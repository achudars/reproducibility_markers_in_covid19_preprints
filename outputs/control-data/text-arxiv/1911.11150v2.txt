Early Structure Formation Constraints on the Ultra-Light Axion in the Post-Inflation
Scenario
Vid Iršič1,2,3 ,∗ Huangyu Xiao4 , and Matthew McQuinn1

arXiv:1911.11150v2 [astro-ph.CO] 23 Jun 2020

1

University of Washington, Department of Astronomy,
3910 15th Ave NE, WA 98195-1580 Seattle, USA
2
Kavli Institute for Cosmology,
University of Cambridge, Madingley Road,
Cambridge CB3 0HA, UK
3
Cavendish Laboratory, University of Cambridge,
19 J. J. Thomson Ave., Cambridge CB3 0HE, UK
4
University of Washington, Department of Physics,
3910 15th Ave NE, WA 98195-1580 Seattle, USA

Many works have concentrated on the observable signatures of the dark matter being an ultralight
axion-like particle (ALP). We concentrate on a particularly dramatic signature in the late-time
cosmological matter power spectrum that occurs if the symmetry breaking that establishes the
ALP happens after inflation – white-noise density fluctuations that dominate at small scales over
the adiabatic fluctuations from inflation. These fluctuations alter the early history of nonlinear
structure formation. We find that for symmetry breaking scales of fA ∼ 1013 − 1015 GeV, which
requires a high effective maximum temperature after inflation, ALP dark matter with particle mass
of mA ∼ 10−13 − 10−20 eV could significantly change the number of high-redshift dwarf galaxies,
the reionization history, and the Lyα forest. We consider all three observables. We find that
the Lyα forest is the most constraining of current observables, excluding fA & 1015 GeV (mA .
10−17 eV) in the simplest model for the ALP and considerably lower values in models coupled
to a hidden asymptotically-free strongly interacting sector (fA & 1013 GeV and mA . 10−13 eV).
Observations that constrain the extremely high-redshift tail of reionization may disfavor similar
levels of isocurvature fluctuations as the forest. Future z ∼ 20 − 30 21cm observations have the
potential to improve these constraints further using that the supersonic motions of the isocurvatureenhanced abundance of ∼ 104 M halos would shock heat the baryons, sourcing large BAO features.
PACS numbers:

I.

INTRODUCTION

The nature of the dark matter remains one of the
biggest unsolved puzzles in particle physics and cosmology. We think that the dark matter is a particle produced
in the early universe via one of several established mechanisms. The foremost has it thermally produced and
its abundance freezing out when non-relativistic, which
can result in the observed dark matter density if it has
a weak-scale mass and interaction cross section – the socalled ‘WIMP miracle’ [e.g. 1]. After decades of searching
for the WIMP, the limits on this scenario are becoming
more stringent. Perhaps our second most favored mechanism is the misalignment mechanism, discovered for the
axion of quantum chromodynamics [QCD, 2–4]. At early
times when Hubble rate is greater than axion mass – a
mass that is acquired by non-perturbative effects such as
instantons–, the axion field is stuck outside of the minimum of its potential. However, when the Hubble rate
later becomes smaller than axion mass, the axion field begins to oscillate coherently, behaving like non-relativistic
matter with energy density set by its initial potential en-

∗ E-mail:

vi223@cam.ac.uk (VI)

ergy [5–8].
The misalignment mechanism is also how the early universe could create dark matter in the form of ultra-light
axion-like particles (ALPs; also known as fuzzy dark matter). The misalignment mechanism may naturally produce an ALP relic abundance of order the dark matter
abundance if the ALP is the Goldstone Boson arising
from a broken GUT to Planck scale symmetry and if it
later acquires a mass of mA ∼ 10−20 eV [9]. The nonperturbative mass generation can also naturally explain
such ultralight masses, with mA ∼ 10−20 eV motivated
by the estimated size of non-perturbative effects for the
GUT coupling constant [8].
Our study focuses on such ultra-light ALPs in the limit
where the Peccei-Quinn symmetry breaking that establishes this particle (re)occurs after inflation. For string
theory-motivated models, the anticipated ranges for the
symmetry breaking scale, fA , are GUT to Planck scales
[8, 9], although models that allow a lower scale have
been devised [10]. Too low of a symmetry breaking scale
would not generate the dark matter abundance: As our
constraints probe, mA = 10−16 − 10−20 eV, this requires
fA just below the GUT scale with ∼ 1015 − 1016 GeV
to generate the relic abundance. These high values
for fA (which are far above the Hubble scale during
inflation so that this symmetry must be broken dur-

2
ing this epoch) may be strained by CMB B-mode observations, which limit the energy scale of inflation to
V (φ) . 1.7 × 1016 GeV [11]. Our mechanism requires
the symmetry to be re-established after inflation. This
reestablishment can occur if the maximum post-inflation
thermalization temperature is greater than fA [115] or
instead during preheating where larger effective temperatures can naturally arise from the non-thermal distribution of resonantly produced particles [12, 13].
We further consider models with an asymptoticallyfree strongly interacting sector that mimics the behavior of the QCD axion (in which the particle mass increases after the ALP behaves behaves like dark matter). Such models allow a somewhat lower fA to match
the dark matter abundance (down to fA ∼ 1013 GeV),
at the cost of introducing a sub-MeV confinement scale.
The cosmological constant problem can be solved by hundreds of ALPs connected with strongly coupled sectors
(as such sectors allow non-degenerate vacuum minima
owing to higher instanton contributions), possibly with
several hidden sectors per decade in energy [14]. (See this
endnote [116] for more discussion of the strongly interacting ‘Axiverse’ scenario, as there are some challenges
to this scenario in our post-inflationary picture.)
Just like with the QCD axion in this post inflation
limit, different causally disconnected patches will acquire
different energy vaccua depending on the random angle
θ ∈ [−π, π] the field rolled to after symmetry breaking
in a given patch, with the Horizon scale setting the coherence length until mA ∼ H [4, 15]. At this time, the
vacuum energy is then converted into non-relativistic axions with number density ∝ θ2 , leading to order unity
fluctuations in the abundance of axions on the horizon
scale when mA ∼ H [16]. The lighter the axion, the later
this occurs, the larger the horizon-scale coherence length
of the fluctuations.
These isocurvature perturbations are potentially observable. For the QCD axion [17], the mass contained in
the horizon MH(mA ) when mA ∼ H – which is also the
scale where there are order unity density fluctuations –
is MH(mA ) ∼ 10−10 M [16, 18, 19] (and axion self interactions can lead to larger enhancements on even smaller
scales; [20]). This leads to the collapse of ‘axion miniclusters’ near this mass scale at matter radiation equality, resulting in much denser dark matter structures than
would be produced by the scale-invariant potential fluctuations from inflation. Still, there is no smoking gun
observable for verifying whether these minute structures
exist, although see [21] for a promising possibility. In
contrast, for ultra-light axions that are relevant for smallscale structure problems, MH(mA ) can approach the sizes
of dwarf galaxies, and the RMS fluctuations produced via
these isocurvature fluctuations scale as M −1 , where M
is the average mass contained within a spherical volume.
These fluctuations are still larger than the inflationary
perturbations even on mass scales of M  MH(mA ) . This
property has been used to place constraints on the ultralight ALPs via the cosmic microwave background [CMB;

22, 23].
This paper shows that other observables are much
more constraining than the CMB. We first focus on the
the Lyα forest, which is the quasi-linear ‘large-scale’
structure formation probe sensitive to the smallest scales.
In addition, we show that such isocurvature perturbations could significantly affect the formation of the first
stars and galaxies in the redshift of z ∼ 6 − 20 Universe,
and discuss potential constraints. Since these ioscurvature perturbations lead to the formation of dark matter halos at much higher redshifts than would occur in
the standard cosmology, we also consider whether the
shocks from these supersonic dense structures could ionize and heat the post-recombination universe. Figure 1
summarizes our constraints on the fractional amplitude
of isocurvature fluctuations fiso (defined shortly) and axion mass ma , where dashed lines represent existing constraints and dotted represent forecasts for future efforts.
This paper is organized as follows. Section II describes
the character of ALP isocurvature fluctuations. Then,
we discuss the limits from several observables: the Lyα
forest (§III), the high-redshift galaxy luminosity function (§IV), measurements that constrain early universe
star formation from the electron scattering optical depth
through reionization (§V), and finally from future 21cm
observations and the potential shock heating of cosmic
gas (§VI). While some of these observables are inherently very astrophysical and hence the constraints dependent on modeling, we show that isocurvature fluctuations can result in qualitatively different trends. Our numerical calculations take Ωm = 0.308, ΩΛ = 0.692, Ωb =
0.0484, h = 0.678, σ8 = 0.815, and ns = 0.968, consistent
with the results of [24]. When convenient, our calculations will use natural units where c = ~ = kb = 1.
Cosmological distances and wavenumbers are given in
comoving units. All mass function calculations use the
mass function of Sheth and Tormen [25]. Even though we
are considering non-standard cosmologies, the well-tested
universality of the mass function means that Sheth and
Tormen [25] still holds at the 10% fractional level [26,
and some of us have also have been involved in running
simulations testing this].

II.

ISOCURVATURE POWER FROM
POST-INFLATION AXIONS

After perturbative effects break the degeneracy between different θ-vacua, the vacuum misalignment of the
ALP translates into a component that behaves like nonrelativistic matter with local density [4, 27, 28]
ρa (T, θini ) =

1 2
2
f ma (T )ma (Tosc )θini
2 a



a(Tosc )
a(T )

3
, (1)

where θini is the initial vacuum misalignment angle after
symmetry breaking, a(T ) is the scale factor, and ma (T )
the axion mass. This formula holds after the axion starts

100

101

Isocurvature ratio fiso

Planck
10−1

Galaxy LF

5 × 1014GeV

CMB-S4

10−2

5 × 1015GeV

Reionization

102

1014GeV

1014GeV

103

Lyα forest
10−3

1015GeV
Cosmic Dawn

n=0

n=4

1013GeV

104

n = 10

10−4−22
10
10−21 10−20 10−19 10−18 10−17 10−16 10−15 10−14 10−13 10−12
ALP Mass [eV]

Early time non-linear scale knl [Mpc−1]

3

FIG. 1: The fiso – ma constraints for the ALP dark matter in the post-inflation scenario, assuming the ALP is all of the dark
matter. The isocurvature to adiabatic ratio fiso applies at the pivot scale of k? = 0.05 Mpc−1 , and the second y-axis gives the
nonlinear scale defined by ∆2iso ≡ (k/knl )3 at early times. The solid lines show this mapping for our fiducial choice of Aosc = 0.1
and the shaded bands span 0.01 ≤ Aosc ≤ 0.3. The horizontal dashed lines correspond to current upper limits on fiso obtained
using different data sets: the Planck 2018 CMB measurements in magenta from [23], Hubble Space Telescope galaxy luminosity
function measurements in grey (§ IV), a combination of constraints on the reionization history in green (§ V), and finally Ly-α
forest in orange (§ III). The horizontal dotted line in light blue is a forecast for CMB-S4 [23], while the horizontal dotted line
in dark red is a rough forecast for where shock-heating should qualitatively change the z ∼ 20 21cm signal (§ VI). The labeled
dots give the value of the symmetry breaking scale fa .

oscillating at an oscillation temperature that we define
as ma = 3H(Tosc ). Eqn. (1) allows for the possibility
that the axion temperature is also evolving at Tosc as
could occur in strongly interacting sectors (as discussed
later). We average ρa (T, θini ) over space, noting that we
2
use the simple relation for the spatial average hθini
i =
2
π /3, to calculate the average dark matter abundance.
The axion decay constant fA (which we also refer to as
the “symmetry breaking scale”) will be adjusted to match
the observed dark matter abundance.
Because different causal horizons have different θini ,
this translates into a white spectrum of isocurvature fluctuations in the matter overdensity at times after the field
behaves like non-relativistic matter but well into the radiation era with growing mode dimensionless power spectrum of (e.g. [23])
∆2S (k)

k3
≡
PS (k) = Aosc
2π 2



k
kosc

3
at k < kosc , (2)

where PS (k) ≡ V −1 |δ̃k |2 , V is the volume, and δ̃k is the
Fourier transform of the configuration-space dark matter
matter overdensity δ(x) (which we assume to be entirely
composed of ALPs such that δ(x) = ρa (x)/hρa i − 1),
kosc = a H |Tosc is the size of the Horizon when the APL
starts to oscillate in its potential [4], and Aosc sets the
normalization for which the order-unity fluctuations on

the oscillations scale mean Aosc ∼ 1. While irrelevant
for this study, at scales k & kosc a sharp cut-off is expected as the vacuum misalignment fluctuations have
been smoothed out by the Kibble Mechanism [15]. Typical values of kosc are between 100 and 1000 Mpc−1 for
the ALP masses of 10−19 and 10−17 eV, respectively.
The signatures we study are sourced by structures that
are coming from an order of magnitude smaller wavenumbers.
Simulations of the QCD axion find that values of the
isocurvature variance at initial conditions are Aosc ∼
0.01 − 0.3 [23, 29], somewhat smaller than unity because
some of the misalignment power is not in the zero mode
and because this signal is diluted by relativistic axions
radiated by axionic strings. However, for our ALP we
expect the details that shape Aosc to depend on the specific model. When we connect our results to the axion
mass ma , we take as a fiducial value Aosc = 0.1, but our
results are easily re-scaled to other values.
We use the standard growth and transfer function parameterization to model the subsequent evolution of the
isocurvature fluctuations (as well as the standard inflationary adiabatic fluctuations). We parameterize the
ioscurvature fluctuations as
∆2iso (k, z)

=

2
2
Diso
(z)Tiso
(k, z)Aiso



k
k?

3
,

(3)

4
where Diso (z) is the growth function that tends to a
2
constant deep in the radiation era, and Tiso
(k, z) is the
transfer function that is normalized to unity at high-k
[117]. This transfer function is approximately constant
for modes that enter the horizon during radiation domination. We take k? = 0.05 Mpc−1 for the pivot scale.
Similarly, for the adiabatic fluctuations from inflation
 ns −1
k
2
2
,
(4)
∆2ad (k, z) = Dad
(z)Tad
(k, z)As
k?
with analogous definitions as for ∆2iso except that the adiabatic transfer function is normalized to unity at low k.
For our chosen value of σ8 , As = 2.054 × 10−9 . The total
matter power at redshift z is the sum of the isocurvature
and adiabatic contributions, ∆2iso + ∆2ad . The transfer
functions at late times were calculated using CAMB Boltzmann code solver [30]. Following convention, we define
fiso to be the ratio of isocurvature to adiabatic fluctuations at k? = 0.05 Mpc−1 :

3
Aiso
Aosc
k?
2
fiso
=
=
,
(5)
As
As
kosc
where the second equation uses that deep into the ra3
since
diation dominated universe Aiso /k? 3 = As /kosc
Diso Tiso → 1. In the late time matter power, the ratio of isocurvature-sourced to adiabatic-sourced fluctuations is highly scale dependent, scaling approximately as
k 3 at high wavenumbers. This is illustrated in Fig. 2,
where different colours represent different values of fiso ,
with highest value of fiso resulting in highest small scale
power. Dashed vertical lines show the mass scale at which
the adiabatic and isocurvature contributions to the power
spectrum are equal. The contribution of isocurvature
fluctuations becomes important at different mass scales,
following the approximate scaling of fiso with mass as
M 1/2 . This is a direct consequence of the definition of
fiso which is fixed on large scales (k? ), and leads to a natural expectation that observables probing smaller mass
scales will result in tighter constraints on fiso .
We also specify the level of isocurvature by its early
−1/3
time nonlinear scale knl , where knl ≡ kosc Aosc such that
2
3
deep into the radiation era ∆iso = (k/knl ) . The nonlinear scale represents a more straightforward quantification
of the white noise power because it does not convolve in
the well-understood amplitude of adiabatic fluctuations
and because it does not single out a specific k? .
One likely scenarios is that the ma does not exhibit
strong temperature dependence in the early Universe.
This limit applies to ALPs whose mass is acquired by
nonperturbative effects associated with the perturbative
gauge couplings in GUT theories [9]. In this case, the
non-perturbative mass is exponentially suppressed relative to the symmetry breaking scale and the ALP field
obtains its zero-temperature mass at T  Tosc . We
also consider a QCD-like case of a asymptotically-free
strongly interacting sector where the non-perturbative effects increase with decreasing temperature until the temperature reaches the confinement scale, Λ; evolution of

the mass occurs even after the ALP behaves like nonrelativistic matter if Λ < Tosc , with the final mass equal
to mA = Λ2 /fa . The ALP mass evolution can be characterized at T . Tosc by
 n
Λ
ma (T ) = ma
for T > Λ,
T
ma (T ) = ma otherwise,

(6)
(7)

where we use the notation that ma without an argument
is the zero temeprature mass and where n parameterizes
the temperature dependence of the instanton effects. The
case n = 4 mimics the scaling found for the QCD axion,
but the details of this scaling will depend on the strong
sector. For n = 0 perturbative case, we note that this
parameterization still holds (trivially).
With this parameterization,

Tosc = 3

10
π 2 geff
n

kosc
fA

1/4

[mA (Tosc )MP ]1/2

(8)

4+n

2 − 8+3n
ma8+3n ,
(9)
∝ hθini
i
Tcmb,0 mA (Tosc )
= aosc H(Tosc ) =
∝ Tosc , (10)
Tosc
3
2 −2/(8+3n) −(2+n)/(8+3n)
∝ hθini
i
ma
,
(11)

√
where MP = 1/ 8πG is the reduced Planck mass, and
Tosc evaluates to 1−100keV for mA of interest, indicating
geff ≈ 3.4. For the proportionality relations, we have
eliminated the Λ dependence in favor of ma and fA . We
note that at fixed mA (Tosc ) the amplitude of isocurvature
fluctuations does not depend on n, and our constraints in
Fig. 1 translate to mA (Tosc ) = 10−20 − 10−17 eV. For our
n = 4, 10 models in Fig. 1, the particle mass increases by
3, 4 orders of magnitude to reach ma at T = Λ.
Fig. 1 foreshadows the constraints we find in the following sections in the ma − fiso plane. The different
horizontal limits show the upper limit on fiso , bounding the viable parameter space to be below the curves.
The n = 0 corresponds to the most likely case where the
mass is established well before the particle commences
oscillations, and the QCD axion yields a scaling with
n = 4. The dots on the lines correspond to the values
of the decay constant fA for those models (colour coded
to match the lines), while the shaded regions around the
lines correspond to the uncertainty in the value of Aosc .
The sold lines themselves were evaluated at the value of
Aosc = 0.1.

III.

LYMAN-α FOREST

The Lyman-α forest is used to infer the initial conditions using significantly smaller comoving scales than
other large-scale structure observables, to 3D wavenumbers of k ≈ 10 − 100Mpc−1 [31, 32]. The Lyman-α forest
circumvents many of the difficulties of modeling structure

Linear Matter Power spectrum P (k) [Mpc3/h3]

5

105
10

3 × 10 M

104
10

8

1 × 10 M

5

8 × 10 M

3

102
101
100
10−1
10−2

fiso = 0
fiso = 0.001
fiso = 0.01
fiso = 0.1

10−3
10−4
10−5
10−6 −2
10

10−1

100
101
Wavenumber k [h/Mpc]

102

103

FIG. 2: The linear matter power spectrum at z = 0 for different values of fiso . The scales where isocurvature contribution
become important, relative to the adiabatic power spectrum,
are marked with vertical dashed lines and labeled by their
M = 4π/3ρm (z = 0)kc−3 , where kc is the wavenumber where
adiabatic and isocurvature fluctuations are equal.

Collapsed Fraction f (> Mh)

100

10−1
fiso = 0
fiso = 0.001
fiso = 0.01
fiso = 0.1

10−2

10−3

10−4 3
10

z=0
z = 10
z = 30
104

105

106

FIG. 3: The collapsed
Different colours show
fractions of fiso = 0.1
(green) and fiso = 0
redshifts.

107 108 109 1010 1011 1012 1013 1014 1015
Halo Mass Mh [M ]

fraction in halos above a mass of Mh .
the collapsed fraction for isocurvature
(blue), fiso = 0.01 (red), fiso = 0.001
(black). The line styles differentiate

formation at these nonlinear scales by being sensitive exclusively to low-densities (∆ ∼ 1 as the absorption of
higher densities is saturated; [33]) where our nonlinear
models for the cosmic web appear to be under control
[34–36] and where astrophysical processes appear to be
less of a contaminant [e.g. 32]. Indeed, the forest has
been used to place the tightest constraints on small-scale
cutoff in the spectrum of primordial matter fluctuations,
which may owe to the free streaming of warm dark matter and the de-Broglie wavelength of fuzzy dark matter
[37–39]. In the context of ALPs, combining the Lyα constraints with the limits on the isocurvature fluctuations
from the CMB can lead to interesting bounds on the
tensor-to-scalar ratio [40].
A typical Lyα forest analysis is sensitive to 1D

wavenumbers between 0.1 and 10 Mpc/h, which would
naively lead to a typical mass of 108 M (see Fig. 2).
However, The non-linear mapping from the 3D density
field to the 1D flux field in the quasar spectra makes the
Lyα forest sensitive to even smaller wavenumbers (see
e.g. [41]). Additionally, the non-linearity of the gravitational evolution does not dominate over the clustering
signal at high redshifts, which helps to better constrain
cosmology at a given scale.
The forest is also sensitive to an enhancement in power
as would occur from the white isocurvature fluctuations
from axions in the post-inflation scenario. Indeed, the
allowed level of enhancement has been constrained in the
context of primordial black holes, which also may have a
white spectrum [41, 42]. Conveniently, the adiabatic plus
white-noise simulations run for the primordial black holes
in [41] are the same as would be run in the context of ALP
isocurvature perturbations, the difference comes in the
interpretation of the isocurvature amplitude and how it is
linked to the actual physical model. In particular, Murgia
and coworkers
[41] find that the isocurvature fraction of
p
fiso = Aiso /As at the pivot scale of k = 0.05 Mpc−1 ,
should be lower than 0.004 at 2σ confidence level when
adopting conservative priors on the thermal history. This
constraint can be remapped to our models by solving
Eqs. 5 and 11 for a given ALP mass evolution model.
The relation between fA and ma is fixed by assuming that
all of dark matter is composed of the axion-like particle.
This gives a lower bound on the mass of the ALP of
mA > 2 × 10−17 eV for the most natural case of no mass
evolution after the axion starts oscillating (n = 0). This
constraint further shows that the forest is effectively able
to probe structure in the dark matter to mass scales as
small as ∼ 3 × 107 M (using Fig. 2); a number that is
helpful for putting the forest in context with the other
constraints we discuss.
Figure 1 shows the constraints from the forest. A primary result of this paper is that we find the Lyα forest
is more constraining than other probes, although future
observations of the high-redshift universe using redshift
21cm radiation may ultimately be more constraining.

IV.

GALAXY LUMINOSITY FUNCTION

Small galaxies are a second observable that has been
used to constrain the primordial fluctuations on small
scales, with observations both probing them as satellite
galaxies to the Milky Way [43] and at high redshifts when
they are forming the bulk of their stars [44, 45]. Since the
white-noise isocurvature fluctuations in our ultra-light
axion models dramatically increase fluctuations on small
scales, such scenarios may predict a large increase in the
number of low-luminosity galaxies. Foreshadowing the
result of this section: For galaxies that are directly observable in the future, we find that this enhancement is
small for the fiso allowed by the forest, although in § V
we show that for smaller galaxies (whose effects can only

6

φ(L) ≡

dnh dMh
dng
=
,
dL
dMh dL

(12)

This model assumes the common one-to-one mapping between halo mass and observed UV luminosity described
by dMh /dL. As this function has significant astrophysical uncertainty, we will use qualitatively different shapes
for the galaxy luminosity function, dng /dL, as a signature that a given axion cosmology is excluded.
To calculate the terms in eqn. 12, we use the ShethTormen mass function [25] to model dnh /dMh [118] The
‘universality’ of the halo mass function makes it likely
that the same mass function should be a good approximation to cases with isocurvature fluctuations [26, 46,
e.g.]. Additionally, we adopt a common assumption that
a galaxy’s star formation rate is proportional to its gas accretion rate, Ṁb , with proportionality constant f? (Mh , z)
called stellar efficiency. Note that the star formation rate
directly maps to the UV luminosity of the galaxy. We follow Furlanetto et al. [47] to calculate f? , who calculate
it from an analytic model that considers energy regulated stellar feedback process plus virial shocking. In
this model, the stellar efficiency of the baryons peaks at
around Mh = 1011.5 M , where it reaches the values of
just below 0.05. This efficiency has a steep tail towards
smaller masses, reaching 10−3 by Mh = 108 M . One
worry, which we will address, is that this efficiency depends on uncertain astrophysics and so any differences
we find may not be distinguishable.
To model the gas accretion rate Ṁb , numerical results
are typically obtained from cosmological simulations (e.g.
[48]), but for the isocurvature case, Ṁb has not been determined using simulations. However, the time evolution
of the halo accretion rate is driven largely by the time
evolution of the mass variance σ(M ) (see e.g. [49]). We
set
d ln Mb
d ln σ
=
dt
d ln Mh

−1

d ln D
,
dt

(13)

and D is the growth function. This allows us to build a
consistent approach to calculating the gas accretion for
any fiso . Our results on the gas accretion are in good
agreement [49] in the limit they consider of fiso = 0.
Fig. 4 shows the resulting comparison of the galaxy
luminosity function. Our model is compared to the measurements of [50–53], but also include the z = 6 lensed
galaxy sample of [54] that extend the measurement to
fainter immensities. We use the standard convention of
writing the UV luminosity in terms of absolute AB magnitude where MAB = −2.5 log10 (LUV ) + Mref where Mref

100
Galaxy LF φ(MAB) [N/mag/Mpc3]

be indirectly probed via their ionization and enrichment)
the enhancement can be more substantial.
To model the enhanced number of small galaxies, we
use a simple but successful model for star formation
where the predicted number density of galaxies ng per
UV luminosity between L and L + dL is related to the
halo mass function dnh /dMh by

10−1
10−2
10−3
10−4
10−5

z
z
z
z

10−6
10−7
10−8
−24

−22

=6
=7
=8
=9

−20
−18
AB Magnitude MAB

z = 10
fiso = 0
fiso = 0.01
fiso = 0.1
−16

−14

FIG. 4: The effect of white-noise isocurvature fluctuations on
the galaxy luminosity function. The various linestyles shows
different levels of isocurvature fluctuations, with colour indicating redshift. Overplotted is a compilation of observational
data ranging over typical redshifts probed by the future surveys. We consider fiso = 0.1 to be ruled out by these observations as by this value the luminosity function has a qualitatively different behavior, especially at the highest redshifts
probed.

is a constant. We have not performed any dust correction at this stage, as the typical corrections [e.g. 55] are
only significant for the higher mass systems, and leads to
a shallower relation between the halo mass and the UV
magnitude [119].
However, including isocurvature fluctuations, even at
level already excluded by Lyα forest of fiso = 0.01, only
results in a small signal at a lower end of the luminosity
function. This is mainly due to the fact that even the
observed high-redshift galaxies behind cluster lenses reside in > 109 M halos in our models. In contrast, the
Lyα forest is sensitive to scales of M ∼ 108 M , as illustrated in Fig. 2. We find that current observations of the
high-redshift luminosity function rule out fiso > 0.1, as
this leads to a large qualitative change that likely cannot be mimicked by the large astrophysical uncertainty
in our star formation efficiency model. One can already
start to see this large effect for the fiso = 0.05 model in
Fig. 2. These limits translate into a lower bound on the
ALP mass to be ma > 10−19 eV.
Future observations at higher redshifts would help
in discriminating between different isocurvature models,
and could potentially provide constraints comparable to
the ones derived from the small scale structure of the
Lyα forest. Namely, the James Webb Space Telescope
(JWST) is able to go a few magnitudes deeper at z ≈ 6,
and more importantly has the infrared sensitivity that allows better constraints at higher redshifts. With lensed
galaxy samples, JWST should be able to place similar
constraints to HST at z = 6 (reaching to absolute magnitudes of MAB = −14) but all the way to z = 10, constraining fiso ∼ 0.01. Unfortunately, astrophysical uncertainties require a qualitative change in behavior, making

7
it difficult to probe beyond fiso = 0.01. Thus, the Lyα
forest is likely to always provide a more sensitive probe
than direct measurements of galaxy luminosity functions.
HIGH-REDSHFIT STAR FORMATION RATE
AND REIONIZATION

Though we find that the galaxy luminosity function is
not competitive with the Lyα forest, the collapsed fraction of halos that can form stars can be orders of magnitude larger than the fiso = 0 prediction at z = 10,
and this difference is even larger at higher redshifts, if
we take fiso = 0.01 – comparable to the constraint coming from Lyα. This is illustrated in Fig 3, noting that
stars can only form in halos with Mh & 107−8 M if
the gas condenses by cooling via atomic transitions and
Mh & 105−6 M halos if instead by molecular ones. Unfortunately, the direct luminosity function measurements
with HST (and in the future with JWST) are not sufficiently sensitive to detect the stars/galaxies that likely
lie in these diminutive halos. However, the enhanced extremely high-redshift star formation from an increased
abundance of these small halos could also heat and ionize the cosmic gas (and their UV photons can pump the
21cm line) in a manner that may allow constraints on
fiso . There is also some indirect evidence that the smallest galaxies contribute disproportionately to the ionizing
photons that escape into and hence ionize the IGM [56,
e.g.], which would make our mass-independent escape in
what follows conservative.
To illustrate just how much isocurvature fluctuations could change the mass in halos that are massive enough to host stars, we calculate the fraction of
mass that is collapsed in halos with masses above Mh
using Extended Press-Schechter theory
√  [57, 58]. This
yields fcoll (> Mh ) = erfc ν(Mh )/ 2 , where erfc(x) ≡
R∞
π −1/2 x dx exp[−x2 ] and ν ≡ δc /σ(M, z) and σ(M, z)
is the standard deviation of the density in a spherical
top-hat Lagrangian volume with mass M . The virial
temperature of halo (the characteristic temperature the
gas can shock heat) is the property of a halo that sets
whether its gas can cool and form stars rather than the
3/2
halo mass. The two are related by Mh ∝ [aTvir ]
– at
higher redshifts the same virial Tvir halo has smaller Mh .
The isocurvature fluctuations with constant power spectrum on small scales during the matter dominated epoch
this leads to σ 2 (M ) ∝ a2 M −1 , whereas for fiso = 0 we
have σ 2 (M ) ∝ a2 log[M ]. The result is that the redshift
evolution of the collapsed fraction at fixed virial radius is
much flatter for masses where isocurvature fluctuations
dominate, with the difference given by
fcoll (> Tvir ) = erfc [1.7 Z10 ]
fcoll (> Tvir ) = erfc[1.0

1/4 3/4
−1
fi,−2
Z10 Tvir,4 ]

for adiabatic;
isocurvature,

where fi,−2 ≡ fiso /10−2 , Z10 ≡ (1 + z)/10 and Tvir,4 ≡
Tvir /104 K.[120]

fiducal
w PopIII
f?III = 0.005 w PopIII
Ionized fraction xi

V.

100

fiso = 0.01
fiso = 0.01, fesc = 0.14
fiso = 0.01 w PopIII
fiso = 0.001 w PopIII

10−1

10−2

10−3
5

McGreer+14
Mason+17,+19
Hoag+19
Greig+16,+18
Davies+18
10

15

Redshift z

20

25

30

FIG. 5: The evolution of the ionized fraction of the intergalactic gas during reionization. The fiducial model assumes
a given stellar efficiency described in Sec. IV. The effect of
axion isocurvature fluctuations is shown for various values of
fiso and also varying assumptions about the escape fraction
of Pop-II stars (orange dashed) or including a contribution
from Pop-III stars (blue and orange dot-dashed). Overplotted is a compilation of observational constraints on the ionized
fraction coming from Lyα dark pixels (grey), Lyα emitters
(brown) and QSO damping wings (green).

The former function falls off exponentially with increasing redshift
for rare (large ν) objects noting asymp√
totic form πerf(x) = exp[−x2 ](x−1 + O(x−3 )), whereas
the latter (while still exponentially sensitive once the argument becomes greater than unity) is much flatter, allowing halos that can cool at much higher redshifts.
An enhancement in the number of star forming halos in the manner of our white isocurvature fluctuations
should lead to an enhanced number of hydrogen ionizing
photons, causing the reionization of the Universe to start
earlier and be a much more prolonged process. Such a
reionization history would be constrained by direct estimates of the ionized fraction using quasar spectra and
Lyman-α emitters. The ionized state of the intergalactic gas can be measured through the time evolution of
the volume-averaged ionized fraction, that depends on
the balance between recombination and ionization due
to photo-ionization [59],
dxi
d (ζfcoll )
=
− n̄H (t) αre (Te ) CHII xi ,
dt
dt

(14)

where ζ = AHe f? fesc Nγ is the ionizing efficiency: a
product of the correction factor for singly ionized helium, AHe ≈ 1.22; the star formation efficiency, f? ; the
escape fraction of ionizing photons, fesc ; and the average number of ionizing photons produced per stellar
baryon, Nγ . In the recombination term, the number
density of hydrogen, n̄H , is time dependent as n̄H =
3
n̄H (z = 0) (1 + z) at redshift z; the recombination
rate, αre , is temperature dependent such that αre (Te ) =
0.76
2.6 × 10−13 Te /104 K
cm3 s−1 , at the electron temperature Te ; and the volume-averaged clumping factor is

8
defined to be CHII ≡ hn2e i/hne i2 .
A rough approximation during HI reionization [59, 60]
is to fix CHII = 3, and Te = 104 K. It would be naturally
to expect a redshift evolution of the clumping factor (see
e.g. [56]), which might change the reionization history.
In our simple scenario, chaning the value of the clumping factor to 5 (1) leads to a largely redshift-independent
change in the ionized fraction in our calculations by a
factor of 0.8 (1.4) (at least at high redshifts). The value
of the mean number of ionizing photons produced, Nγ ,
depends in the initial mass function and metalicity of the
stellar population. We use Nγ = 4, 000 for Population II
(Pop-II) stars, assuming Salpeter IMF and 5% of the solar metalicity (although the results are weakly sensitive
to these choices at least assuming empirically motivated
IMFs). Pop-II stars are the second generation of stars
that are born in metal enriched gas and likely have properties similar to stars observed at low-redshifts. Unless
otherwise stated we use the escape fraction of 20% for
the Pop-II stars. In the fiducial Pop-II model we assume
all halos above Mmin form stars, and at each redshift the
value of Mmin is fixed to the mass at the virial temperature of Tvir = 104 K. The basic photo-ionization rate
can be evaluated using the halo mass accretion rates discussed in (§IV),
Z ∞
d (ζfcoll )
dMh
= AHe Nγ fesc
n(Mh )f? Ṁh , (15)
dt
Mmin ρ̄m
where f? is the mass-dependent stellar efficiency and
n(Mh ) is the halo mass function.
In the context of the early star formation, a Population
III (Pop-III) stellar contribution is often discussed, which
is the first generation of stars which are born metal free
and expected to be more massive. Since this contribution is at present largely unconstrained [61], we adopt a
toy model to characterize their effect on the progression
of the reionization. In this case an additional photoionization term is added, mimicking the structure of
d (ζIII fcoll ) /dt, but with the ionizing efficiency characteristic of the Pop-III models. Namely, following Eqn. (15)
we write down the Pop-III photo-ionization rate as
Z Mmin
d (ζIII fcoll )
dMh
III
= AHe Nγ
n(Mh )f?III Ṁh .
III
dt
ρ̄m
Mmin
(16)
The integration is only over halos where molecular cooling is efficient and atomic is not (as atomic leads to our
normal mode of star formation), i.e. between Tvir =
III
500 K (Mmin
), warm enough to excite rotational transitions of molecular hydrogen, and the mass at the virial
temperature of 104 K (Mmin ). We use NγIII = 40, 000
as anticipated for the hotter photospheres of these metal
free stars[62], and assume that all ionizing photons escape
as anticipated for star formation in these diminutive halos. We also take a stellar efficiency of f?III = 5 × 10−4 ,
although the escape of ionizing photons can be pulled
into this parameter. This efficiency is on the lower end
of what is typically used in the literature [63, 64], with

most commonly used values being 10−3 − 10−2 . However, in our simplifed model, our fiducial value of f?III
leads to the star formation rate density of Pop-III stars
comparable to that of [61] (see our endnote [121]).
Once enough stars form in the Universe, the ∼ 11eV
Lyman-Werner radiation they produce dissociates molecular hydrogen, turning off cooling in molecular cooling
halos and preventing the formation of further Pop-III
stars [65, 66]. To model this we follow [61, 67, 68], where
III
we modify the lower integration limit (Mmin
) in Eqn. (16)
to also include self-regulations due to Lyman-Werner
background. The numerical calculations of [69, 70] found
that the gas is able to cool in halos with mass


III
0.47
,
(17)
Mmin
= Mh (Tvir = 500 K) 1 + 6.69 FLW,21
where FLW,21 is the Lyman-Werner intensity integrated
over solid angle in units of 10−21 erg s−1 Hz−1 cm−2 . To
estimate the Lyman-Werner intensity given a star formation rate (ρ̇SFR ), we use the relations of [61, 68]

(1 + z)3 −τLW
II
III III
NLW
ρ̇II
e
SFR + NLW ρ̇SFR ,
H(z)
(18)
where H(z) is the Hubble rate of expansion, and τLW is
the intergalactic opacity for the Lyman-Werner photons
which can be 1 − 2 in the absence of dissociations [71]
and can be larger once the first HII regions have formed
[72]. We use exp (−τLW ) = 0.5, however we note that in
the isocurvature model the value of τLW might increase
due to more small scale structure obscuring the LymanWerner background.
The number of Lyman-Werner photons produced per
II
= 9, 690 for Pop-II
baryon in stars is taken to be NLW
III
stars, and NLW = 100, 000 for Pop-III stars [68]. The
value of ρ̇SFR is modelled through Eqns. (15) and (16),
such that ρ̇SFR = f? d (fcoll ) /dt. We use an iterative
process to determine the value of ρ̇III
SFR that satisfies
Eqns. (16), (17) and (18).
We also multiply Eqn. (16) by (1 − xi ) to account for
the photo-heating. This term only becomes important
towards the end of reionization at lower redshifts, but
prevents the Pop-III photo-ionization term from resulting in overly large optical depth contribution in the range
of 10 − 15. The functional form of the above model is
an approximate way to characterize the self-regulation
of the Pop-III stellar population in the early Universe.
Simpler models regulated by the average ionized fraction (e.g. [73]) give very similar results. We would also
comment that relations in [61, 68] that we use to derive
Eqns. (17) and (18) were empirically determined from
CDM simulations. An approach based on simulations is
most likely required to model the details of the Pop-III
star formation history in the presence of the isocurvature
fluctuations.
However not including any self-regularization leads to
larger ionized fractions earlier in its evolution, which violate the observational constraints shown in Fig. 5, as well
as the integrated optical depth from Planck (see below).
FLW,21 = 7.22

9

0.08
Thomson optical depth τe(< z)

Thus some form of self-regularization is important to implement, but the exact details of the model do not change
the quantitative picture that including the isocurvature
fluctuations leads to a slower decrease of the ionized fraction at higher redshifts, compared to just Pop-III star
formation, which is illustrated in Fig. 5.
Fig. 5 shows how the ionized fraction evolves in the
redshift range probed by the measurements. Current observations from a variety of sources are plotted on Fig. 5:
Lyα dark pixels ([74] in grey), Lyα emitters ([75–77] in
brown), and QSO damping wings ([78–80] in green). The
fiducial model (black solid line), uses only Pop-II photoionization rates, with fesc = 0.2 and no isocurvature fluctuations (fiso = 0). The effect of including axion isocurvature fluctuations (red lines) exhibits a distinctly longer
tail of reionization, where the ionized fraction starts to
increase much earlier and at a steadier rate than for the
no iosocurvature case. At lower redshift, where the ionized fraction can be currently estimated, the effect of the
isocurvature fluctuations is slightly degenerate with the
escape fraction of Pop-II stars (red dashed line).
On the other hand, the effect of Pop-III stars is prominent at higher redshifts (green dot-dashed line), and in
tandem with the isocurvature fluctuations (dot-dashed
red line) can create a boost to the ionized fraction such
that it evolves much slower between redshifts of 25 and
10, potentially creating a strong observable signal of the
isocurvature modes in the future observations. However,
enhancing the star formation efficiency for Pop-III stars
to 0.005 as used in [64] increases the ionized fraction
evolution even without isocurvature fluctuations (green
dashed line in Fig. 5), making it not obvious that the astrophysics of star formation can be robustly disentangled
from fiso . Nevertheless, at high enough redshift all our
isocurvatore models cross the green-dashed line in Fig. 5
that corresponds to this extreme case of Pop-III stellar
efficiency. This is the unique signal of the isocurvatore
models in the ionization history, resulting from the nearly
redshift-independent collapse fraction in such models.
Future observations by ground based surveys (e.g.
UKIDSS [81]; VIKING [82]; VHS [83]; UHS [84]) and
wide-field surveys (e.g. Euclid, WFIRST, WEAVE, JPAS) in combination with high signal-to-noise spectra
from JWST would be more sensitive to the differences
between the models. In particular measuring the ionized
fraction during the cosmic dawn epoch (z > 15) can lead
to stronger constraints on the isocurvature fluctuations.
Another possibility of constraining the reionization
process is utilizing the measurements of the CMB
anisotropy, in particular the effect of the CMB Thomson scattering off of free electrons. Since the redshift
where this would occur (z < 20) are relatively closer than
the surface of last scattering, this physical process affects
predominantly large scales of the CMB fluctations. The
CMB constraints from the Planck satellite on the τe are
very strong [85], as is show by the grey band in Fig. 6.
The axion isocurvature model has a different signal in
the Thomson scattering optical depth, which primarily

0.07
0.06
0.05
0.04
0.03
0.02
0.01
0.00
5

fiducal
w PopIII
f?III = 0.005 w PopIII

fiso = 0.01, fesc = 0.14
fiso = 0.01 w PopIII
fiso = 0.001 w PopIII

fiso = 0.01
10

15

Redshift z

20

25

30

FIG. 6: Thomson optical depth to recombination, τe . The
grey band shows the Planck 2018 constraints on τe . The models plotted are the same as in Fig. 5, with the black solid line
respresenting the fiducial case using the stellar efficiency described in Sec. IV and fiso = 0, while the orange lines show
the contribution for varying fiso . The models that are clearly
discrepant by the current CMB constraints have either (1)
Pop-III photo-ionization and fiso = 0.01 or (2) high PopIII star formation efficiency and no isocurvature fluctuations
(blue dashed).

reflects the prolonged redshift evolution of the reionization process seen in Fig. 5. However, we note that that
reionization affects on the CMB are not just as a single
number, τe , as an earlier tail ionization creates polarization anisotropies at smaller scales [86, 87]. An extended
reionization is constrained by the Planck satellite to be
τe (15, 30) < 0.007, where this notation indicates the optical depth contributed between z = 15 and z = 30 [85].
(The Planck limits on the tail of reionization vary only
slightly with the assumed priors, and can lower the bound
to τ (15, 30) < 0.006 if flat priors are chosen on the positions of the knots on which τ is interpolated.)
The limits on the tail of reionization are most constraining for models with an earlier star formation, in
particular if the contribution of Pop-III stars is included.
Of the models plotted in Fig. 6 the models with fiso =
0.01 and including Pop-III star formation is clearly excluded, with τe (15, 30) = 0.018 (dotted red line) as shown
in Fig. 7. On the other hand, with the typical Pop-III
star formation rate, the current data is not excluding a
lower value of fiso = 0.001, suggesting that lower fiso values are more degenerate with astrophysical uncertainties
of early star formation. Along this lines, increasing the
III
star formation efficiency of Pop-III stars to fstar
= 0.005
(0.05)[122] leads to τe (15, 30) = 0.007 (0.017) for fiso = 0.
While tangential to the focus of this paper, this interestingly suggests that Planck is already constraining Pop-III
star efficiencies in some of the range typically used. The
limits on the tail of reionization are most constraining
for models with an earlier star formation, in particular if
the contribution of Pop-III stars is included. Apart from
the stellar efficiency, changing the escape fraction of pho-

10

Probability distribution

1.0
fiducal
w PopIII
f?III = 0.005 w PopIII

0.8

0.6

Planck 2018

fiso = 0.01
fiso = 0.01, fesc = 0.14
fiso = 0.01 w PopIII
fiso = 0.001 w PopIII

0.4

0.2

0.0
0.000

0.005

0.010
0.015
0.020
Thomson optical depth τe(15, 30)

0.025

FIG. 7: Thomson optical depth contributed in redshift interval 15 < z < 30, τe (15, 30), in both models and observations.
The grey posterior shows the Gaussian that yields the Planck
2018 2σ upper bound of τe (15, 30) < 0.007. The vertical lines
show τe (15, 30) values for the same models that are plotted in
Fig. 6: the fiducial case using the stellar efficiency described in
Sec. IV and fiso = 0 (black solid line), adding Pop-III photoionization rates (blue dot-dashed), and varying fiso (orange
lines with differing linestyles). Including even small Pop-III
star formation efficiencies can result in detectable τe (15, 30)
for fiso = 0.01.

tons from Pop-II stellar population (τe (15, 30) = 0.002
- dashed red line) can also lower the predicted optical
depth, making isocurvature models similar to the fiducial adiabatic dark matter model (solid black line). This
effect can also lower the optical depth in Pop-III models
that have slightly higher τe compared to the CMB data
(green and red dot-dashed lines).
The enhanced contribution to τe from the isocurvature fluctuations can be mimicked by astrophysical uncertainties: Similar effects can be observed by keeping
fiso = 0.01 fixed, but switching off the Pop-III star formation (solid red line); or switching off isocurvature contribution, but adding Pop-III photo-ionization with the
stellar efficiency of f?III = 5 × 10−4 (green dot-dashed
line). However, differences may show up in the tail of
the reionization, where the aforementioned two models
differ by a factor of ≈ 2 in τe (15, 30). In particular, further increasing Pop-III stellar efficiency by another order
of magnitude to f?III = 0.05 results in too much ionization
at early times – τe (15, 30) = 0.018 – which is ruled out by
Planck CMB constraints. Such a high τe (15, 30) is similar
to that for the case with low Pop-III stellar efficiency and
non-zero fiso (see red dot-dashed line in Fig. 7). However, the contribution to the ionization fraction comes
from z < 20 in the case of high Pop-III stellar efficiency,
while the signal in isocurvature models is dominated by
the contribution at z > 20.
On the other hand, further increasing the amount of
isocurvature power by a factor of 5 ionizes the Universe to
10% early on (z ∼ 29(46) for fiso = 0.05(0.1)), leading to
large values of τe (15, 30) ∼ 0.04(0.09). Such models are

clearly ruled out by the current CMB data, despite the
astrophysical uncertainties. At a high enough level of fiso
the statement that such models are excluded by the CMB
holds over the range of Pop-III efficiencies considered.
In our models this transition happens in the range of
fiso = 0.01 − 0.1.
Neglecting Pop-III contribution also lowers the effect
of isocurvature modes. This occurs because the minimal mass (Mmin ) that contributes to the Pop-II photoionization rates (Eqn. 15) is typically ∼ 108 M , requiring a large fiso to have an appreciable effect on these
mass scales (see Fig. 2). On the other hand the minimal
III
mass for Pop-III photo-ionization rates (Mmin
) is generally two orders of magnitude lower than for Pop-II stars
(∼ 106 M ), and thus more sensitive to smaller values of
fiso .
Since some contribution from the Pop-III star formation is expected, values of fiso of the order of 10−2 are
excluded with the current measurements already, which
corresponds to ALP mass limit of ma > 10−18 eV. Current and future CMB observations (e.g. CLASS, LiteBIRD) aim to put more stringent constraints on τe approaching the cosmic variance limit of στ = 0.002 [88, 89].
The sensitivity of measurements of the tail of reionization
via statistics like τe (15, 30) likely can be improved even
more significantly over Planck with future missions than
this improvement in στ [89], although we expect measuring even higher redshift contributions like τe (25, 40)
would be needed to be able to disentangle astrophysics
and improve constraints on fiso .
Finally, we note that early ionization (which is likely
also associated with X-ray and ultraviolet backgrounds)
would shape the high-redshift 21cm emission signal [90].
The 21cm signal is potentially sensitive to much lower
star formation rate densities via these emissions than the
ionizing emissions this section has focused on [67]. The
next section discusses another effect that may be even
more constraining for this signal.

VI.

CMB RECOMBINATION AND THE DARK
AGES THERMAL HISTORY

As illustrated in Fig 3, the presence of white noise
isocurvature fluctuations leads to the formation of dark
matter halos much earlier than in the standard scenario.
These early dark matter halos are moving supersonically
relative to the gas, with an RMS Mach number of ≈ 2
and with a Maxwellian distribution [91]. Some regions
can even be moving hypersonically at z & 500 (i.e. with
relative velocities of & 10km s−1 so that the shocks can
ionize the gas). Furthermore, a 104 M dark matter halo
will lose its velocity relative to the dark matter within
a Hubble time [92], potentially ionizing and heating the
gas in the Universe if enough of these halos are present.
We first investigate the effect of shock ionization on
the cosmic microwave background from such hypersonic
motion. Even percent level differences in the global

11
on the thermal history by solving

30
25

Compton

Temperature [K]

20

adiabatic

}|
{
z
z }| { 8π 2 xi Tγ4 σT (Tγ − T )
dT
= −2HT +
(19)
dt
45me (1 + xi )
Z Mmax
µmp
dn
−1
,
−
hζs (vb-dm )vb-dm i
dMh Mh2
3MP4
dM
h
M
|
{z min
}

15
10
No heating
fiso = 1 × 10−4
fiso = 2 × 10−4

5
15

shock heating

fiso = 3 × 10−4
20

25
30
Redshift z

35

40

FIG. 8: Rough estimates for the evolution of gas temperature
at different fiso , with larger fiso leading to more shock heating.
Our estimates suggest that fiso ∼ 10−4 lead to percent-level
or greater shock heating. Percent level heating would manifest in a qualitatively different high-redshift 21cm signal, with
significant BAO peaks.

z ∼ 500 recombination history that result from this ionization could have a detectable effect on the cosmic microwave background [93]. However, while we found that
the shocks in a large fraction of the Universe at z > 500
would often heat the gas sufficiently for it to start to collisionally ionize, ionization would quickly sap out the thermal energy of the gas, leaving it at insufficient temperatures to collisionally ionize further. We found that because of this cost to ionization, even the strongest shocks
would only ionize the gas to ∼ 1%. This small ionization,
coupled with the fact that (for viable fiso ) only a fraction
of dark matter has collapsed into the Mh & 103 M at
z & 500 halos that generate significant shocks, results in
the recombination history being negligibly affected.
We next turn to the heating imparted by such shocks.
If the heating occurs early enough, it could also affect the
recombination history, as the recombination rate depends
inversely on the temperature. Our calculations suggest
that such heating does not occur at early enough times
to be relevant for Recombination. Another observable is
the cosmological 21cm signal. When the 21cm signal is
in absorption as is anticipated 15 . z . 30, its amplitude
is inversely proportional to the gas temperature [90]. We
show below that this shock heating could be important
for this 21cm signal.
A simple estimate for the amount of shocking uses that
we know how much energy is dissipated into the gas via
dynamical friction, a frictional force from the gas that
acts to decelerate the supersonicly streaming dark matter
halos. Namely, halos more massive than ∼ 105 − 106 M
should lose all of their relative velocity to the baryons in
a Hubble time at z ∼ 20 [67]. Some of this dynamical
energy should go into shocks (and if all of the energy
goes into shocks we would expect to heat the Universe
by hM2 i ∼ 4). We estimate the effect of shock heating

where σT is the Thomson cross section, mp is the mass of
hydrogen atom, vb-dm is the velocity difference between
dark matter and baryons, Mh is the halo mass and ρdm is
the density of dark matter. The Compton cooling term
owes to the scattering of CMB photons, which is negligible below redshift z = 200. The “shock heating” term in
Eqn. 19 follows from the power generated from dynamical friction; taking the expression in [94] but dropping
the factor of the Coulomb logarithm. The motivation for
dropping this logarithm is that the resulting expression
accounts only for gas that intersects within the Bondi2
Hoyle radius for accretion (rBH = 2GM/vb-dm
; [95] and
see this endnote [123]), which is the gas whose trajectory would be deflected to the origin (in the absence of
pressure) and hence is most likely to shock. We conservatively assume the shock heating has efficiency ζs at thermalizing its energy, and we take ζs = 0.1 motivated by
entropy increase calculated in planar shocks with Mach
numbers of M = 2. Finally, Mmax is set to the halo
mass whose timescale to lose its energy by dynamical
friction in much less than the age of the Universe, as
once a halo reaches this mass, it will likely have decelerated and no longer contribute to the heating. We take
106 M as the maximum mass. The minimum mass is
set by where the halo viral radius equals rBH , which we
find is M ≈ 104 M . It is worth stressing that the shock
heating effect is most sensitive to the maximum mass.
If we make the maximum mass a factor of 10 smaller
(105 M ), the temperature difference will be about three
times smaller in Fig. 8, which we think reflects the level
of uncertainty.
Our simple estimates show that the shock heating effects from axion halos starts to become significant around
redshift z = 20 as shown in Fig. 8 for fiso & 10−4 . Models predict a global 21cm absorption feature at ∼ 80MHz,
corresponding to absorption at z ∼ 15−20 [90], the same
signal purported to be detected by EDGES [96]. This absorption dip is inversely proportional to the gas temperature. Thus, a detection of the full amplitude of this dip
should at a minimum be used to discern shock heating
at the O(1) level, requiring for us fiso ∼ 5 × 10−4 . Such
heating would be hard to disentangle from X-ray heating
from the first supernovae and black holes [90]. However,
efforts to detect fluctuations in the 21cm have a potentially smoking gun signal for this heating. Since change
in temperature is tied to the relative velocity between
the baryons and the dark matter (vb-dm ), and this relative velocity is modulated by the acoustic physics in the

12
early Universe, any heating could result in large acoustic oscillations in the signal. McQuinn and O’Leary [67]
showed that even just ∼ 3% changes in the temperature
that are tied to vb-dm would lead to order-unity acoustic
features in the 21cm signal at k ∼ 0.1Mpc−1 [67], qualitatively changing the 21cm signal. Our estimates in Fig. 8
suggests that heating at the few percent level occurs for
fiso & 10−4 , although we illustrate the rough constraint
in Fig 1 at fiso = 3 × 10−4 . These acoustic features are
quite distinct from the smoother continuum of fluctuations from the extra star formation would create, which
were referenced as a potential observable in § V.
VII.

CONCLUSIONS

One possible candidate for the dark matter is that it
is an ultra-light scalar field that is generated in the early
universe in a similar manner to that for the QCD axion,
making it an ‘axion like particle’ (ALP). Most previous
studies have concentrated on how the ultralight ALP’s
quantum pressure suppresses the small-scale growth of
the adiabatic fluctuations from inflation or on how its
relaxation can lead to solitonic cores [97–99]. However,
if the symmetry breaking that establishes the axion-like
particle (ALP) occurs after inflation ends, this leads to
white isocurvature fluctuations in the ALP energy density. The parameter space where the post inflationary
scenario can occur are for symmetry breaking scales of
1013 − 1016 GeV for the particle mass ranges that are
probed by the large scale structure observables considered here (mA ∼ 10−13 − 10−20 eV). The higher values
for the symmetry breaking scale (and lower values for the
mass) push against limits from searches for inflationary
B-modes. This paper focused on how these isocurvature
fluctuations could influence various observations of early
structure formation.
Fig. 1 summarizes our resulting constraints on the ALP
mass ma and isocurvature fluctuation amplitude fiso –
defined in the traditional manner as their ratio with adiabatic fluctuations at a wavenumber of 0.05Mpc−1 (but
we also report constraints in terms of the more natural
nonlinear wavenumber knl ). The solid lines show the relation between the axion mass and fiso . Different colours
represent different parameterizations of the evolution of
the axion mass with temperature after it commences oscillations. The simplest model, and also most conservative in terms of mass constraints, is the n = 0 case where
the mass was set at early times. For an ALP coupled
to an asymptotically free sector (in analogy to the QCD
axion), leading to a mass that increases in size until the
cosmic temperature falls below the sector’s confinement
scale, the value of n is nonzero (with n = 4 approximating the evolution of the QCD axion). As n increases
above 4, the sensitivity of our results to n becomes weak.
The cosmological observables presented in this paper
are sensitive to different axion masses mA or equivalently
different levels of fiso , with the smaller scale the ob-

servable is sensitive to the stronger the constraint. Our
strongest present constraint comes from the Lyα forest
power spectrum measurements at high redshifts (orange
dashed line). The lower bound on the ALP mass from
the Lyα forest is mA > 2 × 10−17 eV for n = 0 (and
mA > 10−13 eV for n = 4). Apart from being currently
most constraining bound, the Lyα analysis is also the
least affected by uncertainties in the astrophysics of the
existing probes we investigated.
Another potential probe is high-redshift galaxy observations. We find that only for mA already ruled out by
the Lyα forest is the observed luminosity function qualitatively changed in a manner that could potentially be
disentangled from more mundane astrophysical explanations. However, smaller mass (and higher redshift) galaxies than can be observed directly are more substantially
boosted by isocurvature fluctuations. Such diminutive
galaxies may be observable via their effect on the ionized fraction evolution during the Reionization Epoch.
We find that a particularly interesting observable is the
CMB, which is sensitive to the high-redshift tail of reionization. This tail can be substantially more extended in
models with white isocurvature fluctuations. While we
find that the ionization fraction in models where galaxies
form via the traditional route (in halos massive enough
that the gas can cool atomically) only show qualitatively
different trends for mA already ruled out by the forest,
models that include Pop-III stars (even for much lower efficiencies for their formation than is commonly assumed)
could lead to a small residual ionization to extremely
high redshifts. Thus, future CMB efforts could potentially probe mA range similar to that of the Lyα forest.
Finally, the shock-heating of the gas due to supersonically moving axion minihalos during the Cosmic Dark
Ages and Cosmic Dawn could lead to even stronger constraints, potentially excluding ALP masses of mA <
10−16 eV for n = 0. This shocking would suppress the
depth of the absorption trough in the global 21cm signal
(as probed by e.g EDGES and PRIZM). The caveat is
that X-ray heating could have a similar effect [100, 101].
However, even percent-level changes in the mean temperature from shock-heating will manifest in distinct baryon
acoustic oscillation features in the 21cm brightness temperature fluctuations that trace the relative baryon-dark
matter velocity field. These oscillations are potentially a
smoking gun of shock heating from a dramatic enhancement in the number of minihalos.
Some low redshift small-scale structure probes could
complement the probes discussed here. First, local observations of Milky Way tidal streams could lead to detection of small sub halos in the mass range 108 −105 M
[102, 103], with some uncertainty in whether the lowest
values of 105 M can be disentangled from astrophysical
uncertainties, as encounters with these subhalos open up
gaps in these streams. This places the sensitivity of the
galactic streams somewhere in the range of isocurvature
amplitudes of fiso = 0.001 − 0.01, potentially pushing the
constraints lower than the current Lyα bound and com-

13
parable to our most optimistic reionization constraints.
In addition, Dai and Miralda-Escudé [104] recently
showed that the micro-lensing caustics of stars on a cluster macro-lens could even be sensitive to the minute value
of MH(mA ) for the QCD axion of ∼ 10−12 M , where
MH(mA ) is the mass within the Horizon at Tosc . In particular, these micro-lensing caustics are perturbed by these
axion structures, deviating from the smooth profile otherwise expected. This constraint can also be translated
to our scenario. Dai and Miralda-Escudé [104] showed
this method is sensitive to 10−13 < MH(mA ) < 10−6 M ,
which translates to the bounds on the ALP mass of
10−15 < mA < 10−11 eV for n = 0 (10−11 − 10−6 eV
for n = 4). Since the sensitivity falls off on both sides
of the ALP mass range, this makes the microlensing of
stars complementary to the signatures of early structure
formation considered in this paper. Future observations
with HST or JWST should be able to push forward this
exciting science [105, 106].
Lastly, a post-inflation ALP may affect the properties
of black holes. Studies of black hole superradiance [107–
110] – the gravitaional production of a ALP halo from
the free energy in black hole spin – have excluded the existence of ALPs with 10−14 < mA < 10−11 eV from measurements of finite stellar black hole spins. The measurements of super massive black hole spin can potentially

exclude a wide mass range mA < 10−16 eV [109], but
inferring the black hole masses over a broad mass range.
The bounds from superradiance are also only valid in
the limit of fA > 1014 GeV and no self-interaction [109].
Furthermore, the earlier structure formation sourced by
a post-inflation ALP could potentially produce the seeds
that grow into the highest mass black holes, ameliorating somewhat the difficulty in having sufficient time for
these seeds to grow into the highest redshift quasars (e.g.
[111]).

[1] G. Jungman, M. Kamionkowski, and K. Griest, Physics
Reports 267, 195 (1996), hep-ph/9506380.
[2] S. Weinberg, Phys. Rev. Lett. 40, 223 (1978), URL
https://link.aps.org/doi/10.1103/PhysRevLett.
40.223.
[3] F. Wilczek, Phys. Rev. Lett. 40, 279 (1978).
[4] E. W. Kolb and M. S. Turner, The early universe, vol. 69
(1990).
[5] J. Preskill, M. B. Wise, and F. Wilczek, Phys. Lett.
120B, 127 (1983).
[6] L. F. Abbott and P. Sikivie, Phys. Lett. 120B, 133
(1983).
[7] M. Dine and W. Fischler, Phys. Lett. 120B, 137 (1983).
[8] D. J. E. Marsh, Physics Reports 643, 1 (2016),
1510.07633.
[9] L. Hui, J. P. Ostriker, S. Tremaine, and E. Witten,
Phys. Rev. D 95, 043541 (2017), 1610.08297.
[10] P. Svrcek and E. Witten, Journal of High Energy
Physics 2006, 051 (2006), hep-th/0605206.
[11] Planck Collaboration, Y. Akrami, F. Arroja, M. Ashdown, J. Aumont, C. Baccigalupi, M. Ballardini, A. J.
Banday, R. B. Barreiro, N. Bartolo, et al., arXiv e-prints
arXiv:1807.06211 (2018), 1807.06211.
[12] I. I. Tkachev, Physics Letters B 376, 35 (1996), hepth/9510146.
[13] L. Kofman, A. Linde, and A. A. Starobinsky, Phys. Rev.
Lett. 76, 1011 (1996), hep-th/9510119.
[14] A. Arvanitaki, S. Dimopoulos, S. Dubovsky,
N. Kaloper, and J. March-Russell, Phys. Rev. D
81, 123530 (2010), 0905.4720.
[15] T. Kibble, Physics Reports 67, 183 (1980), ISSN 0370-

1573, URL http://www.sciencedirect.com/science/
article/pii/0370157380900915.
C. J. Hogan and M. J. Rees, Physics Letters B 205, 228
(1988).
J. Preskill, M. B. Wise, and F. Wilczek, Physics Letters
B 120, 127 (1983).
G. Efstathiou and J. R. Bond, MNRAS 218, 103 (1986).
A. Vaquero, J. Redondo, and J. Stadler, J. Cosmology
Astropart. Phys. 2019, 012 (2019), 1809.09241.
E. W. Kolb and I. I. Tkachev, Phys. Rev. D 49, 5040
(1994), astro-ph/9311037.
L. Dai and J. Miralda-Escudé, arXiv e-prints
arXiv:1908.01773 (2019), 1908.01773.
D. J. E. Marsh, D. Grin, R. Hlozek, and P. G. Ferreira,
Phys. Rev. D 87, 121701 (2013), 1303.3008.
M. Feix, J. Frank, A. Pargner, R. Reischke, B. M.
Schfer, and T. Schwetz, JCAP 1905, 021 (2019),
1903.06194.
Planck Collaboration, P. A. R. Ade, N. Aghanim,
M. Arnaud, M. Ashdown, J. Aumont, C. Baccigalupi,
A. J. Banday, R. B. Barreiro, J. G. Bartlett, et al., A&A
594, A13 (2016), 1502.01589.
R. K. Sheth and G. Tormen, MNRAS 329, 61 (2002),
astro-ph/0105113.
J. S. Bagla, N. Khandai, and G. Kulkarni, arXiv e-prints
arXiv:0908.2702 (2009), 0908.2702.
S. Weinberg, Phys. Rev. Lett. 40, 223 (1978), URL
https://link.aps.org/doi/10.1103/PhysRevLett.
40.223.
F. Wilczek, Phys. Rev. Lett. 40, 279 (1978), URL
https://link.aps.org/doi/10.1103/PhysRevLett.

Acknowledgments

We would like to thank Akshay Ghalsasi for helpful
conversations, and Erik Anson for running tests of the
universality of the mass function in cosmologies near our
white case. VI and MM thank US NSF grant AST1514734, and MM and HX the University of Washington
Royalty Research Grant program. HX is also supported
in part by the U.S. Department of Energy, under grant
number de-sc0011637. VI acknowledges support by the
Kavli Foundation.

[16]
[17]
[18]
[19]
[20]
[21]
[22]
[23]

[24]

[25]
[26]
[27]

[28]

14
40.279.
[29] A. Vaquero, J. Redondo, and J. Stadler, J. Cosmology
Astropart. Phys. 2019, 012 (2019), 1809.09241.
[30] A. Lewis and S. Bridle, Phys. Rev. D 66, 103511 (2002),
astro-ph/0205436.
[31] A. A. Meiksin, Reviews of Modern Physics 81, 1405
(2009), 0711.3358.
[32] M. McQuinn, ARA&A 54, 313 (2016), 1512.00086.
[33] V. Iršič and M. McQuinn, J. Cosmology Astropart.
Phys. 2018, 026 (2018), 1801.02671.
[34] R. Cen, J. Miralda-Escudé, J. P. Ostriker, and
M. Rauch, Astrophysical Journal Letters 437, L9
(1994), astro-ph/9409017.
[35] J. Miralda-Escudé, R. Cen, J. P. Ostriker, and
M. Rauch, Astrophys. J. 471, 582 (1996), astroph/9511013.
[36] L. Hernquist, N. Katz, D. H. Weinberg, and J. MiraldaEscudé, Astrophysical Journal Letters 457, L51 (1996),
astro-ph/9509105.
[37] U. Seljak, A. Makarov, P. McDonald, and H. Trac, Phys.
Rev. Lett. 97, 191303 (2006), astro-ph/0602430.
[38] M. Viel, J. Lesgourgues, M. G. Haehnelt, S. Matarrese,
and A. Riotto, Phys. Rev. D 71, 063534 (2005), astroph/0501562.
[39] V. Iršič, M. Viel, M. G. Haehnelt, J. S. Bolton, and
G. D. Becker, Phys. Rev. Lett. 119, 031302 (2017),
1703.04683.
[40] T. Kobayashi, R. Murgia, A. De Simone, V. Iršič, and
M. Viel, Phys. Rev. D 96, 123514 (2017), 1708.00015.
[41] R. Murgia, G. Scelfo, M. Viel, and A. Raccanelli, arXiv
e-prints arXiv:1903.10509 (2019), 1903.10509.
[42] N. Afshordi, P. McDonald, and D. N. Spergel, Astrophysical Journal Letters 594, L71 (2003), astroph/0302035.
[43] J. S. Bullock and M. Boylan-Kolchin, ARA&A 55, 343
(2017), 1707.04256.
[44] R. Barkana, Z. Haiman, and J. P. Ostriker, Astrophys.
J. 558, 482 (2001), astro-ph/0102304.
[45] F. Pacucci, A. Mesinger, and Z. Haiman, MNRAS 435,
L53 (2013), 1306.0009.
[46] Z. Lukić, K. Heitmann, S. Habib, S. Bashinsky, and
P. M. Ricker, Astrophys. J. 671, 1160 (2007), astroph/0702360.
[47] S. R. Furlanetto, J. Mirocha, R. H. Mebane, and G. Sun,
MNRAS 472, 1576 (2017), 1611.01169.
[48] J. McBride, O. Fakhouri, and C.-P. Ma, MNRAS 398,
1858 (2009), 0902.3659.
[49] C. A. Correa, J. S. B. Wyithe, J. Schaye, and A. R.
Duffy, MNRAS 450, 1514 (2015), 1409.5228.
[50] R. J. McLure, J. S. Dunlop, R. A. A. Bowler, E. CurtisLake, M. Schenker, R. S. Ellis, B. E. Robertson, A. M.
Koekemoer, A. B. Rogers, Y. Ono, et al., MNRAS 432,
2696 (2013), 1212.5222.
[51] R. A. A. Bowler, J. S. Dunlop, R. J. McLure, and D. J.
McLeod, MNRAS 466, 3612 (2017), 1605.05325.
[52] R. J. Bouwens, G. D. Illingworth, P. A. Oesch,
M. Trenti, I. Labbé, L. Bradley, M. Carollo, P. G. van
Dokkum, V. Gonzalez, B. Holwerda, et al., Astrophys.
J. 803, 34 (2015), 1403.4295.
[53] R. J. Bouwens, P. A. Oesch, I. Labbé, G. D. Illingworth,
G. G. Fazio, D. Coe, B. Holwerda, R. Smit, M. Stefanon,
P. G. van Dokkum, et al., Astrophys. J. 830, 67 (2016),
1506.01035.
[54] R. J. Bouwens, P. A. Oesch, G. D. Illingworth, R. S.

[55]

[56]
[57]
[58]
[59]
[60]
[61]
[62]
[63]
[64]
[65]
[66]
[67]
[68]
[69]
[70]
[71]
[72]
[73]
[74]
[75]

[76]

[77]

[78]
[79]
[80]

[81]

Ellis, and M. Stefanon, Astrophys. J. 843, 129 (2017),
1610.00283.
R. Smit, R. J. Bouwens, M. Franx, G. D. Illingworth,
I. Labbé, P. A. Oesch, and P. G. van Dokkum, Astrophys. J. 756, 14 (2012), 1204.3626.
F. Haardt and P. Madau, Astrophys. J. 746, 125
(2012), 1105.2039.
W. H. Press and P. Schechter, Astrophys. J. 187, 425
(1974).
J. R. Bond, S. Cole, G. Efstathiou, and N. Kaiser, Astrophys. J. 379, 440 (1991).
G. Sun and S. R. Furlanetto, MNRAS 460, 417 (2016),
1512.06219.
J. M. Shull, A. Harness, M. Trenti, and B. D. Smith,
Astrophys. J. 747, 100 (2012).
E. Visbal, Z. Haiman, and G. L. Bryan, MNRAS 453,
4456 (2015), 1505.06359.
V. Bromm, R. P. Kudritzki, and A. Loeb, Astrophys. J.
552, 464 (2001), astro-ph/0007248.
M. Trenti and M. Stiavelli, Astrophys. J. 694, 879
(2009), 0901.0711.
E. Visbal, Z. Haiman, and G. L. Bryan, MNRAS 475,
5246 (2018), 1705.09005.
Z. Haiman, M. J. Rees, and A. Loeb, Astrophys. J. 476,
458 (1997), astro-ph/9608130.
Z. Haiman, T. Abel, and M. J. Rees, Astrophys. J. 534,
11 (2000), astro-ph/9903336.
M. McQuinn and R. M. O’Leary, Astrophys. J. 760, 3
(2012), 1204.1345.
R. H. Mebane, J. Mirocha, and S. R. Furlanetto, MNRAS 479, 4544 (2018), 1710.02528.
M. E. Machacek, G. L. Bryan, and T. Abel, Astrophys.
J. 548, 509 (2001), astro-ph/0007198.
J. H. Wise and T. Abel, Astrophys. J. 671, 1559 (2007),
0707.2059.
M. Ricotti, N. Y. Gnedin, and J. M. Shull, Astrophys.
J. 560, 580 (2001), astro-ph/0012335.
J. L. Johnson, T. H. Greif, and V. Bromm, Astrophys.
J. 665, 85 (2007), astro-ph/0612254.
V. Miranda, A. Lidz, C. H. Heinrich, and W. Hu, MNRAS 467, 4050 (2017), 1610.00691.
I. D. McGreer, A. Mesinger, and V. D’Odorico, MNRAS
447, 499 (2015), 1411.5375.
C. A. Mason, T. Treu, M. Dijkstra, A. Mesinger,
M. Trenti, L. Pentericci, S. de Barros, and E. Vanzella,
Astrophys. J. 856, 2 (2018), 1709.05356.
A. Hoag, M. Bradač, K. Huang, C. Mason, T. Treu,
K. B. Schmidt, M. Trenti, V. Strait, B. C. Lemaux,
E. Q. Finney, et al., Astrophys. J. 878, 12 (2019),
1901.09001.
C. A. Mason, A. Fontana, T. Treu, K. B. Schmidt,
A. Hoag, L. Abramson, R. Amorin, M. Bradač,
L. Guaita, T. Jones, et al., MNRAS 485, 3947 (2019),
1901.11045.
B. Greig, A. Mesinger, Z. Haiman, and R. A. Simcoe,
MNRAS 466, 4239 (2017), 1606.00441.
B. Greig, A. Mesinger, and E. Bañados, MNRAS 484,
5094 (2019), 1807.01593.
F. B. Davies, J. F. Hennawi, E. Bañados, Z. Lukić,
R. Decarli, X. Fan, E. P. Farina, C. Mazzucchelli, H.W. Rix, B. P. Venemans, et al., Astrophys. J. 864, 142
(2018), 1802.06066.
A. Lawrence, S. J. Warren, O. Almaini, A. C. Edge,
N. C. Hambly, R. F. Jameson, P. Lucas, M. Casali,

15

[82]

[83]

[84]

[85]

[86]
[87]
[88]

[89]
[90]
[91]
[92]
[93]
[94]
[95]
[96]

[97]
[98]
[99]

[100]
[101]
[102]
[103]
[104]
[105]

[106]

A. Adamson, S. Dye, et al., MNRAS 379, 1599 (2007),
astro-ph/0604426.
A. Edge, W. Sutherland, K. Kuijken, S. Driver,
R. McMahon, S. Eales, and J. P. Emerson, The Messenger 154, 32 (2013).
R. G. McMahon, M. Banerji, E. Gonzalez, S. E. Koposov, V. J. Bejar, N. Lodieu, R. Rebolo, and VHS
Collaboration, The Messenger 154, 35 (2013).
S. Dye, A. Lawrence, M. A. Read, X. Fan, T. Kerr,
W. Varricatt, K. E. Furnell, A. C. Edge, M. Irwin, N. Hambly, et al., MNRAS 473, 5113 (2018),
1707.09975.
Planck Collaboration, N. Aghanim, Y. Akrami, M. Ashdown, J. Aumont, C. Baccigalupi, M. Ballardini, A. J.
Banday, R. B. Barreiro, N. Bartolo, et al., arXiv e-prints
arXiv:1807.06209 (2018), 1807.06209.
W. Hu and G. P. Holder, Phys. Rev. D 68, 023001
(2003), astro-ph/0303400.
C. H. Heinrich, V. Miranda, and W. Hu, Phys. Rev. D
95, 023513 (2017), 1609.04788.
E. Di Valentino, T. Brinckmann, M. Gerbino, V. Poulin,
F. R. Bouchet, J. Lesgourgues, A. Melchiorri, J. Chluba,
S. Clesse, J. Delabrouille, et al., J. Cosmology Astropart. Phys. 2018, 017 (2018), 1612.00021.
D. J. Watts, G. A. Addison, C. L. Bennett, and J. L.
Weiland (2019), 1910.00590.
S. R. Furlanetto, S. P. Oh, and F. H. Briggs, Physics
Reports 433, 181 (2006), astro-ph/0608032.
D. Tseliakhovich and C. Hirata, Phys. Rev. D 82,
083520 (2010), 1005.2416.
R. M. O’Leary and M. McQuinn, Astrophys. J. 760, 4
(2012), 1204.1344.
T. R. Slatyer, N. Padmanabhan, and D. P. Finkbeiner,
Phys. Rev. D 80, 043526 (2009), 0906.1197.
E. C. Ostriker, Astrophys. J. 513, 252 (1999), astroph/9810324.
H. Bondi and F. Hoyle, MNRAS 104, 273 (1944).
J. D. Bowman, A. E. E. Rogers, R. A. Monsalve, T. J.
Mozdzen, and N. Mahesh, Nature (London) 555, 67
(2018), 1810.05912.
H.-Y. Schive, T. Chiueh, and T. Broadhurst, Nature
Physics 10, 496 (2014), 1406.6586.
J. Veltmaat, J. C. Niemeyer, and B. Schwabe, Phys.
Rev. D 98, 043509 (2018), 1804.09647.
P. Mocz, A. Fialkov, M. Vogelsberger, F. Becerra, M. A.
Amin, S. Bose, M. Boylan-Kolchin, P.-H. Chavanis,
L. Hernquist, L. Lancaster, et al., Phys. Rev. Lett.
123, 141301 (2019), URL https://link.aps.org/doi/
10.1103/PhysRevLett.123.141301.
R. Barkana, Nature (London)
555, 71 (2018),
1803.06698.
A. Fialkov and R. Barkana, MNRAS 486, 1763 (2019),
1902.02438.
J. Bovy, D. Erkal, and J. L. Sanders, MNRAS 466, 628
(2017), 1606.03470.
A. Bonaca, D. W. Hogg, A. M. Price-Whelan, and
C. Conroy, Astrophys. J. 880, 38 (2019), 1811.03631.
L. Dai and J. Miralda-Escudé, arXiv e-prints
arXiv:1908.01773 (2019), 1908.01773.
W. Chen, P. L. Kelly, J. M. Diego, M. Oguri, L. L. R.
Williams, A. Zitrin, T. L. Treu, N. Smith, T. J. Broadhurst, N. Kaiser, et al., Astrophys. J. 881, 8 (2019),
1902.05510.
A. A. Kaurov, L. Dai, T. Venumadhav, J. Miralda-

[107]
[108]
[109]
[110]
[111]

[112]
[113]
[114]
[115]

[116]

[117]

[118]

[119]

[120]

[121]

Escudé, and B. Frye, Astrophys. J. 880, 58 (2019),
1902.10090.
A. Arvanitaki, M. Baryakhtar, and X. Huang, Phys.
Rev. D 91, 084011 (2015), 1411.2263.
M. Baryakhtar, R. Lasenby, and M. Teo, Phys. Rev. D
96, 035019 (2017), 1704.05081.
M. J. Stott and D. J. E. Marsh, Phys. Rev. D 98,
083006 (2018), 1805.02016.
H. Davoudiasl and P. B. Denton, Phys. Rev. Lett. 123,
021102 (2019), 1904.09242.
M. A. Latif and A. Ferrara, Publications of the
Astronomical Society of Australia 33, e051 (2016),
1605.07391.
E. W. Kolb, A. Notari, and A. Riotto, Phys. Rev. D
68, 123505 (2003), hep-ph/0307241.
F. Wilczek, arXiv e-prints hep-ph/0408167 (2004), hepph/0408167.
H. Trac, R. Cen, and P. Mansfield, Astrophys. J. 813,
54 (2015), 1507.02685.
The maximum temperature is larger (in some models by
orders of magnitude) than the reheat temperature [e.g.
112].
In this strongly interacting ‘axiverse’ scenario, any
post-inflation ALP likely cannot have multiple nondegenerate vaccua to avoid a domain wall catastrophe. Thus, the ALPs with non-degenerate vaccua would
come into existence before inflation and have a small
misalightment angle coherent over the cosmological volume so that they do not overclose the Universe, which
perhaps could occur because of the anthropic principle
[113]. For our results to apply of course, the ALPs that
dominate the dark matter density would have to come
into existence after inflation.
That the isocurvature transfer function limits to unity
at high-k is true for the dark matter/ALP transfer function. Whereas the total matter transfer function will
be lower due to the effects of Jeans smoothing on the
baryons.
We have checked that the results are not sensitive to
the choice of the mass function by also investigating a
mass function specifically calibrated to simulations at
high redshift [114].
This effect may weaken our constraints from the galaxy
luminosity function if lower mass galaxies are substantially dust absorbed.
The full dependence on redshift and virial temperaturehfor the adiabatic case is roughly fcoll
(> Tvir ) =

 −1/2 i
−1
erfc 2.04 × Z10 ln 4.6 × Z10 Tvir,4
, but the logarithmic dependence only adds a small correction to the
redshift evolution.
The star formation rate density in our model peaks
at around 2 × 10−4 M yr−1 Mpc−3 at redshift
of 15, and falls off towards higher redshifts (e.g.
10−6 M yr−1 Mpc−3 at redshift of 35), behaviour quantitatively very similar to that found in [61]. This is true
despite different star formation efficiency assumed in our
model compared to [61], because the minimum mass in
which molecular cooling can lead to Pop-III star formation is lower in our model, compared to the that of
[61]. In [61] the numeric value of the minimum mass
is obtained from CDM simulations and corresponds to
roughly Tvir = 1000 K. See Eqn. 17 as the minimum
does not just set the absolute minimum but also what

16
halos are affected by the Lyman-Werner background.
[122] This is the efficiency one expects from assuming that
each 105 M halo hosts one (ten) 100 M stars, and it
further takes the efficiency to scale with halo mass.
[123] Our expression for the heating power from each halo

is equal to the cross section for Bondi-Hoyle accretion
times the kinetic energy density of the accreted gas
times the velocity offset.

