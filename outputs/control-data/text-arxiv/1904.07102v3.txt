AN INFINITESIMAL VARIANT OF GUO-JACQUET TRACE FORMULA I: THE
CASE OF (GL2n,D , GLn,D × GLn,D )

arXiv:1904.07102v3 [math.NT] 30 Apr 2021

HUAJIE LI

Abstract. We establish an inﬁnitesimal variant of Guo-Jacquet trace formula for the case of (GL2n,D ,
GLn,D × GLn,D ). It is a kind of Poisson summation formula obtained by an analogue of Arthur’s
truncation process. It consists in the equality of the sums of two types of distributions which are nonequivariant in general: one type is associated to rational points in the categorical quotient, while the
other type is the Fourier transform of the ﬁrst type. For regular semi-simple points in the categorical
quotient, we obtain weighted orbital integrals.

Contents
1. Introduction
2. Notation
3. The symmetric pair
4. Integrability of the modified kernel
5. Exponential polynomial distributions
6. Non-equivariance
7. An infinitesimal trace formula for Matp×q,D ⊕ Matq×p,D //GLp,D × GLq,D
8. The second modified kernel
9. Weighted orbital integrals
References

1
4
6
9
21
30
33
34
38
41

1. Introduction
The Guo-Jacquet conjecture proposed in [10] is a possible generalisation in higher dimensions of
Waldspurger’s well-known theorem on central values of automorphic L-functions for GL2 . We briefly
recall it as follows. Let E/F be a quadratic extension of number fields and η the quadratic character of
A× /F × attached to it, where A denotes the ring of adèles of F . Consider the group G = GL2n and its
subgroup H = GLn × GLn defined over F . Let π be a cuspidal automorphic representation of G(A) with
trivial central character. We say that π is H-distinguished if the two linear forms (called “periods”) on
it
Z
φ(h)dh
PH : φ 7→
H(F )Z(A)\H(A)

and

PH,η : φ 7→

Z

φ(h)η(det(h))dh

H(F )Z(A)\H(A)

are both non-zero, where Z denotes the centre of G. This property is directly connected with the nonvanishing of some central L-values (see Friedberg-Jacquet’s work [9]). We also need to deal with another
pair of groups. Let X(E) denote the set of isomorphic classes of quaternion algebras D/F in which E
embeds. For any D ∈ X(E), let GD = GLn,D be the algebraic group defined over F whose F -points are
GLn (D) and HD = ResE/F GLn,E be its subgroup. Let πD be a cuspidal automorphic representation of
GD (A) with trivial central character. We say that πD is HD -distinguished if the linear form on it
Z
φ(h)dh,
PHD : φ 7→
HD (F )Z(A)\HD (A)

is not zero, where we identify the centre of GD with Z. One part of the Guo-Jacquet conjecture says
that if πD is HD -distinguished and π is transferred from πD by the Jacquet-Langlands correspondence,
Date: May 4, 2021.
1

then π is H-distinguished. We can also expect a converse at least when n is odd. For n = 1, these were
known by Waldspurger [20] and reproved by Jacquet [13].
Now we formally describe the approach of relative trace formulae following Jacquet [13]. This was
adopted by Feigon-Martin-Whitehouse [8] to obtain some partial results. Let f G be a smooth function on
G(A) with compact support. As an analogue of Arthur-Selberg trace formula, the relative trace formula
for the case (G, H) roughly says that there are two ways to write the integral (viewed as a distribution)
Z
Z
Kf G (x, y)η(det(x))dxdy,
H(F )\H(A)∩G(A)1

H(F )\H(A)∩G(A)1

P
where G(A)1 denotes the elements in G(A) with absolute-value-1 determinant and Kf G (x, y) = γ∈G(F )
f G (x−1 γy). The geometric side is expected to be a sum of relative (weighted) orbital integrals while
the spectral side should be an expansion of periods. Similarly there is also another formula for the
case of (GD , HD ). Then the comparison of periods of different pairs of groups predicted by the GuoJacquet conjecture is reduced to the comparison of relative (weighted) orbital integrals, for which there
are already some works such as Guo’s fundamental lemma [10] and Zhang’s transfer [25].
However, we have neglected analytic difficulty in the above discussion. That is to say, the double
integral above is not convergent and neither are two ways of its expansions. This is the reason why some
restrictive local conditions are needed in the main results of [8] though they seem kind of artificial. The
aim of this article is to solve this kind of problem at the level of Lie algebras for the case of (G, H).
Notice that such a double integral can be formally written as a single integral
Z
Kf G/H (x)η(det(x))dx,
R

H(F )\H(A)∩G(A)1

where f G/H (x) = H(A)∩G(A)1 f G (xy)dy defines a smooth function on (G/H)(A) with compact support
P
and Kf G/H (x) = γ∈(G/H)(F ) f G/H (x−1 γx). Replacing the symmetric space G/H by its tangent space
s ≃ gln ⊕ gln at the neutral element, we are faced with the divergence of the integral
Z
kf (x)η(det(x))dx,
H(F )\H(A)∩G(A)1

P
where f is a Bruhat-Schwartz function on s(A) and kf (x) = γ∈s(F ) f (x−1 γx).
Our main results can be described as follows.
First of all, as in [2], we replace kf (x) with some explicit kfT (x) (see its definition in (4.0.1) and (4.2.2))
to make the last integral absolutely convergent, where T ∈ R2n is a truncation parameter. Moreover,
there is a relation of equivalence on s(F ) defined by the categorical quotient s//H; we denote by O the
T
set of classes of equivalence. For each class o ∈ O, we define kf,o
(x) and its integral similarly by replacing
s(F ) with o. Then we have
X
T
kfT (x) =
kf,o
(x),
o∈O

and prove the following theorem which gives the geometric expansion of
Z
kfT (x)η(det(x))dx.
H(F )\H(A)∩G(A)1

Theorem 1.1 (see Theorem 4.14). For T in a suitable cone in R2n ,
XZ
T
kf,o
(x)η(det(x))dx
o∈O

H(F )\H(A)∩G(A)1

is absolutely convergent.

Moreover, we see that each summand in the geometric expansion is a sum of products of polynomials
and exponential functions in T . In fact, most (namely regular semi-simple) terms are simply polynomial
distributions.
Theorem 1.2 (see Corollary 5.9). For T in a suitable cone in R2n and each o ∈ O, define
Z
T
T
kf,o
(x)η(det(x))dx.
Jo (η, f ) :=
H(F )\H(A)∩G(A)1

JoT (η, f )

Then T 7→
is the restriction of an exponential polynomial in T . In particular, if o is regular
semi-simple, it is the restriction of a polynomial in T .
2

This property allows us to take the constant term Jo (η, f ) of JoT (η, f ) to eliminate the truncation
parameter. In the infinitesimal setting, the geometric expansion of the Fourier transform of f plays the
role of the original spectral side (cf. [5]). Our infinitesimal variant of Guo-Jacquet trace formula equating
the geometric developments of f and its Fourier transform (defined by (3.5.2) and denoted by fˆ) is the
following, which essentially comes from the Poisson summation formula.
Theorem 1.3 (see Theorem 7.1). For a Bruhat-Schwartz function f on s(A), we have the equality
X
X
Jo (η, f ) =
Jo (η, fˆ).
o∈O

o∈O

Such a formula should be of interest for at least two reasons. For one thing, since this formula is close
to but easier than its analogue for the symmetric space, it gives us a clue to the original relative trace
formula (cf. Zydor’s work [27] on Jacquet-Rallis trace formulae). For another, a simplified version of
this formula (see [25, Theorem 8.4 and p. 1875]) has been used in Zhang’s proof of the smooth transfer.
The distributions Jo (η, ·) on s(A) that we obtained are non-equivariant under the conjugation of
H(A) ∩ G(A)1 in general, which is close to the situation in [2] and different from that in [26]. In fact,
we have the following formula of non-equivariance. The lack of equivariance may add difficulty to the
comparison of Guo-Jacquet trace formulae (cf. [4, §22]).
Proposition 1.4 (see Corollary 6.2). For a Bruhat-Schwartz function f on s(A) and y ∈ H(A) ∩ G(A)1 ,
we denote f y (x) := f (yxy −1 ). Then
X
η
Jo (η, f y ) = η(det(y))
JoQ (η, fQ,y
),
Q

where the sum on Q runs over all ω-stable relatively standard parabolic subgroups of G (defined in Section
η
5.2). Here JoQ (η, ·) is an analogue of Jo (η, ·) with G replaced by Q, and fQ,y
is defined by (6.0.1) with
s = 0.
Nevertheless, we can write regular semi-simple terms as explicit weighted orbital integrals whose
weights are the restriction to H(A) of Arthur’s in [2] for G(A).
Theorem 1.5 (see Theorem 9.2). Let o ∈ O be a regular semi-simple class, P1 an ω-stable relatively
standard parabolic subgroup of G and X1 ∈ o an elliptic element relative to P1 (defined in Section 9.2).
For a Bruhat-Schwartz function f on s(A), we have
Z
f (x−1 X1 x)vP1 (x)η(det(x))dx,
Jo (η, f ) = vol([HX1 ]) ·
HX1 (A)\H(A)

where HX1 denotes the centraliser of X1 in H, vol([HX1 ]) is its associated volume and vP1 (x) is the
volume of some convex hull.
This paper is organised in the following way. Section 2 and 3 are devoted to standard notation
in Arthur’s work on trace formulae and characterisation of O in the specific symmetric pair that we
T
consider respectively. We define the truncated kernel kf,o
(x) and prove its integrability in Section 4.
This key definition is partly inspired by [12] [26] [6] (for the decomposition of groups) and [16] (for the
decomposition of linear spaces) apart from Arthur’s pioneering work [2] and its Lie algebra variant [5].
Section 5 is about the quantitive behaviour of our distributions with respect to the truncation parameter
T . In Section 6, we study their variance under the conjugation of H(A) ∩ G(A)1 . In Section 7, the
infinitesimal Guo-Jacquet trace formula for the case of (GL2n , GLn × GLn ) is given. Section 8 and 9
aim to express the regular semi-simple distribution as weighted orbital integrals.
Here are two final remarks. Firstly, actually we study the more general symmetric pair (GLp+q,D ,
GLp,D × GLq,D ) instead of (GL2n , GLn × GLn ) and add an extra term |Nrd(x1 )|sA to the integrand
in most of this article. Not only do we prefer more general results (including the case considered in
[24] for instance) or possible applications (cf. [17] for the study of the first derivative of L-functions),
but the study of the case where p = q and s = 0 also yields consideration on a more general setting
including the cases where p 6= q or s 6= 0 (see Theorem 5.8 for example). A simple reason for this comes
from the structure of the intersection of H and semi-standard Levi subgroups of G. Secondly, there are
some similarities between our case and the twisted trace formula (cf. [15]) for (GLn × GLn ) ⋊ σ where
σ exchanges two copies of GLn . In fact, we obtain the same weights for regular semi-simple orbits.
However, we shall see that more parabolic subgroups will be needed to define the truncation here. We
shall return to this discussion at the end of this paper.
3

Acknowledgement. I would like to express my great appreciation to my PhD advisor Professor PierreHenri Chaudouard for introducing me to this problem and valuable suggestions during my preparation
of this work. Part of this paper was revised during my visit to the Institute for Mathematical Sciences
at the National University of Singapore and I would like to thank their hospitality. This work was
supported by grants from Région Ile-de-France.
2. Notation
2.1. Roots and weights. Let F be a number field and G a reductive group defined over F . Denote
by ZG the centre of G. Fix a minimal Levi F -subgroup M0 of G. All the following groups are assumed
to be defined over F without further mention. We call a parabolic subgroup P of G semi-standard if
M0 ⊆ P . For any semi-standard parabolic subgroup P of G, we usually write MP for the Levi factor
containing M0 and NP the unipotent radical. Denote by AP the maximal F -split torus in the centre of
MP . Let X(MP )F be the group of characters of MP defined over F . Then define
aP := HomZ (X(MP )F , R)
and its dual space
a∗P := X(MP )F ⊗Z R,
which are both R-linear spaces of dimension dim(AP ). Notice that the restriction X(MP )F ֒→ X(AP )F
induces an isomorphism
a∗P ≃ X(AP )F ⊗Z R.
Suppose that P1 ⊆ P2 are a pair of semi-standard parabolic subgroups of G. The restriction
2
X(MP2 )F ֒→ X(MP1 )F induces a∗P2 ֒→ a∗P1 and its dual map aP1 ։ aP2 . Denote by aP
P1 the kernel
∗
∗
of the latter map aP1 ։ aP2 . The restriction X(AP1 )F ։ X(AP2 )F induces aP1 ։ aP2 and its dual map
aP2 ֒→ aP1 . The latter map aP2 ֒→ aP1 provides a section of the previous map aP1 ։ aP2 . Thus we have
decompositions
2
aP1 = aP2 ⊕ aP
P1
and
2 ∗
a∗P1 = a∗P2 ⊕ (aP
P1 ) .
2
When P1 is a minimal semi-standard parabolic subgroup, since aP1 (resp. AP1 ) and aP
P1 are independent
P2
of the choice of P1 , we write them as a0 (resp. A0 ) and a0 respectively.
2
For a pair of semi-standard parabolic subgroups P1 ⊆ P2 of G, write ∆P
P1 for the set of simple roots
P2
P2
2 ∗
for the action of AP1 on NP1 := NP1 ∩ MP2 . Notice that ∆P1 is a basis of (aP
P1 ) . Let

b P2 )∨ := {̟α∨ : α ∈ ∆P2 }
(∆
P1
P1

P2
2
be the basis of aP
P1 dual to ∆P1 . If B is a minimal semi-standard parabolic subgroup contained in P1 ,
P2
∨
∨
2
one has the coroot β ∨ associated to any β ∈ ∆P
B . For every α ∈ ∆P1 , let α be the projection of β to
P2
P2
P2
aP1 , where β ∈ ∆B whose restriction to aP1 is α. Such α∨ is independent of the choice of B. Define
P2
∨
2 ∨
(∆P
P1 ) := {α : α ∈ ∆P1 },
2
which is a basis of aP
P1 . Denote by

b P2 := {̟α : α ∈ ∆P2 }
∆
P1
P1

P2 ∨
2 ∗
the basis of (aP
P1 ) dual to (∆P1 ) .
For a semi-standard parabolic subgroup P of G, set

G
a+
P := {T ∈ aP : ∀α ∈ ∆P , α(T ) > 0}.

For P1 ⊆ P2 as above, define τPP12 and τbPP12 as the characteristic functions of
2
{T ∈ a0 : ∀α ∈ ∆P
P1 , α(T ) > 0}

and
respectively.

b P2 , ̟(T ) > 0}
{T ∈ a0 : ∀̟ ∈ ∆
P1
4

2.2. The functions HP and F P . Let A be the ring of adèles of F and | · |A the product of normalised
local absolute values on the group of idèles A∗ . Fix a maximal compact subgroup K of G(A) that is
admissible relative to M0 in the sense of [3, p. 9]. In this paper, we choose the standard maximal
compact subgroup for inner forms of GLn (see [22, p. 191 and 199] for example). More concretely,
suppose that G(F ) = GLn (D), where D is a central division algebra over F . For every place v of F ,
fix an isomorphism D ⊗F Fv ≃ glrv (Dv ), where Dv is a central division algebra over Fv . Under this
isomorphism, the completion at v of G(F ) is Gv ≃ GLnv (Dv ), where nv = nrv . For v a finite place of
F , let Kv ≃ GLnv (ODv ), where ODv is the ring of integers of Dv ; for v an infinite place of F , we choose
Kv to be the orthogonal group, unitary group and compact symplectic group Q
(see [11, Chapter 1.2.8] for
example) for Gv ≃ GLnv (R), GLnv (C) and GLnv (H) respectively; let K := v Kv . Suppose that P is
a semi-standard parabolic subgroup of G. If m ∈ MP (A), define HP (m) ∈ aP by
hHP (m), χi = log(|χ(m)|A )

1

for all χ ∈ X(MP )F . Write MP (A) for the kernel of HP and A∞
P for the neutral component for the
topology of R-manifolds of the group of R-points of the maximal Q-split torus in ResF/Q AP . Then
any element x ∈ G(A) can be written as x = nmak, where n ∈ NP (A), m ∈ MP (A)1 , a ∈ A∞
P and
k ∈ K. We can define a continuous map HP : G(A) → aP by setting HP (x) := HP (a) with respect to
this decomposition. Notice that HP induces an isomorphism from A∞
P to aP . If P ⊆ Q are a pair of
semi-standard parabolic subgroups, write
1
AQ,∞
:= A∞
P ∩ MQ (A) .
P

Then HP also induces an isomorphism from AQ,∞
to aQ
P
P.
Denote by ΩG the Weyl group of (G, A0 ). In the cases to be considered in this paper, for every s ∈ ΩG ,
we can always choose one representative ωs ∈ G(F )∩K. In fact, we are dealing with the case of G = GLn
or its inner forms, thus we can choose ΩG to be the group of permutation matrices. For an F -subgroup
H of G and s ∈ ΩG , we usually write sH := ωs Hωs−1 . Let P1 and P2 be a pair of semi-standard parabolic
subgroups of G. Denote by ΩG (aP1 , aP2 ) the (perhaps empty) set of distinct isomorphisms from aP1 to
aP2 obtained by restriction of elements in ΩG . Denote by ΩG (aP1 ; P2 ) the (perhaps empty) subset of
double classes in ΩMP2 \ΩG /ΩMP1 of elements s ∈ ΩG such that s(aP1 ) ⊇ aP2 . Suppose additionally
that P1 and P2 contain a common minimal semi-standard parabolic subgroup P0 of G. We can talk
about positive roots and standard parabolic subgroups with respect to P0 . By [15, Lemme 1.3.6], each
s ∈ ΩG (aP1 , aP2 ) admits a unique representative (still denoted by s) in ΩG such that s−1 α > 0 for all
G
2
α ∈ ∆P
P0 . By [15, Lemme 1.3.7], each s ∈ Ω (aP1 ; P2 ) admits a unique representative (still denoted by
P2
G
−1
s) in Ω such that s α > 0 for all α ∈ ∆P0 . If Q is a parabolic subgroup of G containing P1 ∪ P2 and
ΩMQ (aP1 , aP2 ) 6= ∅, we say that P1 and P2 are MQ -associated. There is a bijection between ΩG (aP1 ; P2 )
and the disjoint union of quotients ΩMP2 (aR , aR )\ΩG (aP1 , aR ) where R runs over standard parabolic
subgroups of G contained in P2 , modulo MP2 -association (see [15, Lemme 1.3.7]).
From the reduction theory (see [2, p. 941]), we know that there exists a real number t0 < 0 and a
compact subset ̺B ⊆ NB (A)M0 (A)1 for each minimal semi-standard parabolic subgroup B of G such
that for any semi-standard parabolic subgroup P of G containing B, we have
G(A) = P (F )SP
B (̺B , t0 ).
Here the Siegel set SP
B (̺B , t0 ) is defined by
∞
SP
B (̺B , t0 ) := ̺B AB (P, t0 )K,

where
∞
P
A∞
B (P, t0 ) := {a ∈ AB : ∀α ∈ ∆B , α(HB (a)) > t0 }.
We shall fix such t0 and ̺B . Additionally, we are authorised to assume that ̺sB = ωs ̺B ωs−1 for s ∈ ΩG .
Moreover, we require that (MP (A) ∩ ̺B , MP (A) ∩ K, B ∩ MP , t0 ) will play the role of (̺B , K, B, t0 ) for
any semi-standard parabolic subgroup P of G containing B.
Let B ⊆ P and t0 be as above. For T ∈ a0 , define the truncated Siegel set
∞
SP
B (̺B , t0 , T ) := ̺B AB (P, t0 , T )K,

where
∞
bP
A∞
B (P, t0 , T ) := {a ∈ AB (P, t0 ) : ∀̟ ∈ ∆B , ̟(HB (a) − T ) ≤ 0}.
1
P
It is known that A∞
B (P, t0 , T )∩MP (A) has compact closure (see [15, Lemme 1.8.1]). Denote by FB (·, T )
P
the characteristic function of the projection of SB (̺B , t0 , T ) to P (F )\G(A).
5

2.3. Bruhat-Schwartz functions and Haar measures. Write g for the Lie algebra of G. For an
F -linear subspace s of g, denote by S(s(A)) the Bruhat-Schwartz space of s(A), namely the C-linear
space of functions on s(A) generated by f∞ ⊗ χ∞ , where f∞ is a Schwartz function on s(F ⊗Q R) and
χ∞ is the characteristic function of an open compact subset of s(A∞ ), where we denote by A∞ the ring
of finite adèles of F .
Let P be a semi-standard parabolic subgroup of G. For every algebraic subgroup V of NP (resp. every
subspace h of g), choose the unique Haar measure on V (A) (resp. on h(A)) such that vol(V (F )\V (A)) = 1
(resp. vol(h(F )\h(A)) = 1). We also take the Haar measure on K such that vol(K) = 1.
Fix a Euclidean norm k · k on a0 invariant by the group ΩG and Haar measures on all subspaces of a0
compatible with this norm. If P ⊆ Q are a pair of semi-standard parabolic subgroups, we obtain Haar
Q,∞
measures on A∞
via the isomorphism HP .
P and AP
G ∗
Denote by ρP ∈ (aP ) the half of the sum of weights (with multiplicities) for the action of AP on
nP . We choose compatible Haar measures on G(A) and its Levi subgroups by requiring that for any
f ∈ L1 (G(A)),
Z
Z
Z
Z
f (x)dx =
f (nmk)e−2ρP (HP (m)) dndmdk
G(A)
N (A) M (A) K
Z P Z P
Z
Z
=
f (nmak)e−2ρP (HP (a)) dndmdadk.
NP (A)

MP (A)1

A∞
P

K

3. The symmetric pair
Let F be a number field and D a central division algebra over F . Let d be the degree of D, i.e.,
dimF (D) = d2 . Denote by GLn,D the reductive group over F whose F -points are GLn (D). For x ∈
GLn (D), we write Nrd(x) for its reduced norm, Trd(x) for its reduced trace and Prdx for its reduced
characteristic polynomial. For x ∈ GLp (D) × GLq (D), denote by x1 (resp. x2 ) its projection to the
first (resp. second) component. Until further notice, we shall work in a more general setting than that
of Guo-Jacquet for later use, i.e., we shall study the case of (GLp+q,D , GLp,D × GLq,D ) and add an
additional term |Nrd(x1 )|sA in the integral of the modified kernel.
by diagonal
3.1. Groups and linear spaces. Let G := GLp+q,D and H := GLp,D ×GL

 q,D its subgroup
1
0
p
. Thus H = Gθ ,
embedding. Define an involution θ on G by θ(g) = ǫgǫ−1 , where ǫ =
0 −1q
where Gθ denotes the θ-invariant subgroup of G.
Define an anti-involution ι on G by ι(g) = θ(g −1 ). Denote by S the ι-invariant subvariety of G. There
is a symmetrization map
s : G → S, s(g) := gι(g),
by which one can regard the symmetric space G/H as a subvariety of S. We see that H × H acts on G
by left and right translation and that H acts on S by conjugation.
Let g := Lie(G) and h := Lie(H). Denote by dθ the differential of θ. Thus
h = {X ∈ g : (dθ)(X) = X}.
Let s be the tangent space of S at the neutral element. We shall always view s as a subspace of g. Then
s = {X ∈ g : (dθ)(X) = −X},
and





0 A
: A ∈ Matp×q (D), B ∈ Matq×p (D) ≃ Matp×q (D) ⊕ Matq×p (D).
B 0
There is an H(F )-action on s(F ) by conjugation, i.e.,
s(F ) =

−1
(h1 , h2 ) · (A, B) = (h1 Ah−1
2 , h2 Bh1 ).

3.2. Semi-simple elements. We say that an element X ∈ s is semi-simple if the orbit H · X is Zariski
closed in s. By a regular element X ∈ s, we mean that the stabiliser HX has minimal dimension.
Proposition 3.1. An element X of s(F ) is semi-simple if
element of the form

0 0 1m
 0 0 0
X(A) := 
 A 0 0
0 0 0
6

and only if it is H(F )-conjugated to an

0
0 

0 
0

with A ∈ GLm (D) being semi-simple in the usual sense. More precisely, the set of H(F )-conjugacy
classes of semi-simple elements of s(F ) is bijective to the set of pairs (m, {A}) where 0 ≤ m ≤ min{p, q}
is an integer and {A} is a semi-simple conjugacy class in GLm (D). Moreover, X(A) is regular semisimple if and only if m = min{p, q} and A is regular semi-simple in GLmin{p,q} (D) in the usual sense.
Proof. The case D = F is [14, Proposition 2.1 and Lemma 2.1] while the case p = q is [24, Proposition
5.2]. This proposition is nothing but a slightly more general one combining both cases, whose proofs are
similar and still work here.




A
∈ s is regular semi-simple if and only if PrdAB is
0


0 A
separable and PrdAB (0) 6= 0. If p > q, an element
∈ s is regular semi-simple if and only if
B 0
PrdBA is separable and PrdBA (0) 6= 0.
Proposition 3.2. If p ≤ q, an element

0
B

Proof. We only consider the case p ≤ q since the other case can be deduced by symmetry. We may study
the proposition over an algebraic closure F of F . For A ∈ Matdp×dq (F ) and B ∈ Matdq×dp (F ), we see
that



0 A
(3.2.1)
det λId(p+q) −
= λd(q−p) det(λ2 Idp − AB).
B 0



0 A
∈ s and denote by PrdX the reduced polynomial of X viewed as an element of g.
B 0
Then PrdX and PrdAB determine each other.
Suppose that PrdAB is separable and PrdAB (0) 6= 0. Let X = Xs + Xn be the Jordan decomposition
in g, where Xs is semi-simple, Xn is nilpotent and Xs Xn = Xn Xs . By the uniqueness of the Jordan
decomposition,
 we see thatXs , Xn ∈ s. From Proposition 3.1, up to conjugation by H, we may suppose
0 1dp 0
that Xs =  C
0 0 , where C ∈ GLdp (F ) is semi-simple. Since PrdX = PrdXs , we deduce that
0
0 0
PrdAB = PrdC . Then PrdC is separable and PrdC (0) 6= 0 by our assumption. By linear algebra, C is
regular semi-simple in GLdp (F ), which implies that Xs ∈ s is regular semi-simple by
 Proposition 3.1.

0
D 0
Since Xs Xn = Xn Xs , simple computation (cf. [14, Lemma 2.1]) shows that Xn =  DC 0 0 ,
0
0 0
where D ∈ gldp (F ) and DC = CD. On the one hand, because Xn is nilpotent and C is invertible, we see
that D is nilpotent. On the other hand, because DC = CD and C is regular semi-simple, we see that D
is semi-simple. Hence, we have D = 0 and thus Xn = 0. Therefore, X = Xs ∈ s is regular semi-simple.
The other direction is a direct consequence of Proposition 3.1.

Let X :=

3.3.
Denote by c the affine space Ad min{p,q} . Define a morphism π : s → c by mapping
 Invariants.

0 A
∈ s to the coefficients of the reduced characteristic polynomial of AB. It is constant on
B 0
H-orbits. Denote by crs the subset of (ci )0≤i≤d min{p,q}−1 ∈ c such that the polynomial
d min{p,q}−1

P (λ) := λd min{p,q} +

X

ci λi

i=0

is separable and c0 6= 0. It is a principal Zariski open subset of c. Denote by c× the subset of
(ci )0≤i≤d min{p,q}−1 ∈ c such that c0 6= 0. Then crs ⊆ c× .
Proposition 3.3. The pair (c, π) defines a categorical quotient of s by H over F .
Proof. It suffices to consider the case p ≤ q since the case p > q can be obtained by symmetry.
We first extend the base field to an algebraic closure F of F . Then HF ≃ GLdp,F × GLdq,F and
sF ≃ Matdp×dq,F ⊕ Matdq×dp,F . For (ci )0≤i≤dp−1 ∈ cF , denote by A((ci )0≤i≤dp−1 ) ∈ GLpd its companion
7

matrix



0
 1


A((ci )0≤i≤dp−1 ) := 
 0
 .
 ..

0
0
1
..

.
0 ···

···
···
..
.
..

.
0

Define a morphism cF → sF by mapping (ci )0≤i≤dp−1 to

0
1dp
 A((ci )0≤i≤dp−1 ) 0
0
0

0
0
..
.

−c0
−c1
−c2
..
.

0
1 −cdp−1






.





0
0 .
0

This is a section of π, so π is surjective. By Propositions 3.2 and 3.1, the fibre of any point in the
non-empty open subset cF ,rs ⊆ cF contains exactly one closed orbit. We may use Igusa’s criterion (see
[18, Theorem 4.13] and Remark 3.4 below) to show that the pair (cF , π) defines a categorical quotient
of sF by HF .
The morphism π : s → c defined over F factors through the categorical quotient Spec(F [s]H ) of s by
H over F . This induces a dual morphism F [c] → F [s]H of F -algebras. We have shown that after the
base change to F , it is an isomorphism of F -algebras. By Galois descent, we deduce that the morphism
F [c] → F [s]H is an isomorphism of F -algebras, i.e., the pair (c, π) defines a categorical quotient of s by
H over F .

Remark 3.4. We notice that cF can be of dimension 1 (when D = F and min{p, q} = 1) in the proof of
Proposition 3.3 above, so the first condition in [18, Theorem 4.13] may not be satisfied. However, as is
evident from the proof of Igusa’s criterion, this condition can be replaced with the surjectivity of π.
The categorical quotient (c, π) defines a relation of equivalence on s(F ), where two elements are in
the same class if and only if they have the same image under π. We denote by O the set of equivalent
classes for this relation. By Proposition 3.1, two semi-simple elements of s(F ) belong to the same class
of O if and only if they are conjugate by H(F ). Denote by Ors the subset of O with images in crs . By
Proposition 3.2, each class in Ors is a regular semi-simple H(F )-orbit in s(F ). Denote by O× the subset
of O with images in c× . Then Ors ⊆ O× .
3.4. Relatively standard parabolic subgroups. Fix Pe0 a minimal parabolic subgroup of H defined
over F and M0 a Levi factor of Pe0 defined over F . Then M0 is also a minimal Levi subgroup of G defined
over F . For a semi-standard parabolic subgroup P of G (namely M0 ⊆ P ), we say that P is “relatively
standard” if Pe0 ⊆ P , i.e., P ∩ H is a standard parabolic subgroup of H (namely Pe0 ⊆ P ∩ H). We shall
suppose that ̺Pe0 ⊆ ̺B for all relatively standard minimal parabolic subgroup B of G. Denote by K the
standard maximal compact subgroup of G(A) and by KH := H(A) ∩ K the maximal compact subgroup
of H(A). Up to conjugation by G(F ), we may assume that M0 is the subgroup of diagonal matrices in
G and that Pe0 is the product of groups of upper triangular matrices.
We can describe the embedding H ֒→ G via D-bimodules. Let V := he1 , · · ·, ep iD (resp. W :=
hf1 , · · ·, fq iD ) be the free D-bimodule generated by the basis {e1 , · · ·, ep } (resp. {f1 , · · ·, fq }). Set GL(V )
to be the group of F -linear automorphisms on V, which acts on V on the left. Denote by GL(V )D the
subgroup of GL(V ) which respects the right D-module structure on V . Put G := GL(V ⊕ W )D and
H := GL(V )D × GL(W )D . Then M0 is the stabiliser in G (or in H) of the D-lines hei iD , 1 ≤ i ≤ p and
hfi iD , 1 ≤ i ≤ q. Suppose that Pe0 is the direct product of the stabiliser in GL(V )D of the flag
0 ( he1 iD ( he1 , e2 iD ( · · · ( he1 , · · ·, ep iD =: V

and the stabiliser in GL(W )D of the flag
0 ( hf1 iD ( hf1 , f2 iD ( · · · ( hf1 , · · ·, fq iD =: W.
A relative standard parabolic subgroup P of G can be interpretated as the stabiliser in G of the flag
0 ( he1 , · · ·, ep1 , f1 , · · ·, fq1 iD ( he1 , · · ·, ep1 , f1 , · · ·, fq1 , ep1 +1 , · · ·, ep1 +p2 , fq1 +1 , · · ·, fq1 +q2 iD
( · · · ( he1 , · · ·, ep1 , f1 , · · ·, fq1 , · · ·, ep−pl +1 , · · ·, ep , fq−ql +1 , · · ·, fq iD =: V ⊕ W,
8

where

l
P

pi = p,

i=1

l
P

qi = q and we allow pi or qi to be zero. In particular, we have

i=1

MP ≃ GLp1 +q1 ,D × · · · × GLpl +ql ,D

and
MPH ≃ GLp1 ,D × · · · × GLpl ,D × GLq1 ,D × · · · × GLql ,D .
Proposition 3.5. Let P be a relative standard parabolic subgroup of G. For all X ∈ (mP ∩ s)(F ) and
U ∈ (nP ∩ s)(F ), we have
π(X) = π(X + U ).
Proof. It is a consequence of [16, Lemma 2.1]. We can also give a direct proof as follows. Because of
(3.2.1), for any X ∈ s(F ), π(X) is determined by the coefficients of the reduced characteristic polynomial
of X regarded as an element of g(F ). The proposition follows from the easy fact: for X ∈ mP (F ) and
U ∈ nP (F ), the reduced characteristic polynomial of X + U is equal to that of X.

Corollary 3.6. Let P be a relative standard parabolic subgroup of G and o ∈ O. For all subsets
S1 ⊆ (mP ∩ s)(F ) and S2 ⊆ (nP ∩ s)(F ), we have o ∩ (S1 ⊕ S2 ) = (o ∩ S1 ) ⊕ S2 .
3.5. Fourier transform. Fix a nontrivial unitary character Ψ of A/F . Let h·, ·i be the non-degenerate
H(A)-invariant bilinear form on s(A) defined by
hX1 , X2 i := Trd(X1 X2 )

(3.5.1)

for all X1 , X2 ∈ s(A). For f ∈ S(s(A)), its Fourier transform fˆ ∈ S(s(A)) is defined by
Z
b :=
b
(3.5.2)
fˆ(X)
f (X)Ψ(hX, Xi)dX
s(A)

b ∈ s(A).
for all X

4. Integrability of the modified kernel

Fix a minimal semi-standard parabolic subgroup P0 of G. For any semi-standard parabolic subgroup
P of G and T ∈ a0 , denote by TP the projection of sT in aP , where s is any element in ΩG such that
sP0 ⊆ P . Notice that this definition is independent of the choice of s.
For a semi-standard parabolic subgroup P of G, x ∈ G(A) and T ∈ a0 , define
P
(x, TsP0 ),
F P (x, T ) := FsP
0

where s is any element in ΩG such that sP0 ⊆ P .
Lemma 4.1. The above definition of F P (x, T ) is independent of the choice of s.
Proof. For any s ∈ ΩG and any minimal semi-standard parabolic subgroup B ⊆ P , since we choose
ωs ∈ G(F ) ∩ K, we have
sP
FsB
(x, T ) = FBP (ωs−1 x, s−1 T ).
Let s, s′ ∈ ΩG be such that sP0 , s′ P0 ⊆ P . Then s′ s−1 ∈ ΩMP . By the last equality and the left
P
MP (F )-invariance of FsP
(·, TsP0 ), we have
0
P
′
(ωs−1
FsP′ P0 (x, Ts′ P0 ) = FsP
′ s−1 x, ss
0

−1

P
(x, TsP0 ).
Ts′ P0 ) = FsP
0

This completes the proof of the lemma.



Let f ∈ S(s(A)), P be a relatively standard parabolic subgroup of G and o ∈ O. Write PH := P ∩ H.
For x ∈ MPH (F )NPH (A)\H(A), define
Z
X
kf,P,o (x) :=
f (x−1 (X + U )x)dU.
X∈mP (F )∩o

(nP ∩s)(A)

For T ∈ a0 and x ∈ H(F )\H(A), define
X
T
(4.0.1)
kf,o
(x) :=
(−1)dim(AP /AG )
e0 ⊆P }
{P :P

X

δ∈PH (F )\H(F )

τbPG (HP (δx) − TP ) · kf,P,o (δx).

We know that the sum over δ ∈ PH (F )\H(F ) is finite from the following lemma.
9

Lemma 4.2. Let P be a semi-standard parabolic subgroup of G. For all x ∈ G(A) and T ∈ aP , the sum
X
τbPG (HP (δx) − T )
δ∈P (F )\G(F )

is finite.

Proof. This is a particular case of [2, Lemma 5.1].



4.1. Reduction theory.
Lemma 4.3. There exists a point T+ ∈ a+
P0 such that for any semi-standard parabolic subgroup Q of
G, any minimal semi-standard parabolic subgroup B of G contained in Q, any T ∈ T+ + a+
P0 and any
x ∈ G(A), we have
X
X
F P (δx, T )τPQ (HP (δx) − TP ) = 1.
{P :B⊆P ⊆Q} δ∈P (F )\Q(F )

Proof. This is [2, Lemma 6.4] in our case.



We shall fix such a T+ . If T ∈ T+ + a+
P0 , we shall say that T is sufficiently regular.
Lemma 4.4. For any relatively standard parabolic subgroup Q of G, any sufficiently regular T and any
x ∈ H(A), we have
X
X
F P (δx, T )τPQ (HP (δx) − TP ) = 1.
e0 ⊆P ⊆Q} δ∈PH (F )\QH (F )
{P :P

This is an analogue of [26, Proposition 2.3] whose proof relies on [12, (2.5) in p. 674] (cf. Lemma
4.11 below). It is essentially a restricted form to x ∈ H(A) from Lemma 4.3 for x ∈ G(A). We can
give a proof close to the steps in an early version of [26], which reflects that a main complexity of the
truncation here arises from the fact that none of the Siegel sets of H is contained in any Siegel set of
G, as mentioned in [12]. However, we shall adopt alternatively the point of view in [6] to give a more
conceptual proof here, which might be useful in other relative trace formulae as well.
First we introduce a variant (see [6, §1.5]) of some concepts and results in [6, §2] without reproducing
proofs. We say that a semi-standard parabolic subgroup Q of G is standard if P0 ⊆ Q. For P ⊆ Q a pair
of standard parabolic subgroups of G, denote by ρQ
P the half of the sum of weights (with multiplicities)
+
for the action of AP on nP ∩ mQ . We denote by a+
P0 the closure of aP0 in a0 .
Definition 4.5. For g ∈ G(A), Q a standard parabolic subgroup of G and T ∈ a+
P0 , we define the degree
of T -instability of g with respect to Q by the following formula
Q
degQ
T (g) := maxhρP , HP (δg) − T i
(P,δ)

where (P, δ) runs over the pairs of a standard parabolic subgroup P ⊆ Q and an element δ ∈ P (F )\Q(F ).
By Lemma 4.2, we know that the supremum of hρQ
P , HP (δg) − T i in the definition is finite and
attainable.
Lemma 4.6 (cf. [6, Lemme 2.2.1]). Let g ∈ G(A), Q be a standard parabolic subgroup of G and T ∈ a+
P0 .
The following two conditions are equivalent:
(1) degQ
T (g) ≤ 0;
b Q , we have h̟, HP (δg)−T i ≤
(2) for all parabolic subgroup P ⊆ Q, all δ ∈ P (F )\Q(F ) and all ̟ ∈ ∆
P
0.

Definition 4.7. Let g ∈ G(A) and T ∈ a+
P0 . We say that a pair (P, δ) of a standard parabolic subgroup
P ⊆ G and an element δ ∈ P (F )\G(F ) is T -canonical for g if it satisfies the following two conditions:
G
(1) hρG
P , HP (δg) − T i = degT (g);
G
(2) for any parabolic subgroup Q ⊇ P such that hρG
Q , HQ (δg) − T i = degT (g), we have Q = P .

Lemma 4.8 (cf. [6, Lemme 2.3.2]). Let g ∈ G(A) and T ∈ a+
P0 . Then (P, δ) is a T -canonical pair for g
if and only if it satisfies the following two conditions:
(1) degP
T (δg) ≤ 0;
(2) for any α ∈ ∆G
P , we have hα, HP (δg) − T i > 0.
10

Proposition 4.9 (cf. [6, Proposition 2.4.1]). Let g ∈ G(A) and T ∈ a+
P0 . Then there exists a unique
T -canonical pair for g.
Let T ∈ a0 and Q be a standard parabolic subgroup of G. Define Fe Q (·, T ) as the characteristic
function of g ∈ G(A) such that degQ
T (g) ≤ 0.

Proposition 4.10 (cf. [6, Proposition 2.5.1]). For g ∈ G(A), Q a standard parabolic subgroup of G and
T ∈ a+
P0 , we have
(1)
X
X
Fe P (δg, T )τ Q (HP (δg) − TP ) = 1;
P

{P :P0 ⊆P ⊆Q} δ∈P (F )\Q(F )

(2)

Fe Q (g, T ) =

X

(−1)dim(AP /AQ )

X

δ∈P (F )\Q(F )

{P :P0 ⊆P ⊆Q}

τbPQ (HP (δg) − TP ).

Since we have similar formulae for F Q (·, T ) for sufficiently regular T (see Lemma 4.3), we know that
F (·, T ) = FPQ0 (·, T ) for such T . Now we can return to the proof of Lemma 4.4.
eQ

Proof of Lemma 4.4. It is noticeable that the identity is reduced to its analogues for semi-standard Levi
factors of Q, which is a product of GLpi +qi ,D whose intersection with H is GLpi ,D ×GLqi ,D . By induction
on the rank of G, it suffices to prove the identity for Q = G.
For a standard parabolic subgroup P of G, fix a set of representatives ΩP,G in {s ∈ ΩG |Pe0 ⊆ s−1 P }
MP
. We can rewrite the equality in the lemma as
for the relation s1 ∼ s2 if and only if s2 s−1
1 ∈ Ω
X
X
X
FPP0 (ωs δx, TP0 )τPG (HP (ωs δx) − TP ) = 1.
{P :P0 ⊆P } s∈ΩP,G δ∈(s−1 P )H (F )\H(F )

In fact, this follows from
−1

Fs

P

−1

(δx, T ) = Fss−1 PP0 (δx, Ts−1 P0 ) = FPP0 (ωs δx, TP0 )

and
τsG−1 P (Hs−1 P (δx) − Ts−1 P ) = τPG (HP (ωs δx) − TP ).
Combining the double sums over s and δ, we claim that the equality above is equivalent to
X
X
FPP0 (δx, TP0 )τPG (HP (δx) − TP ) = 1.
{P :P0 ⊆P } δ∈P (F )\P (F )ΩG H(F )

In fact, for any s ∈ ΩP,G , consider the map

(s−1 P )H (F )\H(F ) → P (F )\P (F )ΩG H(F ), δ 7→ ωs δ.
Firstly, it is well-defined: if δ1 = ωs−1 pωs δ2 with p ∈ P (F ), then ωs δ1 = pωs δ2 . Secondly, it is injective: if
ωs δ1 = pωs δ2 with p ∈ P (F ), then δ1 = ωs−1 pωs δ2 with ωs−1 pωs = δ1 δ2−1 ∈ (s−1 P )H (F ). Thirdly, for s1 6=
−1
s2 in ΩP,G , we have ωs1 δ1 6= pωs2 δ2 with p ∈ P (F ): otherwise, s1−1 P = (δ2 δ1−1 )−1 (s−1
2 P )(δ2 δ1 ) with
−1
−1
−1 −1 −1
−1
−1
−1
−1
δ2 δ1 ∈ H(F ), so (s1 P )H = (δ2 δ1 ) (s2 P )H (δ2 δ1 ), and then δ2 δ1 ∈ (s1 P )H (F ) = (s2 P )H (F )
−1
−1
−1
for both of (s−1
1 P )H and (s2 P )H are standard parabolic subgroups of H, which implies s1 P = s2 P
G
contradicting s1 6= s2 . Fourthly, any se ∈ Ω appears in the image of the map for some s ∈ ΩP,G :
since (e
s−1 P )H is a semi-standard parabolic subgroup of H, there exists an s0 ∈ ΩH such that Pe0 ⊆
−1
−1
s0 ((e
s P )H ) = (s−1
s−1 P ))H = ((e
ss0 )−1 P )H , i.e., ses0 ∈ ΩP,G . To sum up, we finish the argument of
0 (e
the claim.
It suffices to prove an analogue of the last equality by replacing FPP0 with Fe P for T ∈ a+
P0 , as they
are identical for sufficiently regular T . That is to say, for x ∈ H(A) = Gθ (A), if (P, δ) is the unique
T -canonical pair for x, we need toprove that δ ∈ P (F )\P (F )ΩG H(F ). Recall that θ(g) = ǫgǫ−1 for
1p
0
. Since ǫ ∈ M0 (F ) ∩ K, from Lemma 4.8, we deduce that (P, δ) is
g ∈ G(A), where ǫ =
0 −1q
the unique T -canonical pair for g ∈ G(A) if and only if (P, θ(δ)) is the unique T -canonical pair for θ(g).
In particular, if (P, δ) is the unique T -canonical pair for x ∈ H(A), we have δ = θ(δ). Denote by δ0 a
representative of δ ∈ P (F )\G(F ). Then δ0 ǫδ0−1 ∈ P (F ).
Suppose that δ0 ǫδ0−1 = mu, where m ∈ MP (F ) and u ∈ NP (F ). Both of mu and m are semi-simple
in G(F ) (in the classical sense) for (mu)2 = m2 = 1. Applying [2, Lemma 2.1] to the characteristic
function of the singleton {u}, one obtains that mu is NP (F )-conjugated to mu′ for some u′ ∈ NP (F )
11

such that mu′ = u′ m. Since both of mu′ and m are semi-simple in G(F ), by the uniqueness of Jordan
decomposition, we have u′ = 1, i.e., δ0 ǫδ0−1 is NP (F )-conjugated to m. By linear algebra, m is MP (F )conjugated to a diagonal matrix with entries {±1} with expected multiplicities p and q respectively. In
sum, δ0 ǫδ0−1 is P (F )-conjugated to ωs ǫωs−1 for some s ∈ ΩG . Suppose that p0 ∈ P (F ) satisfies δ0 ǫδ0−1 =
−1 −1
θ
G
p0 (ωs ǫωs−1 )p−1

0 . Then ωs p0 δ0 ∈ G (F ) = H(F ), i.e., δ = P (F )δ0 ∈ P (F )\P (F )Ω H(F ).
Lemma 4.11. Let P be a relatively standard parabolic subgroup of G. For any a ∈ A∞
e0 (PH , t0 ), there
P
∞
exists a relatively standard minimal parabolic subgroup B ⊆ P such that a ∈ AB (P, t0 ).
Proof. This is an analogue of [12, (2.5) in p. 674]. To begin with, we reduce ourselves to proving the case
P = G. For this purpose, suppose that the assertion is true in this case, and consider the case P 6= G.
∞
Since A∞
e0 (PH , t0 ) = AP
e0 ∩MP (MPH , t0 ), by our assumption, there exists a minimal parabolic subgroup B∗
P
of MP containing Pe0 ∩ MP such that a ∈ A∞
B∗ (MP , t0 ). Let B := B∗ NP . Then B is a relatively standard
∞
∞
minimal parabolic subgroup of G contained in P , and A∞
B∗ (MP , t0 ) = AB (P, t0 ). Thus a ∈ AB (P, t0 ),
which implies the lemma. Therefore, we may and shall only consider the case P = G in the rest of the
proof.
ai
t0
Let a ∈ A∞
for 1 ≤ i ≤ p − 1 and p + 1 ≤
e0 (H, t0 ). Then a = diag(a1 , · · ·, ap+q ), where ai+1 > e
P
i ≤ p + q − 1. In the definition of Siegel sets, we suppose that t0 < 0, so 0 < et0 < 1. Note that
bi
t0
A∞
P0 (G, t0 ) = {diag(b1 , · · ·, bp+q )| bi+1 > e , ∀1 ≤ i ≤ p + q − 1}. Thus we need to show that there exists
a permutation s ∈ ΩG such that s · a = diag(as−1 (1) , · · ·, as−1 (p+q) ) satisfies the following two conditions:
(1) s(i) < s(i + 1) for 1 ≤ i ≤ p − 1 and p + 1 ≤ i ≤ p + q − 1;
(2)

as−1 (i)
as−1 (i+1)

> et0 for 1 ≤ i ≤ p + q − 1.

Firstly, we show that one can move ap+1 to its left hand side in (a1 , · · ·, ap+q ) such that both the first
p + 1 elements and the last q − 1 ones in the new sequence are in “good” order (which means that the
quotient of any consecutive pairs is > et0 ), while keeping the original relative orders among (a1 , · · ·, ap )
ap
> et0 , we are already done (one can take s = 1). In general, write
and among (ap+1 , · · ·, ap+q ). If ap+1



ai
t0
i1 := max 0, max 1 ≤ i ≤ p
.
>e
ap+1
a

a

1 +1
When 1 ≤ i1 ≤ p − 1, since et0 < 1, aip+1
≤ et0 implies aip+1
≥ e−t0 > 1; there is an s ∈ ΩG such that
1 +1
s · a = diag(a1 , · · ·, ai1 , ap+1 , ai1 +1 , · · ·, ap , ap+2 , · · ·, ap+q ). When i1 = 0, which implies ap+1 > a1 , there
is an s ∈ ΩG such that s · a = diag(ap+1 , a1 , · · ·, ap , ap+2 , · · ·, ap+q ).
Secondly, we consider moving ap+2 as before. One should check that ap+2 will not exceed the new
a
place of ap+1 , which results from the fact that ap+1
> et0 . Thus one can move ap+1 and ap+2 to their
p+2
left hand side in (a1 , · · ·, ap+q ) such that both the first p + 2 elements and the last q − 2 ones in the
new sequence are in ”good” order, while still keeping the original relative orders among (a1 , · · ·, ap ) and
among (ap+1 , · · ·, ap+q ).
To finish the argument of our claim, it suffices to move ap+3 , · · ·, ap+q one by one as above. After
moving ai to its left hand side, where p + 3 ≤ i ≤ p + q, one requires that both the first i elements and
the last p + q − i ones in the new sequence are in ”good” order, while the original relative orders among
(a1 , · · ·, ap ) and among (ap+1 , · · ·, ap+q ) are kept. As in the second step above, this is possible since
ai−1
t0
ai > e . After one moves the last element ap+q , the sequence satisfies the desired two conditions. 

Proposition 4.12. Let B be an arbitrary minimal semi-standard parabolic subgroup of G. Let P be a
parabolic subgroup of G containing B. Suppose that T is sufficiently regular. If m ∈ ̺B ∩ MP (A), a ∈
P
∞
A∞
B (P, t0 ) and k ∈ K ∩ MP (A) satisfy FB (mak, TB ) = 1, then a ∈ AB (P, t0 , TB ).
Proof. It results from Lemma 4.6, since FeBP (·, T ) = FBP (·, T ) for sufficiently regular T . Here we write
FeBP (·, T ) for Fe P (·, T ) when B plays the role of P0 .


For a relatively standard parabolic subgroup P of G, denote by P(Pe0 , P ) the set of relatively standard
minimal parabolic subgroups of G contained in P . For B ∈ P(Pe0 , P ), write
1
AG,∞
(P, t0 ) := A∞
B (P, t0 ) ∩ G(A)
B

and for all T ∈ a0 ,
1
AG,∞
(P, t0 , T ) := A∞
B (P, t0 , T ) ∩ G(A) .
B
12

Corollary 4.13. Let P be a relatively standard parabolic subgroup of G. For sufficiently regular T , the
following subset of MPH (A) ∩ G(A)1
[
G,∞
(P, t0 , TB )) · (KH ∩ MPH (A))
(̺Pe0 ∩ MPH (A)) · (A∞
e (PH , t0 ) ∩ AB
P
0

e0 ,P )
B∈P(P

projects surjectively on {m ∈ MPH (F )\MPH (A) ∩ G(A)1 |F P (m, T ) = 1}.
Proof. This is an analogue of [26, Corollaire 2.5]. By Lemma 4.11, the following subset of MPH (A)∩G(A)1
[
G,∞
(P, t0 )) · (KH ∩ MPH (A))
(̺Pe0 ∩ MPH (A)) · (A∞
e (PH , t0 ) ∩ AB
P
0

e0 ,P )
B∈P(P

projects surjectively on MPH (F )\MPH (A) ∩ G(A)1 . Recall that ̺Pe0 ⊆ ̺B for all B ∈ P(Pe0 , P ) and that
KH ⊆ K by our choices (see Section 3.4). Therefore, the statement to be proved follows from Proposition
4.12.

4.2. Integrability.
Theorem 4.14. For all sufficiently regular T and all s ∈ R,
XZ
T
|kf,o
(x)||Nrd(x1 )|sA dx < ∞,
o∈O

H(F )\H(A)∩G(A)1

where we write x = (x1 , x2 ) ∈ GLp,D (A) × GLq,D (A).

Proof. Let P1 ⊆ P2 be a pair of relatively standard parabolic subgroups of G. Following [2, §6], for
T1 ∈ aP1 , we define the characteristic function
X
G
(−1)dim(AP2 /AQ ) τPQ1 (T1 )b
τQ
(T1 ).
σPP12 (T1 ) :=
{Q:P2 ⊆Q}

Recall that for P ⊇ P1 a relatively standard parabolic subgroup of G, we have (see [2, p. 943])
X
σPP12 (T1 ).
τPG (T1 ) =
τPP1 (T1 )b
{P2 :P ⊆P2 }

Denote P1,H := P1 ∩ H. For x ∈ P1,H (F )\H(A), we put
χTP1 ,P2 (x) := F P1 (x, T )σPP12 (HP1 (x) − TP1 ),
and
kP1 ,P2 ,o (x) :=

X

(−1)dim(AP /AG ) kf,P,o (x).

{P :P1 ⊆P ⊆P2 }

Using Lemma 4.4 and the left invariance of HP and kf,P,o by PH (F ), we have
X
X
T
χTP1 ,P2 (δx)kP1 ,P2 ,o (δx)
(4.2.1)
kf,o
(x) =
e0 ⊆P1 ⊆P2 } δ∈P1,H (F )\H(F )
{P1 ,P2 :P

for x ∈ H(F )\H(A). Thus
XZ
o∈O

≤

H(F )\H(A)∩G(A)1

X

X

o∈O {P1 ,P2 :P
e0 ⊆P1 ⊆P2 }

T
|kf,o
(x)||Nrd(x1 )|sA dx

Z

P1,H (F )\H(A)∩G(A)1

χTP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx.

It suffices to prove that for any pair of relatively standard parabolic subgroups P1 ⊆ P2 of G,
XZ
χTP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx < ∞.
o∈O

P1,H (F )\H(A)∩G(A)1

If P1 = P2 6= G, by [2, Lemma 6.1], we have σPP12 = 0 and then χTP1 ,P2 = 0, so the integration is zero. If
P1 = P2 = G, by Corollary 4.13, every x ∈ H(F )\H(A) ∩ G(A)1 with F G (x, T ) = 1 has a representative
in the compact subset
[
̺Pe0 · AG,∞
(G, t0 , TB ) · KH ,
B
e0 ,G)
B∈P(P

13

so the integral is bounded by an integral of a continuous function over a compact subset and thus
convergent. Therefore, we reduce ourselves to proving the following proposition.

Proposition 4.15. Let f ∈ S(s(A)), s ∈ R and P1 ( P2 be two relatively standard parabolic subgroups
of G. Fix any two positive real numbers ǫ0 and N . Then there exists a constant C such that
XZ
χTP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx ≤ Ce−N kT k
P1,H (F )\H(A)∩G(A)1

o∈O

for all sufficiently regular T satisfying α(T ) ≥ ǫ0 k T k for any α ∈ ∆G
P0 .
For x ∈ H(F )\H(A), define
kf,G (x) :=

X

kf,G,o (x) =

f (x−1 Xx)

X∈s(F )

o∈O

and
kfT (x) :=

(4.2.2)

X

X

T
kf,o
(x).

o∈O

Corollary 4.16. Let f ∈ S(s(A)) and s ∈ R. Fix any two positive real numbers ǫ0 and N . Then there
exists a constant C such that
Z
|kfT (x) − F G (x, T )kf,G (x)||Nrd(x1 )|sA dx ≤ Ce−N kT k
H(F )\H(A)∩G(A)1

for all sufficiently regular T satisfying α(T ) ≥ ǫ0 k T k for any α ∈ ∆G
P0 .
Proof. For x ∈ H(F )\H(A), we have
X
X
X
T
T
kfT (x) − F G (x, T )kf,G (x) =
kf,o
(x) − F G (x, T )
kf,G,o (x) =
(kf,o
(x) − F G (x, T )kf,G,o (x)).
o∈O

o∈O

o∈O

χTP1 ,P2

= 0 for P1 = P2 6= G, we have
X
T
kf,o
(x) − F G (x, T )kf,G,o (x) =

By (4.2.1), since

X

χTP1 ,P2 (δx)kP1 ,P2 ,o (δx).

e0 ⊆P1 (P2 } δ∈P1,H (F )\H(F )
{P1 ,P2 :P

Therefore,

Z

H(F )\H(A)∩G(A)1

≤

XZ

o∈O

≤

X

|kfT (x) − F G (x, T )kf,G (x)||Nrd(x1 )|sA dx

H(F )\H(A)∩G(A)1

X

o∈O {P1 ,P2 :P
e0 ⊆P1 (P2 }

T
(x) − F G (x, T )kf,G,o (x)||Nrd(x1 )|sA dx
|kf,o

Z

P1,H (F )\H(A)∩G(A)1

χTP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx.

We now conclude by applying Proposition 4.15 to the last expression.



Proof of Proposition 4.15. Let P be a relatively standard parabolic subgroup of G such that P1 ⊆ P ⊆
P2 . For any X ∈ mP (F ) ∩ o, there exists a unique relatively standard parabolic
! subgroup R of G such
S
that P1 ⊆ R ⊆ P and X ∈ (mP (F ) ∩ r(F ) ∩ o) −
mP (F ) ∩ q(F ) ∩ o . Write
P1 ⊆Q(R




eR
m
P1 := mR −

and

[

{Q:P1 ⊆Q(R}



mR ∩ q

nP
R := nR ∩ mP .
By Corollary 3.6, we have



(mP (F ) ∩ r(F ) ∩ o) − 

[

P1 ⊆Q(R



P
eR
mP (F ) ∩ q(F ) ∩ o = (m
P1 (F ) ∩ o) ⊕ ((nR ∩ s)(F )).
14

Hence
X

kf,P,o (x) =

X∈mP (F )∩o

X

=

Z

f (x−1 (X + U )x)dU

nP ∩s(A)

X

X

P
{R:P1 ⊆R⊆P } ξ∈m
eR
P (F )∩o X∈(nR ∩s)(F )
1

Z

f (x−1 (ξ + X + U )x)dU.

(nP ∩s)(A)

Denote by P the semi-standard parabolic subgroup of G opposite to P and write
nP
R := nR ∩ mP .
P
Note that the restriction of h·, ·i (defined in (3.5.1)) to ((nP
R ∩s)(A))×((nR ∩s)(A)) is also non-degenerate.
R ∩ s)(A), applying the Poisson summation formula to the Bruhat-Schwartz function
RFor any ξ ∈ (m
−1
f
(x
(ξ
+ · + U )x)dU , we get
(nP ∩s)(A)

Z

X

(nP ∩s)(A)

X∈(nP
R ∩s)(F )

P
b
X∈(n
R ∩s)(F )

where the partial Fourier transform Φx,R
of
ξ
notation Ψ in Section 3.5)
b
Φx,R
ξ (X)

:=

X

f (x−1 (ξ + X + U )x)dU =
R

(nP ∩s)(A)

Z

Z

(nP
R ∩s)(A)

−1

f (x

b
Φx,R
ξ (X),

f (x−1 (ξ + · + U )x)dU is defined by (recall the

(ξ + X + U )x)dU

(nP ∩s)(A)

!

b
Ψ(hX, Xi)dX

b ∈ (nP ∩ s)(A). Since hU, Xi
b = 0 for U ∈ (nP ∩ s)(A) and X
b ∈ (nP ∩ s)(A), as well as
for all X
R
R
P
nR ∩ s = (nP ∩ s) ⊕ (nR ∩ s), we have
Z
x,R b
b
Φξ (X) =
f (x−1 (ξ + U )x)Ψ(hU, Xi)dU
(nR ∩s)(A)

b ∈ (nP
for all X
R ∩ s)(A), whose expression is actually independent of P .
To sum up,
X
X
X
b
kf,P,o (x) =
Φx,R
ξ (X).
P
b
{R:P1 ⊆R⊆P } ξ∈m
eR
P (F )∩o X∈(nR ∩s)(F )
1

Hence

kP1 ,P2 ,o (x) =

X

(−1)dim(AP /AG ) kf,P,o (x)

{P :P1 ⊆P ⊆P2 }

=

X

{P :P1 ⊆P ⊆P2 }

=

X



X


(−1)dim(AP /AG ) 
X

{R:P1 ⊆R⊆P2 } ξ∈m
eR
P (F )∩o
1




X

X

P
b
{R:P1 ⊆R⊆P } ξ∈m
eR
P (F )∩o X∈(nR ∩s)(F )

X

1

(−1)dim(AP /AG )

X

P
b
X∈(n
R ∩s)(F )

{P :R⊆P ⊆P2 }

For a relatively standard parabolic subgroup P3 of G containing R, we write


[
P3
3 ′
.

nQ
(nP
R
R ) := nR −
{Q:R⊆Q(P3 }

Then

X

P
b
X∈(n
R ∩s)(F )

b
Φx,R
ξ (X) =

X

X

P3 ′
{P3 :R⊆P3 ⊆P } X∈((n
b
) ∩s)(F )

15

R

b
Φx,R
ξ (X).



b 
Φx,R
ξ (X)


b 
Φx,R
ξ (X)

We have

X

=

b
Φx,R
ξ (X)

P
b
X∈(n
R ∩s)(F )

{P :R⊆P ⊆P2 }

X

X

(−1)dim(AP /AG )

X

(−1)dim(AP /AG )

P3 ′
{P3 :R⊆P3 ⊆P } X∈((n
b
) ∩s)(F )

{P :R⊆P ⊆P2 }

X

dim(AP2 /AG )

=(−1)

X

R

X

P3 ′
{P3 :R⊆P3 ⊆P2 } X∈((n
b
) ∩s)(F )
R

b
Φx,R
ξ (X)

b
Φx,R
ξ (X)
X

(−1)dim(AP /AP2 ) .

{P :P3 ⊆P ⊆P2 }

From [2, Proposition 1.1], we know that

X
1, if P3 = P2 ;
dim(AP /AP2 )
=
(−1)
0, otherwise.
{P :P3 ⊆P ⊆P2 }

We obtain
X

(−1)dim(AP /AG )

X

P
b
X∈(n
R ∩s)(F )

{P :R⊆P ⊆P2 }

Thus

dim(AP2 /AG )
b
Φx,R
ξ (X) = (−1)

X

kP1 ,P2 ,o (x) = (−1)dim(AP2 /AG )

X

X

P2 ′
b
X∈((n
R ) ∩s)(F )

X

P2 ′
{R:P1 ⊆R⊆P2 } ξ∈m
eR
b
) ∩s)(F )
P (F )∩o X∈((n

Now
XZ
o∈O

≤

P1,H (F )\H(A)∩G(A)1

XZ

o∈O

=

P1,H (F )\H(A)∩G(A)1

X

{R:P1 ⊆R⊆P2 }

Z

1

R

b
Φx,R
ξ (X).

b
Φx,R
ξ (X).

χTP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx



χTP1 ,P2 (x) 

P1,H (F )\H(A)∩G(A)1

We reduce ourselves to bounding
Z
(4.2.3)

P1,H (F )\H(A)∩G(A)1

X

X

X



P2 ′
{R:P1 ⊆R⊆P2 } ξ∈m
eR
b
) ∩s)(F )
P (F )∩o X∈((n

χTP1 ,P2 (x)

1

X

eR
ξ∈(m
P1 ∩s)(F )

χTP1 ,P2 (x)

X

eR
ξ∈(m
P1 ∩s)(F )

R

X

P2 ′
b
X∈((n
R ) ∩s)(F )

X

P2 ′
b
X∈((n
R ) ∩s)(F )

s
b 
|Φx,R
ξ (X)| |Nrd(x1 )|A dx

s
b
|Φx,R
ξ (X)||Nrd(x1 )|A dx.
s
b
|Φx,R
ξ (X)||Nrd(x1 )|A dx

for any fixed relatively standard parabolic subgroup R of G such that P1 ⊆ R ⊆ P2 .
By Iwasawa decomposition and our choices of measures, the integral over P1,H (F )\H(A) ∩ G(A)1 can
be decomposed as integrals over
(n1 , m1 , k) ∈ NP1,H (F )\NP1,H (A) × MP1,H (F )\MP1,H (A) ∩ G(A)1 × KH .
Then

Z

=

Z
·

P1,H (F )\H(A)∩G(A)1

KH

Z

χTP1 ,P2 (x)

eR
ξ∈(m
P1 ∩s)(F )

MP1,H (F )\MP1,H (A)∩G(A)1

X

X

P2 ′
eR
b
ξ∈(m
) ∩s)(F )
P ∩s)(F ) X∈((n
1

R

X

Z

X

P2 ′
b
X∈((n
R ) ∩s)(F )

NP1,H (F )\NP1,H (A)

s
b
|Φx,R
ξ (X)||Nrd(x1 )|A dx

F P1 (m1 , T )σPP12 (HP1 (m1 ) − TP1 )

b −2ρP1,H (HP1,H (m1 )) |Nrd(m1,1 )|s dn1 dm1 dk,
|Φξn1 m1 k,R (X)|e
A

where we write m1 = (m1,1 , m1,2 ) ∈ GLp,D (A) × GLq,D (A).
By Corollary 4.13, the following subset of MP1,H (A) ∩ G(A)1
[
G,∞
(P1 , t0 , TB )) · (KH ∩ MP1,H (A))
(̺Pe0 ∩ MP1,H (A)) · (A∞
e (P1,H , t0 ) ∩ AB
P
0

e0 ,P1 )
B∈P(P

projects surjectively on {m1 ∈ MP1,H (F )\MP1,H (A) ∩ G(A)1 |F P1 (m1 , T ) = 1}. Let Γ1 ⊆ NP1,H (A) be
a compact subset which projects surjectively on NP1,H (F )\NP1,H (A). Then Γ1 · (̺Pe0 ∩ MP1,H (A)) is a
16

P

compact subset of NPe0 (A). Let Γ2 ⊆ NP2,H (A), Γ3 ⊆ NPe2,H (A) and Γ4 ⊆ MPe0 (A)1 be compact subsets
0
(independent of T ) such that Γ1 · (̺Pe0 ∩ MP1,H (A)) ⊆ Γ2 Γ3 Γ4 . We have
Z
X
X
s
b
χTP1 ,P2 (x)
|Φx,R
ξ (X)||Nrd(x1 )|A dx
P1,H (F )\H(A)∩G(A)1

≤c1

X

e0 ,P1 )
B∈P(P

Z

KH

b
|Φξn2 namk,R (X)|e

Z

Γ4

P2 ′
eR
b
ξ∈(m
) ∩s)(F )
P ∩s)(F ) X∈((n
1

Z

AG,∞
(P1 ,t0 ,TB )
B

−2ρPe (HB (a))
0

Z

Γ3

Z

R

Γ2

σPP12 (HP1 (a)

− TP1 )

X

X

P2 ′
eR
b
ξ∈(m
) ∩s)(F )
P ∩s)(F ) X∈((n
1

R

|Nrd(a1 )|sA dn2 dndadmdk,

where c1 = vol(KH ∩ MP1,H (A)) is a constant independent of T .
b ∈ (nR ∩ s)(A). Let R ⊆ P2 be a pair of relatively
Lemma 4.17. Let x ∈ H(A), ξ ∈ (mR ∩ s)(A) and X
standard parabolic subgroups of G. For n2 ∈ NP2,H (A), we have
b = Φx,R (X).
b
Φξn2 x,R (X)
ξ

Proof of Lemma 4.17. Let U2 := n−1
2 ξn2 − ξ. Then
Z
b
b =
f (x−1 n−1
Φnξ 2 x,R (X)
2 (ξ + U )n2 x)Ψ(hU, Xi)dU
(nR ∩s)(A)
Z
b
f (x−1 (ξ + U2 + n−1 U n2 )x)Ψ(hU, Xi)dU.
=
2

(nR ∩s)(A)

Since both U2 and n−1
2 U n2 − U belong to (nP2 ∩ s)(A), we have
so
b =
Φξn2 x,R (X)

b
hU2 + n−1
2 U n2 − U, Xi = 0,

Z

(nR ∩s)(A)

−1
b
f (x−1 (ξ + U2 + n−1
2 U n2 )x)Ψ(hU2 + n2 U n2 , Xi)dU.

Because the change of variables U2 + n−1
2 U n2 7→ U does not change the Haar measure, we obtain
b = Φx,R (X).
b
Φξn2 x,R (X)
ξ



Using Lemma 4.17, we get
b = Φnamk,R (X)
b = Φaa
Φξn2 namk,R (X)
ξ
ξ

−1

namk,R

By change of variables a−1 U a 7→ U , using the fact that
b = ha−1 U a, a−1 Xai,
b
hU, Xi

we have

b
(X).

−1

b = e2ρR,+ (HB (a)) Φa−1 namk,R (a−1 Xa),
b
Φξn2 namk,R (X)
a ξa

where we denote by ρR,+ the half of the sum of weights (with multiplicities) for the action of A0 on
nR ∩ s. From the reduction theory (see [2, p. 944]), we know that for a satisfying σPP12 (HP1 (a) − TP1 ) 6= 0,
a−1 na belongs to a compact subset independent of T . In sum,
Z
X
X
s
b
|Φx,R
χTP1 ,P2 (x)
ξ (X)||Nrd(x1 )|A dx
P1,H (F )\H(A)∩G(A)1

≤c2

X

e0 ,P1 )
B∈P(P

·

X

sup
y∈Γ

Z

P2 ′
eR
b
ξ∈(m
) ∩s)(F )
P ∩s)(F ) X∈((n
1

(P1 ,t0 ,TB )
AG,∞
B

X

P2 ′
eR
b
ξ∈(m
P1 ∩s)(F ) X∈((nR ) ∩s)(F )

R

(2ρ
−2ρ )(H (a)) P2
e R,+ Pe0 B
σP1 (HP1 (a)

−1 b
|Φy,R
Xa)||Nrd(a1 )|sA da,
a−1 ξa (a

− TP1 )

where c2 is a constant independent of T , and Γ is a compact subset of H(A) ∩ G(A)1 independent of T .
Denote by OF the ring of integers of F . Fix an F -basis for each weight space for the action of A0 (F )
on s(F ). Since the function f ∈ S(s(A)) is compactly supported at finite places, there exists an OF eR
scheme structure on such weight spaces independent of T such that the sums over ξ ∈ (m
P1 ∩ s)(F ) and
17

P2 ′
b
b ∈ ((nP2 )′ ∩ s)(F ) can be restricted to ξ ∈ m
eR
X
P1 (F ) ∩ s(OF ) and X ∈ (nR ) (F ) ∩ s(OF ) respectively.
R
To see this, one may consult [5, §1.9 and p. 363] for details, and one needs to replace mR and nR in loc.
cit. by mR ∩ s and nR ∩ s respectively.
Fix an R-basis {e1 , · · · , eℓ } of the R-linear space s(F ⊗Q R), whose dimension is denoted by ℓ, consisting
of eigenvectors for the action of A∞
B . Let k · k be the standard Euclidean norm with respect to this basis.
Consider a sufficiently large integer k > 0 to be described precisely at the end of the proof. There exists
2
an even integer m ≥ 0, a real number kα ≥ 0 for each α ∈ ∆P
B , and a real number c3 > 0 satisfying the
following conditions (cf. [5, (4.10) in p. 372] or [2, p. 946-947]):

(1) if R = P2 , m = 0;
R
2
(2) for all α ∈ ∆P
B − ∆B , kα ≥ k;

(3) for all a0 ∈ A∞
B (P2 , t0 ),
X

(4.2.4)

P2 ′
b
X∈(n
R ) (F )∩s(OF )

−m
b
ka−1
≤ c3
0 Xa0 k

Y

e−kα α(HB (a0 )) .

P
α∈∆B2

We fix such data.
We extend any differential operator ∂ on s(F ⊗Q R) to s(A) by defining ∂(f∞ ⊗ χ∞ ) := (∂f∞ ) ⊗ χ∞
(see Section 2.3 for the notation). We also write
b
Φx,R,∂
(X)
ξ

:=

Z

(nR ∩s)(A)

b
(∂f )(x−1 (ξ + U )x)Ψ(hU, Xi)dU.

→
−
→
−
For a multi-index i = (i1 , · · · , iℓ ) ∈ Zℓ≥0 , denote by ∂ i := ( ∂e∂ 1 )i1 · · · ( ∂e∂ ℓ )iℓ the corresponding differenb 7→ kXk
b m is a polynomial with Z-coefficients
tial operator on s(F ⊗Q R). Since m is even, the function X
2
on (nP
R ∩ s)(F ⊗Q R). Invoking integration by parts (see [7, Theorem 3.3.1.(f)] for example), we see that
there exists a differential operator ∂ (m) on s(F ⊗Q R) satisfying the following two conditions.

→
−

(1) ∂ (m) is a finite Z-linear combination of ∂ i ’s with the properties:
→
−
• the sum of components of i is m;
→
−
• all components of i are even integers;
→
−
2
• all non-zero components of i correspond to eigenvectors lying in (nP
R ∩ s)(F ⊗Q R).
b=
(2) For X
6 0, we have

b
b −m |Φy,R,Ad(y
|Φy,R
ξ (X)| = kXk
ξ

We fix such a ∂ (m) . Suppose that ∂ (m) =
b 6= 0, we have
Then for X

P

→
−
i ∈I

−1

)∂ (m)

→
−

b
(X)|.

− ∈ Z.
− ∂ i , where I is a finite set of multi-indices and r→
r→
i
i

−1 b
b −m
|Φy,R
Xa)| ≤ c4 (y)ka−1 Xak
a−1 ξa (a

X

→
−
i ∈I

→
−
i

−1 b
|Φy,R,∂
Xa)|,
a−1 ξa (a

where c4 (y) is a continuous function of y.
Denote by Φ(AB , mR ∩ s) the set of weights of AB in mR ∩ s. For any µ ∈ Φ(AB , mR ∩ s), let mµ be the
corresponding weight space. From [21, §41], we know that there exists a function φµ ∈ S(mµ (A)) for each
µ ∈ Φ(AB , mR ∩s) and a function φnR ∩s ∈ S((nR ∩s)(A)) such that for all ξ+U ∈ (mR ∩s)(A)⊕(nR ∩s)(A)
and y ∈ Γ,


X
Y
→
−
φµ (ξµ ) φnR ∩s (U ),
|(∂ i f )(y −1 (ξ + U )y)| ≤ 
→
−
i ∈I

µ∈Φ(AB ,mR ∩s)

where ξµ denotes the projection of ξ to mµ (A).
18

Let a ∈ AG,∞
(P1 , t0 , TB ) be such that σPP12 (HP1 (a) − TP1 ) 6= 0. It is shown in [5, p. 375] that
B
2
α(HB (a)) > t0 for all α ∈ ∆P
B . Now we have
X

X

P2 ′
eR
b
ξ∈(m
) ∩s)(F )
P ∩s)(F ) X∈((n
1

=

R

X

X

−1 b
|Φy,R
Xa)|
a−1 ξa (a

P2 ′
eR
b
ξ∈m
) (F )∩s(OF )
P (F )∩s(OF ) X∈(n
1

≤

R

X

X

P2 ′
eR
b
ξ∈m
) (F )∩s(OF )
P (F )∩s(OF ) X∈(n
1

≤c5

X

eR
ξ∈m
P (F )∩s(OF )
1

≤c5 c3

X




eR
ξ∈m
P (F )∩s(OF )
1

where c5 := sup c4 (y)
y∈Γ

Thus

R

P1,H (F )\H(A)∩G(A)1

X

≤c2 c5 c3

e0 ,P1 )
B∈P(P

X

·

eR
ξ∈m
P1 (F )∩s(OF )

Y

b −m
c4 (y)ka−1 Xak
−1

φµ (µ(a)

µ∈Φ(AB ,mR ∩s)




Y

µ∈Φ(AB ,mR ∩s)



ξµ ) ·

X

→
−
i ∈I

→
−

i
−1 b
|Φy,R,
Xa)|
a−1 ξa (a

X

P2 ′
b
X∈(n
R ) (F )∩s(OF )



φµ (µ(a)−1 ξµ ) ·

Y

b −m
ka−1 Xak

e−kα α(HB (a)) ,

P

α∈∆B2

φnR ∩s (U )dU , and we have applied (4.2.4) to a0 = a in the last inequality.

(nR ∩s)(A)

Z

R

−1 b
|Φy,R
Xa)|
a−1 ξa (a

X

χTP1 ,P2 (x)

eR
ξ∈(m
P1 ∩s)(F )

Z

e

AG,∞
(P1 ,t0 ,TB )
B



Y



µ∈Φ(AB ,mR ∩s)

X

P2 ′
b
X∈((n
R ) ∩s)(F )

s
b
|Φx,R
ξ (X)||Nrd(x1 )|A dx

(2ρR,+ −2ρPe )(HB (a)) P2
0
σP1 (HP1 (a)

− TP1 )


 
Y


φµ (µ(a)−1 ξµ ) · 
e−kα α(HB (a))  |Nrd(a1 )|sA da.
P

α∈∆B2

mR ∩s
Denote by ΣB
the positive weights of mR ∩ s under the action of AB . Consider the subsets S of
P1
with the following property: for all α ∈ ∆R
B − ∆B , there exists µ ∈ S such that its α-coordinate
is > 0. Then
mR ∩s
ΣB

X

eR
ξ∈m
P (F )∩s(OF )
1





X Y


≤
S

µ∈S




Y

µ∈Φ(AB ,mR ∩s)

X

ξ− ∈m−µ (OF )−{0}



φµ (µ(a)−1 ξµ )
 

φ−µ (µ(a)ξ− ) 

Y
m

µ∈ΣB R

∩s




X

ξ+ ∈mµ (OF )



φµ (µ(a−1 )ξ+ ) .

The rest of the proof is analogous to that of [5, Proposition 4.4], and we shall only sketch main steps and
point out additional ingredients. By the argument in [5, p. 373], for a ∈ A∞
B (P2 , t0 ), we have bounds for
two factors


Y
X
Y

φ−µ (µ(a)ξ− ) ≤ c6
e−kα(HB (a))
µ∈S

P

ξ− ∈m−µ (OF )−{0}

1
α∈∆R
B −∆B

and
Y

m ∩s
µ∈ΣB R




X

ξ+ ∈mµ (OF )



φµ (µ(a−1 )ξ+ ) ≤ c7 e(2ρB,+ −2ρR,+ )(HB (a)) ,
19

where c6 and c7 are constants independent of T . We deduce that

e

(2ρR,+ −2ρPe )(HB (a))
0

·

X

eR
ξ∈m
P (F )∩s(OF )

≤c8 e

(2ρR,+ −2ρPe )(HB (a))
0




·

1

Y

P




Y

µ∈Φ(AB ,mR ∩s)




 
 Y −kα α(HB (a)) 
s
φµ (µ(a)−1 ξµ ) · 
e
 |Nrd(a1 )|A
P

α∈∆B2




Y



e−kα(HB (a))  e(2ρB,+ −2ρR,+ )(HB (a)) · 
e−kα α(HB (a))  |Nrd(a1 )|sA
P

1
α∈∆R
B −∆B




=c8 e(2ρB,+ −2ρPe0 )(HB (a)) |Nrd(a1 )|sA · 

Y

α∈∆B2

 

P

1
α∈∆R
B −∆B



  Y −kα α(HB (a)) 
e−kα(HB (a))  · 
e
,
P

α∈∆B2

where c8 is a constant independent of T . The last expression only differs from [5, (4.17) in p. 375] by a
factor
pq
! p+q
s
1/p
|Nrd(a
)|
1
(2ρB,+ −2ρPe )(HB (a))
(2ρ
−2ρ
)(H
(a))
s
B,+
B
e
A
P
0
0
e
|Nrd(a1 )|A = e
1/q
|Nrd(a2 )|A
∗
in the form of eλ(HB (a)) , where λ ∈ (aG
B ) . We shall see that this discrepancy will be unimportant when
we follow the end of the proof of [5, Proposition 4.4] (cf. [26, end of §3.2]). Write


 X

λ=
cα α + λ′ ,
P

α∈∆B2

∗
where cα ∈ R and λ′ ∈ (aG
P2 ) . By [4, Lemma 8.3.(b)], there exists a constant c9 > 0 such that for all
P2
G
T1 ∈ aP1 satisfying σP1 (T1 ) = 1, we have


X


λ′ (T2 ) ≤ c9 
β(T12 ) ,
P

β∈∆P2
1

G,∞
G
2
where we write T1 = T12 + T2 with T12 ∈ aP
(P1 , t0 , TB ) satisfies
P1 and T2 ∈ aP2 . Hence, when a ∈ AB
P2
σP1 (HP1 (a) − TP1 ) 6= 0, we have


 Y cα α(HB (a))  λ′ (HP2 (a))
eλ(HB (a)) = 
e
·e
P

α∈∆B2


Y
′
G
G
′


=
ecα α(HB (a))  · eλ (HP2 (a)−TP2 ) eλ (TP2 )


P



α∈∆B2

 



 Y cα α(HB (a))   Y c9 tβ  c10 kT k
≤
e
e
,
·
e
P

P

α∈∆B2

β∈∆P2
1

G
where TPG2 is the projection of TP2 to aG
P2 via the decomposition aP2 = aP2 ⊕ aG , we let
2
tβ ∈ R be the projection of HP1 (a) − TP1 to aP
P1
constant independent of T . To bound (4.2.3), it
375]. More precisely, set

kα + cα ,
kα′ :=
kα + k + cα ,

P

P
β∈∆P2
1

tβ ̟β∨ with

2
via the decomposition aP1 = aP
P1 ⊕ aP2 , and c10 is a
suffices to plug this extra factor into [5, (4.18) in p.

R
2
for all α ∈ ∆P
B − ∆B ;
P1
R
for all α ∈ ∆B − ∆B .
20

Then there exists a constant c11 > 0 independent of T such that
Z
X
X
χTP1 ,P2 (x)
P1,H

(F )\H(A)∩G(A)1

P2 ′
eR
b
ξ∈(m
) ∩s)(F )
P ∩s)(F ) X∈((n
1

1 ,∞
≤c11 vol(AP
(t0 , TB ))ec10 kT k
B

Y

P

R

P

α∈∆B2 −∆B1


Z
′
e−kα α(TB )

0

∞

s
b
|Φx,R
ξ (X)||Nrd(x1 )|A dx


′
(1 + t)nα e(c9 −kα )t dt ,

1 ,∞
1
where AP
(t0 , TB ) := A∞
B (P1 , t0 , TB ) ∩ MP1 (A) , and nα ’s are positive integers independent of T . We
B
P1 ,∞
P1
2
know that vol(AB (t0 , TB )) is of polynomial growth in T and that kα ≥ k+cα for all α ∈ ∆P
B −∆B 6= ∅.
G
For sufficiently regular T satisfying α(TB ) ≥ ǫ0 kT k for all α ∈ ∆B , if we choose sufficiently large k, then
the last expression is bounded by Ce−N kT k with a constant C independent of T .


5. Exponential polynomial distributions
Let T be sufficiently regular, o ∈ O and η be the quadratic character of A× /F × attached to a quadratic
field extension E/F . For f ∈ S(s(A)) and s ∈ C, define
Z
T
kf,o
(x)η(Nrd(x))|Nrd(x1 )|sA dx
(5.0.1)
JoG,T (η, s, f ) :=
H(F )\H(A)∩G(A)1

and
J G,T (η, s, f ) :=

Z

H(F )\H(A)∩G(A)1

kfT (x)η(Nrd(x))|Nrd(x1 )|sA dx,

T
where kf,o
(x) and kfT (x) are defined by (4.0.1) and (4.2.2) respectively, and we write x = (x1 , x2 ) ∈
GLp,D (A) × GLq,D (A). From Theorem 4.14, we know that JoG,T (η, s, ·) and J G,T (η, s, ·) are well-defined
distributions on S(s(A)) and that
X
J G,T (η, s, f ) =
JoG,T (η, s, f ),
o∈O

which is an analogue of the geometric side of Arthur’s trace formula.

5.1. A generalised case in the product form. Let Q be a relatively standard parabolic subgroup of
G. Then
MQ ≃ GLp1 +q1 ,D × · · · × GLpl +ql ,D
and
MQH ≃ GLp1 ,D × · · · × GLpl ,D × GLq1 ,D × · · · × GLql ,D ,
l
l
P
P
qi = q and we allow pi or qi to be zero. The tangent space of MQ /MQH at the
pi = p,
where
i=1

neutral element is

i=1

mQ ∩ s ≃

M

{1≤i≤l|pi qi 6=0}



0

Matqi ×pi ,D


Matpi ×qi ,D
.
0

The conjugate action of MQH (F ) on (mQ ∩ s)(F ) can be described as follows:




GLpi (D)
0
Matpi ×qi (D)
(1) if pi qi 6= 0,
acts on
by conjugation;
GLqi (D)
0
Matqi ×pi (D)


GLpi (D)
(2) if pi qi = 0,
acts on 0 (viewed as a 0-dimensional vector space) trivially.
GLqi (D)
We may generalise integrability in last section to the product setting here whose proof is similar.
Define a relation of equivalence on (mQ ∩ s)(F ) which is similar to that on s(F ) on each component.
We denote by OmQ ∩s the set of equivalent classes for this relation. For o ∈ O, the intersection o ∩ mQ (F )
is a finite (perhaps empty) union of classes o1 , · · ·, ot ∈ OmQ ∩s . Fix the minimal parabolic subgroup
Pe0′ := Pe0 ∩ MQH = Pe0 ∩ MQ of MQH and its Levi factor M0 . We say that a parabolic subgroup P ′
of MQ is semi-standard (resp. relatively standard) if M0 ⊆ P ′ (resp. Pe0′ ⊆ P ′ ). Notice that there
exists a bijection from the set of semi-standard (resp. relatively standard) parabolic subgroups of G
contained in Q to the set of semi-standard (resp. relatively standard) parabolic subgroups of MQ given
by P 7→ P ∩ MQ , whose inverse is given by P ′ 7→ P ′ NQ .
Choose ςQ ∈ ΩG (not unique) such that ςQ P0 ⊆ Q. Fix the minimal semi-standard parabolic subgroup
′
P0 := (ςQ P0 ) ∩ MQ of MQ depending on the choice of ςQ . For any semi-standard parabolic subgroup P ′
21

of MQ and T ∈ a0 , denote by TP ′ the projection of sT in aP ′ , where s ∈ ΩMQ such that sP0′ ⊆ P ′ . For
s ∈ ΩMQ and a semi-standard parabolic subgroup P ⊆ Q of G, we see that sP0′ ⊆ P ∩ MQ if and only if
sςQ P0 ⊆ P . Then (ςQ T )P ∩MQ = TP which is independent of the choice of ςQ . If T ∈ a+
P0 is sufficiently
+
regular with respect to P0 ⊆ G, then ςQ T ∈ aP ′ is sufficiently regular with respect to P0′ ⊆ MQ .
0
Let f ′ ∈ S((mQ ∩ s)(A)), P ′ be a relatively standard parabolic subgroup of MQ and 1 ≤ j ≤ t. Write
′
PH
:= P ′ ∩ MQH = P ′ ∩ H. For x ∈ MPH′ (F )NPH′ (A)\MQH (A), define
Z
X
MQ
f ′ (x−1 (X + U )x)dU.
(5.1.1)
kf ′ ,P
′ ,o (x) :=
j
X∈mP ′ (F )∩oj

For T ∈ a0 and x ∈ MQH (F )\MQH (A), define
X
kfQ,T
(−1)dim(AP ′ /AMQ )
′ ,o (x) :=
j
e′ ⊆P ′ }
{P ′ :P
0

(nP ′ ∩s)(A)

X

′ (F )\M
δ∈PH
QH (F )

M

M

Q
τbP ′ Q (HP ′ (δx) − TP ′ ) · kf ′ ,P
′ ,o (δx).
j

l
For sufficiently regular T ∈ a+
P0 and {si }1≤i≤l ∈ C , define
Z
Y
Q,ςQ T
′
(η,
{s
},
f
)
:=
JoQ,T
(x)η(Nrd(x))
k
|Nrd(xi,1 )|sAi dx,
′
i
f ,oj
j
MQH (F )\MQH (A)∩MQ (A)1

1≤i≤l

where we write x = (x1 , ..., xl ) ∈ GLp1 +q1 ,D (A) × · · · × GLpl +ql ,D (A) and xi = (xi,1 , xi,2 ) ∈ GLpi ,D (A) ×
Q,ς T
GLqi ,D (A). As explained above, kf ′ ,oQj and JoQ,T
are independent of the choice of ςQ . Then we have
j
(η, {si }, ·) on S((mQ ∩ s)(A)). It only depends on the projection of ςQ T
well-defined distributions JoQ,T
j
Q
to aςQ P0 and does not depend on TQ . Now we define
JoQ,T :=

(5.1.2)

t
X

JoQ,T
j

j=1

and
J Q,T :=

X

JoQ,T .

o∈O
η
fQ

∈ S((mQ ∩ s)(A)) by
Z
Z
η
fQ
(X) :=
f (k −1 (X + V )k)η(Nrd(k))dV dk

For f ∈ S(s(A)), define
(5.1.3)

KH

(nQ ∩s)(A)

for all X ∈ (mQ ∩ s)(A).
5.2. ω-stable parabolic subgroups. In our case, we can embed G into g in the standard way. For
any linear subspace v of g, we denote by v× the intersection of v and G in g.
 that p = q. Let
 Assume
0 1n
×
×
∈ G(F ). In this
us denote n := p = q. Then s (F ) is the union of classes in O . Let ω :=
1n 0
section, we shall freely use the notation in Section 3.4. Then ω is the element in G exchanging ei and fi
for all 1 ≤ i ≤ n. We see that ω Pe0 ω −1 = Pe0 . We say that a semi-standard parabolic subgroup Q of G is
“ω-stable” if ωQω −1 = Q. By Chevalley’s theorem, this condition is equivalent to ω ∈ Q. Recall that a
relatively standard parabolic subgroup Q of G is understood as the stabiliser in G of the flag
0 ( he1 , ···, ep1 , f1 , ···, fq1 iD ( he1 , ···, ep1 +p2 , f1 , ···, fq1 +q2 iD ( ... ( he1 , ···, ep1 +···+pl , f1 , ···, fq1 +···+ql iD ,
where

l
P

i=1

pi =

l
P

qi = n and we allow pi or qi to be zero.

i=1

Proposition 5.1. Assume that p = q = n. Let Q be a relatively standard parabolic subgroup of G. Then
Q is ω-stable if and only if pi = qi for all 1 ≤ i ≤ l.
Proof. Since ω ∈ G exchanges ei and fi for all 1 ≤ i ≤ n, the parabolic subgroup ωQω −1 of G is the
stabiliser in G of the flag
0 ( hf1 , ···, fp1 , e1 , ···, eq1 iD ( hf1 , ···, fp1 +p2 , e1 , ···, eq1 +q2 iD ( ... ( hf1 , ···, fp1 +···+pl , e1 , ···, eq1 +···+ql iD .
Then ωQω −1 = Q if and only if the flags associated to ωQω −1 and Q are the same, which is equivalent
to pi = qi for all 1 ≤ i ≤ l.

22

An illustrating example of ω-stable relatively
l = 2)

∗
 0
Q=
 ∗
0

standard parabolic subgroups of G looks like (when

×
∗
∗ 
 .
∗ 
∗
×

pn pn
induces a bijection from the set
Proposition 5.2. Assume that p = q = n. The map Pn 7→
pn pn
of standard parabolic subgroups in GLn,D (namely containing the group of upper triangular matrices) to
the set of ω-stable relatively standard parabolic subgroups in G.
∗
∗
∗
∗

∗
0
∗
0

Proof. It is known that there is a bijection between the set of standard parabolic subgroups in GLn,D
and the set of partitions of n. By Proposition 5.1, the latter set is in bijection with the set of ω-stable
relatively standard parabolic subgroups in G. The composition of these bijection is exactly given by the
×

pn pn
.

map Pn 7→
pn pn
Proposition 5.3. Assume that p = q = n. Let Q ⊆ R be a pair of relatively standard parabolic subgroups
of G. If Q is ω-stable, then R is ω-stable.
Proof. Suppose that R is the stabiliser in G of the flag
0 ( he1 , ···, er1 , f1 , ···, ft1 iD ( he1 , ···, er1 +r2 , f1 , ···, ft1 +t2 iD ( ... ( he1 , ···, er1 +···+rl′ , f1 , ···, ft1 +···+tl′ iD .
The condition Q ⊆ R tells us that the partition (p1 , · · ·, pl ) (resp. (q1 , · · ·, ql )) is a refinement of the
partition (r1 , · · ·, rl′ ) (resp. (t1 , · · ·, tl′ )) of n, and that for all 1 ≤ j ≤ l′ , rj and tj are divided into the
same number of segments in these two refinements. Hence, if pi = qi for all 1 ≤ i ≤ l, then rj = tj for

all 1 ≤ j ≤ l′ . Thus this proposition results from Proposition 5.1.
For any relative standard parabolic subgroup Q of G, define
\
ω-st
R,
Q
:=
{R:Q⊆R,ωRω −1 =R}

which is the minimal ω-stable parabolic subgroup of G containing Q.
Proposition 5.4. Assume that p = q = n. Let o ∈ O. The following three conditions are equivalent:
(1) o ∈ O× ;
(2) for all relatively standard parabolic subgroup Q of G, if o ∩ q(F ) 6= ∅, then Q is ω-stable;
(3) for all relatively standard parabolic subgroup Q of G, if o ∩ mQ (F ) 6= ∅, then Q is ω-stable.
Proof. The direction (2)⇒(3) is trivial. We actually have (2)⇔(3) from Proposition 3.5.
Next, we prove the direction (1)⇒(2). We assume that o ∈ O× and that o ∩ q(F ) 6= ∅ for some
relatively standard parabolic subgroup Q of G. If Q is not ω-stable, let k be the minimal integer such
that 1 ≤ k ≤ l − 1 and that
X
X
pi −
qi 6= 0.
1≤i≤k

1≤i≤k

Without loss of generality, we may assume that
X
X
pi −
qi < 0.


1≤i≤k

1≤i≤k



∗ ∗
Let
∈ o ∩ q(F ). Then A ∈ gln (D) is in the form of
, where the size of the zero matrix
0 ∗

 

P
P
pi . Therefore, A is not invertible, which
in the lower left corner is at least
pi × 1 +
0
B

A
0



k+1≤i≤l

k+1≤i≤l

contradicts with o ∈ O× . This establishes (1)⇒(2).
Finally,
the direction (3)⇒(1). We assume (3). Suppose that o ∈
/ O× . Let P (λ) := PrdAB (λ),
 we prove

0 A
where
is any element in o. By [23, Proposition 5], there exists 1 ≤ m ≤ n such that P (λ) =
B 0
λdm R(λ), where R(λ) = PrdC (λ) for some C ∈ GLn−m (D). Let Q be the relative standard parabolic
23



0
 0

subgroup of G with l = 2, p1 = q1 = n − m and p2 = q2 = m. Then 
C
0
which contradicts with (3). This shows (3)⇒(1).

0 1n−m
0
0
0
0
0
0


0
0 
 ∈ o ∩ mQ (F ),
0 
0


Denote by ρQ,+ the half of the sum of weights (with multiplicities) for the action of A0 on nQ ∩ s. We
see that ρQ,+ = ρQ − ρQH and that for Q ⊆ R a pair of relatively standard parabolic subgroup of G, the
restriction of (2ρQ,+ − 2ρQH ) aQ to aR equals (2ρR,+ − 2ρRH ) aR .
Lemma 5.5. Assume that p = q = n. Let Q be a relatively standard parabolic subgroup of G. For all
b ∨ , we have (2ρQ,+ − 2ρQH )(̟∨ ) ≥ 0. Moreover, 2ρQ,+ − 2ρQH viewed as an element of (aG )∗
̟∨ ∈ ∆
Q
Q
is zero if and only if Q is ω-stable.

Proof. Put e∗i ∈ a∗0 (resp. fi∗ ∈ a∗0 ) to be the character of the action of A0 on ei (resp. fi ). Write e∨
i ∈ a0
∗ ∨
(resp. fi∨ ∈ a0 ) to be the dual basis, i.e., e∗i (e∨
)
=
δ
(resp.
f
(f
)
=
δ
)
for
1
≤
i,
j
≤
n.
A
basis
of
ij
ij
j
i
j
∨
∨
∨
∨
aQ is given by h∨
for
1
≤
i
≤
l.
Write
+
f
+
·
·
·
+
f
:=
e
+
·
·
·
+
e
q1 +···+qi−1 +1
q1 +···+qi
p1 +···+pi−1 +1
p1 +···+pi
i
h∗i ∈ (aQ )∗ to be the dual basis. Denote

̟k∨ :=

l
P

(pi + qi )

i=k+1

∨
(h∨
1 + · · · + hk ) −

2n

k
P

(pi + qi )

i=1

∨
(h∨
k+1 + · · · + hl ).

2n

Recall that
b G )∨ = {̟∨ |1 ≤ k ≤ l − 1}
(∆
Q
k

is a basis of aG
Q . We can also see that
2ρQ,+

X

(pi qj + qi pj )(h∗i − h∗j )

X

(pi pj + qi qj )(h∗i − h∗j ),

= dimF (D)

aQ

1≤i<j≤l

and that
2ρQH

aQ

= dimF (D)

1≤i<j≤l

so
(2ρQ,+ − 2ρQH )

aQ

X

= dimF (D)

(pi − qi )(qj − pj )(h∗i − h∗j ).

1≤i<j≤l

Since

l
P

i=1

pi =

l
P

qi = n, we have

i=1

(h∗i

−

h∗j )(̟k∨ )

(
0, if k + 1 ≤ i < j ≤ l or 1 ≤ i < j ≤ k;
=
1, if 1 ≤ i ≤ k and k + 1 ≤ j ≤ l.

Then
(2ρQ,+ − 2ρQH )(̟k∨ ) = dimF (D)

X

(pi − qi )(qj − pj )

1≤i≤k
k+1≤j≤l



= dimF (D) 


= dimF (D) 

X

pi −

X

1≤i≤k

1≤i≤k

X

X

pi −

1≤i≤k

1≤i≤k



qi  
2

X

k+1≤j≤l

qi  ≥ 0.

qj −

X

k+1≤j≤l



pj 

It is clear that (2ρQ,+ − 2ρQH )(̟k∨ ) = 0 for all 1 ≤ k ≤ l − 1 if and only if pi = qi for all 1 ≤ i ≤ l.
24



5.3. Exponential polynomials. Let T1 , T2 ∈ a0 . Following [3, §2], define ΓP (T1 , T2 ) ∈ R inductively
on dim(AP /AG ) by setting
X
(−1)dim(AQ /AG ) τbPQ (T1 )ΓQ (T1 , T2 )
τbPG (T1 − T2 ) =
{Q:P ⊆Q}

for any relatively standard parabolic subgroup P of G. This definition can be explicitly given by [3, (2.1)
in p. 13] and only depends on the projections of T1 , T2 onto aG
P . For T = (t1 , ..., tp+q ) ∈ a0 , we denote
∗
∗
Σ1 (T ) := t1 + ... + tp . If we use the notation in Section 3.4 and put e∗i ∈ a∗0 (resp.
P fi ∈∗ a0 ) to be the
character of the action of A0 on ei (resp. fi ), it is equivalent to say that Σ1 = 1≤i≤p ei . For T2 ∈ aQ
and s ∈ C, write
Z
(5.3.1)
pQ,s (T2 ) :=
e(2ρQ,+ −2ρQH +sΣ1 )(T1 ) ΓQ (T1 , T2 )dT1 .
aG
Q

When p = q = n, s = 0 and Q is ω-stable, it is reduced to
Z
pQ,0 (T2 ) =
ΓQ (T1 , T2 )dT1
aG
Q

by Lemma 5.5.
b R )∨ the lattice
For Q ⊆ R a pair of relatively standard parabolic subgroups of G, denote by Z(∆
Q
R
∨
R
G
∨
G
∨
G
b ) in a and by Z(∆ ) the lattice generated by (∆ ) in a . Following [3, §2], for
generated by (∆
Q
Q
R
R
R
λ ∈ a∗Q,C := a∗Q ⊗R C, define
Y

R
b R ∨ −1
λ(̟∨ )
θbQ
(λ) := vol(aR
Q Z(∆Q ) )
b R )∨
̟ ∨ ∈(∆
Q

and


G ∨ −1
G
θR
(λ) := vol(aG
R Z(∆R ) )

Y

λ(α∨ ).

∨
α∨ ∈(∆G
R)

Proposition 5.6. Let Q be a relatively standard parabolic subgroup of G, T2 ∈ aQ and s ∈ C. The
function T1 7→ ΓQ (T1 , T2 ) is compactly supported on aG
Q . Moreover, the function T2 7→ pQ,s (T2 ) is an
exponential polynomial in T2 ; more precisely, there exists a polynomial pQ,R,s (not necessarily unique)
on aG
R of degree ≤ dim(AQ /AG ) for each relatively standard parabolic subgroup R containing Q such that
X
G
G
e(2ρR,+ −2ρRH +sΣ1 )(T2,R ) pQ,R,s (T2,R
),
pQ,s (T2 ) =
{R:Q⊆R}

G
R
G
where we write T2,R
for the projection of T2 ∈ aQ in aG
R via the decomposition aQ = aQ ⊕ aR ⊕ aG . When
p = q = n and s = 0, the purely polynomial term of pQ,0 (T2 ) is given by
X
G
pQ,R,0 (T2,R
),
{R:Q⊆R,ωRω −1 =R}

which is a homogeneous polynomial in T2 of degree dim(AQω-st /AG ); in particular, if Q is ω-stable, then
pQ,0 (T2 ) is a homogeneous polynomial in T2 of degree dim(AQ /AG ).
Proof. The first statement is [3, Lemmas 2.1]. First let us prove the second one.
From [3, Lemma 2.2], we know that the integral
Z
eλ(T1 ) ΓQ (T1 , T2 )dT1
aG
Q

is an entire function in λ ∈ a∗Q,C , and its value is given by
X
G
R
G
(−1)dim(AQ /AR ) eλ(T2,R ) θbQ
(λ)−1 θR
(λ)−1
{R:Q⊆R}

when the latter expression makes sense.
R
G
Fix ε ∈ a∗Q,C such that θbQ
(ε) 6= 0 and θR
(ε) 6= 0 for all relatively standard parabolic subgroups R
×
R
containing Q. Then for t ∈ R whose absolute value is small enough, we also have θbQ
(2ρQ,+ − 2ρQH +
25

G
sΣ1 + tε) 6= 0 and θR
(2ρQ,+ − 2ρQH + sΣ1 + tε) 6= 0 for all relatively standard parabolic subgroups R
containing Q. Let λ = 2ρQ,+ − 2ρQH + sΣ1 + tε in the formula above, and we obtain
X
G
R
(2ρQ,+ − 2ρQH + sΣ1 + tε)−1
(−1)dim(AQ /AR ) e(2ρQ,+ −2ρQH +sΣ1 +tε)(T2,R ) θbQ
pQ,s (T2 ) = lim
t7→0

·

{R:Q⊆R}

G
θR
(2ρQ,+

− 2ρQH + sΣ1 + tε)−1 .

Since the restriction of 2ρQ,+ − 2ρQH + sΣ1 to aR equals 2ρR,+ − 2ρRH + sΣ1 , we get
G

G

e(2ρQ,+ −2ρQH +sΣ1 )(T2,R ) = e(2ρR,+ −2ρRH +sΣ1 )(T2,R ) .
G
We can put pQ,R,s (T2,R
) to be the constant term of the Laurent series development around t = 0 of
G

G
R
(2ρQ,+ − 2ρQH + sΣ1 + tε)−1 .
(2ρQ,+ − 2ρQH + sΣ1 + tε)−1 θR
t 7→ (−1)dim(AQ /AR ) e(tε)(T2,R ) θbQ

G
G
Then pQ,R,s (T2,R
) is a polynomial in T2,R
of degree ≤ dim(AQ /AG ). Hence we prove the existence in
the second statement.
Now let p = q = n and s = 0. From Lemma 5.5, we know that the purely polynomial term of pQ,0 (T2 )
is given by
X
G
pQ,R,0 (T2,R
).
{R:Q⊆R,ωRω −1 =R}

Next we compute the degree of pQ,R,0 that we chose above for each ω-stable parabolic subgroup R
containing Q. Denote
b R )∨ : (2ρQ,+ − 2ρQH )(̟∨ ) = 0}
N1 := ♯{̟∨ ∈ (∆
Q
and
∨
∨
N2 := ♯{α∨ ∈ (∆G
R ) : (2ρQ,+ − 2ρQH )(α ) = 0},
where ♯ means the cardinality of a finite set. Then
deg(pQ,R,0 ) = N1 + N2 .

b G )∨ and (∆G )∨ are bases of aG . Since R is relatively standard and ω-stable, by
Recall that both of (∆
R
R
R
Lemma 5.5, we have
N2 = dim(AR /AG ).
Keep the notation as in the proof of Lemma 5.5 for Q. Since R is relatively standard and ω-stable, by
Proposition 5.1, we may suppose that R is the stabiliser in G of the flag
0 ( he1 , ···, er1 , f1 , ···, fr1 iD ( he1 , ···, er1 +r2 , f1 , ···, fr1 +r2 iD ( ... ( he1 , ···, er1 +···+rl′ , f1 , ···, fr1 +···+rl′ iD .
The fact that Q ⊆ R tells us that both of the partitions (p1 , · · ·, pl ) and (q1 , · · ·, ql ) are refinements of
the partition (r1 , · · ·, rl′ ) of n, and that every ri is divided into the same number of segments in these
two refinements. Then
)
(
j
k
X
X
′
R
∨
∨
G
∨
R
b Q ) = projection of ̟k ∈ (∆
b Q ) to aQ 1 ≤ k ≤ l − 1,
2ri ∀1 ≤ j ≤ l − 1
(pi + qi ) 6=
(∆
=

(

i=1

i=1

projection of

̟k∨

∈

∨
bG
(∆
Q)

to

aR
Q

′

1 ≤ k ≤ l − 1, ∄1 ≤ j ≤ l − 1s.t.

k
X
i=1

pi =

k
X

qi =

i=1

j
X
i=1

ri

)

.

Because the restriction of 2ρQ,+ − 2ρQH to aR equals 2ρR,+ − 2ρRH and R is relatively standard and
ω-stable, by Lemma 5.5, we do not need the projection, i.e.,




b G )∨ .
b G )∨ to aR = (2ρQ,+ − 2ρQH ) ̟∨ ∈ (∆
(2ρQ,+ − 2ρQH ) projection of ̟k∨ ∈ (∆
k
Q
Q
Q
From the proof of Lemma 5.5, for any 1 ≤ k ≤ l, we have (2ρQ,+ − 2ρQH )(̟k∨ ) = 0 if and only if
k
k
P
P
ω-st
qi . We can also see that Q
pi =
is the ω-stable parabolic subgroup R containing Q with
i=1

i=1

maximal l′ := dim(AR ). To sum up, we have

N1 = dim(AQω-st /AR ).
Hence for each ω-stable parabolic subgroup R containing Q,
deg(pQ,R,0 ) = N1 + N2 = dim(AQω-st /AR ) + dim(AR /AG ) = dim(AQω-st /AG ).
The assertion about the particular case where Q is ω-stable is [3, Lemma 2.2] combined with Lemma
5.5; it can also be read from the results above that we have proved.

26

5.4. Quantitive behaviour in T . For a relatively standard parabolic subgroup Q of G, let {sQ
i }1≤i≤l ∈
Zl be the explicit constants determined by
Y
sQ
(5.4.1)
|Nrd(xi,1 )|Ai = e(2ρQ,+ −2ρQH )(HQH (x))
1≤i≤l

1

for all x ∈ MQH (A) ∩ MQ (A) , where we write x = (x1 , ..., xl ) ∈ GLp1 +q1 ,D (A) × · · · × GLpl +ql ,D (A) and
sQ

xi = (xi,1 , xi,2 ) ∈ GLpi ,D (A) × GLqi ,D (A). If pi qi = 0 for some 1 ≤ i ≤ l, we shall take |Nrd(xi,1 )|Ai = 1
and sQ
i = 0 by convention. Then such constants are unique.
Proposition 5.7. Let Q be a relatively standard parabolic subgroup of G. If pi qi 6= 0 for some 1 ≤ i ≤ l,
then
!
X
X
Q
si = 2d
(pk − qk ) +
(qk − pk ) .
k<i

When p = q = n, if Q is ω-stable, then

sQ
i

k>i

= 0 for all 1 ≤ i ≤ l.

Proof. Assume that pi qi 6= 0 for some 1 ≤ i ≤ l. Let x ∈ MQH (A). We have
P
P 
qk -th power of |Nrd(xi,1 )|A ;
(1) the contribution of xi,1 to e2ρQ,+ (HQH (x)) is the d
qk −
(2) the contribution of xi,1 to e2ρQH (HQH (x))

(3) the contribution of xi,2 to e

2ρQ,+ (HQH (x))

(4) the contribution of xi,2 to e

2ρQH (HQH (x))

k>i

k<i

k>i

k<i

k>i

k<i

k>i

k<i

P
P 
pk -th power of |Nrd(xi,1 )|A ;
pk −
is the d

P
P 
pk -th power of |Nrd(xi,2 )|A ;
is the d
pk −

P
P 
qk -th power of |Nrd(xi,2 )|A .
is the d
qk −


P
P
In sum, the contribution of xi to e(2ρQ,+ −2ρQH )(HQH (x)) is the product of the d
(pk −qk )+ (qk −pk ) k>i
k<i

P
P
(pk − qk ) -th power of |Nrd(xi,2 )|A .
th power of |Nrd(xi,1 )|A and the d
(qk − pk ) +
k<i

k>i

)Nrd(xi,2 )|A = |Nrd(x
Now let x ∈ MQH (A) ∩ MQ (A)1 . Then |Nrd(x
i )|A = 1. Therefore, the
i,1
P
P
(2ρQ,+ −2ρQH )(HQH (x))
contribution of xi to e
is the 2d
(pk −qk )+ (qk −pk ) -th power of |Nrd(xi,1 )|A .
k<i

k>i

We have proved the first statement.
The second statement is nothing but a special case of the first one, since we have pk = qk for 1 ≤ k ≤ l
in this case.


Theorem 5.8. Let T ′ be sufficiently regular, o ∈ O and f ∈ S(s(A)). Then for all sufficiently regular
T and s ∈ C, we have
X
′ G
′
η
JoG,T (η, s, f ) =
pQ,s (TQ − TQ′ )e(2ρQ,+ −2ρQH +sΣ1 )((T )Q ) JoQ,T (η, {sQ
i + s}, fQ ),
e0 ⊆Q}
{Q:P

′
G
G
where we write (T ′ )G
Q for the projection of TQ ∈ aQ in aQ via the decomposition aQ = aQ ⊕ aG , the
′

η
distributions JoG,T and JoQ,T are defined by the formulae (5.0.1) and (5.1.2) respectively, and fQ
and
pQ,s are defined by the formulae (5.1.3) and (5.3.1) respectively.

Corollary 5.9. Let o ∈ O, f ∈ S(s(A)) and s ∈ C. Then the functions T 7→ JoG,T (η, s, f ) and
T 7→ J G,T (η, s, f ) are the restriction of exponential polynomials in T , so we can extend them to all
T ∈ a0 . When p = q = n and s = 0, their purely polynomial terms have degree ≤ n − 1; in particular, if
o ∈ O× (e.g., o ∈ Ors ), T 7→ JoG,T (η, 0, f ) is the restriction of a polynomial in T of degree ≤ n − 1.
Proof of Corollary 5.9. It results from Theorem 5.8, Propositions 5.6 and 5.4.



Remark 5.10. We may extend our result to the product form in Section 5.1 by similar argument. Let Q
be a relatively standard parabolic subgroup of G. Let o ∈ O, f ′ ∈ S((mQ ∩ s)(A)) and {si }1≤i≤l ∈ Cl .
Then the functions JoQ,T (η, {si }, f ′ ) and J Q,T (η, {si }, f ′ ) are the restriction of exponential polynomials
in T independent of TQ , so we can extend them to all T ∈ a0 .
27

Proof of Theorem 5.8. Let P be a relatively standard parabolic subgroup of G, δ ∈ PH (F )\H(F ) and
x ∈ H(A) ∩ G(A)1 . Substituting T1 = HP (δx) − TP′ and T2 = TP − TP′ in the definition of ΓP (T1 , T2 ),
we get
X
(−1)dim(AQ /AG ) τbPQ (HP (δx) − TP′ )ΓQ (HP (δx) − TP′ , TP − TP′ ).
τbPG (HP (δx) − TP ) =
{Q:P ⊆Q}

Then

JoG,T (η, s, f ) =

Z

H(F )\H(A)∩G(A)1




X

(−1)dim(AP /AG )

δ∈PH (F )\H(F )

e0 ⊆P }
{P :P
s
η(Nrd(x))|Nrd(x1 )|A dx

=

·
Z

H(F )\H(A)∩G(A)1




X

{Q:P ⊆Q}

X

X

τbPG (HP (δx) − TP ) · kf,P,o (δx)

X

(−1)dim(AP /AG )

e0 ⊆P }
{P :P



δ∈PH (F )\H(F )



(−1)dim(AQ /AG ) τbPQ (HP (δx) − TP′ )ΓQ (HP (δx) − TP′ , TP − TP′ ) kf,P,o (δx)

· η(Nrd(x))|Nrd(x1 )|sA dx.

Exchanging the order of two sums over P and Q, and decomposing the sum over PH (F )\H(F ) into two
sums over PH (F )\QH (F ) and QH (F )\H(F ), we have
X
X
X
X Z
(−1)dim(AP /AQ )
JoG,T (η, s, f ) =
H(F )\H(A)∩G(A)1

e0 ⊆Q}
{Q:P

e0 ⊆P ⊆Q}
{P :P

δ ′ ∈QH (F )\H(F ) δ∈PH (F )\QH (F )

τbPQ (HP (δδ ′ x) − TP′ )ΓQ (HP (δδ ′ x) − TP′ , TP − TP′ )kf,P,o (δδ ′ x)η(Nrd(x))|Nrd(x1 )|sA dx.

Combining the integral over H(F )\H(A) ∩ G(A)1 and the sum over QH (F )\H(F ) into an integral over
QH (F )\H(A) ∩ G(A)1 , and using the fact that
PH (F )\QH (F ) ≃ (PH (F ) ∩ MQH (F ))\MQH (F ),
we obtain
JoG,T (η, s, f ) =

X

e0 ⊆Q}
{Q:P

Z

QH (F )\H(A)∩G(A)1

τbPQ (HP (δx)

X

X

(−1)dim(AP /AQ )

e0 ⊆P ⊆Q}
{P :P

δ∈(PH (F )∩MQH (F ))\MQH (F )

− TP′ )ΓQ (HP (δx) − TP′ , TP − TP′ )kf,P,o (δx)η(Nrd(x))|Nrd(x1 )|sA dx.

By Iwasawa decomposition and our choices of measures, the integral over QH (F )\H(A) ∩ G(A)1 can
be decomposed as integrals over
× MQH (F )\MQH (A) ∩ MQ (A)1 × KH .
(n, a, m, k) ∈ NQH (F )\NQH (A) × AG,∞
Q
Then
JoG,T (η, s, f )

=

X

e0 ⊆Q}
{Q:P

Z

KH

Z

X

MQH (F )\MQH (A)∩MQ (A)1

δ∈(PH (F )∩MQH (F ))\MQH (F )

Z

AG,∞
Q

τbPQ (HP (δnamk)

Z

NQH (F )\NQH (A)

X

(−1)dim(AP /AQ )

e0 ⊆P ⊆Q}
{P :P

− TP′ )ΓQ (HP (δnamk) − TP′ , TP − TP′ )

· kf,P,o (δnamk)η(Nrd(mk))|Nrd(a1 m1 )|sA e−2ρQH (HQH (am)) dndadmdk.
Notice that

and that

τbPQ (HP (δnamk) − TP′ ) = τbPQ (HP (δm) + HP (a) − TP′ ) = τbPQ (HP (δm) − TP′ ),

ΓQ (HP (δnamk) − TP′ , TP − TP′ ) = ΓQ (HQ (δnamk) − TQ′ , TQ − TQ′ ) = ΓQ (HQ (a) − TQ′ , TQ − TQ′ ).
28

In addition, by change of variables, we see that
X

kf,P,o (δnamk) =

X∈mP (F )∩o

X

=

X∈mP (F )∩o

X

=

X∈mP (F )∩o

Z

f ((δnamk)−1 (X + U )δnamk)dU

(nP ∩s)(A)

Z

f ((δa−1 namk)−1 (X + a−1 U a)δa−1 namk)dU

(nP ∩s)(A)

Z

f ((δa−1 namk)−1 (X + U )δa−1 namk)e2ρQ,+ (HQ (a)) dU

(nP ∩s)(A)

= e2ρQ,+ (HQ (a)) kf,P,o (δa−1 namk).
Since δa−1 naδ −1 ∈ NQH (A) ⊆ NPH (A) and kf,P,o is left invariant by NPH (A), we deduce that
kf,P,o (δnamk) = e2ρQ,+ (HQ (a)) kf,P,o (δmk).
In sum, the integrand for the term indexed by Q in the above formula for JoG,T (η, s, f ) is independent
of n ∈ NQH (F )\NQH (A). We can choose the Haar measure such that vol(NQH (F )\NQH (A)) = 1. Then
JoG,T (η, s, f ) =

X

e0 ⊆Q}
{Q:P

Z

Z

AG,∞
Q

|Nrd(a1 )|sA e(2ρQ,+ −2ρQH )(HQ (a)) ΓQ (HQ (a) − TQ′ , TQ − TQ′ )da

MQH (F )\MQH (A)∩MQ (A)1

τbPQ (HP (δm) − TP′ )

Z

KH

X

(−1)dim(AP /AQ )

e0 ⊆P ⊆Q}
{P :P



!

X

δ∈(PH (F )∩MQH (F ))\MQH (F )

kf,P,o (δmk)η(Nrd(k))dk η(Nrd(m))|Nrd(m1 )|sA e−2ρQH (HQH (m)) dm.

By the definition of the Haar measure on AG,∞
, we have
Q
Z

AG,∞
Q

:=

Z

aG
Q

=e

|Nrd(a1 )|sA e(2ρQ,+ −2ρQH )(HQ (a)) ΓQ (HQ (a) − TQ′ , TQ − TQ′ )da

e(2ρQ,+ −2ρQH +sΣ1 )(T1 ) ΓQ (T1 − TQ′ , TQ − TQ′ )dT1

(2ρQ,+ −2ρQH +sΣ1 )((T ′ )G
Q)

Z

aG
Q

=e(2ρQ,+ −2ρQH +sΣ1 )((T

′ G
)Q )

e(2ρQ,+ −2ρQH +sΣ1 )(T1 ) ΓQ (T1 , TQ − TQ′ )dT1

pQ,s (TQ − TQ′ ).

Since nP = nQ
P ⊕ nQ , by change of variables, we see that
kf,P,o (δmk) =

X

X∈mP (F )∩o

Z

(nQ
P ∩s)(A)

= e2ρQ,+ (HQH (m))

dU

X

Z

f ((δmk)−1 (X + U + V )δmk)dV

(nQ ∩s)(A)

X∈mP (F )∩o

Z

(nQ
P ∩s)(A)

so we can write
Z
kf,P,o (δmk)η(Nrd(k))dk = e2ρQ,+ (HQH (m))
KH

= e2ρQ,+ (HQH (m))

dU

Z

f (k −1 ((δm)−1 (X + U )δm + V )k)dV,
(nQ ∩s)(A)

X

X∈mP (F )∩o
t
X

j=1
29

M

Z

(nQ
P ∩s)(A)

kf ηQ,P ∩MQ ,oj (δm)
Q

η
fQ
((δm)−1 (X + U )δm)dU

by (5.1.1). Now we can draw our conclusion by noting that
t Z
X
X
′
η
JoQ,T (η, {sQ
+
s},
f
)
=
i
Q
MQH (F )\MQH (A)∩MQ (A)1

j=1

X

e0 ⊆P ⊆Q}
{P :P
M

δ∈((P ∩MQ )(F )∩MQH (F ))\MQH (F )
M

(−1)dim(AP ∩MQ /AMQ )

Q
τbP ∩M
(HP ∩MQ (δm) − (ςQ T ′ )P ∩MQ )
Q

· kf ηQ,P ∩MQ ,oj (δm)η(Nrd(m))|Nrd(m1 )|sA e(2ρQ,+ −2ρQH )(HQH (m)) dm
Z Q
X
X
(−1)dim(AP /AQ )
=
MQH (F )\MQH (A)∩MQ (A)1



τbPQ (HP (δm) − TP′ ) 

t
X
j=1

e0 ⊆P ⊆Q}
{P :P

δ∈(PH (F )∩MQH (F ))\MQH (F )



M
kf ηQ,P ∩MQ ,oj (δm) η(Nrd(m))|Nrd(m1 )|sA
Q

· e(2ρQ,+ −2ρQH )(HQH (m)) dm.


5.5. Independence of constant terms. Let JoG (η, s, f ) and J G (η, s, f ) be the constant terms of
JoG,T (η, s, f ) and J G,T (η, s, f ) respectively. We fix a common minimal Levi subgroup M0 of H and
G.
Firstly, the distributions JoG (η, s, f ) and J G (η, s, f ) are independent of the choice of the relatively
standard minimal parabolic subgroup P0 of G at the very beginning of last section. In fact, let P0′ be
another relatively standard minimal parabolic subgroup of G and σ ∈ ΩG such that P0′ = σP0 . Denote
G
′
by JPG,T
′ ,o (η, s, f ) and JP ′ ,o (η, s, f ) the distributions obtained starting from P0 . Then if T ∈ aP ′ , we have
0
0

0

−1

JPG,T
(η, s, f ) = JoG,σ T (η, s, f ), so JPG′ ,o (η, s, f ) = JoG (η, s, f ).
′
0
0 ,o
Secondly, the distributions JoG (η, s, f ) and J G (η, s, f ) are independent of the choice of the minimal
parabolic subgroup Pe0 of H. In fact, let Pe0′ be another minimal parabolic subgroup of H and σ ∈ ΩH
G
such that Pe0′ = σ −1 Pe0 . Put P0′ := σ −1 P0 . Denote by JPG,T
e′ ,o (η, s, f ) the distributions
e′ ,o (η, s, f ) and JP
0

0

obtained starting from Pe0′ and P0′ . We can apply the argument of [5, Proposition 4.6] after some minor
−1
T
(η, s, f ), so JoG (η, s, f ) = JPG
modifications here to prove that JoG,T (η, s, f ) = J G,σ
e′ ,o (η, s, f ).
e′
P0 ,o

0

6. Non-equivariance
Let Q be a relatively standard parabolic subgroup of G, s ∈ R and y ∈ H(A)∩G(A)1 . For f ∈ S(s(A)),
η
define fQ,s,y
∈ S((mQ ∩ s)(A)) by
Z
Z
η
(6.0.1)
fQ,s,y (X) :=
f (k −1 (X + V )k)η(Nrd(k))pQ,s (−HQ (ky))dV dk
KH

(nQ ∩s)(A)

for all X ∈ (mQ ∩ s)(A), where pQ,s is defined by the formula (5.3.1).
Proposition 6.1. For f ∈ S(s(A)) and y ∈ H(A) ∩ G(A)1 , we denote f y (x) := f (yxy −1 ). Then for all
sufficiently regular T , o ∈ O and s ∈ R, we have
X
G
η
JoG,T (η, s, f y ) = η(Nrd(y))|Nrd(y1 )|sA
e(2ρQ,+ −2ρQH +sΣ1 )(TQ ) JoQ,T (η, {sQ
i + s}, fQ,s,y ),
e0 ⊆Q}
{Q:P

l
where JoG,T and JoQ,T are defined by the formulae (5.0.1) and (5.1.2) respectively, {sQ
i }1≤i≤l ∈ Z are
G
G
the explicit constants determined by (5.4.1), and we write TQ for the projection of TQ ∈ aQ in aQ via
the decomposition aQ = aG
Q ⊕ aG .

For o ∈ O and f ∈ S(s(A)) (resp. f ′ ∈ S((mQ ∩ s)(A))), thanks to Corollary 5.9 (resp. Remark 5.10),
we may take the constant term JoG (η, s, f ) of JoG,T (η, s, f ) (resp. JoQ (η, {si }, f ′ ) of JoQ,T (η, {si }, f ′ )) for
s ∈ C (resp. {si }1≤i≤l ∈ Cl ). When s = 0 (resp. si = 0 for all 1 ≤ i ≤ l), denote JoG (η, f ) := JoG (η, 0, f )
(resp. JoQ (η, f ′ ) := JoQ (η, {0}, f ′)).
30

Corollary 6.2. Assume that p = q = n. Let f ∈ S(s(A)), y ∈ H(A) ∩ G(A)1 and o ∈ O. We have
X
η
JoG (η, f y ) = η(Nrd(y))
JoQ (η, fQ,0,y
).
e0 ⊆Q,ωQω −1 =Q}
{Q:P

Proof of Corollary 6.2. We apply Proposition 6.1 to the case s = 0 and consider the constant terms of
both sides. Because JoQ,T is independent of TQ , by Lemma 5.5, only ω-stable Q contribute to the purely

polynomial term. Then we apply Proposition 5.7 to the case p = q = n to conclude.
Proof of Proposition 6.1. By definition,

Z
X

JoG,T (η, s, f y ) =

(−1)dim(AP /AG )

H(F )\H(A)∩G(A)1

·

e0 ⊆P }
{P :P
s
η(Nrd(x))|Nrd(x1 )|A dx,

where

X

kf y ,P,o (δx) =

X∈mP (F )∩o

H(F )\H(A)∩G(A)1

·

δ∈PH (F )\H(F )

Z

By change of variables, we have

Z

JoG,T (η, s, f y ) =

X



τbPG (HP (δx) − TP ) · kf y ,P,o (δx)

f (y(δx)−1 (X + U )δxy −1 )dU = kf,P,o (δxy −1 ).

(nP ∩s)(A)

X

(−1)dim(AP /AG )

e0 ⊆P }
{P :P
η(Nrd(xy))|Nrd(x1 y1 )|sA dx.

X

δ∈PH (F )\H(F )



τbPG (HP (δxy) − TP ) · kf,P,o (δx)

For x ∈ H(A) and P a relatively standard parabolic subgroup of G, let kP (x) be an element in KH
such that xkP (x)−1 ∈ PH (A). Then
τbPG (HP (δxy) − TP ) = τbPG (HP (δx) − TP + HP (kP (δx)y)).

Substituting T1 = HP (δx) − TP and T2 = −HP (kP (δx)y) in the definition of ΓP (T1 , T2 ), we get
X
(−1)dim(AQ /AG ) τbPQ (HP (δx) − TP )ΓQ (HP (δx) − TP , −HP (kP (δx)y)).
τbPG (HP (δxy) − TP ) =
{Q:P ⊆Q}

Thus

JoG,T (η, s, f y ) =

Z

H(F )\H(A)∩G(A)1




X

{Q:P ⊆Q}

X

(−1)dim(AP /AG )

e0 ⊆P }
{P :P

X

δ∈PH (F )\H(F )



(−1)dim(AQ /AG ) τbPQ (HP (δx) − TP )ΓQ (HP (δx) − TP , −HP (kP (δx)y))

· kf,P,o (δx)η(Nrd(xy))|Nrd(x1 y1 )|sA dx,

Exchanging the order of two sums over P and Q, and decomposing the sum over PH (F )\H(F ) into two
sums over PH (F )\QH (F ) and QH (F )\H(F ), we obtain
X
X
X
X Z
(−1)dim(AP /AQ )
JoG,T (η, s, f y ) =
e0 ⊆Q}
{Q:P

H(F )\H(A)∩G(A)1

e0 ⊆P ⊆Q}
{P :P

τbPQ (HP (δδ ′ x) − TP )ΓQ (HP (δδ ′ x)
· |Nrd(x1 y1 )|sA dx.

δ ′ ∈QH (F )\H(F ) δ∈PH (F )\QH (F )

− TP , −HP (kP (δδ ′ x)y))kf,P,o (δδ ′ x)η(Nrd(xy))

Combining the integral over H(F )\H(A) ∩ G(A)1 and the sum over QH (F )\H(F ) into the integral over
QH (F )\H(A) ∩ G(A)1 , and using the fact that
PH (F )\QH (F ) ≃ (PH (F ) ∩ MQH (F ))\MQH (F ),
we have
JoG,T (η, s, f y ) =

X

e0 ⊆Q}
{Q:P

Z

QH (F )\H(A)∩G(A)1

τbPQ (HP (δx)

X

e0 ⊆P ⊆Q}
{P :P

(−1)dim(AP /AQ )

X

δ∈(PH (F )∩MQH (F ))\MQH (F )

− TP )ΓQ (HP (δx) − TP , −HP (kP (δx)y))kf,P,o (δx)η(Nrd(xy))|Nrd(x1 y1 )|sA dx.
31

By Iwasawa decomposition and our choices of measures, the integral over QH (F )\H(A) ∩ G(A)1 can
be decomposed as integrals over
× MQH (F )\MQH (A) ∩ MQ (A)1 × KH .
(n, a, m, k) ∈ NQH (F )\NQH (A) × AG,∞
Q
Then
X

JoG,T (η, s, f y ) =

e0 ⊆Q}
{Q:P

Z

KH

Z

MQH (F )\MQH (A)∩MQ

X

δ∈(PH (F )∩MQH (F ))\MQH (F )

(A)1

Z

AG,∞
Q

Z

NQH (F )\NQH (A)

X

(−1)dim(AP /AQ )

e0 ⊆P ⊆Q}
{P :P

τbPQ (HP (δnamk) − TP )ΓQ (HP (δnamk) − TP , −HP (kP (δnamk)y))

· kf,P,o (δnamk)η(Nrd(mky))|Nrd(a1 m1 y1 )|sA e−2ρQH (HQH (am)) dndadmdk.
As in the proof of Theorem 5.8, we see that
τbPQ (HP (δnamk) − TP ) = τbPQ (HP (δm) − TP ),

and that

kf,P,o (δnamk) = e2ρQ,+ (HQ (a)) kf,P,o (δmk).
In addition,
ΓQ (HP (δnamk) − TP , −HP (kP (δnamk)y)) = ΓQ (HQ (δnamk) − TQ , −HQ (kP (δnamk)y))
= ΓQ (HQ (a) − TQ , −HQ (kQ (δnamk)y))
= ΓQ (HQ (a) − TQ , −HQ (ky)).
To sum up, the integrand for the term indexed by Q in the above formula for JoG,T (η, s, f y ) is independent
of n ∈ NQH (F )\NQH (A). We can choose the Haar measure such that vol(NQH (F )\NQH (A)) = 1. Then
Z
Z
X Z
X
JoG,T (η, s, f y ) =
(−1)dim(AP /AQ )
e0 ⊆Q}
{Q:P

KH

MQH (F )\MQH (A)∩MQ (A)1

X

δ∈(PH (F )∩MQH (F ))\MQH (F )

AG,∞
Q

e0 ⊆P ⊆Q}
{P :P

τbPQ (HP (δm) − TP )ΓQ (HQ (a) − TQ , −HQ (ky))

· e2ρQ,+ (HQ (a)) kf,P,o (δmk)η(Nrd(mky))|Nrd(a1 m1 y1 )|sA e−2ρQH (HQH (am)) dadmdk.
First, let us compute the integral on AG,∞
, which is
Q
Z

AG,∞
Q

:=

Z

aG
Q

=e

|Nrd(a1 )|sA e(2ρQ,+ −2ρQH )(HQ (a)) ΓQ (HQ (a) − TQ , −HQ (ky))da

e(2ρQ,+ −2ρQH +sΣ1 )(T1 ) ΓQ (T1 − TQ , −HQ (ky))dT1

G
(2ρQ,+ −2ρQH +sΣ1 )(TQ
)

Z

aG
Q

e(2ρQ,+ −2ρQH +sΣ1 )(T1 ) ΓQ (T1 , −HQ (ky))dT1

G

=e(2ρQ,+ −2ρQH +sΣ1 )(TQ ) pQ,s (−HQ (ky)).
Next, we consider the integral on KH , which is
Z
kf,P,o (δmk)η(Nrd(k))pQ,s (−HQ (ky))dk.
KH

As in the proof of Theorem 5.8, we see that
Z
X
kf,P,o (δmk) = e2ρQ,+ (HQH (m))
X∈mP (F )∩o

(nQ
P ∩s)(A)

dU

32

Z

f (k −1 ((δm)−1 (X + U )δm + V )k)dV,
(nQ ∩s)(A)

so we can write

Z

kf,P,o (δmk)η(Nrd(k))pQ,s (−HQ (ky))dk
Z
X
η
=e2ρQ,+ (HQH (m))
fQ,s,y
((δm)−1 (X + U )δm)dU
KH

X∈mP (F )∩o

=e2ρQ,+ (HQH (m))

t
X

(nQ
P ∩s)(A)

M

kf ηQ

j=1

Q,s,y ,P ∩MQ ,oj

(δm)

by (5.1.1). Hence
X

JoG,T (η, s, f y ) =η(Nrd(y))|Nrd(y1 )|sA



t
X

M

kf ηQ

Q,s,y ,P ∩MQ ,oj

j=1

X

(−1)dim(AP /AQ )


δ∈(PH (F )∩MQH (F ))\MQH (F )

τbPQ (HP (δm) − TP )

(δm) η(Nrd(m))|Nrd(m1 )|sA e(2ρQ,+ −2ρQH )(HQH (m)) dm.

As in the proof of Theorem 5.8, we notice that
Z
η
JoQ,T (η, {sQ
+
s},
f
)
=
i
Q,s,y

MQH (F )\MQH (A)∩MQ (A)1

P

j=1

(2ρQ,+ −2ρQH )(HQH (m))

X

(−1)dim(AP /AQ )

e0 ⊆P ⊆Q}
{P :P


t
X
M
τbQ (HP (δm) − TP ) 
k ηQ
·e

Z

MQH (F )\MQH (A)∩MQ (A)1

e0 ⊆Q}
{Q:P

X

e0 ⊆P ⊆Q}
{P :P



G

e(2ρQ,+ −2ρQH +sΣ1 )(TQ )

fQ,s,y ,P ∩MQ ,oj

dm.



X

δ∈(PH (F )∩MQH (F ))\MQH (F )

(δm) η(Nrd(m))|Nrd(m1 )|sA

Then we finish the proof.



7. An infinitesimal trace formula for Matp×q,D ⊕ Matq×p,D //GLp,D × GLq,D
Theorem 7.1. For f ∈ S(s(A)) and s ∈ R,
X
X
JoG (η, s, f ) =
JoG (η, s, fˆ),
o∈O

o∈O

where fˆ is the Fourier transform of f defined by (3.5.2), and JoG (η, s, ·) denotes the constant term of
JoG,T (η, s, ·).
Proof. From the Poisson summation formula, we know that for any x ∈ H(A),
X
X
fˆ(x−1 Xx),
f (x−1 Xx) =
X∈s(F )

X∈s(F )

i.e.,
kf,G (x) = kfˆ,G (x).
Using Corollary 4.16, for all sufficiently regular T satisfying α(T ) ≥ ǫ0 k T k for any α ∈ ∆P0 , we
have
Z
G,T
F G (x, T )kf,G (x)η(Nrd(x))|Nrd(x1 )|sA dx ≤ C1 e−N kT k
J
(η, s, f ) −
H(F )\H(A)∩G(A)1

and
J G,T (η, s, fˆ) −

Z

H(F )\H(A)∩G(A)1

F G (x, T )kfˆ,G (x)η(Nrd(x))|Nrd(x1 )|sA dx ≤ C2 e−N kT k .

Thus
|J G,T (η, s, f ) − J G,T (η, s, fˆ)| ≤ (C1 + C2 )e−N kT k .
33

By Corollary 5.9, we know that both of J G,T (η, s, f ) and J G,T (η, s, fˆ) are exponential polynomials in
T . Because we can choose N to be large enough, we deduce that
J G,T (η, s, f ) = J G,T (η, s, fˆ).
Since

X

J G,T (η, s, f ) =

JoG,T (η, s, f )

o∈O

and

J G,T (η, s, fˆ) =

X

JoG,T (η, s, fˆ),

o∈O

we obtain

X

X

JoG,T (η, s, f ) =

o∈O

JoG,T (η, s, fˆ).

o∈O

We may conclude by taking the constant terms of both sides.



8. The second modified kernel
In this section and the next, we shall focus on the case where p = q = n in order to get better
description for distributions associated to regular semi-simple orbits. We shall change our notation by
denoting G := GL2n,D and H := GLn,D × GLn,D without further mention.
Let f ∈ S(s(A)), P be a relatively standard parabolic subgroup of G and o ∈ Ors (see Section 3.3).
For x ∈ PH (F )\H(A), define
X
X
f ((nx)−1 Xnx).
jf,P,o (x) :=
X∈mP (F )∩o n∈NPH (F )

Let T ∈ a0 . For x ∈ H(F )\H(A), define
X
T
jf,o
(x) :=
(−1)dim(AP /AG )
e0 ⊆P }
{P :P

X

δ∈PH (F )\H(F )

τbPG (HP (δx) − TP ) · jf,P,o (δx).

By Lemma 4.2, we know that the sum over δ ∈ PH (F )\H(F ) is finite. Recall that since o ∈ Ors ⊆ O× ,
if mP (F ) ∩ o 6= ∅, then P is ω-stable by Proposition 5.4. Thus the above definitions only involve the
relatively standard parabolic subgroups that are ω-stable.
Lemma 8.1. Let P be a relatively standard parabolic subgroup of G and o ∈ Ors . For X ∈ mP (F ) ∩ o,
the map
NPH → nP ∩ s, n 7→ n−1 Xn − X
is an F -isomorphism of algebraic varieties and preserves the Haar measures on A-points.
Proof. Since P is relatively standard and ω-stable, we can suppose
×

pn,D pn,D
,
P =
pn,D pn,D
where



Then we have
mP ∩ s =
Let





Pn,D = 


GLn1 ,D

mPn,D

mPn,D

Matn1 ×n2 ,D
GLn2 ,D

···
···
..
.

Matn1 ×nl ,D
Matn2 ×nl ,D
..
.
GLnl ,D



, NPH =







X=
 B1





NPn,D

NPn,D

A1
..

..

.
Bl
34

.





, nP ∩ s =





.




nPn,D




Al 
 ∈ mP (F ) ∩ o,





nPn,D



.

where Ai , Bi ∈ GLni (D) for 1 ≤ i ≤ l,

1 C12

1





n=







and
···
···
..
.



C1l
C2l
..
.
1
1

D1l
D2l
..
.
1

where Cij , Dij ∈ Matni ×nj ,D for 1 ≤ i < j ≤ l. Then







Xn−nX = 
 0 B1 C12 − D12 B2


0




···
···
..
.

D12
1

0







 ∈ NPH ,







A1 D12 − C12 A2
0

···
···
..
.

A1 D1l − C1l Al
A2 D2l − C2l Al
..
.
0

···
···
..
.

B1 C1l − D1l Bl
B2 C2l − D2l Bl
..
.
0

We claim that the morphism of F -affine spaces









 ∈ nP ∩s.







Matni ×nj ,D ⊕ Matni ×nj ,D → Matni ×nj ,D ⊕ Matni ×nj ,D
(Cij , Dij ) 7→ (Ai Dij − Cij Aj , Bi Cij − Dij Bj )
induces an F -linear isomorphism on F -points. In fact, since it gives an F -linear map between finite
dimensional linear spaces of the same dimension, we only need to prove that this map is injective under
base change to an algebraic closure of F . Then without loss of generality, it suffices to consider the
case where D = F . If Ai Dij − Cij Aj = Bi Cij − Dij Bj = 0, then Cij Aj Bj = Ai Dij Bj = Ai Bi Cij
and Dij Bj Aj = Bi Cij Aj = Bi Ai Dij . Since X is regular semi-simple, Ai Bi and Aj Bj (resp. Bi Ai and
Bj Aj ) have no common eigenvalue. By the classical theory of Sylvester equation [19], we know that
Cij = Dij = 0 and conclude.
From this claim, we know that the map
NPH → nP ∩ s, n 7→ Xn − nX
is an F -isomorphism of algebraic varieties and preserves the Haar measures on A-points. Notice that
n−1 Xn − X = n−1 (Xn − nX). It is not hard to check that here n−1 functions as some translation
Ai Dij − Cij Aj 7→ Ai Dij − Cij Aj + (a polynomial of Ci′ j ′ and Di′ j ′ , i′ > i, j ′ ≤ j or i′ ≥ i, j ′ < j), so an
analogous assertion still holds for the map n 7→ n−1 Xn − X.

Theorem 8.2. For all sufficiently regular T , all s ∈ R and o ∈ Ors ,
Z
T
|jf,o
(x)||Nrd(x1 )|sA dx < ∞,
H(F )\H(A)∩G(A)1

where we write x = (x1 , x2 ) ∈ GLn,D (A) × GLn,D (A). Moreover, for s ∈ C,
Z
G,T
T
Jo (η, s, f ) =
jf,o
(x)η(Nrd(x))|Nrd(x1 )|sA dx.
H(F )\H(A)∩G(A)1

Proof. As in the proof of Theorem 4.14, using the left invariance of jf,P,o by PH (F ), we reduce ourselves
to proving
Z
χTP1 ,P2 (x)|jP1 ,P2 ,o (x)||Nrd(x1 )|sA dx < ∞,
P1,H (F )\H(A)∩G(A)1

where P1 ( P2 are a pair of relatively standard parabolic subgroups of G and for x ∈ P1,H (F )\H(A),
we put
X
(−1)dim(AP /AG ) jf,P,o (x).
jP1 ,P2 ,o (x) :=
{P :P1 ⊆P ⊆P2 }

35

In addition,
X

jf,P,o (x) =

X

X

X

f ((nx)−1 (ξ + X)nx),

P
{R:P1 ⊆R⊆P } ξ∈m
n∈NPH (F )
eR
P (F )∩o X∈(nR ∩s)(F )
1

P
eR
where we use the notations m
P1 and nR in the proof of Proposition 4.15.
Applying Lemma 8.1, we get

X

jf,P,o (x) =

X

X

X

f (x−1 (ξ + X + u)x)

P
{R:P1 ⊆R⊆P } ξ∈m
u∈(nP ∩s)(F )
eR
P (F )∩o X∈(nR ∩s)(F )

=

1

X

X

X

f (x−1 (ξ + X)x).

{R:P1 ⊆R⊆P } ξ∈m
X∈(nR ∩s)(F )
eR
P (F )∩o
1

Hence
X

jP1 ,P2 ,o (x) =




(−1)dim(AP /AG ) 

{P :P1 ⊆P ⊆P2 }

X

=

X

{R:P1 ⊆R⊆P2 } ξ∈m
eR
P (F )∩o
1



X

X

{R:P1 ⊆R⊆P } ξ∈m
X∈(nR ∩s)(F )
eR
P (F )∩o

X



X

{P :R⊆P ⊆P2 }

1



(−1)dim(AP /AG ) 

X




f (x−1 (ξ + X)x)
f (x−1 (ξ + X)x).

X∈(nR ∩s)(F )

By [2, Proposition 1.1], we have
jP1 ,P2 ,o (x) = (−1)dim(AP2 /AG )

X

X

X

X

P

f (x−1 (ξ + X)x).

e P2 (F )∩o X∈(nP2 ∩s)(F )
ξ∈m
1

Applying Lemma 8.1 again, we obtain
jP1 ,P2 ,o (x) = (−1)dim(AP2 /AG )

2
eP
ξ∈m
P1 (F )∩o

f ((n2 x)−1 ξn2 x),

n2 ∈NP2,H (F )

where we denote P2,H := P2 ∩ H.
Decomposing the integral over x ∈ P1,H (F )\H(A)∩G(A)1 into double integrals n1 ∈ NP1,H (F )\NP1,H (A)
and y ∈ MP1,H (F )NP1,H (A)\H(A) ∩ G(A)1 , and using the fact that χTP1 ,P2 (x) is left invariant under
NP1,H (A), we have
Z

P1,H

=

Z

(F )\H(A)∩G(A)1

χTP1 ,P2 (x)|jP1 ,P2 ,o (x)||Nrd(x1 )|sA dx

MP1,H (F )NP1,H (A)\H(A)∩G(A)1

X

·

≤

Z

P
e P2 (F )∩o
ξ∈m
1

X

NP1,H (F )\NP1,H (A)

χTP1 ,P2 (n1 y)

f ((n2 n1 y)−1 ξn2 n1 y) |Nrd(y1 )|sA dn1 dy

n2 ∈NP2,H (F )

MP1,H (F )NP1,H (A)\H(A)∩G(A)1


Z


Z

χTP1 ,P2 (y)

X

P

e P2 (F )∩o
ξ∈m
1

X

NP1,H (F )\NP1,H (A) n ∈N
2
P2,H (F )



|f ((n2 n1 y)−1 ξn2 n1 y)|dn1  |Nrd(y1 )|sA dy.
36

Since P1,H ⊆ P2,H and vol(NP2,H (F )\NP2,H (A)) = 1, we see that
Z
X
|f ((n2 n1 y)−1 ξn2 n1 y)|dn1
NP1,H (F )\NP1,H (A) n ∈N
2
P2,H (F )

=

Z

NP1,H (F )\NP1,H (A)

=

Z

NP1,H (F )\NP1,H (A)

=

Z

NP1,H (F )\NP1,H (A)

Z

X

|f ((n2 nn1 y)−1 ξn2 nn1 y)|dndn1

NP2,H (F )\NP2,H (A) n ∈N
2
P2,H (F )

Z

|f ((nn1 y)−1 ξnn1 y)|dndn1

NP2,H (A)

Z

|f ((n1 y)−1 (ξ + U )n1 y)|dU dn1 ,

(nP2 ∩s)(A)

where we have applied Lemma 8.1 in the last equality. Therefore
Z
χTP1 ,P2 (x)|jP1 ,P2 ,o (x)||Nrd(x1 )|sA dx
P1,H (F )\H(A)∩G(A)1

≤

Z

MP1,H (F )NP1,H (A)\H(A)∩G(A)1

=

P

e P2 (F )∩o
ξ∈m
1

Z

NP1,H (F )\NP1,H (A)

Z

X

χTP1 ,P2 (y)

P1,H (F )\H(A)∩G(A)1

Z

−1

|f ((n1 y)

(nP2 ∩s)(A)

χTP1 ,P2 (x)

X

P
e P2 (F )∩o
ξ∈m
1

!

(ξ + U )n1 y)|dU dn1 |Nrd(y1 )|sA dy
Z

|f (x−1 (ξ + U )x)|dU

(nP2 ∩s)(A)

!

|Nrd(x1 )|sA dx,

whose convergence results from that of the formula (4.2.3) when R = P2 .
Now we begin to prove the second statement. From the first statement, now we have the right to
write
Z
T
jf,o
(x)η(Nrd(x))|Nrd(x1 )|sA dx
1
H(F )\H(A)∩G(A)
Z
X
=
χTP1 ,P2 (x)jP1 ,P2 ,o (x)η(Nrd(x))|Nrd(x1 )|sA dx,
e0 ⊆P1 ⊆P2 }
{P1 ,P2 :P

where

P1,H (F )\H(A)∩G(A)1

X

jP1 ,P2 ,o (x) =

(−1)dim(AP /AG ) jf,P,o (x)

{P :P1 ⊆P ⊆P2 }

X

=

{P :P1 ⊆P ⊆P2 }



(−1)dim(AP /AG ) 

X

X

X∈mP (F )∩o n∈NPH (F )

1



f ((nx)−1 Xnx) .

Decompose the integral over x ∈ P1,H (F )\H(A)∩G(A) into double integrals over n1 ∈ NP1,H (F )\NP1,H (A)
and y ∈ MP1,H (F )NP1,H (A)\H(A) ∩ G(A)1 . Since NP1,H (F )\NP1,H (A) is compact, by Lemma 8.1 and
[21, §41],
X
X
X
X
|f ((n1 y)−1 (X + u)n1 y)|
|f ((nn1 y)−1 Xnn1 y)| =
X∈mP (F )∩o u∈(nP ∩s)(F )

X∈mP (F )∩o n∈NPH (F )

is bounded independently of n1 ∈ NP1,H (F )\NP1,H (A). Then using the fact that χTP1 ,P2 (x) is left invariant
under NP1,H (A), we have
Z
T
(x)η(Nrd(x))|Nrd(x1 )|sA dx
jf,o
H(F )\H(A)∩G(A)1
Z
X
X
(−1)dim(AP /AG )
=
χTP1 ,P2 (y)
e0 ⊆P1 ⊆P2 }
{P1 ,P2 :P

X

X∈mP (F )∩o


Z


MP1,H (F )NP1,H (A)\H(A)∩G(A)1

X

NP1,H (F )\NP1,H (A) n∈N

PH (F )

{P :P1 ⊆P ⊆P2 }



f ((nn1 y)−1 Xnn1 y)dn1  η(Nrd(y))|Nrd(y1 )|sA dy.
37

Since P1,H ⊆ PH and vol(NPH (F )\NPH (A)) = 1, we see that
Z
X
f ((nn1 y)−1 Xnn1 y)dn1
=
=
=

Z

Z

Z

NP1,H (F )\NP1,H (A) n∈N
PH (F )

NP1,H (F )\NP1,H (A)

NP1,H (F )\NP1,H (A)

NP1,H (F )\NP1,H (A)

Z

X

f ((nn2 n1 y)−1 Xnn2 n1 y)dn2 dn1

NPH (F )\NPH (A) n∈N
PH (F )

Z

f ((nn1 y)−1 Xnn1 y)dndn1

NPH (A)

Z

f ((n1 y)−1 (X + U )n1 y)dU dn1 ,

(nP ∩s)(A)

where we have applied Lemma 8.1 in the last equality. Therefore
Z
T
jf,o
(x)η(Nrd(x))|Nrd(x1 )|sA dx
1
H(F )\H(A)∩G(A)
Z
X
X
=
χTP1 ,P2 (y)
e0 ⊆P1 ⊆P2 }
{P1 ,P2 :P

X

X∈mP (F )∩o

=

X

Z

NP1,H (F )\NP1,H (A)

e0 ⊆P1 ⊆P2 }
{P1 ,P2 :P



=

·

X

X∈mP (F )∩o

X

MP1,H (F )NP1,H

Z

Z

Z

Z

(−1)dim(AP /AG )

{P :P1 ⊆P ⊆P2 }

−1

f ((n1 y)

(X + U )n1 y)dU dn1

(nP ∩s)(A)

P1,H (F )\H(A)∩G(A)1

(nP ∩s)(A)

e0 ⊆P1 ⊆P2 }
{P1 ,P2 :P

(A)\H(A)∩G(A)1

X

χTP1 ,P2 (x)

!

η(Nrd(y))|Nrd(y1 )|sA dy

(−1)dim(AP /AG )

{P :P1 ⊆P ⊆P2 }



f (x−1 (X + U )x)dU  η(Nrd(x))|Nrd(x1 )|sA dx

P1,H (F )\H(A)∩G(A)1

χTP1 ,P2 (x)kP1 ,P2 ,o (x)η(Nrd(x))|Nrd(x1 )|sA dx.

From the proof of Theorem 4.14, we are authorised to write
Z
T
G,T
kf,o
(x)η(Nrd(x))|Nrd(x1 )|sA dx
Jo (η, s, f ) =
H(F )\H(A)∩G(A)1
Z
X
=
χTP1 ,P2 (x)kP1 ,P2 ,o (x)η(Nrd(x))|Nrd(x1 )|sA dx,
e0 ⊆P1 ⊆P2 }
{P1 ,P2 :P

P1,H (F )\H(A)∩G(A)1

which completes the proof.


9. Weighted orbital integrals

As in the last section, we shall assume that p = q = n in the following discussion. Moreover, we shall
suppose that s = 0 in the orbital integral for convenience, since |Nrd(x1 )|sA is not invariant under the
G
translation by A∞
G . Recall that for o ∈ O and f ∈ S(s(A)), we denote by Jo (η, f ) the constant term of
G,T
Jo (η, 0, f ).
9.1. Weyl groups. From Section 5.5, we may choose P0 to be the stabiliser in G of the flag
0 ( he1 iD ( he1 , f1 iD ( he1 , f1 , e2 iD ( he1 , f1 , e2 , f2 iD ( · · · ( he1 , f1 · ··, en , fn iD = V ⊕ W
by the notation in Section 3.4. Then all ω-stable relatively standard parabolic subgroups of G contain
P0 . Denote by P0 the stabiliser in G of the flag
0 ( he1 , f1 iD ( he1 , f1 , e2 , f2 iD ( · · · ( he1 , f1 · ··, en , fn iD = V ⊕ W.
It is the minimal ω-stable relatively standard parabolic subgroup of G. A parabolic subgroup P of G
is relatively standard and ω-stable if and only if P0 ⊆ P . Let P0,n be the group of upper triangular
matrices in GLn,D . We can talk about positive roots for G, H and GLn,D with respect to P0 , Pe0 and
P0,n respectively.
38


×

×
p1,n p1,n
p2,n p2,n
Lemma 9.1. Let P1 =
and P2 =
be a pair of ω-stable relatively standard
p1,n p1,n
p2,n p2,n
parabolic subgroups of G, 
where P1,n
 and P2,n are standard parabolic subgroups of GLn,D .
sn
induces a bijection from
1) The map sn 7→ s =
sn
P

2,n
a) the set of representatives sn of ΩGLn,D (aP1,n , aP2,n ) in ΩGLn,D such that s−1
n α > 0 for all α ∈ ∆P0,n

to
2
b) the set of representatives s of ΩG (aP1 , aP2 ) in ΩG such that s−1 α > 0 for all α ∈ ∆P
P0 .


s
2) The map sn 7→ s = n
induces a bijection from
sn

a) the set of representatives sn of ΩGLn,D (aP1,n ; P2,n ) in ΩGLn,D such that sn (aP1,n ) ⊇ aP2,n and
P2,n
s−1
n α > 0 for all α ∈ ∆P0,n
to
b) the set of representatives s of ΩG (aP1 ; P2 ) in ΩG such that s(aP1 ) ⊇ aP2 and s−1 α > 0 for all
2
α ∈ ∆P
P0 .
Proof. Suppose that P1,n and P2,n correspond to the partitions (n1 , · · ·, nl ) and (n′1 , · · ·, n′l′ ) respectively
of n. Then P1 and P2 correspond to the partitions (2n1 , · · ·, 2nl ) and (2n′1 , · · ·, 2n′l′ ) respectively of 2n.
For an integer m > 0, denote by Sm the symmetric group of degree m.
1) From [4, p. 33], the set ΩGLn,D (aP1,n , aP2,n ) is empty unless l = l′ , in which case
(9.1.1)

ΩGLn,D (aP1,n , aP2,n ) ≃ {sn ∈ Sl : ∀1 ≤ i ≤ l, n′i = nsn (i) }.

Similarly, the set ΩG (aP1 , aP2 ) is empty unless l = l′ , in which case
(9.1.2)

ΩG (aP1 , aP2 ) ≃ {s ∈ Sl : ∀1 ≤ i ≤ l, 2n′i = 2ns(i) }.

The map in the lemma is induced by the obvious bijection between the right hand sides of (9.1.1) and
(9.1.2).
2) From [4, p. 59], the set a) is identified with the set of sn ∈ Sl ⊆ Sn such that (nsn (1) , · · ·, nsn (l) ) is
−1
finer than (n′1 , · · ·, n′l′ ), and such that s−1
n (i) < sn (i + 1) for any 1 ≤ i ≤ n − 1 that is not of the form
n′1 + · · · + n′k for some 1 ≤ k ≤ l′ . Similarly, the set b) is identified with the set of s ∈ Sl ⊆ S2n such that
(2ns(1) , · · ·, 2ns(l) ) is finer than (2n′1 , · · ·, 2n′l′ ), and such that s−1 (i) < s−1 (i + 1) for any 1 ≤ i ≤ 2n − 1
that is not of the form 2n′1 + · · · + 2n′k for some 1 ≤ k ≤ l′ . The map in the lemma is induced by the
obvious bijection between these two sets.

For P1 and P2 a pair of ω-stable relatively standard parabolic subgroups of G, denote by ΩH (aP1 , aP2 )
the (perhaps empty) set of distinct isomorphisms from aP1 to aP2 obtained by restriction of elements
in ΩH . It is a subset of ΩG (aP1 , aP2 ) a priori. However, since the image of the map in Lemma 9.1.1)
is contained in ΩH , we actually have ΩH (aP1 , aP2 ) = ΩG (aP1 , aP2 ) (cf. [15, Lemme 2.8.1]). Denote by
S H
2 ∩H
ΩH (aP1 ; P2 ) the set of s ∈
Ω (aP1 , aQ ) such that s(aP1 ) ⊇ aP2 and s−1 α > 0 for each α ∈ ∆P
QH ,
aQ

where the union takes over all aQ associated to some ω-stable relatively standard parabolic subgroup Q
of G. Then ΩH (aP1 ; P2 ) = ΩG (aP1 ; P2 ) by Lemma 9.1.2).

9.2. Regular semi-simple terms. Let o ∈ Ors (see Section 3.3). It is possible to choose an element
X1 ∈ o and a relatively standard parabolic subgroup P1 of G such that X1 ∈ mP1 (F ) (thus P1 is ω-stable
by Proposition 5.4) but X1 cannot be H(F )-conjugated to an element in the Lie algebra of any relatively
standard parabolic subgroup R ( P1 . We call such X1 an elliptic element in (mP1 ∩ s)(F ).
×

p1,n p1,n
Let P1 =
be an ω-stable relatively standard parabolic subgroup of G, where P1,n is a
p1,n p1,n


0 A1
∈ (mP1 ∩ s)(F ) be a regular semi-simple
standard parabolic subgroup of GLn,D . Let X1 =
B1 0
element in s. Then X1 is elliptic in (mP1 ∩ s)(F ) if and only if A1 B1 is elliptic in mP1,n (F ) in the usual
sense, i.e., PrdA1 B1 is irreducible (see [23, Proposition 5] for example). Let HX1 be the centraliser of X1
in H. Then X1 is elliptic in (mP1 ∩ s)(F ) if and only if the maximal F -split torus in HX1 is AP1 .
39

Theorem 9.2. Let o ∈ Ors , P1 be a relatively standard parabolic subgroup of G and X1 ∈ o be an elliptic
element in (mP1 ∩ s)(F ). For f ∈ S(s(A)), we have
Z
G
∞
f (x−1 X1 x)vP1 (x)η(Nrd(x))dx,
Jo (η, f ) = vol(AP1 HX1 (F )\HX1 (A)) ·
HX1 (A)\H(A)

where vP1 (x) is left-invariant under HX1 (A) and equals the volume of the projection onto aG
P1 of the convex
hull of {−HQ (x)}, where Q runs over all semi-standard parabolic subgroups of G with MQ = MP1 .
Proof. Consider a relatively standard parabolic subgroup P of G and X ∈ mP (F ) ∩ o (thus P is ωstable by Proposition 5.4). There exists an ω-stable relatively standard parabolic subgroup P2 ⊆ P and
X2 ∈ (mP2 ∩ s)(F ) such that X2 is conjugate to X via an element in MPH (F ) and the maximal F -split
torus in HX2 is AP2 . Then any element in H(F ) which conjugates X1 and X2 will conjugate AP1 and
AP2 . It follows that there exists s ∈ ΩH (aP1 , aP2 ) and m ∈ MPH (F ) such that
X = mωs X1 ωs−1 m−1 .
Suppose that P3 ⊆ P is another relatively standard parabolic subgroup, s′ ∈ ΩH (aP1 , aP3 ) and m′ ∈
MPH (F ) such that
′ −1
X = m′ ωs′ X1 ωs−1
.
′ m
Then there is ζ ∈ HX (F ) such that
m′ ωs′ = ζmωs .
Since HX ⊆ MPH , we see that
ωs′ = ξωs
for some ξ ∈ MPH (F ). In sum, for any given P a relatively standard parabolic subgroup of G and
X ∈ mP (F ) ∩ o, there is a unique s ∈ ΩH (aP1 ; P ) such that X = mωs X1 ωs−1 m−1 for some m ∈ MPH (F ).
For x ∈ PH (F )\H(A), we obtain
X
X
f ((nx)−1 Xnx)
jf,P,o (x) =
X∈mP (F )∩o n∈NPH (F )

X

=

s∈ΩH (aP1 ;P ) m∈M

X

=

X

−1 (F )
PH ,ωs X1 ωs

X

s∈ΩH (aP1 ;P ) m∈M

−1 (F )
PH ,ωs X1 ωs





X

f ((mnx)−1 ωs X1 ωs−1 mnx)

MPH (F ) n∈NPH (F )

f ((mx)−1 ωs X1 ωs−1 mx),
PH (F )

where MPH ,ωs X1 ωs−1 denotes the centraliser of ωs X1 ωs−1 in MPH . For T ∈ a0 and x ∈ H(F )\H(A), we
have
X
X
T
τbPG (HP (δx) − TP ) · jf,P,o (δx)
(−1)dim(AP /AG )
jf,o
(x) =
δ∈PH (F )\H(F )

{P :P0 ⊆P }

X

=

δ∈PH (F )\H(F )

{P :P0 ⊆P }



=


·


X

X

s∈ΩH (aP1 ;P ) m∈M

X

X

(−1)dim(AP /AG )

−1 (F )
PH ,ωs X1 ωs

(−1)dim(AP /AG )

X



τbPG (HP (δx) − TP )

PH (F )


f ((mδx)−1 ωs X1 ωs−1 mδx)


s∈ΩH (aP1 ;P ) δ∈M

{P :P0 ⊆P }



X

−1 (F )
PH ,ωs X1 ωs

· f ((δx)−1 ωs X1 ωs−1 δx).



H(F )

τbPG (HP (δx) − TP )

Notice that the centraliser of ωs X1 ωs−1 in H is actually contained in MPH . We deduce that
X
X
X
T
(−1)dim(AP /AG )
τbPG (HP (δx) − TP ) · f ((δx)−1 ωs X1 ωs−1 δx)
jf,o
(x) =

H
{P :P ⊆P }
s∈Ω (aP1 ;P ) δ∈H

0

=

X

{P :P0 ⊆P }

(−1)dim(AP /AG )

X

−1 (F )
ωs X1 ωs

X

s∈ΩH (aP1 ;P ) δ∈HX1 (F )\H(F )
40

H(F )

τbPG (HP (ωs δx) − TP ) · f ((δx)−1 X1 δx).

For y ∈ H(A), write
χT (y) :=

X

X

(−1)dim(AP /AG )

s∈ΩH (aP1 ;P )

{P :P0 ⊆P }

Then

X

T
jf,o
(x) =

τbPG (HP (ωs y) − TP ).

f ((δx)−1 X1 δx) · χT (δx).

δ∈HX1 (F )\H(F )
T
For sufficiently regular T , using Theorem 8.2 and the fact that jf,o
(x)η(Nrd(x)) is left invariant by
we have
Z
T
JoG,T (η, 0, f ) =
jf,o
(x)η(Nrd(x))dx

A∞
G,

H(F )\H(A)∩G(A)1

=

Z

A∞
G H(F )\H(A)

Hence,
(9.2.1)




X

δ∈HX1 (F )\H(F )

JoG,T (η, 0, f ) = vol(A∞
P1 HX1 (F )\HX1 (A)) ·

where
vP1 (x, T ) :=

Z



f ((δx)−1 X1 δx) · χT (δx) η(Nrd(x))dx.

Z

f (x−1 X1 x)vP1 (x, T )η(Nrd(x))dx.

HX1 (A)\H(A)

χT (ax)da.

∞
A∞
G \AP

1

Here we have cheated by assuming that vP1 (x, T ) is well-defined and left-invariant under HX1 (A) in the
last equality, which is explained below along with its geometric interpretation.
Let Q be a parabolic subgroup of G containing P0 . Since P0 ⊆ P1 , by the charaterisation in [4, p.
59], ΩG (aP1 ; Q) is empty unless P0 ⊆ Q, in which case we have ΩG (aP1 ; Q) = ΩH (aP1 ; Q) by Lemma
9.1.2). Therefore, we have
X
X
G
(−1)dim(AQ /AG )
τbQ
(HQ (ωs y) − TQ ).
χT (y) =
s∈ΩG (aP1 ;Q)

{Q:P0 ⊆Q}

Compared to [2, p. 951], vP1 (x, T ) is nothing but the restriction to H(A) of Arthur’s weight for G(A). It is
shown in [1, Corollary 3.3] that the integral over a can be taken over a compact subset. From [1, Corollary
3.5], vP1 (x, T ) equals the volume of the projection onto aG
P1 of the convex hull of {TQ − HQ (x)}, where Q
takes over all semi-standard parabolic subgroups of G with MQ = MP1 . For y ∈ HX1 (A) ⊆ MP1 ∩H (A),
the convex hull associated to vP1 (yx, T ) is a translation of that associated to vP1 (x, T ), so they have the
same volume, i.e., vP1 (yx, T ) = vP1 (x, T ). By taking constant terms of both sides of (9.2.1), we obtain
the theorem.

Remark 9.3. As mentioned in the proof of Theorem 9.2, the weights we get for regular semi-simple
orbits are the restriction to H(A) of Arthur’s weights (see [2, p. 951]) for G(A). They are also the
same as those (see [15, p. 131]) appearing in the twisted trace formula for (GLn,D × GLn,D ) ⋊ σ, where
σ acts on GLn,D × GLn,D by σ(x, y) := (y, x). For Pn a standard parabolic subgroup of GLn,D and

×
pn pn
P =
an ω-stable relatively standard parabolic subgroup of G, we may identify aP with the
pn pn
σ-invariant subspace of aPn ×Pn . The ω-stable relatively standard parabolic subgroups of G here play the
role of the σ-stable standard parabolic subgroups of GLn,D × GLn,D , which correspond to the standard
parabolic subsets of (GLn,D × GLn,D ) ⋊ σ in the sense of [15, §2.7]. However, we need more (namely
relatively standard) parabolic subgroups in our truncation to deal with o ∈
/ O× .
References
[1] James Arthur. The characters of discrete series as orbital integrals. Invent. Math., 32(3):205–261, 1976.
[2] James Arthur. A trace formula for reductive groups. I. Terms associated to classes in G(Q). Duke Math. J., 45(4):911–
952, 1978.
[3] James Arthur. The trace formula in invariant form. Ann. of Math. (2), 114(1):1–74, 1981.
[4] James Arthur. An introduction to the trace formula. In Harmonic analysis, the trace formula, and Shimura varieties,
volume 4 of Clay Math. Proc., pages 1–263. Amer. Math. Soc., Providence, RI, 2005.
[5] Pierre-Henri Chaudouard. La formule des traces pour les algèbres de Lie. Math. Ann., 322(2):347–382, 2002.
41

[6] Pierre-Henri Chaudouard. Sur une variante des troncatures d’Arthur. In Werner Müller, Sug Woo Shin, and Nicolas Templier, editors, Geometric Aspects of the Trace Formula, pages 85–120, Cham, 2018. Springer International
Publishing.
[7] Anton Deitmar. A first course in harmonic analysis. Universitext. Springer-Verlag, New York, second edition, 2005.
[8] Brooke Feigon, Kimball Martin, and David Whitehouse. Periods and nonvanishing of central L-values for GL(2n).
Israel J. Math., 225(1):223–266, 2018.
[9] Solomon Friedberg and Hervé Jacquet. Linear periods. J. Reine Angew. Math., 443:91–139, 1993.
[10] Jiandong Guo. On a generalization of a result of Waldspurger. Canad. J. Math., 48(1):105–142, 1996.
[11] Brian Hall. Lie groups, Lie algebras, and representations, volume 222 of Graduate Texts in Mathematics. Springer,
Cham, second edition, 2015. An elementary introduction.
[12] Atsushi Ichino and Shunsuke Yamana. Periods of automorphic forms: the case of (GLn+1 × GLn , GLn ). Compos.
Math., 151(4):665–712, 2015.
[13] Hervé Jacquet. Sur un résultat de Waldspurger. Ann. Sci. École Norm. Sup. (4), 19(2):185–229, 1986.
[14] Hervé Jacquet and Stephen Rallis. Uniqueness of linear periods. Compositio Math., 102(1):65–123, 1996.
[15] Jean-Pierre Labesse and Jean-Loup Waldspurger. La formule des traces tordue d’après le Friday Morning Seminar,
volume 31 of CRM Monograph Series. American Mathematical Society, Providence, RI, 2013. With a foreword by
Robert Langlands [dual English/French text].
[16] Jason Levy. A truncated Poisson formula for groups of rank at most two. Amer. J. Math., 117(6):1371–1408, 1995.
[17] Qirui Li. An intersection number formula for CM cycles in Lubin-Tate towers. arXiv e-prints, page arXiv:1803.07553,
Mar 2018.
[18] V. L. Popov and Eh. B. Vinberg. Invariant theory. Algebraic geometry. IV: Linear algebraic groups, invariant theory, Encycl. Math. Sci. 55, 123-278 (1994); translation from Itogi Nauki Tekh., Ser. Sovrem. Probl. Mat., Fundam.
Napravleniya 55, 137-309 (1989)., 1989.
[19] J. J. Sylvester. Sur l’équation en matrices px = xq. C. R. Acad. Sci., Paris, 99:67–71, 115–116, 1884.
[20] J.-L. Waldspurger. Sur les valeurs de certaines fonctions L automorphes en leur centre de symétrie. Compositio Math.,
54(2):173–242, 1985.
[21] André Weil. Sur certains groupes d’opérateurs unitaires. Acta Math., 111:143–211, 1964.
[22] André Weil. Basic number theory. Classics in Mathematics. Springer-Verlag, Berlin, 1995. Reprint of the second (1973)
edition.
[23] Chia-Fu Yu. Characteristic polynomials of central simple algebras. Taiwanese J. Math., 17(1):351–359, 01 2013.
[24] Chong Zhang. On linear periods. Math. Z., 279(1-2):61–84, 2015.
[25] Chong Zhang. On the smooth transfer for Guo-Jacquet relative trace formulae. Compos. Math., 151(10):1821–1877,
2015.
[26] Michal Zydor. La variante inﬁnitésimale de la formule des traces de Jacquet-Rallis pour les groupes linéaires. J. Inst.
Math. Jussieu, 17(4):735–783, 2018.
[27] Michal Zydor. Les formules des traces relatives de Jacquet-Rallis grossières. J. Reine Angew. Math., 762:195–259,
2020.

Université de Paris, Sorbonne Université, CNRS, Institut de Mathématiques de Jussieu-Paris Rive
Gauche, F-75013 Paris, France
E-mail: huajie.li@imj-prg.fr

42

