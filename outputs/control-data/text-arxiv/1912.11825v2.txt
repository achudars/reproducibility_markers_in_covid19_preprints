arXiv:1912.11825v2 [math.NT] 6 Mar 2020

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS OF
ORTHOGONAL SHIMURA VARIETIES
JAN HENDRIK BRUINIER AND SHAUL ZEMEL
Abstract. We determine the behavior of automorphic Green functions along the boundary components of toroidal compactifications of orthogonal Shimura varieties. We use this
analysis to define boundary components of special divisors and prove that the generating
series of the resulting special divisors on a toroidal compactification is modular.

1. Introduction
Orthogonal Shimura varieties that arise from even lattices of signature (n, 2) carry a
natural family of divisors that are called Heegner divisors, rational quadratic divisors,
or special divisors in the literature. In his seminal paper [Bo1], Borcherds constructed
meromorphic modular forms on these varieties, and then used them in the sequel [Bo2]
to establish the modularity of the generating series of these divisors in the first Chow
group of such a Shimura variety. This provided a new proof of the Gross-Kohnen-Zagier
theorem about the modularity of Heegner divisors on modular curves and a generalization
to orthogonal Shimura varieties of arbitrary dimension and level. Taking Chern classes one
obtains as a corollary also the modularity of the generating series of the cohomology classes
of special divisors, such as the celebrated Hirzebruch-Zagier theorem for Hilbert modular
surfaces [HZ] and particular cases of results of Kudla-Millson on cohomology classes of
special cycles on locally symmetric spaces associated with orthogonal groups [KM].
The modularity of generating series of special cycles plays a central role in the Kudla
program, see, e.g., [K1], [K2]. Once one knows modularity, the generating series can
be used to construct arithmetic analogues of the theta correspondence, relating Siegel
modular forms to classes of special cycles in (arithmetic) Chow groups. For applications
to intersection and height pairings one is interested in special cycles on smooth toroidal
compactifiations and corresponding modularity results, cf. Problem 3 of [K2]. The present
paper is a contribution in this direction.
In order to present the results in more detail, we need some notation. Let L be an
even lattice of signature (n, 2), and let ΓL be the stable special orthogonal group of L, see
(3.6). We write XL = ΓL \D for the associated connected complex Shimura variety. For
every element µ in the discriminant group ∆L = L∗ /L of L and every positive number
2
m ∈ µ2 + Z there is a corresponding special divisor Z(m, µ) on XL . If ρL denotes the Weil
representation associated with L, then Theorem 4.5 of [Bo2] states the following.
The first author is partially supported by DFG grant BR-2163/4-2 and the LOEWE research unit
USAG.
1

2

JAN H. BRUINIER AND SHAUL ZEMEL

Theorem 1.1. Let Z(0, 0) be any divisor on XL representing the line bundle of modular
forms of weight −1/2, and denote the image of Z(m, µ) in CH1 (XL ) ⊗ Q by [Z(m, µ)] for
any m and µ. Then the formal power series
X
X
[Z(m, µ)] · q m eµ
[Z(0, 0)]e0 +
µ∈∆L 0<m∈ µ2 +Z
2

is a modular form of weight 1+n/2 and representation ρL with coefficients in CH1 (XL )⊗Q.
Note that Theorem 1.1 involves the representation ρL , and not the complex conjugate
representation ρL as in Theorem 4.5 of [Bo2], since we work here with the opposite signature
convention. The idea of the proof is that given a weakly holomorphic modular form f of
weight 1 − n/2 and representation ρL with integral principal part, there exists, according
to Theorem 13.3 of [Bo1], a Borcherds product Ψf on XL that gives rise to a particular
relation among the special divisors in CH1 (XL ). The result can then be deduced by means
of an incarnation of Serre duality, which appears as Theorem 3.1 of [Bo2], and which is
stated here as Proposition 5.3.
The variety XL is typically non-compact. Following work of Satake [Sa], Baily and Borel
constructed in [BB] a canonical minimal compactification XLBB of XL . When n is larger
than the Witt rank of L, an appropriate equivalent of Theorem 1.1 holds also for the
closures of the divisors Z(m, µ) on XLBB . Indeed, meromorphic modular forms with respect
to ΓL , and in particular Borcherds products, are defined on XLBB , and the complement of
XL in XLBB has codimension larger than 1 by the assumption on the Witt rank. Hence
the divisor of any Borcherds product yields a relation among the special divisors, and the
result follows in the same manner.
The Baily-Borel compactification XLBB is typically highly singular at the boundary. In
order to work on a smooth compact variety, we shall consider toroidal compactifications
as constructed in [AMRT]. These are described explicitly in the orthogonal setting for
instance in [Fi], and we present the results here as well in a manner that is more suitable
for our purposes. However, the complement of XL inside a toroidal compactification XLtor is
a divisor, and it turns out that Theorem 1.1 does not extend to XLtor if one works with the
closures of the special divisors on XL . Instead, one has to add certain boundary divisors
with appropriate multiplicities, a phenomenon which was already observed for Hilbert
modular surfaces in [HZ] and for unitary Shimura varieties in [BHY] and [BHKRY]. Here
we define special divisors Z tor (m, µ) on XLtor which include suitable linear combinations of
the boundary divisors, and we prove an analogue of Theorem 1.1.
The idea of our approach is the following. For every µ ∈ ∆L and every positive number
2
m ∈ µ2 + Z there is a harmonic Mass form Fm,µ of weight 1 − n/2 with representation
ρL whose principal part is given by q −m (eµ + e−µ ). Its regularized theta lift against the
Siegel theta function ΘL of L determines an automorphic Green function ΦLm,µ on XL with
a logarithmic singularity along Z(m, µ), see [Br1] and [BFu] for more details. We analyze
the behavior of this Green function towards each boundary component of XLtor . It turns
out that besides a term with log-log-growth, the Green function has logarithmic growth
along certain boundary divisors. Here the corresponding multiplicities are determined by

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

3

regularized theta lifts associated to lattices of signature (n − 2, 0) and (n − 1, 1) which are
obtained as quotients of L.
Every primitive rank 2 isotropic sublattice J ⊆ L determines a 1-dimensional Baily-Borel
boundary component and also a canonical boundary divisor BJ of XLtor . On the other hand,
the lattice D = (J ⊥ ∩ L)/J is positive definite of signature (n − 2, 0). There is a linear
D
map taking Fm,µ to a harmonic Maass form Fm,µ
with representation ρD . We show in
Proposition 4.8 that ΦLm,µ has logarithmic growth along the divisor multJ (m, µ) · BJ , where
D
the multiplicity multJ (m, µ) is determined by the regularized theta lift of Fm,µ
against the
2m
theta function ΘD of the lattice D, which in turn is given by n−2 times the representation
number of m by the coset of D arising from µ.
Every primitive rank 1 isotropic sublattice I ⊆ L determines a 0-dimensional BailyBorel boundary component, as well as a Lorentzian lattice K = (I ⊥ ∩ L)/I of signature
(n − 1, 1). In contrast to the canonical boundary divisor BJ from the previous paragraph,
the inverse image in XLtor depends on the choice of an admissible cone decomposition of the
rational closure of a cone C of negative norm vectors in KR . The lattice K and an oriented
primitive negative norm vector ω ∈ K ∩ C that spans an inner ray in the associated cone
decomposition determine a boundary divisor BI,ω of XLtor . There is a linear map taking
K
Fm,µ to a harmonic Maass form Fm,µ
with representation ρK . We show in Proposition 4.7
(or, more explicitly, in the special case presented in (4.21)) that ΦLm,µ has logarithmic
growth along the divisor multI,ω (m, µ) · BI,ω , where the multiplicity multI,ω (m, µ) is given
K
by the regularized theta lift of Fm,µ
against the Siegel theta function ΘK of K, evaluated
at the special point associated with ω in the Grassmannian of K.
We define the special divisor Z tor (m, µ) ∈ Div(XLtor ) ⊗ R by the formula
X
XX
(1.1)
Z tor (m, µ) = Z(m, µ) +
multJ (m, µ) · BJ +
multI,ω (m, µ) · BI,ω .
J⊆L

I⊆L R+ ω

Here J (resp. I) runs over a set of representatives of rank 2 (resp. rank 1) primitive isotropic
sublattices of L modulo ΓL , and given I, the index R+ ω runs over representatives for the
inner rays of the chosen admissible cone decomposition. Note that while the multiplicities
multJ (m, µ) are easily seen to be rational because of their description as representation
numbers, the multiplicities multI,ω (m, µ) seem to be real in general. Only certain linear
combinations of the latter quantities can be shown to be rational, cf. Theorem 5.2.
Our first main result, given in Theorem 4.13 below, states that 21 ΦLm,µ is a logarithmic
Green function for the divisor Z tor (m, µ) on XLtor with a term that is pre-log-log along the
boundary in the sense of [BBK]. In particular this means that if dc is the complementary
then we have the current equation
operator ∂−∂
4πi
(1.2)

ddc [ 12 ΦLm,µ ] + δZ tor (m,µ) = [η tor (m, µ)],

where η tor (m, µ) is the sum of a smooth 2-form on XLtor and the ddc -image of the pre-log-log
term.
Our second main result, Theorem 5.4, describes the generating series of these special
divisors.

4

JAN H. BRUINIER AND SHAUL ZEMEL

Theorem 1.2. Assume that n is larger than the Witt rank of L, set Z tor (0, 0) to be any
divisor on XLtor that represents the line bundle of modular forms of weight −1/2, and write
[Z tor (m, µ)] for the image of Z tor (m, µ) in CH1 (XLtor ) ⊗ R for every pair (m, µ). Then the
formal power series
X
X
[Z tor (m, µ)] · q m eµ
[Z tor (0, 0)]e0 +
µ∈∆L 0<m∈ µ2 +Z
2

is a modular form of weight 1+n/2 and representation ρL with coefficients in CH1 (XLtor )⊗R.
Taking advantage of our analysis of the Green functions ΦLm,µ , this result can now be
proved in a similar way as Theorem 1.1. For every weakly holomorphic modular form
f of weight 1 − n/2 and representation ρL with integral principal part, we consider the
associated Borcherds product Ψf , but now as a section of a line bundle over XLtor . Since
f can be (essentially) uniquely written as a linear combination of the harmonic Maass
forms Fm,µ , the logarithm of the Petersson metric of Ψf decomposes as a corresponding
linear combination of the Green functions ΦLm,µ . This implies that the divisor of Ψf on
XLtor includes the boundary components of XLtor with multiplicities compatible with (1.1).
Hence f gives rise to a relation among the divisors Z tor (m, µ), and the theorem follows
again by Serre duality. In fact, as we construct the divisors Z tor (m, µ) via their Green
functions, our argument can also prove modularity in Chow groups arising in arithmetic
settings—see Remark 5.5 below.
We remark that [P] proves a similar result on the moduli space of polarized K3 surfaces
in dimension 19, though this result does not involve the multiplicities multI,ω (m, µ) because
the toroidal compactification considered there is based on fans that have no internal rays.
This paper is divided into five sections, the first being the introduction. Section 2
reviews quickly the general theory of toroidal compactifications, while Section 3 presents
the explicit description of what happens in the orthogonal case. Section 4 investigates the
Green functions associated with special divisors, and explains the extensions of the Green
functions to toroidal compactifications. Finally, Section 5 recalls some results on Borcherds
products and shows how to modify the modularity theorem for special cycles on the open
variety to become suitable for the toroidal case.
We thank Max Rössler and Salim Tayou for helpful comments.
2. General Toroidal Compactifications
We skim here briefly, without any proofs, the general theory of toric varieties and toroidal
compactifications. More details on toric varieties can be found in [Fu] or in [CLS], and
the general construction of toroidal compactifications is available in [AMRT], [Nam], [Fi],
and others. The particular parts that will be of use to us are Proposition 2.5, Lemma 2.7,
Propositions 2.8 and 2.9, Definition 2.12, and Theorem 2.14.
2.1. Toric Varieties. There is a correspondence between algebraic tori of finite dimension
and lattices, namely free Abelian groups of finite rank. Given a lattice Λ, the corresponding

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

5

torus TΛ is the one for which TΛ (C) = ΛC /Λ. The dual lattice Λ∗ = Hom(Λ, Z) is identified
with Hom(TΛ , Gm ) via


(2.1)
ν 7→ zν ,
zν : ζ ∈ TΛ (C) = ΛC /Λ 7→ e (ν, ζ) ,

where we adopt the usual notation e(w) = e2πiw for w ∈ C and the pairing (ν, ζ) in (2.1)
is the extension of the pairing between Λ and Λ∗ to elements from ΛC . The functions zν
from (2.1) satisfy zµ+ν = zµ zν for µ and ν in Λ∗ , a relation that we henceforth implicitly
assume wherever we use this notation. It follows that as an algebraic variety we have
TΛ = Spec C[zν | ν ∈ Λ∗ ].

A toric variety is an irreducible algebraic variety X containing a torus T as a dense
Zariski open subset, such that the action of T on itself extends to an action of T on all of X.
We shall only consider normal separated toric varieties in what follows, where a variety is
always understood to be locally of finite type. Recall that a rational polyhedral cone σ ⊆ ΛR
is a set generated by finitely many elements of Λ, with coefficients in R+ = {a ∈ R| a ≥ 0}.
The dual cone of σ is

σ ∗ = ν ∈ Λ∗R (ν, λ) ≥ 0 for all λ ∈ σ ,
which is a rational polyhedral cone in Λ∗R . The cone σ is called strongly convex if it contains
no full lines. This is equivalent to σ ∗ being of full dimension rk Λ in Λ∗R . For any such cone
σ, the semigroup σ ∗ ∩ Λ∗ is finitely generated, and
XΛ,σ = Spec C[zν | ν ∈ σ ∗ ∩ Λ∗ ]
is a normal irreducible affine algebraic variety, containing TΛ (C) as the open acting torus.
We shall use the notation τ ≤ σ for stating that τ is a face of σ (in the usual polyhedral
sense). In this case XΛ,τ is an open TΛ (C)-invariant subvariety of XΛ,σ . General (normal
separated) toric varieties are then defined using the following notion.
Definition 2.1. A rational fan is a collection Σ of strongly convex rational polyhedral
cones in ΛR , satisfying the following conditions:
(i) If σ ∈ Σ and τ ≤ σ then τ ∈ Σ.
(ii) Given σ and τ in Σ, we have σ ∩ τ ≤ σ and σ ∩ τ ≤ τ .
The first main result in the theory of toric varieties is the following one.
Theorem 2.2. Every rational fan Σ as in Definition 2.1 gives rise to a separated normal
toric variety XΛ,Σ , on which the acting torus is TΛ . Conversely, every separated normal
toric variety arises, up to isomorphism, as XΛ,Σ from a lattice Λ and a fan Σ satisfying
the conditions of Definition 2.1.
Theorem 2.2 indicates that properties of the toric varieties XΛ,σ should be expressed as
properties of the defining fan Σ. We recall that the dimension of a cone σ is the dimension
of the real vector space Rσ = σ + (−σ).

6

JAN H. BRUINIER AND SHAUL ZEMEL

Definition 2.3. A cone σ, of some dimension 0 ≤ l ≤ rk Λ, is called simplicial if it can
be generated using precisely l elements of Λ. It is called smooth if these elements form a
basis over Z for the group Λ ∩ Rσ. The fan Σ from Definition 2.1 will be called simplicial
or smooth if every σ ∈ Σ has the respective property.
We state the following relations between properties of Σ and properties of XΛ,Σ , whose
proofs are rather simple and straightforward.
Proposition 2.4. The following assertions hold:
(i) The affine toric variety XΛ,σ is smooth if and only if the cone σ is smooth in the
sense of Definition 2.3. The general toric variety XΛ,Σ is smooth if and only if the
fan Σ is smooth.
(ii) If the cone σ is simplicial then XΛ,σ has at most finite quotient singularities. If the
fan Σ is simplicial then the toric variety XΛ,Σ has at most finite quotient singularities.
(iii) The toric variety XΛ,Σ is of finite type if and only if the fan ΣSis finite.
(iv) The toric variety XΛ,Σ is proper if and only if Σ is finite and σ∈Σ σ is all of ΛR .
We remark that while our main object of interest below will be smooth toroidal compactifications, which are obtained when the toric varieties appearing in the construction
below are smooth (as characterized in Proposition 2.4), this fact will play no role in any
of the following proofs. Our results are therefore equally valid for non-smooth toroidal
compactifications.
The orbits in the action of TΛ on XΛ,Σ are in one-to-one correspondence with the cones
σ ∈ Σ. More explicitly, define the annihilator of σ to be

σ 0 = ν ∈ ΛR (ν, λ) = 0 for all λ ∈ σ = σ ∗ ∩ (−σ ∗ ),
and then the orbit O(σ) associated with σ and the corresponding closure OΣ (σ) in XΛ,Σ
are defined to be
[


(2.2)
O(σ) = ZXΛ,σ zν ν ∈ (σ ∗ ∩ Λ∗ ) \ σ 0
and OΣ (σ) =
O(η).
σ≤η

Here we have used, for an affine variety X, the notation ZX (S) for the set of common zeros
of a set S ⊆ C[X]. The dimension of both O(σ) and OΣ (σ) is rk Λ − dim σ. The special
case of (2.2) concerning divisors is given by
Dρ = OΣ (ρ) ∈ Div(XΛ,Σ )

for a ray, i.e., a 1-dimensional cone ρ ∈ Σ, and the generic part O(ρ) = Dρ ∩ XΛ,ρ of Dρ is
smooth. Any such ray is R+ ω for a unique, well-defined primitive element ω ∈ Λ, and if we
take some element κ ∈ Λ∗ with (κ, ω) = 1, which is possible by the primitivity of ω, then
zκ is a defining function for O(ρ) in XΛ,ρ , hence a local defining function for Dρ in XΛ,Σ .
We deduce the following beautiful formula from [Fu] and others, which will be useful for
us in what follows.
Proposition 2.5. For ν ∈ Λ∗ and a ray ρ = R+ ω ∈ Σ as above, the order ordDρ (zν ) of
the function zν for ν ∈ Λ∗ along the the divisor Dρ is (ν, ω).

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

7

2.2. Toroidal Compactifications. The theory of toric varieties can be used to construct
interesting (e.g., smooth) compactifications of algebraic varieties arising as quotients of
Hermitian symmetric spaces by arithmetic groups. Indeed, let D be a simple Hermitian
symmetric space of non-compact type, and let G be the connected component of Aut(D).
The group G can be viewed as the connected component of the group of real points of a
simple algebraic group G. In case G is defined over Q, the group G contains arithmetic
subgroups, which are discrete and of finite co-volume in G. By fixing such a subgroup Γ,
the space X = Γ\D carries the structure of a complex algebraic variety, which is usually
defined over Q or over some number field (see, e.g., Theorem 2.6 below), but is not complete
in general.
Any compactification of X arises by adding appropriate boundary components to X.
The first, and most natural, way to do this is based on the boundary components of D
as a symmetric space. We denote the assertion that Ξ is a boundary component of D by
Ξ ≤ D, and the rational structure on G determines which boundary components of D are
rational (this is always the case for D itself). One therefore defines
[
D BB =
Ξ.
Ξ≤D, Ξ rational

The group Γ acts on D BB , and we set
(2.3)

open

X BB = Γ\D BB ⊇ Γ\D = X.

The quotient X BB from (2.3), with the Baily–Borel topology and complex structure, is
called the Baily–Borel compactification of X. It is a normal projective variety, which
contains X as a Zariski dense open subset. The boundary components of X BB , which are
called cusps, are quotients of rational boundary components of D by arithmetic groups.
They are typically of high codimension and very singular. This compactification can also
be constructed and characterized by the following result of Baily, Borel, and Satake (see,
e.g., [Sa] and [BB]).
Theorem 2.6. The algebraic variety X BB from (2.3) can be obtained as the proj construction of the ring of holomorphic modular forms with respect to Γ (hence it is projective and
defined over a number field). It is the minimal algebraic compactification of X.
The minimality in Theorem 2.6 means that any algebraic compactification of X carries
a unique map to X BB that restricts to the identity map on the open subset X of both
varieties.
Smooth compactifications of X can be constructed using the theory of toroidal compactifications, obtained by gluing to X open subsets of toric varieties. This theory is described
in detail in [AMRT] in general, and more explicitly for the symplectic case in [Nam]. We
will give the precise details for our case of interest, the orthogonal case, in Section 3 below,
slightly in parallel to [Fi], with a special case appearing also in Section 4.2 of [P]. For describing the general idea, recall that the minimality in Theorem 2.6 allows one to restrict
attention to the pre-image of a given cusp, and any cusp is the Γ-orbit of some rational

8

JAN H. BRUINIER AND SHAUL ZEMEL

boundary component Ξ ≤ D. Let P(Ξ) denote the connected component of the stabilizer
StG (Ξ), which is a parabolic subgroup of G, for which we now have the following result.
Lemma 2.7. The parabolic subgroup P(Ξ) lies in the split short exact sequence
1 → W(Ξ) → P(Ξ) → Gh (Ξ) × Gℓ (Ξ) × M(Ξ) → 1.

The unipotent radical W(Ξ) of P(Ξ) lies in the short exact sequence
0 → U(Ξ) → W(Ξ) → V(Ξ) → 0,

which does not split in general, where the center U(Ξ) of W(Ξ) and the quotient V(Ξ) are
isomorphic to real vector spaces, with dimR V(Ξ) even. The group Gh (Ξ) isthe connected
component of Aut(Ξ). The group Gℓ (Ξ) is a simple subgroup of GL U(Ξ) , whose symmetric space is a self-adjoint cone Ω(Ξ) inside U(Ξ) which is usually non-Hermitian, and
M(Ξ) is a compact group.
We remark that some of the five components Gh (Ξ), Gℓ (Ξ), M(Ξ), U(Ξ), or V(Ξ) from
Lemma 2.7 may be trivial for some D and Ξ (see, e.g., Proposition 3.6 below). Note
that the center U(Ξ) of W(Ξ) is normal also in P(Ξ), and we denote the quotient group
P(Ξ)/U(Ξ) by P(Ξ).
The choice of Ξ also gives a presentation of D in a specific way, in correspondence with
the action of P(Ξ) as decomposed in Lemma 2.7.
Proposition 2.8. The choice of Ξ describes the Hermitian symmetric domain D as a
topologically trivial holomorphic fiber bundle
π e
(2.4)
U(Ξ) + iΩ(Ξ) → D → D(Ξ)

e
e
over a complex manifold D(Ξ),
in which the fiber of D over a point in D(Ξ)
is the image
of U(Ξ) + iΩ(Ξ) inside an affine space underlying the complexification U(Ξ)C of the real
vector space U(Ξ) from Lemma 2.7. Appropriately modifying the imaginary part of the
fiber of the first fibration yields a map Φ : D → Ω(Ξ), and with it a topologically trivial
affine vector bundle structure
(2.5)

π×Φ e
U(Ξ) → D −→ D(Ξ)
× Ω(Ξ).

e
The manifold D(Ξ)
is an affine holomorphic vector bundle, whose underlying real structure
is a topologically trivial affine vector bundle
e
(2.6)
V(Ξ) → D(Ξ)
→ Ξ,

e
in which the fiber V(Ξ)s of D(Ξ)
over s ∈ Ξ is the real affine space underlying V(Ξ), but
carrying a complex structure that depends holomorphically on s.

The action of the groups from Lemma 2.7 on the fibrations from Proposition 2.8 is as
follows.

Proposition 2.9. The center U(Ξ) of the unipotent radical W(Ξ) from Lemma 2.7 acts
additively on the affine fibers of the bundle from (2.5), or equivalently on the real part of
those from (2.4). The quotient V(Ξ) acts similarly on the fibers from (2.6), and the map

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

9

Φ from Proposition 2.8 is invariant under this action. In the resulting action of the Levi
quotient Gh (Ξ)×Gℓ (Ξ)×M(Ξ) from Lemma 2.7 on the quotient space Ξ×Ω(Ξ), the groups
Gh (Ξ) and Gℓ (Ξ) act on their symmetric spaces Ξ and Ω(Ξ) respectively, the latter one via
Φ, and M(Ξ) acts trivially.
e
In particular, the description of D(Ξ)
in Proposition 2.8 is as a variation of Hodge
structure over Ξ. Proposition 2.9 shows that the fibers in (2.6) are principal homogeneous
spaces of V(Ξ), and those from (2.5) are principal homogeneous spaces of U(Ξ). The
boundary component Ξ is understood to lie “at ∞”, in the direction of the cone Ω(Ξ).
Recalling that X = Γ\D for an arithmetic group Γ, we set
(2.7)
as well as
and
(2.8)

PZ (Ξ) = P(Ξ) ∩ Γ,

WZ (Ξ) = W(Ξ) ∩ Γ,

UZ (Ξ) = U(Ξ) ∩ Γ

VZ (Ξ) = WZ (Ξ)/UZ (Ξ) ⊆ V(Ξ)
P Z (Ξ) = PZ (Ξ)/UZ (Ξ) ⊆ P(Ξ) = P(Ξ)/U(Ξ).

Now, the spaces U(Ξ) and U(Ξ)C are obtained from UZ (Ξ) by extending the scalars to R
and C respectively, and by Proposition 2.9, the group UZ (Ξ) ⊆ U(Ξ) acts on the real part
e
of the fibers of the bundle from (2.4). Hence UZ (Ξ)\D is also a fiber bundle over D(Ξ),
with the fibers being affine models of
(2.9)

[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) ⊆ [U(Ξ)/UZ (Ξ)] + iU(Ξ) = U(Ξ)C /UZ (Ξ) = TUZ (Ξ) (C).

In these coordinates, the component Ξ of the set D BB from (2.3) lies at ∞ in the direction
of Ω(Ξ). The idea is to extend the fibers TUZ (Ξ) to appropriate toric varieties, such that the
point s ∈ Ξ ⊆ D BB will be replaced by toroidal boundary components. This will make the
boundary not only a bundle over the boundary component Ξ of X BB itself, but also over
e
D(Ξ).
In order to do so while respecting the action of Γ, one observes that there is an open
subset ΩN (Ξ) ⊆ Ω(Ξ), which is invariant under the image of PZ (Ξ) in Gℓ (Ξ), which satisfies
(2.10)

ΩN (Ξ) + Ω(Ξ) ⊆ ΩN (Ξ),

and such that if ξ ∈ D with Φ(ξ) ∈ ΩN (Ξ) and A ∈ Γ does not lie in PZ (Ξ) then
Φ(Aξ) 6∈ ΩN (Ξ). This yields the following neighborhood of Ξ in D.

Lemma 2.10. The subset NΞ = Φ−1 ΩN (Ξ) of D is PZ (Ξ)-invariant, and any element
A ∈ Γ which satisfies ANΞ ∩ NΞ 6= ∅ must be in PZ (Ξ).
Lemma 2.10 and (2.10) imply that that PZ (Ξ)\NΞ becomes a neighborhood of the corresponding cusp of X. It is clear from the definition of NΞ in Lemma 2.10 that the restriction
e
of the map π from (2.4) to NΞ still surjects onto the manifold D(Ξ)
from Proposition 2.8.
Dividing by the action of UZ (Ξ), or equivalently restricting (2.9), gives the fiber bundle
e
(2.11)
[U(Ξ)/UZ (Ξ)] + iΩN (Ξ) → UZ (Ξ)\NΞ → D(Ξ),
with the fibers being smaller open subsets of TUZ (Ξ) (C).

10

JAN H. BRUINIER AND SHAUL ZEMEL

The toric variety extending TUZ (Ξ) will therefore have to be based on a fan Σ(Ξ) of cones
that are roughly contained in Ω(Ξ) (this will be made more precise soon). But it will also
have to respect the action of the image of PZ (Ξ) in Gℓ (Ξ). In addition, consider a cusp Υ
whose closure contains Ξ, a situation that we denote by Ξ ≤ Υ. After embedding the Levi
quotients inside P(Ξ) and P(Υ) one obtains the following result, appearing in Theorem 3
of Chapter 3 of [AMRT].
Lemma 2.11. Let Ξ and Υ be cusps of D, and assume that Ξ ≤ Υ. We then have the
inclusion Gh (Ξ) ⊆ Gh (Υ). One the other hand, we get U(Υ) ⊆ U(Ξ) and Gℓ (Υ) ⊆ Gℓ (Ξ)
in the other direction, with the latter embedding being not canonical, and the cone Ω(Υ)
is a rational boundary component of Ω(Ξ). All the rational boundary components of Ω(Ξ)
are Ω(Υ) for Ξ ≤ Υ.

The exact properties of each fan Σ(Ξ), as well as of the collection of fans {Σ(Ξ)}Ξ , are
expressed in the following definition, taken from [AMRT] and [Nam].
Definition 2.12. For D, Γ, and Ξ as above we say that a fan Σ(Ξ) is an admissible cone
decomposition of (the closure of) Ω(Ξ) if the following three conditions are satisfied:
S
S
(i) σ∈Σ(Ξ) σ = Ξ≤Υ Ω(Υ). The union on the right hand side is the closure of Ω(Ξ).
(ii) If σ ∈ Σ(Ξ) and B ∈ Gℓ (Ξ) is in the image of the group P Z (Ξ) from (2.8) then
Bσ ∈ Σ(Ξ), i.e., Σ(Ξ) is P Z (Ξ)-invariant.
(iii) The action of P Z (Ξ) on Σ(Ξ) has finitely many orbits.
For a collection {Σ(Ξ)}Ξ≤D of fans to be called admissible the following three following
must hold:
(i) Σ(Ξ) is an admissible cone
 decomposition
S of the closure of Ω(Ξ) for every Ξ ≤ D.
(ii) If Ξ ≤ Υ then Σ(Υ) = σ ∈ Σ(Ξ) σ ⊆ Υ≤Ψ Ω(Ψ) .

(iii) For Ξ ≤ D and A ∈ Γ we have Σ(AΞ) = Aσ σ ∈ Σ(Ξ) .

For two cusps Ξ and Υ with Ξ ≤ Υ, we consider Ω(Υ), as well as Ω(Ψ) for every Υ ≤ Ψ,
as identified with its image as a boundary component of Ω(Ξ) as in Lemma 2.11. Note that
in the second condition on Σ(Ξ) in Definition 2.12 we consider P Z (Ξ)-invariance, and not
the equivalent PZ (Ξ)-invariance, since we already divided by UZ (Ξ) in order to be able to
work with TUZ (Ξ) . This condition indicates that Σ(Ξ) will usually contain infinitely many
cones, since the image of P Z (Ξ) in Gℓ (Ξ) is typically infinite.
The existence of admissible cone decompositions for Ω(Ξ), as well as admissible collections of fans {Σ(Ξ)}Ξ≤D , is not hard to prove: One way is by slightly modifying the
argument leading to the Main Theorem II at the end of Chapter 3 of [AMRT] (the assumption that Γ is neat there poses no restriction, since any arithmetic group contains a
neat subgroup of finite index).
Given an admissible cone decomposition Σ(Ξ) for some Ξ, recall the fiber bundles from
(2.9) and (2.11), and that the fibers are open subsets of affine spaces over the torus
TUZ (Ξ) (C). Embedding this torus inside XUZ (Ξ),Σ(Ξ) , one gets a decomposition
i
[ h
o
o
(2.12)
[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) =
[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) ∩ O(σ) ,
σ∈Σ(Ξ)

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

11

where the set on the left hand side is the relative interior of the closure of the fiber
[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) from (2.9) in XUZ (Ξ),Σ(Ξ) . It is clear that none of the sets in the union
from (2.12) is empty, that the intersection associated with any σ ∈ Σ(Ξ) that does not lie
in any Σ(Υ) for a boundary component Υ 6= Ξ with Ξ ≤ Υ is the full orbit O(σ), and that
similar assertions holds for the fiber [U(Ξ)/UZ (Ξ)] + iΩN (Ξ) from (2.11), with all the terms
in which σ 6= {0} being the same. Let now DΞ be the manifold having the fiber bundle
structure
i
[ h
o
e
(2.13)
[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) ∩ O(σ) → DΞ → D(Ξ).
σ∈Σ(Ξ)

In particular DD in (2.13) is just D again. Since Σ(Ξ) is an admissible cone decomposition
in the sense of Definition 2.12, the action of P Z (Ξ)
 extends to DΞ , and the relative interior
o
PZ (Ξ)\NΞ of the closure of PZ (Ξ)\NΞ in P Z (Ξ) DΞ is


h
i
[

o
(2.14)
PZ (Ξ)\NΞ ∪ P Z (Ξ)
[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) ∩ O(σ)
.
{0}6=σ∈Σ(Ξ)

The union in (2.14) is essentially a finite union of TUZ (Ξ) -orbits of positive codimension
(each one perhaps divided by the action of some finite group). A technical important
result, in which we denote the image of P Z (Ξ) in Gℓ (Ξ) by Γℓ (Ξ), is the following one.

Theorem 2.13. Cones in Σ(Ξ) that are not contained in Σ(Υ) for any other cusp Υ with
Ξ ≤ Υ have finite stabilizers in Γℓ (Ξ). This group therefore operates properly discontinuously on the torus TUZ (Ξ) , hence also on the fibers from (2.11). Moreover, when Σ(Ξ) is an
admissible cone decomposition, this action extends to a properly discontinuous action on
XUZ (Ξ),Σ(Ξ) and on the fibers of DΞ from (2.13), taking boundary components to boundary
components.
Theorem 2.13 is complemented by an equivalent to part (iii) in Proposition 2.4, which
states that Γℓ (Ξ)\XUZ (Ξ),Σ(Ξ) is an open subset of a variety that is of finite type, because of
the finiteness of the number of orbits in Definition 2.12. We also deduce from that theorem
that if the cones in Σ(Ξ) are smooth as in Definition 2.3 then this quotient is smooth, up
to finite quotient singularities.
Assume now that the collection {Σ(Ξ)}Ξ is admissible as in Definition 2.12, and take
two cusps Ξ and Υ with Ξ ≤ Υ. 
The first condition in that definition and Lemma 2.11
allow us to identify UZ (Ξ)/UZ (Υ) DΥ as an open subset of DΞ , and write
h
io
[

  n
o
(2.15) DΞ = UZ (Ξ)/UZ (Υ) DΥ ∪
[U(Ξ)/UZ (Ξ)] + iΩ(Ξ) ∩ O(σ) .
σ∈Σ(Ξ)\Σ(Υ)

Recall that W(Υ) acts trivially on Υ, so that it leaves all the boundary components of
Υ invariant, and in particular fixes Ξ. On the other hand, W(Ξ) acts trivially on Ω(Ξ),
so that it fixes the boundary components of that cone that are described in Lemma 2.11,
including, in particular, Ω(Υ). We thus obtain the inclusions
(2.16)

UZ (Υ) ⊆ UZ (Ξ) ⊆ WZ (Ξ) ⊆ PZ (Υ) ∩ PZ (Ξ) ⊇ WZ (Υ),

12

JAN H. BRUINIER AND SHAUL ZEMEL

all of which holding also without the index Z. The inclusion from (2.15) thus yields
open 





PZ (Υ) ∩ PZ (Ξ) /UZ (Υ) DΥ ⊆ PZ (Υ) ∩ PZ (Ξ) /UZ (Ξ) DΞ ,

using which we can glue the appropriate neighborhoods of the cusps in the sets P Z (Ξ)\DΞ
and P Z (Υ)\DΥ properly when Ξ ≤ Υ. Definition 2.12 also implies that if two rational
boundary components lie over the same cusp of X BB , which means that they are identified
via Γ, then their toroidal pre-images coincide. Then (2.14) and the defining properties of
the set NΞ from Lemma 2.10 form the basis for the main result in the theory of toroidal
compactifications, which we now state.
Theorem 2.14. Let D be a simple Hermitian symmetric space, let Γ ≤ G = Aut(D)
be an arithmetic subgroup, and let {Σ(Ξ)}Ξ≤D be admissible as in Definition 2.12. Set
tor
X tor = X{Σ(Ξ)}
to be the variety obtained by gluing, for each Ξ ≤ D, the open subset
Ξ≤D
PZ (Ξ)\NΞ of X = Γ\D with its natural image in P Z (Ξ)\DΞ as in (2.14). Then X tor is
a compactification of X, which is a complete algebraic variety defined over the same field
as X. Assume, in addition, that every cone in every Σ(Ξ) is smooth as in Definition 2.3,
and that if ξ ∈ X tor is in the image of DΞ but not in DΥ for any other Ξ ≤ Υ then the
stabilizer of ξ in P Z (Ξ) is trivial. In this case X tor is a smooth variety, hence a compact
complex manifold.
The main drawback of the construction from Theorem 2.14 is that it is not canonical—it
depends on the choice of the admissible cone decompositions Σ(Ξ) for Ξ ≤ D. However, we
shall assume that the choice of admissible cone decompositions is fixed from the beginning,
tor
and write just X tor in what follows, for avoiding the heavy notation X{Σ(Ξ)}
.
Ξ
Remark 2.15. We remark that a standard argument involving barycentric subdivisions
implies that every fan has a smooth refinement, and since for a Γℓ (Ξ)-invariant fan this
can be done in a Γℓ (Ξ)-equivariant manner, which also respects the relations between the
fans associated with different cusps as in Definition 2.12, admissible collections of smooth
admissible cone decompositions always exist. On the other hand, the condition about
triviality of stabilizers depend on the arithmetic group Γ, and indeed for some groups Γ
the open variety X from (2.3) may itself be not smooth. The latter issue can be resolved,
however, by taking a finite index subgroup of Γ and the corresponding cover of X.
3. Compactifications of Grassmannian Quotients
This section describes the explicit form of the toroidal compactifications in the orthogonal case. The construction parallels [Fi] a bit, but with emphasis on the parts that are
required for our goals. The most important results here are the definition of the toroidal
divisors in (3.18), the explicit admissibility conditions in Corollary 3.21 and Lemma 3.24,
and the construction in Theorem 3.25.
3.1. Grassmannians with a Complex Structure. Let L be an even integral lattice
of signature (n, 2). We shall denote the image of two vectors λ and µ in L under the
associated bilinear form by (λ, µ), and we shorthand (λ, λ) to λ2 for every λ ∈ L. The

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

13

2

quadratic form on L therefore sends λ ∈ L to λ2 . The group of automorphisms of the
real quadratic space LR is the Lie group O(LR ) ∼
= O(n, 2), and we denote the connected
+
component of its identity by SO+ (LR ) ∼
SO
(n,
2).
=
The symmetric space of O(LR ) and of SO+ (LR ) is isomorphic to the Grassmannian


(3.1)
Gr(L) = v ⊆ LR v < 0, dim v = 2} = v ⊆ LR v < 0, v ⊥ > 0}.

It is a real manifold of dimension 2n, but it carries a natural complex structure, derived
from the following description (see Section 13 of [Bo1], Section 3.2 of [Br1], Section 1.2
of [Ze1], Section 3.1 of [Fi], and others, but note that here we work with the opposite
signature). We set

(LC )0 = ZLC (ZL2 ) = ZL ∈ LC ZL2 = 0
to be the zero set of the quadratic form on LC , as well as

(3.2)
P = ZL ∈ (LC )0 (ZL , Z L ) < 0 ,
which is an open subset of (LC )0 . We have a natural map

(3.3)

P → Gr(L),

ZL = XL + iYL 7→ v = RXL ⊕ RYL ,

which is clearly surjective. Moreover, the set P from (3.2) is the disjoint union P + ∪ P − of
two connected components, distinguished by the orientation on the basis (XL , YL ) for the
space v from (3.3), and the restriction of the map from that equation to one component,
say P + , is still surjective. The natural action of O(LR ) on LC preserves P , the subgroup
SO+ (LR ) preserves the two components P + and P − , and the map from (3.3) is O(LR )equivariant. In total, we get the following result.
Proposition 3.1. The Grassmannian Gr(L) from (3.1) is diffeomorphic to the image of
the connected component P + from (3.2) in the projective space P(LC ). This image is an
analytically open subset of the projective quadric P(LC )0 = ZP(LC ) (ZL2 ). Therefore Gr(L)
carries the structure of an n-dimensional complex manifold, on which SO+ (LR ) operates
holomorphically and transitively with compact stabilizers.
Following, e.g., the description in Section 2 of [BFr], one finds that the closure Gr(L) of
Gr(L) in P(LC )0 is obtained by adding appropriate boundary components to Gr(L), which
are associated with isotropic subspaces of LR . To understand them, we first observe that
the closure P + of P + in (LC )0 is

ZL = XL + iYL ∈ LC ZL2 = 0, (ZL , Z L ) ≤ 0, (XL , YL ) linearly dependent or oriented .

In the projective image we omit the point ZL = 0, and the boundary arises from the
complement of P + itself, so that the boundary of Gr(L) in ZP(LC ) (ZL2 ) is the projective
image of

(3.4)
0 6= ZL ∈ LC ZL2 = 0, (ZL , Z L ) = 0, (XL , YL ) linearly dependent or oriented .

Recalling the map from (3.3), taking a vector to the space spanned by its real and imaginary
part, we consider its behavior on the set from (3.4). Since now XL and YL are perpendicular
and isotropic, the space that they span, whose complexification is the span of ZL and Z L
over C, is isotropic. Its dimension cannot be 0 (since ZL = 0 is excluded in (3.4)), hence

14

JAN H. BRUINIER AND SHAUL ZEMEL

this space is either a line or a plane. It is a line if and only if XL and YL are linearly
dependent over R, or equivalently ZL and Z L are linearly dependent over C. Then all the
possible generators ZL of the complexification of this line have the same projective image.
The resulting point in (LC )0 is a 0-dimensional boundary component of Gr(L).
Otherwise the dimension is 2, and we choose a fixed oriented basis (z, w) for the resulting
isotropic plane. Since XL and YL are linearly independent, we find that ZL cannot be
spanned over C by w alone, and can therefore we be written as β(τ w + z) for some complex
β 6= 0 and τ = x + iy. Moreover, the linear independence shows that τ 6∈ R, and the
orientation implies that y > 0, i.e., τ lies in the upper half-plane H = {τ ∈ C| ℑτ > 0}. In
the projective image we may ignore only the factor β, and hence the boundary component
of Gr(L) that is associated with our isotropic plane is the projective image of the set
(3.5)

{τ w + z| τ ∈ H},

which is 1-dimensional over C. Note that taking τ to the boundary P1 (R) yields the 0dimensional boundary component of Gr(L) that is associated with a line that is contained in
our plane, namely the one spanned by τ w + z for finite τ ∈ R and by w for τ = ∞ ∈ P1 (R).
We can summarize this in the following result.
Proposition 3.2. The boundary of Gr(L) inside the projective quadric from Proposition
3.1 consists of a 1-dimensional copy of H for every 2-dimensional isotropic subspace JR of
LR and a point for every isotropic line IR in LR . The latter boundary components exists in
any non-trivial case, i.e., wherever n ≥ 1, while the former ones are present only if n ≥ 2.
All these boundary components are mutually disjoint, and the point associated with IR lies
in the closure of the 1-dimensional component associated with JR if and only if IR ⊆ JR .

The last assertion of Proposition 3.2 is the incarnation of the statement, from [AMRT]
and others, that “a boundary component of a boundary component is a boundary component”, in the orthogonal case. The reason for the notation IR for an isotropic line and JR
for an isotropic plane will become clear in the next subsection.
Recalling the rational structure arising from the fact that LR is the extension of scalars
of the lattice L to R, the find that the Baily–Borel space D BB is obtained by adding to
D = Gr(L) those boundary components from Proposition 3.2 that are associated with
isotropic subspaces of LR that arise as extensions of scalars from isotropic sublattices of L.
In addition, the lattice L has a dual lattice

L∗ = Hom(L, Z) ∼
= ν ∈ LR (ν, L) ⊆ Z ⊆ LR ,

and we thus denote this subgroup of LR also by L∗ . It contains L with finite index, and
the quotient ∆L = L∗ /L is called the discriminant group of L. It carries the Q/Z-valued
2
quadratic form µ 7→ µ2 ∈ Q/Z and the non-degenerate Q/Z-valued bilinear form sending
µ and ν to (µ, ν) ∈ Q/Z. The group O(L) of elements of O(LR ) that preserve L also
preserves L∗ and thus acts on ∆L . We put SO+ (L) = O(L) ∩ SO+ (LR ), and define its
discriminant kernel of L, sometimes called the stable special orthogonal group of L, by

(3.6)
ΓL = ker SO+ (L) → Aut(∆L ) .
This is the arithmetic subgroup that we will consider throughout the rest of this paper.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

15

3.2. Parabolic Subgroups of Orthogonal Groups. Given a boundary component of
Gr(L), the parabolic subgroup of SO+ (LR ) stabilizing this component is the stabilizer of the
corresponding isotropic subspace. There are (at most) two types of parabolic subgroups:
Ones that are associated with isotropic lines in LR , and ones that arise from isotropic
planes in LR . Having the rational structure, we work only with extensions of scalars of
primitive isotropic sublattices of L. Hence every rational isotropic line in LR is IR for a
primitive isotropic sublattice I of rank 1 in L, for which I = IR ∩ L, and we set
(3.7)

IL∗ = IR ∩ L∗ ,

IL⊥ = I ⊥ ∩ L,

IL⊥∗ = I ⊥ ∩ L∗ ,

and K = IL⊥ /IL .

Then KR = IR⊥ /IR is Lorentzian (of signature (n − 1, 1) in our convention), in which K is
an even lattice, and one verifies that

η ∈ KR (η, K) ⊆ Z ∼
= K ∗ = Hom(K, Z) ∼
= IL⊥∗ /IL∗
and the discriminant group of K is given by

∆K = K ∗ /K = IL⊥∗ /(IL⊥ + IL∗ ) = L∗I /(L + IL∗ ),
where L∗I stands for the subgroup

(3.8)
L + IL⊥∗ = µ ∈ L∗ ∃ν ∈ L such that (µ, λ) = (ν, λ) for all λ ∈ I

of L∗ . The lattice L∗I from (3.8) is the one denoted by L′0 (N) in [Br1].
We denote by PI,R the identity component of StSO+ (LR ) (IR ). A simple analysis of its
structure yields (see, e.g., [Nak], [Bo2], or [Ze5], among others) the following result.
+
Lemma 3.3. Consider the natural action of R×
+ × SO (KR ) on KR , in which the former
multiplier acts by ordinary scalar multiplication. Then there is a split exact sequence
+
0 → (KR , +) → PI,R → R×
+ × SO (KR ) → 1.

The rational isotropic planes in LR , which may exist only when n ≥ 2, are all of the
form JR , where J is a primitive isotropic sublattice of rank 2 in L. Then J = JR ∩ L, and
as in (3.7) we define
(3.9)

JL∗ = JQ ∩ L∗ ,

JL⊥ = J ⊥ ∩ L,

JL⊥∗ = J ⊥ ∩ L∗ ,

and D = JL⊥ /JL .

Here D is an even lattice inside the positive definite n − 2-dimensional space DR = JR⊥ /JR ,
and we have descriptions of the dual lattice D ∗ ⊆ DR , the discriminant group ∆D , and
the lattice L∗J , that are similar to those from I and K above, as in, e.g., (3.8). Since DR is
definite, the stabilizer StSO+ (LR ) (JR ) is connected, and we denote it by PJ,R . For presenting
its structure we recall the following definition.
Definition 3.4. The Heisenberg group H(DR ) associated with DR is the group DR ×DR ×R
with the product rule

(α, β, t) · γ, δ, s) = (α + γ, β + δ, t + s + (α, δ) − (β, γ) .

It is a non-trivial central extension of DR × DR by Z H(DR ) = {(0, 0, t)| t ∈ R} ∼
= (R, +),
as expressed by the non-split short exact sequence

0 → Z H(DR ) → H(DR ) → DR ⊕ DR → 0.

16

JAN H. BRUINIER AND SHAUL ZEMEL

The group GL+
2 (R) × SO(DR ) operates on H(DR ) via the formula
[M, γ] : (α, β, t) 7→ (aγα + bγβ, cγα + dγβ, det M · t),

where M = ac db . The action is compatible with the group structure on H(DR ). The
structure of PJ,R is now given (see, e.g., [K3] or [Ze5]) in the following lemma.
(3.10)

Lemma 3.5. After choosing an oriented basis (z, w) for JR , the action of GL+
2 (R)×SO(DR )
on H(DR ) in (3.10) defines PJ,R via the split short exact sequence
1 → H(DR ) → PJ,R → GL+
2 (R) × SO(DR ) → 1.

In correspondence with the general structure theorem from, e.g., Lemma 1.1 and Propositions 1.4 and 1.6 of [Ze5], the choice of the basis (z, w) for JR yields the isomorphisms
GL(JR ) ∼
= GL2 (R),

HomR (DR , JR ) ∼
= DR ⊕ DR ,

and

∗
∼
Homas
R (JR , JR ) = R,

where for the middle one we also used the self-duality of DR .
In order to put these results in the framework of the theory of toroidal compactifications, we shall henceforth write Ξ for a 0-dimensional boundary component and Υ for a
1-dimensional boundary component. The symmetric space D is Gr(L), and its rational
completion is
[  [

BB
D = Gr(L) ∪
ΞI ∪
ΥJ ,
I⊆L

J⊆L

where I (resp. J) will always mean a primitive isotropic sublattice of L of rank 1 (resp.
2). Note that it is possible that the union over J here, and even the union over I, may
be empty even in cases where Proposition 3.2 does not imply its emptiness. On the other
hand, Meyer’s Theorem (see, e.g., Corollary 2 on page 43 of [Se]) assures us that any
indefinite lattice of dimension at least 5 contains a non-zero isotropic vector. It follows
that if n ≥ 3 then rational 0-dimensional boundary components always exist, and when
n ≥ 5 we also have the existence of 1-dimensional such components.
Now, if Ξ = ΞI is the 0-dimensional boundary component of D BB ⊆ Gr(L) that is
associated with the rank 1 lattice I ⊆ L, then P(Ξ) is the group PI,R . We relate its
structure in Lemma 3.3 with the general structure from Proposition 2.7 as follows.

Proposition 3.6. The unipotent radical W(Ξ) of P(Ξ) = PI,R , as well as its center U(Ξ),
is the subgroup (KR , +) from Lemma 3.3. The quotient V(Ξ) is trivial, and so are the
group Gh (Ξ) = Aut(Ξ) and the compact group M(Ξ). The group Gℓ (Ξ) is the full quotient
+
R×
+ × SO (KR ), namely the full Levi subgroup.
Indeed, Ξ is a point, and the Levi subgroup from Lemma 3.3 has no compact factors,
yielding the triviality of Gh (Ξ) and M(Ξ).
For the explicit description of the fibrations from Proposition 2.8, choose an orientation
on I, and let z be the oriented generator of I. As presented in Section 13 of [Bo1], Section
3.2 of [Br1], Section 2.2 of [Ze1], or Section 1 of [Ze3], the condition of pairing to 1 with z
produces a section of the restriction of the projection from (3.3) to the component P + . The

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

17

orientation on elements v ∈ Gr(L) and on I given by the choices of P + and z determine a
cone C of negative norm vectors in the Lorentzian space KR , such that if


KR1 = ξ ∈ LR (ξ, z) = 1 IR

is the affine model of KR arising from z, then our section defines a biholomorphic map
open


(3.11)
Gr(L) → KR1 + iC ⊆ KR1 + iKR = KC1 = ξ ∈ LC (ξ, z) = 1 IC .

The inverse of the map from (3.11), which implies that it is a biholomorphism, is easily
determined by the fact that different lifts to LC of an element of KC1 , which has a non-zero
pairing with the isotropic vector z, have different norms, and hence only one such lift is also
isotropic. The cone C and the complementary cone −C are self-adjoint in the terminology
of [AMRT] or [Nam], and the model KR1 + iC for Gr(L) from (3.11) is a tube domain. The
explicit description of the objects from Proposition 2.8 is now as follows.

e
Proposition 3.7. The basis Ξ and the fiber bundle D(Ξ)
are trivial, and D = Gr(L) is
isomorphic (as the fiber of a map to a point) to the affine tube domain KR1 +iC from (3.11).
The map Φ takes the element v ∈ Gr(L), whose image in P + under the section is ZL , to
the projection Y ∈ C of YL = ℑZL ∈ IR⊥ in KR , and the cone Ω(Ξ) is C.

In addition, U(Ξ) = KR acts additively on the real part of Gr(L) ∼
= KR1 + iC from (3.11),
+
×
and the quotient R+ × SO (KR ) acts on its symmetric space, the cone C, via the map Φ
described in Proposition 3.7, as Proposition 2.9 predicts.
We also need the intersections from (2.7), with Γ being ΓL from (3.6). The following
result, in which ΓK is defined defined analogously to ΓL , was seen in [Bo1], [Br1], [Nak],
[Ze1], [Ze3], [Ze5], and others.
Proposition 3.8. The intersection PZ (Ξ) = PI,R ∩ ΓL lies in a split short exact sequence
0 → (K, +) → PI,R ∩ ΓL → ΓK → 1.

Hence WZ (Ξ) = UZ (Ξ) = K, the group PZ (Ξ) is the semi-direct product, and its image
Γℓ (Ξ) in Gℓ (Ξ) is ΓK .
As the action of UZ (Ξ) = K on Gr(L) ∼
= KR1 + iC from (3.11) is additive on the real
part, we get that as the fiber over a point from Proposition 3.7 we have
(3.12)

open

K\ Gr(L) ∼
= (KR1 /K) + iC ⊆ (KR1 /K) + iKR = KC1 /K = TK1 (C),

which is indeed a principal homogenous space over TK (C) = TUZ (Ξ) (C), as expected from
(2.9). In [Bo1], [Br1], [Ze1], [Ze3], and others, the affine tube domain from (3.11) is
replaced, via the choice of ζ ∈ L∗ with (ζ, z) = 1, by a subset of KC itself, and modulo K one
obtains a subset of TK (C) in (3.12). However, this is not necessary for most applications,
and we stay with our affine models, since they are more canonical. We summarize:
Corollary 3.9. The set UZ (Ξ)\D = K\ Gr(L) is isomorphic, as the fiber over the trivial
e
space D(Ξ),
to an open subset of a principal homogenous space over TK (C), with imaginary
part in the direction of C.

18

JAN H. BRUINIER AND SHAUL ZEMEL

We now compare the structure of the groups and fibrations that are associated with
a 1-dimensional boundary component to the components from Section 2. For a rank 2
primitive isotropic sublattice J ⊆ L, we denote the 1-dimensional boundary component
ΥJ of D BB ⊆ Gr(L) by Υ, and then P(Υ) is the group PJ,R considered in Lemma 3.5. For
putting this lemma in the framework of Proposition 2.7, recall that the action of GL+
2 (R)
on H and its factor of automorphy are defined as


aτ + b
a b
,
and
j(M, τ ) = cτ + d
(3.13) M =
∈ GL+
(R) : τ ∈ H 7→ Mτ =
2
c d
cτ + d
×
respectively, and that GL+
2 (R) is the direct product of the connected component R+ of
+
Z GL2 (R) with SL2 (R). The decomposition of P(Υ) is now as follows.

Proposition 3.10. The unipotent radical W(Υ)
 of the group P(Υ) = PJ,R is the Heisenberg group H(DR ), its center U(Υ) is Z H(DR ) = R, and the quotient V(Υ) is DR ⊕ DR .
Inside the Levi subgroup, Gh (Υ) is SL2 (R), Gℓ (Υ) is the group of R×
+ of scalars, and M(Υ)
is the compact group SO(DR ).
Take now, following Section 1 of [K3], an oriented Z-basis (z, w) for J from (3.9), and
lift Gr(L) into P + via the section of the map from (3.3) that is associated with z. Assume
that v ∈ Gr(L) is taken to ZL ∈ P + , and then the fact that YL2 < 0 for YL = ℑZL implies
that YL 6∈ JR⊥ and hence (YL , w) 6= 0. The orientation then implies that
x + iy = τ = (ZL , w) ∈ H

(3.14)

(note that in spite of the similar notation, this is not the coordinate for the cusp Υ itself,
appearing in (3.5)). We now define, similarly to KR1 and KC1 from (3.11), the affine spaces




DR1,x = ξ ∈ LR (ξ, z) = 1, (ξ, w) = x JR , DR0,y = ξ ∈ LR (ξ, z) = 0, (ξ, w) = y JR ,
and the complexification



DC1,τ = DR1,x + iDR0,y = ξ ∈ LC (ξ, z) = 1, (ξ, w) = τ JC .

These are principal homogenous spaces over DR and an affine model of DC respectively.
The subgroups from Proposition 3.10 are given in [Fi] in terms of explicit matrices, under
the choice of a representing matrix for the quadratic form on L, but the more canonical
description of the fibrations from Proposition 2.8 uses the following presentation.
Lemma 3.11. With the choice of the basis (z, w) for J ⊆ JR , the action of W(Υ) on LR
is as follows. First, the action of the element α ∈ R ∼
= U(Υ) on LR is defined by
α : λ 7→ λ − α(λ, z)w + α(λ, w)z.

Consider now a pair (µ, ν) ∈ DR ⊕ DR = V(Υ), and let η denote an element of JR⊥ and
λ + JR denote the image of λ ∈ LR in LR /JR . Then the action of (µ, ν) is defined by the
formulas
η 7→ η − (η, µ)w − (η, ν)z

and

λ + JR 7→ λ + (λ, w)µ + (λ, z)ν + JR .

Complexifying, and taking ZL and τ are as in (3.14), we deduce that
α : ZL + Cz 7→ ZL − αw + Cz,

and

(µ, ν) : ZL + JR 7→ ZL + τ µ + ν + JR .

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

19

Proof. In general, the unipotent radical W(Υ) is defined as the kernel of the action of
P(Υ) = PJ,R on JR via GL+ (JR ) ∼
= GL+
2 (R) and on DR via SO(DR ) (see, e.g., [Ze5]).
Moreover, as dim JR > 1, the center U(Υ) is the subgroup acting trivially on JR⊥ , and in
dimension 2 the asserted action is the only orthogonal one fixing JR⊥ pointwise (this is in
V2
∗
correspondence with the space Homas
JR in the notation
R (JR , JR ) of [Ze5], or equivalently
of [L], being 1-dimensional). It follows that the quotient V(Υ) has a well-defined action
on elements of JR⊥ , which is given by subtracting elements of JR , but on general elements
of LR the action is only defined modulo JR (by subtracting elements of the quotient DR ).
With the appropriate normalization, the orthogonality condition yields again the required
formulas. For the last assertion we just consider the image of α modulo Cz, and substitute
the values (ZL , z) = 1 and (ZL , w) = τ from (3.14). This proves the lemma.

The structure of D = Gr(L) that is associated with Υ in Proposition 2.8 can now be
described.
S
e
Proposition 3.12. The affine vector bundle D(Υ)
from (2.6) is τ ∈H DC1,τ , with DC1,τ
e
as in (2.4),
being the fiber over τ ∈ Υ ∼
= H. The fiber of D over any point in D(Υ),
is a translated upper half-plane. The cone Ω(Υ) is the ray R+ inside U(Υ) = R, and if
2
v ∈ Gr(L) is represented by ZL ∈ P + and τ is as in (3.14) then Φ(v) = − (ℑZ2yL ) .
Proof. Lemma 3.11 shows that the fiber DC1,τ over τ ∈ Υ is a principal homogenous space
over V(Υ), with the complex structure varying with τ , as in (2.6). In addition, we have
e
seen that if v ∈ Gr(L) is sent to ZL ∈ P + then its image on D(Υ)
is just ZL + JC ∈ DC1,τ ,
for τ from (3.14). Hence two images of our section that map to the same point in DC1,τ can
only differ by complex multiples of w and z. But inverting the map from (3.11) shows that
the condition ZL2 = 0 determines the required multiple of z once that of w is chosen, so
that it remains to see which multiples of w satisfy the condition from (3.2). Write ZL as
XL + iYL as above, and as YL ⊥ z in the image of the section, the value of YL2 is evaluated
using only the multiple of w, and subtracting tw from YL subtracts 2yt from YL2 . Therefore
t must be bounded from below for obtaining section images from Gr(L), and there is no
restriction on the multiple of w subtracted from XL . The associated fiber is therefore an
affine
copy of H, and in particular it is non-empty, so that the map from Gr(L)
S translated
1,τ
to τ ∈H DC is indeed surjective. As U(Υ) is 1-dimensional, and the oriented cone Ω(Υ)
can only be the directed ray in U(Υ), this is indeed as described in (2.4).
Now, Lemma 3.11 also shows that U(Υ) acts transitively on the real parts of the fibers
Y2
of from (2.4), and the asserted Φ-image − 2yL was seen to be a translate of the imaginary
part of these fibers. Moreover, as this Φ-image depends only on the imaginary part of ZL ,
the presentation from (2.5) also follows. In addition, our Φ-image lies, by definition, in
the directed cone Ω(Υ) = R×
+ inside U(Υ) = R, and since Lemma 3.11 shows that both
τ and z are invariant under W(Υ), so is the value of Φ. Now, the action of the Levi
e
quotient on D(Υ)
over Υ and on Ω(Υ) via Φ is given in (3.10) via the interpretations
from Proposition 2.8, and if M ∈ GL+
2 (R) = Gh (Υ) × Gℓ (Υ) and ZL is in the image of
the section and has projection in DC1,τ for τ from (3.14), then we have to divide the result

20

JAN H. BRUINIER AND SHAUL ZEMEL

by the factor of automorpy j(M, τ ) from (3.13) in order to remain in the image of the
section. It follows that the action of Gh (Υ) = SL2 (R) and M(Υ) = SO(DR ) are trivial on
Ω(Υ), and that the group Gℓ (Υ) = R×
+ from Proposition 3.10 is indeed the automorphism
group of Ω(Υ), with trivial stabilizers. On the other hand, on Υ ∼
= H the groups Gℓ (Υ)
and M(Υ) operate trivially, and the action of Gh (Υ) is the natural one from (3.13). This
proves the proposition.

Note that [K3] and [Fi] essentially use a complement for JR⊥ in LR , describing ZL as in
(4.18) below. However, we prefer the affine presentation from Proposition 3.12, since it is
more canonical and does not depend on the complement.
e
As a more geometric interpretation of the space D(Υ)
we recall the following definition.

Definition 3.13. Over H lies Shimura’s variation of Hodge structure V1, which has dimension 2. Its fiber is C2 , and over τ ∈ H it is defined by the vector τ1 having Hodge

weight (1, 0), while τ1 is of weight (0, 1). It is SL2 (R)-equivariant with respect to the
standard representation of that group on C2 , and has pure weight 1. If π : E → H is the
universal elliptic curve over H then we have V1 ∼
= R1 π∗ C, and the integral structure on the
local system is based on the subgroup Z2 ⊆ C2 .

e
In terms of Definition 3.13, the short exact sequence form (2.6) describes the space D(Υ),
∼
via Proposition 3.12, as an affine model of the vector bundle V1 ⊗ D over Υ = H.
As [Ze5] shows, the structure of the intersection PZ (Υ) = PJ,R ∩ΓL can be rather delicate
in general (this point was overlooked in [Fi]). In order to avoid extra complications in our
description, we first recall that for any primitive sublattice M ⊆ L there is a unimodular
complement, namely a subgroup of L∗ whose direct sum with M ⊥ ∩L∗ yields the full lattice
L∗ (the name arises from the fact that such a complement becomes naturally isomorphic to
Hom(M, Z), since M is primitive). We thus make the following hypothesis on the lattice
J from (3.9) for the rest of this section (the later results are independent of it).
Hypothesis 3.14. The lattice J has a unimodular complement J˜ that is isotropic and
whose intersection with the lattice L∗J defined as in (3.8) is contained in L, and the pairing
(λ, µ) is even for every λ and µ in the definite lattice D = JL⊥ /J from (3.9).
Note that our assumption on the pairing in D in Hypothesis 3.14 is stronger than D being
an even lattice (which is always the case when L is even), and is required for the assertion
about H(D) in Theorem 3.15 below (see Equation (14) of [Ze5]). It is always satisfied when
L is the rescaling by 2 of an integral lattice. The properties of the complement J˜ from
Hypothesis 3.14 are equivalent to the vanishing of the maps α and ι from [Ze5]. Equation
(9) of [Ze5] then shows, after substituting α = 0 there, that




˜ ⊥ ∩ L∗ ,
˜ ⊥ ∩ L and L∗ = JL∗ ⊕ J˜ ⊕ (J ⊕ J)
L = J ⊕ (J˜ ∩ L∗ ) ⊕ (J ⊕ J)
J

˜ ⊥ ∩ L (resp. (J ⊕ J)
˜ ⊥ ∩ L∗ ) mapping isomorphically onto D (resp. D ∗ ). It is
with (J ⊕ J)
easy to see that a complement as in Hypothesis 3.14 always exists when L is the rescaling
of a maximal lattice, since a maximal lattice of Witt rank 2 always splits two hyperbolic
planes, but there are other examples of lattices where such complements exist. Note that a

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

21

similar condition for the rank 1 lattices I (which does not follow from that on the lattices
J, because a complement I˜ and the lattice L∗I from (3.8) are larger than those associated
with J) is not required, since Proposition 3.8 holds without any assumption on I.
As the basis (z, w) that we took for JR spans J over Z, the resulting isomorphism
+
between GL+
2 (R) and GL (JR ), appearing implicitly in Lemma 3.5, identifies SL2 (Z) with
SL(J). We define ΓJ to be the congruence subgroup of SL2 (Z) that corresponds under this
isomorphism to

SL(JL∗ , J) = M ∈ SL(J) Mλ − λ ∈ J for every λ ∈ JL∗ .
We also define the integral Heisenberg group H(D) to be D × D × Z with the product rule
from Definition 3.4, and we get from [Ze5] the following result.

Theorem 3.15. The group H(D) is embedded in H(DR ) as the coordinates D × D × Z,
and one has the short exact sequence
1 → H(D) → PJ,R ∩ ΓL → ΓJ × ΓD → 1,
which is split over Z, with the action from (3.10).
The groups with index Z here take the following form, in which we define uΥ to be the
unique oriented primitive element of the cyclic group UZ (Υ) that lies in the cone Ω(Υ).
Proposition 3.16. The integral unipotent radical WZ (Υ) of PZ (Υ) = PJ,R ∩ ΓL is H(D),
its center UZ (Υ) is cyclic and generated by uΥ , and the quotient UZ (Υ) is D ⊕ D. In
addition, the image Γℓ (Υ) of PZ (Υ) in Gℓ (Υ) is trivial, in Gh (Υ) is it ΓJ , and in M(Υ) it
is the finite group ΓD .
The cyclic group UZ (Υ) from Proposition 3.16, oriented via Ω(Υ), is Homas (J ∗ , J) in the
V
notation of [Ze5] and 2 J in the notation of [L]. The triviality of Γℓ (Υ) implies that there
is no question of stabilizers in the fan Σ(Υ). Recall that if ΓL is neat then neither ΓL nor
the group ΓK from Proposition 3.8 nor ΓJ have non-trivial elements of finite order, and
the finite group ΓD is trivial. Dividing by the groups from Proposition 3.16 thus yields, by
Lemma 3.11 and Proposition 3.12, the following result.
e
Corollary 3.17. The fibers of UZ (Υ)\D = ZuΥ \ Gr(L) over the space D(Υ)
from Proposition 3.12 are open subsets of affine models of the 1-dimensional torus TUZ (Υ) (C). The space
WZ (Υ)\ Gr(L) is a similar bundle over the universal family E ⊗ D over H from Definition
3.13. If ΓL is neat then the quotient PZ (Υ)\ Gr(L) is also a bundle with the same fibers,
but now over the open Kuga–Sato variety WJ defined by E ⊗ D over ΓJ \H. The same
assertions hold if we replace Gr(L) by an open subset NΥ as defined in Lemma 2.10.
As the exponential map of the corresponding normalized coordinate from H takes the
open subset of TU1Z (Υ) (C) arising either from quotients of Gr(L) or of NΥ onto a punctured
open disc in C, all the bundles from Corollary 3.17 are punctured disc bundles. We shall
indicate briefly what happens when ΓL is not neat, or when the conditions from Hypothesis
3.14 are not satisfied, after Proposition 3.19 below.

22

JAN H. BRUINIER AND SHAUL ZEMEL

3.3. The Toroidal Boundary Components. We begin by considering the toroidal
boundary components over 1-dimensional cusps. These boundary components are canonical, and their description does not require the gluing with the boundary components
lying over the 0-dimensional cusps. Indeed, we have seen in Propositions 3.16 and 3.12
that UZ (Υ) has rank 1 and hence dim TUZ (Υ) = 1, and the cone Ω(Υ) is a ray in U(Υ).
There
is therefore only one possible cone decomposition: We must take Σ(Υ) to be

Ω(Υ) ∪ {0}, {0} . It follows that if νΥ is the element of UZ (Υ)∗ taking the generator
uΥ from Proposition 3.16 to 1, then the toric variety XUZ (Υ),Σ(Υ) is Spec C[zνΥ ] ∼
= A1 ,
e
and the set DΥ from (2.13) is the union of UZ (Υ)\ Gr(L) and D(Υ).
Note that the A1 ′
coordinate zνΥ is the coordinate denoted by q2 = e(τ2 ) in [K3], so that the equation zνΥ = 0
for that boundary component, given in the proof of Proposition 2.5, is just q2 = 0 from
that reference. As Proposition 3.16 shows that PZ (Υ) maps trivially to Gℓ (Υ), no quotient
of the fiber XUZ (Υ),Σ(Υ) has to be taken in the construction of X tor . In particular, Theorem
2.13 becomes trivial for our Υ.
Combining this information with Corollary 3.17 yields the form of DΥ and its quotients.
The set NΥ from Lemma 2.10 is defined by the Φ-image being large enough in the 1dimensional ray Ω(Υ). We recall that (2.8) denotes the quotient PZ (Υ)/UZ (Υ) by P Z (Υ),
that Lemma 2.10 defines the open subset NΥ of D, and the notation for the relative interior
of the closure appearing in (2.12) and after it, and obtain the following description of the
o
sets DΥ and UZ (Υ)\NΥ and their quotients in this case.
o

Lemma 3.18. The set DΥ and the open subset UZ (Υ)\NΥ are full, non-punctured open
e
disc bundles over D(Υ)
from Proposition 3.12, where the zero section of the disc defines
o
an analytic divisor O(Υ). The quotient VZ (Υ)\DΥ and its open subset WZ (Υ)\NΥ are
similar disc bundles over the family E ⊗ D over H from Corollary 3.17. If ΓL is neat then
o
P Z (Υ)\DΥ , as well as the open subset PZ (Υ)\NΥ , are open disc bundles over the open
Kuga–Sato variety WJ .
We deduce the following consequence (still under Hypothesis 3.14 and for neat ΓL ).

Proposition 3.19. The inverse image in P Z (Υ) DΥ of the image of Υ in PZ (Υ)\D BB
has a smooth neighborhood that is biholomorphic to the product of WJ with a disc, in which
the boundary component itself is defined by the vanishing
of the disc coordinate. Therefore

to Υ one associates a canonical divisor in P Z (Υ) DΥ , which is isomorphic to WJ .
Proposition 3.19 follows immediately from the fact that the bundles in Lemma 3.18 are
trivial. We remark again that Lemma 3.18 and Proposition 3.19 do not depend on choices
of fans, since Σ(Υ) is canonical.

Without Hypothesis 3.14, the form of the boundary divisor of P Z (Υ) DΥ can be significantly more complicated—the interested reader may consult Section 4 of [Ze5] for the
details. As mentioned above, Hypothesis 3.14 is only used for the simpler description of
the parts of Corollary 3.17, Lemma 3.18, and Proposition 3.19 involving the Kuga–Sato
variety, and all the results that we present from now on are equally valid without it.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

23

Consider now a 0-dimensional cusp Ξ, associated with the rank 1 isotropic sublattice
I ⊆ L, with K as in (3.7). The toroidal boundary components lying over Ξ depend on
a choice of a fan Σ(Ξ), which has to be an admissible cone decomposition in the sense of
Definition 2.12. These components must lie, in correspondence with Corollary 3.9, in the
direction of Ω(Ξ), which equals C by Proposition 3.7, but we shall also need to consider the
images Ω(Υ) for boundary components Υ of D BB with Ξ ≤ Υ. These are Υ = D = Gr(L),
with Ω(D) = {0}, and those components Υ associated with primitive isotropic rank 2
sublattices J ⊆ L such that I ⊆ J. Given such J, note that J ⊆ IL⊥ , and the quotient J/I
is a rank 1 primitive isotropic sublattice of K, generating the isotropic line JR /IR ⊆ KR .
Assuming that the orientations and the bases are chosen appropriately, we get a generator
z for I, a generator ωJ,I for J/I that lies on the boundary of the cone C, and an element w
of J such that (z, w) is an oriented basis for J over Z and ωJ,I = −w + I. This extra sign
comes from the fact that w pairs positively with elements of C by (3.14), while the vector
ωJ,I , which lies in the closure of the cone C of negative norm vectors, pairs negatively with
elements of C.
Lemmas 3.3 and 3.5 and Propositions 3.8 and 3.16 allow us to neatly express the intersections P(Ξ) ∩ P(Υ) = PI,R ∩ PJ,R and PZ (Ξ) ∩ PZ (Υ). In particular, the image of the
latter inside the Levi quotient from Lemma 3.3 is the stabilizer StΓK (J/I), for which an
analogue of Proposition 3.8 yields the split short exact sequence
(3.15)

0 → (D, +) → StΓK (J/I) → ΓD → 1.

with the quotient ΓD being trivial in case ΓL is neat. Moreover, the inclusions from Lemma
2.11 express themselves in the following relations, in which we note that the subgroup
{0} × DR × R of H(DR ), and its intersection {0} × D × Z with H(D), are Abelian.
Proposition 3.20. The image of U(Ξ) in the short exact sequence from Lemma 3.5 consists of the part {0} × DR × R of H(DR ), and of the upper triangular unipotent part of
SL2 (R). It is a direct sum of these two groups. After writing U(Ξ) = W(Ξ) ∼
= (KR , +) as
in Proposition 3.6, we get
U(Ξ) ∩ W(Υ) = {0} × DR × R ∼
= (JR /IR )⊥
as well as

U(Υ) = RuΥ ∼
= JR /IR = RωJ,I .
Hence Ω(Υ) is the isotropic ray R+ ωJ,I on the boundary of Ω(Ξ) = C. On the other
hand, Gh (Ξ) is the trivial subgroup of Gh (Υ). Finally, the description of UZ (Ξ) = K from
Proposition 3.8 is obtained by replacing every R above by Z, and the spaces KR , DR , JR /IR ,
and (JR /IR )⊥ by the lattices K, D, J/I, and (J/I)⊥
K respectively.
The proof of Proposition 3.20 is a simple application of Lemma 3.11 and the action of
the unipotent part of Gh (Υ) in Proposition 3.12. This also shows that the action of U(Ξ)
by translations of the real part in the model of Gr(L) as KR1 + iC from (3.11) becomes, in
the bundle structure appearing in Proposition 3.12, an additive action on the real parts of
e
the 1-dimensional fiber of Gr(L) over D(Υ),
of the fibers of V1 ⊗ D, and of the variable
∼
τ ∈ H = Υ.

24

JAN H. BRUINIER AND SHAUL ZEMEL

As Proposition 3.8 shows that P Z (Ξ) is just ΓK , Proposition 3.20 yields the following
explicit description of the admissibility condition of Σ(Ξ) in Definition 2.12, for Ξ = ΞI .
Corollary 3.21. The fan Σ(Ξ) is an admissible cone decomposition as in Definition 2.12
if and only if the following two conditions are satisfied:
(i) We have
[

σ∈Σ(Ξ)

σ = C ∪ {0} ∪

[

Ξ≤Υ



Ω(Υ) = C ∪ {0} ∪

[

⊥
I⊆J⊆IL


R+ ωJ,I ,

where Υ is always a 1-dimensional cusp and J is always a rank 2 primitive isotropic
sublattice of L.
(ii) Σ(Ξ) is ΓK -invariant, and the number of ΓK -orbits in Σ(Ξ) is finite.
For proving Corollary 3.21, it only remains to observe that every primitive isotropic
vector in K that lies in the closure of C must be the form ωJ,I for a 2-dimensional primitive
isotropic lattice J ⊆ L with I ⊆ J ⊆ IL⊥ . Note that when V has Witt rank 1, there are no
1-dimensional boundary components Υ and K is anisotropic, which means that the union
S
σ∈Σ(Ξ) σ from Corollary 3.21 is just C ∪{0}. In any case, the action of ΓK sends boundary
components to boundary components.

Let thus Σ(Ξ) be admissible as in Corollary 3.21, and consider the toric variety XK,Σ(Ξ) .
The properly discontinuous action of ΓK on XK,Σ(Ξ) , predicted by Theorem 2.13, can be
verified directly. First, since the orthogonal complement in K of the generator of a ray
in C is positive definite, the stabilizer of every such ray in ΓK is finite, and the stabilizer
of any cone in Σ(Ξ) operates on the finitely many rays that generate it. This proves this
finiteness of the stabilizer of any cone σ containing a ray that lies inside C, and with it
the fact that the action of ΓK on the associated open subvariety Xσ of XK,Σ(Ξ) is properly
discontinuous. Next, consider the stabilizer StΓK (J/I) of the ray Ω(Υ) = R+ ωJ,I from
Proposition 3.20 for Υ with Ξ ≤ Υ that is associated with I ≤ J ≤ IL⊥ . The action of
the infinite part (D, +) of that stabilizer, given in (3.15), does not leave any vector on
the boundary of C invariant, other than the multiples ωJ,I . Hence any cone of dimension
at least 2 in XK,Σ(Ξ) still has
 a finite stabilizer in ΓK , and the action of the larger group
PZ (Υ) on the orbit O Ω(Υ) was already verified to be properly discontinuous, essentially
in Lemma 3.18. It particular, if ΓL is neat then all of these stabilizers are trivial.
Substituting (3.12) into (2.12) shows that for (KR1 /K) + iC ⊆ XK,Σ(Ξ) we have

[ 
o
o
1
1
(3.16)
(KR /K) + iC =
(KR /K) + iC ∩ O(σ) ,
σ∈Σ(Ξ)

where for every σ ∈ Σ(Ξ) that is neither {0} nor R+ ωJ,I for some J, the intersection is all
e
of O(σ). This is also the form of DΞ from (2.13), by the triviality of D(Ξ)
from Proposition
3.7. The most natural way of defining ΩN (Ξ) ⊆ Ω(Ξ) = C for the set NΞ from Lemma
2.10 is simply by requiring that |Y 2 | be large enough. Using (3.16) and Proposition 3.8,

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

25

o

we deduce from (2.14) that the subset PZ (Ξ)\NΞ of ΓK \XK,Σ(Ξ) is

io
[
 n /h
(3.17)
PZ (Ξ)\NΞ ∪ ΓK
[(KR1 /K) + iC] ∩ O(σ)
,
{0}6=σ∈Σ(Ξ)

with the union consisting of finitely many orbits.
One can also visualize (2.15) in our case: Since the comparison of any boundary component with D itself is immediate in general, the only case to consider is where dim Ξ = 0,
dim Υ = 1, and
 Ξ ≤ Υ. Expressing DΞ as in (3.16), we then have to verify that
UZ (Ξ)/UZ (Υ) DΥ is the intersection of DΞ with the affine 
toric subvariety XK,Ω(Υ) of
XK,Σ(Ξ) . But indeed, Lemma 3.18 shows that UZ (Ξ)/UZ (Υ) DΥ is a disc bundle over

e
UZ (Ξ)/UZ (Υ) D(Υ),
which by Proposition 3.20 is itself fibered over the punctured disc

1
StΓJ ( 0 \H, with the fibers being affine models of DC /D = TD (C). But extending the
disc in the fibers from Lemma 3.18 to C and the punctured disc in the base space to C×
yields an affine structure of TK , with the completion of the disc corresponding to the co∗
ordinates zν for those ν ∈ K
having a positive pairing with uΥ = ωJ,I being allowed to
vanish. Hence UZ (Ξ)/UZ (Υ) DΥ is indeed the desired open subset of XK,Ω(Υ).
As the set from (3.17) maps isomorphically onto a neighborhood of Ξ in PZ (Υ)\D BB ,
we apply (2.15) and deduce the following complement of Proposition 3.19.
fib
the complement in XK,Σ(Ξ) of the union
Proposition 3.22. Denote by XK,Σ(Ξ)
[
TK ∪
O(R+ ωJ,I ),
⊥
I⊆J⊆IL

with J as usual. It is a closed ΓK -invariant subset of XK,Σ(Ξ) , which is contained in DΞ .
fib
Then the inverse image in ΓK \XK,Σ(Ξ) of the image of Ξ in PZ (Ξ)\D BB is just ΓK \XK,Σ(Ξ)
.
It is a closed subset of ΓK \XK,Σ(Ξ) with a finite stratification, in which each stratum is the
quotient of a toric TK -orbit modulo a finite group. If ΓL is neat and Σ(Ξ) is smooth as in
Definition 2.3, then this inverse image has a smooth neighborhood in ΓK \XK,Σ(Ξ).
We shall need the divisors that are contained in the inverse image from Proposition 3.22.
Corollary 3.23. There are finitely many ΓK -orbits of rays ρ = R+ ω in Σ(Ξ), with primitive ω ∈ K, that are not of the form Ω(Υ) for a 1-dimensional boundary component
Υ with Ξ ≤ Υ. The vector ω ∈ K ∩ C satisfies ω 2 = −2Nω for some positive integer
Nω , which is constant on ΓK -orbits. Therefore the boundary from Proposition 3.22 contains finitely many irreducible divisors, each of which is the image of a divisor of the form
Dρ = OΣ(Ξ) (R+ ω), and to such a divisor is attached the associated integer Nω .
It may happen that for some cusp Ξ, the set of divisors from Corollary 3.23 will be
empty: See the end of Section 2 of [Nam] for an example (recall that the group Sp4 from
that reference is isogenous to SO+ (2, 3)), as well as the case considered in [P]. In such a
case the inverse image from Proposition 3.22 has codimension 2 in ΓK \XK,Σ(Ξ) .
We need to see when is our collection of fans admissible as well. The corresponding
condition from Definition 2.12 is simpler in our case than in general.

26

JAN H. BRUINIER AND SHAUL ZEMEL

Lemma 3.24. For admissibility of the set of fans {Σ(Ξ)}Ξ , it suffices that for two 0dimensional
 cusps that are related by ΓL , say Ξ and AΞ for A ∈ ΓL , we have the equality
Σ(AΞ) = Aσ σ ∈ Σ(Ξ) .

Indeed, the fans Σ(Υ) = Ω(Υ), {0} for 1-dimensional boundary components Υ are
canonical, which in particular implies their ΓL -invariance, and they are included in Σ(Ξ)
wherever Ξ ≤ Υ in Corollary 3.21.
Since our arithmetic group depends on the choice of L, our open Shimura variety and
its Baily–Borel compactification from (2.3) are now
open

XL = ΓL \D = ΓL \ Gr(L) ⊆ XLBB = ΓL \D BB .

The toroidal compactification XLtor of XL , and the map onto XLBB = ΓL \D BB , are therefore
constructed, via Theorem 2.14, as follows.
Theorem 3.25. Let {Σ(Ξ)}Ξ≤D be an admissible collection of fans as in Definition 2.12,
or equivalently in Corollary 3.21 and Lemma 3.24. Then XL and the neighborhoods from
Lemma 3.18 and (3.17) glue together to a normal compact complex space, which is the set
tor
of complex points of a complete algebraic variety XLtor = X{Σ(Ξ)}
over C. It is smooth if
Ξ
ΓL is neat and each fan Σ(Ξ) is smooth in the sense of Definition 2.3
Note that if ΓL is not neat, finite quotient singularities may appear at every part of XLtor .
Let J and Υ be as in Proposition 3.19, and recall that the boundary divisor O(Υ) of
o
DΥ has the neighborhood UZ (Υ)\NΥ from
Lemma 3.18. Dividing by P Z (Υ), we get the

o
neighborhood PZ (Υ)\NΥ inside P Z (Υ) DΥ , which embeds as an open subset of XLtor . We
denote the maps
o

πΥ : UZ (Υ)\NΥ ։ PZ (Υ)\NΥ

o

and

o open

ιΥ : PZ (Υ)\NΥ ֒→ XLtor .

In addition, if I, K, Ξ, and Σ(Ξ) are as above, then dividing the neighborhood NΞ from
o
Lemma 2.10 by UZ (Ξ) = K from Proposition 3.8 gives an open neighborhood UZ (Ξ)\NΞ of
fib
the fiber XK,Σ(Ξ)
from Proposition 3.22 inside XK,Σ(Ξ) , and dividing further by P Z (Ξ) = ΓK
o

gives the open subset PZ (Ξ)\NΞ of ΓK \XK,Σ(Ξ) . Also here we set the notation
o

πΞ : UZ (Ξ)\NΞ ։ PZ (Ξ)\NΞ

o

and

o open

ιΞ : PZ (Ξ)\NΞ → XLtor .

Note that both ιΥ and ιΞ have open images in XLtor , but while ιΥ is a homeomorphism onto
its image (whence the notation there), ιΞ is not because the orbits O(R+ ωJ,I ) are divided
by WZ (Υ)/UZ (Ξ) ∼
= D. Taking ω and ρ to be as in Corollary 3.23, we define the irreducible
toroidal divisors

BI,ω = (ιΞ ◦ πΞ )(Dρ ) = (ιΞ ◦ πΞ ) OΣ(Ξ) (R+ ω) ,
(3.18)

BJ = (ιΥ ◦ πΥ ) O(Υ) .

Then the boundary of XLtor consists of a finite number of such divisors: One divisor BJ
for every J in a set of representatives for the ΓL -orbits of isotropic sublattices of rank 2 in
L, and one divisor BI,ω for every I in a similar set of representatives having rank 1, and

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

27

for ω in a set of representatives for the ΓK -orbits of primitive elements generating internal
rays in the fan corresponding to I, where K = IL⊥ /I. Clearly the image in XLtor of each
divisor does not depend on the representatives J or I and ω, and in the latter case the
value −2Nω of ω 2 is also independent of the representative. We conclude by recalling that
the divisor BI,ω from (3.18) contains also the ιΞ -images of orbits O(σ) for σ ∈ Σ(Ξ) with
ρ ≤ σ, and as for BJ , wherever Ξ ≤ Υ and σ ∈ Σ(Ξ) contains Ω(Υ) as a face, this divisor
BJ contains ιΞ O(σ) as well.

Remark 3.26. The choice of the lattice L determined the group ΓL from (3.6) to be the
arithmetic group by which we divide D = Gr(L) for obtaining XL . In some situations
in may be useful to consider covers of XL obtained by dividing by (normal) congruence
subgroups of ΓL , especially when ΓL is not neat and one wishes to avoid the resulting finite
quotient singularities in XL . All of these constructions carry over to such covers, yielding
compactifications of them, but as results like Proposition 3.8 or Theorem 3.15 no longer
necessarily hold for intersections with subgroups of ΓL , the precise analysis of the partial
quotients with which we work in our investigation may become more difficult.
4. Green Functions for Special Divisors
In this section we introduce the special divisors on XL and their Green functions, and
investigate their extensions to the toroidal compactification XLtor .
4.1. Special Divisors and Theta Lifts of Harmonic Maass Forms. Given an element
λ ∈ L∗ with λ2 > 0, the set

(4.1)
λ⊥ = v ∈ Gr(L) v ⊥ λ ,

whose pre-image in P + is {ZL ∈ P + | (ZL , λ) = 0 , is a sub-Grassmannian of complex
codimension 1 in Gr(L), hence an analytic divisor. We shall be interested in the following
combinations of the divisors from (4.1), which are called special divisors.
Definition 4.1. For an element µ ∈ ∆L and an number 0 < m ∈
special divisor of discriminant (m, µ) on XL to be
 X
λ⊥ .
Z(m, µ) = ΓL

µ2
2

+ Z we define the

λ∈µ+L
λ2 =2m

tor
We shall use Z(m, µ) also for the closure of this divisor in XLBB , in XLtor = X{Σ(Ξ)}
, or in
Ξ
any analytic manifold containing a quotient of Gr(L) as a dense open subset.

Since the number of ΓL -orbits associated with any m and µ in Definition 4.1 is finite,
Z(m, µ) is an algebraic divisor on XL . The multiplicities of the irreducible components of
Z(m, µ) are 2 if 2µ = 0 ∈ ∆L , and 1 otherwise.
Recall now the factor of automorphy from (3.13), and let

Mp2 (Z) = (M, ϕ) M ∈ SL2 (Z), ϕ : H → C, ϕ2 (τ ) = j(M, τ )

28

JAN H. BRUINIER AND SHAUL ZEMEL

be the metaplectic extension of SL2 (Z), with the product (M, ϕ)(N, ψ) = (MN, (ϕ◦N)·ψ).
It is generated by the elements


 


1 1
0 −1 √
T =
,1
and
S=
, τ .
0 1
1 0
Consider our even lattice L, of signature (n, 2), and let {eµ }µ∈∆L denote the canonical basis
of the group ring C[∆L ]. We denote by ρL the Weil representation of Mp2 (Z) on C[∆L ],
normalized as in [Bo1], [Br1], or [Ze1]. The dual representation ρ∗L of ρL is canonically
isomorphic to the complex conjugate representation ρL .
Let k ∈ 21 Z be a weight, and denote the weight k hyperbolic Laplacian, in the variable
τ = x + iy ∈ H, by
∆k = −y 2 (∂x2 + ∂y2 ) + ky(∂y − i∂x ) = −ξ2−k ξk ,
where ξk is the operator from [BFu] which is defined by ξk f = 2iy k ∂τ f . Recall that
a harmonic Maass form of weight k and representation ρL is a real-analytic function
f : H → C[∆L ] satisfying the functional equation
f (Aτ ) = ϕ(τ )2k ρL (A, ϕ)f (τ )

(4.2)

for every (A, ϕ) ∈ Mp2 (Z) and τ ∈ H, the differential equation ∆k f = 0, and such that
the growth of f towards the cusp ∞ is at most linear exponential. The ξk -image of such a
modular form is a weakly holomorphic modular form of weight 2 − k and representation ρL
(i.e., it is holomorphic on H, with at most a pole at ∞, and satisfies the functional equation
from (4.2) with 2k replaced by 4 − 2k and ρL replaced by ρL ), see [BFu]. We denote by
Mk! (ρL ) the space of weakly holomorphic modular forms of weight k and representation ρL ,
by Mk (ρL ) the subspace consisting of holomorphic modular forms, by S2−k (ρL ) the space
of cusp forms of weight 2 − k and representation ρL , and by Hk (ρL ) the space of harmonic
Maass form of weight k and representation ρL whose ξk -image is cuspidal. Corollary 3.8 of
[BFu] provides us with the exactness of the sequence
ξ

k
S2−k (ρL ) → 0.
0 → Mk! (ρL ) → Hk (ρL ) →

The modularity condition with respect to T implies that F ∈ Hk (ρL ) admits the Fourier
expansion
X
X
X X
c+ (δ, l)q l eδ +
c− (δ, l)Γ(1 − k, 4π|n|y)q leδ ,
(4.3)
F (τ ) =
δ∈∆L l∈− δ2 +Z
2

δ∈∆L 0>l∈− δ2 +Z
2

R∞
with q = e(τ ) as usual, such that c+ (δ, l) = 0 for l ≪ 0, and where Γ(s, x) = x ts e−t dtt
is the incomplete Gamma function. We denote by F + (τ ) the first sum in (4.3), called the
holomorphic part of F (τ ), and the second sum, which is the non-holomorphic part of F (τ ),
by F − (τ ). Moreover, restricting the sum defining the holomorphic part F + (τ ) to include
only the indices l < 0 yields the (finite) principal part of F . Proposition 3.11 of [BFu] then
yields the following result.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

29

2

Proposition 4.2. For every µ ∈ ∆L and 0 < m ∈ µ2 + Z there is a harmonic Maass form
Fm,µ ∈ H1− n2 (ρL ), which is unique up to an element of M1− n2 (ρL ), whose principal part is
q −m (eµ + e−µ ).
We remark that when n ≥ 3, where the harmonic Maass form Fm,µ from Proposition 4.2
is uniquely defined, it is alternatively constructed in [Br1] as a Poincaré series. When n = 2
it is unique up to a ρL -invariant vector, and when n = 1 up to a larger degree of freedom,
and the Hecke trick extends Poincaré series also to these cases, with some particular choice
of the element from M1− n2 (ρL ). In correspondence with the notation from [Br1] and [BFu],
the specialization of (4.3) when F = Fm,µ expands Fm,µ (τ ) as
(4.4)
X
X
X
X
l
l
b+
b−
q −m (eµ + e−µ ) +
m,µ (δ, l)q eδ +
m,µ (δ, l)Γ(1 − k, 4π|l|y)q eδ .
δ∈∆L 0>l∈− δ2 +Z
2

δ∈∆L 0≤l∈− δ2 +Z
2

The coefficients b±
m,µ (δ, l) are evaluated in Proposition 1.10 of [Br1], and they are real
numbers. This is true, by the Hecke trick, also when n = 2 and l 6= 0, and we assume that
b+
m,µ (δ, 0) ∈ R as well in this case. While some of the results below hold equally well for
n = 1, the fact that Fm,µ can be far from unique in this case can create some complications.
On the other hand, the boundary components are just the classical 0-dimensional cusps in
this case, and the theta lifts are investigated in detail in [BO], so that we do not lose much
by restricting attention to n ≥ 2.
Given τ = x + iy ∈ H and v ∈ Gr(L), we recall the Siegel theta function

X  λ2
2
e τ v2⊥ + τ λ2v eλ+L ,
(4.5)
ΘL (τ, v) = y
λ∈L∗

where λv and λv⊥ are the projections of λ onto the corresponding subspaces of LR . Theorem 4.1 of [Bo1] implies that the function τ 7→ ΘL (τ, v) is modular of weight n2 − 1 and
representation
ρL for any
P
Pfixed v ∈ Gr(L). WePrecall the pairing sending two vectors
a = δ∈∆L aδ eδ and b = δ∈∆L bδ eδ to ha, biL = δ∈∆L aδ bδ , and consider the regularized
theta lift
Z reg
L
(4.6)
Φm,µ (v) =
hΘL (τ, v), Fm,µ (τ )iL dµ(τ )
Mp2 (Z)\H

of the function Fm,µ from Proposition 4.2, where dµ(τ ) = dxy2dy is the invariant measure on
H, with the regularization defined either in [Bo1] or in [Br1], and where we can replace v by
the complex variable from Proposition 3.1. Proposition 2.11 of the latter reference implies
that the difference between the two regularizations is only in the value of the constant Cm,µ
below, and is therefore irrelevant to our purposes. Recall the decomposition of the exterior
derivative d as ∂ + ∂, as well as the complementary operator dc = ∂−∂
, so that ddc = 2πi ∂∂.
4πi
In addition, if Z is a divisor on XL then we denote by δZ the current on XL that takes
R an
element η of the space Ac2n−2 (XL ) of compactly supported (2n − 2)-forms on XL to Z η.
Some important properties of the theta lift ΦLm,µ are given in the following theorem.

30

JAN H. BRUINIER AND SHAUL ZEMEL

Theorem 4.3. The invariant Laplace operator on Gr(L), normalized as in [Br1], takes
1 L
the theta lift ΦLm,µ from (4.6) to n4 b+
m,µ (0, 0). Moreover, the function 2 Φm,µ is smooth on
XL \Z(m, µ) with a logarithmic singularity along Z(m, µ). The function 21 ΦLm,µ also satisfies
the current equation
ddc [ 21 ΦLm,µ ] + δZ(m,µ) = [η(m, µ)]
as currents on Ac2n−2 (XL ), where η(m, µ) is a smooth harmonic 2-form representing the
Chern class of the line bundle that is associated with Z(m, µ) on XL .
The first assertion in Theorem 4.3 is Theorem 4.7 of [Br1] (see [Ze1] for analogues of
this statement, without contributions from the constant terms, in some different weights).
For the other assertions we refer to Theorem 2.11 of [Br1] and Theorem 7.3 of [BFu].
In particular, 21 ΦLm,µ is a logarithmic Green function for Z(m, µ) on XL in the sense of
Arakelov geometry, see Section 1.2.4 of [GS] and Section 5.6 of [BKK]. We remark that [OT]
presents a different approach for the construction of such automorphic Green functions,
using spherical functions for symmetric pairs and Poincaré series constructions.
4.2. Green Functions Near the Toroidal Boundary. We will now investigate the
growth behavior of ΦLm,µ along the boundary of the toroidal compactifiation XLtor .
For expressing ΦLm,µ near the boundary we shall need some notation. First, for the
non-triviality of the boundary of D BB there must exist an isotropic sublattice I of rank 1
in L, with an oriented generator z and an associated 0-dimensional boundary component
Ξ ∈ D BB , and we take K to be as in (3.7) and I˜ ⊆ L∗ to be a unimodular complement for
I, with an oriented generator ζ pairing to 1 with z. Subtracting the image of ζ transforms
the affine tube domain model KR1 + iC from (3.11) into the open subset KR + iC of KC ,
∗
so that the pairing of an element Z of the
√ latter space Ywith some element η ∈ K is welldefined. Given Y ∈ C, we write |Y | for −Y 2 , so that |Y | represents a normalized oriented
generator of a negative definite subspace in KR . Observe that ζ ∈ L∗ has well-defined Q/Zpairings with elements of ∆L , and recalling the lattice L∗I from Equation (3.8), we define
the projection
(4.7)

pK : IL⊥∗ /IL⊥ = L∗I /L → ∆K ,

pK δ = δ + IL∗ /I.

Now, if µ ∈ IL⊥∗ /IL⊥ and ν ∈ IL⊥∗ ∩ (µ + L) with ν 2 = 2m then the closure of the analytic
divisor ν ⊥ from (4.1) in D BB contains Ξ. Moreover, there are finitely many ΓL -orbits of
such divisors ν ⊥ , which form a hyperplane arrangement in the terminology of [L]. Omitting
the intersection of their imaginary parts with the cone C produces a disjoint union of open
subsets of C that are called Weyl chambers. By a slight abuse of terminology we also call
a Weyl chamber the subset KR1 + iW of KR1 + iC for a Weyl chamber W in C, and we recall
that these Weyl chambers are associated with m and µ, or equivalently with the form Fm,µ .
The theta lift ΦLm,µ from (4.6) is described explicitly in the formula preceding Definition 3.11 of [Br1], which we now put in our notation and conventions. We recall that
Z ∞
dt
2
Vκ (A, B) =
Γ(1 − κ, A2 t)e−B t−1/t 3/2
t
0

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

31
√

2

2

is the special function from Equation (3.25) of [Br1], which decays as Cε e−2(1−ε) A +B as
K
A2 + B 2 → ∞. Considering the function denoted by Fm,µ
in the language of [Bo1] and
L
by ↓K (Fm,µ ) using the operators from [Br2], it is used for defining the theta lift ΦK
m,pK µ
similarly to (4.6), and we describe it in Proposition 4.6 below.
Proposition 4.4. Let ZL ∈ P+ be such that (ZL , z) = 1 and the image Y of ℑZL in
C ⊆ KR lies in a Weyl chamber W that is associated with Fm,µ and satisfies |Y 2 | > 2m.
Then there is a constant Cm,µ such that the equality


Y
|Y | K
L
2
Φm,µ (ZL ) = √ Φm,pK µ
+ Cm,µ − b+
m,µ (0, 0) log |Y |+
|Y |
2
X
X



ν2
b+
log 1 − e (ν, ZL ) − 4
−4
m,µ ν + L, − 2 log 1 − e (ν, ZL ) +
⊥ ∩(±µ+L)]/I
ν∈[IL
∗
ν 2 =2m
(ν+IR ,W )>0

⊥ /I
ν∈IL
∗
2
ν ≤0
(ν+IR ,W )>0


∞
X


e
h(ν,
ℜZ
)
2 X −
2
L
V1+ n2 πh|ν| · |Y |, πh(ν, Y )
+√
bm,µ ν + L, − ν2
h
π
⊥
h=1
ν∈IL∗ /I
ν 2 >0

holds, where the first term and the first sum do not appear if µ 6∈ IL⊥∗ /IL⊥ .
Proof. Let Z = X +iY ∈ KR +iC be the coordinate ZL −ζ +IC correspondingto ZL . Then
the formula from [Br1] in question involves expressions like e (δ, ζ) + (λ, Z) for λ ∈ K ∗
and δ ∈ L∗I /L with pK δ = λ + K. The expression for Z and the fact that λ is of the form
2
2
ν + IL∗ for some ν ∈ IL⊥∗ imply that ν2 = λ2 and (λ, Z) is the same as (ν, ZL − ζ). In
addition, the choice of δ determines ν up to I rather than up to IL∗ , and the pairing (δ, ζ)

is then the image in Q/Z of (ν, ζ), so that the expression in question is just e (ν, ZL ) ,
which is defined for ν ∈ IL⊥∗ /I. Substituting all this, and normalizing according to our
convention for the signature, gives the desired result. This proves the proposition.

The constant Cm,µ from Proposition 4.4 is given, in the regularization from [Br1], by
X

+′
b+
b+
m,µ (0, 0)(log 2π − γ) + bm,µ (0, 0) − 2
m,µ (ℓ, 0) log 1 − e (ℓ, ζ) ,
06=ℓ∈IL∗ /I
′

where γ is the Euler-Mascheroni constant and b+
m,µ (0, 0) is the derivative with respect to
the spectral parameter (see Theorem 3.9 of [Br1]). Note that by Proposition 2.11 of [Br1],
this derivative does not appear in Cm,µ when one works with the regularization from [Bo1].
The proof of Proposition 4.4 also shows that the exponents in the formula for Cm,µ do not
depend on the choice of ζ and I˜ as well.
As we are interested in the behavior near toroidal boundary divisors, we first need to
divide by UZ (Ξ) = K and consider ΦLm,µ as a function on the subset (KR1 /K) + iC of the
principal homogenous space TK1 (C) from (3.12). This is done as follows.

32

JAN H. BRUINIER AND SHAUL ZEMEL

Lemma 4.5. The expression from Proposition 4.4 is invariant under the action of K by
translations on the real part, and thus represents the value ΦLm,µ (ZL + K) with the variable
ZL + K ∈ (KR1 /K) + iC ⊆ TK1 (C) as well.
The Grassmannian Gr(K) that is associated with the Lorentzian lattice K, of signature
(n−1, 1), is defined as in (3.1), but with the dimension of the negative definite subspaces of
KR being 1. As each such subspace is generated by a unique element u1 ∈ C with u21 = −1,
we can define the Siegel theta function ΘK as in (4.5), but with the Grassmannian variable
√
v replaced by such a vector u1 and y replaced by y. The function τ 7→ ΘK (τ, u1 ) is then
modular of the same weight n2 − 1 and representation ρK for every such u1 . The theta lift
ΦK
m,pK µ , evaluated at u1 , is defined like in (4.6), but with L replaced by K, v replaced by
u1 , and ↓LK (Fm,µ ) instead of Fm,µ itself. Recalling that when n ≥ 3 the latter function is
defined as a Poincaré series, we deduce that ↓LK (Fm,µ ) = 0 when µ 6∈ IL⊥∗ /IL⊥ , and with it
ΦK
m,pK µ vanishes as well. A similar argument will show that if n ≤ 2 then perhaps some
function remains from lifting an element of M1− n2 (ρL ).
For evaluating the first term in Proposition 4.4, we assume that L has Witt rank 2
and hence K is also isotropic, and we choose an isotropic sublattice of K, which is of the
form J/I for an isotropic sublattice J of rank 2 in L. We extend the basis z of I to an
oriented basis (z, w) for J, so that the image of w in K, which we shall also denote by w,
is a generator for J/I whose additive inverse lies on the boundary of C. A unimodular
complement J˜ is spanned by the dual basis, which we can write, if I˜ is chosen appropriately,
as consisting of ζ ∈ I˜ from above and another element υ ∈ J˜ ∩ IL⊥∗ pairing to 1 with w.
We would like to express ΦK
m,pK µ via Equation (3.11) of [Br1], up to a small correction as
⊥
follows. we define pD : JL∗ /JL⊥ = L∗J /L → ∆D for D as in (3.9) analogously to (4.7), and
recall that B2 is the second Bernoulli function, which is 1-periodic and defined by
B2 (x) = x2 − x +

1
6

for 0 ≤ x ≤ 1.

Since D is positive definite, its associated Grassmannian from (3.1) is trivial, and the
theta function from (4.5) has just the variable τ , in which it is a holomorphic modular
form of the weight n2 − 1 and representation ρD (see (4.24) below). Then the analogue
of (4.6) defines ΦD
m,pD µ as the regularized integral of a non-holomorphic modular function
on Mp2 (Z)\H arising from ΘD and ↓LD (Fm,µ ), which vanishes by the same argument if
n ≥ 3 and µ 6∈ JL⊥∗ /JL∗ . Let Kn/2 denote the modified Bessel function of the third kind
with the parameter n2 , recall that the pairing (w, Y ), which is well-defined for Y ∈ KR
because w ∈ I ⊥ , is positive by the orientation on J/I and C, and we obtain the following
expression.
Proposition 4.6. If µ ∈ IL⊥∗ /IL⊥ and the inequality (w, Y ) <

|Y | K
Y
√ Φ
in Proposition 4.4 equals
m,p
µ
|Y |
K
2

|Y |
√
2 m

X

|Y 2 |
b+
ΦD
m,µ (ℓ, 0)B2 (ℓ, υ) +4π(w, Y )
m,pD µ +4π(w, Y )
2(w, Y )
ℓ∈JL∗ /J

holds, then the first term
X

⊥ ∩(µ+L)]/J
λ∈[JL
∗
λ2 =2m

B2




(λ, Y )
+
(w, Y )

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

4(w, Y )
+
π

X

b−
m,µ

⊥ /J
06=λ∈JL
∗

λ+L, −

λ2
2

∞
X
h=1



πh|λ| · |Y |
(w, Y )

33

n/2 



2πh|λ| · |Y |
(λ, Y )
Kn/2
,
e h
(w, Y )
(w, Y )

where the third term also appears only when µ ∈ JL⊥∗ /JL∗ .

Proof. We know that µ ∈ IL⊥∗ /IL⊥ , and we take some element u1 ∈ C with u21 = −1 and
(w, u1) < 2√1m , which allows us to express ΦK
m,pK µ (u1 ) via Proposition 3.1 and Equation
(3.3) of [Br1]. This formula involves arguments like (β, µ̃) + (α, υ), with β ∈ D ∗ and
α ∈ ∆K that is perpendicular to the image of JL∗ in ∆K and whose image in ∆D is β + D,
u1
w
⊥
and where µ̃ is the vector (w,u
− υ + 2(w,u
2 in (J/I)R ⊆ KR in our signature convention.
1)
1)
Each such α is the image of several elements δ ∈ JL⊥∗ /JL⊥ with pD δ = β + D, for each such
δ we can write (α, υ) as (δ, υ), and for the Fourier coefficients we recall that ↓LK (Fm,µ )(τ )
expands as the principal part q −m (epK µ + e−pK µ ) plus
X
X
X
X
X
X
l
l
b+
b−
m,µ (δ, l)q eα +
m,µ (δ, l)Γ(1 − k, 4π|l|y)q eα .
α∈∆K 0≤l∈− α2 +Z δ∈I ⊥∗ /I ⊥
L
L
2
pK δ=α

α∈∆K 0>l∈− α2 +Z δ∈I ⊥∗ /I ⊥
L
L
2
pK δ=α

We can thus work with pairs (β, δ) for such β and δ, which are in correspondence with
elements λ ∈ JL⊥∗ /J like in the proof of Proposition 4.4. The pairing of the K ∗ -image such
an element, which is its class in JL⊥∗ /(J + IL∗ ), with w ∈ J/I is 0, and its pairing with u1 is
2
2
well-defined up to integral multiples of (w, u1). Since we have (β, µ̃) = (λ, µ̃) and β2 = λ2 ,
and (δ, υ) is the image of (λ, υ) in Q/Z once again, it follows that the argument in question
is just (λ, µ̃ + υ). By the formula for µ̃ and the vanishing of (λ, w), this is the same as
(λ,u1 )
, which is indeed defined up to integers and is substituted into 1-periodic functions.
(w,u1 )
Recalling that in the first term in Proposition 4.4 we have k = 1 − n2 and the coefficient
|Y |
√ , and that the variable u1 = Y satisfies the inequality (u1 , w) < √1
from Proposition
|Y |
2 m
2
3.1 of [Br1] by our assumption on Y , this proves the proposition.

4.3. Determining the Growth Towards the Boundary. As mentioned above, we need
to see how automorphic Green functions behave near a boundary component. Lemma
4.5 already allows us to work in TK1 , and we consider the rank 1 isotropic lattice I, the
associated 0-dimensional boundary component Ξ of D BB , the lattice K from (3.7), and the
cone C. We take a cone σ ∈ Σ(Ξ) that does not come from Σ(Υ) for any 1-dimensional
cusp Ξ ≤ Υ, i.e., such that O(σ) ⊆ DΞ maps to Ξ ∈ D BB , and we denote the primitive
elements of K that span σ as a cone by ωj with 1 ≤ j ≤ d.
Some of the ray generators ωj of σ lie in C, while some others can be of the form ωJ,I
for some primitive isotropic rank 2 lattice I ⊆ J ⊆ IL⊥ . We order the indices such that
there is some 0 ≤ e ≤ d such that ωj is ωJj ,I for such a lattice Jj when 1 ≤ j ≤ d, while if
e + 1 ≤ j ≤ d then ωj is a primitive element of K ∩ C. We take some small 0 < ε < 1, we
consider the open trimmed cone

X
d
d
X
ε
bj > ε ,
σ =
bj ωj ∈ σ bj > 0 for every 1 ≤ j ≤ d and
j=1

j=1

34

JAN H. BRUINIER AND SHAUL ZEMEL

and we decompose
(4.8)

ε

σ =

e
[

σkε

k=1

∪

σ0ε

=

d
e X
[

k=1

j=1

bj ωj ∈ σ

ε

X
j6=k

bj < εbk



h
i
S
ε/2
∪ σ ε \ ek=1 σk

as the union of sets that are open in σ, where our condition that ε < 1 implies that the only
non-trivial intersections can be between σkε with k ≥ 1 and σ0ε . Note that our assumption
on σ precisely excludes the case where d = e = 1, so that σ0ε 6= ∅, and it is clear that when
σ ⊆ C ∪ {0}, i.e., when e = 0, the set σ0ε is just the full trimmed cone σ ε .
Let κ be a subspace of KR of dimension dim σ that is defined over Q such that the
pairing between κ and Rσ is non-degenerate. It will be notationally convenient to assume
that κ contains vectors of negative norm, and therefore its orthogonal complement κ⊥ is
positive definite (or trivial if dim σ = n). This yields decompositions
⊥
⊥
KR = κ⊥ ⊕ Rσ, KC = κ⊥
C ⊕ Cσ, and TK (C) = KC /K = [κC /(κ ∩ K)] ⊕ [Cσ/(σ ∩ K)],

where allowing the real parts to be affine yields decompositions also for KC1 and the affine
model TK1 (C) from (3.12). For an element Z + K ∈ TK (C) we denote the projections onto
the parts from these decompositions as Zκ⊥ and Zσ , so that the imaginary part Y ∈ KR
is Yκ⊥ + Yσ accordingly, and similarly for the affine variable ZL + K ∈ TK1 (C). Note that
while at this point is seems natural to take κ = Rσ, which makes these decompositions
orthogonal, see the proof of Corollary 4.9 below for the reason why we allow a more
general space κ here and decompositions that are not orthogonal. The additional boundary
components O(τ ) of the open subset XK,σ of XK,Σ(Ξ) , where {0} =
6 τ ∈ Σ(Ξ) is a face of σ,
are obtained by considering points Z +K in which the coordinates of Yσ that are associated
with τ are infinite, and the corresponding coordinates of ℜZσ disappear.
Now, adding to σ boundary points in which some of the coefficients of the generators
ωj may attain the value +∞ yields a compact set, which we denote by σ̄. Thus extending
the range of Yσ to σ̄ makes it defined on all of XK,σ . For small ε > 0 we write σ̄ ε for
σ ε ∪ (σ̄ \ σ), and for every 0 ≤ k ≤ e we denote by σ̄kε the relative interior of the closure of
the set σkε from (4.8) in σ̄ ε . Recall that the open subset DΞ of XK,Σ(Ξ) can be written as
in (3.16), and set

ε
DΞ,σ = DΞ ∩ XK,σ and DΞ,σ
= ZL + K ∈ DΞ,σ (ℑZL )σ ∈ σ̄ ε ,
ε
where the full orbit O(σ) is contained in DΞ,σ
. Recall that if {0} =
6 τ ≤ σ is not of the
form Ω(Υ) ∪ {0} for some Υ then O(τ ) ⊆ DΞ,σ , while if τ 6= σ then some points of O(τ )
ε
will not lie in DΞ,σ
. On the other hand, all the points in O(τ ) for such τ will be covered
ε
when we work in DΞ,τ
. The decomposition from (4.8) allows us to write

(4.9)

ε
DΞ,σ

=

e
[

k=0

ε,k
DΞ,σ

e
[

ε
=
ZL + K ∈ DΞ,σ
(ℑZL )σ ∈ σ̄kε .
k=0

ε
Recall that if Y is the imaginary part of an element of DΞ,σ
then Yσ ∈ C and hence Yσ2 < 0,
with |Yσ2 | being very small only when Yσ is close either to 0 or to R+ ωk for some 1 ≤ k ≤ e.
We can now prove the following result.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

35

Proposition 4.7. For every compact subset M of κ⊥ there exists
Pd some R > 0 such that
ε,0
the following holds: Write Y = ℑ(ZL ) for ZL + K ∈ DΞ,σ as j=1 bj ωj + Yκ⊥ with bj ≥ 0
P
for 1 ≤ j ≤ d and dj=1 bj > ε. Then when Yκ⊥ ∈ M and bj > R for some 1 ≤ j ≤ d, the
function ΦLm,µ (ZL + K) equals


Yσ
|Yσ | K
2
2
√ Φm,pK µ
(4.10)
− b+
m,µ (0, 0) log |Yσ | − 2 log |φ|
|Y
|
2
σ
plus a smooth remainder, where φ is a holomorphic function defining the divisor Z(m, µ).
Proof. The element Y = ℑZL ∈ C satisfies

(4.11)

|Y 2 | = −Y 2 = −(Yσ + Yκ⊥ )2 = |Yσ2 | − 2(Yσ , Yκ⊥ ) − Yκ2⊥ .

Since the quadratic form Yσ2 is bounded away from 0 on σ0ε , we deduce that |Yσ2 | is comparable on σ0ε with any positive definite quadratic form Q on σ, in the sense that there
exist constants 0 < c− < c+ such that c− Q(Yσ ) ≤ |Yσ2 | ≤ c+ Q(Yσ ) for every Yσ in this set.
Recalling that Yκ⊥ is confined to the compact set M, we deduce that the first summand
in (4.11) grows quadratically with each bj , while the second summand is linear in these
parameters with bounded coefficients, and the third one is bounded. It follows that when
at least one of the parameters bj , 1 ≤ j ≤ d is large enough, the inequality |Y 2 | > 2m
is satisfied, and we can evaluate ΦLm,µ (ZL + K), via Lemma 4.5, as the expression from
Proposition 4.4, where W is an appropriate Weyl chamber. Applying the logarithm to
(4.11) produces


Yκ2⊥
2(Yσ , Yκ⊥ )
2
2
log |Y | = log |Yσ | + log 1 −
− 2 ,
|Yσ2 |
|Yσ |
2
yielding the term involving log |Yσ | and a function that is smooth on our domain of consideration by our analysis of the terms in (4.11).
Next, the expressions involving V1+ n2 in Proposition 4.4 are smooth on K\ Gr(L) and
ε,0
decay with each bj , and are thus smooth on all of DΞ,σ
, and even on the whole set DΞ,σ .
As for the penultimate term in that proposition, recall that if ν ∈ IL⊥∗ with ν 2 ≤ 0 then
the condition (ν + IR , W ) > 0 for any Weyl chamber in C is equivalent to ν + IR lying
in the closure of the cone −C, independently of W , and for these elements the imaginary
part of (ν, ZL ) grows linearly with every bj , 1 ≤ j ≤ d. It follows that all the summands in
that term are smooth on DΞ,σ as well. Comparing the remaining terms from Proposition
4.4 with the first asserted term in (4.10) and assuming that Y lies in the closure of a Weyl
chamber W shows that the parts of the remainder that we still have to investigate are




X

Y
|Y | K
|Yσ | K
Yσ
(4.12) √ Φm,pK µ
log 1 − e (ν, ZL ) .
− √ Φm,pK µ
−4
|Y |
|Yσ |
2
2
⊥
ν∈[IL∗ ∩(±µ+L)]/I
ν 2 =2m
(ν+IR ,W )>0

For investigating the difference between the first two terms in (4.12), we recall from [Br1]
that ΦK
m,pK µ is the restriction to norm −1 vectors of C of the sum of a smooth function
eK
and a continuous piecewise linear function. If we define the function Φ
m,pK µ to take Y ∈ C

36

JAN H. BRUINIER AND SHAUL ZEMEL



eK
, then Φ
m,pK µ is also a similar sum. Take now a Weyl chamber W that
e K,W be the smooth extension to C of the restriction
contains Yσ in its closure, and let Φ
m,pK µ
K
e K,W (Yσ ),
e
of Φm,pK µ to W . It follows that the second term in (4.12) can be written as √12 Φ
m,pK µ
which is independent of the choice of W by continuity, but it may be that different choices
of Y will land in other Weyl chambers. To take care of this we recall that Theorem 2.12
of [Br1], or equivalently Corollary 6.4 of [Bo1], shows that given
√ another Weyl chamber
K,W̃
K,W
e
e
W̃ , the function Φm,pK µ is obtained from Φm,pK µ by adding −8 2π times the sum of the
expressions (ν + IR , Y ) for

(4.13)
ν ∈ [IL⊥∗ ∩ (±µ + L)]/I ν 2 = 2m, (ν + IR , W ) < 0, (ν + IR , W̃ ) > 0 .
to |Y |ΦK
m,pK µ

Y
|Y |

Note the negative sign arising from our signature convention, and that the elements ν that
have to be inverted in the last term in (4.12) when Y moves from W to W̃ are also precisely
those lying in the set from (4.13).
Consider first the situation in which the Weyl chamber W̃ is separated from W by a
single element λ ∈ IL⊥∗ ∩ (µ + L) with λ2 = 2m, whose K ∗ -image pairs positively with W̃
and negatively with W . Then the set from (4.13) is {λ}, and the value of (4.12) on W̃ is
therefore the value on W plus


−8π(λ + I, Y ) − 4 log 1 − e (λ, ZL ) + 4 log 1 − e (−λ, ZL ) = 0.
Since every two Weyl chambers are separated by a finite number of walls, it follows that
e K,W
e K,W̃ (Y )
√1 Φ
if we replace the first term from (4.12), which reduces to √12 Φ
m,pK µ (Y ), by
2 m,pK µ

for some Weyl chamber W̃ , and the inequality that is imposed in the third term there is
(ν + IR , W̃ ) > 0, then the total expression is independent of W̃ .
We therefore choose W̃ to be the Weyl chamber W which we have used for the second
term. The difference of between the first two terms in the resulting form of (4.12) can then
be written as





|Yσ | e K,W
Yσ
Y
K,W
e
√ Φm,pK µ
− Φm,pK µ
,
|Yσ |
|Yσ |
2
e K,W
where now Φ
m,p µ is a smooth function. We can thus apply Taylor’s theorem, noting that
K

Y

the difference between the arguments is |Yκσ⊥| . As the set of norm −1 vectors inside the
closure of σ0ε in C is compact, and the point |YYσσ | around which we expand lies in that
ε,0
set, the coefficients of this expansion are smooth and bounded on all of DΞ,σ
. Combining
Y

the external coefficient with the denominator of the Taylor variable |Yκσ⊥| , we deduce that
this difference is indeed smooth on that set. The fact that every element of DΞ,σ can be
perpendicular to only finitely many ν ∈ [IL⊥∗ ∩ (±µ + L)]/I with ν 2 = 2m implies that
the sum in the third term of (4.12), in which the condition (ν + IR , W ) > 0 is imposed
ε,0
throughout our subset of DΞ,σ
, is indeed −2 times the logarithm of the square of the
absolute value of a holomorphic defining function for the divisor Z(m, µ) there. This
completes the proof of the proposition.


SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

37

The fact that the values from (4.12), and hence of ΦLm,µ , were seen in the proof of Proposition 4.7 to be independent of the choice of the Weyl chamber W , is in correspondence
with the singularities of this function being logarithmic along 1-codimensional complex
subvarieties, and not along 1-codimensional real submanifolds such as walls between Weyl
chambers. Recalling that if all the rays of σ are generated by elements of C then σ0ε = σ ε
ε,0
ε
in (4.8) and hence DΞ,σ
= DΞ,σ
in (4.9), Proposition 4.7 describes the behavior of ΦLm,µ in
ε
all of the vectors of DΞ,σ with large enough imaginary part, and in particular on all the
boundary points there. It therefore gives the complete description near the boundary in
case L has Witt rank 1. We also remark that when dim σ = n we have κ⊥ = 0 and Yσ = Y ,
and the expression with Y instead of Yσ throughout is also valid in Proposition 4.7, and
even with a shorter proof. However, Yσ grasps the important part of Y near the boundary
ε,0
of DΞ,σ
, and will be more convenient for our consequences below.
Assuming now that the Witt rank of L is 2, take a primitive isotropic lattice I ⊆ J ⊆ IL⊥
of rank 2 for our rank 1 primitive isotropic lattice I, with the associated 0-dimensional
cusp Ξ, 1-dimensional cusp Υ with Ξ ≤ Υ, and the lattice K from (3.7). Let ρ be the ray
Ω(Υ) ∪ {0} = R+ ωJ,I , considered as an external ray that lies in Σ(Ξ), and note that the
natural extension of (4.8) to the case where σ = ρ is with ρε1 = ρε and ρε0 = ∅. Consider
ρ 6= σ ∈ Σ(Ξ) with ρ ≤ σ, and let k ≥ 1 be the index such that ωk = ωJ,I . Recall that if
UZ (Υ) is the cyclic group associated with the 1-dimensional cusp Υ then in the coordinates
from (3.11) it corresponds to translations by J/I = ZωJ,I , and that the quotient of the set
DΥ by K/ZωJ,I is an open subset of DΞ,σ . We now turn to investigating ΦLm,µ on the set
ε,k
ε
DΥ
defined analogously to the one on the right hand side of (4.9), as well as on DΞ,σ
.
To do so we choose an oriented basis (z, w) for J such that I = Zz as always, and recall
that ωk = ωJ,I = −w + I in this case. Moreover, note that if ε is small enough then any
Weyl chamber W that has a non-trivial intersection with σkε for our σ and k must contain
ωk = ωJ,I in its closure, and this is clearly the case also when σ = ρ and σ1ε = ρε . We
take some 1-dimensional rational negative definite vector space κJ , that is therefore not
perpendicular to ωJ,I , where for our given σ, for which we already chose κ above in a way
that it contains negative norm vectors, we assume that κJ ⊆ κ. It follows that each vector
Y ∈ C can be written as tωJ,I + Yκ⊥J where Yκ⊥J lies in a positive definite subspace of KR ,
and since κJ ⊆ κ and hence κ⊥ ⊆ κ⊥
.
J we can also write Yσ as tωJ,I + Yσ,κ⊥
J
Proposition 4.8. Consider an element ZL + ZωJ,I ∈ DΥ , and express Y = ℑZL as
tωJ,I + Yκ⊥J . Then given a compact subset M ⊆ κ⊥
J , there is a number T > 0 such that
L
wherever Yκ⊥J ∈ M and t > T the value of Φm,µ (ZL + ZωJ,I ) is
(4.14)

2
+
tΦD
m,pD µ − bm,µ (0, 0) log t − 2 log |φ|

plus a smooth function. In addition, consider the cone σ with the space κ containing κJ .
Here a compact subset M ⊆ κ⊥ and the parameter ε determine a number T > 0 such
ε,k
that if ZL + K ∈ DΞ,σ
satisfies Yκ⊥ ∈ M and t > T then ΦLm,µ (ZL + K) can again be
described using (4.10), where the difference between the first terms there and that of (4.14)
is bounded by a constant multiple of εt and the difference between the second respective

38

JAN H. BRUINIER AND SHAUL ZEMEL

ε,k
terms is smooth in internal points of DΞ,σ
and grows like b+
m,µ (0, 0) log t towards non-trivial
boundary components there.

Proof. The isotropy of ωJ,I and its relation with w imply that our analog of (4.11) is
(4.15) |Y 2 | = −Y 2 = −2t(ωJ,I , Yκ⊥J ) − Yκ2⊥ = 2t(w, Yκ⊥J ) − Yκ2⊥ ,
J

J

and (w, Y ) = (w, Yκ⊥J ).

Since Yκ⊥J is taken from M, the two expressions (w, Yκ⊥J ) and Yκ2⊥ from (4.15) are bounded,
J
where the former is bounded away from 0 from below because (w, Y ) > 0 for every Y ∈ C.
It follows that when t is large enough, the inequality |Y 2 | > 2m is satisfied regardless of
Yκ⊥J , and we can use the expression from Proposition 4.4, recalling that the Weyl chamber
W in which we do the evaluation must contain ωJ,I = −w + I in its closure. Moreover,
since the expressions (w, Yκ⊥J )2 and Yκ2⊥ are positive definite quadratic forms on κ⊥
J , they
J
are comparable as described in the proof of Proposition 4.7. In addition, recall that if
σ = ρ then Yκ⊥J ∈ M and if σ 6= ρ then Yκ⊥ ∈ M and Yσ ∈ σkε , and in the latter case if we
P
write Yσ as dj=1 bj ωj then the coefficient bk is t plus a linear combination of the other bj s.
It follows that in the first case (w, Yκ⊥J ) is bounded, and in the second case it is the sum of
the bounded expression (w, Yκ⊥ ) and (w, Yσ,κ⊥J ), where the latter is positive and bounded
by some multiple of εt by the definition of σkε in (4.8).
Now, the logarithm of the expression from (4.15) is

Yκ2⊥ 
2
J
log |Y | = log t + log(w, Yκ⊥J ) + log 2 −
,
t(w, Yκ⊥J )
ε,k
where the second and third logarithms are smooth on DΥ . On the other hand, on DΞ,σ
we
2
can express |Yσ | like in (4.15) but with Yκ⊥J replaced by Yσ,κ⊥J , and as our second logarithm is
log(w, Yσ,κ⊥J ) plus a smooth function and both the third logarithm and its Yσ,κ⊥J -counterpart
are smooth, we indeed get the second term of (4.10) up to smooth functions. Since the
difference from the second term of (4.14) is log(w, Yσ,κ⊥J ) plus a smooth expression, and
ε,k
the argument of the logarithm is bounded by a multiple of εt for elements of DΞ,σ
, the
description of the difference of the second terms is established. The smoothness of the
terms with V1+ n2 throughout is proved like in Proposition 4.7, and our property of W
implies that (ν + IR , w) ≥ 0 for every vector ν that appears in Proposition 4.4. As ℑ(ν, ZL )
becomes now t(ν, ωJ,I ) + (ν, Yκ⊥J ) and our analysis implies that the second summand is
smaller than the first one, we see that all the summands in which (ν, ωJ,I ) > 0, which do
not depend on the choice of the Weyl chamber W , produce smooth and decaying functions
ε,k
on our domain in DΥ and on the one in DΞ,σ
. This covers all the elements in the third
term of that proposition, namely those arising from elements of IL⊥∗ with K ∗ -images in the
closure of −C, except ν ∈ JL∗ /I with JL∗ from (3.9) that project modulo IL∗ onto positive
multiples of w. But the latter summands produce products of constant coefficients of Fm,µ
and log 1 − e h(w, ZL ) for positive h ∈ Q with bounded denominators, which are also
ε,k
smooth functions of ZL + ZωJ,I ∈ DΥ as well as of ZL + K ∈ DΞ,σ
.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

39

The remaining summands, which correspond to ν ∈ JL⊥∗ /I, can be partitioned according
to their D ∗ -images, which are the finitely many elements of norm 2m in pD µ ∪ −pD µ ⊆ D ∗ .
Moreover, since each ν is already an I-coset, elements that lie in each class, e.g., the class
associated with β ∈ pD µ + D, differ by integral multiples of w. Assume, for the moment,
that ZL + ZωJ,I or ZL + K is not a boundary point, so that (w, ZL ) is τ = x+ iy as in (3.14)
and hence (w, Y ) = y > 0. Then the condition (ν + IR , W ) > 0 determines “one half” of
this class, which we write as νβ,W + Nw for the unique element νβ,W ∈ JL⊥∗ /I that satisfies
νβ,W + J/I = β as well
as 0 < (νβ,W , Y ) ≤ y and therefore (ν − w, Y ) ≤ 0. By writing

αβ,W = e (νβ,W , ZL ) and recalling that (νβ,W , w + I) = 0 we obtain an element of C that
depends on ZL but not on t and satisfies |q| ≤ |αβ,W | < 1, where the equality |αβ,W | = |q|
occurs P
if and only if (νβ,W − w, Y ) = 0. The contribution of the class associated with β is
l
thus 4 ∞
l=0 log |1 − αβ,W q |, which is independent of t since so are αβ,W and q. It is now
clear that ν−β,W is 2w − νβ,W when (νβ,W , Y ) = y and w − νβ,W otherwise, and therefore
q2
q
α−β,W equals αβ,W
in case |αβ,W | = |q| and αβ,W
when |αβ,W | > |q|, but as the set for which
q
throughout without affecting
|αβ,W | = q for some β has measure 0, we can write just αβ,W
our investigation.
Next, the linear growth of |Y 2 | from (4.15) with t while (w, Y ) = y is independent of
2
2
σ|
t implies that for large enough t we have |Y4m| > (w, Y )2 as well as |Y4m
> (w, Yσ )2 . We
can therefore use Proposition 4.6 for expressing the first term from Proposition 4.4, as well
as the asserted first term in (4.14). The smoothness and decay of the Bessel K-function
|Yσ |
|Y |
and (w,Y
from above to show that the last summand in
combine with the growth of (w,Y
)
σ)
ε,k
each of these expansions is also smooth on DΥ or on DΞ,σ
. The second term there is (w, Y )
times a constant, which is smooth on DΥ when σ = ρ and whose difference from the same
ε,k
constant times (w, Yσ ) is smooth on DΞ,σ
. Note that this part of the first term of (4.14) is

(w, Yσ,κ⊥J ) times a constant. As

ΦD
m,pD µ

is a constant, (4.15) and the boundedness of

Y 2⊥
κ
J

2(w,Yκ⊥ )
J

on M when σ = ρ implies that the first term in that proposition yields the first asserted
|Y 2 |
ε,k
term up to smooth functions. As for DΞ,σ
when σ 6= ρ, we have to compare 2(w,Y
with
)
|Yσ2 |
,
2(w,Yσ )

both of which we express via (4.15), and applying an equality like (4.11) evaluates
this difference as
"
#
2
2
Yσ,κ
Yσ,κ
Yκ2⊥
(w, Yσ,κ⊥J ) 2(Yσ,κ⊥J , Yκ⊥ ) + Yκ2⊥
⊥
⊥ (w, Yκ⊥ )
J
J
J
J
−
=
−
,
2(w, Yκ⊥J ) 2(w, Yσ,κ⊥J )
(w, Yκ⊥J )
2(w, Yσ,κ⊥J )
2(w, Yσ,κ⊥J )2
(w,Y

)

where the external multiplier is the inverse of 1− (w,Y κ⊥⊥ ) , the first summand is the quotient
σ,κ
J

of two linear forms on σR ∩ κ⊥
J , the second one is a quotient of two quadratic forms on
that space, and the coefficients come from the element Yκ⊥ of the compact set M. This
ε,k
difference is therefore smooth on our subset of DΞ,σ
, and note that the second term on the
left hand side is (w, Yσ,κ⊥J ) times the quotient of the two quadratic forms.

40

JAN H. BRUINIER AND SHAUL ZEMEL

Recalling that the set [JL⊥∗ ∩ (µ + L)]/J projects bijectively onto pD µ + D, it remains to
consider the expression
#
"


∞
∞
l+1
X
X
X
q
(β, Y )
.
−4
log |1−αβ,W q l |−4
log 1−
(4.16)
4π(w, Y )B2
(w,
Y
)
α
β,W
⊥
l=0
l=0
β∈[JL∗ ∩(µ+L)]/J
β 2 =2m

When 2µ = 0 in ∆L , so that pD µ and −pD µ is the same coset, the divisor Z(m, µ) contains
each λ⊥ with multiplicity 2, and therefore the sum in (4.16) describes the remaining terms
also in this case. Moreover, the set of lifts of the set of classes β ∈ pD µ + D with β 2 = 2m
is the product over these βs of the sets {νβ ∈ JL⊥∗ /I| νβ + J/I = β}, and sending a Weyl
chamber W containing ωJ,I in its closure to the element {νβ,W }β of the latter set produces
a bijective map. Hence if Y lies in the closure of some Weyl chamber W then we can
(νβ,W ,Y )
write the argument of B2 in (4.16) as 0 < (w,Y
< 1, and we can also substitute it
)
inside the corresponding Bernoulli polynomial B2 (x) = x2 − x + 16 . Consider now a wall
between two such Weyl chambers, say the one corresponding to some λ ∈ JL⊥∗ ∩ (µ + L)
with λ2 = 2m, and let W be the one in which (λ + IR , W ) < 0, while W̃ is the second
one, with (λ + IR , W̃ ) > 0. Then the vector νβ,W is the same on W and W̃ for every
β 6= λ + J and all the associated terms in (4.16) are smooth also near that wall, while we
(ν
)
W̃ ,Y )
have νλ+J,W̃ = λ+I and νλ+J,W = λ+w +I. It follows that if we denote λ+J,
= (λ+I,Y
(w,Y )
(w,Y )

by x and set α = e (λ + I, ZL ) then on W̃ the summand associated with β involves B2 (x)
and the parameter αλ+J,W̃ = α in the two sums over l, while on W we have an argument

)
=
x
+
1
in
B
as
well
as
α
=
e
(λ
+
w
+
I,
Z
)
= qα in the sums.
of (λ+w+I,Y
2
λ+J,W
L
(w,Y )
Therefore the summand associated with l on W in the first sum in (4.16) with β = λ + J
is the one associated with l + 1 on W̃ , while the summand corresponding to l in the second
sum on W̃ there is the one corresponding to l + 1 on W . Since the formula for B2 shows
that B2 (x + 1) = B2 (x) + 2x, we deduce that when we move from W to W̃ , the expression
from (4.16) collects an additional value of
−8π(w, Y ) ·

(λ + I, Y )
1
= −8π(λ + I, Y ) − 4 log |α|,
− 4 log |1 − α| + 4 log 1 −
(w, Y )
α

which vanishes by our value of α.
We may therefore make one choice of a Weyl chamber W , with the corresponding vector
νβ,W for each β, and what
 we proved shows that replacing B2 by B2 , (β, Y ) by (νβ,W , Y ),
and αβ,W by e (νβ,W , ZL ) in (4.16) would give us the correct value for Y , regardless of the
Weyl chamber near ωJ,I in which Y lies, and the same applies for the value arising from
Yσ . But for every such β we have νβ,W ∈ JL⊥∗ /I, so that we can replace Y by Yκ⊥J like with
w in (4.15) as well as Yσ by Yσ,κ⊥J , and we consider the difference between the expressions
with Y and with Yσ . Recalling the formula for B2 , this difference is
"
#
(w, Yσ,κ⊥J ) 2(νβ,W , Yσ,κ⊥J )(νβ,W , Yκ⊥ ) + (νβ,W , Yκ⊥ )2 (νβ,W , Yσ,κ⊥J )2 (w, Yκ⊥J )
−
(w, Yκ⊥J )
2(w, Yσ,κ⊥J )
2(w, Yσ,κ⊥J )2

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS
(w,Y

41

)

plus the linear form −(νβ,W , Yκ⊥ ) + 6κ⊥ evaluated on Yκ⊥ ∈ M which is smooth and
bounded as before. Moreover, as each argument of B2 in the expression with Yσ is the
quotient of two linear forms on linear forms on σR ∩ κ⊥
J with the denominator never vanishing, this argument is bounded and hence so is its value under B2 . As the remaining
part of the smooth form of (4.16) is precisely −2 times the logarithm of the square of the
ε,k
absolute value of a holomorphic function that defines Z(m, µ) on DΥ and on DΞ,σ
, this
proves the desired expression. We have also obtained that the difference between the first
terms of (4.10) and (4.14) is a bounded multiple of (w, Yσ,κ⊥J ) plus a smooth function, which
ε,k
establishes the bound on that difference on DΞ,σ
because the latter pairing is a bounded
multiple of εt on that space. This completes the proof of the proposition.

We would like to view the function ΦLm,µ in the setting of [BBK]. As this paper concerns
smooth varieties, we shall consider smooth toroidal compactifications. The fact that XL
itself may be not smooth can be dealt with by taking covers as in Remark 3.26. For
smoothness at the boundary, we take a refinement as in Remark 2.15, and the resulting
variety XLtor is then smooth up to finite quotient singularities from ΓL , with the toroidal
boundary being a divisor with normal crossings. In this case our main result about ΦLm,µ ,
namely Theorem 4.13 below, can also be described using terminology from [BBK]—see
Remark 4.14 below.
Indeed, there are some simplifications when a fan σ ∈ Σ(Ξ) is smooth in the sense of
Definition 2.3. As the vectors ωj , 1 ≤ j ≤ d generate over Z the primitive sublattice
K ∩ Rσ of K, we can take elements κi ∈ K ∗ with 1 ≤ i ≤ d such that (κi , ωj ) is the
Kronecker δ-symbol δij , and such that the space κ ⊆ KR that they span contains negative
norm vectors. Note that we cannot always take such a dual Z-basis inside Rσ, which is why
κ can be a different rational subspace of KR . We consider κ⊥ ⊆ KR and the projections as
before, and then in our decomposition of Z ∈ TK (C) as Zσ + Zκ⊥ we have
(4.17)

Zκ ⊥ ∈

⊥
[κ⊥
C /(κ

∩ K)] and Zσ =

d
X
j=1

cj ωj ∈ [Cσ/(σ ∩ K)]

with uniquely defined cj ∈ C/Z for 1 ≤ j ≤ d, and we write each such cj as aj + ibj with
aj ∈ R/Z and bj ∈ R. The smoothness condition is required for the vectors {ωj }dj=1 to
span [Cσ/(σ ∩ K)] with free coefficients from C/Z, without additional quotients. Similarly,
assume that I ⊆ J ⊆ IL⊥ with D from (3.9) and Υ as before, and take some basis (z, w)
for J with z ∈ I as well as a basis (ζ, υ) for some unimodular complement J˜ for J in K ∗
that is dual to (z, w). Then if σ contains the ray ρ = R+ ωJ,I = Ω(Υ) ∪ {0}, or when σ = ρ
and we work in DΥ , then the dual basis (ζ, υ) produces, as in [K3], the coordinates
Z 2 +(ζ+τ υ)2 
(4.18)
ZL = ζ + τ υ + Z0 − ηw + ητ − 0 2
z

for ZL ∈ P+ that lies in the image of the section associated with z, where τ ∈ H is the
coordinate from (3.14), Z0 = X0 + iY0 ∈ DC , and η = s + it ∈ C is another coordinate,
Y2
which satisfies t > 2y0 for ℑZL to be of negative norm (this also gives a more explicit,
though less canonical, description of Proposition 3.12). The cyclic group UZ (Υ) operates

42

JAN H. BRUINIER AND SHAUL ZEMEL

as translations of the real part of σ by integers, and we denote, following [K3], the resulting
coordinate e(η) on UZ (Υ)\ Gr(L) by q2 . Considering the imaginary part Y of Z or of ZL , if
P
Z is presented as in (4.17) then Yσ can be written uniquely as dj=1 bj ωj , while for ZL as in
(4.18) we can write Y as yυ + Y0 − tw, or equivalently yυ + Y0 + tωJ,I , with Y0 = ℑZ0 ∈ DR .
We recall from (2.1) that the function zκj on DΞ,σ ⊆ XK,σ is just e(cj ) for ZL as in (4.17),
and from Lemma 3.18 that q2 = e(η) is the local defining equation zνΥ for the complement
of UZ (Υ)\ Gr(L) in DΥ , and we deduce that
(4.19)

bj = ℑcj =

1
1
log
for 1 ≤ j ≤ d,
2π
|zκj |

and t = ℑη =

1
1
log
.
2π
|q2 |

We remark again that if ρ ≤ σ for σ 6= ρ, with ωJ,I = ωk for 1 ≤ k ≤ d, then the two
descriptions from (4.19) are related via the fact that t − bk is a linear combination of
{bj }j6=k , so that q2 = zνΥ is zκk times a toric function that is defined and does not vanish
on the boundary of DΥ .
We can now state and prove the relation to [BBK] in the smooth case.
Corollary 4.9. If XLtor is smooth then the function ΦLm,µ is pre-log along Z(m, µ) and
along the boundary divisor XLtor \ XL in the sense of Definition 1.5 of [BBK], and has a
component that is pre-log-log along the boundary.
Proof. Recalling that XLtor is covered by the images of the sets of the form DΞ,σ or DΥ ,
it suffices to consider the behavior of ΦLm,µ on these sets. We use the description from
P
Propositions 4.7 and 4.8, in which we substitute the expression for Yσ as dj=1 bj ωj into
(4.10), and apply (4.19) for the coordinates bj there as well as for the coordinate t in (4.14).
ε,0
Now, in the closure of DΞ,σ
the argument of ΦK
m,pK µ in (4.10) lies in a compact subset of C
and is thus bounded, and |Yσ | is the square root of
(4.20)

|Yσ2 |

=

−Yσ2

=−

d X
d
X
i=1

d X
d
X
(ωi , ωj )
1
1
(ωi , ωj )bi bj =
log
log
,
2
4π
|zκi |
|zκj |
j=1
i=1 j=1

with all the coefficients −(ωi , ωj ) being strictly positive. Noting that (4.20) reduces to
Pd
|ω1 |2
2 1
2 1
when
d
=
1
and
is
bounded
by
a
multiple
of
log
2
j=1 log |zκj | in general, and
4π
|zκ1 |
that the smoothness of σ implies that the zκj s are adapted to the boundary divisor of
XK,σ , this gives the log-growth from Definition 1.4 of [BBK] (with M = 1) of the first
term in (4.10) as well as the log-log-growth from Definition 1.2 of that reference (with
M = 2) of the second term there, and the third term clearly has the log-growth along
Z(m, µ) (again with M = 1). The fact that the second term satisfies the condition to
be pre-log-log from Definition 1.3 there is now clear, and recalling that by appropriately
normalizing the defining function φ of Z(m, µ) we can replace ΦK
m,pK µ by its smooth analog
K,W
Φm,pK µ associated with a Weyl chamber W in C, the conditions for pre-log in Definition
1.5 of that reference are seen to be satisfied by the first and third terms of that equation.
In addition, substituting the value of t from (4.19) into (4.14) immediately establishes
the required properties of ΦLm,µ along DΥ , and the bounds from Proposition 4.8 on the

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

43

ε,k
difference between (4.10) and (4.14) on DΞ,σ
combine with this value of t to establish the
desired properties also on this set. This completes the proof of the corollary.


In fact, the proof of Corollary 4.9 establishes the linear logarithmic growth of ΦLm,µ and
the log-log-growth of the corresponding term also when XLtor is not smooth, but expressing
this in coordinates becomes more complicated.
For the next important property of ΦLm,µ we shall need the following technical lemma.
Lemma 4.10. Take 1 ≤ d ∈ N, d < α ∈ R, and εj > 0 for every 1 ≤ j ≤ d. We then have
Q
Z ε1
Z εd
Z ε1
Z εd
log log dj=1 rj · dr
dr
···
< ∞ and
< ∞,
···
Qd
Qd
α Qd
α Qd
r
·
log
r
r
·
log
r
0
0
0
0
j
j
j
j
j=1
j=1
j=1
j=1
where dr is the standard Lebesgue measure on Rd .

Proof. The case d = 1 is verified by a simple evaluation of primitive functions. If d > 1
a change of variable involving replacing one variable by the product of all of them easily
transforms the integral to a combination of ones with d − 1 variables. A simple induction
thus yields the desired result.

We can now prove the following result, which holds also in the non-smooth setting.
ε,0
Proposition 4.11. If n ≥ 2 then ΦLm,µ is locally integrable on any set of the form DΞ,σ
.
ε,k
In case n ≥ 3 it is also locally integrable on each DΥ and on every DΞ,σ with k ≥ 1.

Proof. We recall from Section 4.1 of [Br1] that the invariant measure on Gr(L) presented as
in (3.11), as well as on its quotient modulo K, is a multiple of dXdY
. The local integrability
|Y 2 |n
L
of Φm,µ on the open subset K\ Gr(L) follows from the fact that there it is smooth up to
logarithmic singularities. In addition, since all the boundaries in question have measure 0,
the local integrability does not depend on the choice of the toroidal compactification, and
it therefore suffices to consider the case where each fan Σ(Ξ) is smooth as in Definition
2.3, where we can use the expressions from the proof of Corollary 4.9.
ε,0
Consider next a point in ξ ∈ DΞ,σ
for some non-trivial cone σ ∈ Σ(Ξ), which is therefore
not an external ray in C, and the argument preceding (4.8) shows that it suffices to consider
ξ ∈ O(σ). Our choice of the space κ as above allows us to take a neighborhood of ξ which
⊥
is the product of a neighborhood of the projection ξκ⊥ in κ⊥
C /(κ ∩ K) and a neighborhood
of ξσ in the completion of Cσ/(σ ∩ K), with both having compact closures in the respective
spaces. The smoothness of σ allows one to use the coordinates from (4.17), and the relation
between cj = aj + ibj and zκj , which is visible in (4.19), implies that each factor daj dbj
in dXdY becomes

1
4π 2

times

dzκj dzκj
.
−2i|zκj |2

The coordinates arising from ξκ⊥ can be expressed

similarly, thus giving a smooth bounded (2n − 2d)-form on our neighborhood, because the
ε,0
coordinates that do not come from σ do not vanish on DΞ,σ
. We can also assume that
the neighborhood of ξσ , on which all the zκj s vanish, is a product of balls, one for each
coordinate, and when we consider
jth multiplier in polar coordinates, we see that the
Qd the
drj dθj
1
2d-form daj dbj is (4π2 )d times j=1 rj , with 0 ≤ θj < 2π and 0 < rj < εj for every j. As

44

JAN H. BRUINIER AND SHAUL ZEMEL

for the denominator |Y 2 |n , the proof of Proposition 4.7 allows us to write it as |Yσ2 |n times
a function that is smooth and bounded on our neighborhood of ξ, and since (4.20) shows
that the latter expression is quadratic in log |zκ1 | = log r1j with 1 ≤ j ≤ d and positive
j
wherever each one of them is positive, it is comparable with any other quadratic form with
Pd
1 2
, in these expressions. Altogether, we have written
these properties, such as
j=1 log rj
Q
Q
dr
our invariant measure on neighborhoods of points in O(σ) as dj=1 rjj times log−2n dj=1 r1j
Q
on dj=1[0, εj ), times a smooth and bounded (2n − d)-form with no singularities.
We therefore need to establish the integrability of ΦLm,µ in this neighborhood with respect
to this measure, and we express it via (4.10). For the smooth part of this function, as well
as the term with log |φ|, it suffices to consider the integrability of the measure itself, which
now follows from the case of the first integral with α = 2n ≥ 2d > d in Lemma 4.10. The
integral of the second term of (4.10) is just the second integral in Lemma 4.10 with α = 2n,
eK
while in the first term, the fact that the argument of Φ
m,pK µ lies in a compact subset of C
ε,0
when ZL ∈ DΞ,σ yields the boundedness of that multiplier. Since the multiplier |Yσ | simply
replaces the power 2n in the denominator by 2n − 1, and we have 2n − 1 ≥ d + n − 1 > d
because n ≥ 2, Lemma 4.10 establishes the integrability of this term as well. This proves
the first assertion.
ε,k
For the second one we take a boundary point ξ of either DΥ or DΞ,σ
for a cone σ ∈ Σ(Ξ)
with ρ = R+ ωJ,I = Ω(Υ) ∪ {0} ≤ σ and σ 6= ρ, where in the latter case we can again
assume that ξ ∈ O(σ). Recalling the coordinate η = s + it from (4.18), the same argument
shows that on a similar product neighborhood, the part dXdY of the invariant measure
Q
dr
is again dj=1 rjj times a smooth (2n − d)-form with no singularities, where r = rk = |q2 |
and the other rj s come from the other rays of σ in case σ 6= ρ. We now express |Y 2 |
as in (4.15), and the proof of Proposition 4.8 shows that if σ = ρ then it is a smooth
and bounded function times log 1r while when σ 6= ρ it can be written as a smooth and
bounded function times t(w, Yσ,κ⊥J ). As the second multiplier is a linear form with positive
P
coefficients in log r1j with j 6= k, it is a smooth function times the linear form j6=k log r1j ,
Q
dr
and our invariant measure here is the product of log−n 1r · drr on [0, ε) for ε = εk , of dj=1 rjj
Q
Q
times log−n j6=k r1j on j6=k [0, εj ) when σ 6= ρ, and of a smooth, bounded, non-singular
(2n − d)-form.
For the function ΦLm,µ we now use the expression from (4.14), and recall from Proposition
4.8 that while when σ 6= ρ we still need to use (4.10), the difference is bounded by a constant
times t and can thus be considered like the first term in (4.14). Since the only parameter
appearing in (4.14) is t, or equivalently log 1r via (4.19), the integrability of the (d −1)-form
arising from rj with j 6= k follows from Lemma 4.10 because n ≥ d and the dimension here
is d − 1. The integrability of the smooth part of ΦLm,µ and of log |φ|, follow from the case
d = 1 and α = n ≥ 2 in the first integral in Lemma 4.10, and that of the second term from
the second integral with d = 1 and α = n there. As for the first term we obtain the first
integral with d = 1 and α = n − 1, and that lemma is again applicable since we assume
that n ≥ 3, the second assertion is also established. This proves the proposition.


SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

45

Note that Proposition 4.7 becomes simpler when d = 1. Then σ ∈ Σ(Ξ) is the ray
ρ = R+ ω with ω primitive in K ∩ C, the boundary points lie in O(ρ) ⊆ XK,ρ, and if
κ ∈ K ∗ satisfies (κ, ω) = 1 then Proposition 2.5 implies that the function zκ is the defining
equation for O(ρ) in XK,ρ. Then the vector Yσ appearing in (4.10) is just bω with b = b1 ,
ε,0
so that |Yσ | = b|ω|, and it is clear that DΞ,ρ
= DΞ,ρ because ρ has no faces that are rays
lying on the boundary of C. This reduces (4.10) to
 
ω
b|ω| K
2
√ Φm,pK µ
(4.21)
− 2b+
m,µ (0, 0) log b − 2 log |φ|
|ω|
2

up to an additive constant, and we also recall that O(σ) and the subset O(Υ) ⊆ DΥ from
Lemma 3.18 map onto the generic part of the divisors BI,ω and BJ from (3.18) respectively.
Combining these observations with (4.19), we make the following definition.

Definition 4.12. For a rank 1 primitive isotropic sublattice I of L, with the associated
lattice K from (3.7) and cone C as in (3.11), and a primitive element ω ∈ K ∩ C, we define
the multiplicity
 
|ω| K
ω
multI,ω (m, µ) = √ Φm,pK µ
.
|ω|
8 2π
Given a rank 2 primitive isotropic sublattice J in L, set D to be as in (3.9), and we set
1 D
multJ (m, µ) =
Φ
.
8π m,pD µ
In fact, Proposition 4.15 below will show that the multiplicities multJ (m, µ) from Definition 4.12 are always rational numbers. On the other hand, the multiplicities multI,ω (m, µ)
are real numbers, about the rationality of which we have no information in general.
tor
Consider again the variety XLtor = X{Σ(Ξ)}
from Theorem 3.25, which is defined by a
Ξ
collection of fans {Σ(Ξ)}Ξ that satisfies the admissibility conditions from Corollary 3.21
and Lemma 3.24 with respect to ΓL . Using Definition 4.12, the required extension of
Theorem 4.3 can now be established.
2

Theorem 4.13. For every pair (m, µ) with µ ∈ ∆L and 0 < m ∈ µ2 + Z we define, as in
(1.1), the divisor Z tor (m, µ) ∈ Div(XLtor ) ⊗ R by
X X
X
multI,ω (m, µ) · BI,ω .
multJ (m, µ) · BJ +
Z tor (m, µ) = Z(m, µ) +
J⊆L
µ⊥JL∗ /J

I⊆L R+ ω
µ⊥IL∗ /I

Here J (resp. I) runs over a set of representatives of rank 2 (resp. rank 1) primitive
isotropic sublattices of L modulo ΓL and given I, the index R+ ω runs over representatives
for the inner rays in Σ(Ξ) with Ξ = ΞI , and the coefficients multJ (m, µ) and multI,ω (m, µ)
are the ones from Definition 4.12. Assuming that n is larger than the Witt rank of L,
the function 12 ΦLm,µ is integrable on XLtor , grows logarithmically along the divisor Z tor (m, µ)
with a term with log-log-growth along the boundary, and satisfies the ddc -equation (1.2).
Proof. First, as the invariant measure is smooth on XL and our function has only the
logarithmic singularities along Z(m, µ), it is locally integrable on XL , which also covers

46

JAN H. BRUINIER AND SHAUL ZEMEL

the case where L has Witt rank 0 since then there is no boundary. For the local integrability
at boundary points, we recall that for each such point one of the maps ιΞ and ιΥ appearing
in (3.18) is local homeomorphism, so that it suffices to consider local integrability on the
sets DΞ,σ or DΥ . Now, if L has Witt rank 1 then there are no rays of the form R+ ωJ,I ,
ε,0
so that DΞ,σ
= DΞ,σ for every σ ∈ σ(Ξ), and as the boundary of XLtor is then covered by
such sets, the assumption that n ≥ 2 yields the desired local integrability by Proposition
4.11. On the other hand, when L has Witt rank 2 then n ≥ 3, and we also have local
integrability on the remaining covering sets DΥ by the same proposition. This proves the
local integrability of 21 ΦLm,µ on XLtor , and the global one follows from compactness.
Now, the assertion about the growth of 12 ΦLm,µ was established in Corollary 4.9, and the
integrability just proved allows us to substitute 12 ΦLm,µ inside current equations. Moreover,
the fact that the logarithmic growth is linear, namely we had M = 1 in the proof of
Corollary 4.9 in the notation of Definition 1.4 of [BBK], implies that it satisfies the desired
ddc -equation from (1.2) for some divisor on XLtor . Since the required properties of η(m, µ)
are also clear, all that remains it to determine this divisor to be Z tor (m, µ).
Consider first a divisor of the form BI,ω for some primitive vector ω ∈ K ∩ C, which
exists only if n ≥ 2 in our assumption, and for which we denote ρ = R+ ω ∈ Σ(Ξ). Then
the case d = 1 of Proposition 4.7 discussed above evaluates ΦLm,µ on DΞ,ρ as (4.21) plus a
smooth function. Substituting (4.19), dividing by 2, and recalling the behavior of − log of
the square of the absolute value of a coordinate under ddc , establishes the equality
ddc [ 12 ΦLm,µ ] + δZI,ω (m,µ) = [ηI,ω (m, µ)]
as currents on Ac2n−2 (DΞ,ρ ), where ηI,ω (m, µ) is the sum of a smooth 2-form on DΞ,ρ and a
multiple of ddc log log |z1κ | , and
 
|ω| K
ω
(4.22)
ZI,ω (m, µ) = Z(m, µ) + √ Φm,pK µ
· O(ρ),
|ω|
8 2π

where O(ρ) is the pullback of BI,ω to DΞ,ρ ⊆ DΞ via ιΞ ◦ πΞ .
We now turn to the divisors BJ under the assumption that n ≥ 3, where Proposition
4.8 describes ΦLm,µ on DΥ via (4.14) up to a smooth function. We again substitute (4.19)
and divide by 2, and we recall from Proposition 3.19 that the divisor O(Υ) inside DΥ is
characterized by the vanishing of q2 . The same argument now produces the equality
ddc [ 21 ΦLm,µ ] + δZJ (m,µ) = [ηJ (m, µ)]

on Ac2n−2 (DΥ ), in which ηJ (m, µ) is the sum of a smooth 2-form on DΥ and a multiple of
ddc log log |q12 | , and
ΦD
m,pD µ
· O(Υ),
8π
with O(Υ) being the pullback of BJ to DΥ under ιΥ ◦ πΥ
Now, the union of XL and the generic parts of the toroidal divisors has a complement in
tor
XL whose complex codimension there is 2, and therefore the restriction map from divisors
on XLtor to divisors on this open subvariety is surjective. It follows that the divisor on XLtor

(4.23)

ZJ (m, µ) = Z(m, µ) +

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

47

which appears in the global ddc -equation for 12 ΦLm,µ has to have the pullback from (4.22) to
DΞ,R+ ω for every I and ω, as well as the pullback given in (4.23) to DΥ for every J. Since
Definition 4.12 implies that the only divisor having this property is Z tor (m, µ), we have also
established (1.2) with the correct divisor. This completes the proof of the theorem.

Note that in the case n = 1 in Theorem 4.13 the assumption about the Witt rank of L
implies that there are no cusps, but this case is therefore covered in Theorem 4.3.
Remark 4.14. When XLtor is smooth, the result of Theorem 4.13 means that 12 ΦLm,µ is an
integrable logarithmic Green function for Z tor (m, µ) on XLtor with additional log-log-growth
along the boundary divisor in the sense of Definition 1.12 of [BBK].
4.4. Explicit Formulas for the Multiplicities. The multiplicities multJ (m, µ) and
multI,ω (m, µ) are given in Definition 4.12 as regularized theta lifts. However, it can be
useful to have more explicit expressions for the values of these multiplicities.
We begin by assuming that n ≥ 2 and considering the divisor BJ that is associated
via (3.18) with the rank 2 isotropic sublattice J of L, where D is the positive definite
lattice from (3.9) as usual. Note that ΓL preserves the condition µ ∈ JL⊥∗ /JL⊥ ⊆ ∆L (by
definition) and the isomorphism class of D, so that the expressions below are independent
of the choice of the lattice J that represents BJ . Specializing (4.5) to the definite lattice
D, and recalling the operator ↑LD from above, we obtain
(4.24)
X 2
X
2
ΘD (τ ) =
q β /2 eβ+D ∈ M n2 −1 (ρD ) and ↑LD (ΘD )(τ ) =
q β /2 eβ+L ∈ M n2 −1 (ρL ).
β∈D ∗

We set σ1 (n) =

P

⊥ /J
β∈JL
∗

d|n

d for 1 ≤ n ∈ N, denote by
E2∗ (τ )

∞
X
3
3
= E2 (τ ) −
= 1 − 24
σ1 (n)q n −
πy
πy
n=1

the nearly holomorphic Eisenstein series of weight 2 (with E2 being the weight 2 holomorphic quasi-modular Eisenstein series), and introduce the notation CT(G) for the constant
term of a Laurent series G in the variable q. Recalling that the arrow operators commute
with differential operators and are dual with respect to the pairings via
X
X
bδ eδ ,
aα eα and b =
(4.25)
ha, ↓LD biD = h↑LD a, biL
for
a=
α∈∆D

δ∈∆L

and observing that when n = 2 and L has Witt rank 2 the lattice D is trivial and ΘD
from (4.24) is just the constant function 1, Theorem 4.4.1 of [BHY] evaluates the theta lift
ΦD
m,pD µ as follows.
Proposition 4.15. The number ΦD
6 JL⊥∗ /JL⊥ , and if µ ∈ JL⊥∗ /JL⊥
m,pD µ vanishes when µ ∈
then we have



 8π CT q d ↑L (Θ ), F +
n≥3
D
m,µ L
n−2
dq D
ΦD

m,pD µ =
 π CT E h↑L (1), F + i
n = 2.
2 D
m,µ L
3

48

JAN H. BRUINIER AND SHAUL ZEMEL

We remark that the value of ΦD
m,pD µ for n ≥ 3 in Proposition 4.15 also equals, by
modifying the proof of Theorem 9.2 of [Bo1] as in Proposition 4.19 below, to the expression
 π

π
+
CT E2 · h↑LD (ΘD ), Fm,µ
iL − E2∗ ↑LD (ΘD ), ξ1− n2 Fm,µ Pet ,
(4.26)
3
3
where the latter pairing is the Petersson inner product of the nearly holomorphic modular
form E2∗ ↑LD (ΘD ) and the cusp form ξ1− n2 Fm,µ , both of weight 1 + n2 and representation
ρL . This gives back the expression for n = 2 in Proposition 4.15, since as in the proof of
Theorem 4.4.1 of [BHY], the Petersson inner product there vanishes when ΘD reduces to
d
a constant. In addition, since q dq
↑LD (ΘD ) is holomorphic in q with integral coefficients
1
ΦD
and without a constant term, the value of the multiplicity multJ (m, µ) = 8π
m,pD µ from
L
Definition 4.12, with n ≥ 3, is rational. More explicitly, the symmetry of ↑D (ΘD ) and the
+
simple principal part of Fm,µ
reduce its value to
2m
{β ∈ pD µ| β 2 = 2m} .
n−2
This is not necessarily true for n = 2, where the latter expression vanishes by the triviality
of D, since when L has Witt rank 2 multiples of ↑LD (1) are ρL -invariant vectors by which
+
modifying Fm,µ
can affect the value from Proposition 4.15.

ω
We now turn to the evaluation of ΦK
m,pK µ |ω| for a primitive vector ω ∈ K ∩C, for which
ω 2 = −2Nω as usual, and we write N for Nω for short. Recall that this expression is a
theta lift like in (4.6), where the theta function ΘK is defined as in (4.5) with the negative
definite subspace of KR that is spanned by ω. Denote the orthogonal complement of ω in
⊥
K by ωK
and in KR by just ω ⊥ , and define the ρK ⊗ ρN -valued function
 λ2 
X
X
(4.27)
ΘK,ω (τ ) =
e τ ω2⊥ eλ+K ⊗ er .
r∈Z/2N Z

λ∈K ∗ /Zω
(λ,ω)≡−r (mod 2N )

Let ΛN be the 1-dimensional lattice spanned by a vector of norm 2N, so that its discriminant ∆N = ∆ΛN is cyclic of order 2N, and we denote by ρN the Weil representation ρΛN
and by ΘN the theta function ΘΛN ∈ M 1 (ρN ), which is defined by
2

∞
X 2
X  X
l /4N
l2 /2N
er .
q
el+2N Z =
q
(4.28)
ΘΛN (τ ) =
l=−∞

r∈Z/2N Z

l≡r

(4N )

If ΘN is the complex conjugate of the function from (4.28), and h·, ·iN is the pairing
associated with the lattice ΛN , then we obtain the following decomposition.
Lemma 4.16. We have the equality
 √
ω
ΘK τ, |ω|
= y ΘK,ω (τ ), ΘN (τ )

N

.

Proof. We partition the elements λ ∈ K ∗ in the sum from (4.5) according to their pairing
with ω ∈ K, and observe that if an element λ ∈ K ∗ satisfies (λ, ω) = −l then the projection
l2
lω
and hence λ2Rω = − 4N
. Note that if two elements of K ∗ lie in the same coset of
λRω is 2N

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

49

⊥
∆K and have the same pairing with ω then their difference lies in ωK
, and that for every
α ∈ ∆K and two integers h and l we have


λ ∈ K + α (λ, ω) = −l + hω = λ ∈ K + α (λ, ω) = −l − 2hN .

Moreover, since hω ∈ K ∩ Rω this operation of adding hω does not affect the respective

λ2
ω
expression ω2⊥ . Substituting this into the definition of ΘK τ, |ω|
in the equivalent of (4.5),
we find that
 λ2 
X
X
 √ X

ω
l2
ΘK τ, |ω| = y
e − 4N τ
e τ ω2⊥ eλ+K ,
r∈Z/2N Z l∈r+2N Z

λ∈K ∗ /Zω
(λ,ω)≡−r (mod 2N )

which is easily seen to be the desired expression. This proves the lemma.



It is good to know that the theta function from (4.27) also has the appropriate modularity
property.
Lemma 4.17. The function ΘK,ω from (4.27) is modular of weight
ρK ⊗ ρN with respect to the full group Mp2 (Z).

n−1
2

and representation

We omit the details of the proof of Lemma 4.17, and just remark that if K factors as
⊕ Zω then a rather straightforward decomposition yields the desired result, and in
general we have to use an operator like ↑K
⊥ ⊕Zω , tensored with ΛN .
ωK

ω
are evaluated, in a slightly different context, in TheoExpressions like ΦK
m,pK µ |ω|
rem 10.6
of [Bo1], which uses the incorrect Lemma 9.5 of that reference. Explicit pre-images
√
N
of − 8π ΘN under the operator ξ3/2 are constructed in Theorem 4.3 of [BS] as follows.
⊥
ωK

Theorem 4.18. For every natural N there√ exists a harmonic Maass form GN of weight
3
and representation ρN , with ξ3/2 GN = − 8πN ΘN , and such that its holomorphic part G+
N
2
has rational Fourier coefficients with bounded denominators.
!
It is clear that GN is unique only up to adding elements of M3/2
(ρN ) with rational Fourier
coefficients, but
 our results below will be independent of the choice of GN . The evaluation
ω
of ΦK
m,pK µ |ω| can now be carried out as follows.

ω
Proposition 4.19. The value of ΦK
m,pK µ |ω| is


reg
8π
8π
+
N
N
n
− √ CT h↑L⊕Λ
↑L⊕Λ
K⊕ΛN (ΘK,ω ), GN iN , Fm,µ L + √
K⊕ΛN (ΘK,ω ), GN N , ξ1− 2 Fm,µ Pet ,
N
N
where the second term is the regularized Petersson inner product of these modular forms.

Proof. We follow the proof of Theorem
 10.6 of [Bo1]. As in (4.6), we need the regularized
integral of ΘK (τ, Rω), ↓LK Fm,µ (τ ) K dµ(τ ), and Lemma 4.16 presents this theta function
√
as y times the pairing ΘK,ω (τ ), ΘN (τ ) N of the holomorphic theta function ΘK,ω and
the anti-holomorphic theta function ΘN . Via (4.25) we can express this measure as
D
E


N
↑LK hΘK,ω (τ ), ΘN (τ )iN , Fm,µ (τ ) L =
Θ
(τ
)
,
Θ
(τ
)
↑L⊕Λ
,
F
(τ
)
K,ω
N
m,µ
K⊕ΛN
N
L

50

JAN H. BRUINIER AND SHAUL ZEMEL

times y −3/2 dxdy. Theorem 4.18 allows us to write the non-holomorphic multiplier ΘN y −3/2
√ ∂τ GN , and if we assume for the moment that Fm,µ is holomorphic on H then the
as 16πi
N
differential 2-form that we have in the integrand is the exact Mp2 (Z)-invariant form


E

8π D L⊕ΛN
↑K⊕ΛN ΘK,ω (τ ) , GN (τ ) N , Fm,µ (τ ) dτ .
(4.29)
d √
L
N
Now, the integral from (4.6) can be carried out over the fundamental domain

F = τ = x + iy ∈ H |x| ≤ 21 , |τ | ≥ 1

of Mp2 (Z), and in the regularization of this divergent integral, we evaluate the integral on
FR = {τ ∈ F | y ≤ R} for large R, and take the limit R → ∞. We can thus apply Stokes’
Theorem for the integral over FR , and the Mp2 (Z)-invariance of the 1-form appearing as
the argument of d on the right hand side of (4.29) implies that on the integrals on the
boundary parts of FR that are
 also part of the boundary of F cancel. All that remains
1 1
is the integral along − 2 , 2 + iR oriented negatively, which produces the constant term
of the Fourier expansion of the differential form in question, at y = R. The part arising
−
l
from G+
N yields the first asserted term, and since the Fourier coefficients of GN multiply q
for negative l by decreasing functions of y, the contribution from this part vanishes at the
limit R → ∞.
However, as Fm,µ is not holomorphic, the formula from (4.29) has to be corrected by
subtracting the 2-form
E

16πi D L⊕ΛN
√
↑K⊕ΛN ΘK,ω (τ ) , GN (τ ) N , ∂τ Fm,µ (τ ) dxdy,
L
N
and the relation between ξ1− n2 and ∂τ allows us to write
i n
∂τ Fm,µ = y 2 −1 ξ1− n2 Fm,µ .
2
Hence the additional term yields the asserted regularized Petersson inner product. This
completes the proof of the proposition.

5. Modularity of Heegner divisors

Here we consider some basic parts from the theory of Borcherds products, and show how
to modify them in order to prove our main result, Theorem 5.4, which is the modularity
of the appropriately modified divisors from Theorem 4.13 in the Chow group of XLtor .
Consider again the Grassmannian Gr(L) that is associated via (3.1) to the even lattice
L. Recall that the map from (3.3) describes the chosen component P + of the set P from
(3.2) as a C× -bundle over Gr(L), and we define an automorphic form of weight m on Gr(L)
with respect to ΓL to be a function from P + to C that is ΓL -invariant and homogenous of
degree −m. Given an oriented sublattice I of rank 1 in L, one can identify Gr(L) with
the affine tube domain KR1 + iC from (3.11), and choosing a complement for IL⊥∗ in L∗
maps this affine tube domain onto the linear one KR + iC ⊆ KC . Combining these maps
with the section from Gr(L) to P + , one identifies an automorphic form of weight m on
Gr(L) with a function on KR + iC ⊆ KC which transforms under ΓL with the mth power

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

51

of an appropriate factor of automorphy. In any case, we are interested here only in such
automorphic forms that are meromorphic.
An important class of meromorphic automorphic forms on XL is given by Borcherds
products, see Theorem 13.3 of [Bo1]. The result is as follows.
!
Theorem 5.1. Let F ∈ M1−n/2
(ρL ) be given, with a Fourier expansion as in the holomorphic part of (4.3), and assume that c+ (δ, l) ∈ Z if l < 0. Then there exists a meromorphic
automorphic form Ψ on Gr(L) of weight c+ (0, 0)/2 and some multiplier system χ of finite
order with respect to ΓL , whose divisor of XL is given by
X
1 X
divXL (Ψ) =
c+ (µ, −m)Z(m, µ).
2 µ∈∆
2
L

0<m∈µ /2+Z

The proof of Theorem 5.1 is based on the fact that the theta lift of F , given in (4.6) with
Fm,µ replaced by F , is, up to an additive constant, 2 times the logarithm of the Petersson
metric of a meromorphic function Ψ on Gr(L) with the asserted divisor, which is then
shown to be automorphic. By the theory of Baily–Borel, the power of Ψ for which the
multiplier system χ becomes trivial is defined on the Baily–Borel compactification XLBB ,
and hence its pullback is defined also on XLtor . We can thus determine its divisor on XLtor .
Theorem 5.2. Assume that n ≥ 3 or that n = 2 and C[∆L ] contains no ρL -invariant
!
vectors, take F ∈ M1−
n (ρL ) that satisfies the condition of Theorem 5.1, and let Ψ be the
2
associated Borcherds product. If the character χ of Ψ is trivial, then the divisor of Ψ on
XLtor is given by
X
1 X
c+ (µ, −m)Z tor (m, µ).
divXLtor (Ψ) =
2 µ∈∆
2
L

0<m∈µ /2+Z

The difference between this divisor and the closure of divXL (Ψ) from Theorem 5.1 is


XX

1 X
+
N
CT E2 · h↑LD (ΘD ), F iL · BJ −
CT h↑L⊕Λ
· BI,ω ,
(Θ
),
G
i
,
F
K,ω
K⊕ΛN
N N
L
24 J
I R ω
+

where J, D, I, K, ω, and N are as in Theorem 4.13, and the coefficients are rational.

Proof. Recalling that our assumptions on n and ρL imply that the harmonic Maass form
of weight 1 − n2 and representation ρL with a given principal part is unique, we deduce that
if F ∈ H1− n2 (ρL ) has the Fourier expansion (4.3) and n ≥ 3 then
X
1 X
(5.1)
F =
c+ (µ, −m)Fm,µ .
2 µ∈∆
2
L

0<m∈ µ2 +Z

The linearity of the regularized theta integral (4.6) thus implies that the Petersson metric
of Ψ is given by
X
1 X
c+ (µ, −m)ΦLm,µ .
− log kΨk2 =
2 µ∈∆
2
L

0<m∈ µ2 +Z

52

JAN H. BRUINIER AND SHAUL ZEMEL

Consequently, the divisor of F on XLtor is given by the corresponding linear combination of
the divisors Z tor (m, µ) of the Green functions. Hence the assertion about the divisor of Ψ
follows from Theorem 4.13.
The difference between the divisors on XLtor and on XL is the sum of the parts of the divisors Z tor (m, µ) that are supported on the boundary divisors. The multiplicity of each such
boundary divisor is the linear combination of the corresponding multiplicities multJ (m, µ)
or multI,ω (m, µ) from Definition 4.12, according to the coefficients from (5.1). But the
formulas for these multiplicities, given in (4.26) and in Proposition 4.19 respectively, are
linear in F , and we can thus just substitute F instead of Fm,µ there. But since F is weakly
holomorphic, we have F + = F and the terms involving ξ1− n2 F vanish, and we remain
with the asserted multiplicities. Finally, as the principal part of F determines F and has
rational Fourier coefficients, it is therefore invariant under Aut(C/Q), and therefore so is
F itself and all of its coefficients are rational (see [McG]). Since Theorem 4.18 provides the
same property for GN , and it is clear that E2 and the theta functions share this property, it
follows that the asserted multiplicities are rational as desired. This proves the theorem. 
When n ≥ 3 we could have
also written the multiplicity of BJ in Theorem 5.2 as

d
L
CT q dq ↑D (ΘD ), F L . We remark that the multiplicity of BI,ω does not depend
on the choice of the function GN from Theorem 4.18, since this function pairs with the
weakly holomorphic modular form hΘK,ω , ↓LK (F )iK of weight 12 , and Proposition 3.5 of
[BFu] shows that this constant term can be evaluated only using ξ3/2 GN . We also remark
that a bit of additional analysis shows that the results of Theorem 5.2 hold also without
the assumption on ρL when n = 2, and even when n = 1, provided that F is taken to have
rational Fourier coefficients for the rationality of the multiplicities to remain valid.
Theorem 5.2 yields new proofs of some known results from the literature. First, for describing the behavior of Ψ near a 0-dimensional cusp Ξ = ΞI , we express the corresponding
lift Φ from (4.6) as in Proposition 4.4, where the parts involving the functions V1+ n2 vanish

and all the terms of the form log 1 − e (ν, ZL ) give the logarithm of the expansion of Ψ
as a Borcherds product. The first term ΦK , the theta lift of ↓LK (F ) with respect to the
lattice K, is a continuous piecewise
linear function of Y , which is given, in a Weyl chamber
√
W associated with F , by 8 2π times the pairing of Y with a vector ρ ∈ KQ that is called
the Weyl vector associated
with L, I, F , and W . Hence the product expansion of Ψ is

multiplied by e (Z, ρ) in the variable Z = X + iY in the linear tube domain KR + iC
as well as on the corresponding subset of the torus TK , and if ρ ∈ K ∗ then this function
is just the toric function zρ . The order of Ψ along BI,ω for primitive ω ∈ K ∩ C with
R+ ω ∈ Σ(Ξ) is thus the order of zρ , so that Proposition 2.5 reproduces the corrected result
of Theorem 10.6 of [Bo1]. Similarly, by considering the order of Ψ along BJ , Equation
(4.27) of [K3] shows that we have reproduced also the parts of Theorem 2.1 and Corollary
2.3 of that reference involving
P∞the power of l the coordinate q2 defining this divisor. We
also remark that combining l=0 log |1 − αq | from the proof of Proposition 4.8 with the
summands arising from Zw − ν yields, by the Jacobi triple product identity, the logarithm
of the absolute value of the quotients θ/η of the translated classical theta function over the
Dedekind eta function appearing in the expansions from [K3].
1
n−2

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

53

We now recall Borcherds’ modularity criterion, see Theorem 3.1 of [Bo2]. The rationality
statement appearing here is a consequence of the main result of [McG].
Proposition 5.3. Let a(µ, m) for µ ∈ ∆L and 0 ≤ m ∈
complex vector space Y , and let
X
X
a(µ, m) · q m eµ

µ2
2

+ Z be elements of some

µ∈∆L 0≤m∈ µ2 +Z
2

be the resulting formal ρL (T )-invariant power series with values in Y ⊗C C[∆L ]. Assume
that the coefficients a(µ, m) have the symmetry property that is required for this series to
be invariant under the action of the center of Mp2 (Z) with weight 2 − k and representation
ρL . Then this power series belongs to Y ⊗C M2−k (ρL ) if and only if its pairing
P with every
F ∈ Mk! (ρL ) vanishes, that is, denoting the Fourier expansion by F (τ ) = δ,l c(δ, l)q l eδ ,
we have the equality
X X
c(µ, −l)a(µ, l) = 0 ∈ Y.
µ∈∆L l∈ µ2 +Z
2

In addition, having these relations only for those elements F ∈ Mk! (ρL ) whose Fourier
coefficients are integral suffices for the series to be in Y ⊗C M2−k (ρL ).
Our second main result, Theorem 1.2 from the introduction, is now as follows.
Theorem 5.4. Assume that n is larger than the Witt rank of L, set Z tor (0, 0) to be any
divisor on XLtor that represents the line bundle of modular forms of weight −1/2, and write
[Z tor (m, µ)] for the image of Z tor (m, µ) in CH1 (XLtor ) ⊗ R for every pair (m, µ). Then the
formal power series
X X
[Z tor (m, µ)] · q m eµ
µ∈∆L m∈ µ2 +Z
2

is a modular form of weight 1+n/2 and representation ρL with coefficients in CH1 (XLtor )⊗R.
!
Proof. If F ∈ M1−
n (ρL ) has the Fourier expansion from (4.3), and if cµ (n) ∈ Z wherever
2
n < 0, then by Theorem 5.2 we get the identity
X X
cµ (−m)Z tor (m, µ) = 0
µ∈∆L m∈ µ2 +Z
2

in CH1 (XLtor ) ⊗ R. The result thus follows from Proposition 5.3 as in [Bo2], with the
rationality statement allowing one to omit the Galois action appearing in that reference.
This proves the theorem.

Remark 5.5. According to Theorem 4.13, the pairs (Z tor (m, µ), 21 ΦLm,µ ) define classes in
c 1 (X tor , Dpre) of X tor over C in the sense of Definition 1.15
the arithmetic Chow group CH
L
L
of [BBK]. The same argument as in the proof of Theorem 5.4 shows that the generating
series of these classes is modular with values in that arithmetic Chow group.

54

JAN H. BRUINIER AND SHAUL ZEMEL

References
[AMRT]

Ash, A., Mumford, D., Rapoport, M., Tai, Y. S. Smooth Compactifications of Locally
Symmetric Varieties, Lie Groups, History, Frontiers and Applications IV, Math. Sci. Press,
Brookline, MA, iv+335pp (1975).
[BB]
Baily, W. L., Borel, A., Compactification of Arithmetic Quotients of Bounded Symmetric Domains, Ann. of Math., vol 84 issue 3, 442–528 (1966).
[Bo1]
Borcherds, R. E., Automorphic Forms with Singularities on Grassmannians, Invent.
Math., vol. 132, 491–562 (1998).
[Bo2]
Borcherds, R. E., The Gross–Kohnen–Zagier Theorem in Higher Dimensions, Duke
Math J., vol 97 no. 2, 219–233 (1999). Correction: Duke Math J., vol 105 no. 1, 183–184 (2000).
[Br1]
Bruinier, J. H., Borcherds Products on O(2, l) and Chern Classes of Heegner Divisors, Lecture Notes in Mathematics 1780, Springer–Verlag (2002).
[Br2]
Bruinier, J. H., On the Converse Theorem for Borcherds Products, J. Alg., vol 397,
315–342 (2014).
[BBK]
Bruinier, J. H., Burgos Gil, J.-I., Kühn, U., Borcherds Products and Arithmetic Intersection Theory on Hilbert Modular Surfaces, Duke Math J., vol 139 no. 1, 1–88
(2007).
[BFr]
Bruinier, J. H., Freitag, E., Local Borcherds Products, Ann. Inst. Fourier, vol 51, 1–26
(2001).
[BFu]
Bruinier, J. H., Funke, J., On Two Geometric Theta Lifts, Duke Math J., vol 125 no. 1,
45–90 (2004).
[BHY]
Bruinier, J. H., Howard, B., Yang, T., Heights of Kudla–Rapoport Divisors and Derivatives of L-Functions, Invent. Math., vol 201 no. 1, 1–95 (2015).
[BHKRY] Bruinier, J. H., Howard, B., Kudla, S., Rapoport, M., Yang, T., Modularity of generating series of divisors on unitary Shimura varieties, preprint (2017). arXiv:1702.07812
[math.NT]
[BK]
Bruinier, J. H., Kühn, U., Integrals of Automorphic Green’s Functions Associated
to Heegner Divisors, Int. Math. Res. Not., vol 2003, 1687–1729 (2003).
[BO]
Bruinier, J. H., Ono, K., Heeger Divisors, L-Functions, and Harmonic Weak Maass
Forms, Ann. of Math., vol 172, 2135–2181 (2010).
[BS]
Bruinier, J. H., Schwagenscheidt, M., Algebraic Formulas for the Coefficients of
Mock Theta Functions and Weyl Vectors of Borcherds Products, J. Algebra, vol
478, 38–57 (2017).
[BKK]
Burgos Gil, J.-I., Kramer, J., Kühn, U., Cohomological Arithmetic Chow Rings, J. Inst.
Math. Jussieu., vol 6, 1178 (2007).
[CLS]
Cox, D. A., Little, J., Schenck, H., Toric Varieties, Graduate Texts in Mathematics 124,
AMS, (2012)
[Fi]
Fiori, A., Toroidal Compactifications and Dimension Formulas for Spaces
of Modular Forms for Orthogonal Shimura Varieties, pre-print. arXiv link:
https://arxiv.org/abs/1610.04865.
[Fu]
Fulton, W., Introduction to Toric Varieties, Princeton University Press, Princeton, NJ
(1993)
[GS]
Gillet, H., Soulé, C., Arithmetic Intersection Theory, Publ. Math. IHES, vol 72, 94-174
(1990).
[GKZ]
Gross, B., Kohnen, W., Zagier, D., Heegner Points and Derivatives of L-Series, II,
Math. Ann., vol 278 no. 1–4, 497–562 (1987).
[HZ]
Hirzebruch, F., Zagier, D., Intersection Numbers of Curves on Hilbert Modular
Surfaces and Modular Forms of Nebentypus, Invent. Math., vol. 36, 57–114 (1976).

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

[H]
[HMP]
[K1]
[K2]

[K3]

[KM]

[L]
[McG]
[Nak]
[Nam]
[OT]
[P]
[Sa]
[Se]
[Ze1]
[Ze2]
[Ze3]

[Ze4]
[Ze5]

55

Hofmann, E., Local Borcherds Products for Unitary Groups, Nagoya Math. J., vol
234, 139–169 (2019).
Howard, B., Madapusi Pera, K., Arithmetic of Borcherds Products, pre-print,
https://arxiv.org/abs/1710.00347.
S. Kudla, Central Derivatives of Eisenstein Series and Height Pairings, Ann. of
Math. 2, vol 146 issue 2, 545–646 (1997).
S. Kudla, Special Cycles and Derivatives of Eisenstein Series, in Heegner Points and
Rankin L-series, Math. Sci. Res. Inst. Publ., vol 49, Cambridge University Press, Cambridge
(2004).
Kudla, S. S., Another Product for a Borcherds Form, in Advances in the Theory of Automorphic Forms and Their L-functions, ed. D. Jiang, F. Shahidi and D. Soudry, Contemporary
Math. 664, AMS, 261-294 (2016).
Kudla, S., Millson, J., Intersection numbers of cycles on locally symmetric spaces
and Fourier coefficients of holomorphic modular forms in several complex variables, IHES Publi. Math. vol. 71, 121–172 (1990).
Looijenga, E., Compactifications Defined by Arrangements II: Locally Symmetric
Varieties of Type IV, Duke Math. J., vol 119, 527-588 (2003).
McGraw, W. J., Rationality of Vector Valued Modular Forms Associated to the
Weil Representation, Math. Annalen, vol. 326, 105–122 (2003).
Nakajima, S., On Invariant Differential Operators on Bounded Symmetric Domains of Type IV, Proc. Japan Acad., vol 58 issue A, 235238 (1982).
Namikawa, Y., Toroidal compactification of Siegel spaces, Lecture Notes in Mathematics 812, Springer–Verlag, Berlin (1980).
Oda, T., Tsuzuki, M., Automorphic Green Functions Associated with the Secondary
Spherical Functions, Publ. Res. Inst. Math. Sci., vol 39, 451–533 (2003).
Peterson, A., Modular Forms on the Moduli Space of Polarised K3 Surfaces, preprint, arXiv link: https://arxiv.org/abs/1511.06887 (2015).
Satake, I., On Compactifications of the Quotient Spaces for Arithmetically Defined Discontinuous Groups, Ann. of Math., vol 72 issue 2, 555–580 (1960).
Serre, J.-P., A Course in Arithmetic, Graduate Texts in Mathematics 7, Springer-Verlag,
New York (1973).
Zemel, S., A Gross–Kohnen–Zagier Type Theorem for Higher-Codimensional Heegner Cycles, Res. Number Theory, vol 1:23, 1–44 (2015).
Zemel, S. Regularized pairings of meromorphic modular forms and theta lifts, J.
Number Theory, vol 162, 275-311 (2016).
Zemel, S., Weight Changing Operators for Automorphic Forms on Grassmannians
and Differential Properties of Certain Theta Lifts, Nagoya Math. J., vol 228, 186–
221 (2017).
Zemel, S., Normalizers of Congruence Groups in SL2 (R) and Automorphisms of
Lattices, Int. J. Number Theory, vol 13 issue 7, 1275-1300 (2017).
Zemel, S., The Integral Structure of Parabolic Subgroups of Orthogonal Groups,
submitted. https://arxiv.org/abs/1902.08264

Fachbereich Mathematik, Technische Universität Darmstadt, Schlossgartenstrasse 7,
D–64289 Darmstadt, Germany
E-mail address: bruinier@mathematik.tu-darmstadt.de
Einstein Institute of Mathematics, the Hebrew University of Jerusalem, Edmund Safra
Campus, Jerusalem 91904, Israel
E-mail address:
zemels@math.huji.ac.il

