Orbital Stabilization of Nonlinear Systems via Mexican
Sombrero Energy Shaping and Pumping-and-Damping
Injection ?

arXiv:1903.04070v3 [cs.SY] 1 Sep 2019

Bowen Yi a,b , Romeo Ortega b,c , Dongjun Wu b , Weidong Zhang a
a
b
c

Department of Automation, Shanghai Jiao Tong University, 200240 Shanghai, China

Laboratoire des Signaux et Systèmes, CNRS-CentraleSupélec, 91192 Gif-sur-Yvette, France
Faculty of Control Systems and Robotics, ITMO University, St. Petersburg 197101, Russia

Abstract
In this paper we show that a slight modification to the widely popular interconnection and damping assignment passivity-based
control method—originally proposed for stabilization of equilibria of nonlinear systems—allows us to provide a solution to
the more challenging orbital stabilization problem. Two different, though related, ways how this procedure can be applied are
proposed. First, the assignment of an energy function that has a minimum in a closed curve, i.e., with the shape of a Mexican
sombrero. Second, the use of a damping matrix that changes “sign” according to the position of the state trajectory relative
to the desired orbit, that is, pumping or dissipating energy. The proposed methodologies are illustrated with the example of
the induction motor and prove that it yields the industry standard field oriented control.
Key words: passivity-based control, nonlinear systems, orbital stabilisation, oscillator.

1

Introduction

In many practical tasks the system under control is required to operate along periodic motions, i.e., walking
and running robots, path following, rotating electromechanical systems, AC or resonant power converters, and
oscillation mechanisms in biology. As clearly explained
in [16, Section 8.4] the stability analysis of these behaviors can be recast as a standard equilibrium stabilization
problem, but this leads to very conservative results. It is
more convenient, instead, to invoke the notion of stability of an invariant set, where the latter is the closed orbit
associated to the periodic solution. This approach leads
to the important notion of orbital stability [16, Definition 8.2].
A large number of papers and books have been devoted
to analysis of orbital stability of a given dynamical system, see e.g., [7,11,14]. However, there are only a few
? Corresponding author: W. Zhang.
Email addresses: yibowen@ymail.com (Bowen Yi),
ortega@lss.supelec.fr (Romeo Ortega),
dongjun.wu@l2s.centralesupelec.fr (Dongjun Wu),
wdzhang@sjtu.edu.cn (Weidong Zhang).

Preprint submitted to Automatica

constructive tools available to solve the task of orbital
stabilization of a controlled system. A popular approach
to address this question is the virtual holonomic constraints (VHC) method, which has been tailored for mechanical systems of co-dimension one [17,19,27,28]. In
the VHC method a certain subspace of the state-space is
rendered attractive and invariant, leading to a projected
dynamics that behaves as oscillators. This is a particular
case of the framework adopted in the immersion and invariance (I&I) technique, first reported for equilibrium
stabilization in [2], and later extended for observer design and adaptive control in [3]. In [25] it has recently
been shown that I&I can also be adapted for orbital stabilization, leading to a procedure that contains, as particular case, the VHC designs. The only modification
done to the standard I&I technique is in the definition
of the target dynamics that now should be chosen possessing periodic orbits, instead of an equilibrium at the
desired point. A main drawback in both the VHC and
I&I methods is that the steady-state behavior cannot be
fixed a priori, but depends on the initial states, see [25,
Remark 2] for a discussion on this matter.
An alternative approach to generate oscillations is reported in [26], where it is proposed to construct pas-

4 September 2019

sive oscillators for Lure dynamical systems using “signindefinite” feedback static mappings, which is a mechanism similar to the pumping-and-damping injection discussed below. Unfortunately, since the analysis is carried
out applying the center manifold theory—that is a local notion—the obtained oscillators are assumed to have
small amplitudes. Orbital stabilization designs, for some
particular controlled plants, have also been reported in
[1,11,29].

desired curve

Fig. 1. The closed-loop Hamiltonian with the target orbit
and the Mexican sombrero in MSEA-PBC

2
The aim of this paper is to show that the widely popular interconnection and damping assignment passivity based control (IDA-PBC), originally proposed in
[22,23,24] for stabilization of equilibria, can be easily be
adapted to address the problem of orbital stabilization
of general nonlinear systems. This leads to two new
constructive solutions for this problem that—as usual
in PBC—have a clear interpretations from the energy
viewpoint. First, the assignment of an energy function
that has a minimum in a closed curve, i.e., with the
shape of a Mexican sombrero. Second, the use of a
damping matrix that changes “sign” according to the
position of the state trajectory relative to the desired
orbit, that is, pumping or dissipating energy. As usual
in all constructive nonlinear controller designs, the success of the proposed methods hinges upon our ability to
solve a partial differential equation (PDE).

Background on IDA-PBC

We consider in the paper systems written in the form
ẋ = f (x) + g(x)u,

(1)

with the state x ∈ Rn and the control u ∈ Rm , m ≤
n and g(x) full rank. To solve the orbital stabilization
problem we propose in the paper a variation of the IDAPBC method [23], normally used for regulation tasks.
The objective in IDA-PBC is to find a feedback control
law u = û(x) such that the closed-loop dynamics takes
a port-Hamitonian (pH) form, that is,


f (x) + g(x)û(x) = J (x) − R(x) ∇H(x) =: fcl (x) (2)
with H(x) ∈ R the desired Hamiltonian and
J (x) = −J > (x), R(x) = R> (x)

The remaining of the paper is organized as follows. Section 2 revisits the standard IDA-PBC. Section 3 introduces the problem formulation of orbital stabilization,
followed by the constructive main results in Section 4.
The application to the induction motor (IM) is reported
in Section 5. Interestingly, we prove that the resulting
controller exactly coincides with the industry standard
direct field-oriented control (FOC) first proposed in
[5]. In Section 6 the orbital stabilization of pendula is
studied. The paper is wrapped-up with conclusions and
future work in Section 7.

(3)

the desired (n × n) interconnection and damping matrices, respectively. The matching objective (2) is achieved
if and only if the following PDE (in H(x)) is solved


g ⊥ (x)f (x) = g ⊥ (x) J (x) − R(x) ∇H(x).

(4)

If this is the case, the control law is given as



û(x) = g † (x) J (x) − R(x) ∇H(x) − f (x) .

(5)

In regulation tasks, H(x) has a unique minimum at the
desired equilibrium and we choose the matrix R(x) to
be positive semi-definite to inject the damping required
to drive the trajectory towards the equilibrium. In this
paper we show that, for orbital stabilization we select
H(x) to have a minimum at the desired orbit—see Fig.
1. We will refer to this controller as Mexican sombrero
energy assignment (MSEA) PBC.

Notation. S denotes the unit circle. Given a set A ⊂ Rn
and a vector x ∈ Rn , we denote kxkA := inf y∈A |x − y|,
with |x|2 := x> x, and Bε (A) := {x ∈ Rn |kxkA ≤ ε}. All
mappings are assumed smooth. For a full-rank mapping
g(x) ∈ Rn×m with (m < n), we denote the generalized
inverse as g † (x) := [g > (x)g(x)]−1 g > (x), and g ⊥ (x) ∈
R(n−m)×n a full-rank left annihilator of g(x). We define the gradient transpose operator as ∇x := (∂/∂x)> .
When clear from the context the arguments of the mappings and the operator ∇ are omitted.

An alternative option is to select the “sign” of R(x) to
pump energy or inject damping according to the relative
position of the state with respect to the desired orbit—
this method is called energy pumping-and-damping
(EPD)-PBC. A visual illustration is given in Fig. 2.

Caveat. An abridged version of this paper will be presented in [31].

2

to ensure that the closed-loop vector field (2) satisfies
fcl (x)|x∈O 6= 0.

(8)

desired curve

4

We propose in this section two methods to solve the
orbital stabilization problem posed above, MSEA and
EPD-PBC, whose underlying philosophy is described in
Section 2. Connections between these two methods are
also given.

Fig. 2. The desired Hamiltonian and the target orbit in
EPD-PBC.

3

Problem Formulation

We are interested in the paper in the generation, via
IDA-PBC, of periodic solutions X : R+ → Rn which are
asymptotically orbitally stable. That is,
Ẋ(t) = fcl (X(t)),

Main Results

4.1

Mexican sombrero energy assignment PBC

The successful application of the IDA-PBC procedure
described in Section 2 is guaranteed in MSEA with the
following.

X(t) = X(t + T ), ∀t ≥ 0,

where the closed-loop vector field fcl (x) is given in (2),
and the set is defined by its associated closed orbit

Assumption 1 There are mappings (3) with R(x) ≥ 0
and a function H0 : Rn−1 → R verifying

A := {x ∈ Rn | x = X(t), 0 ≤ t ≤ T },

arg min H0 (x0 , x` ) = (0, x∗` )

(isolated),

(9)

is attractive.
which are solutions of the PDE (4), where we defined
the function H(x) := H0 (Φ(xp ), x` ).

We consider a particular case of periodic motion,
which is defined as follows. First, split the state as
x := col(xp , x` ), with xp ∈ R2 , x` ∈ Rn−2 . We also
partition the matrices J (x) and R(x) conformally as
"
#
(·)pp (·)p`
(·)`p (·)``

"
∼

R2×2

R2×(n−2)

R(n−2)×2 R(n−2)×(n−2)

There are two additional requirements to ensure the success of the MSEA design. First, a detectability-like condition to guarantee attractivity of the desired orbit. Second, to avoid the scenario discussed in Remark 1, we
impose a constraint on the interconnection matrix, that
ensures there are no equilibrium points in the set O
given in (7). These requirements are articulated in the
assumptions of the following proposition.

#
.

Then, define the set A as
A = C × {x∗` } ⊂ Rn ,

Proposition 1 Consider the system (1), verifying Assumption 1, in closed-loop with the control law u = û(x)
with û(x) given in (5). Assume the following.

where x∗` ∈ Rn−2 is a constant vector and C is a Jordan
curve, given in implicit form as

H1 A is the largest invariant set in the set
C := {xp ∈ R2 | Φ(xp ) = 0},

(6)

Q := {x ∈ Rn |∇> H(x)R(x)∇H(x) = 0} ∩ Bε (A),

on which ∇Φ 6= 0 with a smooth function Φ(xp ) ∈ R.
for some ε > 0.
H2 The (1,2)-element of J (x) may be parameterized as

Remark 1 It is important at this point to clarify the
difference between our objective of orbital stabilization
and the more classical set stabilization. The latter is
satisfied ensuring limt→∞ kx(t)kA = 0, but this does
not ensure that the desired periodic motion is generated.
Indeed, if the set

J(1,2) (x) =

c(x)
∇x0 H0 (x0 , x` )

(10)
x0 =Φ(xp )

(7)

for some c : Rn → R satisfying 0 < |c(x)| <
∞, ∀x ∈ A.

contains equilibrium points of the closed-loop dynamics
the periodic motion is not generated. That is, we want

Then, the closed-loop system is asymptotically orbitally
stable.

O := {x ∈ Rn | kxkA = 0}

3

the 1-norm of ẋp as

Proof 1 The closed-loop system takes the form
ẋ = [J (x) − R(x)]∇H.

kfcl (x)k1 = |c(x)|k∇Φ(xp )k1 > 0,

(11)

With the additional Jordan curve assumption, the existence of a periodic orbit is verified, completing the proof.
222

From the isolated minimum condition of H0 (x0 , x` )
stated in (9), we conclude that the function H(x) has
minima in the set A. Consequently,
∇H(x)

x∈A

= 0, ∇2 H0 (x)

x∈Bε (A)

>0

Remark 2 The minimum condition (9) implies that
∇x0 H0 (x0 , x) = 0. Consequently, in view of condition
(10), the mapping Jp` (x) is singular along the orbit.
However, the closed-loop dynamics and the feedback law
(5) are well-defined everywhere. If the term J(1,2) (x) is
bounded along the orbit the condition (8) is violated.
Consequently, the “infinite interconnection” condition
H2 is necessary to ensure the orbit exists, otherwise we
only achieve set stabilization—see Remark 1.

(12)

for some ε > 0. This shows that the set Q—containing
the set A—is non-empty.
From the closed-loop pH dynamics it is clear that
Ḣ = −∇> H(x)R(x)∇H(x) ≤ 0,
implying the boundedness of H(x). Together with (12),
we conclude the Lyapunov stability of the closed-loop
system with respect to A. Thus, given a parameter ε > 0,
there always exists an invariant set E such that A ⊂
E ⊂ Bε (A). Now, from the first equation of (12) we get
∇> H(x)R(x)∇H(x)

x∈A

4.2

lim kx(t)kA = 0,

= 0.

H(x) := Hp (xp ) + H` (x` ).

∀x(t0 ) ∈ E.

with Hp∗ the desired energy level for Hp (xp ), which
should be “above” the minimal value of Hp (xp ), that is,
it should satisfy
Hp∗ > min(Hp (xp )).
To enforce the oscillation, the “sign” of the damping
matrix R(x) changes according to the position of the
state x relative to the desired oscillation—whence, to
the set C. See Fig. 2.

Jpp (x)∇xp H(x) = Jpp (x)∇x0 H0 (x0 , x` )∇Φ(xp )
"
#
0
J(1,2) (x)
∇x0 H0 (x0 , x` )∇Φ(xp )
=
−J(1,2) (x)
0
"
#
0 c(x)
=
∇Φ(xp ),
−c(x) 0

Similarly to Assumption 1 for MSEA-PBC, in EPDPBC we require that the PDE (4) is solvable, with an
additional constraint on R(x) to implement the energy
pumping-and-damping mechanism.

where we applied in the first identity the chain rule
∇xp H(x) = ∇x0 H0 (x0 , x` )∇Φ(xp ), and used assumption H2 in the third one. Considering that ∇H(x) x∈A =
0, the residual dynamics is

ẋp =

0

#
c(x)

−c(x)

0

∇Φ(xp ),

(13)

The function that defines the Jordan curve (6) is given
as
Φ(xp ) := Hp (xp ) − Hp∗ ,
(14)

The proof is completed establishing the existence of the
periodic orbit, that is, verifying (8). Consider the term
Jpp (x)∇xp H(x) of the closed-loop dynamics:

"

Energy pumping-and-damping PBC

In this subsection, we introduce an alternative orbital
stabilization methodology: EPD-PBC—where the periodic orbit is enforced by regulating the energy level to a
constant value. More precisely, we assume the total energy of the closed-loop can be decomposed as

Applying LaSalle’s invariance principle, taking into account the trajectory boundedness in E, and the assumption H1, we prove the attractivity of A, that is,
t→∞

∀x ∈ A.

Assumption 2 There exist functions Hp (xp ) and
H` (x` ), which have isolated minima in x∗p ∈ R2 and
x∗` ∈ Rn−2 , respectively, and mappings (3), with
R(x) = diag{Rpp (x), R`` (x` )},

ẋ` = 0.

where R`` (x` ) ≥ 0 and the diagonal matrix Rpp (x) satisfies the pumping-and-damping condition

Now, from Φ̇ = 0, we conclude that the set C is invariant.
To prove that the set A is a periodic orbit, we compute

Rpp (x)Φ(xp ) ≥ 0

4

(15)

ance principle, the state ultimately converges into the
largest invariant set of the set

where Φ(xp ) is given in (14), and
Rpp (x) = 0

⇐⇒

Φ(xp ) = 0.

(16)

Q = {x ∈ Rn |x` = x∗` , [Φ(x)Rpp (x)]∇Hp (x) = 0}.
There are three cases of [Φ(x)Rpp (x)]∇Hp (x) = 0,
namely,

In EPD-PBC besides the detectability-like and the interconection conditions, we require a technical assumption
to complete the proof. That is, ∇> Hp (xp )Jp` (x) = 0,
in order to “cut off” the energy flow between x` and xp
partitions.

i) [Φ(x)Rpp (x)] = 0;
ii) ∇Hp (x) = 0;
iii) Φ(x)Rpp (x) =
6 0 and ∇Hp (x) 6= 0 with

Proposition 2 Consider the system (1), verifying Assumption 2, in closed-loop with the control law u = û(x)
with û(x) given in (5). Assume the following.

∇Hp (x) ∈ Ker(Φ(x)Rpp (x)) = Ker(Rpp (x)).
First consider Case iii) with the definition

H3 {x∗` } is the largest invariant set in the set

Qiii := {x ∈ Rn |x` = x∗` and x satisfies Case iii)}.


x` ∈ Rn−2 ∇> H` (x` )R`` (x` )∇H` (x` ) = 0 .

We will prove that Qiii is not an invariant set by contradiction. Assume Qiii is invariant along the closed-loop
dynamics. On Qiii the residual dynamics is

H4 The matrix J (x) satisfies
J(1,2) (x) 6= 0,

∇> Hp (xp )Jp` (x) = 0.

ẋp = [Jpp (x) − Rpp (x)]∇Hp (xp )
with x` = x∗` . Since ∇Hp (xp ) ∈ Ker(Rpp (x)), we have

H5 For some ε∗ > 0
∇2 Hp |xp ∈Bε∗ (x∗p ) > 0, maxBε∗ (x∗p ) Hp (xp ) > Hp∗ .

ẋp = Jpp (x)∇Hp .

Assumption H4 ensures det(Jpp (x)) 6= 0, hence from
(17) we conclude that there are no equilibrium points in
Qiii . From (17) we also conclude that

Then, the closed-loop system is asymptotically orbitally
stable with respect to the orbit A ∩ Bε∗ (x∗ ) .
Proof 2 The closed-loop dynamics takes the form (11)
with ∇H = col(∇Hp (xp ), ∇H` (x` )). From which it is
clear that

>
Ḣ` = −∇> H` R`` (x` )∇H` + Jp`
(x)∇Hp

Hp (xp (t)) ≡ const, ∀x ∈ Qiii , t ≥ 0.

where we have used the assumption H4. Applying
LaSalle’s invariance principle and using the assumption
H3, we have
lim x` (t) = x∗` .

For Case i), from (16) we have
Φ(x)Rpp (x) = 0

t→∞

For Hp (xp ) we have
Ḣp = −∇ Hp Rpp (x)∇Hp −

>
Jp`
(x)∇H`

(18)

Noticing the diagonal condition of Rpp (x), together with
det(Rpp ) = 0, Rpp 6= 0 for Case iii) and ∇Hp (x) ∈
Ker(Rpp (x)), we then have ∇xp1 Hp ≡ 0 or ∇xp2 Hp ≡ 0,
that contradicts the identity (18). Therefore, the set Qiii
is not invariant, excluding the possibility of Case iii).

= −∇> H` R`` (x` )∇H` ≤ 0,

>

(17)

⇒

Φ(xp ) = 0.

Together with Φ̇ = 0 for all x ∈ A, it implies the invariance of Case i). For Case ii), it yields x = col(x∗p , x∗` ) :=
x∗ . In summary, the largest invariant set in Q is A∪{x∗ }.



= −∇> Hp Rpp (x)∇Hp ,

We consider the function W (x) = Φ(x), and, for some
small ε > 0, it follows

where we used again the assumption H4.
Consider the function V (xp ) := 12 Φ2 (xp ), we have

Ẇ = −∇> Hp Rpp (x)∇Hp ≥ 0,

V̇ = −∇> Hp [Φ(x)Rpp (x)]∇Hp ≤ 0,

∀xp ∈ Bε (x∗p ).

Therefore, the isolated equilibrium point x∗ is unstable.
On the other hand, the set A is attractive.

where the inequality is the consequence of the pumpingand-damping condition (15). Invoking LaSalle’s invari-

We proceed now to verify the existence of a periodic

5

Proposition 2 are satisfied by selecting the mappings 1

orbit. Since x∗ is a minimum of H(x) we have that
∇H(x)

x=x∗

= 0, ∇2 H(x)

x∈Bε (x∗ )

Hp (xp ) = Φ(xp ),
H` (x` ) = H` (x` )
"
"
#
#
0
H1 Jpp Jp`
H10 Rpp 0
J(x) =
, R(x) =
,
>
−Jp`
J``
0
R``
(20)
and H∗p = 0. Furthermore, the MSEA and EPD methods
yield the same feedback law.

> 0.

If x ∈ Bε (x∗ ), the function V(x) := H(x) − H(x∗ )
qualifies as a Lyapunov function (for the dynamics ẋ =
F (x)∇H(x) with F (x) > 0). According to [6, Theorem
4.1], the set C ∩ Bε∗ (x∗p ) defines a Jordan curve. On the
set A ∩ Bε∗ (x∗ ) the residual dynamics is
"
ẋp =

0

J(1,2) (x)

−J(1,2) (x)

0

Proof 3 We first verify the solvability of the matching
PDEs—equivalently the coincidence of two closed-loop
dynamics. The closed-loop dynamics in Proposition 1 is

#
∇Hp , ẋ` = 0.

We conclude |fcl (x)| =
6 0, completing the proof.



ẋ = J (x) − R(x) ∇H0 (Φ(xp ), x` )
"
#"
#
Jpp (x) − Rpp (x)
Jp` (x)
H10 ∇Φ
=
>
−Jp`
(x)
J`` (x) − R`` (x)
∇H`
#
#"
"
∇Φ
H10 (Jpp (x) − Rpp (x))
Jp` (x)
=
>
−Jp`
(x)
J`` (x) − R`` (x) ∇H`


= J(x) − R(x) ∇H(x),

222

Remark 3 The condition H4 is similar, in nature, to
H2, but excluding equilibria on the orbit A ∩ Bε∗ (x∗ ).
Noticing that |∇Hp | =
6 0 on the desired orbit, only “finite interconnection” is adequate in the EPD method
for the purpose of orbital stabilization. An example of
energy regulation without adequate interconnection is
given in our previous work [30], which solves the open
problem—using smooth, time-invariant state-feedback
to achieve almost global asymptotic regulation of threedimensional nonholonomic systems.

where we have used the assumption ∇> Φ(xp )Jp` (x) = 0
in the third equality. It is obvious that the closed-loop
dynamics in Proposition 2 is exactly the same with the
one in Proposition 1. The matching PDE in Proposition
2 is thus solvable.
Second, we will verify the assumptions in Proposition 2.
With the decomposition (19), we have

Remark 4 A trivial selection of the mapping Rpp is
diag(0, Φ(xp )), but it is non-unique. This indeed provides an additional degree of freedom to solve the PDE,
and the possibility to regulate the speed of convergence.

4.3


(9)

⇐⇒

(21)

satisfying the convex properties of H` (x` ) in Proposition
2. We then need to prove that there exists a point x∗p
such that

Comparison of MSEA-PBC and EPD-PBC

∇Hp (x∗p ) = 0,
In this section we compare the two methods and clarify the parallel between them. To simplify the presentation we relabel the various mappings used in the methods with fonts mathcal (J , R, H) for MSEA-PBC and
mathbf (J, R, H) for EPD-PBC. We have the following.

∇2 Hp (x)

x∈Bε (x∗
p)

> 0.

(22)

with Hp (xp ) = Φ(xp ). To this end, we notice that C is
diffeomorphic to the unit circle, and thus there exists
a smooth mapping T : R2 → R2 such that Φ(xp ) =
|T (xp )|2 −1, with ∇T 6= 0 and its inverse mapping T −1 (·)
is well-defined. By fixing x∗p = T −1 (0), we then have
∇Hp

Proposition 3 Consider the system (1), verifying all
the assumptions in Proposition 1. Assume the matrix R
is diagonal, R`` is a function of x` , and Rpp is non-zero.
If the mapping H0 : Rn−1 → R can be decomposed as
H0 (x0 , x` ) = H1 (x0 ) + H` (x` ),

arg min H1 (x0 ) = 0
arg min H` (x` ) = x∗` ,

∇2 Hp

(19)

x=x∗
p

x∈Bε (x∗
p)

= 2(∇T )> T (T −1 (0)) = 0
= 2(∇T )> ∇T + 2

2
X

Ti (xp )∇2 Ti > 0

i=1

1
The notation H10 represents the derivative of H1 (x0 ) with
respect to x0 . We also have H10 (x0 ) = ∇x0 H0 (x0 , x` ) according to (19).

and ∇> Φ(xp )Jp` (x) = 0, then all the assumptions in

6

for some small ε > 0, where in the latter inequality we
have used the continuity of the mapping and the fact
Ti (x∗p ) = 0. Thus we have verified the property of the
Hamiltonian H(x) in Proposition 2.

+

passive system

-

To verify the condition (15), we have
Fig. 3. Lure system with sign-indefinite feedback

Rpp (x) = 0

⇐⇒

H10 Rpp (x)

⇐⇒

H10 (x0 )

⇐⇒

=0
=0

be circumvented with the IDA methods, but with an additional difficulty in solving PDEs.

x0 =Φ(xp )

Φ(xp ) = 0,

where we have used the assumption Rpp (x) 6= 0 in the
second implication, and the fact H10 |x0 =0 = 0 in the last
one. Therefore, the equation (16) is satisfied. According
to the property of H1 , for sufficiently small |x0 | we have
H10 (x0 ) < 0 for x0 < 0 and H10 (x0 ) > 0 if x0 > 0. It
yields


Rpp (x)Φ(xp ) = Rpp (x) H10 (Φ(xp ))Φ(xp ) ≥ 0.

Remark 7 In [1,8,13] a similar MSEA approach is
adopted for some specific dynamical systems. In particular, in [8] the MSEA is imposed to the potential energy
in a path following task for fully actuated mechanical
systems.
Remark 8 In [4] the pumping-and-damping injection
is applied to stabilize pendula at the upright equilibrium almost globally. Some works on energy regulation
of nonlinear systems, though not aiming at oscillation
generation, can be found in [11,12,29].

Thus, the pumping-and-damping condition—inequality
(15)—has been proved. The remaining assumptions H3
and H4 are trivially verified.
222
4.4

Discussions
Remark 9 In [26] passive oscillators is constructed for
Lure dynamical systems using “sign-indefinite” feedback
static mappings, see Fig. 3. After assigning the linearized
system with a unique pair of conjugated poles on the
imaginary axis, the “sign-indefinite” feedback is adopted
to regulate the energy achieving periodic oscillations. Indeed, [26, Theorem 2] can be regarded as an EPD controller. It should be underscored that the center manifold
theory is applied in the analysis where the center manifold plays the exactly same role as the invariant manifold in VHC. Since the analysis of the latter is carried
out applying the center manifold theory—whose nature
is intrinsically local—the oscillators resulting from [26,
Theorem 2] are assumed to have small amplitudes. On
the other hand, they circumvent the daunting task of
solving PDEs. Whereas, the proposed EPD method has
the ability to shape behaviors of the closed-loop dynamics, making it instrumental in engineering practice.

The following remarks are in order specifically emphasizing the connections between the proposed methods
and existing methods.
Remark 5 In the problem formulation, we impose the
two-dimensional partition of xp . It may be argued to be
peculiar and stringent. We should underscore that, in
many cases, orbital stabilization tasks can be translated
in to our case. We take the widely studied VHC method,
though with a different mechanism from the proposed
designs, for instance, and consider an Euler-Lagrange
system with states q ∈ RN and q̇ ∈ RN the generalized
coordinates and velocities. The simplified control task
in VHC is to stabilize the invariant manifold
M := {(q, q̇) | q̄ = α(qN )},

q̄ := col(q1 , . . . , qN −1 ),

with some mapping α : R → RN −1 , and guarantee the
zero dynamics to admit non-trivial periodic solutions. It
is clear that on the manifold we have q̄˙ = η(qN , q̇N ) :=
∇α> (qN )q̇N . The above-mentioned task appropriately
adopts to our problem formulation with n = 2N and
the change of coordinate xp = col(qN , q̇N ), x` = col(q̄ −
α(qN ), q̄˙ − η(qN , q̇N )).

Remark 10 The assumptions in Proposition 4 on the
equivalence between two proposed methods are relatively mild, namely, the diagonalization of R(x) and the
decomposition of H0 (x). Despite the equivalence, the
realms of applicability of the methods are slightly different. For instance, if a controlled plant endows a pH
form, it may be easier to generate oscillations via EPD
without solving PDEs; on the other hand, for some systems it is simple to shape the Hamiltonian, e.g., fullyactuated mechanical systems, thus the MSEA method
is preferred.

Remark 6 A main drawback of VHC and I&I orbital
stabilization technique is that the steady-state behavior cannot be fixed a priori, but depends on the initial
states with a notable exception [19]. The drawback can

7

5
5.1

Induction Motor Example

P2 The controller (5) takes the form
ix
h
k
p
, k > 0.
u = β? I2 − (x` − ω? )J
β?
|xp |

Dynamic model and control objective

We consider the practical example of speed regulation
of current-fed IMs. The normalized dynamics of the IM
in the fixed frame is described by
ψ̇r = −Rψr + ωJψr + Ru
"
#
0 −1
>
ω̇ = u Jψr − τL , J :=
,
1 0

P3 All the assumptions of Proposition 1 are satisfied.
Consequently, the closed-loop system is asymptotically
orbitally stable with respect to (24). Moreover, the convergence is exponential.

(23)
Proof 4 The fact that Assumption 1 is satisfied
with (26)-(28) is easily verified. Assumption H2 is
also satisfied, with c(x) = −x` |xp |, which evaluated
in A yields −β? ω? 6= 0. The largest invariant set in
{x ∈ R3 |∇> H(x)R(x)∇H(x) = 0} is A ∪ {0}. Some
basic Lyapunov analysis shows that the origin is an
unstable equilibrium. According to Proposition 1, we
conclude that the closed-loop system is almost globally
asymptotically orbitally stable.

where ψr ∈ R2 is the rotor flux, ω ∈ R is the rotor
angular speed, τL ∈ R is the constant load torque, R > 0
is the rotor resistance, u ∈ R2 is the stator current,
which is assumed to be the control and, without loss of
generality, we have taken the rotor inertia to be equal
to one—see [21,18] for further details. To show the basic
idea, we make the assumption that τL = 0, which can be
removed adding an integral in the control action [21,18].

To establish the exponential orbital stability claim we
refer to [15], where it is shown to be equivalent to prove
that the transverse coordinate z := col(Φ(xp ), x` − ω? )
exponentially converges to (0, 0). The proof of Proposition 1 shows that we can always find some invariant compact sets containing A. In these compact sets, |xp | ≥ c1
for some c1 > 0. Thus in the neighborhood of A, we have

The control objective is to ensure the asymptotic orbital
stabilization of the set
A := {x ∈ R3 | Φ(xp ) = 0, x` = ω? },

(24)

where we introduced the notation xp := ψr , x` := ω,
defined the function
Φ(xp ) := |xp | − β? ,

(28)

ż2 = −

(25)

k
|xp |z2 ,
β?

and β? > 0, ω? ∈ R, ω? 6= 0 are the desired (constant)
references. Intuitively, we may fix the desired Hamiltonian as (27) then solving the PDE.

then yielding the exponential convergence of z2 to zero.
Now we have

5.2

where t is an exponentially decaying term caused by
z2 (0). The Jordan curve Φ(x) = 0 implies ∇Φ 6= 0 in
the neighborhood of A, from which we conclude the exponential stability of the transverse coordinate z. 222

ż1 = −R|∇Φ|2 z1 + t ,

Orbital stabilization of the IM via MSEA-PBC

In the following proposition we show that the aforementioned regulation problem of IMs can be solved via
MSEA-PBC.

Remark 11 It can also be shown that the closed-loop
system takes the pH form (11) with

Proposition 4 Consider the fixed-frame current-fed
IM model (23) and the target set (24), (25).



R(|xp | − β? )
0
0


R(x) = 
0
R(|xp | − β? ) 0 


k
0
0
β? |xp |


kR x2
0 −ω|xp | β? |xp |


x1 
J(x) = 
0
− kR
∗
β? |xp | 
∗
∗
0
1
1
1
H(x) = |xp |2 + (ω − ω? )2 , H?p = β?2 .
2
2
2

P1 Assumption 1 is satisfied with the choices

R 0

R=
0 R
0 0



x |xp |
kR x2
0 − |xp`|−β
β? |xp |
?



x1 

0 
0
− kR
 , J = ∗
β? |xp | 
k
∗
∗
0
β? |xp |
(26)
0



and
H0 (x0 , x` ) =

1 2 1
x + (x` − ω? )2 .
2 0 2

(27)

8

(29)

Remark 13 The application of the main idea of FOC of
IMs for smooth regulation of Brockett’s non-holonomic
integrator was first reported in [10], and later adopted
in [9,20] for control of nonholonomic systems.

and satisfies all the assumptions of Proposition 2. Hence,
the IM can be orbitally stabilized with the EPD-PBC
also.
5.3

FOC of the IM is an MSEA-PBC
6

In this subsection we prove that the MSEA controller of
Proposition 4 exactly coincides with the industry standard direct FOC first proposed in [5]—see also [18, Chapter 2.2] and [21, Chapter 11.2.1].

Pendulum Example

6.1

Local design

We consider a benchmark in nonlinear control—the planar inverted pendulum, which is related to various applications, e.g., the attitude control of space boosters and
walking robots. The normalized model given by [4]

Corollary 1 The MSEA controller (28) of Proposition
4 yields, after a state and input change of coordinates,
the classical direct FOC.

θ̇ = ω,
Proof 5 To prove that (28) coincides—modulo a coordinate change—with the direct FOC we introduce the
change of coordinates
ψr := eJθ λ,

u := eJθ v,

θ̇ = ω,

ω̇ = v > Jλ.

(30)

We are interested in asymptotically stabilizing the pendulum oscillating around its upright equilibrium. We define x = xp := col(θ, ω) in the absence of the x` partition. The first design is a local result as follows.

(31)

Proposition 5 Consider the model (33) in closed-loop
with the control law

Now, we write (31) in polar coordinates (β, ρ) as
β̇ = −Rβ + Rid , ρ̇ =

(33)

where θ ∈ S and ω ∈ R denote the angular position and
velocity, and the input u is the acceleration of the pivot.
In this representation, the angles 0 and π correspond to
the upright and downright positions, respectively.

that, applied to (23) (with τL = 0), yields the well-known
current-fed IM dynamics in the rotating frame
λ̇ = −Rλ + Rv,

ω̇ = sin θ − u cos θ,

R
iq , ω̇ = βiq
β

u = 2 sin θ + ωP (θ, ω) cos θ

(34)

with γ1 P (θ, ω) = −(cos θ − 21 )2 + 12 ω 2 −Hp∗ , where Hp∗ :=
−(cos θ∗ − 12 )2 , γ > 0, and θ∗ ∈ (− π3 , π3 ), the system is
locally asymptotically orbitally stable. Furthermore, the
angle θ ultimately oscillates between [−θ∗ , θ∗ ].

where we have defined
# " #
"
id
cos ρ
,
:= e−Jρ v.
λ := β
sin ρ
iq

Proof 6 We first define
It is easy to see from the equations above that the objective β(t) → β? , ω(t) → ω? , which is equivalent to the
asymptotic stabilization of the set 2 A, is achieved with
the simple control
"
v=e

β?

Jρ
k
β?

ω? − ω

Φ(x) = Hp − Hp∗ .
The closed loop takes the pH form (11) with 3

#
 ,

"

(32)

J (x) =

, R(x) =
−1 0

1 2
Hp (x) = − cos θ −
+
2

with k > 0. This is the famous direct FOC for induction
motors. It is a simple exercise to show that (28) is obtained applying to (32) the change of coordinates (30).
222

"
0

0

#

0 γ(cos θ)2 Φ(x)
1 2
ω .
2

The Hamiltonian function Hp (x) admits an isolated local
minimal point at (0, 0). Define A = {x ∈ R2 |Φ(x) = 0},
and the periodic orbit is

Remark 12 It is interesting to note that, expressed in
the rotating coordinates, the direct FOC does not generate a periodic orbit, but only ensures set stability.
2

#
0 1

A ∩ {x ∈ R2 ||x1 | <
3

Notice that |ψr | = |λ| = β.

9

π
},
3

The Hamiltonian function is motivated by [4].

which is a Jordan curve.

and

The fact

Q(θ, ω) :=

Φ̇ = −ω 2 (cos θ)2 Φ.
implies that the set
Ω = {x ∈ R2 ||Φ(x)| < ε, |x1 | <


 γ1 (Hp (θ, ω) − Hp∗ ),
γ ,
2

π π
θ ∈ (− , )
3 3
π
π
θ ∈ [−π, ] ∪ [ , π)
3
3

then there exist γ1 , γ2 ∈ R+ such that the state asymptotically converges to the orbit A ∩ {x ∈ R2 ||x1 | < π3 }
or the saddles ( π3 , 0), almost globally on S × R.

π
}
3

is invariant for some ε > 0. It is easy to verify the assumptions H3-H5 in the set Ω. We complete the proof
by applying Proposition 2.
222

Proof 7 The closed-loop is the same with the one in
Proposition 5, but with a different function P (θ, ω).
We draw the curves of P (θ, ω) = 0 (the red one) and
Hp (θ, ω) = 0 (the green one) in Fig. 5. They divide the
manifold S × R into 9 portions, where each set is defined
as an open set. Intuitively, in the set

We underscore that the level set Φ(x) = 0 containing
two disconnected parts. Hence, the restriction |x1 | <
1
3 π is indispensable. We give the simulation results in
Fig. 5 with initial values (0.1π, 0) and (0.3π, 0), where
γ = 5 and Hp∗ = −0.0429. In this figure we show the
evaluation of the (2,2)-element of R(x), illustrating the
pumping-and-damping mechanism.

Ωp := cl(S) ∪ D1 ∪ cl(U1 ) ∪ cl(U2 ) ∪ cl(U3 ) ∪ cl(U4 )
the pumping-and-damping matrix is a pumping matrix,
and in the set
Ωd := Q1 ∪ Q2 ∪ D2
it acts as a damping one.

Q1
U2

U1

A

S

!

D1 D2

B

S

U4

U3

Q2
¼

¡¼

Fig. 5. The partition of the space S × R.

It is clear that
Ḣp = (∇Hp )
Fig. 4. The dynamics behaviour in Proposition 5.

6.2

>

"
0

0

#

0 −(cos θ)2 P (θ, ω)

∇Hp .

We now consider three possible cases of the initial condition.
1) In the set

Almost global design

Ωp − D1 /{(π, 0), A, B}

The following proposition is an almost global design.

we have Ḣp > 0, thus this connected set is a repeller. Noticing that the boundary of the set S is
the contour Hp (x) = 0, thus all states in the set
Ωp − D1 /{(π, 0), A, B} will leave into cl(U1 ) ∪ cl(U2 ) ∪
cl(U3 ) ∪ cl(U4 ), which contains two equilibria A and B.

Proposition 6 Considering Proposition 5, if we select
3
1
3
P (θ, ω) = ( cos θ + ω 2 − )Q(θ, ω)
2
2
4

10

2) It is also easy to show the set
cl(D2 ) ∪ cl(D1 )/{A, B}
is invariant. In this set, we need to prove that the control
law regulates the state to the desired energy level Hp =
Hp∗ 4 . To this end, we define the function
V =

1
Φ(x)2 .
2

Its derivative along the closed-loop dynamics is
V̇ = −(∇Hp )

>

"
0

#
Z(θ, ω)

∇Hp

,

with

Z(θ, ω) =

3
1
3
cos θ + ω 2 −
2
2
4



2
· cos θΦ ,

Fig. 6. The dynamics behaviour nin Proposition 6.

which is positive semi-definite in cl(D2 )∪cl(D1 )/{A, B}.
We have the set {(θ, ω)|V̇ = 0} equal to {(θ, ω)|Hp (θ, ω) =
Hp? } ∪ (0, 0), and the equilibrium (0, 0) is unstable.
Thus invoking LaSalle’s invariance principle, if the initial state is in cl(D2 ) ∪ cl(D1 )/{A, B, (0, 0)}, it will
asymptotically converge to the desired periodic orbit.
3) For the set cl(U1 ) ∪ cl(U2 ) ∪ Q1 or the set cl(U3 ) ∪
cl(U4 )∪Q2 , it is relatively complicated. For convenience,
we define the set
Ω3 := Q1 ∪ Q2 ∪ cl(U1 ∪ U2 ∪ U3 ∪ U4 ).
Since the set cl(S) is a repeller, the states which star in
Ω3 have two possible trajectories:

7

Concluding Remarks

It has been shown that the IDA-PBC design methodology can be adapted to address the problem of orbital stabilization of nonlinear systems. We propose two different, but related, IDA-PBC designs: MSEA and EPD—
whose application, as usual in IDA, requires the solution
of a PDE. In the former, the closed-loop Hamiltonian
function is shaped to have minima at the desired orbit.
For the latter, we regulate the energy to a desired value
using a pumping-and-damping dissipation matrix. To
ensure asymptotic orbital stability, and not just set attractivity, some constraints are imposed on the interconnection matrix. We then establish connections between
the above-mentioned methods.
Currently research is carried out in the following directions.

3a) converging to the compact set cl(D2 ), and then it
can be analyzed as case 2).
3b) staying in the set Ω3 for all t > 0.

• The problem of path following—in a time parameterizationfree manner—for mechanical systems. It has been
observed that this is closely related to the orbital
stabilization problem studied in this paper.
• The connection between the proposed method and the
indirect version of FOC is still an open, and interesting, topic.
• Application of the proposed methods to solve some
periodic motion control problems in mechanical and
power electronic systems, e.g. in walking robots and
AC (or resonant) power converters.

Following the proof in [4] with some complicated analysis, we can prove the energy dissipation in Ω3 thus ruling out the case 3b) except two equilibria A and B. It
completes the proof.
222
Fig. 6 gives the simulation results to illustrate Proposition 6 with the x(0) = (π, 0.01), γ1 = 20, γ2 = 2, θ∗ = π4
and Hp∗ = −0.0429. The figure illustrates the almost
global property with the angle ultimately oscillating between [− π4 , π4 ].

Acknowledgements

4

This paper is supported by the NSF of China (61473183,
U1509211, 61627810), National Key R&D Program of

It should be noticed that the contour Φ(x) = 0 has two
unconnected parts.

11

China (SQ2017YFGH001005), China Scholarship Council and by the Government of the Russian Federation
(074U01), the Ministry of Education and Science of Russian Federation (GOSZADANIE 2.8878.2017/8.9, grant
08-08).

[17] M. Maggiore and L. Consolini, Virtual holonomic constraints
for Euler-Lagrange systems, IEEE Trans. Automatic Control,
vol. 58, pp. 1001-1008, 2013.
[18] R. Marino, P. Tomei and C. Verrelli, Induction Motor Control
Design, Springer Verlag, London, 2010.
[19] A. Mohammadi, M. Maggiore and L. Consolini, Dynamic
virtual holonomic constraints for stabilization of closed orbits
in underactuated mechanical systems, Automatica, vol. 94,
pp. 112-124, 2018.

References

[20] P. Morin and C. Samson. Practical stabilization of driftless
systems on Lie groups: The transverse function approach.
IEEE Trans. Automatic Control, 48:1496–1508, 2003.

[1] J. Aracil, F. Gordillo and E. Ponce, Stabilization
of oscillations through backstepping in high-dimensional
systems, IEEE Trans. Automatic Control, vol. 50, pp. 705710, 2005.

[21] R. Ortega, A. Loria, P. J. Nicklasson and H.
Sira-Ramirez, Passivity-Based Control of Euler-Lagrange
Systems, Springer-Verlag, Berlin, Communications and
Control Engineering, 1998.

[2] A. Astolfi and R. Ortega, Immersion and invariance: A
new tool for stabilisation and adaptive control of nonlinear
systems, IEEE Trans. Automatic Control, vol. 48, pp. 590606, 2003.

[22] R. Ortega, M. Spong, F. Gomez and G. Blankenstein,
Stabilization of underactuated mechanical systems via
interconnection and damping assignment, IEEE Transactions
Automatic Control, vol. AC-47, no. 8, pp. 1218-1233, 2002.

[3] A. Astolfi, D. Karagiannis and R. Ortega, Nonlinear and
Adaptive Control with Applications, Springer-Verlag, Berlin,
Communications and Control Engineering, 2008.

[23] R. Ortega, A.J. van der Schaft, B. Maschke and G. Escobar,
Interconnection and damping assignment passivity-based
control of port-controlled Hamiltonian systems, Automatica,
vol. 38, pp. 585-596, 2002.

[4] K.J. Astrom, J. Aracil and F. Gordillo, A family of smooth
controllers for swinging up a pendulum, Automatica, vol. 44,
pp. 1841-1848, 2008.
[5] F. Blaschke, The principle of field orientation as applied to
the new TRANSVEKTOR closed loop control system for
rotating field machines, Siemens Review, vol. 39, pp. 217-220,
1972.

[24] R. Ortega and E. Garcia-Canseco, Interconnection and
damping assignment passivity-based control: A survey,
European J of Control, vol. 10, pp. 432-450, 2004.

[6] C.I. Byrnes, On Brockett’s necessary condition for
stabilizability and the topology of Liapunov functions on Rn ,
Communications in Information and Systems, vol 8, pp. 333352, 2008.

[25] R. Ortega, B. Yi, J.G. Romero and A. Astolfi, Orbital
stabilisation of nonlinear systems via the immersion and
invariance technique, Int. J. on Robust and Nonlinear
Control, submitted, 2018. arXiv:1810.00601

[7] D. Cheban, Global Attractors of Non-Autonomous
Dissipative Dynamical Systems, , World Scientifc Publishing
Co. Pte. Ltd., Singapore, 2004.

[26] G.-B. Stan, R. Sepulchre, Analysis of interconnection
oscillators by dissipativity theory, IEEE Trans. Automatic
Control, vol. 52, pp. 256-270, 2007.

[8] V. Duindam and S. Stramigioli, Port-based asymptotic
curve tracking for mechanical systems, European Journal of
Control, vol. 10, pp. 411-420, 2004.

[27] A.S. Shiriaev, J.W. Perram and C. Canudas-de-Wit,
Constructive tool for orbital stabilization of underactuated
nonlinear systems: Virtual constraints approach, IEEE
Trans. Automatic Control, vol. 50, pp. 1164-1175, 2005.

[9] W.E. Dixon, D.M. Dawson, E. Zergeroglu and F. Zhang.
Robust tracking and regulation control for mobile robots.
Int. J. on Robust and Nonlinear Control, 10:199–216, 2000.

[28] A.S. Shiriaev, L.B. Freidovich and S.V. Gusev, Transverse
linearization for controlled mechanical systems with several
passive degrees of freedom, IEEE Trans. Automatic Control,
vol. 55, pp. 893-906, 2010.

[10] G. Escobar, R. Ortega and M. Reyhanoglu, Regulation and
tracking of the nonholonomic double integrator: A fieldoriented control approach, Automatica, vol. 34, pp. 125-131,
1998.

[29] M.W. Spong, The swing up control problem for the Acrobot,
IEEE Control Systems Magazine, vol. 15, pp. 49-55, 1995.

[11] A.L. Fradkov, A.Y. Pogromsky, Introduction to Control of
Oscillations and Chaos, World Scientifc Publishing Co. Pte.
Ltd., Singapore, 1998.

[30] B. Yi, R. Ortega and W. Zhang, Smooth, time-varying
regulation of nonholonomic systems via energy pumpingand-damping, Systems & Control Letters, submitted, 2019.
arXiv:1812.11538

[12] G. Garofalo and C. Ott, Energy based limit cycle control of
elastically actuated robots, IEEE Trans. Automatic Control,
vol. 62, pp. 2490-2497, 2017.

[31] B. Yi, R. Ortega, D. Wu and W. Zhang, Two constructive
solutions to orbital stabilization of nonlinear systems via
passivity-based control, IEEE Conference on Decision and
Control, submitted, 2019.

[13] F. Gomez-Estern, A. Barreiro, J. Aracil and F. Gordillo,
Robust generation of almost-periodic oscillations in a class of
nonlinear systems, Int. J. on Robust and Nonlinear Control,
vol. 16, pp. 863-890, 2006.
[14] J. Guckenheimer and P. Holmes, Nonlinear Oscillations,
Dynamical Systems, and Bifurcations of Vector Fields,
Springer, NY, 1983.
[15] J. Hauser and C.C. Chung, Converse Lyapunov functions
for exponentially stable periodic orbits, Systems & Control
Letters, vol. 23, pp. 27-34, 1994.
[16] K.H. Khalil, Nonlinear Systems, Prentice-Hall, NJ, 3rd ed.,
2002.

12

