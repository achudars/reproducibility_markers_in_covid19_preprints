Coupling Staggered-Grid and MPFA Finite Volume Methods for
Free Flow/Porous-Medium Flow Problems
Martin Schneidera,∗, Kilian Weishaupta , Dennis Gläsera , Wietse M. Boona , Rainer Helmiga

arXiv:1902.02568v1 [math.NA] 7 Feb 2019

a Institute

for Modelling Hydraulic and Environmental Systems, University of Stuttgart, Pfaffenwaldring 61,
70569 Stuttgart, Germany

Abstract
A discretization is proposed for models coupling free flow with anisotropic porous medium flow.
Our approach employs a staggered grid finite volume method for the Navier-Stokes equations in
the free flow subdomain and a MPFA finite volume method to solve Darcy flow in the porous
medium. After appropriate spatial refinement in the free flow domain, the degrees of freedom are
conveniently located to allow for a natural coupling of the two discretization schemes. In turn, we
automatically obtain a more accurate description of the flow field surrounding the porous medium.
Numerical experiments highlight the stability and applicability of the scheme in the presence of
anisotropy and show good agreement with existing methods, verifying our approach.
Keywords: free flow, porous medium, coupling, multi-point flux approximation

1. Introduction
Coupled systems of free flow and flow through a porous medium can be found ubiquitously in
various kinds of natural and industrial contexts, including soil water evaporation [1], fuel cell water
management [2], food processing [3], and evaporative cooling for turbomachinery [4]. Despite
every-growing computational capacities, a discrete numerical modeling these kind of systems,
including the porous geometry, is only feasible for small-scale problems. For larger domain sizes,
averaging techniques involving the concept of a representative elementary volume (REV) [5], are
used in order to yield upscaled models for the description of the porous domain [6]. These models
can then be coupled to the free-flow region either using a single-domain or a two-domain approach.
For the former, both the porous medium and the free flow are described by a single set of equations,
as first introduced by Brinkman [7]. The two domains are then discerned by a spatial variation of
material parameters. On the other hand, the two-domain approach decomposes the problem into
two disjoint subdomains. The free-flow region is then governed by the Navier-Stokes equations
∗ Corresponding

author
Email addresses: martin.schneider@iws.uni-stuttgart.de (Martin Schneider),
kilian.weishaupt@iws.uni-stuttgart.de (Kilian Weishaupt), dennis.glaeser@iws.uni-stuttgart.de (Dennis
Gläser), wietse.boon@iws.uni-stuttgart.de (Wietse M. Boon), rainer.helmig@iws.uni-stuttgart.de (Rainer
Helmig)

Preprint submitted to Journal of Computational Physics

February 8, 2019

while Darcy’s or Forchheimer’s law is used in the porous medium subdomain [8, 9, 10, 11]. In order
to maintain thermodynamic consistency, appropriate coupling conditions have to be formulated
which enforce the conservation of mass, momentum and energy across the interface between the
two domains [12]. The aim of this work is to couple two different discretization schemes, and
we will focus on the two-domain approach since it provides this flexibility more readily. We will
consider laminar single-phase flow in the following but the extension to compositional multi-phase
flow in the porous domain [11] and the use of turbulence models in the free flow part [13] is
possible.
Being an active area of research, various mathematical and numerical models for the coupling
of (Navier-) Stokes and Darcy/Forchheimer have been developed during recent years. Examples
using the same spatial discretization scheme for both domains range from the staggered-grid finite
volume method [14, 15], finite element method [16] or the box-scheme, a vertex-centered finite
volume method [11, 17]. Furthermore, combinations of colocated and staggered-grid schemes have
been developed [18, 19, 13]. For more discretization approaches to the modeling of coupled free
flow and porous medium flow, we refer the reader to [16] and references therein.
In this work, the free flow equations are discretized using the staggered-grid method, which
forms a stable numerical method for such problems. In turn, no additional stabilization techniques
are necessary, in contrast to colocated schemes [20], for example. In the porous medium, we employ
a multi-point-flux-approximation method (MPFA) [21]. This method was developed to overcome
the shortcomings of the classical two-point-flux approximation. In particular, the MPFA scheme
does not require the grid to be K-orthogonal, meaning that the grid cells need not be in line with
the principal directions of the permeability tensor K. This is especially important for skewed and
unstructured grids or in case the principal directions of the permeability tensor are inclined, in
the case of layered porous structures or faults, for example. The MPFA method has been applied
previously for solving Brinkman’s equation [22, 7] for a coupled system of free flow and porous
medium. The referenced works thus use the same discretization scheme for both subdomains. The
novelty of this work is that we employ a staggered-grid method for the free-flow model (NavierStokes), and couple it with a MPFA method for the porous medium model (Darcy).
The paper is organized as follows. Section 2 introduces the coupled model by presenting the
governing equations in the free flow and porous medium flow subdomains, respectively, as well as
the coupling conditions at the interface. The discretization schemes are introduced in Section 3,
including the newly proposed coupling at the interface between the two subdomains. Numerical
results are presented in Section 4 with the use of two test cases. Finally, Section 5 focuses on the
conclusions.

2

2. Governing Equations
In order to present the governing equations for the coupled model, we first introduce the
assumptions on the geometry and the notational conventions. After these preliminary definitions,
we continue with the equations governing free flow and porous medium flow, followed by the
coupling conditions.
Let Ω ⊂ Rd , d ∈ {2, 3}, be an open, connected Lipschitz domain with boundary ∂Ω and d-

dimensional measure |Ω|. Furthermore, let Ωpm and Ωff be a disjoint partition of Ω representing
the porous medium and free flow subdomains, respectively. The subdomain boundaries are given
by the interface Γif := ∂Ωff ∩∂Ωpm as well as the remainders Γpm := ∂Ωpm \Γif and Γff := ∂Ωff \Γif .
For brevity, the superscripts are often omitted when no ambiguity arises.
The external boundary ∂Ω = Γff ∪ Γpm is further decomposed such that Γff = Γffv ∪ Γffp and

pm
disjointly. Here, the subscript denotes whether the velocity or the pressure
Γpm = Γpm
v ∪ Γp

is prescribed as a boundary condition. To ensure unique solvability of the resulting system, we
ff
assume that |Γpm
p ∪ Γp | > 0, i.e. that a pressure boundary condition is imposed on a subset of the

boundary ∂Ω with positive measure.
Let n denote the unit normal vector on ∂Ω oriented outward with respect to Ω. We abuse
notation and let n moreover denote the unit normal vector on Γif oriented outward with respect
to Ωff .
2.1. Free Flow
In our model, the Navier-Stokes equations govern the free flow in subdomain Ωff . These
equations are given by:
∂%
+ ∇ · (%v) = q,
∂t

∂(%v)
+ ∇ · %vvT − µ(∇v + (∇v)T ) + pI = %g,
∂t

(1a)
in Ωff ,

(1b)

v = vΓ ,

on Γffv ,

(1c)

p = pΓ ,

on Γffp .

(1d)

The unknown variables are the velocity v and the pressure p. Here, % and µ denote the
potentially pressure-dependent density and viscosity, respectively, while q is a source (or sink)
term, and g describes the influence of gravity. I is the identity tensor in Rd×d . The boundary
conditions are given by known quantities vΓ and pΓ , representing the velocity or pressure at the
corresponding boundary.

3

2.2. Porous Medium Flow
The equations governing single-phase flow in the porous-medium Ωpm are given by
∂%
+ ∇ · (%v) = q,
∂t
1
v + K (∇p − %g) = 0,
µ

(2a)
in Ωpm ,

(2b)

v · n = vΓ ,

on Γpm
v ,

(2c)

p = pΓ ,

on Γpm
p .

(2d)

Equation (2b) states that the momentum balance in the porous medium is given by Darcy’s law,
i.e. the Darcy velocity is calculated as v = − µ1 K (∇p − %g), with K being the permeability
tensor. Similar to the free-flow equations (1), q denotes a source or sink term. Finally vΓ and pΓ
are known quantities representing the normal flux and pressure on the corresponding boundaries,
respectively.
2.3. Coupling Conditions
In order to derive a thermodynamically consistent formulation of the coupled problem, conservation of mass and momentum has to be guaranteed at the interface between the porous medium
and the free-flow domain. We therefore impose the following interface conditions:

vff · n = −vpm · n,
ff
%vvT − µ(∇v + (∇v)T ) + pI n = ppm n,
!ff
√
t · Kt
−
(∇v)n − v
· t = 0,
αBF

(3a)
(3b)
on Γif .

(3c)

The momentum transfer normal to the interface is given by (3b) [9]. Condition (3c) is the
commonly used Beavers-Joseph-Saffman slip condition [23, 24]. Here, t denotes any unit vector
from the tangent bundle of Γif and αBF is a parameter to be determined experimentally. We
remark that this condition is technically a boundary condition for the free flow, not a coupling
condition between the two flow regimes. Furthermore, it has been developed for free flow strictly
parallel to the interface and might lose its validity for other flow configurations.

3. Discretization
This section is devoted to giving an outline of the numerical schemes used in the individual
subdomains and the incorporation of the interface conditions (3). However, we first introduce
some notational conventions concerning the partition of Ω in the following definition.

4

Definition 1 (Grid discretization). The tuple D := (T , E, P, V) denotes the grid discretization,
in which
(i) T is the set of control volumes (cells) such that Ω = ∪K∈T K. For each cell K ∈ T , |K| > 0
denotes the cell volume.
(ii) E is the set of faces such that each face σ is a (d − 1)-dimensional hyperplane with measure
|σ| > 0. For each cell K ∈ T , EK is the subset of E such that ∂K = ∪σ∈EK σ. Furthermore,
xσ denotes the face evaluation points and nK,σ the unit vector that is normal to σ and
outward to K.
(iii) P := {xK }K∈T is the set of cell centers (not required to be the barycenters) such that
xK ∈ K and K is star-shaped with respect to xK . For all K ∈ T and σ ∈ EK , let dK,σ
denote the Euclidean distance between xK and σ.
(iv) V is the set of vertices of the grid, corresponding to the corners of the cells.
For ease of exposition, we assume d = 2, however, this is not a limitation and the model can
be readily extended for three dimensions.
3.1. Staggered grid scheme
A staggered-grid finite volume scheme, also known as MAC scheme [15], is used in the free-flow
subdomain. Here, scalar quantities including pressure and density are stored on the cell centers
P while the velocity degrees of freedom are located on the primary control volumes’ faces E.
The resulting scheme is stable, hence oscillation-free solutions are guaranteed without the need
for additional stabilization techniques. This is in contrast with colocated schemes, in which all
unknowns are defined at the same location [20]. D is a uniform Cartesian grid with mesh size h
in both directions.
We start with the momentum balance equations. For each face in E, we construct a secondary

control volume K ∗ with boundary ∂K ∗ , as depicted in Figure 1. On each K ∗ , we integrate the
momentum balance equation and apply Gauss divergence theorem to obtain
Z
Z
Z
Z
Z
∂(%v)
dx +
(%vvT ) · n dΓ −
(µ(∇v + (∇v)T )) · n dΓ +
pn dΓ =
%g dx.
∂t
∂K ∗
∂K ∗
∂K ∗
K∗
K∗
(4)
The first and second components of this vector equation are considered separately. Due to the
different locations at which the degrees of freedom are defined, we require interpolation operators
in order to continue. Let us introduce the average ({·}) and jump quantities (J·K) on cell centers

5

(P) and vertices (V) of the primal grid for v = [vx , vy ]T (see Figure 1):




1 vxE + vxW 
1  vxN + vxS 
{v}|P =
{v}|V =
2 vN + vS
2 vE + vW
y
y
y
y




2 vxE − vxW 
1 vxN − vxS + vyE − vyW 
JvK|P =
JvK|V =
h vN − vS
h vN − vS + vE − vW
y
y
x
x
y
y

(5)

Here, the superscript {E, N, W, S} refers to the closest degree of freedom East, North, West, or
South of the evaluation point, see Figure 1. In the following, the superscript “up” denotes the

Dual cell

Vertex

Cell center
Face velocities

Figure 1: Grid and notations used for the staggered-grid discretization. Kx∗ , Ky∗ denote the dual cells. The picture
on the left illustrates the situation where xσ∗ coincides with a cell center, whereas the picture on the right shows
the case where the center xσ∗ of a dual face σ ∗ coincides with a vertex of the primary grid.

upwind quantity relative to the velocity v. Moreover, we introduce µavg such that in all cell centers
P, it denotes the corresponding viscosity whereas in each vertex V, it is the viscosity averaged
over the adjacent cells.
With the operators defined, we discretize the momentum balance equation for each secondary
control volume Ki∗ , in which the subscript i ∈ {x, y} denotes whether the control volume surrounds
a vertical or horizontal face, respectively. The discretized equation for component i is then given
by
Z
Ki∗

∂(%vi )
dx +
∂t

Z
∂Ki∗

({v}(%vi )up ) · n dΓ −

Z
∂Ki∗

µavg JvK · n dΓ +

Z

Z
pni dΓ =

∂Ki∗

%gi dx.
K∗

(6)

We emphasize that the boundary integrals are computed numerically using the following rules
for a scalar-valued function f and a vector-valued function f :
Z
X
X
f dΓ =
|σ ∗ |f (xσ∗ ) = h
f (xσ∗ ),
∂K ∗

Z
∂K ∗

f · n dΓ =

σ ∗ ∈EK ∗

X
σ ∗ ∈EK ∗

(7a)

σ ∗ ∈EK ∗

|σ ∗ |f (xσ∗ ) · nK ∗ ,σ∗ = h

6

X
σ ∗ ∈EK ∗

f (xσ∗ ) · nK ∗ ,σ∗ .

(7b)

By definition, each xσ∗ will either be a cell center (P) or a vertex (V) of the grid.
Finally, the mass balance is evaluated on each cell of the grid, i.e. we compute for each K ∈ T :
Z
K

∂%
dx +
∂t

Z
∂K

up

% v · n dΓ =

Z
q dx.

(8)

K

The above equations fully define the staggered-grid discretization scheme for all internal faces
of the grid D. For incorporation of boundary conditions, we refer the reader to [20].
3.2. Cell-centered finite volume scheme
A cell-centered finite volume scheme is employed in the Darcy subdomain, i.e. the grid elements are used as control-volumes and the degrees of freedom are associated with the cell centers.
Typically, the finite volume formulation is obtained by integrating the first equation of (2) over a
control volume K ∈ T and by applying the Gauss divergence theorem:
Z
Z
X Z %up
∂%
dx +
(−K
(∇p
−
%g))
·
n
dΓ
=
q dx.
up
σ µ
K
K ∂t

(9)

σ∈EK

Replacing, the exact fluxes by an approximation, i.e. FK,σ ≈

R
σ

(−KK (∇p − %g)) · n dΓ (here

KK is the value of K associated with control volume K), yields
Z
X %up
∂%
dx +
FK,σ = QK , ∀ K ∈ T ,
µup
K ∂t

(10)

σ∈EK

where FK,σ is the discrete flux through face σ flowing out of cell K, QK :=

R
K

q dx is the integrated

source/sink term, and (·)up denotes upwinding with respect to the sign of the flux FK,σ .
Finite volume schemes primarily differ in the approximation of the term (KK ∇p) · n (i.e. the
choice of the fluxes FK,σ ). The widely used linear two-point flux approximation (TPFA), for
example, is a simple but robust scheme. However, it is well-known that it is inconsistent on grids
that are not K-orthogonal (see e.g. [25]). In this work we consider anisotropic permeability tensors
in the porous medium and K-orthogonality of the grid can thus not be guaranteed. Therefore,
we employ a multi-point flux approximation (MPFA) scheme for the formulation of the discrete
fluxes, which has been presented in [21]. This particular scheme is termed MPFA-O and is only
one among many methods that fall into the family of MPFA schemes ([26, 27]). Please note that
we will omit the suffix “-O” throughout this document wherever it would affect the readability.
For the computation of the fluxes, a dual grid is created by connecting the barycenters of the
cells with the barycenters of the faces (d = 2) or the barycenters of the faces and edges (d = 3).
This divides each cell into sub-control volumes K v with K ∈ T and v ∈ V. Analogously, each
face is sub-divided into sub-control volume faces σ v , see Figure 2. Expressions for the face fluxes

FK,σv are obtained by introducing the face pressures pσv . The location of these face pressures
along the sub-control volume faces σ v is parameterized by ξ, 0 ≤ ξ < 1, and is the center of the
7

Interaction region
Sub-control volumes
Sub-control volume faces
Pressure support region
Cell pressures
Intermediate face pressures

Figure 2: Interaction region for the MPFA-O method. The parameter ξ, 0 ≤ ξ < 1 is used to define the location of
the intermediate face pressure unknowns pσiv . Here, the situation for ξ = 0.5 is illustrated.

original face σ for ξ = 0 and would be the position of the vertex v for ξ = 1. These face pressures
are then eliminated by enforcing the continuity of fluxes across each sub-control volume face. I.e.,
for each face σ v between K v and Lv , we impose:
FK,σv + FL,σv = 0.

(11a)

We allow for piecewise constant K (denoted as KK for each cell K) and construct discrete
v

v
gradients ∇K
D p, per sub-control volume K , depending on its two embedded sub-control volume

faces. Let us consider K v in Figure 2 with faces σ1v and σ3v . Here, the discrete gradients are
constructed to be consistent such that the following holds for i ∈ {1, 3}:
v

∇K
D p · (xσiv − xK ) = pσiv − pK .

(12)

Thus, a discrete gradient (for sub-control volume K v ) that fulfills the two conditions (12) is
defined by
v

−T
∇K
D p = DK v



pσ1v − pK

,
pσ3v − pK

h
with DK v := xσ1v − xK

i
xσ3v − xK .

(13)

This enables us to write the discrete flux across σ v between K v and Lv as follows:
v

FK,σv := −|σ v |nTK,σv KK ∇K
D p + γK,σ v ,
where we introduced γK,σv = ρσv |σ v |nTK,σv KK g, with ρσv =
gravity.
8

ρK +ρL
,
2

(14)
to incorporate the effect of

To deduce a cell-centered scheme, the face pressures pσiv are eliminated. This is done by
enforcing flux continuity (11a) within each interaction volume and by solving a local system of
equations.
We rewrite these conditions in matrix form, and introduce the sans serif font to denote the
corresponding matrices and vectors. All local face pressures of an interaction region are collected
in the vector pσ , cell pressures in the vector pK , and all terms related to gravity in the vector g.
Flux continuity then allows us to rewrite the face pressures in terms of the cell pressures:
A pσ = B pK + ∆g.

(15)

Here, the ∆ represents the difference in contributions due to gravity over each face. Let f
denote the vector of all fluxes across the sub-control volume faces of the interaction region. These
can be expressed in matrix form using equation (14):
f = C pσ + D pK + g.

(16)

With these introduced matrices the final expressions for the local sub-control volume face
fluxes, related to the interaction region, read:

f = CA−1 B + D pK + CA−1 (∆g) + g.
|
{z
}

(17)

=:T

The entries of the matrix T are often referred to as the transmissibilities.
3.3. Coupling
In this section, we consider the realization of the coupling conditions (3). As depicted in
Figure 3, the grids are chosen to be non-matching at the interface such that each sub-control
volume face coincides with a face σ ∈ E ff of the free-flow domain. In turn, a natural coupling
arises between the staggered grid discretization and the MPFA method, due to the coinciding
degrees of freedom (for ξ = 0.5, see Figure 3). We emphasize that each cell in the porous-medium
subdomain has two neighboring cells in the free-flow subdomain (two-dimensional setup).
We start with the flux continuity condition (3a). As depicted in Figure 3, let us consider a
sub-control volume K v located at the interface such that σ3v is located on Γif . We then let the
velocity from the free-flow domain determine the flux over σ3v :
ff
FK,σ3v = −µup |σ3v |vy,σ
v.
3

(18)

Collecting the right-hand side of (18) in the matrix-vector product Wvff , we can rewrite (15)
for interaction regions that are located at the interface to the free-flow domain:
A pσ = B pK + Wvff + ∆g.
9

(19)

pm pm
In the situation shown in Figure 3, the face pressures ppm
σ1v , pσ2v , pσ3v are thus dependent on
pm
ff
ff
the primary unknowns ppm
K , pL of the porous-medium domain and the face velocities vσ2v , vσ3v of
pm pm pm ff
ff
the free-flow domain (i.e. ppm
σ v = pσ v (pK , pL , vσ2v , vσ3v )). Insertion of (19) in (16) leads to the
i

i

expression
f = T pK + CA−1 (Wvff + ∆g) + g

(20)

for the fluxes across sub-control volume faces within interaction regions located at the interface
to the free-flow domain.

Interaction region
Sub-control volumes

Free-ﬂow domain

Sub-control volume faces

Porous medium domain

Pressure support region
Cell pressures
Intermediate face pressures
Face velocities
Slip velocities (BJS)

Figure 3: Interaction region for the MPFA-O method at the interface to the free-flow subdomain. The graphic
illustrates the non-matching grids at the interface and the choice of ξ = 0.5 for the MPFA scheme such that
the degrees of freedom for the face velocities in the free-flow domain coincide with the intermediate face pressure
unknowns introduced on the interface.

The remaining coupling conditions are imposed as followed. The momentum balance (3b) is
enforced using the reconstructed face pressures from (19). On the other hand, the Beavers-JosephSaffman condition (3c) is technically a boundary condition for the free-flow problem, as previously
noted in Section 2, and is implemented accordingly.
Finally, we remark that in the case of compressible fluids, the density and viscosity are pressuredependent. The upwind terms µpm,up , %pm,up , %ff,up are then evaluated using the cell-pressure
unknowns, i.e. for a face σ between porous-medium cell K and free-flow cell L, these terms
ff
therefore depend on the pressures ppm
K and pL .

4. Numerical results
All simulations are performed using the open-source simulator DuMux [28], which comes in
the form of an additional DUNE module [29]. We employ a monolithic approach, where both

10

sub-problems are assembled into one system of equations and use an implicit Euler method for the
time discretization. Newton’s method is used to solve the non-linearities involved in the systems
of equations. For all test cases, the compressible fluid “air” (see the DuMux documentation [28])
is used. We consider two-dimensional setups, however, the implementation is also able to handle
three-dimensional domains.
4.1. Test case 1
The first test case is similar to the one that has been presented in [14]. However, the authors of
[14] used a Navier-Stokes-Brinkman-type system for both domains and this system is discretized
by using a staggered-grid scheme in both domains. For anisotropic permeability tensors, this
requires the interpolation of all velocity components at grid faces.
In this work, we use a different approach, where a staggered-grid scheme is used to discretize the
free-flow system and a cell-centered finite volume scheme to discretize the porous-medium system.
Thus, no additional velocity degrees of freedom are needed for the porous-medium domain. However, for anisotropic permeability tensors or unstructured grids this requires more sophisticated
cell-centered finite volume schemes, as for example the MPFA scheme that has been presented in
Section 3.2.
Air is flowing through a two-dimensional channel which is partially blocked by a rectangular
porous medium as shown in Figure 4. The first test case involves small Reynolds numbers (Re 
1) with respect to the average velocity in the narrow section in the channel above the porous
medium. In this case, only the stationary solution (which is reached after a few time steps,
starting from a resting fluid) is investigated. The top and bottom of the domain are considered as
rigid, impermeable walls with v = 0 (including the wall part below the porous box). Flow is driven
by a pressure difference between the left and the right boundary which is set to ∆p = 10−6 Pa.

Figure 4: Setting for the first test case.

The permeability tensor in the porous medium is given as



1
k
0
cos α
 R−1 (α), with R(α) = 
K = R(α)  β
0 k
sin α
11

− sin α
cos α


,

(21)

where α is the rotation angle, β ≥ 1 the anisotropy ratio, and k = 10−6 m2 . In the following,
pm
pm
the influence of the anisotropy on the total mass fluxes crossing the boundaries Γpm
in , Γout , Γtop

is investigated for α ∈ {−45◦ , −30◦ , 0◦ , 30◦ , 45◦ } and β ∈ {10, 100}. In the free-flow domain the
same grid is used for the MPFA and the TPFA schemes, whereas in the porous medium the grid
used for the MPFA scheme is coarsened such that we obtain a non-matching interface, as shown
in Figure 3.
Figure 5 and 6 show the velocity magnitude and the pressure profile of the MPFA and TPFA
schemes for β = 100 and α ∈ {−45◦ , 45◦ }. For the TPFA scheme, the results are only shown
for α = 45◦ because the results for α = −45◦ are identical. Due to the flow resistance imposed

by the porous medium, most of the air passes this obstacle through the constricted section above
the block, thus leading to the highest flow velocities there. While the gas passes the porous block
virtually parallel for both α = 45◦ and α = 0◦ when applying the TPFA method, the effect of
anisotropy is clearly visible in the MPFA results. Here, the flow follows the inclined principal
direction of the permeability tensor, exiting or entering the porous domain at the top. Small
regions of local recirculation can be found within the obstacle which are caused by the medium’s
anisotropy and the closed wall at the bottom. For α = −45◦ , the upward flow in the box creates
a recirculation at the right part of the bottom, where a small amount of gas is actually pulled
from the free-flow channel into the porous medium. Analogously for α = 45◦ , the downward flow
causes a recirculation at the bottom left, where the gas cannot exit through the solid wall and
thus leaves the domain towards the left, in opposition to the general flow field.
Due to the small pressure differences, we subtract a reference value of pref = 105 Pa for improved
visibility as shown on the right side of Figures 5 and 6. Almost the entire pressure drop along the
channel is observed at the porous domain. Again, the influence of anisotropy is clearly visibly for
the MPFA results in terms of an inclined pressure profile which also reflects the closed bottom of
the domain. None of these effects can be captured by the TPFA method.
Figure 7 shows the total mass fluxes over the porous-medium free-flow interfaces. For α = 0,
the TPFA and MPFA scheme result in almost the same solutions (small differences occur because a
finer mesh is used for the TPFA scheme in the porous medium). For this angle, the TPFA scheme
is also consistent and produces the correct results. However, it is observed that for all other angles
the total mass fluxes significantly differ. The off-diagonal terms of K are not considered in the
TPFA transmissibilities, which explains why the TPFA results are independent from the direction
of rotation. Furthermore, the total fluxes over Γpm
top are small for the TPFA scheme, in contrast to
the MPFA scheme, where the total mass fluxes increase with increasing rotation angle due to the
contribution from the non-parallel porous-medium flow as mentioned above.

12

Figure 5: Velocity (left column) and pressure (right column) profiles of MPFA scheme for an ansisotropy ratio
of β = 100 and for angles α = −45◦ (upper row) and α = 45◦ (lower row). The reference pressure is set to
pref = 105 Pa.

Figure 6: Velocity (left column) and pressure (right column) profiles of TPFA scheme for an ansisotropy ratio of
β = 100 and for angle α = 45◦ . The reference pressure is set to pref = 105 Pa.

4.2. Test case 2
The next test case investigates the solution behavior for higher Reynolds numbers. It uses a
similar setting as the previous one with the difference that the channel is elongated in x-direction.
The computational domains are given by Ω = [0, 2.5] × [0, 0.25] m and Ωpm = [0.4, 0.6] × [0, 0.2] m
such that Ωff = Ω \ Ωpm . A pressure difference of ∆p = 2 · 10−3 Pa between the left and the right
boundary results in Re ≈ 130 in the channel right atop the porous block.
For this test case, it takes much longer until a stationary solution is reached, which is why
the solutions are investigated at different time steps. In the following, we focus on the discussion
of the case where α = 0◦ or α = 45◦ and β = 100. Figure 8 shows the resulting velocity fields
of the MPFA method at different times for α = 45◦ . As before, the gas hits the front of the
porous block and is forced mainly through the narrow channel section above it which acts as some
sort of duct through which a jet of high velocity fluid streams in the open channel on the right
side. As the velocity gradually increases over time, the formation of vortex structures within the
free-flow channel can be observed after around 20 s. Having reached equilibrium at around 1000 s,

13

×10−8

×10−8
Mpfa
Tpfa

6

Mpfa
Tpfa

4

4
2

flux

flux

2
0
−2

0

−2

−4
−4

−6
−40

−20

0

20

−40

40

α

×10−8

0

20

40

20

40

α

×10−8
Mpfa
Tpfa

4

Mpfa
Tpfa

4

2

flux

2

flux

−20

0

−2

0

−2

−4

−4
−40

−20

0

20

−40

40

α

−20

0

α

pm
Figure 7: Total mass fluxes of MPFA and TPFA schemes over the porous-medium boundaries Γpm
in , Γout (left

column) and Γpm
top (right column) for an ansisotropy ratio of β = 10 (upper row) and β = 100 (lower row). In the
left pictures, the dashed lines correspond to the mass fluxes at the inlet boundary Γpm
in , whereas the solid lines to
the fluxes at the outlet boundary Γpm
out . Positive fluxes mean that fluid flows into the porous medium.

the system features two stable countercurrent, larger vortices downstream the porous obstacle and
one small recirculation zone in front of the block. Again, the flow within the obstacle is clearly
influenced by the anisotropy, a feature not reproduced by the TPFA method as seen in Figure 9.
Here, the flow within the block does not follow K’s orientation. Instead, the fluid immediately
strives for the top of the obstacle once it has entered it which is due to the strongly increased
vertical permeability (β = 100). Again, the TPFA scheme is not able to capture this relevant
anisotropy effect as it only considers the main diagonals of K. Figure 10 depicts the cumulative
mass fluxes per unit depth across the porous medium’s boundaries (top row) and across the plane
at the center of the narrow channel section (x = 0.5 m, bottom row) for a case with α = 0◦ (left
column) and one with α = 45◦ (right column). For the former, the results of the TPFA and MPFA
are very similar. With increasing time, the total mass flux entering the obstacle’s front (red line)
increases in accordance with the global velocity field (see Figure 8) until it approaches a constant
value after approximately 100 s. The same applies for the fluxes leaving the obstacle’s top (blue
line), which approaches the same value as the incoming fluxes but with a different sign. This

14

Figure 8: Velocity profiles of MPFA scheme for an ansisotropy ratio of β = 100 and for angle α = 45◦ for times
t ∈ {20 s, 40 s, 80 s, 200 s, 1000 s}. The domain is scaled by a factor of 2 in y-direction for a better visualization. The
porous-medium boundary is represented by the black lines.

Figure 9: Velocity profile of TPFA scheme for an ansisotropy ratio of β = 100 and for angle α = 45◦ for times
t = 1000 s. The domain is scaled by a factor of 2 in y-direction for a better visualization. The porous-medium
boundary is represented by the black lines.

indicates that no mass flux occurs over the obstacle’s back which can also be seen from the black
line. This line (and thus, the fluxes over the obstacle’s top) only deviates from zero at the very
beginning of the simulation where it has to balance out the initial disequilibrium between the red
and blue curve. Due to the imposed anisotropy ratio of β = 100, the horizontal permeability is
100 times lower than the vertical one and fluid is immediately pushed towards the top, where it
15

exits the domain again. Even though the fluid’s density is actually pressure-dependent, significant
compressibility effects could not be observed for the given setup. The differences between TPFA
and MPFA with respect to the blue and red curves (front and back of the obstacle) are most likely
due to the different discretization width in the porous domain as explained before. In total, less
gas seems to enter the porous block for the MPFA method. The plot on the lower left of Figure 10
shows the temporal evolution of the total mass flux through the channel above the obstacle. Both
the TPFA and the MPFA scheme converge to the same result, the grid resolution of the free-flow
domain is identical for both cases. Note that even with a constant flux through the constriction
after 100 s, the global velocity field downstream the obstacle still changes, including the formation
of vortices as described before.
0.00004

0.0002

MPFA Γpm
in

MPFA Γpm
in
MPFA Γpm
out

MPFA Γpm
out

MPFA Γpm
top

MPFA Γpm
top
TPFA

flux

TPFA
TPFA

TPFA Γpm
in

0.0001

0.00000

TPFA Γpm
out
TPFA Γpm
top

flux

0.00002

Γpm
in
Γpm
out
Γpm
top

0.0000

−0.00002

−0.0001
−0.00004
0

20

40

60

80

−0.0002

100

0

20

40

MPFA
TPFA

80

100

60

80

100

MPFA
TPFA

0.0020

0.0020

0.0015

0.0015

flux

flux

60

t

t

0.0010

0.0005

0.0010

0.0005

0.0000

0.0000
0

20

40

60

80

100

0

20

40

t

t

pm
pm
Figure 10: Total mass fluxes of MPFA and TPFA schemes over the porous-medium boundaries Γpm
in , Γtop , Γout

(upper row) and at the center of the constricted section of the free-flow channel (over the line segment connecting
the points (0.5 m, 0.2 m)T and (0.5 m, 0.25 m)T ) (lower row) for an ansisotropy ratio of β = 0 (left column) and
β = 100 (right column). Positive fluxes mean that fluid flows into the porous medium.

Considering the right column of Figure 10 (α = 45◦ ), the differences between the two schemes
are significantly higher. For the MPFA method, we observe a considerable inflow across the obstacle’s top boundary, coming from the constricted free-flow channel and drawn by the downwards
inclined flow field within the porous medium. At the same time, there is only a very limited inflow
through the obstacle’s front which is due the obstacle’s anistropy.
This is in strong contrast to the TPFA method’s result, where air is still leaving the obstacle’s
16

top as also described before and seen in Figure 9. The MPFA method results in a higher flux
through the constricted channel (see bottom right of Figure 10) as there is less fluid entering the
porous obstacle as explained above.
4.3. Test case 3
Another advantage of using MPFA in the porous medium domain is the ability to use unstructured grids while maintaining consistency of the scheme. The test case presented in this section
considers a porous medium domain in which geometrical constraints favor the use of triangles
(unstructured) over quadrilaterals for its discretization. This situation can arise, for example, in
environmental applications considering the exchange processes between the atmosphere and the
subsurface, where the latter can be composed of complex shaped geological layers. An illustration
of the setup of this test case is given in Figure 11, while a detailed view on the discretization of
the two compartments is depicted in Figure 12.

Figure 11: Setting for the third test case.

Figure 12: Detailed view on the grid used in test case three.

Two sets of simulations were performed using the rotation angles α = 45◦ and α = −45◦ ,

together with β = 10, k = 10−6 m2 and ∆p = 1 · 10−6 Pa. The results using both MPFA and
17

TPFA in the porous medium domain are shown in the Figures 13 and 14, respectively. Please note
that unlike before, the velocity vectors are now scaled by magnitude. As expected, the solutions
using TPFA exhibit a more distorted velocity field originating from the scheme being inconsistent
on both unstructured grids and for anisotropic tensors. On the other hand, the solutions using
MPFA provide velocity fields that follow the geometrical features of the porous medium. For
α = −45◦ , two main regions in which the flux from the porous medium into the free-flow domain
is concentrated, and where the maximum velocities occur, can be observed (see Figure 13). The
direction of these maximum velocities coincides with the direction of highest permeability. In
contrast to that, the inflow from the free-flow domain into the porous medium occurs in the
direction of the lowest permeability and thus at smaller velocities. In the case of α = 45◦ , the
highest velocities are observed in the regions where an inflow from the free-flow domain into the
porous medium occurs, again following the direction of the highest permeability (see Figure 14).
With TPFA being used in the porous medium domain, the differences between the velocity fields
obtained from the two angles turn out to be smaller in comparison to the solutions obtained with
MPFA. Furthermore, the low velocity regions seem to be generally overestimated. This effect
shows itself also in the integrated transfer flux across the interface, which results in 1.3 · 10−8 kg/s

for MPFA and 2.2 · 10−8 kg/s for TPFA, thus, around 70 % higher.

Figure 13: Velocity distribution in the porous medium for the third test case with β = 10 and α = −45◦ . The
upper and lower pictures depict the result using MPFA and TPFA in the porous medium domain, respectively.

5. Conclusions
In this work, a discretization method is proposed for problems concerning free flow coupled
to porous medium flow. The method combines the stability of the staggered grid finite volume
method for the free-flow equations with the consistency of MPFA finite volume methods for flows
18

Figure 14: Velocity distribution in the porous medium for the third test case with β = 10 and α = 45◦ . The upper
and lower pictures depict the result using MPFA and TPFA in the porous medium domain, respectively.

in anisotropic porous media. We have shown how appropriate alignment of the grids results in a
natural coupling between the two discretization schemes due to coinciding degrees of freedom.
The stability and consistency of the method are emphasized with the use of numerical experiments. Especially in the presence of anisotropy in the porous medium, a significant difference
is observed with respect to the widely used, but inconsistent, TPFA finite volume method. We
moreover emphasized the use of unstructured grids in the porous medium, allowing for computations on more general geometries. The use of unstructured grids in the free-flow domain [30] is a
topic for future investigation.
Future work will moreover address the extension of the presented model to multi-phase flow
simulations including compositional and non-isothermal effects, with a special focus on evaporative
processes at the interface between the porous medium and the free-flow domain. This extension
would make the model applicable to a large variety of applications, as e.g. the drying of soil due to
evaporation [11] and subsequent soil salinization [31]. This drying process can lead to the creation
of fractures within the porous medium. Therefore, we want to employ a discrete fracture model
for the description of the porous medium domain, for which there is a preexisting implementation
available in DuMux (see [32]). To increase efficiency, we will also use other finite volume schemes
for the porous domain, as for example those that have been recently presented in [33].

Acknowledgements
We thank the German Research Foundation (DFG) for supporting this work by funding SFB
1313, Research Project A02.

19

References
[1] J. Vanderborght, T. Fetzer, K. Mosthaf, K. M. Smits, R. Helmig, Heat and water transport in
soils and across the soil-atmosphere interface: 1. Theory and different model concepts, Water
Resources Research 53 (2) (2017) 1057–1079.
[2] V. Gurau, J. A. Mann, A critical overview of computational fluid dynamics multiphase models
for proton exchange membrane fuel cells, SIAM Journal on Applied Mathematics 70 (2) (2009)
410–454.
[3] P. Verboven, D. Flick, B. Nicolaı̈, G. Alvarez, Modelling transport phenomena in refrigerated
food bulks, packages and stacks: basics and advances, International Journal of Refrigeration
29 (6) (2006) 985–997.
[4] W. Dahmen, T. Gotzen, S. Müller, M. Rom, Numerical simulation of transpiration cooling
through porous material, International Journal for Numerical Methods in Fluids 76 (6) (2014)
331–365.
[5] J. Bear, Dynamics of fluids in porous media, Courier Dover Publications, 1972.
[6] S. Whitaker, The method of volume averaging, Kluwer Academic, 1999.
[7] H. C. Brinkman, A calculation of the viscous force exerted by a flowing fluid on a dense
swarm of particles, Applied Scientific Research 1 (1) (1949) 27–34.
[8] J. A. Ochoa-Tapia, S. Whitaker, Momentum transfer at the boundary between a porous
medium and a homogeneous fluidi. theoretical development, International Journal of Heat
and Mass Transfer 38 (14) (1995) 2635–2646.
[9] W. J. Layton, F. Schieweck, I. Yotov, Coupling fluid flow with porous media flow, SIAM
Journal on Numerical Analysis 40 (6) (2002) 2195–2218.
[10] D. Jamet, M. Chandesris, B. Goyeau, On the equivalence of the discontinuous one-and twodomain approaches for the modeling of transport phenomena at a fluid/porous interface,
Transport in Porous Media 78 (3) (2009) 403–418.
[11] K. Mosthaf, K. Baber, B. Flemisch, R. Helmig, A. Leijnse, I. Rybak, B. Wohlmuth, A coupling
concept for two-phase compositional porous-medium and single-phase compositional free flow,
Water Resour. Res 47 (10).
[12] S. M. Hassanizadeh, W. G. Gray, Derivation of conditions describing transport across zones
of reduced dynamics within multiphase systems, Water Resour. Res 25 (3) (1989) 529–539.

20

[13] T. Fetzer, C. Grüninger, B. Flemisch, R. Helmig, On the conditions for coupling free flow
and porous-medium flow in a finite volume framework, in: International Conference on Finite
Volumes for Complex Applications, Springer, 2017, pp. 347–356.
[14] O. Iliev, V. Laptev, On numerical simulation of flow through oil filters, Computing and
Visualization in Science 6 (2-3) (2004) 139–146.
[15] F. H. Harlow, J. E. Welch, Numerical calculation of time-dependent viscous incompressible
flow of fluid with free surface, The Physics of Fluids 8 (12) (1965) 2182–2189.
[16] M. Discacciati, A. Quarteroni, Navier-stokes/darcy coupling: Modeling, analysis, and numerical approximation, Revista Matemática Complutense 22 (2) (2009) 315–426.
[17] R. Huber, R. Helmig, Node-centered finite volume discretizations for the numerical simulation
of multiphase flow in heterogeneous porous media, Computational Geosciences 4 (2) (2000)
141–164.
[18] I. Rybak, J. Magiera, R. Helmig, C. Rohde, Multirate time integration for coupled saturated/unsaturated porous medium and free flow systems, Computational Geosciences 19 (2)
(2015) 299–309.
[19] R. Masson, L. Trenty, Y. Zhang, Coupling compositional liquid gas darcy and free gas flows at
porous and free-flow domains interface, Journal of Computational Physics 321 (2016) 708–728.
[20] H. K. Versteeg, W. Malalasekera, An introduction to computational fluid dynamics: the finite
volume method, Pearson Education, 2007.
[21] I. Aavatsmark, An introduction to multipoint flux approximations for quadrilateral grids,
Computational Geosciences 6 (3-4) (2002) 405–432.
[22] O. Iliev, R. Kirsch, Z. Lakdawala, G. Printsypar, Mpfa algorithm for solving stokes-brinkman
equations on quadrilateral grids, in: Finite Volumes for Complex Applications VII-Elliptic,
Parabolic and Hyperbolic Problems, Springer, 2014, pp. 647–654.
[23] G. S. Beavers, D. D. Joseph, Boundary conditions at a naturally permeable wall, Journal of
Fluid Mechanics 30 (01) (1967) 197–207.
[24] P. G. Saffman, On the boundary condition at the surface of a porous medium, Studies in
applied mathematics 50 (2) (1971) 93–101.
[25] M. G. Edwards, C. F. Rogers, Finite volume discretization with imposed flux continuity for
the general tensor pressure equation, Computational geosciences 2 (4) (1998) 259–290.

21

[26] I. Aavatsmark, G. Eigestad, B. Mallison, J. Nordbotten, A compact multipoint flux approximation method with improved robustness, Numerical Methods for Partial Differential
Equations: An International Journal 24 (5) (2008) 1329–1360.
[27] M. Edwards, H. Zheng, Quasi-positive families of continuous darcy-flux finite volume schemes
on structured and unstructured grids, J. Computational Applied Mathematics 234 (2010)
2152–2161. doi:10.1016/j.cam.2009.08.078.
[28] T. Koch, D. Gläser, K. Weishaupt, S. Ackermann, M. Beck, B. Becker, S. Burbulla, H. Class,
E. Coltman, T. Fetzer, B. Flemisch, C. Grninger, K. Heck, J. Hommel, T. Kurz, M. Lipp,
F. Mohammadi, M. Schneider, G. Seitz, S. Scholz, F. Weinhardt, Dumux 3.0.0 (Dec. 2018).
doi:10.5281/zenodo.2479595.
URL https://doi.org/10.5281/zenodo.2479595
[29] M. Blatt, A. Burchardt, A. Dedner, C. Engwer, J. Fahlke, B. Flemisch, C. Gersbacher,
C. Gräser, F. Gruber, C. Grüninger, D. Kempf, R. Klöfkorn, T. Malkmus, S. Müthing,
M. Nolte, M. Piatkowski, O. Sander, The distributed and unified numerics environment,
version 2.4, Archive of Numerical Software 4 (100) (2016) 13–29.
[30] R. Eymard, J. Fuhrmann, A. Linke, On mac schemes on triangular delaunay meshes, their
convergence and application to coupled flow problems, Numerical Methods for Partial Differential Equations 30 (4) (2014) 1397–1424.
[31] V. Jambhekar, R. Helmig, N. Schröder, N. Shokri, Free-flow–porous-media coupling for
evaporation-driven transport and precipitation of salt in soil, Transport in Porous Media
110 (2) (2015) 251–280.
[32] D. Gläser, R. Helmig, B. Flemisch, H. Class, A discrete fracture model for two-phase flow in
fractured porous media, Advances in Water Resources 110 (2017) 335–348.
[33] M. Schneider, B. Flemisch, R. Helmig, K. Terekhov, H. Tchelepi, Monotone nonlinear finitevolume method for challenging grids, Computational Geosciences 22 (2) (2018) 565–586.
doi:10.1007/s10596-017-9710-8.

22

