Benefits and Pitfalls of the Exponential Mechanism with
Applications to Hilbert Spaces and Functional PCA

arXiv:1901.10864v1 [cs.CR] 30 Jan 2019

Jordan Awan Ana Kenney Matthew Reimherr Aleksandra SlavkovicÃÅ
Department of Statistics, Pennsylvania State University, University Park, PA
Abstract
The exponential mechanism is a fundamental tool of Differential Privacy (DP) due to its strong privacy
guarantees and flexibility. We study its extension to settings with summaries based on infinite dimensional
outputs such as with functional data analysis, shape analysis, and nonparametric statistics. We show
that one can design the mechanism with respect to a specific base measure over the output space, such
as a Guassian process. We provide a positive result that establishes a Central Limit Theorem for the
exponential mechanism quite broadly. We also provide an apparent negative result, showing that the
magnitude of the noise introduced for privacy is asymptotically non-negligible relative to the statistical
estimation error. We develop an -DP mechanism for functional principal component analysis, applicable
in separable Hilbert spaces. We demonstrate its performance via simulations and applications to two
datasets.

1

Introduction

Data privacy and security have become increasingly critical to society as we continue to collect troves of
highly individualized data. In the last decade, we have seen the emergence of new tools and perspectives on
data privacy such as Differential Privacy (DP), introduced by Dwork et al. (2006), which provides a rigorous
and interpretable definition of privacy. Within the DP framework, numerous tools have been developed that
achieve DP in a variety of applications and contexts, such as empirical risk minimization (Chaudhuri et al.,
2011; Kifer et al., 2012), linear and logistic regression (Chaudhuri & Monteleoni, 2009; Zhang et al., 2012; Yu
et al., 2014; Sheffet, 2017; Awan & SlavkovicÃÅ, 2018), hypothesis testing (Vu & Slavkovic, 2009; Wang et al.,
2015; Gaboardi et al., 2016; Awan & SlavkovicÃÅ, 2018; Canonne et al., 2018), network data (Karwa et al.,
2016; Karwa & SlavkovicÃÅ, 2016), and density estimation (Wasserman & Zhou, 2010), to name a few.
One of the most flexible and convenient DP tools is the exponential mechanism, introduced by McSherry
& Talwar (2007), which often fits in naturally with estimation techniques from statistics and machine learning.
Many estimation procedures can be described as maximizing a particular objective or utility function:
where Œæ : Y ‚Üí R,

bÃÇ = arg max Œæ(b),
b‚ààY

or, equivalently, minimizing a loss function such as least squares or the negative log-likelihood. The exponential
mechanism provides a sanitized version of bÃÇ by using the objective function directly to add noise. The
sanitized estimate, bÃÉ, is drawn from a density, f (b), that is proportional to
n 
o
f (b) ‚àù exp
Œæ(b) ,
2‚àÜ
where ‚àÜ captures the sensitivity of the objective function to small perturbations in the data, and  is the
desired privacy budget (details in Sections 2 and 3). The idea behind this mechanism is to assign higher
density values to regions with higher utility. The constant ‚àÜ/ adjusts the spread of the density; as the
sensitivity increases or as the privacy budget decreases (meaning a decreased disclosure risk), the variability
of bÃÉ increases. A major advantage of such an approach is its use of the objective function from the non-private
estimate, bÃÇ, which naturally promotes perturbations with higher utility and discourages those with poor
utility.
1

In this paper we study the exponential mechanism, especially as it pertains to functional data analysis,
shape analysis, and nonparametric statistics, where one has a (potentially) infinite dimensional output. We
show that the exponential mechanism can be applied in such settings, but requires a specified base measure
over the output space Y. We propose using a Gaussian process as the base measure, as these distributions
are well studied and easy to implement. We derive a Central Limit Theorem (CLT) for the exponential
mechanism quite broadly, however, this result also implies that the magnitude of the noise introduced for
privacy is of the same order as the statistical estimation error. In particular, we show that in most natural
settings the exponential mechanism does not add an asymptotically negligible noise, even in finite dimensions.
Using our approach, we develop an -DP mechanism for functional principal component analysis (FPCA),
which extends the method of Chaudhuri et al. (2013) to separable Hilbert spaces. We show that a Gaussian
process base measure enables us to modify the Gibbs sampling procedure of Chaudhuri et al. (2013) to this
functional setting. We illustrate the performance of our private FPCA mechansim through simulations, and
apply our mechanism to both the Berkeley growth study from the fda package Ramsay et al. (2018) and the
Diffusion Tensory Imaging (DTI) dataset from the refund package Goldsmith et al. (2018).
Related Work: This work most directly builds off of Hall et al. (2013) and Mirshani et al. (2017),
which develop the first techniques for producing fully functional releases under DP. Another work in this
direction is Alda & Rubinstein (2017), in which they use Bernstein polynomial approximations to release
functions. Recently, Smith et al. (2018) applied the techniques of Hall et al. (2013) to privatize gaussian
process regression. In their setup, they assume that the predictors are public knowledge, and use this
information to carefully tailor the sanitization noise.
There have been a few accuracy bounds regarding exponential mechanism, which can be found in Section
3.4 of Dwork & Roth (2014). However, these results bound the loss in terms of the objective function, rather
than in terms of the private release. Wasserman & Zhou (2010) also develop some accuracy bounds for the
exponential mechanism, focusing on mean and density
‚àö estimation. They show that in the mean estimation
problem, the exponential mechanism introduces O(1/ n) noise. Our asymptotic analysis of the exponential
mechanism agrees in this setting, and extends this result to a large class of objective functions.
Our application to FPCA extends the private PCA method proposed in Chaudhuri et al. (2013). There
have been other approaches to private multivariate PCA. Blum et al. (2005) were one of the first to develop a
DP procedure for principal components, which is a postprocessing of a noisy covariance matrix. Dwork et al.
(2014) follow the same approach and develop bounds for this algorithm; they also develop an online algorithm
for private PCA. Jiang et al. (2013) modify this approach by both introducing noise in the covariance matrix
as well as to the projection. Imtiaz & Sarwate (2016) also add noise to the covariance matrix, but use a
Wishart distribution rather than normal or Laplace noise.
Organization: In Section 2, we review the necessary background of Differential Privacy. In Section
3, we recall the exponential mechanism and give asymptotic results for the performance of the exponential
mechanism in both finite and infinite dimensional settings. In Section 4 we show how the exponential
mechanism can be applied to produce Functional Principal Components, and in Section 5 we give a Gibbs
sampler for this mechanism. In Section 6, we study the performance of the private principal components
on both simulated data and on the Berkeley and DTI datasets. Finally, we give our concluding remarks in
Section 7.

2

Differential Privacy

In this section we provide a brief overview of differential privacy (DP). Throughout, we let X denote an
arbitrary set, which represents a particular population, and let X n be the n-fold Cartesian product, which
represents the collection of all possible samples that could be observed. We begin by defining the Hamming
Distance between two databases.
Definition 2.1 (Hamming Distance). The bivariate function Œ¥ : X n √ó X n ‚Üí Z, which maps Œ¥(X, Y ) :=
#{i | Xi 6= Yi }, is called the Hamming Distance on X n .
It is easy to verify that Œ¥ is a metric on X n . If Œ¥(X, Y ) = 1 we call X and Y adjacent.
Since we are focused on infinite dimensional objects, we define Differential Privacy broadly for any
statistical summary. In particular, suppose that f : X n ‚Üí Y represents a summary of X n , and let F be a

2

œÉ-algebra of subsets of Y so that the pair (Y, F ) is a measurable space. From a probabilistic perspective, a
privacy mechanism is a family of probability measures {¬µX : X ‚àà X n } over Y. We can now define what we
mean when we say the mechanism satisfies -DP. While DP was originally introduced in Dwork et al. (2006),
Definition 2.2 is similar to the versions given in Wasserman & Zhou (2010) and Kifer & Lin (2010).
Definition 2.2 (Differential Privacy: Dwork et al., 2006). A privacy mechanism {¬µX : X ‚àà X n } satisfies
-Differential Privacy (-DP) if for all B ‚àà F and adjacent X, X 0 ‚àà X n ,
¬µX (B) ‚â§ ¬µX 0 (B) exp().
From Definition 2.2, we see that, for an -DP mechanism, ¬µX and ¬µX 0 must be equivalent measures (i.e.
they agree on sets of measure zero) if Œ¥(X, X 0 ) = 1. By transitivity, it follows that ¬µX and ¬µY are equivalent
measures for any X, Y ‚àà X n . By the Radon-Nikodym Theorem, we can always therefore interpret DP in
terms of densities with respect to a common base measure, ŒΩ (if needed, one can always take ŒΩ = ¬µX for an
arbitrary X ‚àà X n ).
Proposition 2.3. Let M = {¬µX | X ‚àà X n } be a privacy mechanism over a measurable space (Y, F ). Then
M achieves -DP if and only if there exists a base measure ŒΩ such that ¬µX  ŒΩ for all X ‚àà X n and the
densities {fX : X ‚àà X n } (Radon-Nikodym derivatives) of the ¬µX (with respect to ŒΩ) satisfy
fX (b) ‚â§ fX 0 (b) exp(),
ŒΩ-almost everywhere and for all adjacent X, X 0 ‚àà X n .
Proof. The reverse direction is given in Remark 1 from Hall et al. (2013), though we provide the argument
here again for completeness. Let B ‚àà F and X, X 0 ‚àà X n be adjacent elements. Then
Z
Z
Z
fX 0 (b)
¬µX (B) =
fX (b) dŒΩ(b) =
fX (b) dŒΩ(b) ‚â§
exp()fX 0 (b) dŒΩ(b) = exp()¬µX 0 (b).
B
B fX 0 (b)
B
Going in the other direction we will use a proof by contradiction. Assume that M is an -DP mechanism.
Recall that two measures are equivalent if they agree on the zero sets, thus, as we have said, the measures in a
DP mechanism must all be equivalent. So, we can assume that all of the measures have a density with respect
to some common base measure, ŒΩ, which, without loss of generality, we can take to be one of the elements of
M . Now assume that there exists a set B and some adjacent databases X, X 0 such that fX (b) > fX 0 (b) exp()
for all b ‚àà B and that ŒΩ(B) > 0. Then this would imply the strict inequality
Z
Z
¬µX (B) =
fX (b) dŒΩ(b) > exp()
fX 0 (b) dŒΩ(b) = exp()¬µX 0 (B),
B

B

which is a contradiction, and thus the claim holds.
Interpreting DP in terms of densities is common in the DP literature (e.g. Dwork & Roth, 2014; Kifer
et al., 2012), however, we could not find a reference for the precise statement and proof, especially for the
reverse implication.

3

Exponential Mechanism

One of the earliest mechanisms designed to satisfy -DP, is the exponential mechanism, introduced by
McSherry & Talwar (2007). It uses an objective or utility function, which in practice, can be the same
objective function used for a (non-private) statistical or machine learning analysis, thus making it especially
easy to link DP with existing inferential tools. A simple proof for Proposition 3.1 can be found in McSherry
& Talwar (2007).
Proposition 3.1 (Exponential Mechanism: McSherry & Talwar, 2007). Let (Y, F , ŒΩ) be a measure space.
Let {ŒæX : Y ‚Üí R | X ‚àà X n } be a collection of measurable functions. We say that this collection has a finite
sensitivity ‚àÜŒæ , if
|ŒæX (b) ‚àí ŒæX 0 (b)| ‚â§ ‚àÜŒæ < ‚àû,
3

R
for all adjacent X, X 0 and ŒΩ-almost all b. If Y exp(ŒæX (b)) dŒΩ(b) < ‚àû for all X ‚àà X n , then the collection of
probability measures {¬µX | X ‚àà X n } with densities fX (with respect to ŒΩ) satisfying




fX (b) ‚àù exp
ŒæX (b)
2‚àÜŒæ
satisfies -DP.
We call the set {ŒæX | X ‚àà X n } the Objective Function, used in the exponential mechanism. Note that
0
in Proposition 3.1, if ŒΩ is a finite measure,
R ‚àÜ(Œæ) < ‚àû, and ŒæX (b) is bounded above for all X ‚àà X and
ŒΩ-almost all b, then one immediately has exp(ŒæX (b)) dŒΩ(b) < ‚àû. We will exploit this fact later on as our
base measures in infinite dimensions will actually be taken from Gaussian processes, not from any form of
Lebesgue measure.
The exponential mechanism offers a general approach to building DP mechanisms, and in fact, any DP
mechanism can be expressed as an instantiation of the exponential mechanism, by taking the objective
function to be the log-density of the mechanism (McSherry & Talwar, 2007). We remark that the factor of 2
in the exponential mechanism can sometimes be removed (e.g. location families).
Since the solution to many statistical problems can be expressed as the optimizers of some expression, it
is natural to set the objective function in the exponential mechanism to this expression. Often times, such
expressions can be expressed as empirical risks, such as the MLE/MAP estimate (Wang et al., 2015), principal
component analysis (Chaudhuri et al., 2013), and quantiles of one-dimensional statistics (Smith, 2011).
The following result shows that for objective functions of such forms, the noise added by the exponential
mechanism is asymptotically normal.
Theorem 3.2 (Utility of Exp Mech). Assume the observed record, X1 , . . . , Xn , and corresponding sequence
of objective functions Œæn (b) := ŒæX (b), for b ‚àà Rd satisfy
1. ‚àín‚àí1 Œæn (b) are twice differentiable convex functions and there exists a finite Œ± > 0 such that the
eigenvalues of ‚àín‚àí1 Œæn (b)00 are greater than Œ± for all n and b ‚àà Rd ;
2. the minimizers satisfy bÃÇ ‚Üí b? ‚àà Rd and ‚àín‚àí1 Œæn (bÃÇ)00 ‚Üí Œ£‚àí1 where Œ£ is a p √ó p positive definite matrix;
3. Œæn has finite sensitivity ‚àÜ, which is constant in n.
Assume the base measure has a bounded, differentiable density g(b) which is strictly positive in a neighborhood
of b? . Then the sanitized value bÃÉ drawn from the exponential mechanism with privacy parameter  is
asymptotically normal
 
 
‚àö
2‚àÜ
D
n(bÃÉ ‚àí bÃÇ) ‚Üí Np 0,
Œ£ .

Proof. The density of the exponential mechanism can be expressed as
o
n 
ŒæX (b) g(b),
fX (b) = c‚àí1
n exp
2‚àÜ
‚àö
where cn is the normalizing constant. Define the random variable Z = n(bÃÉ ‚àí bÃÇ), then its density is given by
n 
‚àö
‚àö o
‚àí1/2
fn (z) = c‚àí1
n
g(
bÃÇ
+
z/
n)
exp
Œæ
(
bÃÇ
+
z/
n) .
n
n
2‚àÜ
We now aim to show that, for z fixed, the density converges to a multivariate normal. Using a two term
Taylor expansion, we have by Assumption (2) and (3) that
‚àö
‚àö
0
00
ŒæX (bÃÇ + z/ n) = [ŒæX (bÃÇ) + z > ŒæX
(bÃÇ)/ n + z > ŒæX
(bÃÇ)z/2n] + o(1).
The first term will be absorbed into the constants, since it does not depend on z, while the second
‚àö term is zero for
n large, leaving only the third term to contribute to the form of the density. Obviously |g(bÃÇ+z/ n)‚àíg(b? )| ‚Üí 0,
so the only remaining task is to show that the combined constants behave appropriately. Recall that
o Z
n 
n 
o
‚àö
‚àö
cn n1/2 exp ‚àí
Œæn (bÃÇ) =
g(bÃÇ + z/ n) exp
[Œæn (bÃÇ + z/ n) ‚àí Œæn (bÃÇ)] dz.
2‚àÜ
2‚àÜ
Bn
4

By Assumption (1) we have that
‚àö
Œ±
ŒæX (bÃÇ + z/ n) ‚àí Œæn (bÃÇ) ‚â§ ‚àí kzk2 .
2
Since exp{‚àíkzk2 } is integrable, we can apply the dominated convergence theorem to conclude that the
constants converge to something nonzero as well.
Putting everything together, we can conclude that
n 
o
fn (z) ‚Üí f (z) ‚àù exp ‚àí
z > Œ£‚àí1 z/2 .
2‚àÜ
which, is the density of the multivariate normal. Applying Scheffe‚Äôs Theorem, we thus have both convergence
in distribution as well as convergence in total variation:

‚àö
 
D
n(bÃÉ ‚àí bÃÇ) ‚Üí Np 0,
Œ£ .
2‚àÜ
The previous‚àöresult shows that under common conditions, the noise added by the exponential mechanism
is of order O(1/ n). We know by the theory of M-estimators that the non-private solution to the objective
‚àö
functions bÃÇ also converges
‚àö at rate O(1/ n). So, we have that the use of the exponential mechanisim in such
cases preserves the 1/ n convergence rate, but with a sub-optimal asymptotic variance. This means that
asymptotically, to achieve the same performance as the non-private estimator, the exponential mechanism
requires k times as many samples, where k is some constant larger than 1, which depends on  and ‚àÜ.
However, we know that for many problems, it is possible to construct DP mechanisms which only introduce
O(1/n) noise, thus having equivalent asymptotics to the non-private estimator (e.g. Smith, 2011; Awan &
SlavkovicÃÅ, 2018). Even though in these settings, the noise is asymptotically negligible, developing accurate
approximations is still a challenge, which Wang et al. (2018) recently tackled.
In the next result, we extend Theorem 3.2 from Rp to Hilbert spaces. However, we currently only consider
base measures which are Gaussian processes.
Theorem 3.3 (Utility of Exp Mech). Suppose that the observed record, X1 , . . . , Xn , and objective function
ŒæX (b), for b ‚àà H satisfy
1. ‚àín‚àí1 Œæn (b) are twice differentiable convex functions and there exists a finite Œ± > 0 such that the
eigenvalues of ‚àín‚àí1 Œæn (b)00 are greater than Œ± for all n and b ‚àà H;
2. the minimizers satisfy bÃÇ ‚Üí b? ‚àà H and ‚àín‚àí1 Œæn (bÃÇ)00‚àí1 ‚Üí Œ£ where Œ£ is positive definite trace class
operator (and convergence is wrt this space);
3. Œæn has finite sensitivity ‚àÜ, which is constant in n.
Assume the base measure is taken to be a Gaussian process, ŒΩ ‚àº NH (0, C), such that C ‚àí1 Œ£ is bounded. Then
the sanitized estimate bÃÉ is asymptotically normal



‚àö 
2‚àÜ
D
n bÃÉ ‚àí bÃÇ ‚Üí NH 0,
Œ£ .

Proof. The proof would be essentially the same as before, however when changing variables via standardizing,
the base measure is no longer Lebesgue and thus the effects of rescaling the base measure cannot
‚àö be ignored.
Recall there is no translation invariant œÉ-finite measure in infinite dimensions. Consider Z = n(bÃÉ ‚àí bÃÇ) and
Z
Z
‚àö
‚àö
‚àö
‚àí1/2
P ( n(bÃÉ ‚àí bÃÇ) ‚àà A) =
fX (b) dŒΩ(b) = n
fX (bÃÇ + z/ n) dŒΩ(bÃÇ + z/ n).
‚àö
bÃÇ+A/ n

A

The same Taylor expansion arguments from before
‚àö still apply, however the base measure has now been shifted
and scaled. In particular, if dŒΩÃÉ(z) = dŒΩ(bÃÇ + z/ n), then ŒΩÃÉ is the measure of a Gaussian process with mean
‚àö
‚àí nbÃÇ and covariance operator nC. So, we have that, up to a normalizing constant
Z
Z
nD
E
o
n D
‚àö
 00
 ‚àí1 E o
P ( n(bÃÉ ‚àí bÃÇ) ‚àà A) ‚âà
exp z,
ŒæX (bÃÇ)z /2n dŒΩÃÉ(z) ‚âà
exp ‚àí z,
Œ£ z /2 dŒΩÃÉ(z).
2‚àÜ
2‚àÜ
A
A
5



However, this is a Gaussian measure with covariance operator ( 2‚àÜ
Œ£‚àí1 +C ‚àí1 /n)‚àí1 and mean ‚àín‚àí1/2 ( 2‚àÜ
Œ£‚àí1 +
C ‚àí1 /n)‚àí1 C ‚àí1 bÃÇ. Since C is fixed, the following limits hold

‚àí1
 
2‚àÜ
Œ£‚àí1 + C ‚àí1 /n
Œ£
‚Üí
2‚àÜ

‚àín‚àí1/2

 
‚àí1
Œ£‚àí1 + C ‚àí1 /n
C ‚àí1 bÃÇ ‚Üí 0.
2‚àÜ

Remark 3.4. The requirement that C ‚àí1 Œ£ is bounded implies that the base measure is ‚Äúrougher‚Äù than the
00
asymptotic distribution of bÃÇ. One way to view the assumption on ŒæX
is through tightness. In particular, if
one assumed only that Œ£ was bounded, then the sequence of measures need not be tight and thus one does
not get convergence in the ‚Äústrong topology‚Äù in H (Billingsley, 2013; Chen & White, 1998, Remark 3.3).
However, one could still obtain convergence of properly normalized continuous linear functionals.
Example 3.5. Consider X1 , . . . , Xn ‚àà H are drawn from a Gaussian process with mean ¬µX and covariance
operator CX . Consider estimating ¬µX using the target function
‚àíŒæX (b) =

n
X

kXi ‚àí bk2 .

i=1

Assume that the kXi k ‚â§ 1 and thus we need only consider kbk ‚â§ 1. In that case, the sensitivity is bounded
by 4. However, for this target function the exponential mechanism will not be asymptotically Gaussian (in
the strong topology). If we consider the second derivative we have
00
‚àíŒæX
(b) = 2nI,
00
and thus (‚àíŒæX
(b)/n)‚àí1 = (1/2)I, which is not a nuclear operator in infnite dimensions. However, if instead
we consider the penalized version

‚àíŒæX (b) =

n
X

kXi ‚àí bk2 + nŒªkbk2C ,

i=1

where kbk2C = hb, C ‚àí1 bi, then the sensitivity is the same, but the second derivative is now
00
‚àíŒæX
(b) = 2nI + 2nŒªC ‚àí1 ,

which satisfies the assumptions of Theorem 3.3. In this case, we can now take our Guassian mechanism to be
a mean zero Gaussian process with covariance C.
00
We stress that, in finite samples, there is no issue related to privacy even when ŒæX
(b)‚àí1 is not nuclear
since we are assuming the mechanism is defined using a value probability distribution as the base measure.
What the previous results and this example illustrate is that there is a price to pay for using such a flexible
mechanism. In the ‚Äúgood‚Äù case, when the assumptions of Theorem 3.3 are met, one has an asymptotically
non-negligle noise, but in the ‚Äùbad‚Äù case, the noise can be even larger, since the covariance operator can blow
up.

4

DP Functional Principal Components

In this section, we apply the exponential mechanism to the problem of producing private functional principal
component analysis (FPCA).
Let (H, h¬∑, ¬∑i) be a Hilbert Space. Let X ‚àà Hn be such that its components satisfy kXi k ‚â§ 1 for all
i = 1, . . . , n. Call SÃÇ(X) the k-dimensional subspace of H given by the span of the first k principal components

6

of X. Let PSÃÇ(X) : H ‚Üí H denote the projection operator of H onto SÃÇ(X). We can write PSÃÇ(X) as the solution
to the optimization problem
n
X
PSÃÇ(X) = arg min
kXi ‚àí P Xi k2 ,
(1)
P ‚ààPk

i=1

where Pk is the set of projection operators P : H ‚Üí H of rank k. Equivalently, we can write
PSÃÇ(X) = arg max

P ‚ààPk

n
X

kP Xi k2 .

i=1

More specifically, in this section, we develop a set of probability measures M on Pk , indexed by Hn , which
satisfy -DP, and such that a random element P from ¬µX ‚àà M is ‚Äúclose‚Äù to PSÃÇ(X) .
n
Our approach follows
Pn that of Chaudhuri et al. (2013). We take our objective function to be Œæ : X √óPk ‚Üí R
defined by ŒæX (P ) =P i=1 kP Xi k2 . Note that ‚àÜŒæ = 1, since kP Xi k2 ‚â§ kXi k2 ‚â§ 1 for any P ‚àà Pk and any
n
i = 1, . . . , n. Since i=1 kP Xi k2 ‚â§ n, for any probability measure ŒΩ on Pk , the class of densities on Pk
with respect to ŒΩ given by
!
n
X
2
fX (P ) ‚àù exp
kP Xi k , satisfies -DP.
2 i=1
If H is finite dimensional, then Pk is a compact subset of the space of linear operators (e.g. matrices
when H = Rp ). In that case, there exists a uniform distribution on Pk . In Chaudhuri et al. (2013), they
implement the exponential mechanism as above, with respect to the uniform distribution on Pk .
For arbitrary H, Pk is not compact, so we must find another base measure on Pk . To understand our
proposed construction, we again consider the finite dimensional H. Let P ‚àº Unif(Pk ), that is P is drawn
iid

from the uniform distribution on Pk . Let V1 , . . . , Vk ‚àº N (0, I), be iid multivariate normal with mean zero
d

and identity covariance matrix. Then P = Projection(span(V1 , . . . , Vk )) (since Vk is invariant under rotations).
iid

From this factorization, a natural extension for arbitrary H becomes clear. Let V1 , . . . , Vk ‚àº NH (0, Œ£), be iid
Gaussian processes in H with zero mean and covariance operator Œ£. Note that Œ£ must be positive definite and
trace class, which excludes the identity when H is infinite dimensional (Bogachev, 1998). We can also tailor
Œ£ to instill certain properties such as smoothness or periodicity. Then set P = Projection(span(V1 , . . . , Vk )).
This procedure induces in a probability measure on Pk , which we call ŒΩ.
Theorem 4.1. Let H be a real separable Hilbert Space and Pk the collection of all k-dimensional projection operators over H. Let ŒΩ be the probability measure over Pk induced by the transformation Projection(span(V1 , . . . , Vk )),
where Vi ‚àà H are iid Gaussian process with mean 0 and covariance operator Œ£. Let M be the class of
probability measures on Pk with densities
!
n
X
2
kP Xi k
fX (P ) ‚àù exp
2 i=1
with respect to ŒΩ. Then M satisfies -DP.
Theorem 4.2. Let H be a Hilbert Space, k < n be two positive integers, and M be the class of probability
measures on Hk with densities fX (V1 , . . . , Vk ) proportional to
!
n
X
exp
kProjection(span(V1 , . . . , Vk ))Xi k2
2 i=1
with respect to ŒΩ (the measure induced by the Gaussian distribution N k (0, Œ£)) on Hk . Then M satisfies -DP.
As we see in the next section, we will represent the output of Theorem 4.2 as an arbitrary basis for a
k-dimensional subspace Se of H, which can then be assembled into a projection operator as needed.
Remark 4.3. In many cases we can interpret Œ£ as instilling some particular structure on P or the Vi . For
example, if H = L2 [0, 1], then we could define Œ£ using the kernel of an RKHS. The kernel could then be
chosen so that Se have a certain number of derivatives as many Sobelev spaces are RKHS as well (Berlinet &
Thomas-Agnan, 2011), which is often a natural assumption.
7

Figure 1: Plot of 100 curves generated for the simulation.

5

PCA continued: Sampling

In the previous section, we developed a set of -DP probability measures for arbitrary Hilbert Spaces. However,
for these to be of use to us, we need to be able to sample from these probability distributions. As is common
in FDA (Ramsay & Silverman, 2005; Kokoszka & Reimherr, 2017) we use finite dimensional approximations
via basis expansions for computation.
Let b1 , b2 , . . . be an orthonormal basis for H. We will work in the m-dimensional subspace Hm =
span(b1 , . . . , bm ). Given our observed values Xi ‚àà H, call Xij = hXi , bj i for i = 1, . . . , n and j = 1, . . . , m.
We arrange these real values in an n √ó m matrix X = (Xij ). Next, let Œ£ be a trace class covariance operator
on H. Write Œ£ij = hbi , Œ£bj i for i, j = 1, . . . , m. We put these values in an m √ó m matrix Œ£ = (Œ£ij ), which is
a positive definite matrix in Rm√óm . In this setup, we then draw (V1 , . . . , Vk ) ‚àà Hm . Call Vij = hVi , bj i, and
arrange these values into a real-valued matrix V = (Vij ) We then draw from the density f (V ), with respect
to Lebesgue measure on Rk√óm , which is proportional to


tr(X > XV (V > V )‚àí1 V > ‚àí V > Œ£‚àí1 V )) .
exp
2
In fact, we can obtain a more convenient form for sampling. Since we only need the span of V , we can
condition on the columns of V being orthonormal. The density f (V | orthonormal), with respect to the
uniform measure on the set of orthonormal matrices in Rm√ók , is proportional to

 
exp
tr V > X > X ‚àí Œ£‚àí1 V ,
2
which is an instance of the Matrix-Bingham-Von-Mises distribution, for which an efficient Gibbs sampler is
known (Hoff, 2009; Hoff & Franks, 2018).

6

Numerical Studies

In this section we assess the performance of the exponential mechanism for private FPCA, as developed in
Sections 4 and 5 on both simulated and real data.

6.1

Simulation Study

For our simulation study, we generated data on a grid of 100 evenly spaced points on [0, 1] using the
Karhunen-Loeve expansion with Gaussian noise added:
p
X
1
Xi (tik ) = ¬µ(tik ) +
U u (t ) + Œµik ,
2 ij j ik
j
j=1

for i = 1, . . . , n, k = 1, . . . , 100. The uj (t) are the true functional principal components, Œµik are independent
errors sampled from the Gaussian distribution N (0, 1), and scores Uij are sampled from N (0, 0.1). Note that
for each scenario we re-scale the Xi so that ||Xi ||2 < 1 for i = 1, ..., n.
The uj (t) are comprised of Fourier basis functions and to fully explore the effectiveness of this approach,
we vary the sample size n, privacy budget , and repeat each scenario 10 times. Data is generated using
p = 21 true components and additional weights were placed on the fourth term in the Fourier expansion,
creating the overall shape shown in Figure 1. We release only k = 1 components.
8

(a) Average ratio of variance explained between the (b) Average subspace norm of private principal comprivate and non-private principal components.
ponents.

Figure 2: Average performance measurements in simulation scenarios over sample sizes ranging from n = 100
to 1000. Standard error bars are provided at each point.

(a) One instance of the simulation where n = 500 (b) One instance of the simulation where n = 5000
and  = 1.
and  = 1

Figure 3: Comparisons between the private estimate, non-private estimate, and true first functional principal
component. The last 100 Gibbs updates for the private estimate are provided to demonstrate the variability
of the mechanism.
We also specify m, the number of orthonormal basis functions bi , when restricting the functional
observations to a finite dimensional space and Œ£, a trace class covariance operator on H. It is common to
take m to be some sufficiently large value, usually around 40-50, and for our simulation scenarios we have
m = 40. The choice of Œ£ can vary depending on what structures one may want to induce on the functions
(i.e. the number of derivatives). For our choice of Œ£, we take it to be a diagonal matrix with Œ£ii = i‚àí3 , which
corresponds to requiring that the Vi are continuous. Given that the data is periodic, we chose to use the
Fourier basis functions as bi . Finally, recall there is an efficient Gibbs sampler for this approach Hoff (2009),
which has been implemented in the rstiefel package Hoff & Franks (2018) in R. This also requires a fixed
number of iterations as burn-in prior to starting the procedure. Following the computational experiments in
Chaudhuri et al. (2013), we used 20,000 iterations and had similar convergence results.
We provide two measurements of performance to compare the resulting space of orthogonal projection
operators. The first compares the ratio of variability accounted for between the private and non-private
estimates of the k functional principal components. More explicitly,
0‚â§

||X T PÃÉ X||2F
||X T PÃÇ X||2F

‚â§ 1,

where || ¬∑ ||F is the Frobenius norm, PÃÉ is the projection onto the span of V drawn from the mechanism in
Theorem 4.2, and PÃÇ the the non-private solution to (1).
The second measure gives an indication of how close the range of PÃÉ is to PÃÇ :
0‚â§

1
||PÃÉ ‚àí PÃÇ ||2F ‚â§ k.
2

If the range of PÃÉ and PÃÇ agree in h dimensions and are orthogonal in k ‚àí h dimensions, then this measure
gives the value k ‚àí h. So this can be interpreted as roughly the number of dimensions that PÃÉ and PÃÇ disagree.
We summarize the results in Figures 2a and 2b over a range of sample size n and privacy budget . Note
that, as expected, larger sample sizes can preserve utility (in terms of the two measurements described

9

Table 1: Average performance for private principal components from the Berkeley growth and DTI data sets.
Standard errors are provided in parenthesis for reference.
No. of Components (k)
1
Berkeley

2

3

Variance Ratio

1/8
1/4
1/2
1
2
DTI (cca)

0.264
0.343
0.408
0.550
0.743

(.024)
(.024)
(.025)
(.025)
(.018)

1/8
1/4
1/2
1
2

0.372
0.497
0.726
0.879
0.933

(.025)
(.026)
(.020)
(.009)
(.006)

0.494 (.023)
0.523 (.023)
0.523 (.022)
0.680 (.018)
0.787 (.012)
Variance Ratio
0.569
0.676
0.812
0.885
0.928

(.024)
(.021)
(.014)
(.007)
(.004)

0.672
0.681
0.729
0.775
0.855

(.020)
(.020)
(.019)
(.015)
(.010)

0.727
0.811
0.876
0.910
0.939

(.018)
(.011)
(.009)
(.005)
(.003)

previously) for stricter privacy requirements. Additionally, we provide the sanitized curve for the first principal
component for one instance of a scenario with a sample size of n = 500, and n = 5000, seen in Figures 3a
and 3b. The last 100 Gibbs updates are given as well, demonstrating the variability in each sample size. Note
that even with a privacy budget of  = 1 and relatively low sample size, the overall shape is captured, but the
variance is reduced when n = 5000.

6.2

Applications

For the real data application, we applied our procedure to two data sets, the Berkeley growth study from the
fda package Ramsay et al. (2018), and Diffusion Tensor Imaging (DTI) from the refund package Goldsmith
et al. (2018). The Berkely data has the heights of 93 children at 31 time points with ages ranging from 1-18.
DTI gives fractional anisotropy (FA) tract profiles for the corpus callosum (CCA) the right corticospinal tract
(RCST) for patients with Multiple Sclerosis as well as controls. We focus on the cca data, which includes 382
patients measured at 93 equally spaced locations along the CCA.
Results are summarized in Tables 1 and 2 when releasing 1-3 principal components across a range of
privacy budgets and averaging the performance measurements over 100 repetitions of our procedure. For each
data set we selected the Gaussian kernel for Œ£ with a smoothness parameter that requires m = 5 eigenvalues
to explain >99% of variation. Its corresponding eigenfunctions were selected for the orthonormal basis bi .
Our approach is more effective over the DTI data set, which may be due to the true variation explained by
the non-private components. For DTI the cumulative variation is .77, .86, and .93 for the top 1, 2, and 3
components respectively, while Berkeley has 0.82, 0.95, and 0.98. When things are too ‚Äúsimple‚Äù, necessary
deviations for privacy show more loss in variation explained compared to the non-private estimates. Overall,
this still demonstrates the effectiveness of our procedure under different types of real data with smaller sample
sizes.

7

Discussion

In this paper, we studied the exponential mechanism in the setting of separable Hilbert spaces. We showed
that generally when the objective is an empirical risk function, the exponential mechanism has a CLT implying
that asymptotically non-negligible noise is introduced. Since the exponential mechanism is popularly used,
this result demands the following question: what properties of the objective function guarantee asymptotically
negligible noise?
Through our simulations and applications, we found that the choice of Œ£ can have a significant impact on

10

Table 2: Average performance for private principal components from the Berkeley growth and DTI data sets.
Standard errors are provided in parenthesis for reference.
No. of Components (k)
1
Berkeley

2

3

Subspace Norm

1/8
1/4
1/2
1
2
DTI (cca)

0.776
0.701
0.633
0.484
0.275

(.025)
(.025)
(.027)
(.027)
(.020)

1/8
1/4
1/2
1
2

0.679
0.544
0.296
0.131
0.073

(.026)
(.029)
(.021)
(.010)
(.006)

1.115 (.036)
1.046 (.035)
1.063 (.033)
0.883 (.031)
0.770 (.032)
Subspace Norm
1.098
0.976
0.861
0.770
0.640

(.035)
(.027)
(.027)
(.026)
(.030)

1.100
1.135
1.066
0.962
0.938

(.034)
(.030)
(.030)
(.032)
(.035)

1.074
1.079
0.982
0.940
0.758

(.030)
(.029)
(.030)
(.035)
(.035)

the result of the private FPCA analysis. In particular, Œ£ can be rescaled by any positive constant, which
affects the smoothing but does not change the interpretation in terms of number of derivatives. While our
approach requires that Œ£ is chosen before seeing the data, it would be preferable to have a method of learning
Œ£ within the DP procedure. Future researchers should investigate effective methods of tuning parameters
under DP.
In the data applications, we found that counter-intuitively, our DP FPCA approach performs better when
there is more variability in the data. Perhaps this is because our measures of performance are comparing
the DP estimates to the non-private estimates, and the variability hurts both. It would be worth while
to investigate this further to better understand how variability in the data affects the performance of DP
methods.

Acknowledgments
This research was supported in part by the following grants to Pennsylvania State University: NSF Grant
SES-1534433, NSF Grant DMS-1712826, and NIH Grant 5T32LM012415-03 via the Biomedical Big Data to
Knowledge (B2D2K) Predoctoral Training Program.

References
Alda, F. and Rubinstein, B. I. The bernstein mechanism: Function release under differential privacy. In
AAAI, pp. 1705‚Äì1711, 2017.
Awan, J. and SlavkovicÃÅ, A. Differentially private uniformly most powerful tests for binomial data. In Advances
in Neural Information Processing Systems 31, pp. 4212‚Äì4222. Curran Associates, Inc., 2018.
Awan, J. and SlavkovicÃÅ, A. Structure and sensitivity in differential privacy: Comparing k-norm mechanisms.
ArXiv e-prints, January 2018. Submitted.
Berlinet, A. and Thomas-Agnan, C. Reproducing kernel Hilbert spaces in probability and statistics. Springer
Science & Business Media, 2011.
Billingsley, P. Convergence of probability measures. John Wiley & Sons, 2013.

11

Blum, A., Dwork, C., McSherry, F., and Nissim, K. Practical privacy: the sulq framework. In Proceedings of
the twenty-fourth ACM SIGMOD-SIGACT-SIGART symposium on Principles of database systems, pp.
128‚Äì138. ACM, 2005.
Bogachev, V. I. Gaussian measures. Number 62. American Mathematical Soc., 1998.
Canonne, C. L., Kamath, G., McMillan, A., Smith, A. D., and Ullman, J. The structure of optimal private
tests for simple hypotheses. CoRR, abs/1811.11148, 2018.
Chaudhuri, K. and Monteleoni, C. Privacy-preserving logistic regression. In Koller, D., Schuurmans, D.,
Bengio, Y., and Bottou, L. (eds.), Advances in Neural Information Processing Systems 21, pp. 289‚Äì296.
Curran Associates, Inc., 2009.
Chaudhuri, K., Monteleoni, C., and Sarwate, D. Differentially private empirical risk minimization. In Journal
of Machine Learning Research, volume 12, pp. 1069‚Äì1109, 2011.
Chaudhuri, K., Sarwate, A. D., and Sinha, K. A near-optimal algorithm for differentially-private principal
components. Journal of Machine Learning Research, 14(1):2905‚Äì2943, January 2013. ISSN 1532-4435.
Chen, X. and White, H. Central limit and functional central limit theorems for hilbert-valued dependent
heterogeneous arrays with applications. Econometric Theory, 14(2):260‚Äì284, 1998.
Dwork, C. and Roth, A. The algorithmic foundations of differential privacy. Found. Trends Theor. Comput.
Sci., 9(3&#8211;4):211‚Äì407, August 2014. ISSN 1551-305X. doi: 10.1561/0400000042.
Dwork, C., McSherry, F., Nissim, K., and Smith, A. Calibrating Noise to Sensitivity in Private Data Analysis,
pp. 265‚Äì284. Springer Berlin Heidelberg, Berlin, Heidelberg, 2006. ISBN 978-3-540-32732-5.
Dwork, C., Talwar, K., Thakurta, A., and Zhang, L. Analyze gauss: Optimal bounds for privacy-preserving
principal component analysis. In Proceedings of the Forty-sixth Annual ACM Symposium on Theory
of Computing, STOC ‚Äô14, pp. 11‚Äì20, New York, NY, USA, 2014. ACM. ISBN 978-1-4503-2710-7. doi:
10.1145/2591796.2591883.
Gaboardi, M., Lim, H., Rogers, R., and Vadhan, S. Differentially private chi-squared hypothesis testing:
Goodness of fit and independence testing. In Balcan, M. F. and Weinberger, K. Q. (eds.), Proceedings of
The 33rd International Conference on Machine Learning, volume 48 of Proceedings of Machine Learning
Research, pp. 2111‚Äì2120, New York, New York, USA, 20‚Äì22 Jun 2016. PMLR.
Goldsmith, J., Scheipl, F., Huang, L., Wrobel, J., Gellar, J., Harezlak, J., McLean, M. W., Swihart, B., Xiao,
L., Crainiceanu, C., and Reiss, P. T. refund: Regression with Functional Data, 2018. R package version
0.1-17.
Hall, R., Rinaldo, A., and Wasserman, L. Differential privacy for functions and functional data. Journal of
Machine Learning Research, 14(1):703‚Äì727, February 2013. ISSN 1532-4435.
Hoff, P. and Franks, A. rstiefel: Random Orthonormal Matrix Generation and Optimization on the Stiefel
Manifold, 2018. R package version 0.20.
Hoff, P. D. Simulation of the matrix bingham‚Äìvon mises‚Äìfisher distribution, with applications to multivariate
and relational data. Journal of Computational and Graphical Statistics, 18(2):438‚Äì456, 2009.
Imtiaz, H. and Sarwate, A. D. Symmetric matrix perturbation for differentially-private principal component
analysis. In Acoustics, Speech and Signal Processing (ICASSP), 2016 IEEE International Conference on,
pp. 2339‚Äì2343. IEEE, 2016.
Jiang, X., Ji, Z., Wang, S., Mohammed, N., Cheng, S., and Ohno-Machado, L. Differential-private data
publishing through component analysis. Transactions on data privacy, 6(1):19, 2013.
Karwa, V. and SlavkovicÃÅ, A. Inference using noisy degrees: Differentially private Œ≤-model and synthetic
graphs. The Annals of Statistics, 44(1):87‚Äì112, 02 2016. doi: 10.1214/15-AOS1358.
12

Karwa, V., Krivitsky, P. N., and SlavkovicÃÅ, A. B. Sharing social network data: differentially private estimation
of exponential family randomgraph models. Journal of the Royal Statistical Society: Series C (Applied
Statistics), 66(3):481‚Äì500, 2016. doi: 10.1111/rssc.12185.
Kifer, D. and Lin, B.-R. Towards an axiomatization of statistical privacy and utility. In Proceedings of the
twenty-ninth ACM SIGMOD-SIGACT-SIGART symposium on Principles of database systems, pp. 147‚Äì158.
ACM, 2010.
Kifer, D., Smith, A., and Thakurta, A. Private convex empirical risk minimization and high-dimensional
regression. Journal of Machine Learning Research, 1:1‚Äì41, 01 2012.
Kokoszka, P. and Reimherr, M. Introduction to functional data analysis. CRC Press, 2017.
McSherry, F. and Talwar, K. Mechanism design via differential privacy. In Proceedings of the 48th Annual
IEEE Symposium on Foundations of Computer Science, FOCS ‚Äô07, pp. 94‚Äì103, Washington, DC, USA,
2007. IEEE Computer Society. ISBN 0-7695-3010-9. doi: 10.1109/FOCS.2007.41.
Mirshani, A., Reimherr, M., and Slavkovic, A. On the Existence of Densities for Functional Data and their
Link to Statistical Privacy. ArXiv e-prints, November 2017.
Ramsay, J. and Silverman, B. Functional Data Analysis. Springer, 2005.
Ramsay, J. O., Wickham, H., Graves, S., and Hooker, G. fda: Functional Data Analysis, 2018. R package
version 2.4.8.
Sheffet, O. Differentially private ordinary least squares. In Precup, D. and Teh, Y. W. (eds.), Proceedings of
the 34th International Conference on Machine Learning, volume 70 of Proceedings of Machine Learning
Research, pp. 3105‚Äì3114, International Convention Centre, Sydney, Australia, 06‚Äì11 Aug 2017. PMLR.
Smith, A. Privacy-preserving statistical estimation with optimal convergence rates. In Proceedings of the
Forty-third Annual ACM Symposium on Theory of Computing, STOC ‚Äô11, pp. 813‚Äì822, New York, NY,
USA, 2011. ACM. ISBN 978-1-4503-0691-1. doi: 10.1145/1993636.1993743.
Smith, M., lvarez, M., Zwiessele, M., and Lawrence, N. D. Differentially private regression with gaussian
processes. In Storkey, A. and Perez-Cruz, F. (eds.), Proceedings of the Twenty-First International
Conference on Artificial Intelligence and Statistics, volume 84 of Proceedings of Machine Learning Research,
pp. 1195‚Äì1203, Playa Blanca, Lanzarote, Canary Islands, 09‚Äì11 Apr 2018. PMLR.
Vu, D. and Slavkovic, A. Differential privacy for clinical trial data: Preliminary evaluations. In Proceedings of
the 2009 IEEE International Conference on Data Mining Workshops, ICDMW ‚Äô09, pp. 138‚Äì143, Washington,
DC, USA, 2009. IEEE Computer Society. ISBN 978-0-7695-3902-7. doi: 10.1109/ICDMW.2009.52.
Wang, Y., Kifer, D., Lee, J., and Karwa, V. Statistical approximating distributions under differential privacy.
Journal of Privacy and Confidentiality, 8(1), 2018.
Wang, Y.-X., Fienberg, S. E., and Smola, A. J. Privacy for free: Posterior sampling and stochastic gradient
monte carlo. In Proceedings of the 32nd International Conference on International Conference on Machine
Learning - Volume 37, ICML‚Äô15, pp. 2493‚Äì2502. JMLR.org, 2015.
Wasserman, L. and Zhou, S. A statistical framework for differential privacy. Journal of the American
Statistical Association, 105:489:375‚Äì389, 2010.
Yu, F., Rybar, M., Uhler, C., and Fienberg, S. E. Differentially-private logistic regression for detecting multiplesnp association in gwas databases. In Privacy in Statistical Databases: UNESCO Chair in Data Privacy,
International Conference, PSD 2014, Ibiza, Spain, September 17-19, 2014. Proceedings, pp. 170‚Äì184, Cham,
2014. Springer International Publishing. ISBN 978-3-319-11257-2. doi: 10.1007/978-3-319-11257-2 14.
Zhang, J., Zhang, Z., Xiao, X., Yang, Y., and Winslett, M. Functional mechanism: Regression analysis
under differential privacy. Proc. VLDB Endow., 5(11):1364‚Äì1375, July 2012. ISSN 2150-8097. doi:
10.14778/2350229.2350253.
13

