Verification of a resetting protocol for an uncontrolled superconducting qubit
Ming Gong,1,2,3 Feihu Xu,1,2,3 Zheng-Da Li,1,2,3 Zizhu Wang,4 Yu-Zhe Zhang,1,2,3 Yulin Wu,1,2,3 Shaowei
Li,1,2,3 Youwei Zhao,1,2,3 Shiyu Wang,1,2,3 Chen Zha,1,2,3 Hui Deng,1,2,3 Zhiguang Yan,1,2,3 Hao
Rong,1,2,3 Futian Liang,1,2,3 Jin Lin,1,2,3 Yu Xu,1,2,3 Cheng Guo,1,2,3 Lihua Sun,1,2,3 Anthony D.
Castellano,1,2,3 Cheng-Zhi Peng,1,2,3 Yu-Ao Chen,1,2,3, Xiaobo Zhu,1,2,3,‚àó and Jian-Wei Pan1,2,3
1

arXiv:1911.12536v2 [quant-ph] 27 Dec 2020

4

Hefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics,
University of Science and Technology of China, Hefei 230026, China
2
Shanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics,
University of Science and Technology of China, Shanghai 201315, China
3
Shanghai Research Center for Quantum Sciences, Shanghai 201315, China and
Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610054, China
Quantum resetting protocols allow a quantum system to be sent to a state in the past by making it interact
with quantum probes when neither the free evolution of the system nor the interaction is controlled. We experimentally verify the simplest non-trivial case of a quantum resetting protocol, known as the W4 protocol, with
five superconducting qubits, testing it with different types of free evolutions and target-probe interactions. After
projection, we obtained a reset state fidelity as high as 0.951, and the process fidelity was found to be 0.792. We
also implemented 100 randomly-chosen interactions and demonstrated an average success probability of 0.323
for |1i and 0.292 for |‚àíi, experimentally confirmed the nonzero probability of success for unknown interactions; the numerical simulated values are about 0.3. Our experiment shows that the simplest quantum resetting
protocol can be implemented with current technologies, making such protocols a valuable tool in the eternal
fight against unwanted evolution in quantum systems.

INTRODUCTION

The tug of war between the natural but unknown evolution of a quantum system and control mechanisms to correct error introduced by such evolution is one of the most
important technical challenges in the implementation of reliable quantum computers. Current protocols for removing
unwanted evolution from a quantum system can be broadly
classified into a few families. The widely used refocusing
techniques such as spin echo [1], dynamical decoupling [2‚Äì
4] use fast control pulses to average out the effect of the unwanted evolution, effectively ‚Äúfreezing‚Äù the target system in
time. The universal refocusing technique [5] is similar to refocusing, but has less assumptions on the target-control interaction Hamiltonian. A more recent technique [6] constructs
a universal quantum circuit to probabilistically implement the
exact inverse evolution of some quantum gate when only the
dimension of the target and the number of permitted uses of
the gate are known.
These techniques, however, rely on very different assumptions. None of the (universal) refocusing techniques are exact,
and all of them require some assumptions about the dynamics. Spin echo and dynamical decoupling require the interaction between the target and the control not to be too strong.
While universal refocusing works with stronger interactions,
the trade-off between error  and the number of ‚Äúcontrolled
interactions‚Äù n scales as n = O(log2 (1/)). The protocol
in [6] is exact, with a realistic probability of success which increases exponentially with the number of uses allowed for the

‚àó Corresponding

author. Email: xbzhu16@ustc.edu.cn

gate to be inverted. But it does not directly remove an evolution, since the inverted gate must be subsequently applied to
the target.
A recent protocol, quantum resetting [7], combines some of
the advantages of the existing protocols above:
1. Both the target and the interactions are uncontrolled.
For the protocol to work, no information about the free
evolution of the target or the interaction between the target and probes is needed, as long as these Hamiltonians
are time-independent.
2. The target is reset to a state in the past when the protocol is successful, without the need of doing the exact
inverse of its free evolution.
3. It is probabilistic but exact, with realistic probabilities
of success. For a qubit target and qubit probes, the probability of success is about 20%.
4. Even if the protocol fails, it is possible to ‚Äúundo‚Äù the
failure by using the output of the failed protocol to increase its probability of success.
The mathematical underpinning of the quantum resetting
protocol is very different from the existing protocols above.
Quantum resetting relies on central matrix polynomials [8],
which are polynomials such that when evaluated on arbitrary
n √ó n matrices, the result is always a scalar matrix (i.e. proportional to the identity). In a quantum resetting protocol, the
target system to be reset is allowed to evolve freely for time
t according to some unknown time-independent Hamiltonian
H0 . After the free evolution, the target system interacts
with a probe for time t0 governed by another unknown timeindependent Hamiltonian HI . When the free evolution/probe

2

A

State Preparaon

Q1 |0

H

X

Q2 |0

H

H

Q3 |0

G1

Q4 |0

H

H

Q5 |0

H

X

B

Free Evoluon

Z

-X/2

U
U

R

R

U

U

R

U
U

U

Z

H

C

Ur

=
U

Tomography

U

R

U

Interacon Process

R z(

) Ry(

) R z( )

R z(

) Ry(

) R z(

)

R z(

) Ry(

) R z( )

R z(

) Ry(

) R z(

)

=
X

Z/2

Ur

Figure 1: Description of the quantum resetting protocol. A. The quantum circuit. During state preparation (yellow), the target qubit Q3
is set with the single-qubit gate G1 , and the probe pairs Q1,2 and Q4,5 are prepared in the Bell state |œà ‚àí i. The single qubit gate R is then
applied on the target qubit during the evolution phase (green). The probes are then made to interact with the target, with the bipartite unitary
operator U governing the interaction. We note that the bipartite operation between the next-nearest-neighboring qubits Q1 and Q3 is realized
as the bipartite operation between Q2 and Q3 and then the SWAP operation between Q1 and Q2 (see Method for details), so as the operation
between Q5 and Q3 . Finally, the five-qubit combined state is obtained via quantum state tomography, which is ‚àö
then projected for a successful
reset. B. Realization of a gate sequence for the deterministic interaction operator U = (X ‚äó Z + iY ‚äó X)/ 2. C. Realization of random
unitary interaction. Three single-qubit rotation gates perform an arbitrary rotation, the rotation angles of which are chosen randomly. Each
rotation is applied on target and probe before and after the CZ gate.

interaction cycle is completed for the last probe, the probes
are measured. If the measurement is successful, then the effect of the free evolution/probe interaction is canceled, the
target state has been reset to the past, before the first free
evolution, otherwise the protocol fails. For the W4 protocol,
the target and the probes are all qubits. The probes are prepared as 2 singlet states |Œ®‚àí i = ‚àö12 (|01i ‚àí |10i), and the
measurement is a projection into the subspace S spanned
by {|0000i, |1111i, ‚àö12 (|0011i + |1100i), 12 (|1000i +
|0100i + |0010i + |0001i), 12 (|0111i + |1011i + |1101i +
|1110i), 12 (|1010i + |0101i + |1001i + |0110i)}.
In our experiment, we tested the simplest non-trivial
quantum resetting protocol: a 2D target interacting with four
2D probes, known as the W4 protocol [7]. After being set to
an initial state, the target qubit interacts with each of the four
probes, which form two pairs of entangled states. Then, measurement of the probes affects the target qubit, sending it back
to its initial state with a given probability.

RESULTS

Experimental implementation of the resetting protocol
The general gate sequence of the quantum circuit used to implement the W4 protocol is pictured in Fig. 1A. We divide the
circuit into four parts: state preparation, free evolution, interaction and tomographic readout. Before the circuit begins, all
qubits are initialized in the state |0i. During state preparation, the gate G1 is applied to the target qubit to bring it to
|œà(0)i, and each pair of neighboring probes is set to the sing-

‚àö
. After state preparation, we apply
let state |Œ®‚àí i = |01i‚àí|10i
2
the gate R, which
P simulates the free evolution with Hamiltonian H0 =
hj œÉj , where {œÉj } are the Pauli operators
j=x,y,z

and hj is the coupling strength on the j-axis. After the first
R gate is applied to the target, the interaction process started.
The first probe interacts with the target via a bipartite unitary
operator U , which varies according to the experimental case.
This process of free evolution followed by target-probe interaction is repeated three more times on the target and different
probes. We note that in this experiment, as there is no direct coupling between the next-nearest-neighboring qubits, the
interaction operation between them is realized via the qubit
between them. Take Q1 and Q3 as an example. To apply a
bipartite unitary operator U between them, we first apply U
between Q2 and Q3 , and then apply a SWAP gate between
Q2 and Q1 . Both U and SWAP gates are based on controlledphase (CZ) gate. The SWAP gate is realized as the combination of single-qubit gates and three CZ gates. More details
can be found in Method. Once the interaction process is complete, a five-qubit state tomography is performed to obtain the
final state with density matrix œÅf . A successful reset has occurred in the portion of the state that overlaps with the success
subspace S given above.
Projecting the probe subspace onto this success subspace
post-selects for a successful reset. The trace overlap between
the measured state and the projected state is defined as the
success probability, Ps = Tr(œÅf œÅps ), where œÅps is the density
matrix of the projected state. The reset state of the target qubit
can be extracted from the projected state by tracing out the
probes[9], œÅ = Trprobes (œÅps ), where œÅ is the density matrix of

3

Figure 2: Resetting the target qubit after a free evolution. On the Bloch spheres, the evolution of the states for the three phases are
presented: After state preparation (A, E, I), after free evolution (B, F, J), and after resetting (C, G, K). The resetting protocol is applied when
the free-evolution induced phase is œï = 3œÄ/8. The red dots mark the state before and after a successful reset. The blue dots mark a free
evolution without resetting as a comparison, simulating the results of the time-independent Hamiltonian H0 . As the resetting protocol requires
three more free evolutions, the state without the resetting process is measured till œï = 3œÄ/2. From top to bottom, each row shows a different
version of the resetting protocol in case 1, demonstrated the resetting process for a superposition state |‚àíi, a classical state |1i, and a mixed
state, respectively. In D, H, and L, the trace distance after the application of resetting protocol are observed jumping from 0.557, 0.564, and
0.506, to 0.214, 0.277, and 0.246, respectively.

the reset state. Once the reset state has been obtained, we also
evaluate the quality of the reset state. We use trace distance
to identify the distinguishability between the reset state and
the initial state of the target qubit, i.e., D = 21 Tr|œÅ ‚àí œÅ0 |,
‚àö
where |X| = X ‚Ä† X and œÅ0 = |œà(0)ihœà(0)|. Note that for
the deterministic cases of our experiment, success subspace is
reduced to the space spanned by the first three vectors in S.
This protocol lies on the vanguard of what is currently experimentally feasible. Even for protocols with five qubits, correctly performing a quantum resetting protocol requires extremely high quality single- and double-qubit gates to model
all possible interactions and free evolutions that make up the
protocol. Quantum processors with superconducting qubits,
which have undergone great progress over recent years, have
reached a level of technical achievement that makes it possible to implement of the long sequences of arbitrary operations in a multi-qubit system [10‚Äì28]. In this experiment, we
successfully implemented quantum circuits with up to totally
119 single-qubit gates and 12 entangling gates. The detail of
the 47-layer circuits is shown in Method.
To verify the W4 protocol, we performed different variations of the resetting experiments, which we divide into three
cases (Table ??). Case 1 (Fig. 2) tested interactions with a
theoretical success probability of 1, i.e. deterministic interactions, varying the initial target states and free evolutions.
Case 2 (Fig. 3) fully characterized the resetting process with

six orthogonal initial states for the target. The final case (Fig.
4) tested the success probability for random interactions, and
compared them with the numerical predictions. To characterize the success probability and the target state fidelity, we use
tomographic readout in all cases to obtain the 5-qubit density
matrix, and then project the state in the success subspace.
Test of the resetting protocol with deterministic interactions
First we tested the protocol that the U will deterministically
reset target qubit in theory. To simulate effects from the physical evolution of a qubit, we varied the rotation around different axes, and measured Ps and trace distances. As shown in
Table ??, case 1a and 1c simulated the free evolution Hamiltonian H0 = hz œÉz by applying a rotation gate Rz (œï), corresponding to a rotation around z-axis through an angle œï. In
case 1b the free evolution Hamiltonian was H0 = hx œÉx , rotating instead around the x-axis. Meanwhile, to observe the
effect of free evolution sensitively, the target is initialized to
a state orthogonal to the rotation axis of the free evolution,
which in case 1a and 1c is |‚àíi, and in case 1b is |1i. Furthermore, to test the protocol not only on pure states, but also
on mixed states, case 1c allows the qubit to decohere for 1
¬µs in state preparation. The deterministic unitary depends on
the form of free evolution Hamiltonian, thus was changed accordingly. Fig. 2 illustrates the results of all three subcases for
the rotation angle œï = 3œÄ/8, in which all fidelities of the re-

4

B

-1
|0
|1

0
-0.5
|0

|1

|0

|1

|1

|0

0
-0.5
|0

|1

-1
|0
|1

0
-0.5
|0

|1

|0

|1

0
-1
|0

|1

|0

1

Imag( )

0

0.5

Real( )

1

Imag( )

|1

|0

|1

|0

|1

|0

|1

|0

|1

0.5
0
-0.5
|0

|1

|1

F

E
0
-1
|0
|1

0.5
0
-0.5
|0

|1

|0

Real( )

Imag( )

1

|1

0
-1
|0

|1

|0

1

Imag( )

Real( )

-1

0.5

D

C

Real( )

0
|0

|1

|0

1

Imag( )

0

0.5

Real( )

1

Imag( )

Real( )

A

|1

|0

0.5
0
-0.5
|0

|1

|1

G
1

Real(

)

Imag( )

0.5

0

I

-1

0
-0.5

-1
X

I
Y

Z

I

X

Y

Z

-0.5

0

X

Y

Z
0.5

I

X

Y

Z

1

Figure 3: Quantum state and process
‚àö tomography of a successful reset. The free-evolution Hamiltonian is I, and the deterministic interaction is U = (X ‚äó Z + iY ‚äó X)/ 2. A-F. The density matries of target qubit after resetting with initialization to each axis of the Bloch
sphere: Alphabetically, |0i, |1i, |+i, |ii, |‚àíi and | ‚àí ii. The corresponding state fidelities are 0.946, 0.951, 0.840, 0.815, 0.823, and 0.829,
respectively. G. The œái matrix of the resetting process determined from A-D. The process fidelity is 0.792¬±0.011. Solid lines correspond to
ideal density matrices œÅ and the ideal œái matrix. The 95% confidence intervals are estimated via bootstrapping (see Method for more details).

set states can be seen jumping above those without resetting.
More results verifying the protocol for other rotation angles
are listed in SM.
For case 1, we experimentally proved that the protocol can
successfully reset the target with high fidelity using theoretically predicted deterministic unitaries. The success probabilities are not as high as theoretical prediction: for case 1a,
we obtained Ps = 0.544. The results for case 1b and 1c are
similar (see Supplementary Note 1 and Supplementary Table
1). We attribute this difference to the fidelity of the measured 5-qubit state, which was found to be 0.399 in comparison
with an ideal state. We find the short dephasing time could be
the main reason which limited the fidelity. In our simulation,
if considering the decoherence, the 5-qubit state fidelity will
drop to a similar value 0.386 (See the Method). In context of
these long quantum circuits, trace distances of reset target, as
shown in Fig. 2D,H,L, in the range of 0.21 ‚àí 0.28 really stand
out.
Characterization of the protocol with quantum process
tomography
Once we confirmed that the protocol can reset the target qubit,
we decided to characterize the resetting process more closely.

‚àö
Setting R = I and U = (X ‚äó Z + iY ‚äó X)/ 2 (shown
in Fig. 1B), we initialized the target qubit to the six axes
of the Bloch sphere and performed quantum process tomography. The density matrices œÅ of the reset target obtained
with state tomography has significant variations in fidelity depending on the p
initialization (Figure3A-F). The state fidel‚àö
‚àö
ity is F = |Tr(
œÅf œÅideal œÅf )|2 . The states |0i and |1i
are not sensitive to dephasing, and have higher reset fidelities ‚Äì close to 0.95. But the four other initializations are located on the equator of the Bloch sphere, so they are sensitive
to dephasing and accordingly, have lower fidelites, ranging
from 0.81 ‚àí 0.84. These different initialization are important because they can be used to fully characterize the resetting process. By combining final states |0i, |1i, |+i and |ii,
we can obtain the œá matrix (Fig. 3G) with quantum process
tomography [9]. A completely positive and trace-preserving
(CPTP) projection [29] is used to guarantee a physical estimate of the œá matrix. We define the process fidelity as the trace
overlap between the ideal process œái , which only contains the
identity operation I, and the measured œá, as Fœá = T r(œái œá),
and is determined to be above 0.79. The comparison between
the reset fidelities of phase-sensitive and phase-insensitive initial states shows the important role dephasing plays in our ex-

5

Figure 4: Success probability of random unitaries for different initial states. The random unitaries are realized as Ur shown in Fig. 1C,
where 12 random single-qubit gates are applied before and after a CZ gate. Experimental results are shown in blue; simulated values are in
brown. In the simulation, decoherence effect is considered (see Method). As shown in case 3 of Table. ??, the free-evolution Hamiltonian is I.
In A and B, the initial state is |‚àíi, and in C and D, the initial state is |1i. For these two different initial states, the random unitary sets are also
different. A and C. Success probabilities for each of the 100 random unitaries; inset: the trace distances for each unitary. The experimental
and simulated results are shown in blue and brown bars, respectively. B and D. Cumulative average of success probabilities. The experimental
and simulated results are shown in blue triangles and brown dashed line, respectively.

periment, leaving room for further improvement.
Implementation of the resetting protocol with random
interactions
The most remarkable advantage of this resetting protocol is
that the interaction need not to be controlled or known. Our
interpretation of the word ‚Äòknown‚Äô simply means that the interaction dynamics can not be adjusted according to the free
evolution of the target system. To simulate these sorts of situations, we investigate the effects of random target-probe interactions. Specifically, we tested the success probability of
random unitaries (Ur ), generated by rotating the target qubit
and its interaction probe before and after a CZ gate (Fig.
1C). Each random rotation is implemented as a sequence of
Rz (Œ±i ), Ry (Œ≤i ), and Rz (Œ≥i ) gates, with angles Œ±i , Œ≤i , and Œ≥i
all chosen randomly. As shown in Table ?? case 3, we set
R = I and |œà(0)i = |1i and |‚àíi, respectively, and tested two
sets of 100 different random unitaries. To compare the experimental and theoretical results, we numerically simulated
the circuit with decoherence and calculated the corresponding success probability and state fidelity. Experimental success probabilities for the random unitaries are in good agreement with numerical simulation for both initial states (Fig. 4).
When the results for the random unitaries are combined, the
cumulative average of success probability converges towards
0.323 and 0.292 for these two initial states, which is close to
the simulated value of 0.312 and 0.271, respectively. The dif-

ference of experimental cumulative average comes from limited number of random unitaries. In our simulation, when the
number of random unitaries increases to 5000, the cumulative average of success probability converges toward 0.290 for
both initial states. The experimental average trace distances
are 0.334 and 0.391, respectively. We attribute the poor trace
distances mainly to decoherence, especially dephasing. In our
simulation, after increasing the dephasing time to be the same
as the relaxation time, the average trace distances can be decreased from 0.322 and 0.390, to 0.155 and 0.205, respectively. Similar to our other results, we expect these blemishes
to become less pronounced as the quality of quantum processors is improved.

DISCUSSION

We have successfully verified the quantum resetting protocol for known and unknown interactions. Even when the
interactions are not known, we still have an average success
probability of about 0.3. This probability can be significantly improved by an ‚Äòundoing failure‚Äô protocol presented by
NavascueÃÅs[7]. Upon failure, it is possible to send more probes
to interact with the target, and measure the new probes for
another chance of a successful reset. Although practical difficulties in implementing additional layers of circuit to cor-

6
rect failed resets may outweigh the potential benefits, since
the ‚Äúundoing failure‚Äù protocol may not increase the fidelity of
the reset state.
Another result of NavascueÃÅs [7], is that the resetting protocol can reset a target system of any dimension. In a photonic
system, our colleagues have demonstrated that a qubit can be
reset to its past entangled state[30], and also here we showed
that a mixed state can be reset, giving the experimental verification that the protocol can work on a target qubit which is
a part of higher-dimensional systems. Given the speed of progress with superconducting processors, it is expected that the
realization of resetting higher-dimensional systems is achievable in the near term, opening the door for applications in
quantum memory[31]. It is also notable that even though
the free evolution/target-probe interactions must be unitary,
it is possible to model an open system by purifying the target and the dynamics. Thus, it is possible that quantum resetting with a higher-dimensional target can be used to model
the open dynamics of its lower-dimensional subspace, making
it an interesting alternative to quantum error correction [32].
Even though quantum resetting protocols exist for targets of
any dimension, currently only the ones with qubit and qutrit
targets can be written down explicitly. Another challenge to
implement d-dimensional quantum resetting protocols is the
depth of the circuit, with the number of probes scaling as
O(d3 ), thus requiring extremely good quantum gates and long
coherence time. However, unlike quantum error correction,
quantum resetting protocols do not require a large number of
qubits. To explore this direction, theoretical tools for easily
finding deterministic interactions in higher dimensions are urgently needed. We expect that theoretical and experimental
development of this protocol will have great potential to advance many areas of quantum information processing.

[1] Hahn, E. L. Spin Echoes. Phys. Rev. 80, 580‚Äì594 (1950).
[2] Viola, L., Knill, E. & Lloyd, S. Dynamical Decoupling of Open
Quantum Systems. Phys. Rev. Lett. 82, 2417‚Äì2421 (1999).
[3] Zanardi, P. Symmetrizing evolutions. Phys. Lett. A 258, 77 ‚Äì
82 (1999).
[4] Duan, L.-M. & Guo, G.-C. Suppressing environmental noise in
quantum computation through pulse control. Phys. Lett. A 261,
139 ‚Äì 144 (1999).
[5] Sardharwalla, I. S. B., Cubitt, T. S., Harrow, A. W. & Linden, N.
Universal Refocusing of Systematic Quantum Noise. Preprint at
https://arxiv.org/abs/1602.07963 (2016).
[6] Quintino, M. T., Dong, Q., Shimbo, A., Soeda, A. & Murao,
M. Reversing unknown quantum transformations: Universal
quantum circuit for inverting general unitary operations. Phys.
Rev. Lett. 123, 210502 (2019).
[7] NavascueÃÅs, M. Resetting Uncontrolled Quantum Systems.
Phys. Rev. X 8, 031008 (2018).
[8] Formanek, E. The Polynomial Identities and Invariants of n√ón
Matrices. No. 78 in Regional Conference Series in Mathematics
(American Mathematical Society, 1991).
[9] Nielsen, M. A. & Chuang, I. L. Quantum computation and
quantum information (Cambridge University Press, Cambridge,

2010).
[10] Gong, M., et al. Genuine 12-Qubit Entanglement on a Superconducting Quantum Processor. Phys. Rev. Lett. 122, 110501
(2019).
[11] Roushan, P., et al. Spectroscopic signatures of localization with
interacting photons in superconducting qubits. Science 358,
1175‚Äì1179 (2017).
[12] Chou, K. S., et al. Deterministic teleportation of a quantum gate
between two logical qubits. Nat. 561, 368‚Äì373 (2018).
[13] Hu, L., et al. Demonstration of quantum error correction and
universal gate set on a binomial bosonic logical qubit. Nat.
Phys. 15, 503-508 (2018).
[14] Wu, Y., et al. An efficient and compact switch for quantum
circuits. npj Quantum Inf. 4, 50 (2018).
[15] Xu, K., et al. Emulating Many-Body Localization with a Superconducting Quantum Processor. Phys. Rev. Lett. 120, 050507
(2018).
[16] Kurpiers, P., et al. Deterministic quantum state transfer and
remote entanglement using microwave photons. Nat. 558, 264‚Äì
267 (2018).
[17] Rosenberg, D., et al. 3D integrated superconducting qubits. npj
Quantum Inf. 3, 42 (2017).
[18] Kandala, A., et al. Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets. Nat. 549,
242‚Äì246 (2017).
[19] Song, C., et al. 10-Qubit Entanglement and Parallel Logic Operations with a Superconducting Circuit. Phys. Rev. Lett. 119,
180511 (2017).
[20] Versluis, R., et al. Scalable Quantum Circuit and Control for a
Superconducting Surface Code. Phys. Rev. Appl. 8 (2017).
[21] Ofek, N., et al. Extending the lifetime of a quantum bit with
error correction in superconducting circuits. Nat. 536, 441‚Äì445
(2016).
[22] CoÃÅrcoles, A. D., et al. Demonstration of a quantum error detection code using a square lattice of four superconducting qubits.
Nat. Commun. 6 (2015).
[23] Kelly, J., et al. State preservation by repetitive error detection
in a superconducting quantum circuit. Nat. 519, 66‚Äì69 (2015).
[24] Barends, R., et al. Superconducting quantum circuits at the
surface code threshold for fault tolerance. Nat. 508, 500‚Äì503
(2014).
[25] Reed, M. D., et al. Realization of three-qubit quantum error
correction with superconducting circuits. Nat. 482, 382‚Äì385
(2012).
[26] Yan, Z., et al. Strongly correlated quantum walks with a 12qubit superconducting processor. Science 364, 753-756 (2019).
[27] Arute, F., et al. Quantum Approximate Optimization of
Non-Planar Graph Problems on a Planar Superconducting
Processor. Preprint at http://arxiv.org/abs/2004.
04197 (2020).
[28] Lacroix, N., et al. Improving the Performance of Deep
Quantum Optimization Algorithms with Continuous Gate
Sets. Preprint at http://arxiv.org/abs/2005.05275
(2020).
[29] Knee, G. C., Bolduc, E., Leach, J. & Gauger, E. M.
Quantum process tomography via completely positive and
trace-preserving projection. Phys. Rev. A 98 (2018).
[30] Li, Z.-D., et al. Photonic realization of quantum resetting. Optica 7, 766 (2020).
[31] Terhal, B. M. Quantum error correction for quantum memories.
Rev. Mod. Phys. 87, 307 (2015).
[32] Campbell, E. T., Terhal, B. M. & Vuillot, C. Roads towards
fault-tolerant universal quantum computation. Nat. 549, 172
(2017).

7
[33] Barends, R., et al. Coherent josephson qubit suitable for scalable quantum integrated circuits. Phys. Rev. Lett. 111, 1‚Äì6
(2013).
[34] Koch, J., et al. Charge-insensitive qubit design derived from the
Cooper pair box. Phys. Rev. A 76, 1‚Äì19 (2007).
[35] Gong, M., et al. Experimental verification of five-qubit
quantum error correction with superconducting qubits. Preprint
at https://arxiv.org/abs/1907.04507 (2019).
[36] Steffen, M., et al. Measurement of the entanglement of two superconducting qubits via state tomography. Science 313, 1423‚Äì
1425 (2006).
[37] Zheng, Y., et al. Solving Systems of Linear Equations with
a Superconducting Quantum Processor. Phys. Rev. Lett. 118,
210504 (2017).
[38] Dicarlo, L., et al. Demonstration of two-qubit algorithms with a
superconducting quantum processor. Nat. 460, 240‚Äì244 (2009).
[39] Martinis, J. M. & Geller, M. R. Fast adiabatic qubit gates using
only œÉz control. Phys. Rev. A 90, 022307 (2014).
[40] Kelly, J., et al. Optimal quantum control using randomized
benchmarking. Phys. Rev. Lett. 112, 240504 (2014).
[41] Neill, C., et al. A blueprint for demonstrating quantum supremacy with superconducting qubits. Science 360, 195‚Äì199 (2018).
[42] Johnson, B. R. Controlling Photons in Superconducting Electrical Circuits. (Yale University, 2011).
[43] Gustavsson, S., et al. Dynamical decoupling and dephasing in
interacting two-level systems. Phys. Rev. Lett. 109, 1‚Äì5 (2012).
[44] Martinis, J. M., Nam, S., Aumentado, J., Lang, K. M. & Urbina,
C. Decoherence of a superconducting qubit due to bias noise.
Phys. Rev. B 67, 94510 (2003).
[45] Vion, D., et al. Rabi oscillations, Ramsey fringes and spin
echoes in an electrical circuit. Fortschritte der Phys. 51, 462‚Äì
468 (2003).

METHOD

Experimental wiring setup and device
The superconducting processor used in this work is a 12qubits processor[10, 26], as shown in Fig. 5. The twelve
qubits are arranged in a 1-D lattice. Each qubit is an Xmon
variant [33] of transmon qubit [34]. The qubits couple to their
nearest-neighbor qubits via a fixed capacitor, inducing a constant coupling strength around 11.5 MHz. For each qubit,
there are one inductively coupled flux control line and one capacitively coupled microwave control line to enable the fully
control of the quantum state. After the control operations, we
simultaneously read out the state of all qubits via their dispersively coupled resonators. We chose five adjacent qubits
[35] to perform the present experiment, labeled as Q1 to Q5
in Fig. 5. The device is mounted under the mixing chamber
plate of a dilution refrigerator, for which the base temperature
is below 12 mK. The experimental wiring setup from room
temperature to low temperature is shown in Fig. 5, too. Table.
?? shows the performance of the qubits in our experiment.
Gate implementation
Only single-qubit gates and controlled-phase (CZ) gates are
used in our experiment. Single-qubit gates are implemented as
microwave pulses. We realize CZ gates by implementing DC
wave sequences on two neighbouring qubits to tune the |11i

state close to the avoided crossing generated by the states |11i
and |02i following a ‚Äùfast adiabatic‚Äù trajectory [24, 38‚Äì40].
CZ gates can only be implemented on neighbouring qubits,
so to generate interactions between distant qubits, a SWAP
gate is required. For example, to generate an interaction
between Q1 and Q3 , we first apply U between Q2 and Q3
and then apply a SWAP gate between Q2 and Q1 . Likewise with Q5 and Q3 . The SWAP gate is realized by combining single-qubit gates and CZ gates as SW AP = (I ‚äó
‚àíY /2)CZ(‚àíY /2 ‚äó Y /2)CZ(Y /2 ‚äó ‚àíY /2)CZ(I ‚äó Y /2)
[24], where Y /2 (‚àíY /2) is Ry (œÄ/2) (Ry (‚àíœÄ/2)), representing the rotation by an angle œÄ/2 (‚àíœÄ/2) about the y axis.
The total depth of the sequences for the implementation of
case 1a and 2 in the main text is 39, including 12 double-qubitgate layers and 27 single-qubit-gate layers. For case 1b and
case 3 in the main text, the total depths are 47, both including
12 double-qubit-gate layers and 35 single-qubit-gate layers.
An example of the gate sequences for case 3 is shown in Fig.
6.
Gate optimization
Calibrations and optimizations is a necessary step to successfully realize the theoretical circuits. Cross-talk on the Z
control line [26] is a source of error that needs to be firstly addressed. When CZ gate is applied, because of the 1% ‚àí 2% Z
cross-talk, it induces a frequency shift on other qubits, and
leads unwanted dynamical phases. We correct these phase
shifts by adding corresponding phase gates to each of them.
Meanwhile, CZ gates must be applied in while all other qubits
are idling. Secondly, due to the finite bandwidth and imperfection of the impedance matching in the route from the DAC
channels to the qubit control lines, there is a pulse distortion
after an applied pulse [26, 40‚Äì42]. We use the deconvolution
method to correct this kind of pulse distortion[26, 42]. Last,
to mitigate the effects of dephasing, which produce more errors than energy relaxation in our experiment, we apply Hahn
spin echoes [1, 24, 43‚Äì45] to idling elements of the circuit.
Numerical simulation with decoherence
In order to evaluate the impact of decoherence, we use
operator-sum representations to simulate the evolution of the
system with the relaxation and the dephasing. In this method,
we replace ideal matrices of quantum gates by Kraus operators with decoherence. Thus, the evolution of the system to
which the quantum gate G is applied can be written as[9]:
X
Œµ(œÅ) =
Ek GœÅG‚Ä† Ek‚Ä†
(1)
k

where G is the ideal matrix of the quantum gate, and Ek is
the operation elements for the decoherence. In this way, we
can get the theoretical end states with decoherence after the
designed circuits.
As for the specific matrix form of the operation elements,
the operation elements are different for different kinds of decoherence. For the relaxation, the operation elements are

 ‚àö 

0 Œ≥
1 ‚àö 0
E2 =
(2)
E1 =
0 0
0 1‚àíŒ≥

8
20mK

300K
4K
Readout in
Readout out
JPA DC
JPA pump

Readout
DAC

ADC
MW

Q1 Q2 Q3 Q4 Q5

DC
MW

‚Ä¶‚Ä¶

Qubit control
DAC

‚Ä¶‚Ä¶

XY

MW
DC

DC

DAC

Z

MW
ADC
DAC
DC

CuNi coaxial cable
NbTi coaxial cable
Room-temperature coaxial cable
Low-temperature coaxial cable
HEMT
Room-temperature low noise ampliÔ¨Åer
Josephson parametric ampliÔ¨Åer
0 dB a¬Åenuator
10 dB a¬Åenuator
20 dB a¬Åenuator
RC Ô¨Ålter
8 GHz low pass Ô¨Ålter
18 GHz low pass Ô¨Ålter
500 MHz low pass Ô¨Ålter
80 MHz low pass Ô¨Ålter
Circulator
Bias Tee
Power divider
IQ mixer
Microwave source
Analog-digital converter
Digital-analog converter
DC source

Figure 5: Experimental wiring setup and false colored optical image of the qubit device. There are five adjacent qubits used in this
experiment. To perform the state manipulation and detection, five sets of qubit control and one set of readout units are used. For the control of
each qubit, there are one microwave (XY) control and one flux bias. We use two digital-analog converter (DAC) channels and one microwave
source to modulate the control signal via an IQ mixer. The XY signal is then wire-bonded to the XY control line, which is capacitively coupled
to the qubit. The low speed and high speed bias (Z) signal is generated by a DC source and a DAC channel, and then combined together at
the mixing chamber (MXC) plate via a bias-Tee. The Z signal is also wire-bonded to the Z control line, which is inductively coupled to the
qubit. For state detection, the readout signal is modulated by two DAC channels and one microwave source via an IQ mixer. The signal is
attenuated for 60 dB and then connected to the transmission line of the device. Then, the readout signal goes to the array of circulators. On
the second circulator, the signal is amplified by the Josephson parametric amplifier (JPA), which is biased by the DC source and driven by the
microwave source. The readout signal is then amplified by a HEMT at the 4K plate and a low-noise amplifier at room temperature, and finally
demodulated by an IQ mixer and captured by the analog-digital converter (ADC). We use frequency multiplexing method to simultaneously
readout the states of all qubits. All room temperature electronic instruments are controlled by a computer via 1Gb Ethernet.

|0

H

X

Q2

|0

H

H

Q3

|0

X

Q4

|0

H

H

Q5

|0

H

X

Z

4

5

1

Q1

2

3

Y/2

Z

X

X

Ry ( 1 )

Rz ( 1 )

Rz ( 3 ) Ry ( 3 )

Rz ( 3 )

-Y/2

Y/2

Rz ( 2 )

Ry ( 2 )

Rz ( 2 )

Rz ( 4 ) Ry ( 4 )

Rz ( 4 )

X

X
X

6

X

X

X

X

X

X

7

8

X

9

-Y/2

Q3

X

Q4

X

X

X

X

Q5

X

X

X

X

17

18

10

Y/2

Rz ( 1 )

Rz ( 3 ) Ry ( 3 )

Rz ( 3 )

X

Rz ( 2 ) Ry ( 2 )

Rz ( 2 )

Rz ( 4 ) Ry ( 4 )

Rz ( 4 )

20

21

22

23

24

25

26

X

X

X

X

X

X

Q2

X

X

X

X

X

X

X

X

X

X

Q 4 Ry ( 3 ) Rz ( 3 )
Q5

X

32

-Y/2
-Y/2

33

34

Y/2

Y/2

35

36

-Y/2

37

38

40

X

14

15

X
Rz ( 2 ) Ry ( 2 )

Rz ( 2 )

Rz ( 4 )

Rz ( 1 ) Ry ( 1 )

Rz ( 1 )

Rz ( 3 )

27

28

29

30

31

X
X

Rz ( 2 )

Ry ( 2 )

Rz ( 2 )

Rz ( 4 ) Ry ( 4 )

Rz ( 4 )

Rz ( 1 )

Ry ( 1 )

Rz ( 1 )

Rz ( 3 ) Ry ( 3 )

Rz ( 3 )

41

42

Y/2

39

13

X

Q1

Q 3 Ry ( 4 ) Rz ( 4 )

12

X

Rz ( 1 ) Ry ( 1 )

19

11

X

Q2

16

-Y/2

Rz ( 1 )

X

Measurement

Q1

X

43

44

45

46

47

Circuit Layer

Figure 6: Gate sequences for the test of random unitaries. The initial state of the target qubit is |1i. The total depth is 47, including 12
double-qubit gates and 119 single-qubit gates.

9
where Œ≥ is the probability of losing a exciton and is equals to
the ratio of the gate time to the relaxation time T1 in simulation. In addition, the operation elements for the dephasing
are




1 p 0
0 0
(3)
E4 =
E3 =
‚àö
0 Œ≥œÜ
1 ‚àí Œ≥œÜ
0
where Œ≥œÜ is the probability that the exciton has been scattered
and is equals to the ratio of the gate time to the dephasing
time TœÜ in simulation. Considering both relaxation and dephasing at the same time, we combine these operation elements
like E10 = E1 E3 , E20 = E1 E4 , E30 = E2 E3 , E40 = E2 E4 .
With these specific matrix form of the operation elements and
operator-sum representations, we can simulate the evolution
of the system and numerically get the states with decoherence.
Quantum process tomography and bootstrapping
In our experiment, the quantum process tomography (QPT)
is used to identify the resetting process. In particular, we
prepared the target qubit in different initial states: |0i, |1i,
|+i/|‚àíi, and | + ii/| ‚àí ii. At the end of the resetting protocol, we performed the quantum state tomography (QST) of
the five-qubit system. The physical density matrices are then
constructed via completely positive (CP) projection. After
that, the successfully reset state is obtained by projecting the
five-qubit density matrices into the success subspace S. The
density matrices of the target qubit after successful projection
are then obtained by tracing out the probe qubits. With the
density matrices started with four different initial states, the
superoperator œá matrix is contracted. A completely positive
and trace-preserving projection [29] is used to ensure a physical estimation of the œá matrix.
We use bootstrapping technique to estimate the error bar in
QPT. Based on the experimentally obtained five-qubit density
matrices, we numerically sampled 200 sets of QST data with
each initial states. In sampling the QST data, for each components of the measurement operators, we sampled 10,000
times and obtained the averaged population histograms. We
used the sampled QST data to construct 200 sets of œá matrices,
and the error bar is determined as the 1.96 times of the standard deviation of the process fidelities.

m9.figshare.12715493.

CODE AVAILABILITY

The code for numerical simulations and analyzing the data
of this experiment is also available on Figshare, see https:
//doi.org/10.6084/m9.figshare.12715493.
ACKNOWLEDGEMENTS

The authors thank the USTC Center for Micro- and Nanoscale Research and Fabrication, Institute of Physics CAS and
National Center for Nanoscience and Technology for supporting the sample fabrication. The authors also thank QuantumCTek Co., Ltd. for supporting the fabrication and the maintenance of room temperature electronics. This research was supported by the National Key R&D Program of China (Grants
No. 2017YFA0304300, No. 2018YFA0306703), the Chinese
Academy of Sciences, and Shanghai Municipal Science and
Technology Major Project (Grant No.2019SHZDZX01). This
research was also supported by NSFC (Grants No. 11574380,
No. 11905217) and Anhui Initiative in Quantum Information
Technologies.

AUTHOR CONTRIBUTIONS

X.-B. Zhu, Y.-A. Chen and J.-W. Pan conceived the research. M. Gong, F.-H. Xu, Z.-D. Li, Z.-Z. Wang and X.B. Zhu designed the experiment. S.-Y. Wang designed the
sample. H. Deng, Z.-G. Yan and H. Rong prepared the
sample. M. Gong, Y.-L. Wu, and S.-W. Li carried out the
measurements. Y.-L. Wu developed the programming platform for measurements. Z.-D. Li, M. Gong, C. Zha, Y.-W.
Zhao, and Y.-Z. Zhang did numerical simulations. M. Gong,
Z.-D. Li, Z.-Z. Wang and C. Zha analyzed the results. F.T. Liang, J. Lin, Y. Xu, C. Guo, L.-H. Sun and C.-Z. Peng
developed room temperature electronics equipments. All authors contributed to discussions of the results and development of manuscript. X.-B. Zhu and J.-W. Pan supervised the
whole project.

DATA AVAILABILITY
COMPETING INTERESTS

The experimental data for this experiment is available on Figshare, see https://doi.org/10.6084/

The authors declare that there are no competing interests.

