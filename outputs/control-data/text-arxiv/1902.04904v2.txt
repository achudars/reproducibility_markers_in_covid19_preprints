TOWER POWER FOR S-ADICS

arXiv:1902.04904v2 [math.DS] 11 Mar 2020

NICOLAS BÉDARIDE, ARNAUD HILION, AND MARTIN LUSTIG
Abstract. We explain and restate the results from our recent paper [2] in standard language
for substitutions and S-adic systems in symbolic dynamics. We then produce as rather direct
application an S-adic system (with finite set of substitutions S on d letters) that is minimal and
has d distinct ergodic probability measures.
As second application we exhibit a formula that allows an efficient practical computation of
the cylinder measure µprwsq, for any word w P A˚ and any invariant measure µ on the subshift
Xσ defined by any everywhere growing but not necessarily primitive or irreducible substitution
σ : A˚ Ñ A˚ . Several examples are considered in detail, and model computations are presented.

1. Introduction
Symbolic dynamics has undergone in the past 20-30 years a sequence of several fundamental
changes in what people considered the most promising tool to investigate symbolic dynamical
systems and their invariant measures. After first having developed the technology of KakutaniRokhlin towers, Bratteli diagrams with Vershik maps were recognized as (in many situations) more
promising. More recently S-adic systems have moved into the lime light.
The authors of this note have very recently made public an exposition [2] of yet another technology, which we believe to be perhaps easier to learn and in some situations more efficient to apply
than the previously existing ones. It also seems to have in many situations the potential for further
reaching results.
While writing the paper [2] the authors also had in mind future applications to geometric group
theory, most notably to currents on free groups FN and to the action of the automorphism group
OutpFN q on current space. Since in this world it is natural to admit at all times inverses to the
letters that generate the system, the paper [2] was written for graphs and graph maps rather than
for monoids and substitutions, which makes our results less accessible for somebody working in the
traditional settings of symbolic dynamics.
Hence a translation into the classical terminology of symbolic dynamics seemed to be called for,
and it is provided here (see section 3). Instead of a proof (which is a direct consequence of the main
result of [2], together with the translation dictionary given in section 3 of [2]), we proceed here
to present two applications of our new technology. Both are new results (to our knowledge), but
what is almost more important to the authors is to convince the reader about the relatively small
effort by which they are derived from the results of [2]: We thus would like to point the symbolic
dynamics community’s attention to this new technology, which we believe might be useful also for
other people working in this area.
We now give a brief description of the results of this paper:
Let A be a finite alphabet of cardinality d ě 1, and let X be a subshift over A. Assume
that X possesses an S-adic expansion over A (see section 2), where S is a possibly infinite set of
substitutions σn : A˚ Ñ A˚ , then it is well known that X supports at most d distinct ergodic
2010 Mathematics Subject Classification. Primary 37B10, Secondary 37A25, 37E25.
Key words and phrases. S-adic expansion, non-uniquely ergodic subshift, substitution, cylinder weights.
1

probability measures. Our first result, presented in section 4, concerns the realization of this bound
and can be stated as follows:
Proposition 1.1. (1) For any integer d ě 1 there exists a directive sequence σ “ σ0 ˝ σ1 ˝ . . ., with
level alphabets An all of cardinality d, such that the associated subshift Xσ is minimal and supports
d distinct invariant ergodic probability measures.
(2) There is a finite set S (consisting of 4 substitutions) such that the above substitutions σ0 , σ1 , . . .
can all be chosen from S.
This realization result contrasts in part (1) with the well-known upper bound t d2 u for the number
of ergodic probability measures (see [9, 10]), in the case where Xσ is read off from an interval
exchange transformation. Part (2) seems to contradict at first glance known results from BratteliVershik theory, see Remark 4.6 below. We would also like to mention that Proposition 1.1 is
preceded in the literature by several related results, see for instance [1], [4] and [8].
Our second result concerns the concrete calculation of the measure of any cylinder rws with
w P A˚ , for an arbitrary subshift X over A “ ta1 , . . . , ad u. If X is uniquely ergodic, the question
is unambiguous, but in general one needs to specify the measure µ in question. The main result of
[2] as stated here in Theorem 3.2 presents a tool for such a specification in rather practical terms,
so that a direct calculation (with controlled error term) is possible, once an everywhere growing
S-adic expansion of X is chosen (see Corollary 3.6).
In section 5 we concentrate on the special case of a substitution subshift X “ Xσ for any
everywhere growing (but not necessarily primitive or irreducible) substitution σ : A˚ Ñ A˚ . It is
known (see Proposition 3.4) that the ergodic measures µi on Xσ are in 1-1 correspondence with
certain “distinguished” eigenvectors ~vi ě ~0 with eigenvalues λi ą 1 of the incidence matrix Mσ .
Our determination of the cylinder measures is based on a natural extension of the incidence matrix
Mσ to a pd2 ` dq ˆ pd2 ` dq-matrix Mσ` (for d “ cardA), and on corresponding prolongations of the
eigenvectors ~vi to eigenvectors ~vi` , as well as on “occurrence vectors” ~vn pwq obtained from counting
the occurrences of w as factor in the words σ n pai q and σ n pai aj q. The precise terms of the following
proposition are explained below in section 5; it should be noted though that both, ~vn pwq and the
~vi` , can be readily computed from σ and w, and also the lower bound “pσ, wq-large” used below.
ř
Proposition 1.2. Let σ : A˚ Ñ A˚ be an everywhere growing substitution, and let µ “ ci µi be
any invariant measure on the substitution subshift Xσ , expressed as non-negative linear combination
of ergodic measures µi .
Then for any w P A˚ and any pσ, wq-large integer n P N the measure of the cylinder rws is given
by the scalar product
ÿ 1
µprwsq “ x ~vn pwq,
ci n ~vi` y
λi
Several examples where the formula from Proposition 1.2 is applied to calculate the value of
concretely given cylinders are given at the end of the paper in section 6.

Acknowledgements: The authors would like to thank Julien Cassaigne and Pascal Hubert for useful
comments, as well as our marseillan symbolic dynamics community for its inspiring atmosphere.
We would also like to thank the referee for his careful reading of the first version, and for having
encouraged us to include Remark 4.6.
2. Preliminaries
In this section we only review standard definitions and facts, and we set up the notation used
in this paper. We use [3] as standard reference; indeed, we try to use as much as possible their
terminology and notations.
2

2.1. Subshifts.
Let A “ ta1 , . . . , ad u be a finite set, called alphabet. We denote by A˚ the free monoid over A.
For any element w P A˚ we denote by |w| the length of w as word in the alphabet A. For any any
two words v, w P A˚ we write |w|v for the number of occurrences of v as factor of w.
We denote by
ΣA “ t. . . x´1 x0 x1 x2 . . . | xi P Au
be the set of biinfinite words in A, called the full shift over A. For any word w “ w1 . . . ws P A˚
the cylinder
rws Ď ΣA

is the set of all biinfinite words . . . x´1 x0 x1 x2 . . . in A which satisfy x1 “ w1 , . . . , xs “ ws . The
full shift ΣA , being in bijection with the set AZ , is naturally equipped with the product topology,
where A is given the discrete topology. For any w P A˚ the cylinder rws is closed and open. The
full shift ΣA is compact, and indeed it is a Cantor set.
The shift map S : ΣA Ñ ΣA is defined for x “ . . . x´1 x0 x1 x2 . . . by Spxq “ . . . y´1 y0 y1 y2 . . .,
with yn “ xn`1 for all n P Z. It is bijective and continuous with respect to the above product
topology, and hence a homeomorphism.
A subshift is a non-empty closed subset X of ΣA which is invariant under the shift map S. Such
a subshift X is called minimal if it is the closure of the shift-orbit of any x P X.
Let µ be a finite Borel measure supported on a subshift X Ď ΣA . The measure is called invariant
if for every measurable set A Ď X one has µpS ´1 pAqq “ µpAq. Such a measure µ is ergodic if µ
can not be written in any non-trivial way as sum µ1 ` µ2 of two invariant measures µ1 and µ2 (i.e.
µ1 ‰ 0 ‰ µ2 and µ1 ‰ λµ2 for any λ P ř
Rą0 ). An invariant measure is called a probability measure
µprai sq “ 1. We denote by MpXq the set of invariant
if µpXq “ 1, which is equivalent to
ai PA

measures on X, and by M1 pXq Ď MpXq the subset of probability measures.
The set MpXq is naturally equipped with an addition and an external multiplication with scalars
λ P Rě0 . It is well known (see [11]) that any invariant measure µ is determined by the values µprwsq
for all w P A˚ . Hence the set MpXq is a convex linear cone which through µ ÞÑ pµprwsqwPA˚ is
˚
naturally embedded into the non-negative cone of the infinite dimensional vector space RA . The
cone MpXq is closed, and the extremal vectors of MpXq are in 1-1 relation with the ergodic
measures on X. Furthermore, M1 pXq is compact, and it is the closed convex hull of its extremal
points. The following is well known (see [11]):
Proposition 2.1. For any subshift X Ď ΣA any family of ergodic measures µi P MpXq, which are
pairwise not scalar multiples of each other, is linearly independent.
In particular, if X admits (up to scalar multiples) only finitely many ergodic measures, then
M1 pXq is a finite simplex with vertices that are in 1 - 1 correspondence with the ergodic probability
measures on X.
\
[
It is well known that for any subshift X Ď ΣA the set MpXq of invariant measures is not empty.
If M1 pXq consists of a single point (which then must be ergodic), then X is called uniquely ergodic.
2.2. Substitutions.
Definition 2.2. (1) A substitution σ is given by a map
A Ñ A˚ , ai ÞÑ σpai q .

A substitution defines both, an endomorphism of A˚ , and a continuous map from ΣA to itself which
maps rws to rσpwqs. Both of these maps are also denoted by σ, and both are summarized under
the name of “substitution”.
3

(2) If A and A1 are two possibly distinct alphabets, then any monoid homomorphism σ : A˚ Ñ A1˚
is also called a substitution, with the analogous convention for the induced map on ΣA .
A substitution σ : A˚ Ñ A˚ is called everywhere growing if each ai P A satisfies |σ n pai q| Ñ 8
for n Ñ 8.
For any substitution σ we define the associated language Lσ Ď A˚ to be the set of factors of the
words σ n pai q, with n ě 1 and ai P A.
One defines the subshift Xσ Ď ΣA associated to the substitution σ as the set of all x “
. . . xk´1 xk xk`1 ¨ ¨ ¨ P ΣA with the property that for any integers m ě n the word xn . . . xm is
an element of Lσ .
For any substitution σ : A˚ Ñ A1˚ the non-negative matrix
Mσ :“ p|σpaq|a1 qa1 PA1 , a PA

is called the incidence matrix for the substitution σ (to be specific: a1 gives the row index, while a
gives the column index of Mσ ). The substitution σ is called primitive if Mσ is primitive, i.e. there
exists an integer k ě 1 such that every coefficient of the power Mσk is positive.
2.3. S-adic sequences.
In S-adic theory (see for instance [3, 7]) one considers directive sequences of free monoids A˚n
and of monoid morphisms σn : A˚n`1 Ñ A˚n (for n ě 0). The substitutions σn belong to a given set
S, which in many circumstances is assumed to be finite.
We sometimes call An the level alphabets, and A0 the base alphabet of the directive sequence σ.
We also use the notation σrm,nq “ σm ˝ σm`1 ˝ σm`2 ˝ ¨ ¨ ¨ ˝ σn for any n ě m ě 0. The directive
sequence σ is often represented by writing:
σ “ σ0 ˝ σ1 ˝ . . .
To any such a directive sequence σ one associates the language Lσ Ď A˚0 , defined as the set of
factors in A˚0 of the words σ0 ˝ σ1 ˝ . . . ˝ σn pai q, for any n ě 0 and any ai P An`1 . The subshift
Xσ Ď ΣA0 associated to the directive sequence σ is the set of all x “ . . . xk´1 xk xk`1 ¨ ¨ ¨ P ΣA0 such
that for any two integers m ě n the word xn . . . xm is an element of Lσ . The directive sequence
σ “ σ0 ˝ σ1 ˝ . . . is called an S-adic expansion of a subshift X if X “ Xσ and if S is a set of
substitutions which contains every σi that occurs in σ.
The directive sequence σ is called everywhere growing if one has
min |σr0,nq pai q| Ñ 8

ai PAn

for

n Ñ 8.

One says that σ is weakly primitive (or simply primitive by some authors) if for any m ě 1 there
is an integer n ě m ` 1 such the incidence matrix Mσrm,nq is positive. In this case it follows that σ
is everywhere growing (unless all level alphabets have cardinality 1).
This terminology coincides with that for substitutions introduced in subsection 2.1: indeed, one
recovers the latter as special case of a stationary S-adic sequence, i.e. all terms σn in the directive
sequence σ are equal.
Proposition 2.3 ([3]). For any weakly primitive directive sequence σ the subshift Xσ is minimal.
Furthermore, any minimal subshift X admits an S-adic expansion that is weakly primitive.
\
[
If the directive sequence σ in the last proposition is stationary (or “strongly minimal”, see
Definition 5.1 of [3]), then one can deduce furthermore that Xσ is uniquely ergodic.
The hypothesis that our directive sequence σ is everywhere growing is crucial to everything done
in [2]; it will always be assumed. Fortunately this is not really a restriction, as is shown by the
following elementary fact (see Proposition 5.10 of [2]):
4

Lemma 2.4. Let A be a finite alphabet, and let X Ď ΣA be an arbitrary subshift. Then there exists
an everywhere growing directive sequence σ with base alphabet A0 “ A such that X “ Xσ .
\
[
The following seems to be well known (see [3], Remark 5 and [6]); a proof is provided through
Corollary 2.11 of [2]:
Fact 2.5. (1) For any directive sequence σ, where all level alphabets An are equal to some fixed
alphabet A of cardinality d ě 1, the number of distinct ergodic probability measures carried by the
associated subshift Xσ Ď ΣA is bounded above by d.
(2) In particular, the subset M1 pXσ q of probability measures on Xσ is a simplex of dimension
dim M1 pXσ q ď d ´ 1.
\
[
3. Results from [2]
3.1. The general setting.
Throughout this section we assume that σ “ σ0 ˝σ1 ˝σ2 ˝¨ ¨ ¨ is a directive sequence of substitutions
σn : A˚n`1 Ñ A˚n as set up in the previous section. We also use the notation σrm,nq “ σm ˝ σm`1 ˝
σm`2 ˝¨ ¨ ¨˝σn for any n ě m ě 0, and Mn “ Mσn and Mrm,nq “ Mσrm,nq for the associated incidence
matrices.
Let A1 “ ta1 , . . . , ad u and A2 “ ta11 , . . . , a1d1 u be two alphabets, and let σ : A˚2 Ñ A˚1 be a
substitution. We consider vectors ~v1 “ p~v1 paqqaPA1 and ~v2 “ p~v2 pa1 qqa1 PA2 with real coordinates
~v1 paq ě 0 and ~v2 pa1 q ě 0, and we say that ~v1 and ~v2 are σ-compatible if one has ~v1 “ Mσ ~v2 , where
Mσ denotes the incidence matrix of σ.
Ý
Definition 3.1. Let σ “ σ0 ˝ σ1 ˝ σ2 ˝ ¨ ¨ ¨ be a directive sequence, and let Ð
v “ p~vn qnPNYt0u be a
Ð
Ý
family of non-negative vectors ~vn “ p~vn paqqaPA . We say that v is a σ-compatible vector tower if
n

for any n ě 0 the vectors ~vn and ~vn`1 are σn -compatible.
We notice that there is a natural addition for σ-compatible vector towers, and similarly an
external multiplication with non-negative scalars λ P Rě0 . We are now able to state the main
result of of our previous paper, translated properly into S-adic terminology:
Theorem 3.2 ([2]). Let σ “ σ0 ˝ σ1 ˝ σ2 ˝ ¨ ¨ ¨ be an everywhere growing directive sequence with
associated subshift Xσ . Let M :“ MpXσ q denote the set of invariant measures on Xσ , and let
V “ Vpσq denote the set of σ-compatible vector towers.
Ð
Ý
Ý
(1) Every σ-compatible vector tower Ð
v determines an invariant measure µ v on Xσ .
Ð
Ý
(2) Conversely, every invariant measure µ on Xσ is given via µ “ µ v by some σ-compatible
Ý
vector tower Ð
v.
Ð
Ý
Ý
(3) The issuing map m : V Ñ M, Ð
v ÞÑ µ v is linear (with respect to linear combinations with
non-negative scalars).
Ý
(4) For any word w P A˚0 and any σ-compatible vector tower Ð
v “ p~vn qnPNYt0u , with ~vn “
p~vn paqqaPAn , the sequence of sums
ÿ
~vn paq |σr0,nq paq|w
a PAn

(3.1)

is bounded above and increasing, and one has:
ÿ
Ð
Ý
~vn paq |σr0,nq paq|w
µ v prwsq “ lim
nÑ8

a PAn

\
[

This is precisely the statement of Theorem 2.9 of [2], except that the “increasing” property from
(4) has been shown in Remark 9.5 of [2]. The canonical translation from the more general language
5

of graph towers and vectors towers used in [2] into the traditional S-adic setting for subshifts in
symbolic dynamics is explained in detail in section 3 of [2].
For any of the level alphabets An of a directive sequence σ as above we consider the vector space
An q in the base space RA0 .
n
n
RAn and its non-negative cone RA
ě0 , as well as its image C0 :“ Mr0,nq pR
From Definition 3.1 we obtain a canonical linear map
Ý
m0 : Vpσq Ñ RA0 , Ð
v “ p~vn q
ÞÑ ~v0 ,
nPNYt0u

and it Ş
follows (see Proposition 10.2 (2) of [2]) that its image is equal to the nested intersection
C8 :“ C0n of the cones C0n . This gives (see [2], Proposition 10.2 (1)):

Lemma 3.3. The map ζ : MpXσ q Ñ RA0 , µ ÞÑ pµprasqaPA0 satisfies m0 “ ζ ˝ m and thus C8 “
ζpmpVpσqqq. In particular, dim C8 is a lower bound to the number of distinct ergodic probability
measures on Xσ .
\
[

Of special interest are directive sequences where every level alphabet An has the same cardinality
d ě 1, so that we can postulate them to be equal to An :“ A “ ta1 , . . . , ad u. In this case we say
that σ is a directive sequence over A, and we say that σ is of tower dimension dim σ “ d.
Examples are stationary sequences, or sequences derived through telescoping from directive sequences that have finite tower dimension d: the number d is the inferior limit of the sequence of
the cardAn P N. (We believe that the notion of “finite tower dimension” is related or perhaps even
equivalent to the condition “finite rank” as defined through the Bratteli-Vershik setting.)
3.2. Application to substitutions.
As pointed out in section 2, for any substitution σ : A˚ Ñ A˚ the stationary directive sequence
σ0 ˝ σ1 ˝ σ2 ˝ . . ., with σn “ σ for all n ě 0, has as associated subshift the substitution subshift
Xσ . This gives the possibility to interpret a compatible vector tower as infinite sequence of vectors
in Rdě0 (with d “ card A), obtained from each other through iteration of the linear map Mσ . This
observation has been used to derive in Theorem 10.8 of [2] the following result, which is a slight
improvement of a result of Bezuglyi, Kwiatkowski, Medynets and Solomyak obtained in [5]:
Proposition 3.4. For any everywhere growing substitutions σ the set of ergodic measures on the
substitution subshift Xσ is in 1-1 relation with the set of extremal vectors in the cone
č
C8 “ tMσn pRě0 q | n ě 1u .

The latter are also the non-negative extremal eigenvectors of a suitable positive power Mσk (for
\
[
example k “ pcard Aq! would do, see Appendix 11.3 of [2]).

The determination of the extremal eigenvectors named in the above proposition is in practice for
any given reducible matrix M quite convenient, once one has penetrated the slightly intricate logic
of the two “conflicting” natural partial orders on the primitive diagonal blocks of the power M k .
A concise description of all ingredients needed is given in Appendix 11.3 of [2]; for the convenience
of the reader we will now single out the most frequently occurring non-primitive case:
Corollary 3.5. Let σ be an everywhere growing substitution, and assume that the incidence matrix
Mσ satisfies the following conditions:
(a) Mσ is a 2 ˆ 2 block lower triangular matrix.
(b) The two diagonal blocks M1,1 and M2,2 are primitive, with Perron-Frobenius eigenvalues
λ1 ě 1 and λ2 ą 1 respectively.
(c) The lower left off-diagonal block M2,1 is non-zero.
(1) If λ2 ě λ1 , then there is (up to scalar multiples) only one non-negative eigenvector ~v of Mσ
(with eigenvalue λ2 ), which has zero-coordinates on the top block (corresponding to M1,1 ), and
6

non-zero coordinates on the bottom block (corresponding to M2,2 ). In this case Xσ has only one
ergodic probability measure, and its support is the sub-subshift of Xσ generated by the letters of A
that define the bottom block.
(2) If λ1 ą λ2 , then there are (up to scalar multiples) precisely two non-negative eigenvectors ~v1
and ~v2 of Mσ . The vector ~v2 (with eigenvalue λ2 ) has the same properties as the eigenvector ~v in
case (1). On the other hand, the eigenvector ~v1 (with eigenvalue λ1 ) is positive in all coordinates.
In this case Xσ has precisely two ergodic probability measures µ1 and µ2 : The support of µ2 is,
as in the above case (1), only the sub-subshift of Xσ generated by the letters of A that define the
bottom block. The support of µ2 is all of Xσ .
\
[
3.3. Cylinder measures. Let σ “ σ0 ˝ σ1 ˝ σ2 ˝ ¨ ¨ ¨ be a directive sequence of substitutions
Ý
v “ p~vn qnPNYt0u be a σ-compatible vector tower as in Definition 3.1. We
σn : A˚n`1 Ñ A˚n , and let Ð
n
now define, for any level n ě 0 and any two letters a, a1 P An , a weight ωa,a
1 through equality (3.2)
below. The latter can be viewed a special case of equality (3.1), thus ensuring the existence of the
limit on the right hand side:
ÿ
n
~vk pbq |σrn,kq pbq|aa1
(3.2)
ωa,a
1 :“ lim
kÑ8

b PAk

Here the pair pa, a1 q has to be understood as the “transition” from a to a1 , and by its “σn´1 -image”
pc, c1 q we understand correspondingly the transition of the last letter c of σn´1 paq to the first letter
`
c1 of σn´1 pa1 q. We write pc, c1 q “ σn´1
pa, a1 q.
Of course, such transitions occur also inside σn´1 paq or σn´1 pa1 q, and indeed, we derive from
Ý
v:
(3.2) and from the σ-compatibility of Ð
ÿ
ÿ
n´1
n
(3.3)
ωc,c
ωa,a
~vn paq |σn paq|cc1
1 `
1 “
`
tpa,a1 q | pc,c1 q“σn´1
pa,a1 qu

aPAn

The following has not been stated explicitly in [2]; we will though derive it quickly from the
set-up studied there:
Ý
Corollary 3.6. Let σ and Ð
v be as above. Then, for any word w P A˚0 , and any integer n ě 0 with
|σr0,nq paq| ě |w| ´ 1 for all a P An , one obtains:
ř
Ð
Ý
~vn paq ¨ |σr0,nq paq|w `
µ v prwsq “
a PA
řn
1
1
n p|σ
ωa,a
1
r0,nq paa q|w ´ |σr0,nq paq|w ´ |σr0,nq pa q|w q
a,a1 PAn

Ý
Proof. In [2] the vector towers Ð
v from Theorem 3.2 are defined by means of weight function ωn on
1-vertex graphs Γn that topologically realize the monoid An . For any two letters a, a1 P An there
Ý
v in turn
is a local edge εa,a1 defined in Γn , and if σ is everywhere growing, then the vector tower Ð
determines the weight functions ωn . In particular, see Remark 9.5 of [2], the value of ωn pεa,a1 q is
n
given via ωn pεa,a1 q :“ ωa,a
1 through equality (3.2). One obtains now the claimed statement as a
direct translation of Propositions 6.9 and 7.4 from [2] into the S-adic language used here, following
\
[
the instructions carefully laid out in section 3 of [2].
4. Minimal subshifts with many ergodic measures
This section is devoted to the proof of Proposition 1.1. We give first in subsection 4.1 the proof
of part (1) of this proposition, and improve this coarser approach in subsection 4.2 to a proof of
part (2).
7

4.1. The general construction procedure.
In this subsection we present (in a purposefully concrete and “simplistic” way) in 7 steps a
construction of a directive sequence σ with the desired properties:
(1) We first consider matrices of type Mε “ Id ` ε1dˆd , where ε ą 0, Id denotes the pd ˆ dq-unit
matrix, and 1dˆd denotes the pd ˆ dq-matrix that has all coefficients equal to 1.
Let ~c P Rd denote the column vector with all coefficients equal to 1, and let ~e “ ~ek be any one
of the standard basis vectors of Rd . We compute:
Mε ¨ ~e “ ~e ` ε~c

Mε ¨ ~c “ ~c ` dε~c “ p1 ` dεq~c

and

As a consequence, for any ε1 , . . . , εq ą 0 we obtain:
Mε1 ¨ Mε2 ¨ . . . ¨ Mεq ¨ ~e “ ~e ` rε1 ` p1 ` dε1 qε2 ` p1 ` dε1 qp1 ` dε2 qε3
` . . . ` p1 ` dε1 qp1 ` dε2 q . . . p1 ` dεq´1 qεq s~c
“ ~e ` pL1 ε1 ` L2 ε2 ` L3 ε3 ` . . . ` Lq εq q~c ,
where we set L1 :“ 1 and Ls :“ p1 ` dε1 qp1 ` dε2 q . . . p1 ` dεs´1 q for any s P t2, . . . qu.
(2) We now choose for every n P N a value εn ą 0 which is small enough so that it satisfies
(a) logp1 ` dεn q ă 2´n log 2 and
1
(b) εn ă 2n`1
.
From (a) we deduce Ln ă 2, so that we compute:
Mε1 ¨ Mε2 ¨ . . . ¨ Mεq ¨ ~e “ ~e ` Kq~c
with 0 ă Kq ď Kq`1 ă 1 for all q P N.
We note that the same result stays valid if one further lowers the value of the εn , so that we can
1
for some integer ℓpnq P N.
assume that εn “ ℓpnq
(3) For the family of εn as in (2) we consider any of the standard basis vectors ~ek and obtain
lim Mε1 ¨ Mε2 ¨ . . . ¨ Mεn ¨ ~ek “ ~ek ` K8~c

nÑ8

for some 0 ă K8 ď 1.
This shows that the nested intersection of the cones Mε1 ¨ Mε2 ¨ . . . ¨ Mεn pRdě0 q for all n P N is
equal to the cone generated by the vectors ~ek ` K8~c, which is simplicial of dimension d.

(4) We now define for any ℓ P N the integer matrix Mℓ1 “ ℓId ` 1dˆd , and note that for ε “
have
Mℓ1 “ ℓMε
It follows, since in (2) we chose ℓpnq P N such that εn “

1
ℓpnq ,

1
ℓ

we

that the nested intersection of the

1
1
1
cones Mℓp1q
¨ Mℓp2q
¨ . . . ¨ Mℓpnq
pRdě0 q for all n P N is also equal to the cone generated by the vectors
~ek ` K8~c and thus simplicial of dimension d.

(5) Next we consider an alphabet A “ ta1 , . . . , ad u and substitutions
σn : A ˚ Ñ A ˚ ,

ℓpnq

ak ÞÑ ak

a1 . . . ad

pfor all ak P Aq ,

1
so that one has Mσn “ Mℓpnq
for all n P N.
For formal reasons we add the substitution σ0 :“ idA˚ to our list.

(6) Since for n ě 1 any of the incidence matrices Mσn is positive, it follows that the directive
sequence σ “ σ0 ˝ σ1 ˝ σ2 ˝ . . . is weakly primitive as defined in section 2, so that Proposition 2.3
shows that the associated subshift Xσ is minimal.
8

(7) We now apply Theorem 3.2, Lemma 3.3 and Fact 2.5 to deduce that MpXσ q is a simplicial
cone of dimension d, so that Xσ supports d distinct ergodic probability measures.
1
Remark 4.1. Once the matrices Mℓpnq
have been established in step (4) of the above construction,
1
the choice of the substitutions σn with Mσn “ Mℓpnq
in step (5) is of course only one of many
possible such choices.

4.2. Reduction to finite S.
We will now explain how the method presented in the previous subsection can be refined to
obtain the same result, but for a set S of substitutions that is finite. The latter are given by the
substitutions ρj , θj and τj , for any j P t1, . . . , du, which all fix any ak with k ‰ j and map aj
to ρj paj q “ a3j , θj paj q “ a2j and τj paj q “ aj aj`1 . . . ad a1 . . . aj´1 respectively. We also use the
abbreviation θj1 :“ θd . . . θj`1 θj´1 . . . θ1 .
We first need to recall the following well known fact (deduced easily from the non-commensurability
of the logarithms of 2 and 3):
m

Fact 4.2. (1) The set of numbers 23q , for any integers m, q ě 0, is dense in Rě0 .
(2) More concretely, we need the following, which follows from (1):
m
For any ε ą 0 there are integers m, q ě 0 such that 1 ě 23q ě 1 ´ 2ε . We then define the integer
h ě 1 through h :“ 3q ´ 2m .
\
[
For any ε ą 0 and m, q and h as in Fact 4.2 (2) we now define a substitution
1
σε,j
:“ ρqj τjh θj1

m

1 acts as follows:
and observe that on the generators σε,j
q

aj ÞÑ a3j paj`1 . . . ad a1 . . . aj´1 qh
m

ak ÞÑ a2k
for all
k‰j
1 maps
1
From the above definition of h we quickly deduce that the incidence matrix Mσε,j
“: Mε,j
the center vector ~c from the previous section to
1
Mε,j
¨ ~c “ 3q~c ,

and similarly any basis vector ~ek with k ‰ j to
1
Mε,j
¨ ~ek “ 2m~ek .

For ~ej we compute:

1
Mε,j
¨ ~ej “ h~c ` p3q ´ hq~ej “ h~c ` 2m~ej

1
Lemma 4.3. For any 1 ě ε ą 0 the matrices Mε,j
above and Mε from the previous subsection
satisfy the following inclusion:
1
Mε pRdě0 q Ď Mε,j
pRdě0 q

Proof. We recall from the previous subsection that Mε ¨ ~c “ p1 ` dεq~c and Mε ¨ ~ek “ ~ek ` ε~c for all
1 fix the vector ~
k P t1, . . . , du. We note that both, Mε and Mε,j
c up to a scalar multiple and map
the vector ~ek , for any k P t1, . . . , du, to a linear combination of ~c and ~ek . Hence the claim follows if
1 to a larger segment
we show for any k that the projectivized line segment r~c, ~ek s is mapped by Mε,j
than by Mε .
1 . For
For k ‰ j this is clear, since the projectivized line segment r~c, ~ek s is set-wise fixed by Mε,j
1
k “ j we compute the coefficient quotient of Mε,j ¨ ~ej and apply the inequalities from Fact 4.2 (2)
to obtain:
3q ´ 2m
3q
2
ε
h
“
“ m ´1ď
´1“
m
m
2
2
2
2´ε
2´ε
9

In comparison, the analogous coefficient quotient of Mε ¨ ~ej is equal to ε and thus strictly bigger,
1 -image of
since we can assume that ε is small. This shows that Mε ¨ ~ej defines a point on the Mε,j
the projectivized line segment r~c, ~ej s.
\
[
We now consider an infinite sequence of positive constants ε1 , ε2 , . . . as exhibited in the previous
subsection, for which the limit intersection of the nested sequence of the cones Mε1 ¨ Mε2 ¨ . . . ¨
Mεn pRdě0 q is simplicial of dimension d.
For any εn ą 0 let mn , qn and hn be integers as in Fact 4.2 (2), and for any choice of indices
jpnq P t1, . . . , du let
hn 1
1
n
σn,jpnq
θjpnq mn
τjpnq
:“ ρqjpnq
be the corresponding substitution as introduced above. We denote its incidence matrix by Mn1 :“
Mσ1
, and obtain directly from Lemma 4.3 that for any n P N one has:
n,jpnq

Mε1 ¨ Mε2 ¨ . . . ¨ Mεn pRdě0 q Ď M11 ¨ M21 ¨ . . . ¨ Mn1 pRdě0 q

1
It follows that the same inclusion is true for the limit cones, so that the limit cone for the σn,jpnq
must also have dimension d.
It remains to specify the indices jpnq: if they are chosen so that jpnq varies cyclically through
the set of all indices 1, 2, . . . , d, then the product of any subsequent d incidence matrices is positive,
which suffices to guaranty that the resulting directive sequence is weekly primitive.
It follows as in the previous subsection that the S-adic subshift defined by the directive sequence
1
of σn,jpnq
, for the finite set S given above, is minimal and has d ergodic probability measures.

Remark 4.4. Similar to Remark 4.1 we note that there are many possible variations of the construction presented in this subsection. For examples the exponents of the powers ρj paj q and θj paj q
can be arbitrary relative prime integers, and τj paj q can be any word that involves every letter of
A a fixed number of times.
Remark 4.5. We now observe that any two of the substitutions ρj and ρj`1 are conjugate to each
other, through a cyclic permutation π : aj ÞÑ aj`1 (for j understood modulo d). The same holds for
1
1
the θj and for the τj . It follows that the above constructed directive sequence σ 1 :“ σ0,jp0q
˝σ1,jp1q
˝. . .
2
2
can be understood as obtained through telescoping from a directive sequence σ “ σ0 ˝ σ12 ˝ . . .
with same associated subshift Xσ1 “ Xσ2 , where all σn2 belong to S “ tρ1 , θ1 , τ1 , πu. This proves
the statement (2) of Proposition 1.1.
Remark 4.6. The relevance of statement (2) of Proposition 1.1 is emphasized by a comparison with
F. Durand’s results in [6], where it is shown that a subshift with Bratteli-Vershik representation
based on a finite set of positive incidence matrices is linearly recurrent and hence uniquely ergodic.
In our construction above it is crucial that the 4 generating substitutions ρ1 , θ1 , τ1 , π are not
positive (indeed, not even primitive), so that suitable products of them, as for example the ones
pointed out in the above proof, allows one to compose an infinite set of positive matrices without
(linear or else) bound on the resulting recurrencence.
4.3. Some questions.
Inspired by Remark 4.5 we define for any set S of substitutions of some free monoid A˚ the ergodic
size ηpSq as the maximal number of ergodic probability measures supported by any subshift X Ď ΣA
which admits an S-adic expansion. One can specify this further to a min-ergodic size ηmin pSq by
adding the additional requirement that X be minimal. This gives
1 ď ηpSq ď cardA and ηmin pSq ď ηpSq
for any S ‰ H, as well as
ηmin pS 1 q ď ηmin pSq and
10

ηpS 1 q ď ηpSq

for any subset S 1 Ď S. We say that S is ergodically rich if ηmin pSq ě 2; if ηpSq “ 1, we call S
uniquely ergodic.
In Corollary 10.10 of [2] it has been shown that for any directive sequence σ with stationary
incidence matrix M the number of ergodic probability measures on the associated subshift Xσ
depends only on M and not on the particular choice of σ. It follows that for the finite set SM
of substitutions σi with Mσi “ M the ergodic size satisfies ηpSq “ 1, if M is chosen suitably (for
example primitive).
On the other hand, the min-ergodic size of the 4-elements set S exhibited in Remark 4.5 is shown
there to satisfy ηmin pSq “ d, thus motivating the following:
Question 4.7. (1) Given integers k ě 1 and d ě 1, what are the “generic” values for ηpSq and
ηmin pSq of any set S that consists of at most k substitutions over an alphabet of d letters ?
(2) More specifically, does there exist an ergodically rich set S that consists of 2 primitive substitutions ?
5. Determination of cylinder weights for substitutions
Let A “ ta1 , . . . , ad u be an alphabet, and let σ : A˚ Ñ A˚ be a substitution which is everywhere
growing, but possibly reducible. As before we denote by Xσ Ď ΣA the subshift associated to σ,
and by µ an invariant measure on Xσ . Recall that for any w P A˚ the cylinder determined by w is
denoted by rws.
Question 5.1. How can one determine the measure µprwsq for an arbitrary word w P A˚ ?
We will now describe a (fairly practical) answer to this question, based on our previous results.
Along the description of this algorithm, we will illustrate the main steps on the two (famous)
examples of the Thue-Morse substitution σTM and the Fibonacci substitution σFib :
σTM : a ÞÑ ab
b ÞÑ ba

σFib : a ÞÑ ab
b ÞÑ a

The algorithm we present consists of three steps:
Step 1: We first compute from the given words σpai q the incidence matrix Mσ “ pmx,y qx,yPA ,
where mx,y :“ |σpyq|x denotes the number of occurrences of x in the word σpyq.
We then pass to the augmented incidence matrix
Mσ` :“ pm`
X,Y qX,Y PA2
which is defined as follows: Its rows and columns are indexed by the set A2 of all words in A˚
of length 1 or 2, and it contains Mσ as diagonal block: m`
x,y :“ mx,y for all x, y P A. The
complementary diagonal block is a “pre-permutation matrix” (i.e. every column contains precisely
one non-zero entry, and the latter is equal to 1), defined by the rule that for any word X “ x1 x2 of
length 2 the coefficient m`
X,Y is equal to 1 if and only if for Y “ y1 y2 the letter x1 is the last letter
of σpy1 q and the letter x2 is the first letter of σpy2 q. Otherwise one sets m`
X,Y “ 0.
`
The off-diagonal blocks are defined by the rule that mX,Y “ 0 if |X| “ 1 and |Y | “ 2, while for
|X| “ 2 and |Y | “ 1 one sets m`
X,Y :“ |σpY q|X .
Example„ 5.2. For
substitution
σTM and the Fibonacci substitution σFib one has
 the Thue-Morse
„

1 1
1 1
MσTM “
and MσFib “
, and we obtain, for the row and column indexes given by
1 1
1 0
11

pa, b, aa, ab, ba, bbq:

Mσ`TM

»

—
—
—
“—
—
—
–

1
1
0
1
0
0

1
1
0
0
1
0

0
0
0
0
1
0

0
0
0
0
0
1

0
0
1
0
0
0

0
0
0
1
0
0

ﬁ

ﬃ
ﬃ
ﬃ
ﬃ,
ﬃ
ﬃ
ﬂ

Mσ`Fib

»

—
—
—
“—
—
—
–

1
1
0
1
0
0

1
0
0
0
0
0

0
0
0
0
1
0

0
0
0
0
1
0

0
0
1
0
0
0

0
0
1
0
0
0

ﬁ

ﬃ
ﬃ
ﬃ
ﬃ.
ﬃ
ﬃ
ﬂ

Remark 5.3. It is not hard to verify that with this definition one obtains for any two substitutions
`
σ, σ 1 the equality Mσ` ¨ Mσ`1 “ Mσ˝σ
1 . Thus we have in particular, for any integer n P N:
Mσ`n “ pMσ` qn
Remark 5.4. The augmented incidence matrix Mσ` is lower triangular by blocks, with two diagonal
blocks. The first diagonal block is given by the incidence matrix Mσ . The second diagonal block
can be described as a Kronecker product Sσ b Pσ . For this, we order lexicographically the elements
of A2 r A which serve as indices for the second diagonal block. Now Pσ “ ppxy qx,y PA is the “prefix
matrix” of σ: we set pxy “ 1 if x is the first letter of σpyq, and otherwise pxy “ 0. Similarly,
Sσ “ psxy qx,y PA is “suffix matrix” of σ: sxy “ 1 if x is the last letter of σpyq, and otherwise sxy “ 0.
As a consequence, we notice that the spectrum of Mσ` is given by the spectrum of Mσ plus
possibly 0 and some d1 -th roots of the unity, for d1 ď d.
Example 5.5. For the Thue-Morse substitution σTM and the Fibonacci substitution σFib , we get:

„

„


„
„
1 1
0 1
1 0
0 1
.
, PσFib “
, SσFib “
, PσTM “
SσTM “
0 0
1 0
0 1
1 0
Step 2: For any word w P A˚ we define an integer n ě 0 to be pσ, wq-large if |σ n pai q| ě |w| ´ 1
for all ai P A. For such n we now define an occurence vector ~v pwqn “ pvX qXPA2 with coefficients
vX defined by the rule vX “ |σ n pXq|w if |X| “ 1, and vX “ |σ n pXq|w ´ |σ n px1 q|w ´ |σ n px2 q|w if
X “ x1 x2 has length 2. Thus, in the latter case, the coefficient vX counts the number of times
that w occurs as factor of σ n px1 qσ n px2 q, but ignores those occurrences that are either completely
contained in the first or completely contained in the second factor of this product.
Remark 5.6. (1) If w has length 1 or 2, then independently of σ one has that n “ 0 is pσ, wq-large.
The vector ~v pwq0 has only zero coefficients except for the coordinate X “ w, where it is equal to 1.
(2) It is not hard to verify (using Remark 5.3) that the above defined n-th occurrence vector ~v pwqn
satisfies, for any two pσ, wq-large integers n ě m the equality
t

(5.1)

~v pwqn “ t~v pwqm ¨ pMσ` qn´m .

Example 5.7. (1) We now consider the substitutions σTM and σFib from Example 5.2 and any
word w of length |w| “ 2. We know from Remark 5.6 (1) that any n ě 0 is pσi , wq-large, and
as warm-up exercise we consider n “ 1 for σTM and n “ 2 for σFib . For the same ordering of
coordinates as in Example 5.2 this gives for σTM the following occurrence vectors:
t~
v paaq1

t~
v pabq1

t~
v pbaq1

t~
v pbbq1

p0, 0, 0, 0, 1, 0q p1, 0, 0, 0, 0, 1q p0, 1, 1, 0, 0, 0q p0, 0, 0, 1, 0, 0q
For σFib we obtain the vectors
t~
v paaq2

t~
v pabq2

t~
v pbaq2

t~
v pbbq2

p0, 0, 1, 1, 0, 0q p1, 1, 0, 0, 0, 0q p1, 0, 0, 0, 1, 1q p0, 0, 0, 0, 0, 0q
For both sets of occurrence vectors one uses Remark 5.6 (1) to quickly verify the equation (5.1),
for m “ 0 and n as above.
12

(2) We now want to illustrate how to deal with a more elaborate case, by picking “at random” a
slightly longer word:
w “ baabab
One first iterates the given substitution on the generators, until their images are longer or equal to
|w| ´ 1 “ 5. In our two cases this gives:
3
σTM
: a ÞÑ abbabaab
b ÞÑ baababba

4 :a Ñ
σFib
Þ
abaababa
b Ñ
Þ
abaab

We now compute for σTM :
3
3
3
va :“ |σTM
paq|w “ 0, vb :“ |σTM
pbq|w “ 1, vaa :“ |σTM
paaq|w “ 1,
3
3
3
vab :“ |σTM
pabq|w “ 1, vba :“ |σTM
pbaq|w “ 1, vbb :“ |σTM
pbbq|w “ 2
Similarly, we obtain for σFib :
4
4
4
paq|w “ 1, vb :“ |σFib
pbq|w “ 0, vaa :“ |σFib
paaq|w “ 2,
va :“ |σFib
4
4
4
pbbq|w “ 1
pbaq|w “ 2, vbb :“ |σFib
pabq|w “ 1, vba :“ |σFib
vab :“ |σFib
We then use the general formula for the occurrence vector
t

~v pwqn “ pva , vb , vaa ´ 2va , vab ´ va ´ vb , vba ´ vb ´ va , vbb ´ 2vb q

to obtain for σTM
t

~v paababq3 “ p0, 1, 1, 0, 0, 0q ,

t

~v paababq4 “ p1, 0, 0, 0, 1, 1q .

and for σFib
Step 3: We know from Proposition 3.4 that every ergodic invariant measure µi on the substitution
subshift Xσ Ď ΣA is given for some suitable exponent k ě 1 by a non-negative column eigenvector
~vi “ pvx qxPA of Mσk with eigenvalue λi ą 1, with the property vx “ µprxsq for any x P A (see
Lemma 3.3). The converse statement also holds.
Since for the matrix Mσ` all eigenvalues λj of the lower d2 ˆ d2 diagonal block are of modulus
|λj | ď 1, it follows from standard Perron-Frobenius theory for non-negative matrices (see Appendix
11.3 of [2]) that any eigenvector ~vi of Mσk as above determines uniquely a non-negative eigenvector
~vi` of pMσ` qk , which contains ~vi as “subvector” at the upper d coordinates (i. e. the coordinates
for A Ď A2 ), and which has the same eigenvalue λi .
We have thus explained all terms used in Proposition 1.2, which we abbreviate here to:
ř
Proposition 5.8. For any convex combination µ “ ci µi of the above ergodic measures µi the
measure of the cylinder rws is given by the scalar product (written as matrix multiplication)
ÿ 1
µprwsq “ t~v pwqn ¨
ci n ~vi` .
λi
Proof. It suffices to prove µi prwsq “ t~v pwqn ¨ λ1n ~vi` for a single ergodic measure µi . But this is
i
Ð
Ý
Ý
precisely the formula from Corollary 3.6 for the measure µi “ µ vi given by a vector tower Ð
vi that is
Ý
compatible with the stationary directive sequence defined by the substitution σ, where Ð
vi is defined
Ý
\
[
by the above eigenvector ~vi through setting Ð
vi “ p λ1n ~vi qnPNYt0u .
i

Remark 5.9. Note that for any measure µi as above the associated right eigenvector ~vi` of the
augmented matrix Mσ` gives directly the measures of the cylinders of size 1 and 2. For the words of
length 1 this is is stated in Lemma 3.3, and for the words X of length 2 this follows from Proposition
5.8, since ~v pXq0 is the unit vector for the coordinate X, and 0 is pσ, Xq-large for any everywhere
growing σ and X of length 2.
13

Example 5.10. The two substitutions σTM and σFib from Example 5.2 are primitive and hence
uniquely ergodic. For the Thue-Morse substitution σTM on the full shift Σta,bu , with incidence
„

1 1
matrix MσTM “
, the probability measure µTM is defined by the Perron-Frobenius eigen1 1
„ 
1
vector 12
with eigenvalue λTM “ 2. For the Fibonacci substitution σFib with incidence matrix
„

„1

ϕ
1 1
1
with
MσFib “
we obtain analogously the measure µFib through the eigenvector ϕ2
1
1 0
?

eigenvalue λFib “ ϕ, for the golden mean ϕ :“ 1`2 5 . For the augmented incidence matrices Mσ`TM
and Mσ`Fib computed in Example 5.2 we thus calculate the augmented eigenvectors (written transt
`
`
posed) as t~vTM
“ 12 t p1, 1, 13 , 32 , 23 , 13 q and t~vFib
“ ϕ12 pϕ, 1, ϕ´1 , 1, 1, 0q. Hence using Remark 5.6 (1)
we can now evaluate the formula in Proposition 5.8 to obtain:
w

a

b

aa ab ba bb

µTM prwsq

1
2

1
2

1
6

1
3

1
3

1
6

as well as
w

a

b

aa

ab

ba bb

µFib prwsq

1
ϕ

1
ϕ2

1
ϕ3

1
ϕ2

1
ϕ2

0

It is not hard to check that Remark 5.9 gives the same answer, and is slightly more direct. But
in order to compute the measures of cylinders of size bigger or equal to 3, Remark 5.9 does not
apply, so that one needs to fall back onto Proposition 5.8. For example, for the word w “ baabab
considered in Example 5.7 (3) we obtain
µTM prbaababsq “

1
1t
`
“
~v pbaababq3 ¨ ~vTM
8
12

and

1 t
1
`
~v pbaababq4 ¨ ~vFib
“ 4.
4
ϕ
ϕ
For completeness we mention the fact that all the cylinders of length 3 have the same measure
for Thue-Morse subshift, or else they have measure 0.
µFib prbaababsq “

6. Examples
We conclude this paper with three slightly more challenging examples, concerning non-primitive
everywhere growing substitutions.
6.1. An example with a periodic sequence in the substitution subshift.
The methods developed in [5] don’t seem to work for substitutions with periodic leaves in their associated subshift. Such a restriction doesn’t hold for the technology presented here, as is illustrated
by the following.
Let σ be the (non-primitive) substitution given by:
$
’
&a ÞÑ acbca
b ÞÑ ba
’
%
c ÞÑ cc
14

We compute the incidence matrix and both, the suffix and the prefix matrix for σ:
»
ﬁ
»
ﬁ
»
ﬁ
2 1 0
1 1 0
1 0 0
Mσ “ – 1 1 0 ﬂ , Sσ “ – 0 0 0 ﬂ , Pσ “ – 0 1 0 ﬂ .
2 0 2
0 0 1
0 0 1

The occurrences of words of length 2 in the generator images σpaq, σpbq and σpcq, which serve to
determine the columns of the lower left off-diagonal block of the augmented incidence matrix, are
given respectively (with indices in lexicographic order) by:
t

.
.
.
.
.
.
p0, 0, 1 .. 0, 0, 1 .. 1, 1, 0q, t p0, 0, 0 .. 1, 0, 0 .. 0, 0, 0q, t p0, 0, 0 .. 0, 0, 0 .. 0, 0, 1q

We have now all ingredients to compute the augmented incidence matrix Mσ` , which is of size
12 ˆ 12. Recall that the upper diagonal block (of size 3 ˆ 3) is equal to Mσ , and the lower block
(of size 9 ˆ 9) is equal to the Kronecker product Sσ b Pσ .
ﬁ
»
2 1 0 0 0 0 0 0 0 0 0 0
— 1 1 0 0 0 0 0 0 0 0 0 0 ﬃ
ﬃ
—
— 2 0 2 0 0 0 0 0 0 0 0 0 ﬃ
ﬃ
—
— 0 0 0 1 0 0 1 0 0 0 0 0 ﬃ
ﬃ
—
— 0 0 0 0 1 0 0 1 0 0 0 0 ﬃ
ﬃ
—
— 1 0 0 0 0 1 0 0 1 0 0 0 ﬃ
`
ﬃ
—
Mσ “ —
ﬃ
— 0 1 0 0 0 0 0 0 0 0 0 0 ﬃ
— 0 0 0 0 0 0 0 0 0 0 0 0 ﬃ
ﬃ
—
— 1 0 0 0 0 0 0 0 0 0 0 0 ﬃ
ﬃ
—
— 1 0 0 0 0 0 0 0 0 1 0 0 ﬃ
ﬃ
—
– 1 0 0 0 0 0 0 0 0 0 1 0 ﬂ
0 0 1 0 0 0 0 0 0 0 0 1

We now observe that the incidence matrix Mσ itself has two primitive diagonal blocks, ?with
eigenvalue λ2 “ 2 for the bottom block of Mσ , and λ1 “ 1 ` ϕ for the top one (with ϕ “ 1`2 5 as
before). Since 1 ` ϕ ą 2 holds, the case (2) of Corollary 3.5 applies, giving rise to two non-negative
eigenvectors ~v1 for λ1 and ~v2 for λ2 , which determine invariant ergodic probability measures µ1 and
µ2 respectively on the substitution subshift Xσ . As explained in Step 3 of section 5, each ~vi gives
rise to a non-negative eigenvector ~vi` of the augmented matrix Mσ` , which we can use to determine
the measure of specific cylinders rws via Proposition 5.8. But first we consider the words of length
1 and 2, as for their cylinders the measure is read off directly from ~vi and ~vi` respectively, using
Remark 5.9:
‚ For the eigenvalue λ2 “ 2 we compute the eigenvector ~v2 and we obtain for the words of
length 1:
µ2 prasq “ µ2 prbsq “ 0, µ2 prcsq “ 1

The computation of the augmented eigenvector ~v2` shows that every cylinder of size 2 has measure
0, except rccs. Thus the measure µ2 is atomic: It only gives positive measure to the biinfinite
periodic word . . . ccc . . ..
‚ For the eigenvalue λ1 “ 1 ` ϕ “ ϕ2 we compute the eigenvector
~v1` “

.
.
1t
pϕ ´ 1, 2 ´ ϕ, 2 | 5ϕ ´ 8, 0, 7 ´ 4ϕ .. 5 ´ 3ϕ, 0, 2ϕ ´ 3 .. 2 ´ ϕ, 2 ´ ϕ, 2ϕ ´ 2q
3

which defines the second ergodic measure µ1 . We apply Remark 5.9 to obtain:
15

w

aa

µ1 prwsq

5ϕ´8
3

w

a

b

c

µ1 prwsq

ϕ´1
3

2´ϕ
3

2
3

ab

ac

ba

0

7´4ϕ
3

5´3ϕ
3

bb

bc

ca

cb

cc

0

2ϕ´3
3

2´ϕ
3

2´ϕ
3

2ϕ´2
3

To compute the measure of a cylinder rws for a word w of length larger than 2, say w “ bcacc,
we first iterate the given substitution to calculate σ n on the generators ai , until their images have
length |σ n pai q| ě |w| ´ 1 “ 4:
$
2
’
&σ paq “ acbcaccbaccacbca
σ 2 pbq “ baacbca
’
% 2
σ pcq “ cccc
We then compute the corresponding occurrence vector
.
.
t
~v pbcaccq2 “ p1, 0, 0 | 0, 0, 1 .. 0, 0, 1 .. 0, 0, 0q
and now, according to Proposition 5.8, the matrix product
1 t
~v pbcaccq2 ¨ ~vi` .
λ2i
For i “ 2 this gives of course µ2 prbdaccsq “ 0, while for i “ 1 we obtain:
3´ϕ
1 ϕ ´ 1 7 ´ 4ϕ 2ϕ ´ 3
`
`
q“
µ1 prbdaccsq “ 4 p
ϕ
3
3
3
ϕ4
6.2. Example from Bezuglyi, Kwiatkowski, Medynets and Solomyak.
This example has already been treated in [5], Example 5.8 (up to a permutation of the letters);
we present here the alternative treatment by our methods.
$
’
a ÞÑ baaad
’
’
’
’
’b ÞÑ bc
&
σ : c ÞÑ cb
’
’
’
d ÞÑ de
’
’
’
%e ÞÑ ed

The augmented incidence matrix Mσ` has size 30. Its upper diagonal block is equal to the incidence
matrix Mσ , while the lower one is given by S b P . We compute:
¨
¨
˛
¨
˛
˛
3 0 0 0 0
0 0 0 0 0
0 0 0 0 0
˚1 1 1 0 0‹
˚0 0 1 0 0‹
˚1 1 0 0 0‹
˚
˚
‹
˚
‹
‹
˚
‹
˚
‹
‹
Mσ “ ˚
˚0 1 1 0 0‹ , S “ ˚0 1 0 0 0‹ , P “ ˚0 0 1 0 0‹
˝1 0 0 1 1‚
˝1 0 0 0 1‚
˝0 0 0 1 0‚
0 0 0 1 1
0 0 0 1 0
0 0 0 0 1

Next we list the occurrences of words of length 2 in the images of the generators, which serve to
determine the columns of the lower left off-diagonal block of Mσ` . As before, these columns are
written in transposed form, with A “ ta, b, c, d, eu and indices ordered lexicographically:
.
.
.
.
p|σpaq|xy qx,yPA “ p2, 0, 0, 1, 0 .. 1, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0q
.
.
.
.
p|σpbq|xy qx,yPA “ p0, 0, 0, 0, 0 .. 0, 0, 1, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0q
16

.
.
.
.
p|σpcq|xy qx,yPA “ p0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 1, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0q
.
.
.
.
p|σpdq|xy qx,yPA “ p0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 1 .. 0, 0, 0, 0, 0q
.
.
.
.
p|σpeq|xy qx,yPA “ p0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 0, 0 .. 0, 0, 0, 1, 0q
We now observe that all three diagonal blocks of Mσ are distinguished, so that for each of them
there is a non-negative eigenvector of Mσ` with eigenvalue ą 1, giving rise to 3 distinct ergodic
probability measures µfull , µb,c and µd,e on the substitution subshift Xσ .
‚ For each of the two lower diagonal blocks the substitution σ defines a “sub-substitution” σb,c
and σd,e , since both, the submonoids generated by b and c as well as that for d and e, are σ-invariant.
Both of these sub-substitutions are (up to renaming of the generators) equal to the Thue-Morse
substitution σTM from section 5. They define minimal sub-subshifts Xb,c Ď Xσ and Xd,e Ď Xσ ,
which are precisely the support of the measures µinc and µd,e respectively. Since the Thue-Morse
substitutions has already been treated in detail in section 5, we will skip here the corresponding
computations.
‚ The top diagonal block (of size 1 ˆ 1) of Mσ has eigenvalue 3 and determines a non-negative
eigenvector ~v ` of Mσ` , which is chosen here as to have integer coefficients. In order to determine
from ~v ` via Remark 5.9 the µfull -measures for the cylinders of size 1 and 2 we then rescale the
1
) to get total measure 1.
values of the coordinates (by the factor 36
`
The first 5 coordinates of ~v define a “subvector” ~v “ pvx qxPA which satisfies Mσ ~v “ 3~v . We
compute ~v “ t p12, 8, 4, 8, 4q, which gives:
1
2
1
2
1
µfullprasq “ , µfull prbsq , µfull prcsq “ , µfull prdsq “ , µfull presq “
3
9
9
9
9
We then use the above described coefficients, for the lower diagonal and the lower left off-diagonal
block of the matrix Mσ` , to compute the last 25 coordinates vxy of ~v ` , with x, y P A:
vaa vab vac vad vae
8

0

0

4

vba vbb vbc vbd vbe

0

4

vca vcb vcc vcd vce
0

3

1

0

1

3

0

0

vda vdb vdc vdd vde

0

0

3

0

2

3

vea veb vec ved vee
0

1

0

2

1

Hence all cylinders of size 2 have µfull -measure 0, except for:
1
1
1
1
2
µfull praasq “ , µfull pradsq “ , µfullprbasq “ , µfull prbbsq “ , µfull prbcsq “ ,
9
9
9
36
12
1
1
1
1
, µfull prccsq “ , µfull prdbsq “ , µfull prddsq “ ,
12
36
12
18
1
1
1
1
µfullprdesq “ , µfull prebsq “ , µfull predsq “ , µfullpreesq “
12
36
18
36
We observe that µfull has indeed full support on Xσ , as follows in more generality from the fact
that the eigenvector ~v of Mσ is positive.
Since the σ-image of every generator ai has length |ai | ě 2, we can use the above values also for a
direct evaluation via Proposition 5.8 of any cylinder rws of size |w| “ 3, through a quick calculation
µfullprcbsq “

17

of the occurrence vector ~v pwq0 . For example, this occurence vector for w “ edb has coefficients
equal to 1 only in the coordinates ea and eb, giving
1
µfull predbsq “ µfull preasq ` µfull prebsq “
,
36
while for w “ cba we obtain
1
µfull prcbasq “ µfull prbasq “ .
9
6.3. A family of examples with varying number of ergodic measures.
For any integer k ě 1 we consider the substitution σk defined by:
$
a ÞÑ bacaab
’
’
#
’
&
c ÞÑ cd
b ÞÑ aba
τ:
,
σk :
’
d ÞÑ c
c ÞÑ τ k pcq
’
’
%
d ÞÑ τ k pdq

We compute the incidence matrix for σk :
ﬁ
»
3 2 0 0
— 2 1 0 0 ﬃ
ﬃ
Mσk “ —
– 1 0 ak bk ﬂ
0 0 ck dk

with

„

ak bk
ck dk



“

„

1 1
1 0

k

“ Mτk

We note that for any k ě 1 the Corollary 3.5 applies, and since τ is up to a change of generators
equal to the Fibonacci substitution σFib treated extensively in section 5, we know already that the
primitive bottom diagonal block Mτk of Mσk has PF-eigenvalue ϕk . Its corresponding eigenvector
determines an invariant probability measure which is supported only on the bottom stratum of
σk , defined by c and d, and the cylinder values are precisely those computed in section 5 for the
Fibonacci substitution.
The top diagonal block of Mσk is independent of k and turns out to be actually equal to Mτ3 :
it thus has PF-eigenvalue ϕ3 . Hence for k ě 3 case (1) of Corollary 3.5 holds, so that the above
described invariant “Fibonacci” measure supported on the bottom stratum is the only invariant
measure on the substitution subshift Xσk .
For k “ 1 and k “ 2, however, we find ourselves in case (2) of Corollary 3.5, and hence in
both cases there is a second invariant probability measure µk with full support, which we will now
consider in detail:
The case k “ 1: We first compute an integer PF-eigenvector t pva , vb , vc , vd q for the eigenvalue ϕ3
of the above given (non-augmented) incidence matrix Mσ1 , where we note that ϕ3 “ 2ϕ ` 1:
va

vb

vc

vd

3ϕ3

3ϕ2

ϕ3

1

This gives directly the measure of the cylinders of size 1, through the normalization µ1 prxsq “
1
11ϕ`8 vx for any x P A “ ta, b, c, du.
For the cylinders of size 2 we compute (as in the previous examples) the augmented incidence
matrix Mσ`1 of σ1 , which has size 20. We note:
ﬁ
»
ﬁ
»
0 1 0 0
0 1 0 0
ﬃ
—
— 1 0 0 0 ﬃ
ﬃ , Pσ “ — 1 0 0 0 ﬃ .
Sσ1 “ —
1
– 0 0 1 1 ﬂ
– 0 0 0 1 ﬂ
0 0 0 0
0 0 1 0
18

Next we list the occurrences of words of length 2 in the images of the generators, which serve to
determine the columns of the lower left off-diagonal block of Mσ` . These columns are written as in
the previous examples in transposed form, with indices ordered lexicographically:
.
.
.
p|σ1 paq|xy qx,yPA “ p1, 1, 1, 0 .. 1, 0, 0, 0 .. 1, 0, 0, 0 .. 0, 0, 0, 0q
.
.
.
p|σ1 pbq|xy qx,yPA “ p0, 1, 0, 0 .. 1, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 0q
.
.
.
p|σ1 pcq|xy qx,yPA “ p0, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 1 .. 0, 0, 0, 0q
.
.
.
p|σ1 pdq|xy qx,yPA “ p0, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 0q
We now compute a right PF-eigenvector of Mσ`1 associated to ϕ3 , with coefficients vw for any |w| ď 2
that agree for |w| “ 1 with the above coefficients vx for the eigenvector of Mσ1 . From the above
specified coefficients of Mσ`1 we derive through a minor computational effort:
$
$
va ` vbb “ ϕ3 vaa
va ` vb ` vab “ ϕ3 vba
’
’
’
’
’
’
&v ` v ` v “ ϕ3 v
&v “ ϕ3 v
a
aa
b
ba
ab
bb
3v
’
’
v
`
v
`
v
“
ϕ
v
`
v
“
ϕ3 vbc
a
ac
ac
bc
bd
ad
’
’
’
’
%
%
0 “ ϕ3 vad
0 “ ϕ3 vbd
$
$
va ` vdb “ ϕ3 vca
vcb “ ϕ3 vda
’
’
’
’
’
’
&v “ ϕ3 v
&v “ ϕ3 v
ca
da
cb
db
3v
’
’
v
`
v
“
ϕ
v
`
v
“
ϕ3 vdc
cc
cc
dc
dd
cd
’
’
’
’
%
%
vc “ ϕ3 vcd
0 “ ϕ3 vdd
This gives:
vaa
vab
vac vad
vba
vbb
vbc vbd
ϕ3 va
ϕ6 ´1

va `vb
ϕ3 ´1

ϕ3 va
ϕ6 ´1

0

va `vb
ϕ3 ´1

va
ϕ6 ´1

va
ϕ6 ´1

0

vca

vcb

vcc

vcd

vda

vdb

vdc

vdd

ϕ3 va
ϕ6 ´1

0

1
ϕ6 ´1

1

0

va
ϕ6 ´1

vc
ϕ6 ´1

0

As above, we obtain the measure of the cylinders of size |w| “ 2 through the normalization µ1 prwsq “
1
11ϕ`8 vw .
The case k “ 2: We proceed precisely as in the case k “ 1 to compute from Mσ2 an integer
eigenvector for the eigenvalue ϕ3 :
va

vb

vc

5ϕ ` 2 2ϕ ` 3 2ϕ ` 2
We next determine
Sσ2
as well as:

»

0
— 1
“—
– 0
0

1
0
0
0

0
0
1
0

vd
ϕ

»
ﬁ
0 1
0
— 1 0
0 ﬃ
ﬃ , Pσ “ —
2
– 0 0
0 ﬂ
0 0
1

0
0
1
0

ﬁ
0
0 ﬃ
ﬃ.
1 ﬂ
0

.
.
.
p|σ2 paq|xy qx,yPA “ p1, 1, 1, 0 .. 1, 0, 0, 0 .. 1, 0, 0, 0 .. 0, 0, 0, 0q
.
.
.
p|σ2 pbq|xy qx,yPA “ p0, 1, 0, 0 .. 1, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 0q
19

.
.
.
p|σ2 pcq|xy qx,yPA “ p0, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 1 .. 0, 0, 1, 0q
.
.
.
p|σ2 pdq|xy qx,yPA “ p0, 0, 0, 0 .. 0, 0, 0, 0 .. 0, 0, 0, 1 .. 0, 0, 0, 0q
We thus compute

and obtain:

$
$
va ` vbb “ ϕ3 vaa
va ` vb ` vab “ ϕ3 vba
’
’
’
’
’
’
&v ` v ` v “ ϕ3 v
&v “ ϕ3 v
a
aa
b
ba
ab
bb
3
’
’
va ` vbc ` vbd “ ϕ vac ’vac ` vad “ ϕ3 vbc
’
’
’
%
%
0 “ ϕ3 vad
0 “ ϕ3 vbd
$
$
va ` vcb “ ϕ3 vca
vdb “ ϕ3 vda
’
’
’
’
’
’
&v “ ϕ3 v
&v “ ϕ3 v
ca
cb
da
db
3v
’
’
v
`
v
“
ϕ
v
`
v
`
vdd “ ϕ3 vdc
cc
cc
c
cd
dc
’
’
’
’
%
%
vc ` vd “ ϕ3 vcd
0 “ ϕ3 vdd
vaa

vab

vac

vad

vba

vbb

vbc

vbd

ϕ3 va
ϕ6 ´1

va `vb
ϕ3 ´1

ϕ3 va
ϕ6 ´1

0

va `vb
ϕ3 ´1

va
ϕ6 ´1

va
ϕ6 ´1

0

vca

vcb

vcc

vcd

vda vdb

vdc

vdd

va
ϕ6 ´1

vc `vd
ϕ3 pϕ3 ´1q

vc `vd
ϕ3

vc
ϕ3 ´1

0

va ϕ3
ϕ6 ´1

0

0

As for k “ 1 we obtain the measure of any cylinder of size |w| ď 2 from the coefficients vw through
a normalization given by:
vw
µ2 prwsq “
10ϕ ` 7
References
[1] M. Adamska, S. Bezuglyi, O. Karpel, and J. Kwiatkowski, Subdiagrams and invariant measures on Bratteli
diagrams. Ergodic Theory Dynam. Systems 37 (2017), 2417–2452
[2] N. Bédaride, A. Hilion and M. Lustig, Graph towers, laminations and their invariant measures. J. London
Math. Soc. 95 (2020), 1–61
[3] V Berthé and V. Delecroix, Beyond substitutive dynamical systems: S-adic expansions. RIMS Kôkyûroku
Bessatsu B46 (2014), 81–123
[4] S. Bezuglyi, O. Karpel and J. Kwiatkowski, Exact number of ergodic invariant measures for Bratteli diagrams.
J. Math. Anal. Appl. 480 (2019), Article 123431
[5] S. Bezuglyi, J. Kwiatkowski, K. Medynets and B. Solomyak, Invariant measures on stationary Bratteli diagrams. Ergodic Theory Dynam. Systems 30 (2010), 973–1007
[6] F. Durand, Combinatorics on Bratteli diagrams and dynamical systems. In “Combinatorics, automata and
number theory”, Encyclopedia Math. Appl. 135, 324–372, Cambridge Univ. Press, Cambridge 2010
[7] F. Durand, J. Leroy and G. Richomme, Do the properties of an S-adic representation determine factor complexity ? J. Integer Sequences 16 (2013), Article 13-2-6
[8] S. Ferenczi, A. M. Fisher and M. Talet, Minimality and unique ergodicity for adic transformations. J. Anal.
Math. 109 (2009), 1–31
[9] A. B. Katok, Invariant measures of flows on orientable surfaces. Dokl. Akad. Nauk SSSR 211 (1973), 775–778
[10] W. A. Veech, Moduli spaces of quadratic differentials. J. Analyse Math. 55 (1990), 117–171
[11] P. Walters, Ergodic theory – introductory lectures, Lecture Notes in Mathematics 458, Springer-Verlag, BerlinNew York, 1975.
Aix Marseille
E-mail address:
E-mail address:
E-mail address:

Université, CNRS, Centrale Marseille, I2M UMR 7373, 13453 Marseille, France
Nicolas.Bedaride@univ-amu.fr
Arnaud.Hilion@univ-amu.fr
Martin.Lustig@univ-amu.fr
20

