No–Arbitrage Commodity Option Pricing
with Market Manipulation

arXiv:1909.07896v2 [q-fin.MF] 3 Mar 2020

René Aïd∗ Giorgia Callegaro† Luciano Campi‡
March 4, 2020

Abstract
We design three continuous–time models in finite horizon of a commodity price,
whose dynamics can be affected by the actions of a representative risk–neutral
producer and a representative risk–neutral trader. Depending on the model, the
producer can control the drift and/or the volatility of the price whereas the trader
can at most affect the volatility. The producer can affect the volatility in two ways:
either by randomizing her production rate or, as the trader, using other means
such as spreading false information. Moreover, the producer contracts at time zero
a fixed position in a European convex derivative with the trader. The trader can
be price-taker, as in the first two models, or she can also affect the volatility of the
commodity price, as in the third model.
We solve all three models semi–explicitly and give closed–form expressions of
the derivative price over a small time horizon, preventing arbitrage opportunities
to arise. We find that when the trader is price-taker, the producer can always
compensate the loss in expected production profit generated by an increase of
volatility by a gain in the derivative position by driving the price at maturity to
a suitable level. Finally, in case the trader is active, the model takes the form of
a nonzero-sum linear-quadratic stochastic differential game and we find that when
the production rate is already at its optimal stationary level, there is an amount of
derivative position that makes both players better off when entering the game.
Keywords: price manipulation, fair game option pricing, martingale optimality
principle, linear-quadratic stochastic differential games.

∗

Université Paris-Dauphine, PSL Research University, LEDa. Email: rene.aid@dauphine.psl.eu.
Università degli Studi di Padova, Dipartimento di Matematica, Via Trieste 63, I-35121 Padova,
Italy. Email: gcallega@math.unipd.it.
‡
London School of Economics, Department of Statistics, Columbia House, 10 Houghton Street,
WC2A 2AE, London, United Kingdom. Email: l.campi@lse.co.uk.
†

1

1

Introduction

The methods and techniques of manipulation are limited only by the ingenuity of man,
in Cargill vs Hardin, US Court of Appeal, 8th circuit, Dec 7, 1971.
Price manipulation in financial markets is not the rare event as one may think. In
their paper, Aggarwal and Wu [1] provide data on more than 140 cases of market stock
price manipulation in the sole period of ten years from 1990 to 2001 released by the
Security Exchange Commission. As the authors quote, those cases only correspond to
those who were caught. On commodity markets, illegal practices of market manipulations are abundantly documented and can compete with stock markets (see Pirrong
[20] for a survey of those practices). More recently, the LIBOR itself was the object of
a coordinated manipulation by a cartel of banks. The LIBOR, created more than fifty
years ago and controlled by the British Bankers Association, serves as a benchmark for
loans and as an index in hundreds of trillions of nominal in derivatives. It is enough
to read Duffie and Stein [7] to measure the extent of social welfare loss induced by
the manipulators actions. In their report for the Federal Reserve Bank of New York
on the LIBOR scandal, Hou and Skeie [14] explain that if the first motivation for this
manipulation in the aftermath of the 2008 financial crisis was to maintain a signal of
credit worthiness, the second motivation was the express intent of benefiting the bank’s
derivatives positions.
Indeed, if the first generation of market price manipulation concentrated on using
some market power to increase the market price and then resell the good at a higher
price (unravelling strategy), it seems that the second generation of market manipulation
will use the leverage effect provided by derivatives. Worrying enough to support this
prognosis, the recent paper of Griffin and Shams [12] asserts the possibility of an on–
going VIX manipulation using large position in the out–of–the money options used to
compute the VIX. If true, it would mean that some traders are already engaged in what
was thirty years ago a theoretical problem in derivative pricing when academics would
relax the hypothesis of no–market impact in the Black & Scholes pricing framework (see
Jarrow [15] for a seminal work on this subject).
In this paper, we take market price manipulation models one step further in considering the possibility of the joint control of the average (the drift) and of the volatility
of a commodity price by the actions of a producer and a trader who exchange a derivative. To analyse the behaviours of both players and the distortion of the prices of the
commodity and of the derivative, we design three continuous–time models of increasing
complexity. In each model, the commodity price is impacted by the actions of a representative risk–neutral producer and a representative risk–neutral trader. Both agents
want to maximise their respective expected profits. The representative producer has
market power and can increase or decrease the price by reducing or increasing her production rate. Actions on the volatility can be performed either by randomizing the
production rate or by spreading false information. Production randomization is just
making a strategic use of outages and the question answered in this paper is when this
device has an interest for the producer. Further, regarding the use of information on
2

the volatility, we suppose that the trader or the producer has identified some channels
allowing her to act on the nominal volatility of the underlying by an appropriate rate
of information. For both agents, manipulation of the commodity price comes at some
costs, which are included in their profit functions.
We consider first the case of production–based manipulation: the producer acts
alone and can impact both the average price and its volatility by changing her average
production rate and the volatility of her production rate. Second, we consider the case of
production and information–based manipulation by a producer: the producer acts alone,
she can affect the average price by changing her production rate and the volatility as
mentioned above, e.g. by spreading appropriate information. Finally, we consider the
case of a competition between a producer who can exert market power on the drift of
the price and a trader who has an impact on the volatility of the price. In each case, we
suppose that the producer contracts at time zero a constant (long or short) position of a
European convex derivative and delivers (or receives) its payoff at maturity. The trader
has the opposite position in the derivative. Since they have an asymmetric impact on
the dynamics of the commodity price, we are able to assess which instrument is more
efficient, manipulation of the drift or manipulation of the volatility. We aim at studying
to which extent the producer and the trader can profit from their market power and
how the prices of the commodity and its derivatives can be distorted by their actions.
In the classification of market manipulation provided by Allen and Gorton [3], the
first model corresponds to an action–based manipulation (using physical means such
as production); the second model is a mixture of action–based and information–based
(spreading false rumours on commodity scarcity or accounting and earnings’ manipulation); the last one is a mixture of action–based, information–based and trading–based
(buying to increase the price and then selling back).
To our knowledge, this is the first paper to study the joint manipulation of a commodity price and a derivative. We give now some reasons why our analysis might get
even more relevant in a near future.
First, the commodity business has gone through a concentration trend in the last
decades with the emergence of major players like Glencore/Xstrata, Rio Tinto or BHP
Billinton. A small amount of international firms concentrate in their hands a significant
volume of minerals production. For instance, Glencore concentrate 60% of the zinc,
50% of the copper, 45 % of the lead and 38% of the aluminium. At the same time, they
have to take significant position in the financial markets to hedge their big physical
positions. For instance, Glencore [10, note 28, p. 201] shows a position of $3.2 billion
of commodity related contracts including futures, options, swaps and physical forwards
compared to an adjusted EBITDA of $15.8 billion or a total asset value of $128 billion.
Rio Tinto [21, notes p. 193] presents an exposition in nominal value of derivatives in
aluminum of $1.786 billion for an EBITDA for aluminum of $3.1 billion and operating
asset value of $16.5 billion. Players of this size cannot ignore that the impact they may
have on the price of a commodity will affect the value of their portfolio derivatives too.
Second, large commodity firms are not the only big players in financial markets to
hold significant positions in commodity derivatives. With the financialization of com-

3

modity markets, large hedge funds, banks and institutional players have increased their
position in commodity derivatives (see Cheng and Xiong [5] for an overview). Thus,
when trying to move the price at her own advantage, a producer may find some opposition from financial actors harmed by her action. This problem is already documented
in the case of large position of derivatives exchanged between financial institution (see
the case of Merrill Lynch selling $500 million of knock–in put options to Leiter’s International in Gallmeyer and Seppi [11]).
Third, the activities of trading in commodity firms are in general isolated in a subsidiary because they fall within the scope of financial regulation. Thus, the trading
activity might end up in conflict with the production activity regarding the use of market power.
Our main results can be summarized as follows. For each model we provide closed–
form solutions in terms of a coupled Riccati systems of ordinary differential equations.
In each model, the price of the derivative is a fair market price in the sense that it is
consistent with no–arbitrage condition. First, we find that in all models, the optimal
production rate of the producer follows the same pattern: during a transitory phase,
it reaches the production rate that maximises the profit rate, then it stays there and
at maturity, the production rate increases (resp. decreases) in case of short position
(resp. long position). In the case of production–based manipulation, it is optimal for
the producer to increase the volatility of the production rate to induce an increase in the
volatility of the derivative if and only if he has a short position in the derivative exceeding
a given threshold. Without derivative position, the value function of the producer is
a non–increasing function of the volatility. Thus the producer prefers to reduce the
volatility. But, when she holds a sufficiently large short position in the derivative, the
increase in volatility that pushes the price of the derivative up can compensate the
induced indirect cost of volatility. Since her impact on the average price is significant,
the producer can compensate the loss in expected profit from production due to an
increase of volatility by an increased profit from the derivative position. When the
producer action on the volatility is information–based, the previous observations still
hold, except that now her value function is increasing in the volatility, providing strong
incentive to raise the volatility even without derivative position. Thus, it results that if
the producer can impact the price to increase her profit in her derivative position, she
does it.
What happens if the producer manipulation can be challenged by a trader taking
an opposite position in the derivative? We find that the actions of the trader on the
volatility only reduces the potential profit made by the producer on the derivative.
Further, despite the asymmetry of powers of the two players, we find that when the
production rate is already at its optimal stationary level, there is an amount of derivative
position that makes both players better off entering the game.
There is a considerable financial economics literature about market manipulation,
which follows in particular a game theoretic approach. A short review of the portion of
such a literature related to stock markets has to start with the seminal work of Kyle [16]
and the work of Allen and Gale [2] who provide a simple information condition under
4

which an uninformed trader can make a profitable unravelling strategy (buying the
stock, making the price rise and sell the stocks at an average higher price). Chatterjea
and Jarrow [4] provide a game theoretic model of US Treasury Securities manipulation.
Cooper and Donaldson [6] design a dynamic game theoretic model of corner strategy.
Regarding commodity price manipulation strategy, thorough analysis are available in
the works of Pirrong [18, 19, 20].
It is also worth mentioning that our modelling and contribution are different from
those in the rich literature on market impact, for which we refer the reader to, e.g., the
recent book by Guéant [13] and the references therein. Indeed, while in market impact
models the drift of the market price is affected by the traders as a consequence of an
optimal execution of a market order, in our setting both drift and volatility are affected
and the impact comes directly from market manipulation. Moreover, the modelled
financial phenomena are different and so are the problems solved (optimal execution vs
profit maximization).
The closest work to ours is the paper by Nyström and Parviainen [17]. The authors
provide a zero–sum game between two players who can control the drifts and the volatilities of a multidimensional stock market and show under mild conditions that the game
has a value and that it is given by the unique viscosity solution of degenerate parabolic
PDE. Considering a more specific model of actors and impact functions, we are able to
provide more insights in the gains of the producer and the trader and the distortion of
prices.
The paper is organised in the following way. Sections 2, 3 and 4 present respectively
the model of manipulation through production, manipulation through information and
competition of manipulation. Section 5 provides numerical illustration of the three
models.

2

Production–based manipulation

This section contains all our results on the first model of a producer of a commodity,
who can manipulate the price of the commodity through production.
More in detail, we consider a producer whose objective is to maximise her profit
from production and from investment in a financial market over the time period [0, T ]
for some T > 0. The producer can increase her production rate qt with the instantaneous
control rate ut at the expense of a cost κ2 u2 with κ > 0. We suppose that the production
is entirely sold at a market price S̃, which can be affected by the producer: the more
the production rate the less the market price. This effect leads to observed market price
S̃t := s0 −a qt where a > 0 is some fixed parameter and s0 > 0 is the market price before
action of the producer (which in this case is constant). We will relax the hypothesis of
a constant market price before impact in the second model (see Section 3). The former
relation can also be seen as an inverse demand function of the good, where a is its
elasticity. Thus, the instantaneous profit rate is Pt := qt S̃t .
We suppose that the production rate qt is affected by a random factor that gathers
all the randomness that usually affects production processes (outages, strikes and so
5

on). We suppose that, without intervention of the producer, uncertainty is normally
distributed with standard deviation σ > 0. Further, we suppose that the producer
has an effect on the uncertainty of his production rate. These hypotheses lead to the
following dynamics for the production rate:
√
dqt = ut dt + σ 1 + zt dWt , q0 ∈ R,
(2.1)
where W is a standard Brownian motion, defined on some probability space (Ω, F, P),
and zt is the effect (in percentage) on the variance of the production rate. The information available to the producer is modelled by the natural filtration, (Ft )t∈[0,T ] =
(FtW )t∈[0,T ] , generated by the Brownian motion W and completed with all P-null sets.
Hence, anywhere in this section adaptedness will always be referred to this filtration.
We suppose that controlling zt requires some financial cost g2 z 2 with g > 0. The
producer can choose either to decrease or to increase the volatility of the production rate
qt . Although the costs incurred to increase the volatility are less easy to grasp than the
cost involved to decrease it, they can be interpreted as the costs of the actions needed
to hide them.
At this stage of the model description, we notice that an increase of the volatility of
qt has a negative impact on the expected instantaneous profit E[Pt ] = s0 E[qt ] − aE[qt2 ].
In other terms, the producer is Gamma negative. Thus, he has no incentive to increase
the volatility of his production facilities.
Most large commodity producers make an important use of financial market for
hedging purposes. Hence, we suppose that the producer intervenes in the financial market for his production good by selling derivatives at the initial time. Since the producer
is Gamma negative, a natural hedge would be to sell a Gamma positive derivative such
as a call option. Here, we suppose that the producer has a net derivative position λ
which can be positive (short, sale) or negative (long, purchase) with maturity T and
payoff hT := S̃T2 . Such a quadratic payoff can be seen as a position over a portfolio of
call options with the same maturity T and different strike prices. We denote by h0 the
price at time 0 of that option, its precise definition will be given when specifying the
set of admissible controls. Indeed, h0 is not given from the outset, as it depends on the
underlying which is in turn controlled.
The aim of the producer is to maximise the following objective functional
Z T 


κ 2 g 2
λ
J (u, z, h0 ) := E
Pt − ut − zt dt + λ h0 − hT .
(2.2)
2
2
0
Now, within the producer firm, there are two distinct departments, a production department and an investment department. The former takes any production–related
decisions, i.e. it controls u and z, while the latter is responsible for selling/buying the
derivatives at a fair price and pursuing the corresponding hedging strategy. It is natural
to assume that the investment department is using the nowadays classical no-arbitrage
machinery to propose a derivative’s price. The two departments are aware of the fact
that their decision affects each other. In particular, the fact that the investment department uses the no-arbitrage approach to price derivatives implies the following natural
6

constraints for the production side: the chosen production plan should not lead to
arbitrage opportunities. We are going to incorporate this idea into the definition of
admissible policies. After that, we will give the precise formulation of the producer
optimization problem.
Definition 2.1. We say that any pair (u, z) is admissible if the following properties are
satisfied:
(i) (ut , zt )t∈[0,T ] are progressively measurable processes with values in R × (−1, ∞)
such that
Z T

Z T

2
2
2
E
(ut + zt )dt < ∞, E
qt (1 + zt )dt < ∞;
0

0

(ii) there exists a unique equivalent martingale measure Qu,z for the price process S̃,
equivalently for the production process (qt )t∈[0,T ] , with hT ∈ L1 (P) ∩ L1 (Qu,z );
(iii) there exists a real-valued progressively measurable process (∆u,z
t )t∈[0,T ] satisfying
Z T


u,z
u,z 2
E
|∆t ut | + |∆t | (1 + zt ) dt < ∞,
0

and such that the following holds Qu,z -a.s.
hu,z
t

Qu,z

:= E

Qu,z

[hT |Ft ] = E

Z
[hT ] +

t

∆u,z
s dqs ,

0

for all t ∈ [0, T ].
The set of all admissible pairs will be denoted by A.
u,z

Hence hu,z
= EQ [hT ] can be viewed as the price of the option hT under the
0
production control (u, z). Notice that such a price is clearly affected by the controls
via the risk neutral measure in (ii). It can be interpreted as “commitment price”: after
selling the option, the producer could deviate from the implementation of the hedging
strategy that leads to the measure Qu,z . Here we make the assumption that the producer
implements the production controls leading to precisely that measure and thus, that
price.
Notice that from q’s dynamics we have that the measure Qu,z , whose existence is
postulated in (ii) above, is necessarily given by the following Radon-Nikodym derivative
 Z T

Z
dQu,z
1 T 2
ut
= exp −
δt dWt −
δt dt , δt = √
.
dP
2
σ
1
+ zt
0
0
Before giving the final formulation of the producer optimization problem, we can exploit
the admissibility properties above to rewrite the objective functional (2.2) as follows
Z T 
 
κ 2 g 2
u,z
λ
J (u, z, h0 ) = E
Pt − ut − zt − λ∆t ut dt =: J˜λ (u, z).
2
2
0
7

Indeed, condition (iii) implies that
Z
Z T
∆u,z
dq
=
hT − h0 =
t
t

T

0

0

√
∆u,z
t (ut dt + σ 1 + zt dWt ).

Condition (iii) implies that the dW -part above has zero expectation under P. Moreover,
we observe that the integrability assumptions in (i) and (iii) ensure that J˜λ (u, z) is
finite.
Finally, after all these preliminaries, we can formulate the producer’s optimization
problem
sup J˜λ (u, z).
(2.3)
(u,z)∈A

2.1

Heuristics

In this part we develop the heuristics needed to obtain a candidate for the solution of
problem (2.2). In the next sub-section, we will verify that the candidate is indeed the
optimal solution according to the definition above.
First, notice that, since the market is complete, there exists only one possible noarbitrage price for the derivative hT , which also gives the initial wealth needed to fund
the hedging strategy. The derivative can be perfectly replicated by trading in a selffinancing way in the underlying S̃t = s0 − aqt or, equivalently, in qt . Therefore
Z T
Q
hT = E [hT ] +
∆t dqt ,
0

where Q is the unique equivalent martingale measure for S̃ (or, equivalently, for q), and
∆ is the delta hedging. More precisely, using Girsanov’s theorem we get the dynamics
of q under Q, which is
√
dqt = σ 1 + zt dWtQ , dWtQ = dWt − δt dt,
where δt =

√ut
σ 1+zt

for t ∈ [0, T ]. Hence, defining the price at time t of the derivative as
ht = EQ [(s0 − aqT )2 |qt ] := ϕ(t, qt ),

we obtain the usual PDE for the price
1
ϕt + σ 2 (1 + z(t, q))ϕqq = 0,
2

ϕ(T, q) = (s0 − aq)2 .

(2.4)

Finally, we have the usual relationship ∆t = ϕq (t, qt ).
Remark 2.1. Notice from Equation (2.4) that ϕ depends on z in a functional way.
However we expect the optimal control to be Markovian, which justifies replacing zt
(which could in principle depend on the whole path of the state variable (qt )) with the
function z(t, q) of time and of the value q of state variable at time t. The PDE above
needs to be solved together with the HJB equation for the value function, since the
coefficient of the second derivative ϕqq depends on the control z.
8

The perfect replicability of the derivative allows us to rewrite the objective function
in a more suitable way as at the end of the previous sub-section. Indeed, observe first
that
Z T
Z T
√
h0 − hT = −
∆t dqt = −
ϕq (t, qt )(ut dt + σ 1 + zt dWt ),
0

0

where recall that W is a Brownian motion under P. Hence, given the hedging strategy
ϕq (t, qt ), the maximization problem on the production side can be expressed as follows
Z T 
 
g 2 κ 2
λ
v (0, q0 ) := sup E
qt (s0 − aqt ) − zt − ut − λϕq (t, qt )ut dt .
(2.5)
2
2
u,z
0
In other terms, the gain coming from selling the derivative has been absorbed by the
running profit term. Therefore, we can get the HJB equation


σ2
g 2 κ 2
(2.6)
−vt = sup q(s0 − aq) − z − u − λϕq (t, q)u + uvq + (1 + z)vqq ,
2
2
2
u,z
with terminal condition v(T, q) = 0. Notice that the PDE for the price (2.4) and the
HJB equation for the value function are clearly coupled as the optimal z appears in
the pricing PDE, while the derivative of the price, ϕq , appears in the HJB equation
(compare to Remark 2.1). The first order conditions give the two (candidate) optimal
controls
1
σ2
u
b = (vq − λϕq ) , zb =
vqq .
(2.7)
κ
2g
Notice that we have dropped the dependence upon λ in the value function for sake of
readability. In order to get the full solution, it is natural to make the following
Ansatz 2.1. Both solutions ϕ and v λ are quadratic in q, i.e.
ϕ(t, q) = A(t)q 2 + B(t)q + C(t),

v λ (t, q) = D(t)q 2 + E(t)q + F (t),

where A, B, C, D, E, F are deterministic functions of time, to be determined.
Solving for ϕ. To ease the notation, we drop the dependence of time from A, B and
so on. First of all, applying the Ansatz 2.1 to the candidate optimal controls gives
u
b=

1
(2q(D − λA) + E − λB) ,
κ

zb =

σ2
D.
g

Next, we substitute the expression above for u
b and zb in the pricing PDE (2.4) and we
obtain


σ2
2
σ 1 + D A + A0 q 2 + B 0 q + C 0 = 0, A(T )q 2 + B(T )q + C(T ) = s20 − 2as0 q + a2 q 2 .
g
In particular, the terminal condition for ϕ gives the corresponding terminal conditions
for A, B, C as
A(T ) = a2 , B(T ) = −2as0 , C(T ) = s20 .
9

By identification of the terms in q, we get the following ODEs for A, B and C


σ2
0
0
0
2 2
A = 0, B = 0, C = −σ a 1 + D ,
g
which can be easily solved using the terminal conditions above. Indeed, we obtain

Z T
σ2
2
2
2 2
1 + D(r) dr,
A(t) = a , B(t) = −2as0 , C(t) = s0 + σ a
(2.8)
g
t
for all t ∈ [0, T ]. Notice that the function D(t) will be obtained when solving the HJB
equation (2.6).
Solving for v λ . Substituting the Ansatz 2.1 for v λ (together with the optimal controls)
in the HJB equation (2.6) and identifying the terms in q, we obtain the following ODEs
for D, E and F
2
(D − λA)2 , D(T ) = 0,
κ
2
= s0 + (D − λA)(E − λB), E(T ) = 0,
κ
σ4 2
1
=
D + σ2D +
(E − λB)2 , F (T ) = 0.
2g
2κ

−D0 = −a +
−E 0
−F 0

Now, using (2.8) implies
2
(D − λa2 )2 ,
κ
2
= s0 + (D − λa2 )(E + 2λas0 ),
κ
σ4 2
1
=
D + σ2D +
(E + 2aλs0 )2 ,
2g
2κ

−D0 = −a +
−E 0
−F 0

(2.9)
(2.10)
(2.11)

with null terminal conditions D(T ) = E(T ) = F (T ) = 0.
Remark 2.2. We observe that, while the equation for D is a one-dimensional Riccati
ODE, the second one is linear and the third one can be solved just by integration. The
Riccati equation (2.9) can be easily proved to have a unique solution over the whole
time interval [0, T ]. Indeed, this is a direct consequence of, e.g., Lemma 10.12 in [9].
Moreover, that lemma also implies that
D(t) ≤ 0 for all t ∈ [0, T ]

⇔

D0 (T ) = a −

2λ2 a4
≥ 0,
κ

which will be important later for the interpretation of our results. The value a −
corresponds to the slope of D close to T .

10

2λ2 a4
κ

Set θ =

p
8a/κ. Solving the equations above gives the following expressions
D(t) =
E(t) =
F (t) =

2λ2 a4
θ(T −t) − 1)
κ )(e
−
,
2
θ(T −t) − 1)
θ(eθ(T −t) + 1) + 4λa
κ (e

Z T R
u 2
4aλ
(D(r)−λa2 )dr
t
κ
1+
(D(u)
e
s0
κ
t
Z T 4
σ
1
2
2

2(a −

t

2g

D(u) + σ D(u) +

2κ

(2.12)


− λa ) du,

(E(u) + 2aλs0 )2 du ,
2

(2.13)

(2.14)
for all t ∈ [0, T ].

2.2

Verification

We conclude the section with the verification that the candidate described above is
indeed a solution to problem (2.3).
Theorem 2.1. Let D, E be deterministic functions of time as in, respectively, (2.12)
g
2
and (2.13). Whenever H := 1 − 2λa
κ (λa − σ 2 ) > 0, we assume that the maturity T is
small enough, more precisely
 2

2
−1 2σ a
T < Tmax := coth
H .
(2.15)
θ
θg
Then there exists an optimal policy (b
u, zb) ∈ A for problem (2.3), where the production
policies are
u
bt =


1
2b
qt (D(t) − λa2 ) + 2as0 λ + E(t) ,
κ

zbt =

σ2
D(t),
g

t ∈ [0, T ].

The no-arbitrage price process for the derivative hT is given by

Z T
σ2
u
b,b
z
2
2 2
b
1 + D(u) du, t ∈ [0, T ],
ht := ht = (s0 − ab
qt ) + σ a
g
t

(2.16)

(2.17)

and the hedging process is
b t := ∆ub,bz = 2a(ab
∆
qt − s0 ),
t

t ∈ [0, T ],

where the production rate is

Z t
1
R(t)
qbt = e
q0 +
e−R(s) (−2λa2 + 2as0 λ + E(s))ds
κ
0
s
)
Z t
2
σ
+
e−R(s) σ 1 + D(s)dWs ,
g
0
with R(t) :=

Rt

2
0 κ D(s)ds.

11

(2.18)

(2.19)

Proof. The proof is structured in two steps.
1. Admissibility. Let us verify that the pair (b
u, zb) given in the statement above belongs
to A. We start from condition (i) in Definition 2.1. First, u
b, zb are trivially progressively
2
measurable and real valued. We need to check zbt > −1, which is equivalent to σg D(t) >
2 4

−1. We distinguish two cases: if a ≤ 2λκa we have D(t) ≥ 0 (this is a consequence
of Remark 2.2 or, alternatively, the explicit formula (2.12)), hence zbt > −1 for all
2 4
t ∈ [0, T ]. On the other hand, if a > 2λκa , it follows from expression (2.12) that D(t) is
nondecreasing with D(T ) = 0. Therefore, it suffices to check that D(0) > −g/σ 2 , where
D(0) =

2λ2 a4
κ )
−
2
θT
θ coth( 2 ) + 4λa
κ

2(a −

.

After some computation, we obtain that D(0) > −g/σ 2 if and only if
 
θT
2σ 2 a
coth
>
H,
2
θg
where H is the constant defined in the statement. Now, if H < 0 the inequality above
is always satisfied as the LHS above is nonnegative. If H > 0, the inequality above
is guaranteed by the condition T < Tmax . We can conclude that even in this second
case, provided T < Tmax , we have zbt > −1 for all t ∈ [0, T ]. Regarding the integrability
properties, we verify now that
Z T

Z T

2
2
2
E
(b
ut + zbt )dt < ∞, E
qbt (1 + zbt )dt < ∞,
(2.20)
0

0

where qb = q ub,bz . Since u
b is affine in qb with continuous time-dependent coefficients and zb
is deterministic and continuous in t, checking the properties above boils down to show
Z T

2
E
qbt dt < ∞.
0

RT
RT
First, we use Fubini’s theorem to get E[ 0 qbt2 dt] = 0 E[b
qt2 ]dt. Moreover, since qbt is a
Gaussian random variable for any fixed t (see Remark 2.3 below), the function t 7→ E[b
qt2 ]
is continuous over [0, T ], so its integral is finite.
b = Qub,bz
Regarding condition (ii), we need to show that there exists a unique EMM Q
for the production process qb. Let us recall that
 Z T

Z
b
dQ
1 T b2
b
= exp −
δt dWt −
δ dt ,
dP
2 0 t
0

u
bt
δbt = √
.
σ 1 + zbt

b is
We use [23, Theorem 2.1] to prove that under our assumptions the probability Q
well-defined (see also [22] for more general results of the same type). According to that
results, we need to check Assumption 2.2 in [23], which in our case is satisfied as long
12

as σ 2 (1 + zbt ) > 0 for all t ∈ [0, T ]. By the same arguments used for condition (i), we get
the result. A standard application of Girsanov theorem, together with the integrability
b
properties in (2.20), yields immediately that qb is a martingale under Q.
b Now, hT =
To end checking condition (ii), we have to show hT ∈ L1 (P) ∩ L1 (Q).
(s0 − ab
qT )2 , hence quadratic in qbT . Since under both probability measures qbT is a
b which gives the desired property.
Gaussian random variable, we have qT2 ∈ L1 (P)∩L1 (Q),
b is trivially a progressively measurWe pass to condition (iii) in Definition 2.1. First, ∆
b are
able process with real values. For the integrability property, Rsince both u
b and ∆
T 2
linear in qbt , we are again reduced to the square integrability E[ 0 qbt dt] < ∞, which has
been proved just before.
To conclude this part of the proof, it remains to check that, given (b
u, zb) as above,
Rt
b
b
u
b,b
z
Q
Q
b
b
b
ht := ht = E [hT |Ft ] = E [hT ] + 0 ∆s dqs a.s. under Q, for all t ∈ [0, T ]. This can
be done by direct computation as follows: applying Itô’s formula to b
ht in (2.17) we get
db
ht = −2a(s0 − ab
qt )db
qt
whence, in integral form,
Z
b
ht = b
h0 − 2a

t

Z

t

(s0 − ab
qs )db
qs = b
h0 +
0

b s db
∆
qs .
0

Moreover, one easily find
b q 2 ],
b T ] = E[(s
b 0 − ab
E[h
qT )2 ] = s20 − 2as0 q0 + a2 E[b
T
b denotes the expectation with respect to the measure Q.
b Using Itô’s isometry,
where E
we also have


Z T
2
σ
2
2
2
bq ]=q +
E[b
σ 1 + D(t) dt,
T
0
g
0
which leads to the remaining property in (iii).
2. Optimality. To check the optimality condition, we are going to use the martingale
optimality principle (see [8]). Let us define the process
Z t

g
κ
b r ur dr + V (t, qt ),
Ytu,z :=
(2.21)
qr (s0 − aqr ) − zr2 − u2r − λ∆
2
2
0
with
V (t, q) = D(t)q 2 + E(t)q + F (t).
Thanks to the martingale optimality principle, proving that Y u,z is a supermartingale
for all (u, z) ∈ A and a martingale for (u, z) = (b
u, zb), will give us the result. Itô’s
formula yields


g 2 κ 2
1
u,z
2
b
dYt = qt (s0 − aqt ) − zt − ut − λ∆t ut + Vt + Vq ut + Vqq σ (1 + zt ) dt
2
2
2
√
+ Vq σ 1 + zt dWt ,
(2.22)
13

where Vt , Vq , Vqq denote partial derivative of the function V (t, q). We have omitted the
dependence on (t, q) for sake of simplicity. RFirst,√notice that due to the integrability
t
properties in Definition 2.1(i) the process 0 Vq σ 1 + zr dWr is a true P-martingale.
Therefore, it remains to show that the dt-part in (2.22) above is a nonincreasing process,
that is it is lower or equal to zero almost everywhere. By construction (see heuristics),
we know that the function V (t, q) satisfies the HJB equation (2.6), with
ϕq (t, q) = 2a2 q − 2as0 ,
b t for all t. We can conclude that the drift in (2.22) is lower or equal to
hence ϕq (t, qt ) = ∆
zero a.e., yielding that Y u,z is a supermartingale for all (u, z) ∈ A. To show that Y ub,bz is
a martingale, one proceeds in the same way getting equalities instead of inequalities. In
particular one gets that the drift in (2.22) is equal to zero a.e., implying the martingale
property.
Finally, we can solve for qbt in explicit form, via standard resolution methods, since it is
the unique solution of the following linear SDE
s

1
σ2
db
qt =
2b
qt (D(t) − λa2 ) + 2as0 λ + E(t) dt + σ 1 + D(t)dWt , qb0 = q0 .
κ
g

Remark 2.3. Notice, from Equation (2.19), that qbt is a Gaussian random variable with
time-dependent mean and variance.

3

Production and information based manipulation

In this section we describe and solve explicitly a variant of the model presented before.
We still have a producer of a commodity, who is maximizing her profit coming from
both production and a short/long position in some derivative. The main differences are
that the market price of the commodity is no longer a constant as it is driven by the
Brownian motion W , that in turn does not affect the production rate anymore and,
finally, the producer can directly control the volatility of the market price (by spreading
false information on the state of his production, for instance). Thus, the dynamics of
the state variables is now given by

√
dSt = µ dt + σ 1 + zt dWt ,
(3.1)
dqt = ut dt.
Moreover in this model the market price S̃ is given by S̃t = St − aqt , t ∈ [0, T ]. The
objective of the producer is the same as before, i.e.
Z T 


κ 2 g 2
λ
J (u, z, h0 ) := E
Pt − ut − zt dt + λ h0 − hT .
(3.2)
2
2
0
Analogously to the previous model, we will be working with the following definition of
admissible policies, which admits the same interpretation as before.
14

Definition 3.1. We say that any pair (u, z) is admissible if the following properties are
satisfied:
(i) (ut , zt )t∈[0,T ] are progressively measurable processes with values in R × (−1, ∞)
such that
Z T

Z T

2
2
2
E
(ut + zt )dt < ∞, E
S̃t (1 + zt )dt < ∞;
0

0

(ii) there exists a unique equivalent martingale measure Qu,z for the price process S̃,
with hT ∈ L1 (P) ∩ L1 (Qu,z );
(iii) there exists a real-valued progressively measurable process (∆u,z
t )t∈[0,T ] satisfying
T

Z
E
0

|∆u,z
t ut |

+

2
|∆u,z
t | (1


+ zt ) dt < ∞,


and such that the following holds Qu,z -a.s.
u,z

hu,z
:= EQ
t

u,z

[hT |Ft ] = EQ

Z
[hT ] +

t

e
∆u,z
s dSs ,

0

for all t ∈ [0, T ].
The set of all admissible pairs will be denoted by A.
Analogously as in the previous model, from S̃’s dynamics we have that the measure
Qu,z , whose existence is postulated in (ii) above, is necessarily given by the following
Radon-Nikodym derivative

 Z T
Z
dQu,z
µ − aut
1 T 2
γt dt , γt = √
.
= exp −
γt dWt −
dP
2 0
σ 1 + zt
0
Before giving the final formulation of the producer’s optimization problem in this model
as well, we can exploit the admissibility properties above to rewrite the objective functional (3.2) as follows
λ

Z

J (u, z, h0 ) = E
0

T



 
κ 2 g 2
u,z
Pt − ut − zt − λ∆t (µ − aut ) dt =: J˜λ (u, z).
2
2

Finally, the producer’s optimization problem, that we are going to solve in the next
sub-section, is given by
sup J˜λ (u, z).
(3.3)
(u,z)∈A

15

3.1

Heuristics

In this sub-section we describe the heuristics that led us to propose some candidate
solution. It follows the same lines as in the first model. Being the market complete,
there exists a unique martingale measure Q under which Se is a martingale. Indeed we
have
√
dSet = (µ − aut )dt + σ 1 + zt dWt
√
√
= (µ − aut − γt σ 1 + zt )dt + σ 1 + zt dWtQ ,
µ−au
e is a Q-martingale.
√ t , S
σ 1+zt
EQ [SeT2 ], so that we expect that

where W Q is a Q-Brownian motion and by choosing γt =

The price at time t = 0 of the European claim hT equals
RT
hT = h0 + 0 ∆t dSet , where ∆ is the corresponding delta hedging strategy. Hence, the
difference h0 − hT also reads
Z T
h0 − hT = −
∆t dSet .
(3.4)
0

The last quantity to be introduced is the financial claim’s price, that we denote by ϕ:
h
i
ϕ(t, q, s) := EQ SeT2 |qt = q, St = s .
Remark 3.1. Notice that the filtration generated by q and Se is the same as the one
e
associated with q and S, namely FtS ∨Ftq = FtS ∨Ftq for every t ∈ [0, T ]. We conveniently
choose to consider q and S as state variables.
We clearly expect ϕ to solve the following PDE
(
2
ϕt + σ2 (1 + z(t, q, s))ϕss = 0
ϕ(T, q, s) = (s − aq)2 .

(3.5)

∂ϕ ∂s
∂ϕ
e
Since we formally have ∆ := ∂ϕ
∂e
s = ∂s ∂e
s = ∂s , using the dynamics S under P together
λ
with (3.4) we find that the value function v satisfies
Z T 
 
g 2 κ 2
λ
v (0, q0 , s0 ) = sup Eq0 ,s0
qt (St − aqt ) − zt − ut − λϕs (t, qt , St )(µ − aut ) dt .
2
2
u,z
0

The value function v λ is solution to the following HJB equation, which depends on ϕ
(satisfying (3.5))


−vt = supu,z q(s − aq) − g2 z 2 − κ2 u2 − λϕs (µ − au) + vq u + vs µ

2
(3.6)
+ σ2 (1 + z)vss

v(T, q, s) = 0
Ansatz 3.2. We guess the value function v and the price ϕ have the following form
v(t, q, s) = A(t)q 2 + B(t)s2 + C(t)qs + D(t)q + E(t)s + F (t),
ϕ(t, q, s) = Ā(t)q 2 + B̄(t)s2 + C̄(t)qs + D̄(t)q + Ē(t)s + F̄ (t).
16

The first order conditions on the (3.6) lead us to the candidate optimal controls
zb =

σ2
vss ,
2g

u
b=

1
(aλϕs + vq ) ,
κ

and thus, using the ansatz above,
zbt =

σ2
B(t)
g

u
bt =


1 
λa 2B̄(t)s + C̄(t)q + Ē(t) + 2A(t)q + C(t)s + D(t) ,
k
(3.7)

for all t ∈ [0, T ].
Solving for ϕ. We can now explicitly find ϕ by exploiting the Ansatz 3.2 and replacing
the control pair (b
u, zb) into (3.5). We find:

Ā(t) ≡ a2




B̄(t) ≡ 1




 C̄(t) ≡ −2a
D̄(t) ≡ 0


Ē(t) ≡ 0




Z T



σ2

2
 F̄ (t) =
σ 1 + B(u) du
g
t
Solving for v λ . We proceed in the same way as above to find the value function v λ .
We find the following systems of ODEs
A0 (t) = a −

2
2
(A(t) − λa2 )
κ

1
(2λa + C(t))2
2κ
2
C 0 (t) = −1 − (2λa + C(t))(A(t) − λa2 )
κ


2
0
D (t) = − D(t) A(t) − a2 λ − µ C(t) + 2aλ
k

1
0
E (t) = − D(t) C(t) + 2aλ − 2µ(B(t) − λ)
k
1 σ 4 B(t)2 D(t)2
F 0 (t) = −
−
− µE(t) − σ 2 B(t)
2
g
2κ
B 0 (t) = −

(3.8)
(3.9)
(3.10)
(3.11)
(3.12)
(3.13)

with null terminal conditions A(T ) = · · · = F (T ) = 0.
Remark 3.3. Notice, in particular, that B is a positive decreasing function of time,
which implies (recall Equation (3.7)) that the control zb is always positive. This means
that there is always interest in increasing the market price volatility, even if the producer
buys the derivative.

17

3.2

Verification

Theorem 3.1. Let A, B, C, D be solutions to the system (3.8)-(3.13). There exists an
optimal policy (b
u, zb) ∈ A for problem (3.3), where
u
bt =

i
1h
(2λa + C(t))Sbt + 2(A(t) − λa2 )b
qt + D(t) ,
κ

zbt =

σ2
B(t),
g

t ∈ [0, T ]. (3.14)

The no-arbitrage price process for the derivative hT is given by

Z T
σ2
b
1 + B(u) du, t ∈ [0, T ],
ht := hutb,bz = (Sbt − ab
qt ) 2 + σ 2
g
t

(3.15)

and the hedging process is
b t := ∆ub,bz = 2(Sbt − ab
∆
qt ),
t

t ∈ [0, T ].

(3.16)

Proof. The proof is very similar to the previous model (cf. Theorem 2.1), hence we give
details only for those steps which are slightly different.
1. Admissibility. First, we observe that checking the admissibility property (i), namely
zbt > −1 for all t ∈ [0, T ], is actually easier as no conditions on small T are needed.
Indeed, zbt > −1 if and only if B(t) > −g/σ 2 , where B solves the corresponding equation
in the system (3.8)-(3.13). The latter inequality is satisfied since, being B 0 (t) ≤ 0 and
B(T ) = 0, we have B(t) ≥ 0 for all t ∈ [0, T ].
Regarding the integrability properties in (i), checking them is equivalent to show
that

Z T

Z T
2
2
b
qbt dt < ∞, E
St dt < ∞.
E
0

0

b
b
b
As
qfor the condition on S, observe that under P the process S satisfies dSt = µdt +
2
σ 1 + σg B(t)dWt , namely it is a Gaussian process. So, as previously noticed in the
proof of Theorem 2.1, we apply first of all Fubini’s theorem and then we remark that
the function t 7→ E[Sbt2 ] is continuous over [0, T ] and its integral is finite. We now work
on E[b
qt2 ], which is more delicate, since db
qt = u
bt dt and u
b depends also on Sb (see (3.14)).
We have
Z
Z
Z
1 t
2 t
1 t
qbt = q0 +
(2λa + C(s))Sbs ds +
(A(s) − λa2 )b
qs ds +
D(s)ds,
κ 0
κ 0
κ 0

18

and so
E[b
qt2 ]


2
Z t
2
Z
1 t
3
≤ 3 q0 +
D(s)ds + 2 E
(2λa + C(s))Sbs ds
κ 0
κ
0
Z t
2
12
+ 2E
(A(s) − λa2 )b
qs ds
κ
0
2

Z
Z
1 t
3t t
D(s)ds + 2
[2λa + C(s)]2 E[Sbs2 ]ds
≤ 3 q0 +
κ 0
κ 0
|
{z
}
:=α(t)

+

12t
κ2

t

Z

[A(s) − λa2 ]2 E[b
qs2 ]ds.

0

Now, E[Sbs2 ] is positive and finite and so we can safely introduce the positive continuous
function α as above and write
Z
12t t
2
E[b
qt ] ≤ α(t) + 2
[A(s) − λa2 ]2 E[b
qs2 ]ds.
κ 0
An application of Gronwall’s lemma leads to
Z t
Rt
E[b
qt2 ] ≤ α(t) +
α(s)K(s)e s K(u)du ds,
0

[A(u) − λa2 ]2 > 0. So, t → E[b
qt2 ] is bounded by a continuous function
with K(u) := 12t
κ2
and its integral over [0, T ] is finite.
Regarding condition (ii), we proceed again as in the proof of Theorem 2.1 by checking
Assumption 2.2 in [23], which in our case is satisfied as long as σ 2 (1 + zbt ) > 0 for all
t ∈ [0, T ]. This is automatically true, since here B(t) ≥ 0 for all t ∈ [0, T ] and so
2
σ 2 (1 + zbt ) = σ 2 (1 + σg B(t)) ≥ σ 2 > 0. To end checking condition (ii), we have to show
b
b Now, b
hT ∈ L1 (P) ∩ L1 (Q).
hT = (SbT − ab
qT )2 , hence quadratic in both Sbt and in qbT .
For what we have seen up to now qT2 and SbT belong to L1 (P) and they also belong to
b which gives the desired property.
L1 (Q),
It remains to check (iii). We proceed again as in the previous theorem, except that
now b
ht in (3.15) is a function of both Sb and qb. First, notice that
Z t
Z t
b
b
b
b
b
b s dSes .
ht = h0 + 2 (Ss − ab
qs )(dSs − adb
qs ) = h0 +
∆
0

0

√
cs we have
(Sbs − ab
qs )σ 1 + zbs dW
Z t
p
2
b
cs
E[hT |Ft ] = (s0 − aq0 ) + 2 (Sbs − ab
qs )σ 1 + zbs dW
0
Z T

p
b
cs = b
ht .
+2 E
(Sbs − ab
qs )σ 1 + zbs dW

Now, since b
hT = (s0 − aq0 )2 + 2

RT
0

t

19

b in condition (iii) in Definition
Finally, progressive measurability and integrability of ∆
3.1 can be treated exactly as in the proof of Theorem 2.1, using (i).
2. Optimality This can be proved by proceeding exactly as in the proof of Theorem 2.1,
by taking into account that now the state variable is two-dimensional.

4

Producer–trader competition

In this section, we finally consider a game between a producer who can manipulate the
commodity price through the drift and a trader who can manipulate the volatility of
the price. Hence, the trader is no longer price-taker or passive as in the previous two
models. Here, she can affect the price of commodity by paying some (quadratic) cost.
The dynamics for S and q are as in (3.1). The controls are still given by (u, z) with
the big difference that now only u is controlled by the producer, while z is controlled
by the trader. Clearly, the corresponding costs are allocated accordingly. When the
strategy profile for both players is (u, z) and the derivative price is h0 , the producer
payoff is
Z T 

κ 2
Jpr (u, z, h0 ) = E
qt (St − aqt ) − ut dt + λ(h0 − hT ) .
(4.1)
2
0
On the other hand, the trader who has the opposite position in the derivatives will get
the payoff


Z
g T 2
Jtr (u, z, h0 ) = E −
z dt − λ(h0 − hT ) .
(4.2)
2 0 t
Now, we can give the definition of admissible policies, including the strategy profiles of
both players together with the pricing and hedging strategy of the investment department in the production firm. Notice that it is the same as for the model in Section 3.
We recall that S̃t = St − aqt , for t ∈ [0, T ].
Definition 4.1. We say that any pair (u, z) is admissible if the following properties are
satisfied:
(i) (ut , zt )t∈[0,T ] are progressively measurable processes with values in R × (−1, ∞)
such that
Z T

Z T

E
(u2t + zt2 )dt < ∞, E
S̃t2 (1 + zt )dt < ∞;
0

0

(ii) there exists a unique equivalent martingale measure Qu,z for the price process S̃,
with hT ∈ L1 (P) ∩ L1 (Qu,z );
(iii) there exists a real-valued progressively measurable process (∆u,z
t )t∈[0,T ] satisfying
Z
E
0

T

|∆u,z
t ut |

+

2
|∆u,z
t | (1

20


+ zt ) dt < ∞,


and such that the following holds Qu,z -a.s.
hu,z
t

Qu,z

:= E

Qu,z

[hT |Ft ] = E

Z

t

[hT ] +

∆u,z
s dqs ,

0

for all t ∈ [0, T ].
The set of all admissible pairs will be denoted by A.
On the other hand the definition of solution is slightly different, due to the fact
that the trader can also play strategically in this model. Before proceeding, we exploit
the definition of admissibility, conditions (ii) and (iii) in particular, to rewrite as in the
previous two models the payoffs of both the trader and the producer as follows
Z T 
 
κ 2
u,z
Jpr (u, z, h0 ) = E
dt =: J˜pr (u, z),
qt (St − aqt ) − ut − λ(µ − aut )∆t
2
0
Z T 
 
g 2
u,z
− zt + λ(µ − aut )∆t
Jtr (u, z, h0 ) = E
dt =: J˜tr (u, z),
2
0
for any admissible pair (u, z) ∈ A.
Definition 4.2. We say that the pair (b
u, zb) ∈ A is a Nash equilibrium if it is a Nash
equilibrium between the producer and the trader, i.e.,
J˜pr (b
u, zb) ≥ J˜pr (u, zb),

J˜tr (b
u, zb) ≥ J˜tr (b
u, z),

(4.3)

for all deviations u, z such that (u, zb) and (b
u, z) belong to A.

4.1

Heuristics

We want to compute explicitly a Nash equilibrium for the game between producer and
trader, described just above. We start from some heuristics that would lead to some
candidate equilibrium, while the rigorous verification is postponed to the next subsection as usual.
First, assuming ht = ϕ(t, qt , St ) and consequently ∆t = ϕs (t, qt , St ), while exploiting
the market completeness as for the previous two models, we can rewrite the running
best-response functions of the two players as follows
Z T 


κ
v(t, q, s; z) = sup E
qr (Sr − aqr ) − u2r − λ(µ − aur )ϕs dr | qt = q, St = s ,
2
u
t
Z T 


g 2
w(t, q, s; u) = sup E
− zr + λ(µ − aur )ϕs dr | qt = q, St = s ,
2
z
t
where ϕs is the delta hedging of the derivative, that will have to be determined at the
equilibrium. It is reasonable to expect that the derivative’s price ϕ(t, q, s) is the solution
to the following PDE:
ϕt +

σ2
(1 + z)ϕss = 0,
2
21

ϕ(T, s, q) = (s − aq)2 ,

(4.4)

for some function z = z(t, q, s) coming from the trader’s best-response. The PDE
above is coupled with the following two HJB equations, arising from the best-response
functions of the two players:


κ
σ2
−vt = sup q(s − aq) − u2 − λϕs (µ − au) + vq u + vs µ + (1 + z)vss ,(4.5)
2
2
u


2
g 2
σ
−wt = sup − z + λϕs (µ − au) + wq u + ws µ + (1 + z)wss ,
(4.6)
2
2
z
with terminal conditions v(T ) = w(T ) = 0. Solving the optimization problems within
the HJB equations above, we get the (candidate) equilibrium strategies for the producer
and the trader in terms of the corresponding payoff functions:
u
b=


1
vq + λaϕs ,
κ

zb =

σ2
wss .
2g

The HJB equations for the producer and the trader become respectively as


2
1
σ2
σ2
−vt = q(s − aq) +
vq + λaϕs − µλϕs + µvs +
1 + wss vss
2κ
2
2g
and
−wt = λµϕs −



1
σ2
σ4 2
vq + λaϕs λaϕs − wq + µws + wss + wss
.
κ
2
8g

Furthermore, the PDE giving the option equilibrium price ϕ is given:


σ2
σ2
ϕt +
1 + wss ϕss = 0, with ϕ(T, q, s) = (s − aq)2 .
2
2g
Analogously as in the previous two models, we use the following ansatz for w:
w(t, q, s) = Aw (t)q 2 + Bw (t)s2 + Cw (t)qs + Dw (t)q + Ew (t)s + Fw (t),
and similarly for v and ϕ with self-explanatory notation for their coefficients. Therefore,
using the ansatz and proceeding in the usual way, we easily get
ϕ(t, q, s) = (s − aq)2 + Fϕ (t),
where
Fϕ (t) := σ

2

Z
t

T



σ2
1 + Bw (r) dr.
g

22

After tedious yet straightforward computations we obtain
0

−Av = −a +
0

2
2
Av − a2 λ
κ

(4.7)

1
(Cv + 2aλ)2
2κ

2
Av − a2 λ (Cv + 2aλ)
=1+
κ

2
= µ (Cv + 2aλ) + Dv Av − a2 λ
κ
1
= 2µ (Bv − λ) + Dv (Cv + 2aλ)
κ 

1 2
σ2
2
= µEv +
D + σ 1 + Bw Bv
2κ v
g


4
=
Av − a2 λ Aw + a2 λ
κ
1
= (Cw − 2aλ) (Cv + 2λa)
κ

2
=
(Av − λa2 )(Cw − 2aλ) + (Aw + a2 λ)(Cv + 2λa)
κ
 2

2
= µ (Cw − 2aλ) + Dv Aw + a2 λ + Dw Av − a2 λ
κ
κ
1
1
= 2µ (Bw + λ) + Dw (Cv + 2aλ) + Dv (Cw − 2aλ)
κ
κ
4
1
σ
2
= µEw + Dv Dw + σ 2 Bw + Bw
κ
2g

−Bv =
0

−Cv
0

−Dv
0

−Ev
0

−Fv
0

−Aw
0

−Bw
0

−Cw
0

−Dw
0

−Ew
0

−Fw

(4.8)
(4.9)
(4.10)
(4.11)
(4.12)
(4.13)
(4.14)
(4.15)
(4.16)
(4.17)
(4.18)

with zero terminal condition for all ODEs above. The first equation, which is a Riccati
ODE, can be solved explicitly giving the same expression as for D in the first model:
r
2 4
2(a − 2λκa )(eθ(T −t) − 1)
8a
Av (t) = −
.
, θ :=
4λa2 θ(T −t)
θ(T
−t)
κ
θ(e
+ 1) +
(e
− 1)
κ

The other equations are linear, hence they can be solved in integral form. For the
moment, we give only the expressions for the coefficients that we need in order to
compute the equilibrium strategy zb of the trader. They are given by:
Z
4a2 λ T 4 R u (Av (r)−a2 λ)dr
eκ t
(Av (u) − a2 λ)du,
Aw (t) =
κ
t
Z
1 T
Bw (t) =
(Cw (r) − 2aλ)(Cv (r) + 2aλ)dr,
κ t
Z

2 T 2 R u (Av (r)−a2 λ)dr 
Cw (t) =
eκ t
(Aw (u) + a2 λ)(Cv (u) + 2aλ) − 2aλ(Av (u) − a2 λ) du,
κ t


Z T
R
2 u
4aλ
2 λ)dr
(A
(r)−a
2
v
1+
(Av (u) − a λ) du.
Cv (t) =
eκ t
κ
t
23

4.2

Verification

Theorem 4.1. Let Av , Cv , Dv , Bw be solutions to the system (4.7)-(4.18) such that
Bw (t) > −

g
,
σ2

t ∈ [0, T ].

(4.19)

Then there exists a Nash equilibrium (b
u, zb) ∈ A as in Definition 4.2, where
u
bt =

i
1h
Cv (t)Sbt + 2Av (t)b
qt + Dv (t) + 2λa(Sbt − ab
qt ) ,
κ

zbt =

σ2
Bw (t),
g

t ∈ [0, T ].
(4.20)

The no-arbitrage equilibrium price process for the derivative hT is given by

Z T
σ2
b
1 + Bw (u) du, t ∈ [0, T ],
ht := hutb,bz = (Sbt − ab
qt ) 2 + σ 2
g
t

(4.21)

and the hedging process at equilibrium is
b t := ∆ub,bz = 2(Sbt − ab
∆
qt ),
t

t ∈ [0, T ].

(4.22)

Proof. Analogously as for the previous two models, the proof is structured in two steps.
1. Admissibility. We start from the verification that the pair (b
u, zb) belongs to A. The
two processes u
b, zb are clearly progressively measurable by definition, where u
b takes real
values. Moreover, assumption (4.19) implies that zbt > −1 for all t ∈ [0, T ]. Concerning
the integrability properties in Definition 4.1(i), since both u
b and zb are affine in the state
variables qbt , Sbt with time continuous (hence bounded) coefficients, they boil down to
checking
Z

T

(b
qt2 + Sbt2 )dt < ∞.

E

(4.23)

0

b observe that since zb is a deterministic continuous
For the square integrability of S,
function of time, each Sbt is normally Rdistributed, hence it has every moment and they
T
are continuous in time. Therefore E[ 0 Sbt2 dt] < ∞. To verify the square integrability
of qb, notice that at equilibrium we have
db
qt = [α(t)b
qt + β(t)Sbt + γ(t)]dt,

qb0 = q0 ,

for some deterministic continuous functions of time α, β and γ. Such a linear ODE can
be solved pathwise, giving

Z t R

 
Rt
r
α(r)dr
−
α(u)du
qbt = e 0
q0 +
e 0
β(t)Sbr + γ(r) dr , t ∈ [0, T ].
0

RT
RT Rt
This implies that showing E[ 0 qbt2 dt] < ∞ reduces to E[ 0 ( 0 Sbr dr)2 dt] < ∞, which
Rt
follows since Σt := 0 Sbr dr is a Gaussian process with time continuous second moment.

24

b = Qub,bz
Regarding condition (ii), we need to show that there exists a unique EMM Q
µ−ab
u
t
for the production process qb. Let γ
bt := σ√1+bz and let us consider
t

 Z t

Z
1 t 2
u
b,b
z
γ
bt dWt −
Lt := exp −
γ
b dt ,
2 0 t
0

t ∈ [0, T ].

We use once more [23, Theorem 2.1] to prove that under our assumptions the probability
b := Lub,bz dP is well-defined (see also [22]). For this model, Assumption 2.2 in [23] is
dQ
T

satisfied as long as σ 2 (1 + zbt ) > 0 for all t ∈ [0, T ], which is immediately given by our
assumption that Bw (t) > −g/σ 2 ensuring, as we already saw above, that zbt > −1 for
all t ∈ [0, T ].
To end this part, we need to check property (iii) in Definition 4.1. The first part, relative
to b
h, is done as in the proof of Theorem 2.1, hence the details are omitted. Concerning
b
∆, first notice that it is clearly progressively measurable and takes real values. Due to
b t is linear in both qbt and Sbt , its integrability property is equivalent to
the fact that ∆
(4.23), which has already been checked before.
2. Equilibrium. We are going to use the martingale optimality principle here as well
to verify that at the proposed equilibrium (b
u, zb) both players are implementing an
optimal response to each other strategy. Let us consider the producer first and define
the following process
Z t

κ
u,b
z
z
Yt :=
qr (Sbr − aqr ) − u2r − λ∆u,b
(µ
−
au
)
dr + W (t, qt , Sbt ),
(4.24)
r
r
2
0
with
W (t, q, s) = Aw (t)q 2 + Bw (t)s2 + Cw (t)qs + Dw (t)q + Ew (t)s + Fw (t).
Similarly as in the proof of Theorem 2.1, one can verify by applying Itô’s formula and the
HJB equation (4.5) satisfied by the function W (t, q, s) by construction in the heuristics
part, that Ytu,bz is a supermartingale for all u such that (u, zb) ∈ A, and a martingale for
u=u
b. For the trader, we consider the process
Z t

g
u
b,z
Zt :=
− zr2 + λ∆urb,z (µ − ab
ur ) dr + U (t, qbt , St ),
(4.25)
2
0
with
U (t, q, s) = Av (t)q 2 + Bv (t)s2 + Cv (t)qs + Dv (t)q + Ev (t)s + Fv (t).
Applying the same arguments as for the producer, one can easily check that Z ub,z is a
supermartingale for all z such that (b
u, z) ∈ A and a martingale for z = zb.
Finally, an application of the martingale optimality principle combined with the admissibility of (b
u, zb), gives that the latter is a Nash equilibrium as in Definition 4.2.
Therefore, the proof is complete.
25

Remark 4.1. Observe that in the theorem above we assumed that Bw (t) > −g/σ 2 for
all t ∈ [0, T ]. This is satisfied when the maturity T is small enough. Indeed, one can
reason heuristically in the following way: when T ≈ 0, using the equation (4.14) for Bw
0 (T ) ≈ 1 (2λa)2 > 0 and we also have B (T ) = 0. Therefore, it is natural
we have Bw
w
κ
to expect Bw (t) > −g/σ 2 for all t ∈ [0, T ] when T is small enough, which would also
guarantee that the Radon-Nikodym derivative dQub,bz /dP = LuTb,bz is well-defined (see the
second part of the proof above). Unfortunately, the study of the function Bw is much
more difficult in this case than in the model of Section 2, where we were able to quantify
precisely how small T must be.

5

Numerical illustration

In this section, we use numerical simulations to illustrate and explain the behaviours of
the producer in the three models and of the trader in the third one. We set the drift of
the commodity price to zero, µ = 0, in Models 2 and 3, to simplify the analysis.
Model 1: production-based manipulation. The understanding of the first model
is quite straightforward and it is illustrated by the first column of Figure 1. Starting
from a zero production rate q, the optimal strategy of the producer, whether or not she
holds a derivative position, is to reach as fast as possible the optimal production rate
s0
that maximises the running profit q ? :=
. We have seen that when the producer has
2a
no position in the derivative market, she has no interest in increasing the volatility using
somerandomisation of her production rate q. Indeed, her expected profit is proportional
to E − qt2 ] and thus, increasing the volatility decreases her expected profit. On the
contrary, since controlling the volatility has a cost, she makes costly efforts to reduce it.
When the producer holds a derivative position, we first note that she uses her market
power to drive the price of the commodity at maturity to a level that suits her profit.
If she has bought (resp. sold) the derivative, she drives the commodity price up (resp.
down). For instance, in case of a sale, the derivative is sold at, say, 100, but at maturity
its payoff is close to zero, ensuring a profit of nearly 100. Figure 2 (left) gives the value
function of the producer at time zero as a function of the derivative position. We see
that selling derivatives (λ > 0) can only make her better off while buying derivatives
requires a certain amount of sales before it is worth the cost.
Regarding the volatility, since the price h0 of the derivative is an increasing function
of the realised volatility, the producer may have an interest in increasing the volatility
to push the value of the derivative up. But, since increasing the volatility has a negative
effect on the expected profit, the producer has to assess this trade-off. Using the Remark
2.2 together with the expression for zb in (2.1) and noting that it makes sense to increase
the volatility only in case the producer has sold the derivative (λ > 0) we have that
r
κ
zb ≥ 0 ⇔ λ ≥
.
(5.1)
2a3

26

If the net position exceeds the threshold above, the benefit of increasing the volatility
outweighs the cost. The higher the market power, the lower the threshold. Besides, it is
worth noting that this threshold does not depend on the cost of intervention g to reduce
the volatility. It only depends on the parameters affecting the drift of the commodity
price process. In Figure 1, we choose a large short position of λ = 1 which makes the
profit on the derivative as important as the profit from production. In that case, the
producer increases more than by half the volatility. Figure 3 illustrates the variation
of the price of the derivative h0 , of the expected payoff EP [hT ] but also of the price of
the derivative if no volatility manipulation was undertaken, noted hz=0
0 , as a function
of the holding position λ. In these simulations, we started the initial production rate
at its optimal stationary level q ? to get rid of transitory effects. For the first model, we
observe that h0 is an increasing function of the position, but it varies much less than the
expected terminal payoff. It means that much of the benefit from holding a derivative
position comes from the manipulation of the price at maturity.
Model 2: production and information based manipulation. The story for the
second model is illustrated by the second column of Figure 1 and it has many points in
common with the first model: the producer optimal production strategy is to reach the
stationary optimal level q ? and to drive the price at maturity up in case of a purchase
and down in case of a sale. But, now, contrary to the former case, as pointed out
in Remark 3.3, the producer always increases the volatility whatever her net position,
long or short, because her profit rate is an increasing function of the volatility. As a
consequence, we observe in the second column of Figure 3 that h0 is always greater
P
than hz=0
0 . Further, the variation of E [hT ] − h0 is much larger now, when the producer
can separate the manipulation of the drift and of the volatility, than in the first model.
Figure 2 (middle) provides the value function of the producer at time zero as a function
of the derivative position. The situation here is very similar to what we observed in the
first model, namely selling derivatives (λ > 0) results in a profit, while buying derivatives
is worth the cost as soon as the amount of sales exceeds a threshold depending on the
model parameters.
In both models 1 and 2, the capacity of driving the price of the commodity at
maturity at a desired level reveals itself an efficient tool to take advantage of a derivative
position. If the producer has sold the derivative at, say, 100, she increases her production
rate so that at terminal date, the price of the commodity decreases, making the price of
the derivative decrease below the initial price and thus ensuring a profit on the derivative.
Model 3: producer-trader competition. What happens when the producer is
facing an opponent who can control the level of volatility? The third column of Figure 1
illustrates the interaction between the producer and the trader. The fact that the
producer now faces an opponent does not change her overall production strategy: she
still reaches the stationary optimal level of production rate q ? and she manipulates the
commodity price at maturity at her own advantage. But, the actions of the trader on
the volatility reduces the potential profit made by the producer on the derivative. When
27

the producer has sold (resp. bought) the derivative to the trader, the trader reduces
(resp. increases) the volatility to push the price h0 of the derivative down. The third
column of Figure 3 shows a much lower variation of the derivative profit h0 − EP [hT ]
than in the first two models. Besides, we observe that for λ > 0, we have h0 −EP [hT ] > 0
and for λ < 0, we have h0 − EP [hT ] < 0, meaning that in each case, the trader is making
a loss.
We have seen that the producer can drive the price at maturity at a level that
would make her derivative position a profitable trade for her, providing her with an
efficient tool in this asymmetric game of price manipulation. In this situation, considered
the potential strong asymmetry of power in this game, a natural question on whether
an exchange level λ that would make both players better off exchanging might arise.
Figure 2 (right) gives the value functions of the producer and of the trader at time zero
as a function of the derivative position. We observe that even if the value function of
the producer exhibits the same pattern as in the first two models, her expected profit
is now considerably reduced due to the counteraction of the trader. Besides, the value
function of the trader is concave and admits an optimum at a position that makes the
producer worse off trading. Further, we observe that in this situation, with a zero initial
rate of production, neither the producer nor the trader are better off trading.
But, if we consider that the production rate starts at its optimal stationary level q ? ,
we find that whatever the market power of the producer, there is an exchange position
making both the producer and the trader better off than not making a trade. Figure 4
presents the value functions of the producer and the trader at initial time for different
values of the market power parameter a and different cost of intervention for the trader
g. In each case, we chose as an initial production rate q0 = q ? = s0 /(2a), the stationary
level of production, avoiding in this way the transitory phase to optimal production
rate. When the producer and the trader do not trade (λ = 0), their respective value
v(0, q0 , s0 ) and w(0, q0 , s0 ) stand at the intersection of the black axis. As the trader
starts to sell the derivative, λ becomes negative and both values are greater than when
λ = 0, showing that both are better off making the trade. Further, we observe that
both are worse off in the case where the trader buys the derivative from the producer.

28

Model 1

Model 2

20

Model 3

20

14
q^

q^

q^
12

15

15

10

10

5

5

0

0

10
8
6
4
2

0

0.2

0.4

0.6

0.8

1

0

0.2

0.4

t

0.6

0.8

1

0

120

120
'^

100

80

80

80

60

60

60

40

40

40

20

20

20

0

0

0.6

0.8

1

0

0.2

0.4

t
1.8

0.6

0.8

1

0

0

0.2

0.4

t

0.8

1

0.6

0.8

1

0.6

0.8

1

0.6

0.8

1

t

4

p
< 1 + z^

0.6

'^

100

0.4

0.4

120

'^

0.2

0.2

t

100

0

0

t

1.2

p
< 1 + z^

p
< 1 + z^

1.1

1.6

3.5
1

1.4
3

0.9

1.2

0.8
2.5
0.7

1
2

0.6

0.8
0.5
1.5

0.6
0.4

0.4
0

0.2

0.4

0.6

0.8

1

1

0

0.2

0.4

t
10

0.6

0.8

1

0.3

0

0.2

0.4

t
12

S~

t
10

S~

8

S~

9

10

8
8
6

7
6
6

4
4

5
2

0

2

0

0.2

0.4

0.6

t

0.8

1

0

4

0

0.2

0.4

0.6

t

0.8

1

3

0

0.2

0.4

t

Figure 1: Optimal production rate qb, derivative price ϕ,
b volatility σ
b and commodity price Sb
when the producer has no derivative position λ = 0 (blue), bought the derivative λ < 0 (black)
and sold the derivative, λ > 0 (red). Parameter values: s0 = 10, a = 0.5, g = 0.1, κ = 0.01,
σ = 1, T = 1, µ = 0.0, q0 = 0, λ ∈ {−0.1, 1} for Model 1 & 2, λ ∈ {−0.05, 0.1} for Model 3.

29

Model 1

Model 2

Model 3

160

160

54

140

140

52

4
2

120

120

50

0

100

100

48

-2

80

80

46

-4

60

60

44

-6

40

40

42

-8

v(0; q0 ; S0 )
w(0; q0 ; S0 )

v(0; q0 ; S0 )

20

0

0.2

0.4

0.6

0.8

v(0; q0 ; S0 )

1

20

0

0.2

6

0.4

0.6

0.8

1

40

-0.1

-0.05

0

0.05

-10
0.1

6

6

Figure 2: Producer’s and trader’s value function at initial time as a function of derivative
position λ. Parameter values: s0 = 10, a = 0.5, g = 0.1, κ = 0.01, σ = 1, T = 1, µ = 0.0,
q0 = 0.

Model 1

Model 2

400

Model 3

2500

100
90

350
2000

80

300

70

250

1500

60

200
50

1000

150

40

100

30

500
50
0
-0.2

20
0

0.2

0.4

0.6

0.8

1

0
-0.2

0

0.2

0.4

0.6

0.8

1

10
-0.1

25.8

38

26.4

25.7

36

26.2

25.6

34

26

32

25.8

30

25.6

28

25.4

26

25.2

-0.05

0

0.05

0.1

-0.05

0

0.05

0.1

25.5
25.4
25.3
25.2
25.1
25
-0.2

0

0.2

0.4

0.6

0.8

1

24
-0.2

0

0.2

0.4

0.6

0.8

1

25
-0.1

Figure 3: Values of the derivative h0 , the expected value of the payoff EP [hT ] and the value
of the derivative in case of no volatility manipulation hz=0
as a function of the net position λ.
0
Parameter values: s0 = 10, a = 0.5, g = 0.1, κ = 0.01, σ = 1, T = 1, µ = 0.0, q0 = q ? .

30

a = 0.1

a = 0.5

a = 0.9

251.6

50.24

27.9005

251.4

50.23

27.8995

251.2

50.22

251

50.21

27.9

27.899
27.8985
27.898
27.8975
27.897

50.2

250.8

27.8965
250.6

-0.08

-0.06

-0.04

-0.02

50.19
-20

0

-15

-10

-5

0

5
10

255

50.35

254

50.3

27.896

-10

-5

0

-3

10

-4

10

-4

10

-4

27.915
27.91
27.905

253

50.25

252

50.2

251

50.15

27.9
27.895

250
-0.015

50.1
-0.01

-0.005

0

0.005

0.01

27.89

-15

-10

-5

27.885

0
10

400

350

300

250

-5

0

5

10

53

28.1

52.5

28.05

52

28

51.5

27.95

51

27.9

50.5

27.85

50
-0.03

-0.025

-0.02

-0.015

-0.01

-0.005

0

-10

-5

0

-3

0.005

27.8
-10

-8

-6

-4

-2

0

2

4

Figure 4: Values of v(0, q0 , s0 ) and w(0, q0 , s0 ) as a function of the trading position λ, λ > 0
in red, λ < 0 in blue, for q0 = s0 /2a, and for different values of a.

31

References
[1] R. K. Aggarwal, G. Wu. Stock price manipulations. Journal of Business, 79(4):19151953, 2006.
[2] F. Allen, D. Gale. Stock–price manipulation. Review of Financial Studies, 5(3):503529, 1992.
[3] F. Allen, G. Gorton. Stock price manipulation, market microstructure and asymmetric information. European Economic Review, 36:624-630, 1992.
[4] A. Chatterjea, R. J. Jarrow. Market manipulation, price bubbles, and a model of
the U.S. treasury securities auction market. Journal of Financial and Quantitative
Analysis, 33(2):255-289, 1998.
[5] I.-H. Cheng, W. Xiong. The Financialization of Commodity Markets. Annual Review
of Financial Economics, 6:419–441, 2014.
[6] D. J. Cooper, R. G. Donaldson. A strategic analysis of corners and squeezes. Journal
of Financial and Quantitative Analysis, 33(1):117-137, 1998.
[7] D. Duffie, J. C. Stein. Reforming LIBOR and Other Financial Market Benchmarks.
Journal of Economic Perspectives, 29(2):191–212, 2015.
[8] N. El Karoui. Les aspects probabilistes du contrôle stochastique. 9th Saint Flour
Probability Summer School-1979. Lecture Notes in Math. 876, Springer, 73-238, 1981.
[9] D. Filipovic. Term-Structure Models. A Graduate Course. Springer, 2009.
[10] Glencore. Annual Report, 2018.
[11] M. Gallmeyer and D. Seppi. Derivative Security Induced PriceManipulation. Working Paper 2000-E41, Tepper School of Business, Carnegie Mellon University, 2000.
[12] J. M. Griffin, A. Shams. Manipulation in the VIX? Review of Financial Studies,
31(4):1377–1417, 2017.
[13] O. Guéant. The Financial Mathematics of Market Liquidity: From optimal execution to market making. Chapman and Hall/CRC, 2016.
[14] D. Hou, D. R. Skeie. LIBOR: Origins, Economics, Crisis, Scandal, and Reform.
FRB of New York Staff Report No. 667, April 2014.
[15] R. J. Jarrow. Derivative security markets, market manipulation, and option pricing
theory. Journal of Financial and Quantitative Analysis, 29(2):241-261, 1994.
[16] A. S. Kyle. Continuous auctions and insider trading. Econometrica, 53(6):13151336, 1985.

32

[17] K. Nyström, M. Parviainen. Tug-of-war, market manipulation, and option pricing.
Mathematical Finance, 27(2):279-312, 2017.
[18] G. Pirrong. Manipulation of the commodity futures market delivery process. Journal of Business, 66(3):335-369, 1993.
[19] G. Pirrong. Mixed manipulation strategies in commodity futures markets. The
Journal of Futures Markets, 15(1):13-38, 1995.
[20] G. Pirrong. The economics of commodity markets manipulation: a survey. The
Journal of Commodity Markets, 5:1–17, 2017.
[21] RioTinto. Annual Report, 2018.
[22] J. Ruf. The martingale property in the context of stochastic differential equations.
Electronic Communications in Probability, vol. 20, paper 34, 2015.
[23] T. H. Rydberg. A note on the existence of unique equivalent martingale measures
in a Markovian setting. Finance & Stochastics, 1:251-257, 1997.

33

