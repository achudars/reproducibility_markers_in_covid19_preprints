arXiv:1905.11526v2 [math.CO] 31 May 2019

SKEW KEY POLYNOMIALS AND A GENERALIZED
LITTLEWOOD–RICHARDSON RULE
SAMI ASSAF AND STEPHANIE VAN WILLIGENBURG
Abstract. Young’s lattice is a partial order on integer partitions whose saturated chains correspond to standard Young tableaux, the combinatorial objects
that generate the Schur basis for symmetric functions. Generalizing Young’s
lattice, we introduce a new partial order on weak compositions that we call the
key poset. Saturated chains in this poset correspond to standard key tableaux,
the combinatorial objects that generate the key polynomials, a nonsymmetric polynomial generalization of the Schur basis. Generalizing skew Schur
functions, we define skew key polynomials in terms of this new poset. Using
weak dual equivalence, we give a nonnegative weak composition Littlewood–
Richardson rule for the key expansion of skew key polynomials, generalizing
the flagged Littlewood–Richardson rule of Reiner and Shimozono.

Contents
1. Introduction
2. Posets
2.1. Young’s lattice
2.2. The key poset
3. Polynomials
3.1. Schur functions
3.2. Key polynomials
4. Littlewood–Richardson rules
4.1. Skew Schur functions
4.2. Skew key polynomials
References

1
3
3
3
8
8
9
12
12
14
17

1. Introduction
Schur polynomials are central to the study of the representation theories of the
general linear group and of the symmetric group, as well as to understanding the
geometry of the Grassmannian. The combinatorics of Young tableaux, the ubiquitous objects that generate the Schur polynomials, often sheds light on important
representation theoretic or geometric properties such as tensor products, induction
and restriction of modules, and intersection multiplicities.
Date: June 4, 2019.
2010 Mathematics Subject Classification. Primary 05E05; Secondary 06A07, 14M15, 14N15.
Key words and phrases. composition poset, Demazure characters, key polynomials, skew Schur
functions, weak compositions,Young’s lattice.
S.A. supported in part by NSF DMS-1763336. S.v.W. supported in part by NSERC.
1

2

S. ASSAF AND S. VAN WILLIGENBURG

The celebrated Littlewood–Richardson rule [16] gives a combinatorial description
for the Schur expansion of a product of two Schur polynomials or, equivalently, for
the Schur expansion of a skew Schur polynomial as
X
X
sλ sµ =
cνλ,µ sν , or sν/λ =
cνλ,µ sµ ,
ν

µ

where cνλ,µ is the number of saturated chains in Young’s lattice from λ to ν satisfying certain conditions depending on µ. Here Young’s lattice is the partial order
on integer partitions given by containment of Young diagrams. These so-called
Littlewood–Richardson coefficients arise in representation theory as the irreducible
multiplicities for the tensor product of two irreducible representations for the general linear group and as the irreducible multiplicities for the induced tensor product
of two irreducible representations for the symmetric group. They also appear geometrically, giving the number of points lying in a suitable intersection of three
Grassmannian Schubert varieties.
The key polynomials are nonsymmetric polynomial generalizations of Schur polynomials first studied by Demazure [8] in connection with Schubert varieties. Key
polynomials are irreducible characters of Demazure modules for the general linear
group [9] and represent Schubert classes for vexillary permutations [15]. They form
an important basis for the polynomial ring, and so we may consider their structure
constants parallel to those for the Schur basis of symmetric polynomials. However,
in stark contrast with the Schur case, the structure constants of key polynomials
are not, in general, nonnegative, though Assaf and Quijada [2] have made progress
on understanding the signs in the Pieri case.
Nevertheless, key polynomials appear in many of the myriad generalizations of
the Littlewood–Richardson rule. One such rule is the flagged Littlewood–Richardson
rule of Reiner and Shimozono [19]. Flagged Schur polynomials [14] arise as those
polynomials occuring both as key polynomials and as Schubert polynomials. Reiner
and Shimozono [19] considered the flagged skew Schur polynomials and gave a
nonnegative rule for their expansion into the key basis. Assaf [5] considered a
diagram containment-based skew analog of key polynomials along the same lines,
but obtained nonnegativity results only in very special cases.
Another nonnegative rule is the quasisymmetric Littlewood–Richardson rule. The
quasisymmetric Schur functions of Haglund, Luoto, Mason and van Willigenburg
[11] are a quasisymmetric generalization of Schur polynomials whose combinatorics
shares many nice properties with that for Schur polynomials. These authors [12]
use the quasisymmetric Schur functions to derive a nonnegative refined Littlewood–
Richardson rule for the product of a key polynomial and a Schur polynomial with
sufficiently many variables. Related to this, Bessenrodt, Luoto and van Willigenburg [7] define a partial order on strong compositions that gives rise to a nonnegative
Littlewood–Richardson rule for a skew analog of the quasisymmetric Schur functions. For details on these results and quasisymmetric Schur functions in general,
see the book by Luoto, Mykytiuk, and van Willigenburg [17].
In this paper, we generalize the flagged Littlewood–Richardson rule to skew key
polynomials in the largest possible setting where nonnegativity prevails. To do so,
we begin in Section 2 by generalizing Young’s lattice to a partial order on weak
compositions that we call the key poset. In contrast with the generalization to
strong compositions in [7], we give explicit cover relations as well as explicit criteria for comparability in the poset, though as with the strong composition poset,

SKEW KEY POLYNOMIALS

3

the key poset is not a lattice. In Section 3, we relate the poset with the tableaux
combinatorics for key polynomials. Using these paradigms together, in Section 4
we re-define skew key polynomials with respect to the poset and give a general
nonnegative Littlewood–Richardson rule for skew key polynomials, vastly generalizing the nonnegativity results of [5, 19]. Moreover, we show that under the more
general containment definition for skew key polynomials considered in [5], all key
polynomial coefficients are nonnegative if and only if the two indexing shapes are
comparable in the key poset thereby precisely characterizing this nonnegativity.
2. Posets
2.1. Young’s lattice. An integer partition λ = (λ1 , λ2 , . . . , λℓ ) is a weakly decreasing sequence of positive integers, λi ≥ λi+1 > 0. The rank of a partition λ,
denoted by rk(λ), is the sum of the parts,
rk(λ) = λ1 + λ2 + · · · + λℓ
and we call ℓ its length.
The Young diagram of a partition λ is the collection of λi unit cells left-justified
in row i indexed from the bottom (French notation). Abusing notation, we use λ
interchangeably for the integer partition and for its diagram.
A partially ordered set, or poset, is a set together with a partial order comparing certain elements of the set. We turn integer partitions into a poset by the
containment relation, setting λ ⊆ µ if λi ≤ µi for all i or, equivalently, if the
diagram for λ is a subset of the diagram for µ. We call this poset Young’s lattice.
For p, q in a poset P, we say q covers p, denoted by p ≺· q, if p ≺ q and for
any r ∈ P for which p  r  q, either p = r or r = q. The cover relations for
Young’s lattice may be described by λ ≺· µ if and only if µ is obtained from λ by
incrementing a single part λi+1 for which λi > λi+1 by 1 or, equivalently, by adding
a single cell to the end of a row for which the row with one smaller index is strictly
longer.
The diagram of the cover relations, or Hasse diagram, shows Young’s lattice
is ranked by the number of cells of the diagrams. Fig. 1 depicts the Hasse diagram
of Young’s lattice up to rank 4.
A poset P is a lattice if every pair of elements p, q ∈ P have a unique least
upper bound and a unique greatest lower bound. For Young’s lattice, these constructions are given by the set-theoretic union and the set-theoretic intersection of
the diagrams, respectively.
Young’s lattice is a prominent tool in algebraic combinatorics, used to study
symmetric functions, representations of finite and affine Lie groups, and intersection
numbers for finite and affine Grassmannians. We generalize the construction from
integer partitions to weak compositions in such a way that maintains the connection
to representation theory and geometry.
2.2. The key poset. A weak composition a = (a1 , a2 , . . . , an ) is a sequence of
nonnegative integers, ai ≥ 0. A weak composition is a strong composition if all
ai > 0. Given a weak composition a we denote the strong composition obtained by
removing its zeros by flat(a). Extending notation, the rank of a weak composition
a, denoted by rk(a), is the sum of the parts,
rk(a) = a1 + a2 + · · · + an

4

S. ASSAF AND S. VAN WILLIGENBURG

∅
Figure 1. The Hasse diagram of Young’s lattice up to rank 4.
and we call n its length.
The key diagram of a weak composition a is the collection of ai unit cells leftjustified in row i indexed from the bottom. As above, we use a interchangeably for
the weak composition and for its key diagram.
Definition 2.2.1. The key poset is the partial order ≺ on weak compositions of
length n defined by the relation a  b if and only if ai ≤ bi for i = 1, 2, . . . , n and
for any indices 1 ≤ i < j ≤ n for which bj > aj and ai > aj , we have bi > bj .
If a  b, then the collection of cells in b but not in a is called a skew key
diagram denoted by b/a. We will also consider more general skew diagrams
whenever a ⊆ b, or ai ≤ bi for all i.
Definition 2.2.1 has the following interpretation in terms of key diagrams that
we will use often: a ≺ b if and only if a ⊂ b and whenever a cell of b/a lies above
a cell of a, the lower row is strictly longer in b; see Fig. 2.

Figure 2. An illustration of the partial order on weak compositions in terms of key diagrams. Here, cells lie in a ⊆ b, cells
lie in b/a, and cells lie in b = a ∪ b.
Notice this partial order is not given simply by containment of key diagrams.
Example 2.2.2. Let a = (2, 1, 1) and b = (2, 1, 2). Then ai ≤ bi for i = 1, 2, 3,
showing a ⊂ b. However, a 6≺ b since b3 > a3 and a1 > a3 but b1 = b3 . See Fig. 3.
As with Young’s lattice, this partial order on weak compositions is ranked by
the number of cells, and we may describe the covering relations in terms of adding
a cell subject to certain conditions.

SKEW KEY POLYNOMIALS

5

Figure 3. Two incomparable diagrams where the left is contained
in the right as a subset but is not below in the poset as evidenced
by the set-theoretic difference shown as .
Theorem 2.2.3. The key poset on weak compositions is ranked by rk with covering
relation a ≺· b if and only if b is obtained from a by incrementing aj by 1 where for
any i < j we have ai 6= aj + 1.
Proof. Let a ≺ b be two comparable weak compositions of length n. If rk(b) =
rk(a) + 1, then a ⊂ b and letting j denote the row index of the unique cell of b/a,
then bj > aj and for any i < j for which ai ≥ aj + 1, we must have ai = bi > bj =
aj + 1. In particular, we must have either ai ≤ aj or ai > aj + 1, satisfying the
stated cover relation.
Conversely, given a and a row index j for which ai ≤ aj or ai > aj + 1 for
all i < j, the weak composition b defined by bi = ai for i 6= j and bj = aj + 1
satisfies the condition that for any row index i < j for which ai > aj , we have
bi = ai > aj + 1 = bj . Thus the cover relation implies a ≺ b.
Finally, suppose a ≺ c with rk(c) > rk(a) + 1. Let k denote the shortest, then
lowest if tied, row of c containing an element of c/a. Set bi = ci for i 6= k and
bk = ck − 1. Then clearly a ⊂ b ⊂ c. We claim a ≺ b ≺ c. Given row indices
i < j, if bj > aj and ai > aj , then we also have cj ≥ bj > aj , and so since a ≺ c,
we have ci > cj . This ensures k 6= i by choice of k as the shortest row of c/a for
k, and so bi = ci > cj ≥ bj showing a ≺ b. If cj > bj and bi > bj , then j = k
and ci > ck = cj by choice of the shortest then lowest row for k, and so b ≺ c. In
particular, a is not covered by c, proving the poset is ranked with cover relations
as stated.

Remark 2.2.4. The composition poset [7, Definition 2.3] on strong compositions
can be described as being ranked by rk with covering relation a ≺· b if and only if
b is obtained from a by incrementing aj by 1 where for any i < j we have ai 6= aj .
However, there is no known description of this poset analogous to Definition 2.2.1.
In terms of key diagrams, a ≺· b if and only if a ⊂ b, there is a single cell of b/a,
and this cell does not sit above any cell lying at the end of its row. Fig. 4 depicts
the key poset up to rank 3.
While containment is not sufficient for covering in general, it is for the partition
case. In this way, the key poset generalizes Young’s lattice.
Proposition 2.2.5. For a weakly increasing weak composition a, and for b any
weak composition, we have a ⊆ b if and only if a  b.
Proof. For a weakly increasing, we never have ai > aj for j > i, making the latter
condition of Definition 2.2.1 vacuously true. Thus containment is comparability. 
Corollary 2.2.6. Any finite subposet of Young’s lattice is a subposet of the key
poset.

6

S. ASSAF AND S. VAN WILLIGENBURG

∅
Figure 4. The Hasse diagram of the key poset up to rank 3.
Proof. For λ a partition of length ℓ ≤ n, let aλ = (0, . . . , 0, λℓ , . . . , λ1 ) be the weakly
increasing weak composition of length n whose nonzero parts rearrange to λ. Given
any weak composition b of length n, by Proposition 2.2.5 aλ ⊆ b if and only if
aλ  b. In particular, λ ⊆ µ if and only if aλ aµ .

We have the following relations for intersections and unions of diagrams.
Lemma 2.2.7. Given weak compositions a, b, c of length n,
(1) if a  b and a  c, then a  b ∩ c;
(2) if a  c and b  c, then a ∪ b  c.
Proof. Suppose a  b and a  c. By definition of the poset, we have a ⊆ b and
a ⊆ c, whence a ⊆ b ∩ c. For any cell x in (b ∩ c)/a, if x sits above a cell y of a,
then necessarily the row of x is strictly shorter than that of y in b and in c since
a  b, c. Thus, the row of x is strictly shorter than that of y in b ∩ c, and so
a  b ∩ c.
Suppose a  c and b  c. Then a ⊆ c and b ⊆ c, whence a ∪ b ⊆ c. For any
cell x in c/(a ∪ b), if x sits above a cell y of a ∪ b, then necessarily the row of x
is strictly shorter than that of y in a or in b. Thus, the row of x is strictly shorter
than that of y in c since a, b  c, and so a ∪ b  c.

In particular, by Lemma 2.2.7, if a, b  a ∪ b, then a ∪ b is the unique least
upper bound of a and b, and if a ∩ b  a, b, then a ∩ b is the unique greatest lower
bound of a and b. However, neither of these conditions needs be the case.
Proposition 2.2.8. The key poset is not a lattice.
Proof. Let a = (2, 1, 1) and b = (2, 1, 2). By Lemma 2.2.7, any greatest lower
bound for a and b must be contained in a ∩ b = a, but a 6≺ b by Example 2.2.2.
Thus any greatest lower bound must have rank at most 3. Let c = (1, 1, 1). Then
one can check (visually from Fig. 5) c ≺ a, b, so since c has rank 3, it is a greatest
lower bound for a and b. Now let d = (1, 0, 1). Once again one can check, d ≺ a, b.
However, d 6≺ c since c2 > d2 and d1 > d2 but c1 = c2 . Thus c is not unique.

SKEW KEY POLYNOMIALS

7

Dually, Lemma 2.2.7 ensures any least upper bound for c and d must be contained in c ∪ d = c, but we have just seen d 6≺ c. Thus any least upper bound has
rank at least 4, and so the earlier check confirms a as a least upper bound. Then
as b is likewise also a common upper bound and a 6≺ b, we see a is not unique. 

c≺a

c≺b

d≺a

d≺b

d 6≺ c

Figure 5. An example showing the key poset is not a lattice. Here
∈ c or d, ∈ a/c or a/d, ∈ b/c or b/d, and ∈ c/d.
The set-theoretic unions and intersections are natural candidates for least upper
bounds and greatest lower bounds, though as Proposition 2.2.8 shows, they are
not necessarily above or below their constituent parts in the key poset. While this
problem cannot be overcome completely, there are derived diagrams that do always
lie above or below their constituent parts and which are contained in or contain all
other least upper or greatest lower bounds.
Proposition 2.2.9. Given weak compositions a and b, let a∇b denote a ∪ b
together with all cells y such that the cell immediately left of y sits under a cell of
(a∪b)/(a∩b) and some cell left of y either lies in a with the cell above in b/(a∩b)
or lies in b with the cell above in a/(a ∩ b); see Fig. 6.
Then a, b  a∇b, and for any c for which a, b  c, we have a∇b ⊆ c.

++

Figure 6. An illustration of the rule for padding a∪b up to a∇b.
Here cells lie in a, cells lie in b/(a ∩ b), and cells must be
added to make a∇b.
Proof. By definition, a, b ⊆ a ∪ b ⊆ a∇b. Moreover, if some x ∈ (a∇b)/a (resp.
x ∈ (a∇b)/b) lies above some y ∈ a (resp. y ∈ b), then by construction of a∇b,
the lower row is strictly longer, so a, b  a∇b.
Let c be some weak composition for which a, b  c. By Lemma 2.2.7, we
have a ∪ b  c, so, in particular, a ∪ b ⊆ c. By construction of a∇b, any z ∈
(a∇b)/(a ∪ b) lies in a row i for which there is a higher row j > i that is strictly
shorter in a and in b. Since a ∪ b  c, we must have z ∈ c. In particular,
a∇b ⊆ c.

Example 2.2.10. We now interpret Fig. 6 as a concrete example: Let a = (3, 0, 2)
and b = (2, 0, 4), so a ∩ b = (2, 0, 2), a ∪ b = (3, 0, 4) and a∇b = (5, 0, 4).
Proposition 2.2.11. Given weak compositions a and b, let a∆b denote the subset
of cells x ∈ a ∩ b such that for any y ∈ a/(a ∩ b) and any z ∈ b/(a ∩ b) lying above
x, the row of x is strictly longer than that of y in a and of z in b; see Fig. 7.
Then a∆b  a, b, and for any c for which c  a, b, we have c ⊆ a∆b.

8

S. ASSAF AND S. VAN WILLIGENBURG

×

Figure 7. An illustration of the rule for culling a ∩ b down to
a∆b. Here cells lie in a ∩ b, cells lie in (a ∪ b)/(a ∩ b), and
the cell marked × is deleted to make a∆b.
Proof. By definition, a∆b ⊆ a ∩ b ⊆ a, b. Moreover, if some y ∈ a/(a∆b) (resp.
z ∈ b/(a∆b)) lies above some x ∈ a∆b, then by construction of a∆b, the lower
row is strictly longer, so a∆b  a, b.
Let c be some weak composition for which c  a, b. By Lemma 2.2.7, we
have c  a ∩ b, so, in particular, c ⊆ a ∩ b. By construction of a∆b, any w ∈
(a ∩ b)/(a∆b) must have either a cell y ∈ a/(a∆b) or z ∈ b/(a∆b) above it for
which the row of y in a or the row of z in b is weakly longer than that of w, and
so we cannot have w ∈ c. In particular, c ⊆ a∆b.

Example 2.2.12. We now interpret Fig. 7 as a concrete example: Let a = (3, 0, 2)
and b = (3, 0, 4), so a ∩ b = (3, 0, 2), a ∪ b = (3, 0, 4) and a∆b = (2, 0, 2).
3. Polynomials
3.1. Schur functions. Given a partition λ of rank n, the set SYT(λ) of standard
Young tableaux of shape λ consists of bijective fillings of the Young diagram of
λ with numbers 1, 2, . . . , n such that row entries increase left to right and column
entries increase bottom to top.
A saturated chain in a poset P is a sequence of elements p0 ≺· p1 ≺· · · · ≺· pn .
We may identify standard Young tableaux of shape λ with saturated chains in
Young’s lattice from ∅ to λ
∅ = λ(0) ≺· λ(1) ≺· · · · ≺· λ(n) = λ
by the correspondence placing i in the unique cell of λ(i) /λ(i−1) . For example, the
two saturated chains from ∅ to (2, 1) are shown in Fig. 8. The cover relations for
Young’s lattice are precisely equivalent to increasing rows and columns condition.

∅

≺·

1

≺·

1 2

≺·

3
1 2

∅

≺·

1

≺·

2
1

≺·

2
1 3

Figure 8. Constructing the two standard Young tableaux of
shape (2, 1) as saturated chains in Young’s lattice from ∅ to (2, 1).
The Schur functions, indexed by partitions, form an important basis for symmetric functions. Schur functions are ubiquitous throughout mathematics, arising
as irreducible characters for polynomial representations of the general linear group,
Frobenius characters for irreducible representations of the symmetric group, and
polynomial representatives for the cohomology classes of Schubert cycles in Grassmannians. Combinatorially, Schur functions are the quasisymmetric generating
function for standard Young tableaux.
Gessel introduced the fundamental quasisymmetric functions [10], indexed by
strong compositions, that form an important basis for quasisymmetric functions.

SKEW KEY POLYNOMIALS

9

Given strong compositions α, β, we say β refines α if there exist indices i1 < · · · <
ik , where k is the length of α, such that
β1 + · · · + βij = α1 + · · · + αj .
For example, (1, 2, 2) refines (3, 2) but does not refine (2, 3).
Definition 3.1.1 ([10]). For a strong composition α, the fundamental quasisymmetric function Fα is
X
xb11 xb22 · · · ,
(3.1)
Fα (X) =
flat(b) refines α

where the sum is over weak compositions b such that flat(b) refines α.
For a standard Young tableau T , say i is a descent of T if i + 1 lies weakly left of
i. The descent composition of T , denoted by Des(T ), is the strong composition
given by maximal length runs between descents.
Example 3.1.2. The top tableau in Fig. 8 has a descent only at 2, making its
descent composition (2, 1), whereas the bottom tableau has a descent only at 1,
making its descent composition (1, 2).
The following definition for a Schur function follows from the classical one using
P-partitions as explained in [10].
Definition 3.1.3. For a partition λ, the Schur function sλ is
X
FDes(T ) (X).
(3.2)
sλ (X) =
T ∈SYT(λ)

For example, from Example 3.1.2, we have
s(2,1) (X) = F(2,1) (X) + F(1,2) (X).
Using this paradigm, Young’s lattice becomes a powerful tool in studying Schur
functions as well as the many contexts in which they arise.
3.2. Key polynomials. Based on the quasi-Yamanouchi tableaux of Assaf and
Searles [4], Assaf defined standard key tableaux [5, Definition 3.10]. We generalize
this naturally from key diagrams to skew key diagrams as follows.
Definition 3.2.1 ([5]). A standard (skew) key tableau is a bijective filling of
a (skew) key diagram with 1, 2, . . . , n such that rows decrease left to right and if
some entry i is above and in the same column as an entry k with i < k, then there
is an entry immediately right of k, say j, and i < j.
We denote the set of standard key tableaux of shape a by SKT(a) and extend
this naturally to standard skew key tableaux.
Parallel to the case for Young’s lattice, saturated chains from ∅ to a in the key
poset precisely correspond to standard key tableaux of shape a.
Theorem 3.2.2. For ∅ = a(0) ≺· a(1) ≺· · · · ≺· a(n) = a a saturated chain in the key
poset, the standard filling of the key diagram for a defined by placing n − i + 1 into
the unique cell of a(i) /a(i−1) is a standard key tableaux.
Conversely, given T ∈ SKT(a) with n cells, setting a(0) = ∅ and, for i =
1, . . . , n, setting a(i) to be the diagram containing cells labeled n, n − 1, . . . , n − i + 1
results in a saturated chain from ∅ to a in the key poset.

10

S. ASSAF AND S. VAN WILLIGENBURG

Proof. Suppose ∅ = a(0) ≺· a(1) ≺· · · · ≺· a(n) is a saturated chain in the key poset.
Then by Theorem 2.2.3, a(i−1) ⊂ a(i) and a(i) /a(i−1) has one cell. Thus we may
indeed set a to be the bijective filling of a with n − i + 1 into the unique cell of
a(i) /a(i−1) , for i = 1, . . . , n. The cover relations ensure cells are added only to the
right end of a row, ensuring row entries decrease from left to right. Suppose i < k
are in the same column with i above k. Restricting our attention to a(n−i+1) , the
last cell added corresponds to the cell with entry i. By Theorem 2.2.3, no row
below that containing entry i can have the same length. In particular, the row of
k must be strictly longer. Thus there exists some entry j < k immediately right of
k, and since j was not the most recently added cell, we have j > i. Therefore a is
a standard key tableau.
Suppose now T is a standard key tableau of size n. Since entries decrease from
left to right, the shape of the restriction of T to entries n, n − 1, . . . , n − i + 1 must
be a key diagram. Therefore we may define a nested sequence of weak compositions
∅ = a(0) ⊂ a(1) ⊂ · · · ⊂ a(n) by setting a(i) to be the diagram containing cells of T
labeled n, n − 1, . . . , n − i + 1. Note T restricted to these entries still satisfies the
row and column conditions for a standard key tableau. To see that a(i−1) ≺· a(i) ,
the column condition for key tableaux ensures the cell of a(i) with smallest entry,
which necessarily corresponds to a(i) /a(i−1) , cannot lie above another cell that ends
its row, since that cell necessarily has a larger entry. Thus by Theorem 2.2.3, the
sequence is a saturated chain in the key poset.


∅ ≺·

3

≺·

3
2

≺·

3
2 1

∅ ≺·

3

≺·

3 2

≺·

1
3 2

Figure 9. Constructing the two standard key tableaux of shape
(0, 2, 1) as saturated chains in the key poset from ∅ to (0, 2, 1).
For example, Fig. 9 shows the two saturated chains in the key poset from ∅ to
(0, 2, 1). Notice, as well, the two saturated chains in Fig. 8 are also saturated chains
in the key poset from ∅ to (0, 1, 2) under the label reversing map i 7→ n − i + 1.
The key polynomials, indexed by weak compositions, form an important basis
for the full polynomial ring. Key polynomials arise as characters of Demazure
modules [8] for the general linear group and coincide with Schubert polynomials
[14] in the vexillary case [15]. Key polynomials are nonsymmetric generalizations of
Schur functions, studied combinatorially by Reiner and Shimozono [19] and later by
Mason [18], though our perspective follows that of Assaf and Searles [4] and Assaf
[5] who define them as the fundamental slide generating polynomial for standard
key tableaux.
Assaf and Searles introduced the fundamental slide polynomials [3], indexed by
weak compositions, that form a basis for the full polynomial ring.
Definition 3.2.3 ([3]). For a weak composition a, the fundamental slide polynomial Fa is
X
xb11 xb22 · · · xbnn ,
(3.3)
Fa =
flat(b) refines flat(a)
b1 +···+bk ≥a1 +···+ak ∀k

SKEW KEY POLYNOMIALS

11

where the sum is over weak compositions b such that flat(b) refines flat(a) and b
dominates a in lexicographic order.
For a standard key tableau T , say i is a descent of T if i + 1 lies weakly right of
i. We assign a weak descent composition for T , defined in [5, Definition 3.12],
that will index the corresponding fundamental slide polynomial.
Definition 3.2.4 ([5]). For a standard key tableau T , let (τ (k) |· · ·|τ (1) ) be the
partitioning of the decreasing word n · · · 21 broken between i + 1 and i precisely
whenever i is a descent of T . Set t′i to be the lowest row index in T of a letter in
τ (i) . Set tk = t′k and, for i < k, set ti = min(t′i , ti+1 − 1). Define the weak descent
composition of T , denoted by des(T ), by des(T )ti = |τ (i) | and all other parts are
zero if all ti > 0; and des(T ) = ∅ otherwise.
Notice the descent composition is obtained from the weak descent composition
simply by removing the zeros.
Example 3.2.5. The top tableau in Fig. 9 has a descent only at 2, so the partitioning is (τ (2) |τ (1) ) = (3|21). Thus t2 = t′2 = 3, the row index of 3, t′1 = 2,
the row index of 2 and 1, and t1 = min(t′1 , t2 − 1) = min(2, 2) = 2. These
determine the positions of the descents, and so the weak descent composition is
(0, |τ (1) |, |τ (2) |) = (0, 2, 1).
The bottom tableau in Fig. 9 has a descent only at 1, so the partitioning is now
(τ (2) |τ (1) ) = (32|1). Thus t2 = t′2 = 2, the row index of 2 and 3, t′1 = 3, the
row index of 1, and t1 = min(t′1 , t2 − 1) = min(3,1) = 1. Thus the weak descent
composition is (|τ (1) |, |τ (2) |, 0) = (1, 2, 0).
We take [5, Corollary 3.16] as our definition for key polynomials.
Definition 3.2.6 ([5]). For a weak composition a, the key polynomial κa is
X
Fdes(T ) ,
(3.4)
κa =
T ∈SKT(a)

where the sum is over all standard key tableaux of shape a for which the weak
descent composition is not ∅.
For example, from Example 3.2.5, we have
κ(0,2,1) = F(0,2,1) + F(1,2,0) .
Composing the bijective correspondence defined by Assaf and Searles between
quasi-Yamanouchi Kohnert tableaux and quasi-Yamanouchi Young tableaux [4,
Theorem 4.6] with the bijective correspondence defined by Assaf [5, Theorem 3.15]
between those and the corresponding standard tableaux yields the following.
Proposition 3.2.7. Given a weak composition a that rearranges to a partition λ,
the map ϕ : SKT(a) → SYT(λ) that drops cells within their columns to partition
shape, sorts column entries to decrease bottom to top, and changes entries by i 7→
n − i + 1 is a well-defined bijection. Moreover, for T ∈ SKT(a) with des(T ) 6= ∅,
we have
(3.5)

flat(des(T )) = reverse(Des(ϕ(T ))).

In particular, for a = (0, . . . , 0, λℓ , . . . , λ1 ) of length n, we have
(3.6)

κ(0,...,0,λℓ ,...,λ1 ) = sλ (x1 , x2 , . . . , xn ).

12

S. ASSAF AND S. VAN WILLIGENBURG

Thus key polynomials generalize Schur polynomials. Moreover, key polynomials
stabilize to Schur functions as
(3.7)

lim κ0m ×a (x1 , . . . , xm , 0, . . .) = sλ (X),

m→∞

where 0m × a is a with m zeros prepended and λ is the partition reordering of a.
4. Littlewood–Richardson rules
4.1. Skew Schur functions. Standard Young tableaux arise from considering saturated chains in Young’s lattice beginning at ∅. We may define a more general class
of objects, called standard skew Young tableaux, by considering saturated chains
between any two partition λ ⊂ ν. The direct combinatorial characterization is
completely analogous: the standard skew Young tableaux of shape ν/λ are
bijective fillings of the set-theoretic difference ν/λ, called the skew diagram, with
1, 2, . . . , n such that rows increase left to right and columns increase bottom to top.
Directly extending the notion of descents and descent compositions allows us to
define skew Schur functions directly analogous to Definition 3.1.3.
Definition 4.1.1. For partitions λ ⊂ ν, the skew Schur function sν/λ is
X
FDes(T ) (X).
(4.1)
sν/λ (X) =
T ∈SYT(ν/λ)

Skew Schur functions are symmetric functions, and so we may consider the
Littlewood–Richardson coefficients cνλ,µ that give their Schur expansion,
X
(4.2)
sν/λ (X) =
cνλ,µ sµ (X).
µ

A priori, these coefficients are integers. It is a deep result in algebraic combinatorics,
with myriad beautiful proofs, that these coefficients are nonnegative. Moreover, the
nonnegativity manifests in representation theory and geometry as well, with cνλ,µ
giving multiplicities of irreducible representations in tensor products of polynomial
representations for the general linear group as well as intersection numbers for
Grassmannian Schubert varieties. These latter characterizations come from the
adjoint perspective of cνλ,µ as giving structure constants for Schur functions, that
is, the Schur expansion of products of Schur functions,
X
(4.3)
sλ (X)sµ (X) =
cνλ,µ sν (X).
µ

One (of many) proofs of the nonnegativity of cνλ,µ from the skew Schur function
perspective utilizes dual equivalence [6] to consolidate standard Young tableaux into
equivalence classes, each of which corresponds to a single Schur function. Loosely,
a dual equivalence for a set of objects is a collection of involutions indexed by
2 ≤ i ≤ n − 1 that commute when indices are far apart and whose local equivalence
classes are Schur positive, namely a nonnegative linear combination of Schur
functions. Formally, we have [6, Definition 4.1].
Given a strong composition α of n and integers 1 ≤ h ≤ i ≤ n, let α(h,i) be the
composition obtained by deleting the first h − 1 and last n − i pieces from α.

SKEW KEY POLYNOMIALS

13

Example 4.1.2. Let α = (3, 2, 3, 1), a strong composition of 9. Then α(3,7) =
(1, 2, 2), corresponding to deleting the first 2 pieces both of which come from α1
and last 2 pieces one of which comes from α4 and the remaining from α3 .
Definition 4.1.3 ([6]). Let A be a finite set, and Des be a map from A to strong
compositions of n. A dual equivalence for (A, Des) is a family of involutions
{ϕi }1<i<n on A such that
(i) For all 0 ≤ i − h ≤ 3 and all T ∈ A, there exists a partition λ such that
X
FDes(h−1,i+1) (U) (X) = sλ (X),
U∈[T ](h,i)

where [T ](h,i) is the equivalence class generated by ϕh , . . . , ϕi .
(ii) For all |i − j| ≥ 3 and all T ∈ A, we have ϕj ϕi (T ) = ϕi ϕj (T ).
Define simple involutions si for i = 1, 2, . . . , n − 1 on standard fillings of rank
n that interchange i and i + 1. On standard Young tableaux, we combine these into
elementary dual equivalence involutions, denoted by di , that act by

T if i lies between i − 1 and i + 1 in reading order,

(4.4) di (T ) =
si−1 · T if i + 1 lies between i and i − 1 in reading order,

si · T if i − 1 lies between i and i + 1 in reading order,

where we may take the reading order to be taking the entries either by row or by
column in any direction; see Fig. 10.
5
2 4
1 3

d2
d3

5
3 4
1 2

d4

4
3 5
1 2

d2

4
2 5
1 3

d3
d4

3
2 5
1 4

Figure 10. The elementary dual equivalence involutions on SYT(2, 2, 1).
Haiman [13] showed these are well-defined operators on standard Young tableaux
and that all standard Young tableaux of fixed shape fall into a single equivalence
class. Assaf [6, Proposition 3.3] elaborated on this to show that they give an
example of a dual equivalence.
Theorem 4.1.4 ([6]). Given a partition λ, the involutions di give a dual equivalence
for (SYT(λ), Des) consisting of a single equivalence class.
More importantly, the converse holds as well. That is, by [6, Theorem 3.7], any
dual equivalence is essentially this, and so taking generating functions gives the
following [6, Corollary 4.4].
Theorem 4.1.5 ([6]). If there exists a dual equivalence for (A, Des), then
X
FDes(T ) (X)
T ∈A

is symmetric and Schur positive.
It follows directly from the local nature of Definition 4.1.3 that extending the
elementary dual equivalences to standard skew Young tableaux using Eq. (4.4)
results in a dual equivalence for SYT(ν/λ), thus giving a combinatorial proof of
the Schur positivity of skew Schur functions.

14

S. ASSAF AND S. VAN WILLIGENBURG

Corollary 4.1.6 ([6]). For λ ⊂ ν, the Littlewood–Richardson coefficient cνλ,µ is
the number of dual equivalence classes of SYT(ν/λ) isomorphic to SYT(µ). In
particular, skew Schur functions are Schur positive.
4.2. Skew key polynomials. Assaf considers standard skew key tableaux in [5,
Definition 4.7], defined for any pair of weak compositions a ⊂ d. However, the
positivity result for the corresponding skew key polynomials [5, Theorem 4.10],
generalizing Corollary 4.1.6, is only proved for the limited case when the smaller
weak composition is a partition. Examples show these are not the only cases where
nonnegativity holds, with many overlooked examples arising naturally from geometric contexts. As we shall see, the key to positivity lies in the key poset. We
begin by generalizing Theorem 3.2.2 to skew key diagrams.
Theorem 4.2.1. For a = a(0) ≺· a(1) ≺· · · · ≺· a(n) = d a saturated chain in the
key poset, the standard filling of the skew key diagram for d/a defined by placing
n − i + 1 into the unique cell of a(i) /a(i−1) is a standard skew key tableaux.
Conversely, given T ∈ SKT(d/a) with n cells, setting a(0) = a and, for i =
1, . . . , n, setting a(i) to be the diagram with cells of a skewed and containing cells
labeled n, n − 1, . . . , n − i + 1 results in a saturated chain from a to d in the key
poset.
Proof. Both the poset cover relations and the key tableaux row and column conditions are local, so this follows from Theorem 3.2.2 by restricting attention to shapes
from a onward and to cells with entries 1, 2, . . . , rk(d) − rk(a).

Following [5], extend Definition 3.2.4 directly to skew standard key tableaux.
Definition 4.2.2. For weak compositions a ≺ d, the skew key polynomial κd/a
is
X
Fdes(T ) .
(4.5)
κd/a =
T ∈SKT(d/a)

Note unlike [5, Definition 4.8], we define skew key polynomials only for comparable elements of the key poset. However, the special case of skewing by an increasing
composition, for which the positivity in [5, Theorem 4.10] holds, conforms with this
more restrictive definition by Proposition 2.2.5.
Since key polynomials are a basis for all polynomials, define weak composition Littlewood–Richardson coefficients cd
a,b as the key expansion of skew key
polynomials,
X
(4.6)
κd/a =
cd
a,b κb .
b

A priori, these coefficients are integers. In fact, we will show that they are nonnegative integers, and so skew key polynomials are key positive.
To prove nonnegativity of the weak composition Littlewood–Richardson coefficients, we utilize weak dual equivalence [5], a polynomial generalization of dual
equivalence that consolidates standard key tableaux into equivalence classes, each
of which corresponds to a single key polynomial.
Extending earlier notation, given a weak composition a of rank n and integers
1 ≤ h ≤ i ≤ n, let a(h,i) be the weak composition obtained by deleting the first
h − 1 and last n − i pieces from a.

SKEW KEY POLYNOMIALS

15

Example 4.2.3. Let a = (0, 3, 2, 0, 3, 1). Then a(3,7) = (0, 1, 2, 0, 2, 0), corresponding to deleting the first 2 pieces both of which come from a2 and last 2 pieces one
of which comes from a6 and the remaining from a5 .
Definition 4.2.4 ([5]). Let A be a finite set, and let des be a map from A to weak
compositions of rank n. A weak dual equivalence for (A, des) is a family of
involutions {ψi }1<i<n on A such that
(i) For all i − h ≤ 3 and T ∈ A, there exists a weak composition a such that
X
Fdes(h−1,i+1) (U) = κa ,
U∈[T ](h,i)

where [T ](h,i) is the equivalence class generated by ψh , . . . , ψi .
(ii) For all |i − j| ≥ 3 and all T ∈ A, we have ψj ψi (T ) = ψi ψj (T ).
Define the braid involutions bi for i = 2, . . . , n − 1 on standard fillings of
rank n for which exactly one of i − 1 or i + 1 lies in the same row as i by cycling
entries i − 1, i, i + 1 in the unique way that maintains this condition. For example,
b2 will exchange the two standard key tableaux of shape (0, 2, 1) shown in Fig. 9.
We combine the braid involutions with the earlier simple involutions to give the
elementary weak dual equivalence involutions in [5, Definition 3.21].
Definition 4.2.5 ([5]).
denoted by di , on skew
(4.7)

bi · T



si−1 · T
di (T ) =
si · T



T

Define elementary weak dual equivalence involutions,
standard key tableaux that act by
if exactly one of i − 1, i + 1 lies in the row of i,
else if i + 1 lies between i and i − 1 in reading order,
else if i − 1 lies between i and i + 1 in reading order,
otherwise

where we take the reading order to be taking the entries in each column, bottom
to top and left to right.
For examples of the elementary weak involutions, see Fig. 11.
5 2
4
3 1

d2
d3

5 3
4
2 1

d4

5 4
3
2 1

d2

5 4
1
3 2

d3
d4

5 3
1
4 2

Figure 11. The elementary dual equivalence involutions on SKT(2, 1, 2).
Assaf [5, Theorem 3.25] showed these are well-defined involutions on standard key
tableaux, that all standard key tableaux of fixed shape fall into a single equivalence
class, and that this gives an example of a weak dual equivalence.
Theorem 4.2.6 ([5]). Given a weak composition a, the involutions di give a weak
dual equivalence for (SKT(a), des) consisting of a single equivalence class.
Moreover, under certain stability conditions, the converse holds. That is, by [5,
Theorem 3.29], any weak dual equivalence is essentially this and, on the level of
generating polynomials, we have the following.

16

S. ASSAF AND S. VAN WILLIGENBURG

Theorem 4.2.7 ([5]). If there exists a weak dual equivalence for (A, des) for which
des(T ) 6= ∅ for every T ∈ A, then
X
Fdes(T )
T ∈A

is key positive.
The condition that the weak descent composition is nonempty for every element
can often be circumvented if the polynomials under consideration stabilize. Assaf
uses this along with the elementary weak dual equivalence involutions to prove the
special case of the following when a is weakly increasing [5, Theorem 4.10], which
follows from Theorem 4.2.8 by Proposition 2.2.5.
Theorem 4.2.8. For a ≺ d in the key poset, the weak composition Littlewood–
Richardson coefficient cd
a,b is the number of weak dual equivalence classes of SKT(d/
a) isomorphic to SKT(b). In particular, skew key polynomials are key positive.
Proof. By Theorem 4.2.6, the elementary weak dual equivalence involutions of Definition 4.2.5 give a weak dual equivalence on SKT(d). For a ≺ d in the key poset, by
Theorem 4.2.1, we have SKT(d/a) ⊂ SKT(d). Since Definition 4.2.4 is completely
local, these same involutions restrict to a weak dual equivalence on SKT(d/a).
By Definition 3.2.4, it is clear there exists some nonnegative integer m for which
des(T ) 6= ∅ for every T ∈ SKT(0m × d) (the minimal such m is given explicitly in
[4, Theorem A.6]). Therefore SKT(0m × (d/a)) ⊂ SKT(0m × d) also satisfies the
hypotheses of Theorem 4.2.7, and so we conclude κ0m ×(d/a) is a nonnegative sum
of key polynomials. Setting the first m variables to 0, we have that κd/a is also key
positive.

In fact, we can use the poset structure to prove this result is tight.
Theorem 4.2.9. For a ⊂ d such that a 6≺ d, there exists a weak composition b
for which the weak composition Littlewood–Richardson coefficient cd
a,b is negative.
Proof. Suppose ai ≤ di for all i but a 6≺ d. Let i be the largest index for which there
exists an index j > i such that ai > aj but, contrary to Definition 2.2.1, dj ≤ di ,
and take j largest among these. First consider the minimal case when both a and d
have at most 2 nonzero parts. Generically, we may assume a = (0i−1 , q, 0j−i−1 , p)
for q > p ≥ 0 and d = (0i−1 , m, 0j−i−1 , n) where n ≥ m and n > p, as illustrated
in Fig. 12. In this case, using Definition 4.2.2, we have the expansion
κd/a = κ(0i−1 ,m−q,0j−i−1 ,n−p) − κ(0i−1 ,n−p,0j−i−1 ,m−q) + lower terms,
where the lower terms do not use the variable xj . Since n − p > m − q, the two
terms with xj do not cancel, and so the key expansion is not nonnegative.
In the general case, the term κb̂ appears with coefficient 1 where b̂k = dk − ak ,
and the term κb appears with coefficient −1 where bk = b̂k for k 6= i, j and bi = b̂j
and bj = b̂i . Since bi > bj , these terms do not cancel, and so cd

a,b is negative.
Taken together, Theorems 4.2.8 and 4.2.9 show the key poset precisely characterizes the skew key polynomials with nonnegative key polynomial expansion.
The flagged Schur polynomials are another polynomial generalization of Schur
functions originally defined by Lascoux and Schützenberger [14] and studied further by Wachs [20]. Given partitions µ ⊂ λ and a flag b = (b1 ≤ b2 ≤ · · · ≤bℓλ ),

SKEW KEY POLYNOMIALS

···

···

···

···

17

···

Figure 12. A minimal instance of a ⊂ d but a 6≺ d in the key
poset. Here, cells lie in a ⊆ d and cells lie in d/a.
the flagged skew Schur polynomial Sλ/µ,b is the sum of the monomials corresponding to semistandard Young tableaux of skew shape λ/µ with entries in row i
bounded above by bi . Taking µ = ∅ gives the (nonskew) flagged Schur polynomial.
In addition to the tableaux definition, Assaf and Bergeron [1] describe flagged
(skew) Schur functions in terms of flagged (P, ρ)-partitions, a description that immediately gives the fundamental slide expansion as well.
Reiner and Shimozono [19, Theorem 23] show every flagged Schur polynomial
Sλ,b is equal to a single key polynomial κa for some weak composition a, though
the converse does not hold. That is, key polynomials are more general than flagged
Schur polynomials.
Moreover, Reiner and Shimozono [19, Theorem 20] give a flagged Littlewood–
Richardson rule showing any flagged skew Schur polynomial is a positive sum of
key polynomials, that is
X
(4.8)
Sλ/µ,b =
cλa,µ κa ,
a

where cλa,µ counts the number of λ/µ-compatible tableaux whose left-nil key with
respect to λ − µ is a; see [19] for definitions and details.
By Theorems 4.2.8 and 4.2.9, it follows that each flagged skew Schur polynomial
Sλ/µ,b is equal to a skew key polynomial κd/a for some weak compositions a ≺ d,
though once again the converse does not hold. That is, skew key polynomials are
more general than flagged skew Schur polynomials, and so we obtain a maximal
generalization of the flagged Littlewood–Richardson rule.
References
[1] Sami Assaf and Nantel Bergeron. Flagged (P, ρ)-partitions. arXiv:1904.06630.
[2] Sami Assaf and Danjoseph Quijada. A Pieri rule for key polynomials. Sém. Lothar. Combin.,
80B:Art. 78, 12, 2018.
[3] Sami Assaf and Dominic Searles. Schubert polynomials, slide polynomials, Stanley symmetric
functions and quasi-Yamanouchi pipe dreams. Adv. Math., 306:89–122, 2017.
[4] Sami Assaf and Dominic Searles. Kohnert tableaux and a lifting of quasi-Schur functions. J.
Combin. Theory Ser. A, 156:85–118, 2018.
[5] Sami H. Assaf. Weak dual equivalence for polynomials. arXiv:1702.04051.
[6] Sami H. Assaf. Dual equivalence graphs I: A new paradigm for Schur positivity. Forum Math.
Sigma, 3:e12, 33, 2015.
[7] C. Bessenrodt, K. Luoto, and S. van Willigenburg. Skew quasisymmetric Schur functions and
noncommutative Schur functions. Adv. Math., 226(5):4492–4532, 2011.
[8] Michel Demazure. Désingularisation des variétés de Schubert généralisées. Ann. Sci. École
Norm. Sup. (4), 7:53–88, 1974. Collection of articles dedicated to Henri Cartan on the occasion of his 70th birthday, I.
[9] Michel Demazure. Une nouvelle formule des caractères. Bull. Sci. Math. (2), 98(3):163–172,
1974.

18

S. ASSAF AND S. VAN WILLIGENBURG

[10] Ira M. Gessel. Multipartite P -partitions and inner products of skew Schur functions. In Combinatorics and algebra (Boulder, Colo., 1983), volume 34 of Contemp. Math., pages 289–317.
Amer. Math. Soc., Providence, RI, 1984.
[11] J. Haglund, K. Luoto, S. Mason, and S. van Willigenburg. Quasisymmetric Schur functions.
J. Combin. Theory Ser. A, 118(2):463–490, 2011.
[12] J. Haglund, K. Luoto, S. Mason, and S. van Willigenburg. Refinements of the LittlewoodRichardson rule. Trans. Amer. Math. Soc., 363(3):1665–1686, 2011.
[13] Mark D. Haiman. Dual equivalence with applications, including a conjecture of Proctor.
Discrete Math., 99(1-3):79–113, 1992.
[14] Alain Lascoux and Marcel-Paul Schützenberger. Polynômes de Schubert. C. R. Acad. Sci.
Paris Sér. I Math., 294(13):447–450, 1982.
[15] Alain Lascoux and Marcel-Paul Schützenberger. Keys & standard bases. In Invariant theory
and tableaux (Minneapolis, MN, 1988), volume 19 of IMA Vol. Math. Appl., pages 125–144.
Springer, New York, 1990.
[16] D. E. Littlewood and A. R. Richardson. Group characters and algebra. Philos. Trans. R.
Soc. Lond. Ser. A, 233:99–141, 1934.
[17] K. Luoto, S. Mykytiuk, and S. van Willigenburg. An introduction to quasisymmetric Schur
functions - Hopf algebras, quasisymmetric functions, and Young composition tableaux.
Springer, 2013.
[18] Sarah Mason. An explicit construction of type A Demazure atoms. J. Algebraic Combin.,
29(3):295–313, 2009.
[19] Victor Reiner and Mark Shimozono. Key polynomials and a flagged Littlewood-Richardson
rule. J. Combin. Theory Ser. A, 70(1):107–143, 1995.
[20] Michelle L. Wachs. Flagged Schur functions, Schubert polynomials, and symmetrizing operators. J. Combin. Theory Ser. A, 40(2):276–289, 1985.
Department of Mathematics, University of Southern California, 3620 S. Vermont
Ave., Los Angeles, CA 90089-2532, U.S.A.
E-mail address: shassaf@usc.edu
Department of Mathematics, University of British Columbia, 1984 Mathematics Rd.,
Vancouver, BC V6T 1Z2, Canada
E-mail address: steph@math.ubc.ca

