Designing pretty good state transfer via isospectral reductions
M. RoÃàntgen,1 N. E. Palaiodimopoulos,2 C. V. Morfonios,1 I. Brouzos,2, 3 M. Pyzh,1 F. K. Diakonos,2 and P. Schmelcher1, 4
1

arXiv:1908.02046v1 [quant-ph] 6 Aug 2019

Zentrum fuÃàr optische Quantentechnologien, UniversitaÃàt Hamburg, Luruper Chaussee 149, 22761 Hamburg, Germany
2
Department of Physics, University of Athens, 15771 Athens, Greece
3
Le Mans University, LAUM UMR CNRS 6613, Av. O. Messiaen, 72085, Le Mans, France
4
The Hamburg Centre for Ultrafast Imaging, UniversitaÃàt Hamburg, Luruper Chaussee 149, 22761 Hamburg, Germany
We present an algorithm to design networks that feature pretty good state transfer (PGST), which is of interest
for high-fidelity transfer of information in quantum computing. Realizations of PGST networks have so far
mostly relied either on very special network geometries or imposed conditions such as transcendental on-site
potentials. However, it was recently shown [Eisenberg et al., arXiv:1804.01645] that PGST generally arises
when a network‚Äôs eigenvectors and the factors P¬± of its characteristic polynomial P fulfill certain conditions,
where P¬± correspond to eigenvectors which have ¬±1 parity on the input and target sites. We combine this result
with the so-called isospectral reduction of a network to obtain P¬± from a dimensionally reduced form of the
Hamiltonian. Equipped with the knowledge of the factors P¬± , we show how a variety of setups can be equipped
with PGST by proper tuning of P¬± . Having demonstrated a method of designing networks featuring pretty good
state transfer of single site excitations, we further show how the obtained networks can be manipulated such that
they allow for robust storage of qubits. We hereby rely on the concept of compact localized states, which are
eigenstates of a Hamiltonian localized on a small subdomain, and whose amplitudes completely vanish outside
of this domain. Such states are natural candidates for the storage of quantum information, and we show how
certain Hamiltonians featuring pretty good state transfer of single site excitation can be equipped with compact
localized states such that their transfer is made possible.

I.

INTRODUCTION

The ability to reliably transfer information through a quantum system is of key importance in the quest towards quantum computers. One particularly appealing approach is that
of perfect state transfer (PST) [1‚Äì3] of a given state ‚Äì usually
a single site excitation of an XY -Hamiltonian ‚Äì from an input
to a target site. What makes PST appealing is that it achieves
perfect transfer fidelity (the portion of the final state at the desired site) F = 1 by simple time-evolution of the input excitation with the time-independent Hamiltonian. From a realistic
viewpoint, however, the strong requirement of unity fidelity
is never met due to imperfections; it rather limits severely the
flexibility in the design of quantum networks for state transfer. A less restrictive alternative to PST is the concept of
pretty good [4] (also called almost perfect [5]) state transfer
(PGST), where F gets arbitrarily close to unity at a corresponding time: Specifically, for every  > 0 there is a time t
such that F (t ) > 1‚àí, where F (t) = | hœàI |exp(iHt)|œàF i |2
(setting ~ = 1) for a transfer from state |œàI i to state |œàF i
at time t, with H denoting the Hamiltonian. Clearly, PGST
includes the case of PST and is therefore a broader concept.
Still, the design of PGST-Hamiltonians is challenging, since it
usually requires information about the exact eigenvalue spectrum. So far, many approaches to PGST are therefore based
on special Hamiltonian designs such as certain graph products
[6‚Äì10]. A general and intuitive design mechanism of PGSTHamiltonians is thus lacking.
Recently, progress in this direction has been made in Ref.
[11]. There, an approach is presented that achieves PGST between two sites u and v without direct tuning of the eigenvalue spectrum. The approach is based on Hamiltonians H
which feature so-called cospectral sites u and v for a range
of parameters. In Hamiltonians with such cospectral sites u
and v, all eigenvectors can be chosen to have parity ¬±1 on u

and v. Eisenberg et al. then show that PGST between u and
v automatically arises if the factors P¬± , which are related to
eigenvectors which have non-vanishing amplitudes on u and v
and additionally have ¬±1 parity on them, respectively, of the
characteristic polynomial of H fulfill certain conditions. The
task of achieving PGST therefore boils down to proper tuning
of the factors P¬± . In practice, though, obtaining these factors
from the underlying Hamiltonian is not easy. In Ref. [11], P¬±
are (up to special cases involving symmetries or very small
setups) not obtained, but indirect methods, which manipulate
H such that P¬± are enforced to meet the desired properties,
are presented. An example of such a method is the addition of
transcendental numbers to the values of certain on-site potentials of the Hamiltonian. While elegant, this method limits the
practical applicability, and the question arises whether other,
more practical methods of designing PGST Hamiltonians exist.
In this work, we present such a method by pursuing an alternative road to PGST. Namely, by directly obtaining the polynomials P¬± from an underlying symmetric Hamiltonian that
features cospectral sites u and v. To this end, we combine the
mathematical relations underlying the works in Ref. [11, 12]
with the theory of isospectral reductions [13‚Äì19]. Isospectral
reduction is a method to reduce the size of a given Hamiltonian while keeping a large amount of information on its eigenvalues and eigenvectors. We utilize the isospectral reduction
to ‚Äúcompress‚Äù only the relevant spectral information for the
problem at hand by building upon the very recent results of
Ref. [19]. These results put strong constraints on the structure of the isospectral reduction of a Hamiltonian that features
cospectral sites. We use these structural constraints to extract
the P¬± from the isospectral reduction of H. Equipped with
P¬± , we show how this allows for a convenient and powerful algorithm for designing Hamiltonians featuring PGST by
properly tuning P¬± whilst maintaining the cospectrality of u

2
and v. In order to be self-contained, we also collect known
facts from the literature and condense them into a detailed
method to generate Hamiltonians that feature cospectral sites
u and v.
Interestingly, this cospectrality is often accounted for by
spatial local symmetries, i.e., symmetries, which are only
valid in spatial subdomains of the whole system. Usually,
the signatures of such local symmetries are only indirectly encoded into so-called non-local currents, as has been shown in
Refs. [20‚Äì25]. On the contrary, the impact of the underlying
local symmetries is directly visible in setups featuring cospectral vertices u and v, where all eigenvectors are (in the case of
degeneracies, can be chosen to be) locally parity symmetric on
these sites. It would thus be interesting to analyze cospectral
Hamiltonians within the framework developed in those works.
Having demonstrated how to design networks capable of
PGST of single site excitations, we show how these networks
can be modified to allow for robust storage of qubits. To this
end, we slightly modify these networks, thereby equipping
them with so-called compact localized states. Such states are
eigenstates of the underlying Hamiltonian [26, 27], and are
perfectly localized on a finite number of sites. They are thus
ideally suited for the storage of qubits, and we show how, after
equipping networks with compact localized states, these can
also be pretty well transferred.
This work is structured as follows. We first define the necessary and sufficient conditions for the realization of PGST
in Section II A. We then investigate the necessary condition,
namely strong cospectrality, which is a stronger version of
cospectrality, in more detail in Section II B, and the connection of this property to symmetries in Section II C. Our
treatment of strong cospectrality is completed in Section II D,
where we show how Hamiltonians with this property can be
designed. In Section II E, we introduce isospectral reductions,
and show how they can be harnessed to extract the polynomials P¬± . In Section III, we use this method to construct an
algorithm for the design of graphs featuring PGST. This algorithm represents the main novelty and also one of the two
highlights of this work. We apply the algorithm to a simple
example in Section III B. In Section IV, we present the necessary modifications needed for PGST of compact localized
states. Finally, we conclude our work in Section V.

the context of quantum computers, a natural choice are spin
networks, where each site represents a spin-1/2 qubit (measured up or down). The Heisenberg XX interaction Hamiltonian then reduces to the simple description Eq. (1) within
the subspace of one excitation (1 spin up and all others down)
[30].
In the course of this work, we will often depict H as a
graph, i.e., as a collection of vertices and edges connecting
them. The adjacency matrix of the graph then equals H. As
this establishes a one-to-one relation between graphs and the
underlying H, and we will use these two terms interchangeably. Likewise, we will use the terms ‚Äúsite‚Äù and ‚Äúvertex‚Äù interchangeably throughout this work.
In the following, we will comment on the conditions for
PGST, and show how it can be achieved. In order to help
the reader in comprehending the different aspects involved,
we visualize in Fig. 1 the main mathematical background of
our method to achieve PGST. The overview Fig. 1 contains
all core mathematical theorems used in this work in compact form. We stress that the style of presentation at this
point aims at being self-contained, thereby transferring insights from graph theory to a broader physics community in
Sections II B to II D. Sections II E and III contain, along with
the results provided in Section IV, the highlights and main
novelties of this work.
A.

Necessary and sufficient conditions

In order to support PGST between two sites u and v, a
Hamiltonian H has to fulfill the following two conditions,
whose combination is necessary and sufficient: (i) The two
sites u and v must be strongly cospectral (see the following
subsection) and (ii) its spectrum must fulfill the following condition [31]: Any integers {li , mj } which fulfill
X
X
li Œª+
mj Œª‚àí
(2)
i +
j =0
i

j

X
i

THEORY: PRETTY GOOD STATE TRANSFER OF
SINGLE-SITE EXCITATIONS

Throughout this work, we will consider setups described by
symmetric Hamiltonians of the form
H=

X
i

Ei |ii hi| +

X

hi,j |ii hj|

(1)

X

mj = 0

(3)

j

must also fulfill
X

II.

li +

mi is even.

(4)

i
‚àí
Here, Œª+
i , Œªj are the eigenvalues associated to eigenvectors
+
‚àí
|œài i , |œàj i of H that fulfill

hœài+ |ui = + hœài+ |vi =
6 0
hœàj‚àí |ui = ‚àí hœàj‚àí |vi =
6 0

<i,j>

with real on-site potentials Ei and couplings hi,j = hj,i ,
where the sum in Eq. (1) runs over all interconnected sites
i and j. We use bold-faced script for both vectors and matrices. The Hamiltonian given by Eq. (1) can be represented, for
example, by coupled waveguide arrays [28, 29]. However, in

where |ui , |vi describe single-site excitations of sites u and v,
respectively.
Note that there is always at least one set of integers {li , mj }
fulfilling Eqs. (2) and (3), namely, the trivial choice li =
mj = 0 ‚àÄ i, j, which also fulfills Eq. (4). In certain cases, this
trivial choice is also the only one fulfilling Eqs. (2) and (3).

3
Non-degenerate spectrum of H

2

3

4

1

Figure 1. Grey part: The connection between main theorems that lead to realizations of PGST. Double lines with arrows denote mathematical
relations ‚áê, ‚áí, ‚áî. Yellow/golden part: Essential steps (enumerated 1 to 4) of the algorithm for the design of PGST-Hamiltonians [presented
in Section III]. The isospectral reduction RS (H, Œª) is defined in Eq. (14).

An example
is the‚àöcase where there are only two eigenvalues,
‚àö
Œª+ = 2, Œª‚àí = 3. Then
‚àö
‚àö
l 2 + m 3 = 0,
for integers l, m, can only be fulfilled when l = m = 0. The
setup would thus feature PGST between u and v.

for all non-negative integers k < N , where H ‚àà RN √óN . As
a side remark, we note that Eq. (5) automatically holds for all
k > 0 provided that it holds for 0 < k < N . This is due
to the Cayley-Hamilton theorem, which states that every matrix power Hk‚â•N can be expanded in terms of smaller powers
Hk<N , i.e.,
Hk‚â•N =

B.

(k)

ai Hi

i=0

Geometric interpretation of cospectrality
(k)

A necessary condition for PGST is that u and v are strongly
cospectral [31]. As strongly cospectral vertices are also
cospectral [32] [see Fig. 1], we will first investigate and understand this weaker property before turning to its stronger version. Two vertices u, v are said to be cospectral if œÉ(H \ u) =
œÉ(H \ v), where œÉ(H) denotes the eigenvalue spectrum of H,
and H \ u denotes the Hamiltonian obtained from H by deleting the uth row and column. For our purpose, it is easier to
rely on an equivalent condition [32] in terms of the diagonal
entries of powers of H. Namely, u and v are cospectral if and
only if
(Hk )u,u = (Hk )v,v

N
‚àí1
X

(5)

with ai being the expansion coefficients. These coefficients are scalars, and therefore Eq. (5) must hold for all nonnegative integers k, provided that it holds for 0 ‚â§ k < N .
While well-known in graph theory, it is perhaps surprising to many physicists that the entries of Hk (for integer
k > 0) possess a convenient interpretation. To this end, we
interpret the Hamiltonian matrix as a graph, i.e., as a network of vertices Vi connected to each other by weighted edges
ei,j = {Vi , Vj }, with weight w(ei,j ) = Hi,j . This is exemplarily done in Fig. 2 (a) for the Hamiltonian given in Fig. 2
(b). In this picture of representing H as a graph, every matrix
element Hi,j 6= 0 is connected to an edge between vertices
i and j; and in particular, non-vanishing diagonal elements
Hi,i 6= 0 refer to a link from site i to itself, with weight given

4

1

1
2

2

1

3

1

3

4

1

2

1

2

1

1

1

2

2

+
3

2

2

1

1

1

2

+

2

1

2

2

1

1

2

2

1

3

1

2

+

1

1

3

1

2

2

+

+

by w(ei,i ) = Hi,i .
Now that we have interpreted the entries of H in terms of
edges, we show how entries of higher-order powers Hk>1 can
be interpreted in terms of walks. A walk can be thought of a
route through the graph from one vertex to another by walking along the edges connecting neighboring vertices. Mathematically, it is defined as an alternating sequence of vertices and edges, where each edge must connect its precursor vertex to its successor. For example, in Fig. 2 (a), a
walk of length 2 from vertex 1 to 4 would be the sequence
p = {V1 , e1,3 , V3 , e3,4 , V4 }. In order to interpret the entries of
Hk , we note that, just as each edge ei,j can be given a weight
w(ei,j ), we can also give each walk a weight by multiplying
the weights of all edges occurring within this walk. Thus,
the weight of the walk p = {V1 , e1,3 , V3 , e3,4 , V4 } would be
w(p) = w(e1,3 ) ¬∑ w(e3,4 ) = 1 ¬∑ 1. Equipped with these definitions, one can show that [a proof is provided in Appendix A]
X  (k) 
(Hk>0 )a,b =
w pa,b
(6)

+

Figure 2. The entries of matrix powers of any matrix can be interpreted in terms of walks. (a) shows a graph, described by the matrix
H denoted in (b). We have here used the convention from graph theory that diagonal elements Hi,i are plotted as links from i to itself.
(b ‚Äì d) provide help on how to interpret the entries of powers Hk
(see text for details).

6

Figure 3. A collection of graphs featuring cospectral vertices. In
every graph, the two red vertices are cospectral, provided that the
equality of certain couplings (denoted by different line styles and
labels) is kept, and that vertices of equal color share the same, arbitrarily valued on-site potential.

p
(k)

where pa,b denotes one possible walk of length k between vertices a and b, and the sum is over all such walks. In other
words, the value of the matrix element (Hk )i,j is equal to the
sum of weights of all walks of length k between vertices i and
j. In Figure 2 (b ‚Äì d), we have visualized this interpretation
of walks, and have also explicitly given the integer powers
Hk<N .
We now connect the interpretation of matrix elements of
Hk in terms of walks to the cospectrality of two vertices u
and v. As we have seen above, these are cospectral if and
only if Eq. (5) is fulfilled for all integer k < N , with N being
the number of sites contained in H. Now, by interpreting the
entries of Hk in terms of walks, the cospectrality of u and v
can therefore be determined in a simple and straightforward
manner. Namely, by evaluating all walks of length k that go
from u onto itself, and those that go from v onto itself, and
comparing the respective sum of weights, order by order in
k < N . Thus, in Fig. 2, (Hk )1,1 = (Hk )2,2 for k < 4 [and,
by the Cayley-Hamilton theorem, also for all integer k > 0],
which makes the sites u = 1 and v = 2 cospectral. Alternatively, one can also rely on the statement that two sites u
and v are cospectral if and only if œÉ(H \ u) = œÉ(H \ v). As
the graph of H \ 1 is identical to that of H \ 2, their spectra
œÉ(H\1) = œÉ(H\2) are trivially identical, and the sites u = 1
and v = 2 are therefore cospectral.
We show a collection of cospectral graphs in Fig. 3. In
every graph, the two red vertices (labeled u and v) are cospectral, provided that any two couplings denoted by the same label and line style are identical, and that any two vertices sharing the same color also have identical on-site potential. Let
us now investigate these graphs in more detail. By comparing different variations, it can be seen that certain changes do
not break the cospectrality of two vertices. For example, in
Fig. 3 (a2), we have modified the graph from Fig. 3 (a1) by
identically coupling each red vertex to an additional purple
vertex. In Fig. 3 (a3), we have modified the graph of Fig. 3
(a1) by inserting the ‚Äúcentral‚Äù vertex m. We term this vertex central since it can be reached from sites 1 and 5 by a

5
walk comprising two steps, and the corresponding weights of
these two walks are identical. To understand why inserting
this vertex does not break the cospectrality, one only needs to
investigate the influence of this change by comparing the diagonal matrix elements (HkB )S,S and (Hk )S,S . Here, HB and
H describe the setup of Fig. 3 (a1) and (a3), respectively, and
S = {u, v} label the two red sites. Before the change, u and
v were cospectral, so that (HkB )u,u = (HkB )v,v ‚àÄ k. Thus, to
understand why the cospectrality is kept, we only need to look
at the differences (‚àÜHk )S,S = (Hk )S,S ‚àí (HkB )S,S caused
by inserting the new vertex. Though tedious, it is a straightforward task to show that (‚àÜHk )1,1 = (‚àÜHk )5,5 for k < 9,
and, by the Cayley-Hamilton theorem, therefore for all k. The
addition of vertex m does thus, at each order k, add an equally
valued sum of weights of walks from site 1 to itself compared
to those from site 5 to itself. For this reason, its addition does
not change the cospectrality of u and v.
C.

Strong cospectrality and the impact of symmetries

As we have seen above, cospectrality is linked to the geometric and spectral properties of a graph. It is likewise linked
to properties of the graph‚Äôs eigenstates. Indeed, it can be
shown that two sites u, v are cospectral if and only if [32],
for H |Œªi i = Œª |Œªi i,
X
i

| hŒªi |ui |2 =

X

| hŒªi |vi |2

(7)

i

is fulfilled for all Œª. In words, u and v are cospectral if and
only if, within each degenerate subspace, the sum of squares
of absolute values of projections on sites u is equal to that of
projections on site v.
If u and v are cospectral and additionally [11]
hŒªÃÉi |ui = ¬± hŒªÃÉi |vi
(8)
P
for any superposition |ŒªÃÉi i = j cj |Œªj i of degenerate states
|Œªj i, then u and v are said to be strongly cospectral. Therefore, strong cospectrality implies cospectrality, but that the reverse is not necessarily true. Unlike cospectrality, which can
be readily interpreted and tested for in terms of walks, we are
not aware of an easy, i.e., without computing the determinant
or the eigenstates of the graph, method to test whether a given
general graph is strongly cospectral or not. As the field of
cospectral vertices is quite young, there is hope that this may
change in the future, and we refer the interested reader to Ref.
[32] for further information on the fascinating field of strongly
cospectral vertices.
With the above statements in mind, let us now investigate
the symmetries of cospectral graphs. To this end, we compare the graphs shown in Fig. 3 to the one shown in Fig. 2
(a). The latter graph has the special property that the underlying Hamiltonian is invariant under the permutation of vertices
1 and 2 and therefore commutes with the corresponding permutation operator. As is well-known, such a symmetry has
a drastic impact: The eigenstates are (or, in case of degeneracies, can be chosen to have) parity ¬±1 with respect to a

flip of sites u and v. Thus, they fulfill Eq. (7), so that u and
v are cospectral. Provided that states of negative and positive parity are non-degenerate to each other, they additionally
fulfill Eq. (8), so that u and v are even strongly cospectral.
While the fact that a permutation symmetry of u and v leads
to their (strong) cospectrality should be no surprise, things
change when inspecting the graphs shown in Fig. 3. While
they are indeed all cospectral, none of them is invariant under any non-trivial permutation of vertices. In other words,
the underlying Hamiltonian does not commute with the corresponding permutation matrices. However, due to cospectrality their eigenstates fulfill the same equation Eq. (7) [and,
depending on degeneracies, also Eq. (8)] as they would do
in the presence of a permutation symmetry. For this reason,
graphs (or, just as well, matrices) that lack direct symmetries,
but whose eigenstates fulfill Eqs. (7) and (8) were recently
termed latently symmetric [18, 19]. However, although these
symmetries may indeed seem hidden, we would like to mention here that all the graphs shown in Fig. 3 indeed feature
local symmetries, i.e., symmetries within subdomains of the
system, such that the underlying symmetry operations commute with the Hamiltonian of the subsystem, but not with that
of the complete one. An example is the subsystem of sites
2, 3, 4 in Fig. 3 (a1), which is invariant under the permutation
of sites 2 and 4. Given the high number of local symmetries
in latently symmetric setups, it would be interesting to investigate such systems under the recently established framework
of local symmetries [20‚Äì25], which provides dedicated tools
for the analysis of such setups.
As a concluding remark, we note that there are still many
questions open regarding the connection between local symmetries of a Hamiltonian H and the cospectrality of two sites
u and v of H. Given such a Hamiltonian, it is clear that the
subsystem HSS ‚àà R2√ó2 with S = {u, v} is invariant under
the exchange of u and v, since H is symmetric and cospectrality of u and v implies that Hu,u = Hv,v . However, it is yet
unknown whether and to which amount H must necessarily
feature more (i.e., apart from that of HSS ) local symmetries
in order to allow for the cospectrality of u and v. Although the
question about the necessity of local symmetries for cospectrality is thus still open, local symmetries often naturally appear during the process of designing networks with cospectral
vertices, as we will see in the following section.

D.

Designing graphs featuring strongly cospectral vertices

Let us now briefly recapitulate the above. We have seen
that a necessary condition for PGST from u to v is strong
cospectrality of these two vertices. This implies that u and
v are cospectral, and we demonstrated that whether u and v
are cospectral can be easily determined by testing whether
(Hk )u,u = (Hk )v,v ‚àÄ k < N . We then showed how these
matrix entries can in turn be determined by summing up the
respective weights of all possible walks of length k from sites
u and v to themselves. In the following, we will show how
one can design graphs featuring strongly cospectral vertices u
and v. We will start with a simpler problem, namely, the de-

6

Figure 4. (a1 ‚Äì a2): Creation of a graph [as the one shown in (a2)] featuring cospectral vertices from an arbitrary graph [as the one shown in
(a1)] by symmetrization of the site u. In (a3), we divide the given graph featuring cospectral sites u and v into two parts: The two red sites
denoting u, v, and the remainder of the graph, denoted by a cloud. In the remainder of this figure, the combination of the two red sites with a
cloud denote an arbitrary subsystem featuring cospectral vertices u and v. In (a4 ‚Äì e2), we present a number of operations on such a general
graph which preserve the cospectrality. The validity of these operations is proven in Appendix B.

sign of graphs with cospectral vertices u and v, and then show
how strong cospectrality can be achieved.
A convenient way to create a graph with cospectral vertices is to take any graph, and replicate and symmetrize one
of its sites, u, as shown in Fig. 4 (a1 ‚Äì a4). This symmetrization then automatically yields the cospectrality of site u and
its symmetry partner u = v (see figure). This is due to
the fact that the underlying Hamiltonian is invariant under an
exchange of u and v, which can easily be shown to imply
cospectrality of these vertices.
Having seen how a graph can be changed to feature cospectral vertices u and v, let us now show some modifications of
this graph which keep the cospectrality. The procedure is
shown in Fig. 4 (b1 ‚Äì e2), but let us elaborate more on its
subfigures (a1 ‚Äì a3) first. Figure 4 (a1 - a2) show the above
symmetrization procedure for a simple example setup of five

sites. In Fig. 4 (a3), the logic underlying the subfigures (b1
‚Äì e2) is shown. Namely, the cloud incorporates a subgraph
which must be chosen such that the composite graph, consisting of this subgraph and the two red vertices, features cospectrality of these two red vertices. This subgraph can consist of
the four vertices as shown in Fig. 4 (a3), but can likewise be
an arbitrarily complicated structure as long as the two red vertices are cospectral in the composite structure. In Fig. 4 (a4),
we show a first composite structure. We then change it by a
series of modifications in Fig. 4 (b1 ‚Äì b3), Fig. 4 (c1 ‚Äì c2),
Fig. 4 (d) and Fig. 4 (e1 ‚Äì e2). Each of these modifications
keeps the cospectrality of the two red vertices, as we prove in
Appendix B.
These modifications can be divided into two classes: Those
where the subsystem HBR consisting of the red and blue sites
is reflection symmetric about the horizontal axis, so that its

7
sites i are transformed as i ‚Üî i [compare Fig. 4 (b1)] and
those where there is no such symmetry. The graphs shown in
Fig. 4 (b1,b2,c1,e1) belong to the first class. The principle
underlying this class of modifications is that, under the symmetry operation of a reflection of HBR about the horizontal
axis, the two sites u and v are mapped onto each other. Due
to this symmetry, they are trivially cospectral within HBR .
As we show in Appendix B, their cospectrality is preserved
also in the full system, where HBR is connected to the cloud.
The graphs shown in Fig. 4 (b3,c2,d,e2) belong to the second
class. In these setups, the corresponding subgraph HBR is no
longer symmetric at all. Nevertheless, the sites u and v are
cospectral, and their cospectrality can readily be understood
by evaluating the powers of HBR , as was done in Section II B.
We thus demonstrate a set of examples which allow to design a variety of cospectral graphs from simpler structures
such as the one shown in Fig. 4 (a2). In Fig. 4 (e1 ‚Äì e2),
we apply the modifications done in Fig. 4 (b1 ‚Äì b3) to two
isolated sites (the red vertices). We thereby create the iconic
graph that is shown in the first paper on cospectral vertices
by Schwenk [33] and is also depicted in many publications
related to cospectrality, for example in Refs. [11, 19, 32].
We stress that the operations presented above are certainly
only a subset of valid modifications that keep cospectrality.
As we noted above, the study of cospectral vertices is still
an emerging field, and we expect that there will be more construction principles found in the future. To help the reader and
to spread the understanding of graphs with cospectral vertices,
we developed a graphical MATLAB tool that allows to design
graphs and check for cospectrality of vertices in an intuitive
and fast way. This tool is available upon request from the authors.
Let us now come back to a statement about local symmetries, made in the last paragraph of Section II C. There,
we stated that local symmetries often occur naturally during
the process of designing Hamiltonians featuring cospectral
sites. We can now support this statement by looking at the
graphs depicted in Fig. 4 (b3) and (c2), both of which feature local symmetries. In Fig. 4 (b3), the subgraph consisting
of the sites u, v, 1, 2, 3, 4 is invariant under the permutation
1 ‚Üî 4, 2 ‚Üî 3, u ‚Üî v. This local symmetry is caused by
the way Fig. 4 (b3) was constructed. Namely, by first making symmetric changes [performed in Fig. 4 (b1 ‚Äì b2)] to the
initial setup of Fig. 4 (a4), and breaking them afterwards by
performing another change, as done in Fig. 4 (b3). The underlying symmetries present in Fig. 4 (b1 ‚Äì b2)] are then rendered
to be local symmetries in Fig. 4 (b3)]. A similar reasoning can
be done for the setup depicted in Fig. 4 (c2). Local symmetries
can also occur accidentally, as we now show. To this end, we
note that the graph in Fig. 4 (d) was designed on purpose such
that u and v are cospectral for arbitrary h1 , h2 , h3 , h4 > 0.
In particular, the hi can be chosen asymmetrically, i.e., such
that no any two couplings are identical. Yet, as a byproduct of this construction that aims at an asymmetric graph, the
on-site potentials of the sites 1 to 4 must all have the same
value in order to maintain cospectrality of u and v for arbitrary
h1 , h2 , h3 , h4 . As a result, the subgraph of sites 1, 2, 3, 4 is invariant under the cyclic permutation 1 ‚Üí 2 ‚Üí 3 ‚Üí 4 ‚Üí 1,

representing an accidental local symmetry caused by cospectrality.
Having shown a method to create graphs featuring cospectral vertices, let us now comment on how these can be modified to achieve strong cospectrality. To this end, let us analyze Eqs. (7) and (8) which describe the conditions for cospectrality and strong cospectrality, respectively. From these two
equations, it follows that whenever a Hamiltonian H features two sites u and v which are cospectral but not strongly
cospectral, H must have degenerate eigenvalues. One can thus
achieve strong cospectrality of u and v by suitably modifying
H such that (i) the cospectrality of u and v is kept and (ii)
the spectrum of H becomes non-degenerate. In other words,
if we let H(Œæ) denote a Hamiltonian with cospectral sites u
and v for a set of N parameters Œæ ‚äÜ RN describing couplings and on-site potentials occurring in H(Œæ), we look for
subspaces Œæ 0 ‚äÜ Œæ in which H(Œæ 0 ) is non-degenerate. For the
graph shown in Fig. 3 (c), we have a 9-dimensional parameter
space
Œæ = {(a, b, c, d, e, f, Ered , Eblue , Egreen ) ‚àà R}
where Ered , Eblue , Egreen denote the on-site potentials of the
red, blue and green sites, respectively. For a setup designed
using the procedure demonstrated in this section, the parameter space Œæ can be obtained as follows.
1. Parametrize the couplings and on-site potentials occurring in Hcl = Hcl (Œæcl ), where Hcl denotes the Hamiltonian describing the isolated cloud. For the graph depicted in Fig. 4 (a3), we have
Œæcl = {(a, b, c, d, Ewhite ) ‚àà R}.

(9)

where Ewhite denotes the on-site potential of the white
sites.
2. Denote by Œæcoupl the parameter space for the symmetrized couplings from Hcl to the sites u and v. For
Fig. 4 (a3), we have
Œæcoupl = {(e, f ) ‚àà R}.

(10)

3. Constrain the couplings and on-site potentials occurring in Hcl = Hcl (Œæcl ) such that u and v are cospectral within Hcl (Œæcl ). Here Hcl denotes the Hamiltonian
describing the setup without the cloud. For graphs designed using Fig. 4, we explicitly have
Ô£±
Ô£¥
{Er ‚àà R}
subfig. (a3)
Ô£¥
Ô£¥
Ô£≤{(E , E , h , h ) ‚àà R}
subfig. (b3)
r
b
1
2
Œæcl =
Ô£¥
{(E
,
E
,
h
)
‚àà
R}
subfig. (c2)
r
b
1
Ô£¥
Ô£¥
Ô£≥
{(Er , Eb , h1 , h2 , h3 ) ‚àà R : h4 > 0} subfig. (d)
where Er , Eb denote the on-site potentials of the red
and blue sites, respectively.
4. Construct Œæ from Œæcl , Œæcoupl and Œæcl as
Œæ = Œæcl ‚à™ Œæcoupl ‚à™ Œæcl

(11)

so that the dimension of Œæ is equal to the sum of dimensions of Œæcl , Œæcoupl and Œæcl . For Fig. 4 (a3), we yield
Œæ = {(a, b, c, d, e, f, Ewhite , Er ) ‚àà R}.

8
E.

Relating the spectral condition to minimal polynomials

As explained in Section II A, PGST between u and v happens if and only if u and v are strongly cospectral and the
spectrum meets the conditions Eqs. (2) to (4). In the previous
section we showed that designing a strongly cospectral graph
is straightforward. On the other hand, meeting the spectral requirements remains a difficult task. Nevertheless, in a recent
paper [11] by Eisenberg et al., this has been rendered simpler for the case of PGST. They showed that Eqs. (2) to (4)
are automatically fulfilled, provided that the polynomials P¬±
(defined below) are irreducible over the base field F (which
contains all the entries of H) and fulfill
T r(P+ )
T r(P‚àí )
6=
deg(P+ )
deg(P‚àí )

2

2

3

1

4

3

1

2

Figure 5. (a) Original graph, and its decomposition into HSS and
HSS , where S = {1, 2}. (b) The isospectral RS (H, Œª) reduction
of the graph of (a) over S.

(12)

where T r(P¬± ) denote the sum of roots of P¬± , and deg(P¬± )
denote their respective degree. The polynomials P¬± stem
from a decomposition of the characteristic polynomial of H.
More specifically, given a Hamiltonian H with two strongly
cospectral sites u and v, its characteristic polynomial P can
be decomposed [11] as
P = P0 ¬∑ P+ ¬∑ P‚àí ,

1

(13)

such that P+ and P‚àí have no multiple roots, do not share
any roots, and where the polynomials P¬± are related to eigenvectors of H which are (i) non-vanishing on sites u and v
and (ii) are of positive/negative parity on these sites, respectively. Each root of P0 with multiplicity k is related to exactly
k eigenvectors of H, all of which have vanishing amplitudes
on u and v. The problem of fulfilling the spectral condition for
PGST thus boils down to tuning the polynomials P¬± accordingly. There are two possible routes to achieve this, an indirect
and a direct one. In the indirect route, the properties of the
polynomials P¬± are controlled by applying certain changes to
the underlying Hamiltonian that cause P¬± to be irreducible
over F and meet Eq. (12), but P¬± are not directly known.
Such a method has been presented in Ref. [11], where several
such mechanisms have been shown. In particular, the method
shown there starts from a graph with cospectral vertices and
selectively adds transcendental numbers to some diagonal entries of H, such that the modified setup features PGST. While
elegant and powerful, indirect methods do not provide explicit
forms of the polynomials P¬± . This limits the ability to understand under which circumstances the underyling setup might
feature PGST.
In cases where H features an involutory symmetry œÉ, i.e.,
[H, œÉ] = 0 with œÉ 2 = I, the Hamiltonian can be blockdiagonalized [12] to obtain P¬± . An example for such an involutory symmetry is any permutation that does only pairwise
permutations of two indices, such as S : 1 ‚Üî 2 (acting as
the identity on indices 3 and 4) for the graph in Fig. 2. Unfortunately, this approach is not applicable to setups that do
not invoke such involutory symmetries, or where their form is
unknown, such as all graphs in Fig. 3.
In the following, we will present a new method to create
PGST that relies on the recently introduced isospectral reduction of H. This method and the transfer of compact localized

states, as presented in Section IV, are the two highlights of
our work. Once the polynomials are obtained, proper tuning
of parameters allows to meet the requirements for PGST.

1.

Isospectral reductions

We first provide some key aspects of isospectral reductions
[13‚Äì17, 19], introduced first by Bunimovich and Webb [13].
This concept will allow us to extract the polynomials P¬± . Our
explanations will be accompanied by the illustration in Fig. 5.
The basic idea of isospectral reductions is to reduce the dimension of a given matrix Hamiltonian H by certain transformations specified by a set of sites S, yielding a smaller matrix RS (H, Œª) dependent on a parameter Œª, which carries the
same or almost the same spectral information as the original
matrix H. Among others, the benefit of such a reduction lies
in a reduction of complexity. For this reason, the isospectral
reduction has been invented in the context of network analysis, where the sheer size of the investigated networks often
complicates their treatment. Let us now define the isospectral
reduction of a given matrix H. This reduction RS (H, Œª) is
done over the set of sites S, so that
‚àí1

RS (H, Œª) = HSS ‚àí HSS (HSS ‚àí IŒª)

HSS

(14)

and is defined for all values of Œª that are not eigenvalues of
HSS , where S denotes the complement of the set of vertices S. HSS and HSS denote two subsystems of H, obtained from H by deleting all sites in S or S, respectively.
HSS = (HSS )T are the submatrices which couple HSS
to HSS and HSS to HSS , respectively. The dimension of
RS (H, Œª) is given by |S|, i.e., the number of sites over which
H is isospectrally reduced. Such a decomposition is shown in
Fig. 5 (a). In Fig. 5 (b), we then show the isospectral reduction
of the graph in Fig. 5 (a) over the sites S = {1, 2}.
A major goal of the isospectral reduction is to reduce the
size of the problem, whilst maintaining (almost) all of its spectral features. It may seem that such a reduction is impossible,
since, by the fundamental theorem of algebra, a hermitian matrix H ‚àà CN √óN has exactly N eigenvalues. A reduced version H0 ‚àà C|S|√ó|S| , |S| < N would, therefore, inevitably

9
have N ‚àí |S| less eigenvalues. However, the above is not necessarily true anymore if the entries of H0 are not just constant
real or complex numbers, but rational functions of a parameter
Œª. This is the case for RS (H, Œª), as can be seen for example
in Fig. 5 (b). This change in the nature of matrix entries also
slightly alters the definition of eigenvalues of the isospectrally
reduced matrix RS (H, Œª) compared to that of matrices with
constant entries. While the eigenvalues Œªi of such a matrix H
fulfill


det H ‚àí IŒªi = 0,
the eigenvalues Œªi of RS (H, Œª) fulfill


det RS (H, Œªi ) ‚àí IŒªi = 0.

(15)

It can then be shown that the set of eigenvalues of RS (H, Œª)
contains all eigenvalues of H, except those which are also
eigenvalues of HSS . Thus, if H and HSS do not share any
eigenvalues, the spectrum œÉ(RS (H, Œª)) is identical with that
of H, i.e., œÉ(RS (H, Œª)) = œÉ(H), as desired.
Similar to the definition of eigenvalues of RS (H, Œª), as
done in Eq. (15), it is also possible to generalize the concept
of eigenvectors to isospectral reductions RS (H, Œª). These
eigenvectors {v1 , . . . , vn } of RS (H, Œª), where n is the number of eigenvalues of RS (H, Œª), fulfill
(RS (H, Œªi ) ‚àí IŒªi )vi = 0.
Contrary to eigenvectors of the symmetric matrix H, the set
{vi } does not need to be pairwise orthogonal, and could even
be linearly dependent or pairwise identical. Their importance
stems from the fact that they can be linked [17, 34] to the
eigenvectors of H. Namely, every eigenvector vi ‚àà R|S|√ó1
of RS (H, Œª) with eigenvalue Œªi is, up to normalization, the
projection of the corresponding eigenvector Vi ‚àà RN √ó1 of
H ‚àà RN √óN onto the sites S, i.e., equal to Vi S ‚àà R|S|√ó1 ,
where HVi = Œªi Vi and |S| denotes the number of elements
in S.
2.

Extracting the polynomials P¬± through isospectral reductions

In order to use the isospectral reduction to extract the polynomials P¬± , let us now investigate the special case of an
isospectral reduction over two sites in more detail. Such a
reduction is shown in Fig. 5 (b) for the setup shown in Fig. 5
(a). Inspecting this isospectral reduction RS (H, Œª) in more
h2 (Œª‚àí3)
detail, we see that the respective ‚Äúon-site potentials‚Äù (Œª‚àí3)Œª‚àí1
02

h (Œª‚àí3)
and (Œª‚àí3)Œª‚àí1
of sites 1 and 2 become equal for all Œª if and
only if h = ¬±h0 . In this case
!
h2 (Œª‚àí3)
(Œª‚àí3)h2
2 ¬± (Œª‚àí3)Œª‚àí1
(Œª‚àí3)Œª‚àí1
RS (H, Œª) =
(16)
(Œª‚àí3)h2
h2 (Œª‚àí3)
2 ¬± (Œª‚àí3)Œª‚àí1
(Œª‚àí3)Œª‚àí1

becomes bisymmetric, i.e., symmetric about both the diagonal and the anti-diagonal. Interestingly, the choice h0 = ¬±h is

also the only one that makes u and v cospectral. This finding
suggests that there might be a connection between the bisymmetry of R{u,v} (H, Œª) and cospectrality of u and v. This is
indeed the case, as was very recently proven in Ref. [19]. For
symmetric matrices H, the isospectral reduction RS (H, Œª)
over two sites {u, v} = S is bisymmetric if and only if u and
v are cospectral in H. Moreover, u and v are strongly cospectral if and only if they are cospectral and all eigenvalues of
RS (H, Œª) are simple. This theorem is remarkable, as it connects the two seemingly unrelated concepts of cospectrality
and isospectral reductions.
To give an intuitive argument for why this theorem makes
sense, we show how cospectrality of u and v follows from
bisymmetry of RS={u,v} (H, Œª) for the simple case when
œÉ(H) = œÉ(RS (H, Œª)). In this case, each eigenvector vi of
RS (H, Œª) is the projection of the corresponding eigenvector
Vi of H on the sites S. Now, as can be easily shown, the
eigenvectors of RS (H, Œª) have (in the case of degeneracies,
can be chosen to have) parity ¬±1 on u and v if and only if
RS (H, Œª) is bisymmetric. Therefore, the eigenvectors {Vi }
of H fulfill Eq. (7), i.e., sites u, v are cospectral due to the
bisymmetry of RS (H, Œª). If, additionally, all eigenvalues
of RS (H, Œª) are simple, the {Vi } also fulfill Eq. (8), i.e.,
(Vi )u = ¬±(Vi )v .
We now use the connection between cospectrality and
bisymmetry of RS={u,v} (H, Œª) to extract P¬± . To this end,
we assume that u and v are strongly cospectral. By theorem
3.8. from Ref. [19], RS (H, Œª) is then bisymmetric, and all
its eigenvalues are simple. Due to its bisymmetry, we can
parametrize

RS (H, Œª) =


A(Œª) B(Œª)
B(Œª) A(Œª)

(17)

with A(Œª), B(Œª) being rational functions of Œª. As we have
explained above, all eigenvectors of RS (H, Œª) are (in the
case of degeneracies, can be chosen to be) of definite parity on u and v. Therefore, the characteristic polynomial
PR (Œª) of RS (H, Œª) can be factored into two parts, PR =
+
‚àí
PR
(Œª) ¬∑ PR
(Œª), such that the roots of the polynomials P¬± (Œª)
are the eigenvalues of eigenvectors of RS (H, Œª) with positive
and negative parity, respectively. As we show in Appendix C,
¬±
PR
= A(Œª) ¬± B(Œª) ‚àí Œª. They obey the relation


det(H ‚àí IŒª)
+
‚àí
PR
(Œª) ¬∑ PR
(Œª) = det RS (H, Œª) ‚àí IŒª =
det(HSS ‚àí IŒª)
where the first equality is proven in Appendix C, and the second on p. 7 in Ref. [15].
There are now two possible scenarios for which the polynomials P¬± (Œª) can be obtained. In the first scenario, H and
HSS must not share any eigenvalues. In that case, all eigen¬±
values of H are given by the union of roots of PR
(Œª), and by
the above assumption of strong cospectrality of u and v, all
these eigenvalues are non-degenerate. Combining these properties, we see that all eigenvectors of H do not vanish on the
sites u and v, and the corresponding amplitudes on these two
sites are of definite parity w.r.t. exchanging u and v. Thus,

10
P0 (Œª) = 1 [from the decomposition of the characteristic polynomial of H, as done in Eq. (13)], and we get

det(H ‚àí IŒª) =

P (Œª) = P+ (Œª) ¬∑ P‚àí (Œª)

p+ (Œª) p‚àí (Œª)
det(H ‚àí IŒª)
¬∑
=
(18)
q+ (Œª) q‚àí (Œª)
det(HSS ‚àí IŒª)

where p¬± (Œª), q¬± (Œª) and both determinants are polynomials
in Œª. Since

det(HSS

(19)
(20)

with c¬± (Œª) functions of Œª, the p¬± (Œª) are not uniquely determined by Eq. (18) alone. To uniquely determine P¬± (Œª), one
needs to properly reduce the fractions p¬± (Œª)/q¬± (Œª) [i.e., performing the transformations of Eqs. (19) and (20) with suitable c¬± (Œª)] such that the following conditions are fulfilled.
(¬±)
Firstly, the leading-order coefficients an¬± of the polynomials
p+ (Œª) =

i

where Œª00i are the eigenvalues of HSS which are not simultaneously eigenvalues of H. As a result of Eqs. (13), (21)
and (22),
Y
(Œªi ‚àí Œª) = P+ (Œª) ¬∑ P‚àí (Œª)
i

it would be ideal if the numerators in Eq. (18) match, so that
p¬± (Œª) = P¬± (Œª). However, since Eq. (18) remains invariant
under the transformation

n+
X

i

Y
 Y

‚àí IŒª) =
(Œª0i ‚àí Œª) ¬∑
(Œª00i ‚àí Œª)
i

det(H ‚àí IŒª) = P (Œª) = P+ (Œª) ¬∑ P‚àí (Œª)

p¬± (Œª) ‚Üí c¬± (Œª) ¬∑ p¬± (Œª)
q¬± (Œª) ‚Üí c¬± (Œª) ¬∑ q¬± (Œª)

Y
 Y

(Œªi ‚àí Œª) ¬∑
(Œª0i ‚àí Œª) , (22)
i

where P (Œª) = det(H ‚àí IŒª) is the characteristic polynomial
¬±
of H. The PR
‚â° p¬± /q¬± are rational functions in Œª, so that
+
‚àí
PR
(Œª) ¬∑ PR
(Œª) =

and we can factorize

n
a(+)
n Œª

and similarly to Eq. (18), we obtain
+
‚àí
PR
(Œª) ¬∑ PR
(Œª) =

Q
(Œªi ‚àí Œª)
p+ (Œª) p‚àí (Œª)
¬∑
= Q i 00
.
q+ (Œª) q‚àí (Œª)
(Œª
i i ‚àí Œª)

If the fractions p¬± (Œª)/q¬± (Œª) are properly reduced as above,
we again have that
P¬± (Œª) = p¬± (Œª).
The isospectral reduction can thus be used to extract the
polynomials P¬± provided that (i) H and HSS do not share
a common root, or (ii) all common roots of H and HSS are
related to eigenvectors of H which vanish on S. In the next
section, we show how this knowledge can be harnessed to design Hamiltonians featuring PGST.

n=0
n‚àí

p‚àí (Œª) =

X

n
a(‚àí)
n Œª

n=0

where n¬± are the respective degrees of p¬± (Œª), must be chosen
such that
a(+)
n+ = 1
N
a(‚àí)
n‚àí = (‚àí1)

where N is the dimension of H ‚àà RN √óN . This ensures
that the product of p+ (Œª) ¬∑ p‚àí (Œª) has a leading order coefficient of (‚àí1)N , which matches the leading order coefficient
of det(H ‚àí IŒª). Secondly, the fractions p¬± (Œª)/q¬± (Œª) must
be irreducible. The latter property means that p+ (Œª), q+ (Œª)
[and also p‚àí (Œª), q‚àí (Œª)] are coprime, i.e., their only common
factor is unity. If the above two conditions are fulfilled, we
obtain
P¬± (Œª) = p¬± (Œª)
as desired.
The second scenario where P¬± (Œª) can be obtained is when
all eigenvectors x0 i of H which are related to common eigenvalues Œª0i of both H and HSS vanish on S. The polynomial
P0 (Œª) from Eq. (13) then becomes
Y
P0 (Œª) =
(Œª0i ‚àí Œª)
(21)
i

III.

APPLICATION: DESIGNING GRAPHS WITH
PRETTY GOOD STATE TRANSFER

In the previous Section II, we have introduced the concept
of cospectrality and have shown how, based on the isospectral
reduction, the polynomials P¬± can be extracted. With this theoretical background, one can derive the following algorithm
for the design of graphs with PGST.
1. Achieving cospectrality
Design/take a graph H(Œæ) with cospectral vertices u
and v, e.g., by means of the procedure demonstrated
in Section II D. Here, Œæ denotes the parameter space
of couplings and on-site potentials occurring in H for
which u and v are cospectral and for which there exists at least one possible walk from u to v. For example, for the graph depicted in Fig. 3 (b), we have
Œæ = {(a, b, c, d, Ered , Eblue ) ‚àà R : b 6= 0 or ac 6= 0},
where Ered , Eblue denote the on-site potentials of the red
and blue sites, respectively.
2. Achieving strong cospectrality
Due to cospectrality of u and v for all H(Œæ), the
isospectral reduction


A(Œæ, Œª) B(Œæ, Œª)
RS={u,v} (H(Œæ), Œª) =
B(Œæ, Œª) A(Œæ, Œª)

11
of H(Œæ) over S = {u, v} [with rational functions
A(Œæ, Œª), B(Œæ, Œª)] is, by Theorem 3.3. from Ref. [19],
guaranteed to be bisymmetric. Compute
¬±
PR
(Œæ, Œª) = A(Œæ, Œª) ¬± B(Œæ, Œª) ‚àí Œª ‚â°

p¬± (Œæ, Œª)
,
q¬± (Œæ, Œª)

and, by suitable algorithms [see the next Section III A],
¬± 0
find a subspace Œæ 0 ‚äÜ Œæ for which PR
(Œæ , Œª) individually
have only simple roots, and additionally have no common roots. By Theorem 3.8 from Ref. [19], u and v are
then strongly cospectral.

Figure 6. A simple system which can be tuned to feature PGST between sites u = 1 and v = 6, as demonstrated in Section III B.

3. Extraction of P¬±
By suitable algorithms [see the next Section III A], either

Let us now make two comments regarding the above algorithm. Firstly, the steps 2. to 4. require the search for suitable subspaces, which in general must be performed by means
of suitable trial-and-error algorithms. However, the subspace
Œæ 0 ‚äÜ Œæ [the search for which is the subject of steps 2. and 3. of
the algorithm] can in some cases be given by explicit expressions, as we demonstrate in the next Section III B. Secondly,
not all setups may support PGST, and the above algorithm is
therefore not guaranteed to work in all cases. However, we
have successfully tested the algorithm with a variety of setups, and among others, all six graphs depicted in Fig. 3 were
successfully tuned to support PGST between the two red sites.
Overall, we stress that the main advantage of our algorithm,
compared to existing methods for the design of PGST, is the
ability to derive explicit forms for the polynomials P¬± . We
hope that the insights gained on how to extract the polynomials P¬± will lead to a better understanding on the classes of
setups which support PGST. This understanding is facilitated
by the fact that the core method of our approach, the isospectral reduction RS={u,v} (H(Œæ), Œª), can be performed symbolically. As we will see in the next section, in some cases, nearly
all steps of the algorithm can be done without numerical evaluations at all.

‚Ä¢ further restrict Œæ 0 such that H(Œæ 0 ) and HSS (Œæ 0 ) do
not share any eigenvalues,
‚Ä¢ or, alternatively, restrict Œæ 0 such that all eigenvalues Œª0i shared by H(Œæ 0 ) and HSS (Œæ 0 ) are related
to eigenvectors of H(Œæ 0 ) which vanish on S.
In both cases, properly reduce (or expand) the fractions
¬± 0
occurring in PR
(Œæ , Œª) such that
‚Ä¢ the leading order coefficients of p¬± (Œæ 0 , Œª) [which
are polynomials in Œª] are +1 and (‚àí1)N , respectively, where N is the dimension of H ‚àà RN √óN ,
‚Ä¢ p¬± (Œæ 0 , Œª)/q¬± (Œæ 0 , Œª) are irreducible.
As a result P¬± (Œæ 0 , Œª) = p¬± (Œæ 0 , Œª).
4. Enforcing pretty good state transfer
Within the subspace Œæ 0 , search [see the next Section III A] for realizations Œæ 00 ‚äÜ Œæ 0 such that

A.

(a) P¬± (Œæ 00 , Œª) are irreducible over the base field F
which contains all entries of H(Œæ 00 ).
(b)

T r(P+ (Œæ 00 ,Œª))
deg(P+ (Œæ 00 ,Œª))

6=

T r(P‚àí (Œæ 00 ,Œª))
deg(P‚àí (Œæ 00 ,Œª)) .

H(Œæ 00 ) then features PGST from u to v. We note
that T r(P¬± (Œæ 00 , Œª)) can be computed without finding
the roots of these polynomials, since
PnT r(f (x)) =
‚àían‚àí1 /an for a polynomial f (x) = i=0 ai xi of degree n.
5. Repetition (if necessary)
Since not every graph may support PGST, the above
procedure is not guaranteed to work in all cases [see the
next Section III A for details]. Thus, if step 4. is not successful, i.e., no parameters Œæ 00 exist such that P¬± (Œæ 00 , Œª)
fulfill 4. (a) and (b), go back to step 3. and try its alternative route. If this, again, is not successful, go back to
step 1., modify the graph by adding/removing vertices
and start anew.

B.

Annotations

Example

We now apply the algorithm presented above to a simple
example, and will go separately through each of the steps 1.
to 4.

1.

Achieving cospectrality

We start the algorithm with the graph shown in Fig. 6,
which represents a very simple graph featuring cospectral vertices u and v. The graph is described by
Er
Ô£¨ a
Ô£¨
Ô£¨ b
H(Œæ) = Ô£¨
Ô£¨ 0
Ô£≠ 0
h
Ô£´

a
Eb
0
0
0
0

b
0
Eb
0
0
0

0
0
0
Eb
0
c

0
0
0
0
Eb
d

h
0
0
c
d
Er

Ô£∂
Ô£∑
Ô£∑
Ô£∑
Ô£∑
Ô£∑
Ô£∏

(23)

12
where d =

‚àö

a2 + b2 ‚àí c2 ,

Œæ = {(a, b, c, h, Er , Eb ) ‚àà R : d > 0 and(a, b, c, h) 6= 0},
and Eb , Er denote the on-site potentials of the blue and red
sites, respectively. The sites u = 1 and v = 6 are then guaranteed to be cospectral
‚àö for the Hamiltonian H(Œæ).
The form of d = a2 + b2 ‚àí c2 is chosen such as to ensure cospectrality of u and v within a large parameter space.
For example, for a = b = c, H would be invariant under
the exchange 3 ‚Üî 4, 2 ‚Üî 5, 1 ‚Üî 6, so that u = 1 and
v = 6‚àöwould trivially be cospectral. However, our choice of
d = a2 + b2 ‚àí c2 > 0 ensures this cospectrality even for
asymmetric cases such as a = 2b = 4c, where H is not invariant under any non-trivial permutation of sites.
2.

Achieving strong cospectrality

The isospectral reduction of H(Œæ) over S = {u, v} then
gives
 Œ¥

+ Er
h
RS={u,v} (H(Œæ), Œª) = Œª‚àíEb
Œ¥
h
Œª‚àíEb + Er
where Œ¥ = a2 + b2 , so that
Œ¥
+ h ‚àí Œª + Er ,
Œª ‚àí Eb
Œ¥
‚àí
PR
(Œæ, Œª) =
‚àí h ‚àí Œª + Er .
Œª ‚àí Eb
+
PR
(Œæ, Œª) =

R(p+(Œæ, Œª), p‚àí (Œæ, Œª)) = 4h2 Œ¥ > 0.
Thus, p+ (Œæ, Œª) and p‚àí (Œæ, Œª) will not share any roots. We then
need to check when p+ (Œæ, Œª) and p‚àí (Œæ, Œª) individually have
multiple roots. To this end, we compute
 their so-called discrimant [36]. The discrimant D f (x) of a polynomial f (x)
is zero if and only if f (x) has at least one multiple root. Like
the resultant, the discriminant can be computed analytically
and is implemented in many computer algebra systems. We
then get

D p¬± (Œæ, Œª) = (Eb ‚àí Er ) (Eb ‚àì 2h ‚àí Er ) + h2 + 4Œ¥.

D p¬± (Œæ, Œª) can only vanish if Œ¥ = ‚àí 14 (h ‚àì vv ¬± vr ) 2 < 0,
which is again forbidden by our assumptions that a, b ‚àà R and
a, b 6= 0.
Let us now recapitulate the above. We have investigated
under which conditions all roots of RS={u,v} (H(Œæ), Œª) are
simple. The motivation for this study is the fact that, whenever this is the case, the sites u and v are not only cospectral, but also strongly cospectral. For the Hamiltonian given
by Eq. (23), we have found that both of the above conditions
are fulfilled for all elements in the parameter space Œæ, so that
Œæ 0 = Œæ, and u, v are always strongly cospectral in this Hamiltonian H(Œæ). We can thus move on to the third step of our
algorithm.
3.

Following the procedure of the algorithm, we now have
to investigate (i) under which circumstances all roots of
¬±
+
PR
(Œæ, Œª) are simple and (ii) under which conditions PR
(Œæ, Œª)
‚àí
and PR (Œæ, Œª) do not share any roots. Since
‚àíEb (h ‚àí Œª + Er ) + Œª(h ‚àí Œª) + Œ¥ + ŒªEr
,
Œª ‚àí Eb
(24)
Eb (h + Œª ‚àí Er ) ‚àí Œª(h + Œª) + Œ¥ + ŒªEr
‚àí
(25)
PR
(Œæ, Œª) =
Œª ‚àí Eb
+
PR
(Œæ, Œª) =

are rational functions in Œª, we define the corresponding numerators and denominators as p¬± (Œæ, Œª) and q¬± (Œæ, Œª). Since
the p+ (Œæ, Œª), q+ (Œæ, Œª) and p‚àí (Œæ, Œª), q‚àí (Œæ, Œª) could in principle share roots, we need to evaluate when this can happen.
To this end, we can use the so-called resultant [35]. Two
given polynomials f (x) and g(x) share at least one root if and
only if their resultant R(f, g) is zero. The resultant, defined
in terms of the so-called Sylvester-Matrix, can be computed
symbolically and is implemented in common computer algebra systems. For the problem at hand, we yield
R(p+ (Œæ, Œª), q+ (Œæ, Œª)) = R(p‚àí (Œæ, Œª), q‚àí (Œæ, Œª)) = Œ¥

To check whether p+ (Œæ, Œª) and p‚àí (Œæ, Œª) share any roots,
we again rely on the resultant, which gives

(26)

which can obviously never vanish, since Œ¥ = a2 + b2 and we
demanded that a, b ‚àà R and a, b 6= 0. Thus, we can evalu¬±
ate the roots of PR
(Œæ, Œª) by evaluating only their numerators
p¬± (Œæ, Œª).

Extraction of P¬±

Following the procedure of the algorithm, we now have to
investigate under which circumstances H(Œæ 0 ) and HSS (Œæ 0 )
share eigenvalues. We therefore compute their resultant

R det(H(Œæ 0 ) ‚àí IŒª), det(HSS (Œæ 0 ) ‚àí IŒª) = 0.
(27)
Thus, H(Œæ 0 ) and HSS (Œæ 0 ) always share at least one eigenvalue. Indeed, closer evaluation shows that, irrespective of
how Œæ 0 is chosen, H(Œæ 0 ) and HSS (Œæ 0 ) share a twofold degenerate eigenvalue Œª = Eb , with corresponding
‚àö (unnormalized) eigenvectors x1 ‚àö
= (0, 1, ‚àíb/a, 0, 0, 0)T / 4 and x2 =
(0, 0, 0, 1, ‚àíc/d, 0)T / 4. Both eigenvectors have zero amplitude on the sites S = {1, 6}, and by the reasoning in Section II E 2, the corresponding doubly degenerate eigenvalue
Eb of H(Œæ 0 ) is not of relevance to us. To see whether there
are any other common eigenvalues of H(Œæ 0 ) and HSS (Œæ 0 ), we
investigate the resultant
 det(H(Œæ 0 ) ‚àí IŒª) det(H (Œæ 0 ) ‚àí IŒª) 
SS
R
,
= Œ¥ 4 . (28)
(Œª ‚àí Eb )2
(Œª ‚àí Eb )2
Since Œ¥ = a2 + b2 > 0, H(Œæ 0 ), HSS (Œæ 0 ) do not share any
other roots.
To extract P¬± (Œæ 0 , Œª), we test whether p¬± (Œæ 0 , Œª), given by
the respective numerators of Eqs. (24) and (25), have leading order coefficients +1 and that p¬± (Œæ 0 , Œª)/q¬± (Œæ 0 , Œª) are irreducible fractions. The latter is indeed the case, but the leading order coefficients are ‚àí1. Thus, we have P¬± (Œæ 0 , Œª) =

13
+

CLS 2

1

2

-

+

+
-

1

1

3
1

4

+

-

+

-

+

+

+

-

+

-

+

+

+

+

-

Figure 7. The graph shown in (a) features a compact localizes state
(CLS) on the upper two sites. (b ‚Äì c) show how a setup featuring PGST of single site excitations |ui and |vi (and without direct
coupling between u and v) can be equipped with compact localized
states by dimerizing sites u and v. The setup in (b) is described by
H, while the setup in (c) is described by Hm (see text for details). For
each dimer u1,2 and v1,2 , this setup then features one CLS. (d ‚Äì f)
visualize the proposed method of transferring the CLS by performing
two quenches at t = 0 and t = Tf (see text for details), so that the
three setups are described by Hm , H0m and again Hm , respectively.

‚àíp¬± (Œæ 0 , Œª), and explicitly
P+ (Œæ 0 , Œª) = Eb (h ‚àí Œª + Er ) ‚àí Œª(h ‚àí Œª) ‚àí Œ¥ ‚àí ŒªEr ,
P‚àí (Œæ 0 , Œª) = ‚àíEb (h + Œª ‚àí Er ) + Œª(h + Œª) ‚àí Œ¥ ‚àí ŒªEr .

4.

+

-

+

+

+

Enforcing pretty good state transfer

Inserting P¬± (Œæ 0 , Œª) into Eq. (12) and simplifying the resulting inequality yields
2
2
6=
Eb ‚àí h + Er
Eb + h + Er

(29)

which is obviously fulfilled whenever h 6= 0. The only
task left is to search for realizations Œæ 00 ‚àà Œæ which render
both P¬± (Œæ 00 , Œª) to be irreducible over the base field F which
contains all entries of H(Œæ 00 ). If we choose (Œæ 00 ) such that
H(Œæ 00 ) ‚àà Q6√ó6 , we have F = Q, and one realization leading
to PGST is
a = 1, b = 2, c = 1/4, h = 1, Eb = Er = 0.

Figure 8. (a) Original setup featuring PGST from u to v, described
by H. (b) Modified setup described by Hm , featuring two CLS
|v1 i‚àí|v2 i
i
‚àö 2 and |v‚àí i =
‚àö
, which can be pretty
|u‚àí i = |u1 i‚àí|u
2
2
well transferred into each other by performing instantaneous coupling flips (not shown). (c ‚Äì d) demonstrates the transfer from |u‚àí i
to |v‚àí i by linear ramps of g 0 (t) with ramping time Œ¥t [shown in (f)
for Œ¥t = tOpt /5]. The fidelity of this process is shown in (e).

IV.

STORAGE AND PRETTY GOOD TRANSFER OF
COMPACT LOCALIZED STATES

So far, we investigated the transfer of single-site excitations, and showed how networks supporting pretty good transfer of these states can be designed. In the following, we will
demonstrate how such networks can be modified to allow for
robust storage of qubits. The need for such modifications
arises since, although relatively easy to transfer, single site excitations are difficult to store. To achieve storage, the underlying sites would need to be completely decoupled from the
remainder of the Hamiltonian right after state transfer, which
is usually not achievable. As a consequence, the single site
excitation would tunnel to adjacent (weakly) coupled sites,
drastically degrading the storage performance. Recently, a solution to this problem has been proposed in Ref. [37]. There,
qubits were not encoded into excitations of single sites, but
into excitations of dimers, which are schematically shown in
Fig. 7 (a), where the dimer consisting of the upper two sites
1 and 2 is excited. Storage in these dimers does not rely on
decoupling, but rather on destructive interference. To achieve
such interference, the couplings of the two constituents of the
dimer to the remainder of the system are chosen symmetrical,
and the dimer-sites are excited with a phase difference of œÄ.

14
This completely suppresses any tunneling of this dimer state
to its environment. It can be easily proven that such dimer
states are eigenstates of the underlying Hamiltonian, and due
to their strictly limited spatial extent, they are known as compact localized states (CLS). In Fig. 7 (a), for example, the
‚àö
, and one can easily show
CLS is given by |Œ®CLS i = |1i‚àí|2i
2
that it is an eigenstate of H with eigenvalue Œª = ‚àí2. Importantly, this is also an eigenvalue of the isolated Hamiltonian
of the subsystem


0 2
HSS =
2 0

(b)] which supports PGST from u to v, with time-dependent
fidelity

where S = {1, 2}. The fact that the eigenvalues of CLSs
depend only on the subsystem on which they are localized is
indeed a general property, and this is just one of the many
intriguing features of these states. Not only do CLSs feature
localization without disorder, as is the case for the well-known
Anderson localization [38], but they are also strongly connected to the appearance of flat bands. These are, in turn,
conjectured to play a role in the superconduction of cuprates
[27, 39‚Äì45]. We refer the reader interested in the exciting field
of CLSs and flat bands to the review [27].
What makes compact localized states important in the context of this work is their unique combination of favorable
properties. The fact that they are eigenstates allows for their
perfect, i.e., unity fidelity, storage in idealized model systems,
where imperfections can be ignored. If, on the other hand,
such model systems are realized and imperfections are introduced, CLSs profit from the fact that they are localized only
on a subdomain of the full system. This means that they are
immune to any imperfections of the underlying Hamiltonian
outside of this domain and its directly neighboring sites. Morever, the fact that they are localized by means of destructive interference means that they are even immune to certain perturbations inside or directly next to their domain of localization.
For example, the coupling H1,2 in Fig. 7 (a) could be varying
in time, but would only give an overall time-varying phase on
|Œ®CLS i, which would still remain a compactly localized eigenstate of H(t). Moreover, the couplings H1,3 and H2,3 could
be chosen arbitrarily big and also time-dependent, but |Œ®CLS i
would be completely unaffected as long as H1,3 (t) = H2,3 (t)
for all t.
The combination of all these properties clearly renders
compact localized states ideal candidates for the storage of
qubits. However, the fact that they are eigenstates of H complicates their transfer, which is naturally impossible by simple
time-evolution if H is time-independent. In Ref. [37], a set
of minimal changes to the setup have been demonstrated that
allow for both perfect storage and perfect, i.e., unity fidelity,
transfer of CLSs in specialized networks. In this section, we
use the underlying idea and show how a network capable of
PGST of single-site excitations of sites u and v can be modified by a set of minimal changes such that (i) the network supports compact localized states and (ii) it is possible to perform
pretty good transfer of these states. The only condition on
the underlying network is that there are no direct links (edges)
between u and v. The basic idea is sketched in Fig. 7 (b ‚Äì f).
We start from a Hamiltonian H [as the one depicted in Fig. 7

for the transfer of symmetric excitations |u+ i =

F (t) = | hu|exp(iHt)|vi |2 .

(30)

We then modify H such that u and v are replaced by dimers
u1,2 and v1,2 , and all couplings of u, v to their environment are
replaced by symmetrized and renormalized couplings with the
dimer, as shown in Fig. 7 (c).
The fidelity
F 0 (t) = | hu+ |exp(iHm t)|v+ i |2

(31)
|u1 i+|u2 i
‚àö
2

to

|v1 i+|v2 i
‚àö
2

|v+ i =
by means of the modified Hamiltonian Hm
can then be shown [see Appendix D for details] to be identical
to F (t). In particular, while H supports PGST of single site
excitations u and v, its modified version Hm supports PGST
of symmetric dimer excitations |u+ i and |v+ i.
On the other hand, Hm supports also two compact local|v i‚àí|v i
i
‚àö 2 , and |v‚àí i = 1 ‚àö 2 . They are
ized states, |u‚àí i = |u1 i‚àí|u
2
2
eigenstates of Hm and can thus not be transferred by simple
time evolution. However, by suitable time-dependent modifications, |u‚àí i can be pretty well transferred to |v‚àí i, as we
show in the following. The procedure is visualized in Fig. 7 (d
‚Äì f). The main idea is to achieve such a transfer by performing
two quenches
t=0

t=Tf

Hm ‚Üí H0m ‚Üí Hm
at t = 0 and t = Tf . The Hamiltonian H0m is constructed
from Hm by instantaneously switching all couplings Ji =
hi,u1 = hi,v1 of u1 , v1 (but not of u2 , v2 ) to their environment
as Ji ‚Üí ‚àíhi . Due to this change, the CLS |u‚àí i is no longer
an eigenstate of H0m , and thus spreads across the lattice. The
transfer fidelity during this spreading is given by
F 00 (t) = | hu‚àí |exp(iH0m t)|v‚àí i |2 = F 0 (t) = F (t).

(32)

Once F 00 (t) achieves a sufficiently high value F 00 (Tf ) = 1‚àí
for given , the second quench is performed, and the previously modified couplings are instantaneously switched back
to their original value. At Tf , the state of the system is then
given by
X
‚àö
|Œ®(Tf )i = eiœÜ 1 ‚àí  |v‚àí i +
cŒΩ |œà ŒΩ i

(33)

ŒΩ

where œÜ is a phase and the coefficients cŒΩ must fulfill
| hŒ®(Tf )|Œ®(Tf )i | = 1. The states |v‚àí i and |œàŒΩ i =
6 |v‚àí i
are eigenstates of the pre/post quench Hamiltonian Hm . Since
H(t) = Hm for t ‚â• Tf , we have
| hv‚àí |Œ®(t ‚â• Tf )i |2 = F 00 (Tf ) = constant.

(34)

The CLS |u‚àí i is thus stored with the time-independent fidelity F 00 (tf ) and, due to its properties, enjoys protection
against a large number of imperfections of Hm .

15
In practice, instantaneous coupling flips are rather unrealistic, and may be replaced by more realistic switching
pulses. These will naturally change the transfer fidelity, and
the strength of this change clearly depends both on the individual system and the realization of the flipping pulse. In
Ref. [37], the impact of linear ramps (instead of instantaneous coupling flips) on linear chains that support perfect
transfer of compact localized states has been investigated.
As has been shown there for the case of chains of length
N = 5, even extraordinary slow ramping times of nearly
half of the total transfer time only leads to a decrease of
the transfer fidelity from unity to 0.97. This being said, we
now exemplarily investigate the impact of finite duration linear ramps of couplings on the transfer fidelity of the simple example setup shown in Fig. 8 (a). The two green sites
u and v are cospectral for any choice of the 11 parameters
Œæ = {a, b, c, d, e, Ered , Eblue , Egreen , Eyellow } ‚àà R. Before
investigating the impact of finite-time ramps on the transfer
of compact localized states, we first find the subspace Œæ 00 ‚äÜ Œæ
in which the setup supports PGST of single site excitations.
Within this subspace, we then look for realizations Œæ 000 ‚äÜ Œæ 00
for which the maximum transfer fidelity
Fmax (Tf ) = max(F (t ‚â§ Tf ))
from site u to v within a given time Tf and boundaries on
the absolute values of parameters Œæ 00 is as large as possible.
In other words, we optimize the system to (i) support PGST
from u to v and (ii) reach an acceptable transfer fidelity in
as little time as possible. In practical applications, such an
optimization is always necessary. Since PGST by definition
is an asymptotic property, the underlying network may reach
a suitably high transfer fidelity only after prohibitively long
transfer times. For the setup shown in Fig. 8 (a), we restricted
the optimization to the subspace where all on-site potentials
vanish, and obtained a maximum transfer fidelity
F (Topt = 10.8345) = 0.996
for a = 0.7975, b = 0.8103, c = 0.8880, d = 2.3473, e =
2.3005, f = 0.3061, g = 0.5489.
In order to investigate the transfer of compact localized
states, we first apply the above set of modifications to Fig. 8
(a) and equip it with two compact localized states. The modified setup is shown in Fig. 8 (b) and supports the two CLS
i
|v1 i‚àí|v2 i
‚àö 2 and |v‚àí i =
‚àö
|u‚àí i = |u1 i‚àí|u
. By performing in2
2
stantaneous coupling flips at t = 0 and Topt , we can transfer
|u‚àí i to |v‚àí i (and vice versa) with the fidelity F (Topt ). We
now slightly change the protocol and switch the couplings
by performing linear ramps with a duration Œ¥t. The ramps
are started at t = 0 and t = Topt , so that the transfer process is finished at t = Topt + Œ¥t. The process is sketched in
Fig. 8 (c) and (d). Figure 8 (c) shows the setup at t = 0,
where the state of the system is given by |Œ®(t = 0)i = |u‚àí i
(white circles denoting sites with zero amplitude). The transfer process is then started by linearly
ramping down g 0 (t)
‚àö
0
such that g (t = Œ¥t) = ‚àíg/ 2. At t = Topt , these
are then linearly ramped
‚àö up again, reaching their final value
g 0 (Topt + Œ¥t) = g/ 2. The pulse g 0 (t) is shown in Fig. 8

(f) for Œ¥t = Topt /10. Figure 8 (d) shows the final situation,
where white sites now denote very low (but not necessarily
zero) amplitudes of the final state |Œ®(Topt + Œ¥t)i. In Fig. 8
(e), the transfer fidelity is plotted against the pulse duration Œ¥t.
Quite counter-intuitively, the fidelity of transferring compact
localized states increases first for increasing Œ¥t. Investigating
the cause for this behavior would certainly be a worthwhile
topic for further research. For larger Œ¥t, the fidelity falls off
as expected, but overall remains quite high. Even for comparatively slow ramps of Œ¥t = Topt /10, the transfer fidelity decreases only by roughly 10‚àí4 . Notably, this high robustness
against slow control pulses was also observed in Ref. [37]
for the case of linear chains equipped with compact localized
states.

V.

BRIEF CONCLUSION

We presented a method to design Hamiltonians H featuring
pretty good state transfer (PGST) between two sites. A necessary condition for PGST is that these two sites are so-called
strongly cospectral, which means that all eigenstates have parity ¬±1 on these two sites. We showed how Hamiltonians featuring strongly cospectral sites can be designed. We then relied on so-called isospectral reductions of these Hamiltonians
to yield a factoring of their characteristic polynomial in terms
of smaller polynomials P¬± , which are related to eigenvectors
with parity ¬±1 on u and v. The motivation for this factorization is the fact that PGST automatically arises in setups where
the coefficients of P¬± fulfill a set of relations, as has recently
been shown by Eisenberg et al. [11]. Equipped with explicit
knowledge of P¬± , we show how they can be properly manipulated by changing couplings and on-site potentials whilst
maintaining the strong cospectrality. Through these manipulations, PGST can therefore be achieved in certain setups,
and we develop our method into an algorithm to design PGST
Hamiltonians. We further show how Hamiltonians featuring
PGST can be equipped with so-called compact localized states
(CLS). Such states are eigenstates of H and are strictly localized on a spatially finite (and usually very small) domain,
which allows for robust storage of qubits encoded into such
CLSs. We further present time-dependent protocols which allow for PGST of CLSs. Our work opens new routes towards
flexible design of PGST networks and broadens their scope to
allow for robust storage as well. An important future task is
to investigate how well the transfer fidelity of PGST Hamiltonians within a given maximal transfer time Tmax can be optimized by parameter tuning. This task should be supported
by the algorithm presented in this work, as it allows to obtain
rather small parameter spaces Œæ in which a given parameter
dependent Hamiltonian H(Œæ) features PGST.

VI.

ACKNOWLEDGMENTS

M.R. gratefully acknowledges financial support by the
‚ÄòStiftung der deutschen Wirtschaft‚Äô in the framework of a
scholarship. N.E.P. gratefully acknowledges financial support

16
network keep this cospectrality. To this end, we proof the following
Theorem 1. Let

Hi =

Figure 9. Visualization of the decomposition of H into subsystems.

from the Hellenic Foundation for Research and Innovation
(HFRI) and the General Secretariat for Research and Technology (GSRT) under the HFRI PhD Fellowship Grant No. 868.
I.B. acknowledges financial support by Greece and the European Union (European Social Fund ‚Äì ESF) through the Operational Programme ‚ÄúHuman Resources Development, Education and Lifelong Learning‚Äù in the context of the project ‚ÄúReinforcement of Postdoctoral Researchers‚Äù (MIS-5001552),
implemented by the State Scholarships Foundation (IKY).
M.P. gratefully acknowledges financial support by the ‚ÄòStudienstiftung des deutschen Volkes‚Äô in the framework of a scholarship.

Appendix A: Proof for the interpretation of matrix entries of
powers of Hk in terms of walks

We now prove Eq. (6) which states that
X  (k) 
(Hk>0 )a,b =
w pa,b

(A1)



(k)
where w pa,b denotes the weight of one possible walk of
length k between vertices a and b, and the sum is over all such
walks. To this end, we write (Hk>0 )a,b as
X


‚ààR

Ha,l1 Hl1 ,l2 . . . Hlk‚àí2 ,lk‚àí1 Hlk‚àí1 ,b

l1 ,...,lk‚àí1

(A2)
where each index li goes from 1 to N with H ‚àà RN √óN . We
now interpret every term Hi,j occurring in Eq. (A2) as the
weight of the edge connecting sites i and j. Each summand
is, therefore, the weight of a walk of length k from site a to b
via the sites l1 , l2 , . . . , lk‚àí1 , where walks over physically nonexisting edges (i.e., those with vanishing weights Hi,j = 0)
naturally have vanishing weights as well. As a consequence,
we can write Eq. (A2) as Eq. (A1), and the value of the matrix
element (Hk )a,b is equal to the sum of weights of all walks of
length k between vertices a and b.

Appendix B: Proofs for cospectrality

We now prove the validity of the design mechanism presented in Section II D. In particular, we will prove that all
changes shown in Fig. 4 applied onto an already cospectral

(B1)

be symmetric matrices with i = 1, 2 and


E h
HSS =
h E
bisymmetric. Denote the two sites in HSS as S = {u, v}. If
u, v are cospectral in Hi , then they are also cospectral in
Ô£´
Ô£∂
HSS HSS1 HSS2
0 Ô£∏.
H0 = Ô£≠HS1 S HS1 S1
HS2 S
0
HS2 S2
Proof. We use the fact [19] that the isospectral reduction
RS={u,v} (H, Œª) is, for symmetric H, bisymmetric if and only
if the sites u and v are cospectral. Individually, we therefore
have that
‚àí1
RS (Hi , Œª) = HSS ‚àí HSSi HSi Si ‚àí ŒªI
HSi S
is bisymmetric. We then evaluate the isospectral reduction of
H0 , which can be written as
RS (H0 , Œª) = HSS ‚àí AB‚àí1 AT

p

(Hk>0 )a,b =

HSS HSSi
HSi S HSi Si

(B2)

where


HS1 S1 ‚àí ŒªI
0
A = (HSS1 , HSS2 ), B =
.
0
HS2 S2 ‚àí ŒªI
Equation (B2) then becomes
X
‚àí1
HSi S .
RS (H0 , Œª) = HSS ‚àí
HSSi HSi Si ‚àí ŒªI
i

This expression is bisymmetric, since HSS as well as each
of the two summands are individually bisymmetric, and sums
of bisymmetric matrices are bisymmetric again. Due to the
connection between bisymmetry of RS={u,v} (H, Œª) and the
cospectrality of sites u and v, we have therefore proven the
above theorem.
To apply this theorem to Section II D, we divide the setups
shown their into three parts, as shown in Fig. 9 for a slightly
modified version of the graph depicted in Fig. 4 (b2). Given
the cospectrality of the two red sites, denoted by u and v, in
the original system H1 , the setup is modified by adding the
subsystem containing the sites S2 . By the above theorem, we
know that the cospectrality of u and v is kept also in the composite system H0 provided that RS (H2 , Œª) is bisymmetric.
By explicitly computing the isospectral reductions for each
graph presented in Fig. 4, it can be proven that all of them
are cospectral. We have thus proven the validity of the design
mechanism proposed in Section II D.

17
¬±
Appendix C: Proof for the form of PR

We want to prove that, for bisymmetric


A(Œª) B(Œª)
RS (H, Œª) =
B(Œª) A(Œª)

As stated in Section IV, we demand H to have no direct coupling between u and v, so that


E 0
HSS =
‚àà R2√ó2
0 E
(C1)

¬±
PR
(Œª)

the characteristic polynomials
related to eigenvectors
of positive and negative parity, respectively, are given by
¬±
PR
(Œª) = A(Œª) ¬± B(Œª) ‚àí Œª.
To prove this, we perform a similarity transform
R0S (H, Œª) = A‚àí1 RS (H, Œª)A, with

A=

1 1
1 ‚àí1



is diagonal. We denote the eigenvectors of H as
Ô£´ ŒΩÔ£∂
w
|œÜŒΩ i = Ô£≠ xŒΩu Ô£∏ , ‚àà R(N +2)√ó1
xŒΩv
with wŒΩ ‚àà RN √ó1 . The fidelity for transfer from |ui to |vi is
given as
2

| hu|e

so that

iHt

2

|vi | =

X

xŒΩu (xŒΩv )‚àó eiŒªŒΩ t

.

ŒΩ

R0S (H, Œª) =




A(Œª) + B(Œª)
0
0
A(Œª) ‚àí B(Œª)

becomes block-diagonal. Therefore, its eigenvectors are obviously (1, 0)T [those of the first block] with eigenvalues
{Œª1i } and (0, 1)T [those of the second block] with eigenvalues {Œª2j }. Multiplying these eigenvectors by A then yields the
corresponding eigenvectors of RS (M, Œª). Therefore, these
are obviously (1, 1)T with eigenvalues {Œª1i } and (1, ‚àí1)T
with eigenvalues {Œª2j }. We remind the reader that, since
RS (M, Œª) depends on Œª, it can have more then two eigenvectors, and these need not be linearly independent. The eigenvalues {Œª1i }, {Œª2j } are therefore related to eigenvectors of positive and negative parity, respectively, and are the solutions to
the equations


det A(Œª1i ) + B(Œª1i ) ‚àí Œª1i = 0


det A(Œª2j ) ‚àí B(Œª2j ) ‚àí Œª2j = 0.
¬±
It is thus obvious that PR
(Œª) = A(Œª) ¬± B(Œª) ‚àí Œª are the
characteristic polynomials related to eigenvectors of positive
and negative parity, respectively, and that


+
‚àí
PR
¬∑ PR
= det R0S (H) = det RS (H) .

Appendix D: Mathematical details on the transfer of compact
localized states

We now prove the statements made in Section IV. The
proofs are similar to those done in [37], but are included here
so that the current work is self-contained.
We assume that the original network is described by a
Hamiltonian H and supports PGST between sites S = {u, v}.
We then partition the system such that


HSS HSS
‚àà R(N +2)√ó(N +2) .
H=
HSS HSS

We then modify the system as shown in Fig. 7 (c), so that
its Hamiltonian becomes
Ô£´
Ô£∂
HSS ‚àö12 HSS ‚àö12 HSS
Ô£¨
02√ó2 Ô£∑
Hm = Ô£≠ ‚àö12 HSS HSS
Ô£∏.
1
‚àö H
0
H
2√ó2
SS
2 SS
By means of the ‚Äòequitable partition theorem‚Äô [26, 46, 47] its
N + 4 eigenstates can then be shown to be
Ô£´ ŒΩ Ô£∂
w
Ô£´
Ô£∂
Ô£¨ ‚àö1 xŒΩu Ô£∑
0N √ó1
Ô£¨ 2 Ô£∑
1
ŒΩ
Ô£¨
Ô£∑
|œÜŒΩ i = Ô£¨ ‚àö2 xv Ô£∑ , |œÜN +2+r i = Ô£≠ zr Ô£∏
Ô£¨ ‚àö1 ŒΩ Ô£∑
‚àízr
Ô£≠ 2 xu Ô£∏
1
ŒΩ
‚àö x
2 v
with ŒΩ = 1, . . . , N + 2 and r = 1, 2. The zr ‚àà C2√ó1 are
the eigenvectors of the isolated HSS . We now denote the first
N sites as S, and the remaining four as u1 , v1 , u2 , v2 . The
fidelity
F 0 (t) = | hu+ |exp(iHm t)|v+ i |2

(D1)

[Eq. (31) from Section IV] for the transfer of symmetric exi
|v1 i+|v2 i
‚àö 2 to |v+ i =
‚àö
citations |u+ i = |u1 i+|u
can then be
2
2
evaluated as
2

F 0 (t) = |hu+ |exp(iHm t)|v+ i|
=

N
+2
X

2
ŒΩ

ŒΩ

hu+ |œÜ i hœÜ |v+ i e

iŒªŒΩ t

ŒΩ=1

=

N
+2
X

2

xŒΩu (xŒΩv )‚àó eiŒªŒΩ t

ŒΩ=1

=F (t)
as claimed in Section IV, since the overlap of |u+ i , |v+ i with
|œÜN +2+r i vanishes.

18
We now look at the compact localized states supported by
i
‚àö 2 (loHm . There are two of these, given by |I 0 i = |u1 i‚àí|u
2
i
‚àö 2 (localized
calized on sites u1 and u2 ) and |F 0 i = |v1 i‚àí|v
2
on sites v1 and v2 ). To transfer |I 0 i to |F 0 i, we perform an
instantaneous flip of couplings at t = 0, so that

Ô£´

Hm ‚Üí

0

H0m

HSS
Ô£¨
= Ô£≠ ‚àö12 HSS
‚àí ‚àö12 HSS

0

‚àö1 H
2 SS

HSS
02√ó2

‚àí ‚àö12 HSS
02√ó2 Ô£∑
Ô£∏
HSS

with ŒΩ = 1, . . . , N + 2, r = 1, 2, and zr as above. We then
yield
F 00 (t) =| hu‚àí |exp(iH0m t)|v‚àí i |2
=

N
+2
X

2
ŒΩ

ŒΩ

hu‚àí |œÜ i hœÜ |v‚àí i e

iŒªŒΩ t

ŒΩ=1

Ô£∂
=

N
+2
X

2

xŒΩu (xŒΩv )‚àó eiŒªŒΩ t

ŒΩ=1
0

=F (t) = F (t)
H0m .

and |I i , |F i are no longer eigenstates of
By means
of the so-called ‚Äònonequitable partition theorem‚Äô [26, 48] the
N + 4 eigenstates of H0m can then shown to be
Ô£∂
wŒΩ
Ô£´
Ô£∂
Ô£¨ ‚àö1 xŒΩu Ô£∑
0N √ó1
Ô£¨ 2
Ô£∑
Ô£¨ 1 ŒΩ Ô£∑
|œÜŒΩ i = Ô£¨ ‚àö2 xv Ô£∑ , |œÜN +2+r i = Ô£≠ zr Ô£∏
Ô£¨ ‚àö1 ŒΩ Ô£∑
zr
Ô£≠‚àí 2 xu Ô£∏
‚àí ‚àö12 xŒΩv
Ô£´

[1] S. Bose, Quantum Communication through an Unmodulated
Spin Chain, Phys. Rev. Lett. 91, 207901 (2003).
[2] M. Christandl, N. Datta, A. Ekert, and A. J. Landahl, Perfect
State Transfer in Quantum Spin Networks, Phys. Rev. Lett. 92,
187902 (2004).
[3] M. Christandl, N. Datta, T. C. Dorlas, A. Ekert, A. Kay, and
A. J. Landahl, Perfect transfer of arbitrary states in quantum
spin networks, Phys. Rev. A 71, 032312 (2005).
[4] C. Godsil, State transfer on graphs, Discrete Math. 312, 129
(2012).
[5] L. Vinet and A. Zhedanov, Almost perfect state transfer in quantum spin chains, Phys. Rev. A 86, 052319 (2012).
[6] G. Coutinho, K. Guo, and C. M. van Bommel, Pretty good state
transfer between internal nodes of paths, arXiv:1611.09836.
[7] X. Fan and C. Godsil, Pretty good state transfer on double stars,
Linear Algebra Its Appl. 438, 2346 (2013).
[8] H. Pal and B. Bhattacharjya, Pretty Good State Transfer on Circulant Graphs, Electron. J. Comb. 24 (2017).
[9] C. M. van Bommel, A Complete Characterization of Pretty
Good State Transfer on Paths, arXiv:1612.05603.
[10] E. Ackelsberg, Z. Brehm, A. Chan, J. Mundinger, and C. Tamon, Laplacian state transfer in coronas, Linear Algebra Its
Appl. 506, 154 (2016).
[11] O. Eisenberg, M. Kempton, and G. Lippner, Pretty good quantum state transfer in asymmetric graphs via potential, Discrete
Math. in press (2018).
[12] M. Kempton, G. Lippner, and S.-T. Yau, Pretty good quantum
state transfer in symmetric spin networks via magnetic field,
Quantum Inf. Process 16, 210 (2017).
[13] L. A. Bunimovich and B. Z. Webb, Isospectral graph transformations, spectral equivalence, and global stability of dynamical
networks, Nonlinearity 25, 211 (2011).
[14] L. A. Bunimovich and B. Z. Webb, Isospectral compression and
other useful isospectral transformations of dynamical networks,
Chaos 22, 033118 (2012).
[15] L. Bunimovich and B. Webb, Isospectral Transformations: A
New Approach to Analyzing Multidimensional Systems and Networks (Springer, New York, NY, UNITED STATES, 2014).

as claimed in Section IV.
Thus, if H supports PGST of single site excitations u and v,
Hm supports two compact localized states, and by switching
Hm ‚Üí H0m , these compact localized states can be pretty well
transferred. As explained in Section IV, the compact localized
states can also be stored with time-independent fidelity F (t >
t=Tf

Tf ) = F (Tf ) by instantaneously switching H0m ‚Üí Hm .

[16] Vasquez Fernando Guevara and Webb Benjamin Z., Pseudospectra of isospectrally reduced matrices, Numer. Linear Algebra Appl. 22, 145 (2014).
[17] P. Duarte and M. J. Torres, Eigenvectors of isospectral graph
transformations, Linear Algebra Its Appl. 474, 110 (2015).
[18] D. Smith and B. Webb, Hidden symmetries in real and theoretical networks, Physica A 514, 855 (2019).
[19] M. Kempton, J. Sinkovic, D. Smith, and B. Webb,
Characterizing cospectral vertices via isospectral reduction,
arXiv:1906.07705.
[20] P. A. Kalozoumis, C. Morfonios, N. Palaiodimopoulos, F. K.
Diakonos, and P. Schmelcher, Local symmetries and perfect
transmission in aperiodic photonic multilayers, Phys. Rev. A
88, 033857 (2013).
[21] P. A. Kalozoumis, C. Morfonios, F. K. Diakonos, and
P. Schmelcher, Invariants of Broken Discrete Symmetries, Phys.
Rev. Lett. 113, 050403 (2014).
[22] P. A. Kalozoumis, C. V. Morfonios, F. K. Diakonos, and
P. Schmelcher, Invariant currents and scattering off locally symmetric potential landscapes, Ann. Phys. 362, 684 (2015).
[23] V. E. Zampetakis, M. K. Diakonou, C. V. Morfonios, P. A. Kalozoumis, F. K. Diakonos, and P. Schmelcher, Invariant current
approach to wave propagation in locally symmetric structures,
J. Phys. A 49, 195304 (2016).
[24] M. RoÃàntgen, C. Morfonios, F. Diakonos, and P. Schmelcher,
Non-local currents and the structure of eigenstates in planar
discrete systems with local symmetries, Ann. Phys. 380, 135
(2017).
[25] C. V. Morfonios, P. A. Kalozoumis, F. K. Diakonos, and
P. Schmelcher, Nonlocal discrete continuity and invariant currents in locally symmetric effective SchroÃàdinger arrays, Ann.
Phys. 385, 623 (2017).
[26] M. RoÃàntgen, C. V. Morfonios, and P. Schmelcher, Compact localized states and flat bands from local symmetry partitioning,
Phys. Rev. B 97, 035161 (2018).
[27] D. Leykam, A. Andreanov, and S. Flach, Artificial flat band
systems: From lattice models to experiments, Adv. Phys. 3,
1473052 (2018).

19
[28] I. L. Garanovich, S. Longhi, A. A. Sukhorukov, and Y. S.
Kivshar, Light propagation and localization in modulated photonic lattices and waveguides, Phys. Rep. 518, 1 (2012).
[29] A. Szameit, F. Dreisow, and S. Nolte, Discrete Optics in Femtosecond Laser Written Waveguide Arrays, Topics in Applied
Physics (Springer, Berlin, Heidelberg, 2012).
[30] S. Bose, Quantum communication through spin chain dynamics: An introductory overview, Contemp. Phys. 48, 13 (2007).
[31] L. Banchi, G. Coutinho, C. Godsil, and S. Severini, Pretty good
state transfer in qubit chains‚ÄîThe Heisenberg Hamiltonian, J.
Math. Phys. 58, 032202 (2017).
[32] C. Godsil and J. Smith, Strongly Cospectral Vertices,
arXiv:1709.07975.
[33] A. J. Schwenk, Almost all trees are cospectral, in Proceedings
of the Third Annual Arbor Conference (Academic Press, New
York, 1973) pp. 257‚Äì307.
[34] L. Bunimovich and L. Shu, Generalized eigenvectors of
isospectral transformations, spectral equivalence and reconstruction of original networks, Linear Algebra Its Appl. 551,
104 (2018).
[35] E. W. Weisstein, Resultant. From MathWorld‚ÄîA Wolfram
Web Resource, http://mathworld.wolfram.com/Resultant.html.
[36] E.
W.
Weisstein,
Polynomial
Discriminant.
From
MathWorld‚ÄîA
Wolfram
Web
Resource,
http://mathworld.wolfram.com/PolynomialDiscriminant.html.
[37] M. RoÃàntgen, C. V. Morfonios, I. Brouzos, F. K. Diakonos,
and P. Schmelcher, Quantum network transfer and storage
with compact localized states induced by local symmetries,
arXiv:1811.02950, Accepted for publication in Phys. Rev. Lett..
[38] P. W. Anderson, Absence of Diffusion in Certain Random Lattices, Phys. Rev. 109, 1492 (1958).

[39] N. B. Kopnin, T. T. HeikkilaÃà, and G. E. Volovik, Hightemperature surface superconductivity in topological flat-band
systems, Phys. Rev. B 83, 220503 (2011).
[40] V. I. Iglovikov, F. HeÃÅbert, B. GreÃÅmaud, G. G. Batrouni, and
R. T. Scalettar, Superconducting transitions in flat-band systems, Phys. Rev. B 90, 094506 (2014).
[41] S. Peotta and P. ToÃàrmaÃà, Superfluidity in topologically nontrivial
flat bands, Nat. Commun. 6, 8944 (2015).
[42] A. Julku, S. Peotta, T. I. Vanhala, D.-H. Kim, and P. ToÃàrmaÃà, Geometric Origin of Superfluidity in the Lieb-Lattice Flat Band,
Phys. Rev. Lett. 117, 045303 (2016).
[43] K. Kobayashi, M. Okumura, S. Yamada, M. Machida, and
H. Aoki, Superconductivity in repulsively interacting fermions
on a diamond chain: Flat-band-induced pairing, Phys. Rev. B
94, 214501 (2016).
[44] M. Tovmasyan, S. Peotta, P. ToÃàrmaÃà, and S. D. Huber, Effective theory and emergent SU(2) symmetry in the flat bands of
attractive Hubbard models, Phys. Rev. B 94, 245149 (2016).
[45] L. Liang, T. I. Vanhala, S. Peotta, T. Siro, A. Harju, and
P. ToÃàrmaÃà, Band geometry, Berry curvature, and superfluid
weight, Phys. Rev. B 95, 024515 (2017).
[46] W. Barrett, A. Francis, and B. Webb, Equitable decompositions
of graphs with symmetries, Linear Algebra Its Appl. 513, 409
(2017).
[47] A. Francis, D. Smith, D. Sorensen, and B. Webb, Extensions
and applications of equitable decompositions for graphs with
symmetries, Linear Algebra Its Appl. 532, 432 (2017).
[48] E. Fritscher and V. Trevisan, Exploring Symmetries to Decompose Matrices and Graphs Preserving the Spectrum, SIAM J.
Matrix Anal. Appl. 37, 260 (2016).

