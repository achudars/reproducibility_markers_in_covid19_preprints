Resonant-state expansion for planar photonic-crystal structures
Sam Neale and Egor A. Muljarov

arXiv:1908.06916v1 [physics.optics] 19 Aug 2019

School of Physics and Astronomy, Cardiff University, Cardiff CF24 3AA, United Kingdom
(Dated: August 20, 2019)
We present a new paradigm in the field of photonic crystals and metamaterials, applying the
resonant-state expansion (RSE) to planar photonic-crystal structures. The RSE allows us to understand and quantify optical resonances in photonic-crystal structures in terms of the analytic
resonant states of a homogeneous planar waveguide. The RSE provides an efficient and reliable tool
for accurate calculation of a complete set of the resonant states of a photonic-crystal slab, which is
required for the correct description and a better understanding of its optical spectra. For the proof
of principle, numerical verification of the RSE, and demonstration of its unprecedented accuracy
and convergence, an infinite planar photonic crystal slab periodic in one dimension is taken as an
example. To illustrate the power of the present approach, we consider the mode evolution with the
amplitude of the periodic modulation, revealing the role of the guided modes in the formation of
bound states in the continuum.
I.

INTRODUCTION

Photonic crystal structures exhibit a number of fundamental optical properties, such as strong confinement and
Bragg scattering of light, which can be used e.g. for light
propagation control in grating couplers [1], photonic integrated circuits [2, 3], and beam splitters [4]. The band
structure of an idealized photonic crystal (PC), infinitely
extended in all directions, is already very complicated [5].
Planar PC systems provide an opportunity for the light
trapped within an optical waveguide (WG) to couple to
the photonic continuum outside the system [6–9], which
makes finding the light eigenmodes of a PC slab an even
more challenging task.
The complex transmission spectrum of a PC slab can
be intuitively understood as a superposition of a large
number of resonances of different linewidth and lineshape [7], which can be rigorously described by the resonant states (RSs). Being introduced in quantum mechanics nearly a century ago [10, 11], the RSs in electromagnetics are the discrete eigenmodes of an optical system – solutions to Maxwell’s wave equation with outgoing
boundary conditions (BCs) [12]. Physically, RSs describe
a culmination of various constructive and destructive interferences of waves due to multiple reflections within the
optical system. The RS eigenfrequency is generally complex, with the quality factor (Q-factor) being the half of
the ratio of its real to imaginary part. In planar systems,
the RSs include, as a special case, modes with purely
real frequency, such as WG modes formed in planar systems as a result of the total internal reflection. Additionally, a typical optical spectrum of a PC slab contains
non-resonant features known as Rayleigh-Wood anomalies [13], which are caused by the opening of new diffraction orders into free space. Mathematically, they correspond to the branch cuts in the complex frequency plane
caused by the square root in the light dispersion which
can be represented as a continuum of modes that lie along
the cuts [14] and that are similar to the RSs. These cuts
can be observed, e.g. in a form of isolated resonances –
cut modes, in finite-difference time-domain calculations

with perfectly matched layers [15]. In some cases, these
continua of modes can even be entirely eliminated from
the spectral representation [16, 17].
The positions and linewidths of the RSs can be modified e.g. by introducing imperfections or changes to the
permittivity. This makes RSs of particular importance
for sensing applications, ranging from sensing the refractive index and chirality of a medium [18–20] to biosensing of individual molecules and atoms [21–23]. RSs have
found their application also in miniature lasers [24] and
low-loss guiding of light in photonic crystal fibers [2], to
name a few. The concept of RSs (also known as “quasinormal modes”) is widely used the literature as a natural
tool for understanding the optical properties of microand nano-resonators, see e.g. a recent review [25].
The resonant-state expansion (RSE) is a novel rigorous approach developed in electrodynamics [26] for calculating the RSs of an optical system. Using a complete
set of the RSs of a simpler system as a basis, the RSE
performs a mapping of Maxwell’s wave equation onto a
linear eigenvalues problem, which determines the RSs of
the complex system of interest. In addition to a higher
numerical efficiency compared to other computational
methods, such as finite-difference in time-domain, finiteelement, and Fourier modal method, as demonstrated
in [14, 27], the RSE provides an intuitive physical picture of resonant phenomena, capable of explaining features observed in optical spectra. Also, unlike other approaches, the RSE guarantees the completeness of the
set of the RSs found within the selected spectral range,
provided that the basis set used as input for the RSE
is also complete. The latter is easy to achieve and to
verify when choosing the basis system to be analytically
solvable. Other approaches, in turn, are not able to guarantee that all relevant modes are found and that there
are no spurious solutions. The effect of other modes, not
included in the optical spectrum, is commonly treated as
a background contribution adjusted with a number of fit
parameters [28, 29].
So far the RSE has been applied to finite open optical systems of different geometry and dimensional-

2
ity [27, 30, 31], as well as to homogeneous [17, 32] and inhomogeneous planar waveguides [14]. Recently, the RSE
was generalized to systems with frequency dispersion of
the permittivity [33] and later on to magnetic, chiral and
bi-anisotropic optical systems [34], enabling its further
application to metamaterials. The RSE has been also
used in first order of the perturbation theory for PC
structures to describe the refractive index sensing [19],
and a rigorous analytic mode normalization in PC structures has been presented in [19, 20]. However, the RSE
has never been applied in full to PC systems.
In this paper, we develop a photonic-crystal RSE (PCRSE), a new rigorous approach for the accurate calculation of RSs in planar PC structures. The key idea of
the PC-RSE is to use the analytically solvable homogeneous slab as basis system and to treat a PC structure
as a periodic modulation on top of the slab. This idea
echoes back to the famous nearly-free electron model in
the solid state theory [35]. However, unlike states of a
free electron, the basis RSs of an open optical system are
generally leaky (having finite Q-factors), which makes
the implementation of the same idea in optics entirely
different.
The idea of using the eigenmodes of a homogeneous
slab has been already implemented as a guided mode expansion method [36]. Among different methods available
in the literature, this approach has been considered as the
most efficient way of calculating the eigenmodes of PC
structures. It provides, in particular, a powerful tool for
optimizing parameters of photonic crystal cavities [37].
This method, however, has a significant disadvantage: A
set of the guided modes it uses as a basis is incomplete.
This breach has been patched by introducing an additional procedure, similar to Fermi’s golden rule, for an
approximate treatment of light leakage from the system
resulting in finite Q-factors of modes [36]. Our approach
instead adds to this incomplete set of guided modes all
the missing RSs having finite Q-factors, as well as the
cut modes responsible for the Rayleigh-Wood anomalies observed in optical spectra. Having a complete set
of modes, which is generated by the RSE, allows us to
quantify precisely any optical observable [38–40], such as
the transmission, reflection, scattering, and extinction of
light.
The periodicity of a PC structure mixes all possible
Bragg harmonics. Therefore, the basis RSs have to be
taken with different in-plane wave numbers. As a result, the dyadic Green’s function of the set of Maxwell’s
equations has branch cuts in the complex frequency plane
which have to be taken into account in the PC-RSE along
with the RSs. This presents the major complication of
the PC-RSE which we have dealt with by splitting the
cuts into series of discrete, artificial cut modes added
for completeness to the basis RSs, as it was done e.g.
in [14, 31].
A significant technical advantage of treating periodic
modulations of a homogeneous slab as perturbations is
that all the diagonal elements of the perturbation matrix

are vanishing due to periodicity (without homogeneous
perturbation). This guarantees a low level of numerical
errors even for small basis sizes and strong periodic modulations, as we show in this paper. Using for illustration,
a dielectric slab in a vacuum periodically modulated in
one dimension (1D), we demonstrate the accuracy and
efficiency of the PC-RSE in finding the RSs of PC structures.
For verification of the PC-RSE, we compare it with
the scattering matrix method (SMM) [6, 7], also known
in the literature as Fourier modal method [41–44], which
has been considered in the literature as the most accurate and reliable way of calculating the optical spectra
of infinitely extended periodic open systems. In fact, the
SMM is asymptotically exact, having the total numbers
of the Bragg diffractions channels taken into account as
the only parameter of the method. However, when used
for finding the RSs of the system, the SMM is limited by
rather low numbers of Bragg channels, struggling to find
all modes in a given frequency range and often returning
spurious modes. Recently, a so called “mode expansion
method” has been introduced in [45] for an accurate calculation and qualitative study of bound states in the continuum (BICs) in PC slabs. We note, however, that this
method, which appeared under a new name, is nothing
else than the well-known SMM.
The PC-RSE presented here is not only a simple numerical tool that allows us to accurately calculate a complete set of the RSs of a planar PC slab with a complicated structure. It is a new paradigm in the field of PC
systems revealing the origin and the properties of their
RSs. To demonstrate this, we study BICs of a dielectric
PC slab with 1D grating. These modes, having infinite
Q-factors while residing inside the continuum, were predicted in non-relativistic quantum systems almost a century ago [46] but only recently have become a subject
of particular interest [47–49] and have been observed in
optics [50]. We show in particular how BICs are formed
and how different types of basis RSs of a homogeneous
slab contribute to them as compared to other resonances
of the PC slab, such as quasi-guided [7] and Fabry-Pérot
modes.
II.

FORMALISM OF THE PC-RSE

Consider a PC slab occupying the region |z| 6 a, where
z is the coordinate in the growth direction. Assuming
the permittivity and the permeability are isotropic everywhere, the electric field E, magnetic field H, and the
frequency ω of a given RS of the PC slab satisfy the following Maxwell equations (the speed of light c = 1)
∇ × E = ω(µ + ∆µ)iH ,
∇ × iH = ω(ε + ∆ε)E ,

(1)
(2)

which have to be solved together with outgoing wave
BCs outside the PC slab. Here we have explicitly separated the total permittivity [permeability], periodic in

3
x-direction with the period d, into a homogeneous part
ε(z) [µ(z)] and a periodic part ∆ε(x, z) [∆µ(x, z)], obeying
∆ε(x + d, z) = ∆ε(x, z) ,

∆µ(x + d, z) = ∆µ(x, z) . (3)

For the purpose of a clearer illustration of our approach,
we consider the case of the transverse electric (TE) and
transverse magnetic (TM) polarizations not coupled to
each other, which is achieved by assuming that the ycomponent of the in-plane momentum is zero. We note,
however, that generalization to the case of a non-zero ycomponent of the momentum and to 2D periodicity of
the PC slab is straightforward, and the whole formalism
remains essentially the same as presented here.
Since the TE and TM polarizations are not coupled,
each polarization can be treated separately. However,
due to the symmetry of Maxwell’s equations (1)–(2) with
respect to a simultaneous exchange of E ↔ iH, ε ↔ µ,
and ∆ε ↔ ∆µ, it is sufficient to treat only one of the two
polarizations, for example, the TE polarization, while
retaining the permeability in all results, even if all the
constituent materials are non-magnetic.
For the TE polarization, Maxwell’s equations (1)–(2)
reduce to
(L̂ + ∆L̂)F = 0 ,

determining the quasi-momentum p in the x-direction.
We therefore solve the Maxwell equations (4) for the
given p, using a periodic dyadic Green’s function (GF)
Ĝp (x; z, z 0 ) of the homogeneous slab:
Z
Z
ω
0
F(x, z) = −
dx dz 0 Ĝp (x−x0 ; z, z 0 )∆P̂ (x0 , z 0 )F(x0 , z 0 ),
d d
(12)
R
where d dx implies integration over any period interval.
This GF has the same value of p and satisfies Maxwell’s
equations with a periodic array of sources:
X
L̂(x, z; ω)Ĝp = 1̂δ(z −z 0 )d
eipmd δ(x−x0 −md) , (13)
m

where m is an integer and 1̂ is the 3×3 unit matrix. Using
Bloch’s theorem again, the periodic GF can be written
as
X
Ĝp (x; z, z 0 ) =
Ĝp+g (z, z 0 )ei(p+g)x ,
(14)
g

where
g=

2πm
,
d

(4)

where the vector field F is formed from three nonvanishing components of the electric and magnetic fields,


Ey
F =  iHx  ,
(5)
iHz

and Ĝp (z, z 0 ) is another, x-independent GF of the homogeneous slab satisfying an equation
L̂p (z; ω)Ĝp (z, z 0 ) = 1̂δ(z − z 0 ) ,

L̂p (z; ω) = ω P̂ (z) − D̂p (z) ,

∆L̂(x, z; ω) = ω∆P̂ (x, z)

(6)
(7)

are linear operators, consisting of the generalized permittivity [34]


ε(z) 0
0
P̂ (z) =  0 µ(z) 0  ,
(8)
0
0 µ(z)
the curl operator



0 ∂z −∂x
0 ,
D̂(x, z) =  −∂z 0
∂x 0
0
and the perturbation


∆ε(x, z)
0
0
.
0
∆µ(x, z)
0
∆P̂ (x, z) = 
0
0
∆µ(x, z)

(9)

Owing to the periodicity in the x-direction, the wave
function F obeys the Bloch theorem,
F(x + d, z) = F(x, z)eipd ,

where ⊗ denotes the dyadic vector product, Fn (z; p) is
the vectorial wave function of the RS n of the homogeneous slab, satisfying Maxwell’s equation
(19)

and outgoing BCs, and ωn is the RS eigenfrequency.
Equation (18) is valid if the RSs are normalized according to a general normalization condition [20, 34] applied
to the homogeneous planar system,
Z z2

z2
1=
Fn† · P̂ Fn dz + En† × iH0n − En0 × iH†n · ez z ,
z1

(11)

(17)

which consists of the homogeneous generalized permittivity P̂ (z) given by Eq. (8) and the curl operator D̂p (z)
given by Eq. (9) with ∂x replaced by ip: D̂p (z) = D̂∂x →ip .
The homogeneous GF Ĝp can be written, using the
Mittag-Leffler (ML) theorem [51], in terms of the RSs of
the homogeneous slab,
Z
X
Fn (z; p) ⊗ Fn (z 0 ; −p)
0
Ĝp (z, z ) =
(18)
ω − ωn
n

L̂p (z; ωn )Fn (z; p) = 0

(10)

(16)

with a modified operator

and
L̂(x, z; ω) = ω P̂ (z) − D̂(x, z) ,

(15)

1

(20)

4
where ez is the unit vector in the z-direction, z1 and z2
are two arbitrary coordinates outside of the system, such
that z1 6 −a and z2 > a, and Fn† (z; p) = Fn (z; −p) is
the adjoint field. En and Hn in Eq. (20) are, respectively,
the electric and magnetic fields of the RS n, combined together into the vector Fn = {En , iHn } having in general
six components which are reduced to only three for TE or
TM polarization, in accordance with Eq. (5); En0 and H0n
are the frequency derivatives of the analytic continuation
of the fields En and Hn into the complex frequency plane
(for more details see [27, 34]). Note that the ML series
Eq. (18) includes also cut modes, in addition to all the
RSs lying on the “physical” Riemann sheet of complex
frequency – for details and derivation, see Appendices A
and B.
Substituting Eq. (14) into Eq. (12) and using the ML
expansion Eq. (18), we obtain, owing to the completeness
of the basis and in agreement with Bloch’s theorem, an
expansion of the wave function F of the RS of the PC
slab into the RSs of the homogeneous slab,
Z
XX
cgn Fn (z; p + g)ei(p+g)x ,
(21)
F(x, z) =
g

n

where the expansion coefficients are given by
Z
ω 1
cgn = −
dxe−i(p+g)x
ω − ωng d d
Z
× dzFn (z; −p − g) · ∆P̂ (x, z)F(x, z) . (22)
Then, substituting the expansion Eq. (21) into Eq. (22),
we arrive at the the key equation of the PC-RSE:
Z 
 0
XX
gg 0
δnn0 δgg0 + Vnn
cgn0 = ωng cgn ,
(23)
ω
0
g0

labeled by the index g. Also, the contribution of the cuts,
denoted by the integral, is included in Eq. (23), in the
same way as it was done in the RSE applied to 2D open
optical systems [31] or to inhomogeneous waveguides [14].
Note that the RSE has been recently formulated for
PC systems [19, 20], in a form of a perturbation theory
treating some modifications of the already existing periodic structure, i.e. using a PC slab as a basis system.
It has been applied so far to either weak perturbations,
limiting the RSE basis to a single mode [19], or to moderate perturbations of quasi-degenerate modes, limiting
the basis to such a pair of modes [20]. In the present
work we consider instead a homogeneous basis containing up to several thousands of modes of the homogeneous
basis. This choice of the basis presents a significant advantage in implementation of the RSE. For example, all
different Bragg channels are fully isolated in the homogeneous basis, whereas a PC basis has all these channels
already coupled together. This has, in particular, a dramatic consequence on inclusion of the branch cuts in the
basis, which is impossible to do in practice with Bragg
channels mixed up as in the PC basis.

III.
A.

RESULTS

PC-RSE for permittivity perturbations

We now use the PC-RSE derived in Sec. II for finding
the RSs of a nonmagnetic PC slab with a periodic modulation of the permittivity. In this case the perturbation
matrix in the TE polarization simplifies to
Z
0
gg 0
Vnn
=
Eng (z)∆εg−g0 (z)Eng 0 (z)dz
(26)
0

n0

where
in which δij is the Kronecker delta, and the matrix elements of the perturbation are defined as
Z
gg 0
Vnn
=
Fn (z; −p−g)·∆P̂g−g0 (z)Fn0 (z; p+g 0 )dz (24)
0
with ∆P̂g (z) being the Fourier coefficients of the generalized permittivity perturbation,
Z
1
∆P̂g (z) =
∆P̂ (x, z)e−igx dx .
(25)
d d
Note that in Eqs. (22) and (23), we have added index g
to ωn in order emphasize the dependence of the basis RS
frequencies on the Bragg channel number g.
Equation (23) presents a matrix eigenvalue problem,
linear in ω (the eigenfrequency of a perturbed RS of the
PC slab) and can be solved simply by diagonalizing a
complex symmetric matrix. This equation is very similar
to the RSE equation for a finite open optical system [26].
However, the main difference between the two is that
Eq. (23) contains a summation over all Bragg channels,

∆εg (z) =

1
d

Z

∆ε(x, z)e−igx dx

(27)

d

and Eng (z) is the electric field (directed along y) of the
homogeneous-slab RS with index n and momentum p + g
along x. In general, this RS is a solution of the Maxwell
wave equation (B7) with the outgoing boundary condition Eq. (B15) and the normalization given by Eq. (B16),
see Appendix B. Here, we have added index g to the electric field Eng and the eigenfrequency ωng , in order to distinguish different Bragg channels contributing to the PCRSE.
Note that in order to treat a permittivity perturbation
in the TM polarization, one should instead set ∆ε = 0 in
Eq. (24) and use ∆µ for the modulation of the permittivity, along with replacements iHx → Ex and iHz → Ez
in the unperturbed wave function Fn (z; p).
As a basis system, we choose a homogeneous dielectric
slab in vacuum, of thickness 2a, permittivity  > 1, and
permeability µ = 1. The full permittivity profile of the
slab system is given by Eq. (C1), and the basis RSs and

5
b a s is R S s
c u t p o le s
M

= 5

0 .0

I m (ωa )

m = 1

FIG. 1. Schematic of the perturbed system – photonic crystal
slab of the total thickness 2a, periodically modulated in x
direction, with period d, within the layer of thickness 2b at
the center of the slab.

5
4

- 0 .1
m = 0

- 0 .2

- 0 .3

cut densities are provided in Appendix C. In practical
use of Eq. (23) we apply a cut discretization, described
in detail in Appendix D 2, which modifies the PC-RSE
equation to
 0
X
gg 0
δn̄n̄0 δgg0 + Vn̄n̄
ω
cgn̄0 = ωn̄g cgn̄
(28)
0

3
2

-3 0

-2 0

-1 0

0

1 0

2 0

3 0

R e ( ωa )
FIG. 2. Basis RSs and cut poles (used for comparison of the
PC-RSE with SMM) for  = 6, α = β = 0, and M = 5 leading
to 11 Bragg channels in the basis, each channel labelled with
index m. The frequencies of the RS and cut modes of channels
m and −m are identical.

n̄0 g 0

with index n̄ labeling both the RS and the cut modes,
see Eq. (D8). Within the slab, |z| 6 a, the electric fields
of the RSs and cut modes are described by the same
functions
En̄g (z) = Bn̄g (e

g
iqn̄
z

g
−iqn̄
z

+ (−1)n̄ e

)

(29)

with the normalization constants for the RSs and cut
modes given by Eqs. (C9) and (D10), respectively. The
eigenfrequencies ωn̄g are determined by the secular equation (C7) for the RSs and by Eq. (D5) for the cut modes.
Furthermore, the link between the mode frequency ωn̄g
and the wave number kn̄g in vacuum and qn̄g in the medium
is provided by the following light dispersion relations:
(ωn̄g )2
(ωn̄g )2

=
=

(kn̄g )2 + (p + g)2 ,
(qn̄g )2 + (p + g)2 .

(30)
(31)

For illustration purposes and also for the ease of comparison with the SMM, the perturbation of the homogeneous slab is taken in the most simple harmonic form:


2πx
Θ(b − |z|) ,
(32)
∆ε(x, z) = α + β cos
d
where Θ(z) is the Heaviside step function, b 6 a, and α
and β are some parameters, see Fig. 1. We note, however,
that the RSE can equally deal with any other shape of
the periodic perturbation, not requiring the separation of
variables which the perturbation in the form of Eq. (32)
possesses. The SMM in turn, requires this separation.
In fact, the transfer matrices that form the scattering
matrix are calculated layer-by-layer through the system,
see [7]. Therefore any system changing smoothly in the
growth direction will be approximated by a stack of slices
homogeneous in z, which are ideally infinitely thin.

For the perturbation given by Eq. (32), the matrix elements take the following explicit form:
0

0

0

gg
g g
gg
Vn̄n̄
0 = Bn̄ Bn̄0 (2αδgg 0 + βXg−g 0 ) bZn̄n̄0 ,

(33)

Xg = δg,g1 + δg,g−1

(34)

where

with g±1 = ±2π/d and
0

gg 0
Zn̄n̄
0

q g + qn̄g 0
b
= 1 + (−1)
sinc n̄
π
0


qn̄g − qn̄g 0
n̄
n̄0
+ (−1) + (−1)
sinc
b
π


n̄+n̄0



(35)
(36)

with sinc z = sin z/z.
For homogeneous perturbations, used in Appendix D
for the RSE verification and comparison of the k- and ωrepresentations, we use α 6= 0 and β = 0. For all periodic
perturbations we instead take α = 0 and β 6= 0, so that
all the matrix elements Eq. (26) within the same channel
(g = g 0 ) are vanishing, since ∆ε0 (z) = 0, according to
Eq. (27). Using this property results in a general quick
convergence of the PC-RSE. In fact, since the diagonal
elements of the perturbation matrix are all zeros, the
first-order contribution of the PC-RSE is vanishing [27].
Then the lowest-order non-vanishing contribution of the
gg 0
perturbation can only be quadratic in Vnn
0 , making its
overall effect quantitatively small and the PC-RSE converging quickly to the exact solution.
B.

Basis for the PC-RSE

The full basis for the PC-RSE consists of an infinite
number of RSs and cut modes, taken for all Bragg chan-

6
nels g = 2πm/d, where m = 0, ±1, ±2.... Periodic perturbations, such as the one given by Eq. (32), introduce
coupling between the basis states belonging to different
Bragg channels, so that for obtaining the exact result one
needs to take into account all of them simultaneously. In
practice, we introduce a truncation, limiting the number
of RSs and cut modes for each Bragg channel as well the
number of Bragg channels themselves. We do both truncations by introducing a single real parameter ωmax which
defines a circle |ω| < ωmax in the complex frequency plane
containing the basis RSs and cut modes included in the
PC-RSE. The set of included RSs, defined in this way,
typically contains a large number of WG modes. In fact,
only the m = 0 channel consists of equidistant FP modes
which we call in the following leaky modes. All other
channels contain WG modes
real frequencies ωng
√ having
g
within the intervals (p+g)/  < |ωn | < (p+g), the number of WG modes within each channel is growing linearly
with g, with the total number increasing quadratically
with g. The WG modes are separated from FP modes
by series of cut poles of the GF which are positioned vertically down below the branch points at ω = ±(p + g).
Above ω = p + g and below ω = −(p + g) there are two
infinite series of FP modes for each Bragg channel. All
this means, in particular, that for√a given radius ωmax ,
the basis includes 2M + 1 ≈ ωmax d/π channels, most
of which consist of only WG modes.
For the purpose of verification of the PC-RSE by comparing it with the SMM, which is presented in Sec. III C
below, we use however a different criterion: We limit the
number of Bragg channels to |m| 6 M , where M is a
fixed number, and truncate the RSs and cut modes independent of M , i.e. using the same number of modes
for each selected channel. This is done in order to avoid
a computationally expensive root searching within the
SMM related to the increase of the S-matrix size with
M . Clearly, for adequate comparison, it is essential to
keep the truncation number M the same for both PCRSE and SMM. However, the necessity to keep M low
demonstrates the major weakness of the SMM.
The PC-RSE basis used for the comparison with the
SMM is illustrated in Fig. 2, for p = 0 and M = 5, showing the eigenfrequencies of both the RSs and cut modes
for all selected 11 Bragg channels. Clearly, for p = 0, the
positive- and negative-m channels are degenerate (giving the same RS eigenfrequencies), and both degenerate
channels must be included in the basis. Additionally,
there are now 2M cuts with discretized cut modes added
to the basis. These cut modes are also degenerate for the
same reason as the RSs.

C.

Verification of the PC-RSE

Before applying the PC-RSE we first consider a homogeneous dielectric slab in vacuum. Taking  = 6 and
pa = 5 as an example, we demonstrate numerically in
Appendix C a quick convergence with the basis size N

of the ML series for the GF to its exact values, given
by the analytic formula Eq. (C3). We show in particular
that both k- and ω-representations of the GF (the first
without and the second with cuts in the basis) converge
in the same way, with the absolute error scaling as 1/N 2 .
The contribution of the cuts to the ML expansion in the
ω-representation is taken into account in this case in a
form of a numerical integration.
We then apply in Appendix D the RSE to a uniform
perturbation of the homogeneous slab for p 6= 0, demonstrating for both k- and ω-representations a quick convergence of the RSE to the analytic solution available
for the core-shell geometry used, with the relative error
for the wave numbers scaling as 1/N 3 . While the RSE
in the k-representation essentially reproduces the results
of [17], the RSE in the ω-representation is applied here
to homogeneous systems for the first time. In this representation, the cut contribution is taken into account in a
form of a subset of artificial cut modes obtained by a numerical discretization of the cuts and added to the basis.
The procedure of the cut discretization is described in
detail in Appendix D 2. These cut modes are then used
in the PC-RSE.
Now, in order to verify the PC-RSE, we consider the
periodic perturbation Eq. (32) with α = 0, β = 1,
d = 2π/5, and b = a/2. The unperturbed system is a
homogeneous slab in vacuum of thickness 2a and permittivity  = 6. Its RSs and cut modes for TE polarization
and p = 0 are shown in Fig. 2. Perturbed RSs of the PC
slab, calculated via the PC-RSE (with and without cut
modes) and the SMM, are shown in Fig. 3 along with all
the unperturbed RSs and cut modes present in the displayed spectral range. As already mentioned in Sec. III B,
the same truncation of the Bragg channels with M = 5
was used for both the PC-RSE and SMM.
While the periodic perturbation is not small (β = 1),
leading to a considerable modification of the RSs, one can
see in Fig. 3 a very good visual agreement between the
SMM and the PC-RSE, even when no cut modes are included in the basis (green crosses ×). In fact, in this case,
there is only a slight discrepancy between the two calculations seen for some RSs close to the cuts, see e.g. region 3
in Fig. 3(b). These discrepancies are fully removed when
cut modes are included in the PC-RSE (red crosses +).
Interestingly, the PC-RSE also returns cut modes of the
perturbed system, positioned along the same cut lines at
Re (ωa) = 5 and 10, but shifted vertically with respect
to their unperturbed positions (compare red and black
points).
To quantify the agreement between the PC-RSE and
SMM we study the relative error for the RS frequencies,
which is shown in Fig. 4(a). Increasing the basis size N ,
the error is not improving for some RSs near the cuts,
if the cut modes are not included in the basis. Including the cuts, the relative error gradually decreases for all
RSs, as the basis size grows. Interestingly, the cut modes
do not contribute to all the RSs evenly, and some RSs
close to the cuts show rather small errors, which are not

7

(a )

(a )

0 .0 0

I m (ωa )

- 0 .1 0

R S s
c u t p o le s

re la tiv e e rro r

b a s is
b a s is
S M M
R S E
R S E
p e rtu

- 0 .0 5

w ith o u t c u ts
w ith c u ts
rb e d c u t p o le s

1 0

-2

1 0

-4

1 0

-6

w ith /w ith o u t
c u ts : N =
/
5 1 8
/
9 9 2
/
1 9 9 8

c u ts

- 0 .1 5
M

= 5
F = 1

- 0 .2 0
0

5

1 0

1 0

-8

0

R e ( ωa )

(b )

B IC
1

- 0 .0 0 1
b a s is R S s
S M M
R S E w ith o u t c u ts
R S E w ith c u ts

1 0

2 0

4 0

6 0

-1

2 4 6
N = 2 6

2

3

re la tiv e e rro r

I m ( a )

Q G M s

1 0

R e ( ωa )

(b )
0 .0 0 0

5

1 0

-3

1 0

-5

1 0

-7

1 0

-9

6 6

1 2 6

4 7 8

9 8 4

- 0 .0 0 2

1 9 2 0

3 9 0 2

F = 1

0

5

1 0

R e ( ωa )
FIG. 3. (a) RS frequencies of a PC slab with  = 6, α = 0,
β = 1, b = a/2, and d = 2π/5, calculated for M = 5 using the
PC-RSE (N = 1998, F = 1) with and without cut modes (red
and green crosses) and the SMM (blue squared with dots).
Unperturbed RSs and both unperturbed and perturbed cut
modes are also shown (black circles with dots, black and blue
dots, respectively). (b) Zoom of (a) showing RSs near and on
the real axis.

improving much when the cut modes are included.
We also show in Fig. 4(b) the relative error of the PCRSE with respect to itself for a larger basis size, using
the single truncation parameter ωmax , as described in
Sec. III B. We take in particular the eigenfrequencies calculated for the total basis size of Ntot ≈ 12000 as the
“exact” values in finding the errors shown in Fig. 4(b)
for different basis sizes. Here Ntot = N + F N , where
N and F N are, respectively, the number of RSs and cut
modes in the basis. We study the dependence on F of the
relative error in Appendix D 2 (see Fig. 13(c)) and show
that F ≈ 1 presents an optimal value for determining the
RSs within a rather wide spectral range. This value of F
is thus used in the calculations presented in this section.
Looking at the dependence of the error on the basis
size, presented in Fig. 4(b), we see that the error decreases by roughly an order as the basis size doubles,
which is close to the 1/N 3 dependence observed for ef-

0

5

1 0

2 0

4 0

6 0

R e ( ωa )
FIG. 4. (a) Relative error of the PC-RSE compared to the
SMM result, taking the latter as “exact”, calculated with and
without cut modes, for different basis sized as labeled, F = 1,
and parameters of the PC slab as in Fig. 3. The basis consists
of the closest to the origin modes, with the same number of
modes for each Bragg channel, for M = 5. (b) Relative error
of the PC-RSE using the N ≈ 6000 result as “exact”, for the
same PC slab and the basis size as labeled. The basis consists
of all RSs and cut modes within the circle |ω| < ωmax in the
complex frequency plane.

fective 1D systems treated by the RSE [26, 27, 30]. This
demonstrates a high efficiency of the PC-RSE. In fact, its
slowest element is matrix diagonalization for which the
compute time scales as N 3 . More important is however
the overall level of errors: Even for 26 RSs and no cut
modes in the basis, the perturbed RSs of the PC slab
are calculated with the accuracy of about or less than
10−3 . The same level of errors is seen in Fig. 4(a) when
cut modes are not taken into account, for a large number
of RSs found within a much wider spectral range. This
can be understood by the already mentioned fact that all
gg
= 0, leading to the effect of the
diagonal elements Vn̄n̄
perturbation vanishing in first-order, and therefore to a
rather low level of corrections and errors.
A large number of the RSs shown in Fig. 3(a) seem

8

(a )
b

0 .0

c
d

4
3
2 β

2

I m ( ωa )

1
0

b a s is R S s
β=1

-0 .1

-0 .2
0

2

- 0 .0 1
m = 2

- 0 .0 2

(b )
4 .4

m = 1

R e ( ωa )

- 0 .0 1
- 0 .0 2

4 .5

m = 1

m = 2
c u t

(c )
4 .9

5 .0

R e ( ωa )

6

R e ( ωa )
I m ( ωa )

0 .0 0

I m ( ωa )

I m ( ωa )

0 .0 0

4

m = 3

0 .0 0

m = 2
m = 3

m = 3

- 0 .0 1

(d )

- 0 .0 2
5 .1

8

6 .1

6 .2

R e ( ωa )

6 .3

6 .4

FIG. 5. Evolution of the RS eigenfrequencies of a PC slab for the amplitude of the period modulation changing from β = 0
to β = 2 as given by the color code. Black dotted circles represent the unperturbed modes (β = 0) and the black crosses the
modes shown in Fig. 3 (β = 1). (b-d) Zoom-in of particular regions in the complex frequency plane close to the real axis, with
the values of m indicating the Bragg order of the unperturbed modes.

to have the imaginary part of the eigenfrequency close
to zero. To see this more clearly, we zoom in the view
of the imaginary part in Fig. 3(b) by a factor of 100.
This allows us to distinguish two types of modes. The
first type is known as bound states in the continuum
(BICs). These modes, much like WG modes in a planar
waveguide, have strictly zero imaginary part and therefore infinite Q-factor or lifetime. However, unlike the WG
modes, BICs lie in the spectral range where they could
(but in reality do not) communicate with the photonic
continuum outside of the system. The second type we
call quasi-guided modes (QGMs) [7] which usually have
a very small but non-zero imaginary part of the eigenfrequency (high Q-factor), as compared to e.g. FP modes.
This is again due to the dominant role of the WG modes
in their formation, like for the BIC, while the small imaginary part is caused by the coupling between the WG
and leaky modes, see Sec. III D below for a more detailed
analysis of both types of RSs.

We also see in Fig. 3(b) some failures of the SMM,
showcasing the superiority of the RSE method. The
SMM ultimately relies on the Newton-Raphson method
of finding the poles of the S-matrix [7, 52]. This means
that it uses a small but finite tolerance playing the role
of the parameter. If the mode splitting is below the tolerance level, the SMM is unable to resolve them, such as
in region 1 of Fig. 3(b). Reducing the tolerance can fix
this issue, however, with a potential to generate at the
same time spurious solution at another place, such as in
region 2 of Fig. 3(b). The RSE in turn does not require
a tolerance and returns the correct number of RSs in a
selected region, neither missing any modes nor producing
any spurious solutions. This is an important and unique
property of the RSE, following from the completeness of
the basis used. Owing to its linearity in ω, the RSE always returns as output a set of perturbed modes which
is also complete. Furthermore, the number of perturbed
modes is always equal to the number of basis modes used.

9

(a )

6 .5
8

1

0 .0 0

6 .4

1 0

-4

1 0

-8

B IC

0 .0
3

4
7

1

5

5

6 .2
4

7

I m ( ωa )

6

i m a g ( ωa )

r e a l ( ωa )

- 0 .0 1
6 .3

6

- 0 .0 2

3

- 0 .2

- 0 .0 3
2

2
8
1

4 .9
0

2

4
2

β

- 0 .0 4
0

2

4

FIG. 6. The real and imaginary parts of the modes shown in
Fig 5(c) and four central modes in Fig 5(d) as function of the
permittivity modulation amplitude.

D.

- 0 .3

2

β

Origin and evolution of the RSs in a PC slab

Here we use the advantage of the PC-RSE being an
efficient and accurate tool for finding the complete set of
the RSs of a PC structure and study the origin of the
RSs in a PC slab, their formation and further evolution
with change of the system parameters. Here we change
the most important parameter: the amplitude of the periodic modulation β. Appendix F also presents results for
varying the thickness of the modulation layer 2b and its
period d.
Figure 5 shows the evolution of the RSs eigenfrequencies with increase of the amplitude β of the periodic modulation, which we call the perturbation strength. In the
p = 0 case treated here, all unperturbed RSs (and cut
modes) except m = 0 channel are doubly degenerate, as
discussed in Sec. III B. The periodic modulation lifts this
degeneracy, which is well seen in the figure. Furthemore,
leaky and FP modes shift upwards, increasing their Qfactors, while the majority of the RSs originating from
WG modes are moving down, away from the real axis, in
this way having their Q-factors reduced with β. Overall,
this picture demonstrates a complicated mixing of basis
modes with both infinite and finite Q-factors.
Of particular interest are RSs found close to the real
axis of ω. As mentioned in Sec. III C above, perturbing the WG modes results in two types of RSs, BICs
and QGMs. A closer look provided in Fig. 5(b-d) shows
however that BICs are formed only within the region
−2π/d < Re ω < 2π/d, bound by the cuts of the m = ±1
Bragg channels. Figure 5(b) demonstrates that each pair
of WG modes within this region produces one BIC and
one QGM, the latter loosing its quality very quickly with
the perturbation strength. Outside this region we see instead that the RSs originating from the WG modes of the
homogeneous slab have either Q-factors also quickly decreasing with β or very high Q-factors weakly depending

-2 0

-1 5

-1 0

-5

0

5

1 0

1 5

2 0

R e ( ωa )

(b )

Q G M
0 .0

I m ( ωa )

5 .0

- 0 .1

- 0 .1

- 0 .2

- 0 .3

-2 0

-1 5

-1 0

-5

0

5

1 0

1 5

2 0

R e ( ωa )
FIG. 7. Basis mode contribution to (a) bound state in the
continuum and (b) quasi-guided mode, a pair of modes originating from m = 1 WG mode and shown by black crosses
in
p
Fig. 5(c). The area of each circle is proportional to |cgn |. A
key showing the relationship between the circle area and |cgn |2
is given as black circles.

on the strength of periodic modulation. The latter can be
called quasi-BICs, the term which has recently become
widely used in the literature for such modes [53, 54]. It is
also interesting to see a formation of some of the RSs as
a result of a rather strong coupling between WG modes
which are close in frequency but belong to different Bragg
channels, see e.g in Fig. 5(b) (Fig. 5(d)) the mode repulsion due to the coupling between WG modes of m = 2
and m = 1 (m = 3 and m = 2) channels.
As already discussed in Secs. III A and III C, the perturbation does not contribute in first-order (for α = 0),
and thus the RSs eigenfrequencies change ∝ β 2 for small
β, in accordance with Eq. (38) of [27], see Fig. 6. However, in the case of the above mentioned strong coupling
between the channels, this linear in β 2 regime takes place
only at very low values of β. Another interesting feature
well seen in Fig. 6 is that the degenerate pair of basis WG
modes producing a BIC-QGM pair shows a linear in β 2

10
splitting, while any other pair of states, not containing
BICs, remains degenerate in this order. This makes BICs
even more peculiar states.
To understand this and some other properties of BICs,
we look at the basis mode contribution to different RSs.
We show in Fig. 7 the mode contribution to the BICQGM pair selected close to the cut of the 1st Bragg channel. Other types of modes – FP, leaky and cut modes –
are considered in Appendix E. The size of each circle represents how much that
pmode contributes, with the circle
area proportional to |cgn |, chosen (instead of the natural |cgn |2 ) in order to demonstrate more clearly the role
of different basis modes. We see that all the basis RSs
and cut modes of the given parity contribute to these
states, even though the relevant WG mode has the dominant and indeed very large contribution to both states.
It becomes also clear that the main difference between
the BIC and the QGM in the studied pair is that the
leaky modes of the 0th Bragg channel do not contribute
to BIC. This confirms that the BICs found in this system
are symmetry-protected [55–58].
In fact, owing to the symmetry of the system, this BIC
has a wave function which is odd in the x direction and
thus does not couple to the m = 0 channel containing
only even states. In other words, the m = 0 channel is
not present in the subgroup of odd states, and therefore
this BIC is not even falling into the continuum: For this
subgroup, the continuum starts at the cut positions of the
m = ±1 channels. Furthermore, all doubly degenerate
basis states contribute to the QGM (BIC) with the same
(opposite) amplitude, cgn = ±c−g
n , also reflecting selection
by symmetry.
Note that the other mirror symmetry of the system,
which is in the z-direction, also results in the formation
of the basis and perturbed RSs of even and odd parity.
It is clear, for example, that every other FP mode does
not contribute to the states in Fig. 7. Indeed, modes
of the opposite parity in z do not couple to each other,
and both the QGM and BIC shown in Fig. 7 are of even
parity. This implies in particular that the basis size can
be halved for this kind of perturbations.
It is also clear from Fig. 7 that the cut modes contribute very little to the perturbed BIC and QGM but
are nonetheless required for accuracy. We have seen, in
particular that including even one cut mode, representing the full cut, is far better than not including any cut
modes, despite the cut being very badly approximated.
Finally, the observed splitting ∝ β 2 within the BICQGM pair can be understood as a result of the leaky
modes of the m = 0 Bragg channel affecting (not affecting) the QGM (BIC). If it contributes, the effect of the
leaky modes appears already in the 2nd order in the perturbation β, and thus causes the splitting of the BIC and
QGM in this order.

IV.

CONCLUSIONS

The present paper offers a novel concept in the theory of photonic-crystal structures, revealing the nature
of resonances in the optical spectra and quantifying them
precisely. This concept is based on using the analytical
resonant states of a homogeneous slab, along with its cut
modes responsible for Rayleigh-Wood anomalies, as the
most natural and simple basis for expanding the resonant
states of a photonic-crystal slab. We present photoniccrystal resonant-state expansion (PC-RSE), capable of
doing this accurately and efficiently, and illustrate it on
examples of TE-polarized modes in a photonic crystal
slab with a 1D harmonic modulation. These examples
provide a proof of concept and also a verification of the
PC-RSE by comparing it with the accurate scatteringmatrix method.
We present a general formalism of the PC-RSE and
its application to dielectric photonic-crystal structures.
We demonstrate that the PC-RSE is an asymptotically
exact approach, which (i) depends on a single parameter
– truncation frequency ωmax , determining the basis size;
(ii) guarantees completeness, i.e. has no missing or spurious modes, so that any observable can be represented
as a superposition of the modes found; (iii) technically
reduces solving Maxwell’s wave equation to a matrix diagonalization, thus making the application of the PCRSE a fully automated and straightforward procedure,
not requiring any supervision. The PC-RSE provides an
accurate and efficient tool for calculating all physically
relevant eigenstates of the PC system within the selected
spectral range. In particular, it can be effectively used
repeatedly many times or in parallel, in order to investigate an arbitrarily large space of the physical parameters
characterizing the system, for revealing and optimizing
its fundamental properties. One of the immediate important applications of the PC-RSE is optimization of
photonic-crystal cavities, with a correct account of the
radiative losses of high-quality modes.
We have also demonstrated how the PC-RSE can be
used to study the origin and physical properties of the
optical modes. For illustration, we have traced the evolution of the optical modes in a photonic crystal slab
increasing the amplitude of the periodic modulation of
the permittivity, starting from a homogeneous slab with
no modulation. This allowed us, in particular, to reveal
the dominant role of the waveguide modes in the formation of bound states in the continuum and quasi-guided
modes. Furthermore, the PC-RSE allows us to quantify
precisely the contribution of each basis state to the optical mode of interest, which we have also demonstrated
in the present work.

ACKNOWLEDGMENTS

S.N. acknowledges support by the EPSRC under the
DTA scheme.

11
function in the last term. Also, Eq. (A11) contains exactly the same operator as in Eq. (A3), and therefore

Appendix A: Dyadic Green’s function of a
homogeneous slab

Let us consider arbitrary dependencies of the permittivity ε(z) and permeability µ(z) within a homogeneous
slab occupying the region |z| 6 a and surrounded by
vacuum, so that outside the slab ε = µ = 1. Denoting
the components of the dyadic GF as (Ĝp )ij = Gij (z, z 0 ),
Eq. (16) becomes



ωε ∂z −ip
G11 G12 G13
 −∂z ωµ 0   G21 G22 G23  = 1̂δ(z − z 0 ) .
ip 0 ωµ
G31 G32 G33
(A1)
Owing to the reciprocity of the optical system, the GF
has the following property:
Gij (z, z 0 ) = G†ji (z 0 , z) ,

G13 (z, z 0 ) =

1
∂z0 G11 (z, z 0 ) , (A15)
ωµ(z 0 )
ip
∂z0 G11 (z, z 0 ) ,
G32 (z, z 0 ) = G†23 (z 0 , z) = − 2
ω µ(z)µ(z 0 )
(A16)
and therefore
G12 (z, z 0 ) = G21 (z 0 , z) =

δ(z − z 0 )
1
∂z G12 (z, z 0 ) +
ωµ(z)
ωµ(z)
1
δ(z − z 0 )
= 2
∂z ∂z0 G11 (z, z 0 ) +
.
0
ω µ(z)µ(z )
ωµ(z)
(A17)

G22 (z, z 0 ) =

(A2)

(A3)
(A4)
(A5)

where the operator Û is defined as
Û (ζ; ω) = ζ(z)∂z

1
∂z + ω 2 ε(z)µ(z) − p2
ζ(z)

(A6)

G12 (z, z 0 ) = −

1
∂z G22 (z, z 0 ) ,
ωχ(z)

Û (χ; ω)G22 (z, z 0 ) = ωχ(z)δ(z − z 0 ) ,
ip
G32 (z, z 0 ) = −
G12 (z, z 0 ) ,
ωµ(z)

(A7)

p2
.
ω 2 µ(z)

G13 (z, z 0 ) = G†31 (z 0 , z) =

1̂2 + 1̂3
δ(z − z 0 ) ,
ωµ(z)

Û (µ; ω)G13 (z, z 0 ) = ipδ(z − z 0 ) ,
(A11)
1
0
0
∂z G13 (z, z ) ,
(A12)
G23 (z, z ) =
ωµ(z)
ip
δ(z − z 0 )
G33 (z, z 0 ) = −
G13 (z, z 0 ) +
,
ωµ(z)
ωµ(z)
(A13)
demonstrating in particular that the longitudinal component G33 (z, z 0 ) is divergent at z = z 0 , due to the δ

(A19)

where 1̂j are 3×3 matrices with elements (1̂j )ii0 = δii0 δij
and Ôp is a vector operator defined as

Ôp (z; ω) = 

(A9)

Note that Eq. (A8) is essentially the same as Eq. (A3),
provided that µ(z) is replaced with χ(z). Finally, for the
third column of Ĝp we obtain

(A18)

Ĝp (z, z 0 ) = Ôp (z; ω) ⊗ Ô−p (z 0 ; ω)G11 (z, z 0 )

(A8)

(A10)

ip
G11 (z, z 0 ) ,
ωµ(z 0 )

in agreement with Eq. (A14). Collecting all this information about the GF components, we find a compact
expression for the full dyadic GF:



where
χ(z) = ε(z) −

Finally,

+

with ζ(z) being a weight function. For the second column
of Ĝp , it follows from Eq. (A1) that

(A14)

Using the reciprocity Eq. (A2) and Eqs. (A4), (A12),
and (A14), we further obtain

where the adjoint † means replacing p → −p.
From Eq. (A1) we obtain for the first column of Ĝp :
Û (µ; ω)G11 (z, z 0 ; ω) = ωµ(z)δ(z − z 0 ) ,
1
G21 (z, z 0 ) =
∂z G11 (z, z 0 ) ,
ωµ(z)
ip
G31 (z, z 0 ) = −
G11 (z, z 0 ) ,
ωµ(z)

ip
G11 (z, z 0 ) .
ωµ(z 0 )

1
1
ωµ(z) ∂z
ip
− ωµ(z)


.

(A20)

Solving Eq. (A3) with outgoing boundary conditions
and studying the pole structure and the cuts of the GF in
the complex ω-plane, as done in Appendix B for a general
planar system, allows us to find the ML expansion for
G11 :
Z
X
En (z)En (z 0 )
G11 (z, z) =
,
(A21)
ω − ωn
n
and also for
Z
G11 (z, z) X En (z)En (z 0 )
g(z, z ) =
=
,
ω
ωn (ω − ωn )
n
0

(A22)

where En (z) is the only non-vanishing component (along
y) of the electric field of the RS n, satisfying an equation
Û (µ; ωn )En (z) = 0 ,

(A23)

12
or En (z) is the wave function of the cut pole, see Appendix B for details. Obviously, En (z) depends on p2 , as
so does the operator Û , and thus En (z) is not sensitive
to a change of sign of p, so that En† (z) = En (z).
Substituting Eqs. (A21) and (A22) into Eq. (A3), we
obtain a closure relation
Z
X
ε(z)
En (z)En (z 0 ) = δ(z − z 0 )
(A24)

explicitly showing that g(z, z 0 ) is an analytic function of
k. Having a countable number of simple poles in the
complex
p k-plane, which are at the RS wave numbers,
kn = ωn2 − p2 , and being vanishing at k → ∞, the GF
g(z, z 0 ) can be written as
g(z, z 0 ) =

X Rn (z, z 0 )
n

k − kn

,

(B6)

n

using the Mittag-Leffler theorem [51]. To find an explicit
form of the residue Rn (z, z 0 ) we use Maxwell’s wave equation without sources

and a sum rule
Z
X
En (z)En (z 0 )
n

ωn

= 0.

(A25)
Ûkn2 (z)En (z) = 0 ,

Using Eqs. (A21), (A24), and (A25), we obtain from
Eq. (A19) the ML expansion Eq. (18) of the full dyadic
GF, in which
Fn (z; p) = Ôp (z; ωn )En (z) .

(A26)

Note that in general, one also needs to include in Eq. (18)
for completeness longitudinal static modes, in order to
take into account the effect of the ω = 0 pole of the GF.
Appendix B: Mittag-Leffler expansion of the GF of a
general homogeneous planar system

Let us now consider the scalar GF g(z, z 0 ) of a general homogeneous system, described by arbitrary functions ε(z) and µ(z), and derive its ML expansion given
by Eq. (A22). The GF satisfies an equation
Ûk2 (z)g(z, z 0 ) = µ(z)δ(z − z 0 ) ,

(B1)

where the operator Ûk2 (z) is given by
1
∂z + k 2 ε(z)µ(z) + p2 [ε(z)µ(z) − 1] ,
µ(z)
(B2)
in accordance with it definition Eq. (A6), now written in
terms of k 2 = ω 2 − p2 .
To simplify the derivation, we assume that ε(z) =
µ(z) = 1 outside the system (|z| > a). In this case
Eq. (B2) outside the system takes the form
(B3)

with k being the normal component of the wave number in vacuum. Applying the outgoing wave boundary
conditions, we find that
g(z, z 0 ) = g(±a, z 0 )e±ikz

determining the RS wave functions En (z), as well as the
one with a source term [27, 34],
Ûk2 (z)E(z; k) = µ(z)(k − kn )σn (z) ,

(B8)

determining its analytic continuation E(z; k) in the complex k-plane about the point kn , such that E(z; kn ) =
En (z). The source σn (z) can be any function vanishing
outside the system and normalized in such a way that
Z a
En (z)σn (z)dz = kn .
(B9)
−a

In optical systems with degenerate RSs (e.g due to symmetry), such thatR kn = km for m 6= n, σn (z) is chosen in
a
such a way that −a Em (z)σn (z)dz = δnm .
Solving Eq. (B8) with the help of the GF g(z, z 0 ) and
using its ML expansion Eq. (B6), we find
X k − kn Z a
E(z; k) =
Rn (z, z 0 )σn (z 0 )dz 0 . (B10)
0
k
−
k
n
−a
0
n

Ûk2 (z) = µ(z)∂z

(∂z2 + k 2 )g(z, z 0 ) = δ(z − z 0 )

(B7)

for |z| > a and |z 0 | < a ,
(B4)
where + (−) refers to z > a (z < −a). The outgoing wave
boundary conditions for solving Eq. (B2) can therefore be
written in the following way


1
∂z ∓ ik g(z, z 0 )|z=±a = 0 ,
(B5)
µ(z)

Then taking the limit k → kn , Eq. (B10) becomes
Z a
En (z) =
Rn (z, z 0 )σn (z 0 )dz 0 ,
(B11)
−a

which can be written, after combining it with Eq. (B9),
as

Z a
En (z)En (z 0 )
0
− Rn (z, z ) σn (z 0 )dz 0 = 0 . (B12)
kn
−a
The last equation must be satisfied for any normalized
σn (z), suited for generating the analytic continuation.
Clearly, such a function is not unique, therefore the integrand in the last equation should be vanishing, which
gives Rn (z, z 0 ) = En (z)En (z 0 )/kn and results in the following series for the GF:
g(z, z 0 ) =

X En (z)En (z 0 )
n

kn (k − kn )

.

(B13)

We now find the normalization of En (z) which is determined by the ML form Eq. (B13), which in turn follows

13
from the normalization of the source Eq. (B9). We therefore use it again, substituting σn (z) from Eq. (B8) into
Eq. (B9) and subtracting a similar integral vanishing due
to Eq. (B7):
Z a
Z a
1
1
En Ûk2 Edz −
E Ûkn2 En dz
(k − kn )kn =
µ
µ
−a
−a

a
Z a
En
E
=
∂z E − ∂z En
En Eεdz ,
+ (k 2 − kn2 )
µ
µ
−a
−a
where the first term in the second line is obtained integrating by parts. Finally, using the outgoing wave boundary conditions for E and En ,


1
∂z ∓ ik E(z; k)|z=±a = 0 ,
(B14)
µ(z)


1
∂z ∓ ikn En (z)|z=±a = 0 ,
(B15)
µ(z)
similar to Eq. (B5), we arrive, after taking again the limit
k → kn , at the normalization condition for the RS wave
function:
Z a
E 2 (a) + En2 (−a)
= 1,
(B16)
2
En2 (z)ε(z)dz − n
ikn
−a
which is the same as the one provided in [17] without
proof.
Note that Eq. (B16) is equivalent to the general normalization Eq. (20) used for the TE polarization. In fact,
using Eq. (20) for z1 = −a and z2 = a and the fields replaced by their analytic continuations for the purpose of
taking the frequency derivatives, we find
Z a
 2

a
1=
εE + µ(Hx2 − Hz2 ) dz−[E∂ω Hx − Hx ∂ω E]−a ,

FIG. 8. Poles (blue dots) and cuts (red lines) of the GF
in the complex ω plane, as well the contour of integration
leading to the ML expansion Eq. (B26), which includes the
cut contributions displayed.

where, again, + (−) corresponds to z > a (z 6 −a), and
the amplitudes A± are also functions of ω or k. However,
their frequency dependence does not contribute to the
normalization, since
E∂ω Hx − Hx ∂ω E = ∓E 2 ∂ω

ik
p2 2
=∓
E .
ω
ikω 2

(B22)

Collecting all the “surface” terms and differentiating the
field outside the system, using the explicit form of E
given by Eq. (B21), we obtain

−a

[E∂z E]a−a
a
− [E∂ω Hx − Hx ∂ω E]−a +
ω2
 2


ip
ik 
=
+ 2 E 2 (a) + E 2 (−a)
2
kω
ω
E 2 (a) + E 2 (−a)
=−
,
ik

(B17)
see Eqs. (5), (A20), and (A26). Then using
Hx = −

1
∂z E ,
ωµ

Hz =

ip
E,
ωµ

(B18)

and


1
µ∂z ∂z + ω 2 εµ − p2 E = 0 ,
µ

(B19)

valid for k = kn , we find, integrating by parts:
Z a
Z a
1
1
2
2
µ(Hx − Hz )dz = 2
[(∂z E)2 + p2 E 2 ]dz
ω
µ
−a
−a

Z a 
[E∂z E]a−a
1
1
1
2 2
=
+ 2
−Eµ∂z ∂z E + p E dz
ω2
ω −a µ
µ
Z
a
a
[E∂z E]−a
=
+
εE 2 dz .
(B20)
ω2
−a
We then use the analytic form of the fields outside the
system:
E(z; k) = A± e±ikz ,

(B23)



H(z; k) = ∓

ik
E(z; k) ,
ω

(B21)

which proves that Eq. (20) results in the normalization
given by Eq. (B16).
Equation (B13) is the ML series of the GF in krepresentation. However, the RSE formulated in Sec. II
requires a ML form of the GF in the ω-representation.
Being treated as a function of frequency ω, the GF
has simple poles due to the RSs, at ω = ωn (where
ωn2 = kn2 + p2 ), which are distributed in the complex ωplane symmetrically with respect to the imaginary axis,
see Fig. 8. The residues of the GF at these poles are given
by
lim g(z, z 0 )(ω − ωn ) =

ω→ωn

=

∂ω
∂k

lim g(z, z 0 )(k − kn )

kn k→kn

kn
Rn (z, z 0 ) ,
ωn

(B24)

14
where Rn (z, z 0 ) is found earlier, see Eq. (B13).
Apart from these poles, the GF g(z, z 0 ) is analytic in
the complex k-plane, as shown above. However, in the
complex ω-plane g(z, z 0 ) has branch cuts, owing to the
link between k and ω,
p
(B25)
k = ω 2 − p2 ,

is introduced for convenience.
Now, choosing the functions f (z) and g(z) in such a
way that

with the branch points at ω = ±p. Therefore, applying
the ML theorem in the frequency plane results instead in
g(z, z 0 ) =

X En (z)En (z 0 )
n

ωn (ω − ωn )

+ I1 (z, z 0 ; ω) + I2 (z, z 0 ; ω) ,

(B26)
where the sum includes only the RSs on the selected Riemann sheet, which in our case include all the WG and
FP modes but does not contain anti-WG modes, unlike
the series in Eq. (B13). Integrals
Z ±p−i∞
∆g(z, z 0 ; ω 0 ) 0
1
dω , (B27)
I1,2 (z, z 0 ; ω) = −
2πi ±p
ω − ω0
describe the contribution of the cuts, which are chosen as
vertical straight lines in the complex ω-plane going from
the branch points ±p down to −i∞, see Fig. 8. According
to [14], this choice of the cuts almost minimizes their
contribution to the GF. The jump of the GF value across
the cut is given by the function
∆g(z, z 0 ; ω) = gk (z, z 0 ) − g−k (z, z 0 ) ,

f+ (a)f− (a) + f+ (−a)f− (−a) = 0 ,
f˙+ (a)f˙− (a) + f˙+ (−a)f˙− (−a) = 0 ,

(B33)

f+ (−a)f˙+ (a) + f+ (a)f˙+ (−a) = 0 ,
f− (−a)f˙− (a) + f− (a)f˙− (−a) = 0 ,

(B35)

−

X
1
∆g(z, z 0 ; ω) =
σs fs (z)fs (z 0 ) ,
2πi
s=±

k
1
.
2
2
˙
˙
π fs (a) + fs (−a) + k 2 [fs2 (a) + fs2 (−as)]
(B38)
This form allows us to include the contribution of the
cuts on equal footing with the RSs, treating the cuts as
continua of poles of the GF:
σs (ω) =

g(z, z 0 ) =

X En (z)En (z 0 )

where we have added index k for convenience, in order to
emphasize the fact that k is changing to −k when going
through the cut with an infinitesimal change of ω.
The jump of the GF Eq. (B28) can be evaluated in the
general case by using the explicit form of the GF,

+

s=± s0 =±

≡

s0 p

Z
X
En (z)En (z 0 )
n

ωn (ω − ωn )

Es (z; ω 0 )Es (z 0 ; ω 0 ) 0
dω
ω 0 (ω − ω 0 )

,

(B39)

where
Es (z; ω) =

p

ωσs (ω)fs (z; ω) .

(B40)

Note that in Eqs. (B38), (B39), and (B40), we have added
ω to the arguments of Es , σs , and fs , in order to emphasize their frequency dependence, earlier omitted for
brevity of notations.

Appendix C: Homogeneous slab with constant
permittivity and permeability

and
ER (z) =

ωn (ω − ωn )
X X Z s0 p−i∞

(B29)

in terms of the “left” and “right” functions, EL (z) and
ER (z), respectively. These are solution of the homogeneous wave equation (B19) and the left or right outgoing
boundary condition. More explicitly, they are given by
 −ikz
e
z < −a
EL (z) =
(B30)
B+ f+ (z) + B− f− (z) |z| < a


(B37)

where

n

EL (z< )ER (z> )
,
EL ĖR − ĖL ER

(B36)

which can always be fulfilled, for any profile µ(z), we
obtain, after simple algebra, a convenient form of the cut
integrand

(B28)

g(z, z 0 ) =

(B34)

C+ f+ (z) + C− f− (z) |z| < a
eikz
z>a

(B31)

in terms of f+ (z; ω) and f− (z; ω), two arbitrary linearly independent solutions of Eq. (B19) within the slab.
While these functions (depending on ω) do not change
when changing the sign of k, the coefficients B± and C±
do modify, leading to non-vanishing contributions to the
jump ∆g of the GF across the cuts. Here in Eq. (B29),
z< = min(z, z 0 ) and z> = max(z, z 0 ), and the derivative
Ė(z) ≡

1
∂z E(z)
µ(z)

(B32)

Consider a dielectric slab in vacuum, having thickness
2a and constant permittivity and permeability. Their
profiles in space are described by
ε(z) = 1 + ( − 1)Θ(a − |z|) ,
µ(z) = 1 + (µ − 1)Θ(a − |z|) .

(C1)
(C2)

Within the slab (|z|, |z 0 | 6 a) the GF has the form
g(z, z 0 ) = −

µ ϕ(z< )ϕ(−z> )
,
2iq
1 − ξ2

(C3)

15

(C4)
(C5)
(C6)

Clearly, the GF has poles at ξ = ±1, determining secular
equation for the RS frequencies ωn :
(qn + µkn )e−iqn a = (−1)n (qn − µkn )eiqn a .

The RS wave functions, which are the solutions of
Eq. (B7), are given by

ik z

z>a
 An e n
En (z) = Bn (e−iqn z + (−1)n e−iqn z ) |z| 6 a (C8)

(−1)n A e−ikn z
z < −a
n
with the continuity condition An = Bn (e−iqn a +
(−1)n e−iqn a )e−ikn a . The eigenvalues kn and qn are related to the eigenfrequency ωn via Eq. (C6), and the normalization constants Bn found from Eq. (B16) have the
following explicit form:


ip2 (µ − 1)
−2
n
.
(C9)
Bn = 8(−1) a +
kn (qn2 − µ2 kn2 )
For the cuts of the GF in the complex ω-plane, the
functions satisfying Eqs. (B33)–(B36) are given by
f± (z) = eiqz ± e−iqz

(C10)

within the slab |z| 6 a. They possess a definitive parity
(s = ±1) due to the mirror symmetry of the system, and
the same form as the RS wave functions Eq. (C8). According to Eq. (B38), the cut density functions are given
by
σ± (ω) =

1
µ2 k
. (C11)
2
2
2
4π (µ k − q ) cos(2qa) ± (µ2 k 2 + q 2 )
1.

0

1 0

W G
A W G
F P

to ta l M L
a n a ly tic

1 0

-1

1 0

-2

1 0

-4

1 0

-5

L M

(C7)
0

5

1 0

1 5

k a

(b )

1 0

-1

k -re p r.
ω- r e p r .
k a = 1 0

1 0

re la tiv e e rro r

ϕ(z) = eiqz + ξe−iqz ,
1 + η −2iqa
µk
e
,
ξ=
,
η=
1−η
q
q 2 = µω 2 − p2 ,
k 2 = ω 2 − p2 .

(a )
G r e e n 's f u n c t i o n |g ( z , z ') |

see Eq. (B29) in which, due to the mirror symmetry, the
left and right solutions are given by the same function,
EL (z) = ER (−z) = ϕ(z), with

-2

∝

1 0

1 0

-3

1 0

-4

1 0

-5

N

1 0

-1

1 0

-4

1 0

-7

N =
3 1 6
6 2 6
1 2 5 0
2 5 9 4

-2

1 0 0

1 0 0 0

0

N

5

1 0

1 5

k a
FIG. 9. (a) Green’s function g(z, z 0 ) of a homogeneous dielectric slab in vacuum, with  = 6, calculated for pa = 5,
z = a/2, and z 0 = −a/2 as a function k, the normal component of the wave number in vacuum. Partial contributions
of WG, anti-WG (AWG), FP modes and a leaky mode (LM)
are shown along with the sum of all the contributions and
the analytic values of the GF. (b) Relative error of the GF
calculated via Eq. (B13) as compared to its analytic values
Eq. (C3), for different number of modes N included in the
ML series. The inset shows the relative error for ka = 10
(marked by vertical dashed lines in Figs. 9(b) and 10(b)) as a
function of the basis size N .

GF in k-representation

Using the Newton-Raphson method, we have solved
the secular equation Eq. (C7) and found all the RS wave
numbers in a selected frequency range (within a circle of
radius ωmax in the complex frequency plane). The RSs
include four categories of modes: WG modes, anti-WG
modes, FP modes, and a leaky mode (LM). The WG
and anti-WG modes are present only if p 6= 0. We then
use the ML expansion Eq. (B13) in the k-representation
which includes all types of modes in the summation and
compare it with the analytic GF given by Eq. (C3)
Results for a slab with  = 6 and µ = 1 are shown
in Fig. 9 for z = −z 0 = a/2. We see that all partial

contributions to the GF due to each type of modes is nonvanishing, including that of the LM which has Re ωn = 0
and which is discussed in detail in [17, 32]. Summing up
all the contributions to the ML series Eq. (B13) results in
values of the GF approaching its analytic form Eq. (C3).
By increasing ωmax , we increase the number of RSs N
included in the series Eq. (B13), in this way making the
ML representation more and more accurate, see Fig. 9(b).
The inset demonstrate the convergence of the ML series
to the exact solution, with the error scaling as 1/N 2 .

16
0

1 0

-1

1 0

-2

1 0

-3

to ta l M L
a n a ly tic
F P

(a )

- 0 .1 7

W G
c u ts

- 0 .1 8
0

1 0

2 0

3 0

4 0

5 0

R e (k a )
1 0

-4

5

1 0
N

-1

1 0

-2

1 0

w ith o u t c u ts

to t

re la tiv e e rro r

(b )
1 0

1 0

-2

1 0

-4

1 0

-6

1 0

-8

=
3 1 6
6 2 6

1 2 5 0
2 5 9 4

1 5 2
3 0 6

5 9 8
1 1 5 8

-3

w ith c u ts

1 0
1 0

N =

1 5

ωa

re la tiv e e rro r

b a s is
e x a c t
R S E

- 0 .1 6

Im (k a )

1 0

(b )

-1 0

1

-4

1 0

1 0 0

R e (k a )
1 0

-5

6

1 0

-6

4
5

1 0


FIG. 10.
(a) As Fig. 9(a) but in the ω-representation, in
which the AWG modes and the LM do not contribute to the
ML expansion Eq. (B39), but there is instead an additional
component due to the cuts. (b) Relative error of the GF
calculated via Eq. (B39) as compared to its analytic values
Eq. (C3), for different number of modes N included in the
ML series, with and without contribution of the cuts.

2.

(c )

GF in ω-representation

The GF can also be represented as a function of frequency. However, the square root in Eq. (B25) causes
branch cuts at ω = ±p, which separates the frequency
plane into two Riemann sheets with modes split across
both sheets. Only the modes found on one of the sheets
are taken into account. This is chosen to be the “physical” sheet, on which the WG and FP modes are found,
while anti-WG modes and the leaky mode turn out to be
on the other, unphysical sheet and are thus excluded from
the ML expansion Eq. (B39). Figure 10 shows a comparison, for the same parameters as in Fig. 9, of the ML
expansion Eq. (B39) with the analytic solution Eq. (C3),
again showing different contributions, including WG, FP
modes, and the cuts. We see that the ML series in the
ω-representation again converges to the exact solution,
provided that the cut integrals are included. Note also

(d )
W G

1 5

a

2

Im (k a )

G r e e n 's f u n c t i o n |g ( z , z ') |

(a )

F P

0
-2
-4
-6
1 0

b a s is
e x a c t
R S E

A W G

-1 2

1 0

-1 0

1 0

-8

re la tiv e e rro r

1 0

-6

0

2

4

6

R e (k a )

FIG. 11. (a) Wave numbers kn of the FP modes calculated
for pa = 5 using the RSE in the k-representation (red crosses)
for the core-shell dielectric slab with  = 6, ∆ = 1, and
b = a/2, along with the exact solution (blue squares) and
the basis RSs (black circles with dots). (b) Relative error for
the wave numbers of the FP modes compared to the exact
solution, for different basis sizes as given. (c) Relative errors
for WG and anti-WG modes, for the same basis sizes as in
(b). (d) As (a) but for all WG and anti-WG modes, and the
first few FP modes.

that the convergence is very similar to that in the krepresentation, as it is clear from the inset in Fig. 9(b).
In fact, in both cases the error alternates between two
different boundaries but nevertheless decreases with the
basis size as N −2 .

17
0 .0 0 6

(a )

0 .0 0
W G

0 .0 0 4

b a s is
e x a c t
R S E w
R S E w
e v e n c
o d d c u

p a = 1 0 :

σ+

σ+

σ−

σ−

e v e n s ta te s
o d d s ta te s

e v e n s ta te s
o d d s ta te s

- 0 .0 5

I m (ωa )

c u t p o le w e ig h t σ

p a = 5 :

- 0 .1 0
c u t

- 0 .1 5

0 .0 0 2

ith o u t c u ts
ith c u ts
u t p o le s
t p o le

F P

0

5

1 0

1 5

R e ( ωa )
0 .0 0 0

0 .0

0 .5

1 .0

(b )

FIG. 12. Cut weights σ± (solid and dashed lines) as functions
of the imaginary part of the frequency along the cut, for different values of p as given, along with the discretized cut pole
values Cν /∆ων (circles).

re la tiv e e rro r

- I m ( ωa )

1 0

-2

1 0

-4

1 0

-6

1 0

-8

w ith /w ith o u t c u ts :
/

c u t

N = 1 5 4 3 0 6

6 0 5 1 2 2 2

F = 1

Appendix D: RSE for a homogeneous core slab

∆ε(z) = ∆Θ(b − |z|) .

(D1)

The perturbed system presents a core-shell slab consisting of three homogeneous regions. The secular equation
for this system has the following analytic form:

1 0

-2

(c )

1.

RSE in k-representation

In the k-representation, the RSE equation for treating
planar homogeneous systems is given by Eq. (22) of [17],
which we write here as

X
X
p2
k
(δnn0 + Vnn0 ) cn0 =
kn δnn0 +
Vnn0 cn0 ,
kn
n0
n0
(D3)
00
with the matrix elements Vnn0 = Vnn
0 given by Eq. (33)
for g = g 0 = 0.
Its application to the perturbation given by Eq. (D1)
is shown in Fig. 11, in comparison with the exact solution Eq. (D2) and the basis RSs of the homogenous slab.

5

N
1 0

-4

1 0

-6

1 0

1 0 0

to t

= 1 0 0 0

F =
5
2

1 0

-8

1
0 .1
0

1 0

(γ+ λ− − γ− λ+ ) eiq1 b ± (γ+ λ+ − γ− λ− ) e−iq1 b = 0 ,
(D2)
where
γ± = (q ± k)e∓iq(a−b) , λ± = q ± q1 , and q1 =
p
1 ω 2 − p2 with 1 =  + ∆. The secular equation (C7)
for the homogeneous slab can be restored by setting b = a
and q = q1 , or simply b = 0.

0

R e ( ωa )

re la tiv e e rro r

Here we demonstrate how the RSE in the k- and ωrepresentations is applied to a homogeneous perturbation. This is a special case of the PC-RSE which allows
an exact analytic solution, but obviously lacking any periodic modulations. We use α = ∆ and β = 0 in Eq. (32).
The perturbation of the permittivity thus has the form

1 0

-1 0

-1 0

0

5

1 0

1 0 0

R e ( ωa )
FIG. 13. (a) As Fig. 11 but in frequency representation, also
showing even and odd parity cut modes. (b) Relative errors
compared to the exact solution Eq. (D2) of the RS frequencies
calculated using the RSE, with and without cut modes in the
basis and for different basis sizes as given. (c) Relative error
of the RSE results calculated for a fixed basis size Ntot = 1000
and different values of F , the ratio of the number of cut modes
to the number of RSs in the basis.

The quasi-periodic pattern of the wave numbers of the
perturbed RSs seen in Fig. 11 is caused by the perturbation covering only the middle half of the slab, so that
the original homogeneous slab of thickness 2a is now split
into three subsystems of thickness a/2, a, and a/2, each
acting as a resonance cavity. The distance in frequency
between the modes is given by a fundamental period of
π/(2a) as in the basis cavity, but the cavities between −a
and −b and between b and a have caused additional quasiperiodicities, one of them having the period of π/(a − b),

18
F P

L e a k y
0 .0

I m ( ωa )

I m ( ωa )

0 .0

- 0 .1

- 0 .2

- 0 .3

- 0 .1

- 0 .2

-2 0

-1 5

-1 0

-5

0

5

1 0

1 5

- 0 .3

2 0

-2 0

-1 5

-1 0

-5

0

R e ( ωa )

5

1 0

F P

c u t m o d e
0 .0

I m ( ωa )

I m ( ωa )

2 0

R e ( ωa )

0 .0

- 0 .1

- 0 .2

- 0 .3

1 5

- 0 .1

- 0 .2

-2 0

-1 5

-1 0

-5

0

5

1 0

1 5

2 0

- 0 .3

-2 0

-1 5

-1 0

-5

0

R e ( ωa )
FIG. 14. As Fig. 7 but for two RSs originating from a degenerate pair of FP modes.

which for b = a/2 is four times larger than the fundamental period. Other cavities present in the system also
contribute to the rich spectrum of RSs seen in Fig. 11.
Looking at the relative error shown in Figs. 11(b) and
(c), we see that the RSE in the k-representation quickly
converges to the exact solution. The relative error scales
as 1/N 3 , which is typical for effective 1D systems, see [17,
26, 27, 30, 31].

2.

RSE in ω-representation

The RSE equation in this case is given by the general
formula Eq. (23) of the PC-RSE, but since this is a homogeneous perturbation, there is no mixing of channels, so
we use again g = g 0 = 0. Also, Eq. (23) includes the contribution of the cuts which need to be discretized, giving
rise to cut modes to be used in the RSE on equal footing
with the RSs.
The discretization of the cuts is done following the procedure described in [14, 31]. For each parity s, the cut
with the branch point at ω = p is divided into Nc in-

5

1 0

1 5

2 0

R e ( ωa )
FIG. 15. As Fig. 7 but for a RS coming from a non-degenerate
m = 0 leaky mode (top) and for a perturbed cut mode (bottom).

tervals bounded by [ω̃ν , ω̃ν+2 ], where ν is even (odd) for
s = + (s = −), with a weight given by
ω̃ν+2

Z
Ws =

p

|σs (ω)|dω ,

(D4)

ω̃ν

where ω̃1 = ω̃2 = p and ω̃2Nc +1 = ω̃2Nc +2 = p − i∞
The cut is split into finite intervals in such a way that
Ws is the same for each interval (for the given parity s).
Within each interval, an artificial cut mode is defined at
the frequency ων , given by
Z

1
ων =
Cν

ω̃ν+2

σs (ω)ωdω

(D5)

ω̃ν

with ν = 1, 2, . . . , 2Nc , where s = (−1)ν and
Z

ω̃ν+2

σs (ω)dω .

Cν =

(D6)

ω̃ν

Applying the same discretization to the other cut with
the branch point at ω = −p and extending the ν numbers

19

(a )

(a )

0 .0 0

0 .0 0

- 0 .1 0

- 0 .0 5

I m (ωa )

I m (ωa )

d = d 0/5

R S E :
b /a =
0 .7 5
0 .9
0 .9 5

- 0 .0 5

b a s is R S s
c u t p o le s

- 0 .1 5

- 0 .1 5

- 0 .2 0

b a s is R S s
c u t p o le s
R S E

- 0 .1 0

- 0 .2 0

0

5

1 0

0

1 0

2 0

R e ( ωa )

re la tiv e e rro r

1 0

-3

b = 0 .9 5 a / b =
N =
/
4 7
/
9 8
/
1 9 2

1 0

-5

1 0

-7

1 0

-9

(b )

0 .5 a :

1 0

-2

1 0

-4

4 0

5 0

6 0

1 0

-6

1 0

-8

N =

8
4
0

re la tiv e e rro r

(b )

3 0

R e ( ωa )

1 0

0

5

R e ( ωa )

1 0

2 0

3 0

FIG. 16. (a) RS frequencies of a PC slab with  = 6, α = 0,
β = 1, d = 2π/5, and p = 0, calculated for F = 1 and M = 5
via the PC-RSE for different values of b as given. Unperturbed
RSs and cut modes are also shown (black circles with dots and
black dots, respectively). (b) Relative error of the PC-RSE
compared to the SMM result, taking the latter as “exact”,
calculated for different values of b and different basis sizes N
as given.

to negative integers, the ML expansion Eq. (B39) takes
the form
g(z, z 0 ) ≈

X En̄ (z)En̄ (z 0 )
n̄

ωn̄ (ω − ωn̄ )

(D7)

where
(
n
n̄ =
ν

for RSs
for cut modes

(D8)

and
En̄ (z) = Bn̄ (eiqn̄ z + (−1)n̄ e−iqn̄ z )

|z| 6 a ,

(D9)

with the normalization constant Bn for the RSs given by
Eq. (C9) and for the cut modes by
p
Bν = ων Cν ,
(D10)

5 0 8
1 0 0 0
2 0 0 2

-1 0

1

1 0

1 0 0

R e ( ωa )
FIG. 17. (a) RS frequencies of a PC slab with  = 6, α = 0,
β = 1, d = 2π/25, and p = 0, calculated for F = 1 via the PCRSE (red crosses). Unperturbed RSs and cut modes are also
shown (black circles with dots and black dots, respectively).
(b) Relative error of the PC-RSE compared to the RSE with
N ≈ 4000, taking the latter as “exact”, calculated for different
basis sizes as given.

where Cν is defined in Eq. (D6). Using Eq. (D6), we can
graphically show in Fig. 12 how these artificial cut modes
compensate for the cut, comparing σν (ω) with Cν /∆ων ,
where ∆ων = ω̃ν+2 − ω̃ν is the interval of integration.
With these modes added to the basis, the RSE can
now be performed in the ω-representation using Eq. (28)
with the index g dropped:
X
ω
(δn̄n̄0 + Vn̄n̄0 ) cn̄0 = ωn̄ cn̄ .
(D11)
n̄0

Figure 13(a) shows the RS frequencies calculated using
the RSE equation (D11), with and without cut modes
in the basis. The unperturbed RSs and even- and oddparity cut modes of the basis are also shown. The distribution of perturbed RSs repeats the oscillatory pattern
seen in Fig. 11(a) and discussed above. The RSE frequencies match well the analytic values given by Eq. (D2) even
if the cut modes are not taken into account. In fact, in
this case the relative error is still rather low, as can be

20
of the PC-RSE and found the same optimal value of F .
Therefore, unless stated differently, the value of F = 1 is
used in all calculations throughout this paper.

(a )
0 .0 0
d = 5 d
0

I m (ωa )

- 0 .0 5

Appendix E: Mode Contributions

b a s is R S s
c u t p o le s
R S E

- 0 .1 0

- 0 .1 5

- 0 .2 0
0

1

2

3

R e ( ωa )

(b )

1 0

-1

1 0

-3

1 0

-5

1 0

-7

1 0

-9

re la tiv e e rro r

N =
4 7 8
1 0 3 2
2 1 2 6

In addition to Fig. 7 of the main text, showing the expansion coefficients for a BIC-QGM pair, Figs. 14 and 15
of this Appendix show basis mode contributions for three
other types of modes: FP, leaky, and cut modes. Similar
to the BIC-QGM pair in Fig. 7, two perturbed FP RSs in
Fig. 14 originate from a pair of degenerate unperturbed
FP modes, and only one of them has a nonzero contribution of m = 0 leaky modes. This makes the Q-factor
for that mode slightly lower than for the other one, not
affected by any m = 0 modes due to symmetry. Interestingly, both perturbed modes are almost equally strongly
influenced by a pair of FP and a pair of WG basis modes
matching the perturbed mode frequency.
Like in Fig. 7, the leaky and cut modes shown in Fig. 15
have a dominant contribution of only one basis mode (or
one pair of modes), while the contribution of any other
mode in the basis does not exceed a few per mille.

Appendix F: Other parameters
1

1 0

R e ( ωa )
FIG. 18. As Fig. 17 but for d = 2π.

seen in Fig. 13(b). Obviously, it is higher for the modes
which are close to cut and is not improving for these
modes with increasing N , the number of the RSs in the
basis. Including the cut modes in the RSE results in a
relative error decreasing with N as 1/N 3 , almost uniformly for all the RSs, which is essentially the same as in
the RSE used in the k-representation.
The total number of modes in the basis is given by
Ntot = N + 4Nc = (1 + F )N , where we have introduced
the factor F , the ratio of the number of cut modes to
the number of RSs included. In Fig. 13(c) we show how
the error depends on F for a fixed Ntot . Higher values
of F imply more cut modes included in the basis at the
expense of RSs. It is clear that larger values of F give
generally lower errors for the RSs close to the cut. However, modes with larger frequencies away from the cut
are less accurately determined in this case, as the number of basis RSs N reduces with F . We found that the
value F = 1 is close to the optimal one, as all RSs in
a wide spectral range have a similar level of errors. We
have made a similar study of the relative error in the case

We finally study the dependence of the RS frequencies
calculated via the PC-RSE and their errors on the two
structural parameters of the PC slab: the half width of
the core layer b and the period of modulation d, while
keeping  = 6, α = 0, β = 1, and p = 0 as before.
Increasing b from half-width (b = a/2) to the full-width
value (b = a) does not lead to any significant changes in
the spectrum, as one can see in Fig. 16(a). The relative
error is however getting sensitive to b as b → a. In fact,
the error in Fig. 16(b) shows that the case of b = 0.95a
can produce up to an order of magnitude higher errors
(relative to the SMM) compared to the system with b =
0.5a. The reason for this increase is related to the ML
series changing its convergence properties on the borders
of the system, which requires a further study. Presently,
it prevents the PC-RSE from being used with exactly
b = a.
Figures 17 and 18 show the RS frequencies and the
relative error for the period of modulation d, respectively,
5 times smaller and 5 time larger than that used for Fig. 3.
Such changed of the period change the spectrum of the
RSs dramatically, so for instance, in the first case the
number of RSs per cut is much larger than in Fig. 3 and
in the second case – much smaller. Nevertheless, the PCRSE is working equally well in all these cases, as we can
see from almost the same level of errors.

21

[1] L. Liu, M. Pu, K. Yvind, and J. M. Hvam, Appl. Phys.
Lett. 96, 051126 (2010).
[2] S. J. Mcnab, N. Moll, and Y. A. Vlasov, Opt. Soc. 299,
358 (2003).
[3] A. R. Mcgurn, Phys. Rev. B 61, 13235 (2000).
[4] M. Bayindir, B. Temelkuran, and E. Ozbay, Appl. Phys.
Lett. 77, 3902 (2000).
[5] E. Yablonovitch, T. J. Gmitter, and K. M. Leung, Phys.
Rev. Lett. 67, 2295 (1991).
[6] D. M. Whittaker and I. S. Culshaw, Phys. Rev. B 60,
2610 (1999).
[7] S. G. Tikhodeev et al., Phys. Rev. B 66, 045102 (2002).
[8] S. Fan and J. D. Joannopoulos, Phys. Rev. B 65, 235112
(2002).
[9] W. Zhou et al., Prog. Quant. Electr. 38, 1 (2014).
[10] G. Gamow, Z. Phys. 51, 204 (1928).
[11] A. F. J. Siegert, Phys. Rev. 56, 750 (1939).
[12] L. A. Weinstein, Open resonators and open waveguides
(Golden press, Boulder, Col., Boulder, 1969).
[13] R. W. Wood, Phil. Mag. 4, 396 (1902).
[14] S. V. Lobanov, G. Zoriniants, W. Langbein, and E. A.
Muljarov, Phys. Rev. A 95, 053848 (2017).
[15] A. Gras, W. Yan, and P. Lalanne, Opt. Lett. 44, 3494
(2019).
[16] A. B. Akimov, N. A. Gippius, and S. G. Tikhodeev,
JETP Lett. 93, 427 (2011).
[17] L. J. Armitage, M. B. Doost, W. Langbein, and E. A.
Muljarov, Phys. Rev. A 89, 053832 (2014).
[18] A. O. Govorov et al., Nano Letters 10, 1374 (2010).
[19] T. Weiss et al., Phys. Rev. Lett. 116, 237401 (2016).
[20] T. Weiss et al., Phys. Rev. B 96, 045129 (2017).
[21] F. Vollmer and S. Arnold, Nat. Meth. 5, 591 (2008).
[22] F. Vollmer et al., Appl. Phys. Lett. 80, 4057 (2002).
[23] M. Rosenblit, P. Horak, S. Helsby, and R. Folman, Phys.
Rev. A 70, 053808 (2004).
[24] N. C. Frateschi and A. F. J. Levi, Appl. Phys. Lett. 66,
2932 (1995).
[25] P. Lalanne et al., Laser Phot. Rev. 12, 1700113 (2018).
[26] A. Muljarov, W. Langbein, and R. Zimmermann, Europhys Lett. 92, 50010 (2010).
[27] M. B. Doost, W. Langbein, and E. A. Muljarov, Phys.
Rev. A 90, 013834 (2014).
[28] C. Sauvan, J. P. Hugonin, I. S. Maksymov, and P.
Lalanne, Phys. Rev. Lett. 110, 237401 (2013).
[29] D. Floess et al., Phys. Rev. X 7, 021048 (2017).
[30] M. B. Doost, W. Langbein, and E. A. Muljarov, Phys.
Rev. A 85, 023835 (2012).
[31] M. B. Doost, W. Langbein, and E. A. Muljarov, Phys.

Rev. A 87, 043827 (2013).
[32] L. J. Armitage, M. B. Doost, W. Langbein, and E. A.
Muljarov, Phys. Rev. A 97, 049901 (2018).
[33] E. A. Muljarov and W. Langbein, Phys. Rev. B 93,
075417 (2016).
[34] E. A. Muljarov and T. Weiss, Opt. Lett. 43, 1978 (2018).
[35] N. W. Ashcroft and N. D. Mermin, Solid state physics
(Saunders College, Philadelphia, 1976), Chap. 8, pp.
132–140.
[36] L. C. Andreani and D. Gerace, Phys. Rev. B 73, 235114
(2006).
[37] M. Minkov and V. Savona, Sci. Rep. 4, 5124 (2014), article.
[38] W. Yan, R. Faggiani, and P. Lalanne, Phys. Rev. B 97,
205422 (2018).
[39] S. V. Lobanov, W. Langbein, and E. A. Muljarov, Phys.
Rev. A 98, 033820 (2018).
[40] T. Weiss and E. A. Muljarov, Phys. Rev. B 98, 085433
(2018).
[41] P. Lalanne and E. Silberstein, Opt. Lett. 25, 1092 (2000).
[42] E. Silberstein, P. Lalanne, J.-P. Hugonin, and Q. Cao, J.
Opt. Soc. Am. A 18, 2865 (2001).
[43] L. Li, Journal of Optics A: Pure and Applied Optics 5,
345 (2003).
[44] T. Weiss et al., J. Opt. 11, 114019 (2009).
[45] X. Gao et al., Sci. Rep. 6, 31908 (2016).
[46] J. von Neumann and E. Wigner, Phys. Z. 30, 467 (1929).
[47] D. C. Marinica and A. G. Borisov, Phys. Rev. Lett. 100,
183902 (2008).
[48] E. N. Bulgakov and A. F. Sadreev, Phys. Rev. B 78,
075105 (2008).
[49] N. Moiseyev, Phys. Rev. Lett. 102, 167404 (2009).
[50] Y. Plotnik et al., Phys. Rev. Lett. 107, 28 (2011).
[51] G. B. Arfken and H. J. Weber, Mathematical Methods
for Physicists, 5th edition (Academic Press, San Diego,
2001), p. 448.
[52] D. A. Bykov and L. L. Doskolovich, J. Lightwave Tech.
31, 793 (2013).
[53] A. Taghizadeh and I.-S. Chung, Appl. Phys. Lett. 111,
031114 (2017).
[54] E. N. Bulgakov and A. F. Sadreev, Phys. Rev. A 99,
033851 (2019).
[55] E. N. Bulgakov and A. F. Sadreev, Phys. Rev. A 90,
053801 (2014).
[56] B. Zhen, C. W. Hsu, L. Lu, and A. D. Stone, Phys. Rev.
B 113, 1 (2014).
[57] C. W. Hsu et al., Nat. Rev. Mat. 1, 1 (2016).
[58] D. A. Bykov, E. A. Bezus, and L. L. Doskolovich, Phys.
Rev. A 99, 063805 (2019).

