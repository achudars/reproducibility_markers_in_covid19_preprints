MNRAS 000, 1–24 (2019)

Preprint 24 January 2019

Compiled using MNRAS LATEX style file v3.0

Stochastic modeling of star-formation histories I:
the scatter of the star-forming main sequence
Neven Caplar,1? Sandro Tacchella,2 †
1 Department

of Astrophysical Sciences, Princeton University, 4 Ivy Ln., Princeton, NJ 08544, USA
Center for Astrophysics, 60 Garden Street, Cambridge, MA 02138, USA

arXiv:1901.07556v1 [astro-ph.GA] 22 Jan 2019

2 Harvard-Smithsonian

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT

We present a framework for modelling the star-formation histories of galaxies as a
stochastic process. We define this stochastic process through a power spectrum density
with a functional form of a broken power-law. Star-formation histories are correlated
on short timescales, the strength of this correlation described by a power-law slope,
α, and they decorrelate to resemble white noise over a timescale that is proportional
to the timescale of the break in the power spectrum density, τbreak . We use this framework to explore the properties of the stochastic process that, we assume, gives rise to
the log-normal scatter about the relationship between star-formation rate and stellar
mass, the so-called galaxy star-forming main sequence. Specifically, we show how the
measurements of the normalisation and width (σMS ) of the main sequence, measured in
several passbands that probe different timescales, give a constraint on the parameters
of the underlying power spectrum density. We first derive these results analytically
for a simplified case where we model observations by averaging over the recent starformation history. We then run numerical simulations to find results for more realistic
observational cases. As a proof of concept, we use observational estimates of the main
sequence scatter at z ∼ 0 and M? ≈ 1010 M measured in Hα, UV+IR and the u-band,
Myr, when assuming
and show that combination of these point to τbreak = 178+104
−66
α = 2. This implies that star-formation histories of galaxies lose “memory” of their
previous activity on a timescale of ∼ 200 Myr, highlighting the importance of baryonic
effects that act over the dynamical timescales of galaxies.
Key words: galaxies: evolution – galaxies: star formation – galaxies: statistics

1

INTRODUCTION

Recent observational studies have produced a wealth of data
on galaxy populations at different epochs. This has enabled
us to study galaxies in a statistical manner and explore
scaling relations between a wide range of galaxy properties,
such as luminosity, color, stellar mass, size, velocity dispersion, and central stellar mass density, with cosmic time (e.g.,
Faber & Jackson 1976; Kormendy 1977; Djorgovski & Davis
1987; Baldry et al. 2004; van der Wel et al. 2014; Mosleh
et al. 2017; Barro et al. 2017). However, how and why individual galaxies change their physical properties and evolve to
create such scaling relations is still unclear, since we observe
each individual galaxy only once during its cosmic lifetime.
A possible way forward is the use of analytical and numerical models. A large body of theoretical work, including

?

E-mail: ncaplar@princeton.edu
† E-mail: sandro.tacchella@cfa.harvard.edu

© 2019 The Authors

cosmological simulations, has been developed aiming to explain the evolving galaxy properties and constrain physical
mechanisms that give rise to the observations (e.g., Vogelsberger et al. 2014; Hopkins et al. 2014; Ceverino et al. 2014;
Porter et al. 2014; Henriques et al. 2015; Schaye et al. 2015;
Pillepich et al. 2018). Currently, such models still have relatively limited predictive power because of the inadequate
spatial/mass/temporal resolution, producing small galaxy
samples and/or the uncertainties associated with the “subgrid” physics (e.g., Somerville & Davé 2015).
Another way forward is based on observations: precise
evaluation of the number densities of different types of galaxies, coupled with continuity equations, can be used to construct high-fidelity phenomenological models that explain
a large number of observed features in the Universe (Peng
et al. 2010; Leitner 2012; Carollo et al. 2013; Damjanov et al.
2014; Kelson 2014; Caplar et al. 2015; Kelson et al. 2016;
Caplar et al. 2018). Additionally, galaxy stellar ages can be
used to understand how galaxies relate to their precursors at

2

Caplar & Tacchella

earlier epochs to constrain, for example, the mechanism responsible for the change in morphology (Fagioli et al. 2016;
Williams et al. 2017; Tacchella et al. 2017; Zahid & Geller
2017; Damjanov et al. 2018).
More general than simple “ages” are star-formation histories (SFH), which are one of the critical ingredients needed
to understand the evolution of galaxies. Having the full information on how galaxies change their star-formation rate
(SFR) as a function of cosmic time would allow us to project
the galaxy back in time and understand on which timescales
the galaxy grew its mass as a consequence of star formation.
Furthermore, SFHs encode information about the variability on short and long timescales that arise from different
physical mechanisms. There are several physical processes –
acting on different timescales – that can increase the SFR,
such as gas accretion or mergers, and that can decrease the
SFR, such as ram pressure stripping of gas or feedback from
black holes and stars.
SFHs are related to the scaling relation between the
SFRs and stellar masses (M?) of galaxies: observational
studies have produced a consensus that since at least redshift
3, the majority of star-forming galaxies have a SFR that is
β
strongly correlated with their mass (SFR ∝ M? , with β ∼ 1),
creating the so-called star-forming main sequence (MS). It
has been established that the MS normalization increases
with the look-back time as (1 + z)∼2.2 (Brinchmann et al.
2004; Daddi et al. 2007; Elbaz et al. 2007; Noeske et al.
2007; Whitaker et al. 2012; Speagle et al. 2014; Schreiber
et al. 2015; Boogaard et al. 2018). This increase of the overall
normalization of the MS with lookback time can be understood by the higher dark matter accretion rate onto halos,
which leads to higher gas fractions in high-redshift galaxies
(Lilly et al. 2013; Tacconi et al. 2013; Tacchella et al. 2013,
2018; Genzel et al. 2015; Rodrı́guez-Puebla et al. 2016).
The most noticeable feature is that the MS relation at any given redshift shows a rather small scatter of
σMS ∼ 0.2 − 0.4 dex, depending on the exact definition of
star-forming galaxies and the method used to infer SFRs
and stellar masses. This rather small scatter has been used
to argue that the SFRs of galaxies on the MS are sustained
for extended periods of time in a quasi-steady state of gas inflow, gas outflow, and gas consumption (Bouché et al. 2010;
Daddi et al. 2010; Genzel et al. 2010; Davé et al. 2012; Lilly
et al. 2013; Dekel & Mandelker 2014; Tacchella et al. 2016;
Rodrı́guez-Puebla et al. 2016). Clearly, the MS scatter is
directly related to the variability in the SFH and hence encodes physical mechanisms acting on different timescales.
In general terms, Abramson et al. (2015, see also Muñoz &
Peeples 2015) highlights that if the MS scatter arises due
to short-term fluctuations, star-forming galaxies with similar mass mostly grew-up together, while if the MS scatter arises due to long-term fluctuations (Peng et al. 2010;
Behroozi et al. 2013) then star-forming galaxies with similar mass did not grow-up together and key physics lies in
the process that diversifies star formation histories (Gladders et al. 2013; Kelson 2014).
Based on cosmological zoom-in simulations (VELA simulations; Ceverino et al. 2014; Zolotov et al. 2015), Tacchella et al. (2016) suggested that star-forming galaxies with
M? ≈ 109 − 1011 M oscillate about the MS ridgeline on
timescales of ≤ 2 Gyr at z ∼ 1 − 4. The propagation of galaxies upwards toward the upper envelope of the MS is due to

gas compaction, triggered by e.g., mergers, counter-rotating
streams, and/or violent disk instabilities. The downturn at
the upper envelope is due to central gas depletion by peak
star formation and outflows while inflow from the shrunken
gas disk is suppressed. Rodrı́guez-Puebla et al. (2016) argue,
based on advanced abundance matching, that the MS scatter could be set by the halo mass accretion rate, which itself
has a scatter of ∼ 0.3 dex, matching the observed dispersion
of the MS. Matthee & Schaye (2018) show, based on the EAGLE simulations, that the scatter of the MS at z ∼ 0 origi< 1 Gyr) that
nates from a combination of short timescales ( ∼
are presumably associated with self-regulation from cooling,
star formation and outflows, and long time-scale (∼ 10 Gyr)
variations related to differences in halo formation times. Torrey et al. (2018) show, based on the IllustrisTNG simulations, that galaxy offsets from the MS and mass-metallicity
relation oscillate over similar time-scales (roughly the dynamical time of the dark matter halo) and are often anticorrelated. They speculate that the SFR and metallicity
evolution tracks may become decoupled in galaxy formation
models dominated by feedback-driven globally bursty SFHs,
which could weaken the FMR residual correlation strength.
It is well-known that measurements of star-formation
rate in different observed bands carry different information,
with shorter wavelengths carrying more information about
recent star-formation, and longer wavelengths being more
sensitive to star-formation on longer timescales. However,
measuring SFHs from the observed spectral energy distribution (SED) of galaxies is still very challenging (Conroy 2013).
State-of-the-art SED fitting codes are nowadays able to fit
non-parametric SFHs to the galaxy SEDs and provide constraints of the SFHs on timescales of 100 Myr to a few Gyrs,
i.e., on rather long timescales (Thomas et al. 2005; Graves &
Schiavon 2008; Davies et al. 2015; Pacifici et al. 2016; Iyer &
Gawiser 2017; Leja et al. 2018a; Carnall et al. 2018). Short
timescales can in principle be inferred from comparing nebular lines to the ultraviolet (UV) continuum. For instance,
Weisz et al. (2012) and Guo et al. (2016) inferred a systematic decline and increased scatter in nebular line to FUV ratios toward low-mass systems. They interpreted their data
with simple SFH models that included bursts lasting tens
of Myr, and with periods of ∼ 250 Myr, finding that these
low mass galaxies are rather “bursty”. However, large uncertainties remain, including variations of the initial mass
function (IMF), differential dust attenuation distribution in
front of young and old stars, and metallicity effects (e.g.,
Shivaei et al. 2018).
All this research implies that galaxies exhibits wide
range of SFHs, exhibiting bursts, drops and periods nonchanging star-formation. In this work, we propose to model
the time-dependence of star formation and the movement of
star-forming galaxies around the MS ridgeline as a purely
stochastic process. We aim to describe the stochastic behaviour in very general terms and therefore define its properties in the frequency domain through a power spectrum
density (PSD) that is modelled as a broken power-law. The
high-frequency slope of the PSD determines how quickly the
SFR changes on short timescales and is going to be connected with physical drivers of star-formation. The broken
power-law form allows for a break in the correlation, i.e.,
sets up a timescale on which the SFR in a single galaxy
loses “memory” of previous star-formation.
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
We note that this timescale can, in principle, be longer
than the timescale of the Universe. In that case, the PSD is
effectively a pure power-law for all practical purposes and
the star-formation in a given galaxy has a “long-term dependence”, i.e., it is correlated over the cosmic timescales.
This process, with a single power-law slope, is used by Kelson (2014) to model stellar mass growth in the Universe.
He described the SFHs using a so-called “Hurst parameter”,
which is very closely related to the slope of the PSD used
in this work. We discuss the connection between describing the stochastic process via the PSD with a broken power
law (and its high-frequency slope) and the description using
“Hurst parameter” more extensively in Appendix A.
In this paper we focus on the Myr to a Gyr timescale
and exclude the longer timescales in the analysis, which we
believe set the overall evolution of the MS. Characterisation
of the PSD on these “short” scales is critical for a couple of
reasons. Firstly, it provides a test for simulations, which aim
to match various distributions (e.g., galaxy mass function)
over a span of redshifts, but do not necessarily aim to match
stochasticity of star-formation with cosmic time. Secondly,
the recovered parameters of the underlying stochastic process are connected to the physical drivers of star-formation
and can provide valuable insight into the properties of starformation. In particular, the timescale of the break in the
PSD should be connected with the timescale on which starformation due to internal galaxy properties becomes less important compared to external feeding of the galaxy. For an
example in a related field, stochastic modelling of the shortterm variability (∼ 1 year) of active galactic nuclei (AGN)
is one the main methods to explore physical processes powering AGN (Kelly et al. 2009; MacLeod et al. 2010; Dexter & Agol 2011; MacLeod et al. 2012; Simm et al. 2016;
Caplar et al. 2017), and is providing serious challenges to
standard viscous accretion disk models commonly used to
model AGN accretion (see review by Lawrence 2018). Finally, understanding the variability of the SFR on short
timescale is crucial for proper SED fitting, as the characteristic timescale on which SFR varies is directly related to
the size of parameter confidence intervals (Leja et al. 2018b).
In this work we lay the basic groundwork of our approach and conduct a simple analysis of the observations
in order to constrain the PSD. We focus our investigation on rather massive star-forming galaxies with M? ≈
1010 − 1010.5 M . We work in this rather narrow mass range
because measurement errors are the small, fraction of galaxies that are quenching is negligible, and result are being
less affected by possible variations of dust attenuation with
galaxies mass (as elaborated in Section 5). In a companion paper (Iyer et al. in prep.), we analyse and measure the
PSDs for a wide range of numerical (cosmological and zoomin simulations) and semi-analytical models. We find that
PSDs are well described by a broken power-law, where the
short timescales (high frequencies) follow ∝ f α and above
a certain decorrelation timescale, τbreak , the PSD is constant. Nearly all of the different theoretical models produce
α ≈ −2, while having different values for τbreak , ranging from
τbreak ∼ 100 Myr in the FIRE simulations to τbreak ∼ 1000 Myr
in IllustrisTNG. We show that the PSD is set by physical
ingredients in the models and, hence, the PSD contains a
wealth of information that has not yet been exploited. In a
separate, upcoming paper we will address many issues that
MNRAS 000, 1–24 (2019)

3

complicate the precise determination of the PSD in observations, including possible variations in the IMF and dust
attenuation. There, we also wish to use observational constraints to analyse properties of galaxies at higher redshifts,
where the proper consideration of these complications is critically important.
This paper is structured as follows. In Section 2 we introduce our model and give a short overview of the properties of stochastic processes. In Section 3 we show how we
can infer parameters describing movement of galaxies about
the MS. We show both analytical and numerical results in
the simplified case in which response of each star-formation
indicator is given by a step function. In Section 4 we show
predictions for the observational results given the more realistic response functions. In Section 5 we use results developed in previous sections and determine, as a proof of
concept, parameters describing stochastic processes by using observations of the measured scatter of the MS in the
local universe. We conclude in Section 6. In the appendix we
expand on several more technical aspects of the paper.
Throughout the paper we use the terms “scatter of MS”,
“standard deviation of MS” and “width of MS” interchangeably, and denote it by σMS . We use the term “intrinsic” MS,
or “momentary” MS to denote width of the MS that would be
detected if we could measure the star-formation over the previous 1 Myr. We expand on our choice for 1 Myr in Section
2.3. We make our codes available at github.com/stacchella/
and github.com/nevencaplar/.

2

DESCRIPTION OF STAR-FORMATION
HISTORIES WITH STOCHASTIC
PROCESSES

In this section, we introduce our approach to modelling
SFHs with stochastic processes. In particular, we start by
highlighting and justifying the assumptions we make in our
model. We then explain what a stochastic process is and
how it can be described mathematically. Finally, we show
how we generate SFHs with a stochastic process and discuss
their properties such as burstiness.
2.1

Assumptions

We propose to model time-dependence of the SFR relative to the MS ridgeline of star-forming galaxies as a
purely stochastic process. We denote the SFR relative to
the MS ridgeline for a galaxy with stellar mass M? by
∆MS = log(SFR/SFRMS (M?)), where SFRMS (M?) is the SFR
of the MS at mass of M?. Throughout this work, we assume
that:
• there exists a MS, i.e., there is a power-law relation
between SFR and stellar mass for star-forming galaxies that
are separate from the quiescent galaxy population;
• the distribution of SFRs of galaxies about the MS ridgeline is well described by a log-normal function;
• time-variability of ∆MS of all star-forming galaxies of a
given mass can be described with the same stochastic process
given by a broken power-law PSD.
The first two assumptions are well justified from observations. Specifically, the existence of the MS have been put

4

Caplar & Tacchella

MS

[dex]

1.0

= 1.0, = 10 Myr

= 1.0, = 100 Myr

= 1.0, = 1000 Myr

= 2.0, = 10 Myr

= 2.0, = 100 Myr

= 2.0, = 1000 Myr

= 3.0, = 10 Myr

= 3.0, = 100 Myr

= 3.0, = 1000 Myr

0.5
0.0
0.5
1.0

MS

[dex]

1.0
0.5
0.0
0.5
1.0

MS

[dex]

1.0
0.5
0.0
0.5
1.0
0

100 200 300 400 500 600 0

time [Myr]

100 200 300 400 500 600 0

time [Myr]

100 200 300 400 500 600

time [Myr]

Figure 1. Example star-formation histories (SFHs) drawn from different power spectral densities (PSDs). All of these have been created
with the same random seed so they are directly comparable. Each panel shows the SFH relative to the MS ridgeline (∆MS ), measured with
cadence (time-separation) of 1 Myr. From top to bottom, we show the SFHs generated with different PSDs with increasing power-law
slope (α = 1 → 3) and increasing break timescale (τbreak = 10 → 1000 Myr). Overall, the burstiness increases toward smaller α and shorter
τbreak .

forward by several different observing groups (e.g., Noeske
et al. 2007; Elbaz et al. 2007; Daddi et al. 2007; Peng et al.
2015). Furthermore, several groups claim that the scatter
can be well described by a log-normal (Guo et al. 2013;
Schreiber et al. 2015; Chang et al. 2015; Davies et al. 2019).
Feldmann (2017) shows that the whole galaxy population,
i.e., star-forming and quiescent galaxies, can be well fitted
by a zero-inflated negative binomial distribution, which is
only a small modification from the log-normal distribution
describing star-forming galaxies, but has the advantage that
no division between star-forming and quiescent galaxies is
needed. There is still debate in the literature about the exact shape of the MS, including its slope and turnover at high
mass at low redshifts, and also about the existence of a MS
at high redshifts (z > 3; Speagle et al. 2014; Whitaker et al.
2014; Iyer et al. 2018). Since we focus in this paper on moderately massive (≈ 1010 M ) galaxies at z ∼ 0 and model

the SFRs relative to the MS, this uncertainty on the exact
shape is not critical.

The third assumption that all massive star-forming
galaxies are described with the same stochastic processes
is the simplest reasonable assumption and it enables us to
maintain analytical tractability of the model. In this work
we do not explore further variables that could influence the
PSD, such as environment. It is also possible that lower-mass
galaxies (including dwarfs) follow a stochastic process with
different properties; this will be investigated in the future.
Finally, as also mentioned in the introduction, we assume
that the stochastic behaviour can be described through a
broken power-law PSD, i.e., we assume that the 3-point correlation function (and any higher order terms) is zero. This
is again a reasonable assumption given the current observational constraints, as further discussed in Section 5.
MNRAS 000, 1–24 (2019)

[dex]

1

MS

2
2

1

= 1.0

break/Myr = 1000.0

0

[dex]

1

MS

2
2

1

= 2.0

break/Myr = 10.0

0

[dex]

1

MS

2
2

1

= 2.0

break/Myr = 100.0

0

[dex]

1

MS

2
2

1

= 2.0

break/Myr = 1000.0

0

[dex]

1

MS

2
2

1

= 3.0

break/Myr = 10.0

0

[dex]

1

MS

2
2

1

= 3.0

break/Myr = 100.0

0

[dex]

1

MS

2
2

1

= 3.0

break/Myr = 1000.0

0
2
0.0

0.5

1.0

1.5

time [Gyr]

2.0

2.5

ACF

1.0

0

ACF

0

2

2

0.5
0.0

4
2

1.0

0

ACF

break/Myr = 100.0

0.5
0.0

4

2

0.5
0.0

4
2

1.0

0

ACF

1

= 1.0

2

2

0.5
0.0

4
2

1.0

0

ACF

[dex]

1

MS

2
2

5

1.0

0

2

0.5
0.0

4
2

1.0

0

ACF

0

2

2

0.5
0.0

4
2

1.0

0

ACF

break/Myr = 10.0

2

0.5
0.0

4
2

1.0

0

ACF

1

= 1.0

2

0.5
0.0

4
2

1.0

0

ACF

[dex]

1

MS

2

PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr] PSD [dex2 Myr]

Stochastic modeling of star-formation histories

2

0.5
0.0

4
3.0

2.5

2.0

1.5

1.0

frequency [Myr 1]

0.5

0.0

0.0

0.5

1.0

1.5

2.0

log time [Myr]

2.5

3.0

Figure 2. Example SFHs relative to the MS, associated PSDs and ACFs. From top to bottom, we show SFHs with increasing slope
(α = 1 → 3) and increasing break timescale (τbreak = 10 → 1000 Myr). The left panels shows the SFHs relative to the MS as a function
of time. Three, randomly drawn, examples are shown with blue, orange and green lines. The solid black line and the grey shaded region
show the mean and scatter of the MS of our 1000 model galaxies. Given the large number of galaxies in the simulations, the mean relation
and the scatter change very little with time. The middle panels shows the associated PSDs; the black line shows the median PSD of our
1000 model galaxies. The vertical red line indicates τbreak , while grey region indicates our resolution limit at which we truncate the PSDs.
The right hand panels shows the associated ACFs and the black line shows the median ACF for our 1000 model galaxies.

MNRAS 000, 1–24 (2019)

Caplar & Tacchella
4.0

1.0

3.5

0.5

3.0
2.5

0.0

2.0

0.5

1.5
1.01.0

burstiness parameter

6

1.5

log

2.0
break

2.5

[Myr]

3.0

1.0

Figure 3. The burstiness parameter B. We plot the burstiness
parameter (Equation 6) estimated for the different PSDs with
power-law slope α and break timescale τbreak . PSDs with low values of α and τbreak yield highly bursty (B = 1) SFHs, while PSDs
with high values of α and τbreak give constant and hence regular
(B = −1) SFHs. There is a clear degeneracy between α and τbreak .

2.2

General description of stochastic processes

In this section, we will discuss several different stochastic processes and develop an intuition for parameters that
we will use in the rest of paper. We characterise different
stochastic processes by their PSD, a quantity denoting the
amount of power that a process has as a function of frequency, per unit frequency. The PSD gives a quantitative estimate of the importance of each mode, i.e., the importance
of each frequency interval for a given stochastic process. We
will also extensively use the Fourier pair of the PSD, the autocorrelation function (ACF). The autocorrelation function
provides the same information as the PSD, but in the time
domain instead of the frequency domain. The definition of
ACF, for a process that leads to a time-series ∆(t) is:
∫
limT −>∞ T1 (T ) ∆(t)∆(t + δt)dt
ACF(δt) =
σ∆2

(1)

where σ∆2 is the long-term variance of the process. We can see
that highly correlated timeseries, where ∆(t) ∼ ∆(t + ∆t), give
ACF∼ 1, while uncorrelated timeseries will lead to ACF∼ 0.
The simplest stochastic process is white noise. This
process has equal power at all frequencies. In this work
we denote frequency with f . The statement about equal
power on all frequencies can be mathematically written as
PSD( f ) ∝ f α , with α = 0. This process is perfectly uncorrelated, i.e., for a white noise process it holds that ACF(t) = 0,
for all times when t > 0.
Other processes can be defined by modifying the slope α
of the PSD. By decreasing the slope α the nature of process
changes and values separated by a given ∆t become more
similar. Some well known examples are given by α = −1 (pink
noise) and by α = −2 (red noise); the latter corresponding
to a random walk or Brownian motion.
All natural process have some characteristic time τ,

after which a process becomes uncorrelated, i.e., loses its
“memory” of the previous values and behaves like a white
noise process. We can express that statement in terms of the
ACF by saying that the ACF at times longer than the decorrelation time, τdecor has to be very small, ACF(t > τdecor ) 
1, or, in the closely related terms of the PSD, by requiring
that the slope at small frequencies below “break” frequency,
fbreak , has to be close to zero, α( f < fbreak ) ≈ 0. In that case,
the PSD has a broken power-law shape, with two distinct
slopes at large and small frequencies.
To illustrate this point further, let’s consider the simplest and most instructive case where the PSD is described
by a broken power-law, which corresponds to a damped random walk. The damped random walk is defined by the solution to the stochastic differential equation (Kelly et al.
2015):
d∆(t)
1
∆(t) = (t),
+
dt
τdecor

(2)

where (t) is a continuous white-noise process with zero mean
2 . In this form, one can recognise σ 2 as an
and variance σint
int
intrinsic amount of “randomness” entering the system, while
τdecor describes the timescale by which the process gravitates
towards a stable-state solution. This process is also known
as the Orstein-Uhlenbeck process in physics, or the Vasicek
model in financial literature.
The damped random walk process leads to the following
PSD:
PSD( f ) =

2
σint
2
+ (2π f )2
1/τdecor

σ2
=
.
1 + (τbreak f )2

(3)

where σ = σint τdecor is the “long-term” variability and τbreak =
2πτdecor . The connection of the description of the process in
frequency and time domain can be achived via the WienerKhinchin theorem (Emmanoulopoulos et al. 2010). Application of this procedure for this particular choice of PSD leads
to
ACF(t) = exp(−t/τdecor ).

(4)

We see that this process has all the properties that we
mentioned above. At short timescales (high frequencies),
it is very well correlated (ACF ∼ 1) and described with a
PSD with a slope that equals to 2. Then, the process becomes rapidly decorrelated at a timescale τdecor , and at long
timescales (low frequencies), the ACF drops quickly (ACF
∼ 0) and the PSD is well described with a flat slope. Observationally, high values of ACF imply similar measurements,
while decorrelation implies little to no similarity between
two measurements. As such, while at short timescales starformation measurements will be very similar, at timescales
larger than τdecor the observations of the same galaxy will
have star-formation measurements which are largely independent of each other.
In this work, we consider a larger group of processes,
described with
PSD( f ) =

σ2
.
1 + (τbreak f )α

(5)
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
This choice offers additional flexibility to encompass a wide
range of physical processes that are not necessarily described
by random walks, providing a more general description of
the possible underlying stochastic process. We show examples of generated SFHs relative to the MS, ∆MS , in Figure
1. The generation of these SFHs is described in the next
section. Figure shows simulated SFHs as a function of highfrequency slopes of the PSD (α in Equation 5)1 and break
timescales (τbreak in Equation 5). The figure highlights large
qualitative differences between SFHs generated with different parameters. When the slope of the PSD is shallow and/or
τbreak is small, the SFH rapidly oscillates around the mean
and is very quickly decorrelated. On the other hand, steeper
slopes and longer τbreak lead to slower oscillations and more
correlated behaviour, as described above. In Section 2.4, we
will return to this point in order to quantify the “burstiness”
of these processes.
All of the examples shown in Figure 1 have been created with σ = 0.4 dex. We use this value motivated by the
measurement of the MS width in Davies et al. (2019) in Hα,
and we show in Section 4 that the measurement in Hα is
largely representative of the intrinsic width of MS, σMS . A
number of results that we will derive depend somewhat on
the intrinsic width of MS. In the rest of the paper, we work
with σMS = 0.4 dex, but note at each point where our results
depend on the exact choice of this value.
Finally, we note that we are implicitly assuming that
the stochastic process that we are using is stationary. A stationary process has the property that its mean, variance and
autocorrelation function are not time dependent. That the
variance, i.e., the width of MS is not time dependent over last
several Gyr is consistent with observational data and simulations (Noeske et al. 2007; Rodighiero et al. 2010; Katsianis
et al. in prep.). In other words, we assume that the properties of stochastic process do not change with time and that is
valid to use the same parameters to describe observations of
galaxies over the whole time range probed. It is important
to note that this does not mean that we assume that the
MS is not allowed to change with time. The main stochastic
process modelled in this work is movement of galaxies about
the MS ridgeline (∆MS ). The MS itself evolves over cosmological timescales, but because we consider galaxies at z = 0,
this evolution is negligible. We further discuss this effect in
Section 5, when comparing the results from our modelling
with the observational data.

2.3

Generating star-formation histories

Here we describe how we generate numerically a sample of
SFHs that we use in the rest of the paper when we analyze properties of stochastic processes and observational
consequences. For each choice of break timescale τbreak and
high-frequency slope α we simulate 1000 SFHs using the
algorithm by Timmer & Koenig (1995) and implemented
in Python by Connolly (2015). For each galaxy, we only
consider the SFR as an integrated quantity over the whole
galaxy, i.e., we measure only total SFRs over the whole

galaxy without deeper considerations of possible difference
in different galactic (sub-)components.
When simulating SFHs we need to assume some minimal timescale at which to separate our measurements of
SFR (time bins). In this work we set this timescale to 1
Myr. This choice is motivated by the free-fall time and the
lifetime of giant molecular clouds which are at least of that
order (Murray et al. 2010; Hollyhead et al. 2015; Freeman
et al. 2017; Grudić et al. 2018). Operationally this means
that we are assuming that below the scale of 1 Myr, the
SFR is perfectly correlated, i.e., remains constant. This is
a reasonable assumption since we are considering only total
SFRs integrated over the whole galaxy, which itself is made
up of several star-forming events (giant molecular clouds).
In terms of PSD that means that the domain of the PSD
is defined up to scales of f < 1/Myr. In terms of ACF this
leads to a discontinuity in our assumed ACF at 1 Myr, where
we set ACF to be equal to unity. The effect of this assumptions is less and less pronounced when the stochastic process
has larger α and τbreak , since in this case the process is already highly correlated on 1 Myr scales, and our assumption
is satisfied by construction. In Section 5, when we compare
with observational data at low redshifts, the deduced parameters are outside the range that is critically sensitive to
this assumption, but this might not be the case for studies at
higher redshifts where deeper investigation of this assumption should be conducted.
For each SFH we simulate 4282 points, corresponding
to 4.282 Gyr, i.e., to a galaxy evolving from z = 0.4 to z = 0.
We note that choice of the length is somewhat aribtary and
carries no great physical significance. We often use much
shorter SFHs and our results are not dependent on the actual duration of the simulated histories, provided they are
significantly longer than the τbreak of the considered process.
In Figure 2 we illustrate the results of this procedure. For
each τbreak and α, we show a selection of three SFHs relative
to the MS (left panel), together with their PSDs and ACFs
(middle and right panels). We also show median relations
in black, which have been deduced from all 1000 simulated
galaxies. We also explicitly show the effect of a cut at 1 Myr,
seen as the grey region in the plots of the PSD, and seen in
the fact that ACFs extended “only” to log(time/Myr) = 0.
2.4

In the rest of the paper α will appear as a positively defined quantity, i.e., α is defined with Equation (5), and not with
PSD( f ) ∝ f α .
MNRAS 000, 1–24 (2019)

Quantifying the burstiness of star-formation
histories

Here we want to connect the parameters that we have introduced (α and τbreak ) with a more intuitive quantity which
describes the tendency of the SFH to have “bursts”, i.e., periods of star formation which are much higher (or lower)
than the mean of the population. From Figures 1 and 2 it is
apparent that the power-law slope α and the break timescale
τbreak are connected with the variability, or “burstiness”, of
the SFH. Following Goh & Barabási (2008, see also Applebaum et al. 2018), we define the burstiness parameter, for a
single galaxy, as
B=

1

7

σ/µ − 1
,
σ/µ + 1

(6)

where σ is the standard deviation of ∆MS , and µ is the mean
of ∆MS of an individual SFH, measured over a certain time-

8

Caplar & Tacchella

interval. It is important to note that the exact value of B
depends on the interval over which it is measured. We choose
this time interval to be 30 Myr in order to be able to describe
the large diversity of variability in the SFHs seen in Figure 1.
This choice of time interval is also consistent with the one
used by Applebaum et al. (2018). In general, B has a value
in the bounded range (−1, 1), and its magnitude correlates
with the signal’s burstiness. The average deviation from the
MS for one galaxy, µ, will approach zero as the SFH becomes
more bursty. Therefore, B = 1 is a maximally bursty signal,
B = 0 is neutral, and B = −1 corresponds to a completely
regular (periodic or constant) signal.
To show trends as a function of α and τbreak , we compute the mean of B over our sample of 1000 numerically
generated model galaxies for each point of the α-τbreak parameter space. Figure 3 shows how the burstiness B varies as
a function of the PSD parameters α and τbreak . Large values
of α and τbreak correspond to slowly varying, nearly constant
SFHs (see Figure 1), corresponding to B = −1, i.e., highly
non-bursty. Most individual galaxies rarely venture to the
edges of the MS and therefore experience no episodes of very
high (or very low) SFR in comparison to the average over
30 Myr. On the other hand, PSDs with small α and short
τbreak produce SFHs with B = 1 (highly bursty). These SFH
rapidly change their SFR and have very varied SFHs over
the considered time range of 30 Myr. Furthermore, Figure 3
highlights the degeneracy between α and τbreak : contours of
constant B extend along well-defined curves in the α-τbreak
plane. This is something that we will encounter again in sections 3 and 4, where we investigate how the scatter of the
MS as seen from different indicators depends on the PSD
parameters α and τbreak .

3

FINDING PARAMETERS OF STOCHASTIC
STAR-FORMATION HISTORY IN A TOY
MODEL

In the previous section we have shown how different choices
for parameters describing the PSD (namely the slope α and
the break timescale τbreak ) lead to different SFHs of starforming galaxies. Estimating these stochastic parameters
from observations is difficult, since it is still a big challenge
to infer the SFH from a galaxy’s SED (see Introduction).
By measuring the SFR using different indicators we are
able to estimate how the SFR varied in the galaxy’s recent
past (e.g., Kennicutt 1998). Specifically, measurements of
the SFR with indicators that are based on nebular lines will
probe very recent star-formation (∼ 106 yr), while measurement in the UV and optical bands will be sensitive to much
longer timescales (∼ 107 yr and ∼ 108 yr, respectively; see
also Section 4). As we will show below, by studying a large
sample of galaxies for which the SFRs have been estimated
with different indicators, the parameters of the underlying
stochastic process can be deduced.
To develop understanding, we present the simplest possible case in which measurements with different indicators
correspond exactly to averaging the recent SFR over a given
timescale. We will develop analytical expressions for the offset as well as scatter of the MS as a function of the averaging
timescale. This approach will help us to see connections and
correlations between different parameters more clearly. Af-

terwards, in Section 4, we discuss realistic response functions
for different SFR indicators and redo much of the calculations with more complex and more realistic models. In contrast with mainly analytical approach in this section, when
dealing with more realistic cases we will derive results with
greater emphasis on numerical calculations.

3.1

Impact of averaging of the star-formation
histories on the shape of the measured MS

In this section we show how the measured normalization and
width of the MS change as a function of the timescale over
which the SFH is averaged. These changes depend on the the
properties of the stochastic process (i.e., PSD) and, hence,
can also be used to infer these properties. We first show analytically derived relations between the measured offset from
the MS and then the expression for the width of the MS.
We then confirm these results by our numerically generated
model galaxies (Section 2.3) and show how parameters of
stochastic process can be deduced from measurements.

3.1.1

Mean measured offset from the main sequence

We first consider mean offsets from the MS, as a function of
the parameters of the stochastic process, when measured by
indicators probing different timescales. We denote the SFR
that has been measured with a given indicator by SFRind .
As already mentioned, we assume now the simplest possible
case in which the response of each indicator is given by a step
function each with different lengths, i.e., different response
times. In that case, the response step function can be divided
into N j equal time steps. The measurement of the SFR with
a given indicator at time ti is then equal to the averaged
“true” SFR of the previous N j steps, where t j are labels for
these equidistant time steps:

SFRind (ti ) =

Nj
1 Õ
SFR(ti − t j ).
Nj

(7)

t j =1

Let’s now define the logarithmic distance of the SFR from
the ridgeline of the intrinsic MS2
∆(ti ) = log SFR(ti ) − log SFRMS (M?, ti ),

(8)

and its equivalent quantity, logarithmic distance of measured
SFR from the ridgeline of intrinsic MS
∆ind (ti ) = log SFRind (ti ) − log SFRMS (M?, ti ).

(9)

In this work we are also assuming that the time and
mass dependence of log SFRMS (M?, t) can be neglected, i.e.,
log SFRMS (M?, t) ≡ C, where C is a constant in units of
M yr−1 . This is done to simplify the calculation and is indeed true at low redshifts (see further discussion in Section
5.2.2).

2

We henceforth use just ∆ as shorthand for ∆MS in equations, in
order to reduce the size and complexity of our expressions.
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
By combining Equations (7), (8) and (9) we find that
∆ind (ti ) = log

Nj
1 Õ
SFR(ti − t j ) − log SFRMS
Nj
t j =1

= log

Nj
1 Õ ∆(ti −t j )+log SFRMS
10
− log SFRMS
Nj

(10)

t j =1

= log

Nj
1 Õ ∆(ti −t j )
10
.
Nj
t j =1

The above expression is true for a single galaxy, but in observations we are looking for a statistical quantity h∆ind (ti )i,
where we use hi to denote the average value of the measured
offset from MS, i.e., to denote that the measurement has
been averaged over a sample of observed galaxies.
h∆ind (ti )i can be explicitly derived for the case of
damped random walk (equations (2) and (3)). When the
galaxy is at a MS distance of ∆(t j ) at some time t j , its expected distribution at later time ti − t j is given by (Kelly
et al. 2009; MacLeod et al. 2010):
s
!
ti − t j
ti − t j
P[∆(ti −t j )] = N ∆(t j ) exp(−
), σMS 1 − exp(−
) ,
4τdecor
2τdecor
(11)
where with P we denote expected distribution and N (µ, s)
denotes a normal distribution with mean µ and standard
deviation of s. We are actually interested in the quantity
that appears in Equation (10), i.e., the expectation value
of the quantity 10∆(ti −t j ) . The expectation value, E, for a
lognormal distribution is given by
E[10 N(µ,s) ] = 10µ+

s 2 ln(10)
2

.

(12)

Therefore, the expectation value of the process at time
ti − t j is given by
E[10∆(ti −t j ) ] = 10

t −t
∆(t j ) exp(− 4τi j
decor

2 (1−exp(− t i −t j
)+σMS
2τdecor

)) ln(10)
2

. (13)

Combining together the expressions from equations (10) and
(13) we obtain:
Nj
t −t
2 (1−exp(− t i −t j )) ln(10)
© 1 Õ ∆(t j ) exp(− 4τidecorj )+σMS
2τdecor
2 ª
h∆ind (ti )i = log ­
10
®.
Nj
t
=1
j
«
¬
(14)

We see that the measured offset depends on the duration of
the response of an indicator (N j ), the properties of underlying stochastic process (only τdecor in case of the damped
random walk) and the intrinsic width of the main sequence
(σMS ). We can also see that larger offsets are realized for
larger values of N j , τdecor and σMS . We will investigate the
interplay of these parameters more closely in Section 3.2.
3.1.2

Width of the MS

We now turn to the width of the MS and explore this property as a function of parameters of the stochastic process.
MNRAS 000, 1–24 (2019)

9

The derivation is somewhat involved; see Appendix B for
details. There we show that the lowest order expansion, as
a function of σMS , of the measured variance of a sample of
2
galaxies, σind,MS
, is given by
2
σind,MS
(ti ) =

Nj Õ
Nj
2 Õ
σMS

N j2 t =1 t 0 =1
j
j

ACF(t j − t j 0 ),

(15)

where σMS is the intrinsic width of the MS. This double summation can be simplified, by using symmetry properties of
the auto-correlation function, to yield the measured σind,MS
(Priestley 1981; Ivezić, Ž., Connolly, A. J., Vanderplas, J. T.
and Gray, A. 2014):
1/2


Nj 
Õ
tj
σ ©
ª
σind,MS (ti ) = pMS ­1 + 2
1−
ACF(t j )®
Nj
Nj
t j =1
«
¬

.

(16)

We note that this equation has the same form as the equation for the uncertainty of the mean for the dataset consisting of N j measurements with a homoscedastic measurement
error of σMS . This is another intuitive way to think about
this quantity that we are measuring. In essence, we are exploiting the ergodic property of our sample. Measuring the
width of the distribution created by galaxies which are moving stochastically around the MS with an indicator over N j
times is equivalent to measuring the mean of a sample of
galaxies on MS at N j different times!
We see that in case of ACF(t j ) = 0, the expression in
the brackets of Equation (16) is unity, and thereforepthe
measured scatter of the MS drops very quickly as σMS / N j ,
which is the familiar expression for the uncertainty of the
mean from any analysis that uses independent measurements. On the other hand, in case of highly correlated data
(ACF(t j ) ≈ 1), the measured scatter of the MS is essentially
unchanged and corresponds to the initial σMS .
3.2

Comparison to numerically generated model
galaxies

We now consider the consequences of the theory developed
above, i.e., we study the interplay between the stochastic
process of star-formation and the timescale of the indicators
used to probe the SFR. We show in Figure 4, as a function of
PSD parameters, how the shape of the MS (i.e., distribution
of ∆MS at fixed mass) depends on the different averaging
timescale. The grey line, which is the same in all panels,
shows the intrinsic distribution of the 1000 model galaxies
about the MS ridgeline (∆MS ). By construction, this intrinsic
distribution is defined in 1 Myr time bins and is a normal
distribution with σMS = 0.4 dex.
Let us first consider the effect of averaging the SFH,
i.e., mimicking an observation by averaging the SFR over a
certain time interval t (which we denote with hti). Note that
this is fundamentally different than considering an average
of SFH relative to the MS, i.e., considering an average of
∆MS (t) (see Equation (7)). The blue, orange, green, and red
histograms show the distribution about the MS ridgeline after averaging over 5 Myr, 10 Myr, 100 Myr, and 1000 Myr,
respectively. As expected, we find that measurements over
the shorter averaging timescales give measured distributions

10

Caplar & Tacchella

density

5
4

= 1.0

= 1.0

= 1.0

break = 10 Myr

break = 100 Myr

break = 1000 Myr

= 2.0
break = 10 Myr

= 2.0
break = 100 Myr

= 2.0
break = 1000 Myr

= 3.0
break = 10 Myr

= 3.0
break = 100 Myr

= 3.0
break = 1000 Myr

3
2
1
0

density

5
4
3
2
1
0

density

5
4

100 Myr
1000 Myr

intrinsic
5 Myr
10 Myr

3
2
1
0 1.0

0.5

MS

0.0

[dex]

0.5

1.0

1.0

0.5

MS

0.0

[dex]

0.5

1.0

1.0

0.5

MS

0.0

[dex]

0.5

1.0

Figure 4. Distribution about the MS ridgeline after averaging the SFHs. Each panel shows the resulting distributions for a given PSD,
with increasing α and τbreak from top left to bottom right. The thick black histogram indicates the intrinsic distribution, which has by
construction a mean of 0.0 and a scatter of 0.4 dex for all α and τbreak . The blue, orange, green and red histograms show the distribution
of galaxies after their SFHs were averaged over a timescale of 5 Myr, 10 Myr, 100 Myr, and 1000 Myr, respectively. The larger the
averaging timescale, the larger the MS offset and the smaller the scatter. The effects are the largest for small α and τbreak since the SFHs
are bursty in this case.

that are closer to the intrinsic distribution. On the other
hand, long averaging timescales produce a narrower distribution with a median value that is biased to higher values
than in the original distribution. This is a consequence of
arithmetic averaging of logarithmic quantity (see Equation
(14)) and serves as a useful reminder that the measured median of the MS is not necessarily at the same value as the
intrinsic median of the MS.
We now consider different processes measured with the
same indicator, i.e., consider the differences between histograms in different panels with the same colour. We find
that the observed distribution matches the intrinsic distribution better for larger values of α and τbreak . This is because
the SFR of individual galaxies changes less during the time
covered by an indicator and is therefore more similar to its
momentary value.

Therefore, we see that there is an interplay between the
parameters of a stochastic process (α and τbreak ) and the averaging timescale (timescale of the observational indicator).
In particular, for a given slope α, there is a strong connection between between the timescale of the process and the
averaging timescale. This can be seen in Figure 4 as a similarity of the MS distributions that have the same τbreak and
averaging timescale in a given row of the figure (compare
orange histograms in the panels on the left hand side, green
in the middle and red on the right hand side).
We note that our formalism is able to predict further
moments of the distribution, such as skewness and kurtosis.
However, given that those increasingly depend on the details
on the assumed intrinsic distribution and are less readily
observed quantities, we choose not to extend that part of
our analysis.
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories

0.0

MS, < t >

> [dex]

0.3
0.2
0.1
0.0 0.0

break/Myr = 100

= 1.0
= 1.5
= 2.0
0.5

0.10

0.00

> [dex]

[dex]

0.4

MS, < t >

0.1

break/Myr = 10
break/Myr = 50
break/Myr = 100
break/Myr = 1000

= 2.5
= 3.0
1.0

1.5

2.0

log averaging timescale < t >

0.15

<

0.2

= 2.0

0.05

0.20
0.15

MS, < t >

0.3

0.20

0.10

<

MS, < t >

[dex]

0.4

11

0.00

0.05

2.5

0.0

0.5

1.0

1.5

2.0

log averaging timescale < t >

2.5

Figure 5. Measured scatter of the MS σMS, hti (left panels) and offset from the intrinsic ridgeline ∆MS, hti (right panels) as a function of
the averaging timescale ht i. Upper panels show the results for a power-law slope α = 2.0 and varying τbreak , while the lower panels show
the results for a constant τbreak = 100.0 Myr and varying α. Averaging the SFHs of the model galaxies over longer timescales increases the
offset from the MS to higher values and leads to a decrease of the MS scatter, as already seen in Figure 4.

We present the information about offset (∆MS, hti ) and
width (σMS, hti ) of the MS contained in Figure 4 in a more
condensed form in Figure 5. In the panels on the left we show
changes of the measured width of the MS as a function of
(a) a fixed slope α and changing τbreak , and (b) a fixed τbreak
and changing slope α. On the right hands side we show the
result of the same exercise on the offset of the measured MS
ridgeline from the intrinsic MS ridgeline.
These plots confirm our intuitive findings from above.
For a given indicator corresponding to a single averaging
timescale hti, the larger α and shorter τbreak leads to measuring a tighter MS and a larger offset from the median of
the intrinsic MS.
Until now we have discussed how measurements (averaging in this simple toy case) and parameters of stochastic processes influence the statistical parameters of the final
distribution such as median and standard deviation. In Figure 6 we show a full example of the effect of averaging the
SFR (i.e., measuring the SFR with a given indicator) on the
observed MS. For all three panels we assume an averaging
timescale of 100 Myr and the slope α = 2, while varying the
τbreak of the process. The blue points show the individual
model galaxies. The dashed red line indicates the predicted
connection between the measured and actual (intrinsic) offset from the MS according to Equation (14). This prediction is in excellent agreement with the relation measured
from simulated model galaxies, which is shown in orange.
In the bottom right corner of each panel we also show the
measured scatter of the MS and the predicted value from
Equation (16).
In the left panel of Figure 6, we can now explicitly see
the central limit theorem in action: because the SFRs vary
rapidly, the measured and intrinsic SFRs are almost completely unrelated. This is a consequence of the fact that
MNRAS 000, 1–24 (2019)

the observational timescale is much longer than the decorrelation time of the process. This means that during the
timescale of the observation, each galaxy has moved up and
down the MS ridgeline and hence the measured SFR gives
us only an estimate of the mean of the whole population. In
the middle and right panels of Figure 6, we increase τbreak :
the decorrelation times become longer and the agreement
between the intrinsic and measured SFRs improve as galaxies change their SFRs less significantly during the time that
measurement is sensitive to.
3.3

Measuring parameters of stochastic process
from the mock data

In the previous section we have extensively discussed how
averaging, i.e., measuring, SFRs changes the inferred properties of the MS, such as position of ridgeline and width.
Furthermore, we have shown how this effect depends on the
parameters of the stochastic process itself. Here we want to
show how we can use these insights to deduce the parameters of the stochastic process from mock observations. We
will then apply the same procedure, with more realistic response functions of different indicators, when discussing real
data in Section 5.
Here we consider an example in which we have simulated 10000 galaxies with α = 2 and τbreak = 400 Myr. We
have then convolved these galaxies with three step functions
of 1, 10 and 100 Myr respectively, mimicking 3 different indicators. Given that we 1 Myr is the shortest time-scale that
we consider, “measurment” with the short indicator is the
equivalent to the intrinsic SFH. We then measure the ratio
of the widths of MS measured in each of these indicators,
with associated error bars, and then find parts of the parameter space that are consistent with these measurements, both

12

Caplar & Tacchella
1.00

=2,

ind, MS

(measured SFR)

0.75

break

= 20.0 Myr

=2,

break

= 100.0 Myr

=2,

break

= 500.0 Myr

0.50
0.25
0.00
0.25

mean from analytical computation
simulated data
mean from simulated data

0.50
0.75
1.001.0

Measured scatter of MS: 0.12 dex
Analytical scatter of MS: 0.09 dex

0.5

MS

0.0

0.5

(intrinsic SFR)

Measured scatter of MS: 0.22 dex
Analytical scatter of MS: 0.20 dex

1.0 1.0

0.5

MS

0.0

0.5

(intrinsic SFR)

1.0 1.0

Measured scatter of MS: 0.32 dex
Analytical scatter of MS: 0.33 dex

0.5

MS

0.0

0.5

(intrinsic SFR)

1.0

Figure 6. Distribution of measured offset, from the main sequence as a function of intrinsic offset from the main sequence. “Measurement”
has been approximated in this simple example by averaging previous 100 Myr of SFH of each galaxy. From left to right, we show result
for damped random walk with τbreak =20, 100 and 500 Myr. Dashed diagonal line shows one-to-one relation. The orange line shows the
mean ∆ind,MS in the measured data, as a function of input ∆MS , along with the 1-σ spread. The dashed red line shows our prediction
for the mean ∆ind,MS in the measured data, calculated from Equation (14). In the bottom right corner we state measured scatter of the
MS as seen in the simulated data, and from our analytical expression in Equation (16). The small offset of the recovered parameters
compared to input parameters is due to the fact that Equation (16) is only the first order approximation of the full expression.

3.0

proximation to the actual measured width, that considering
ratios of measured widths eliminates dependence on intrinsic σMS . Some dependence comes from higher order terms
to Equation (16), which we discuss in Appendix B.

input
analytical
numerical

2.8
2.6
2.4
2.2
2.0
1.8

100Myr/ 1Myr
10Myr/ 1Myr
100Myr/ 10Myr

1.6
1.4
1.4

1.6

1.8

log

2.0 2.2 2.4 2.6
break [Myr]

2.8

3.0

Figure 7. Example of recovering the parameters of a stochastic
process by the MS width measurements. The black cross marks
the input parameter for the simulated model galaxies (α = 2.0 and
τbreak = 400 Myr). The dashed lines show the analytical constraints
from the ratios of MS width measurements, while the shaded
bands show the numerical constraints. The three different colors
show the constraints for three different MS width measurements:
a short, medium, and long timescale indicator (1 Myr, 10 Myr and
100 Myr). We find that we can recover the input parameters. The
small offset of the analytically recovered parameters compared to
input parameters is due to the fact that Equation (16) is only the
first order approximation of the full expression.

from considering Equation (16) and from comparing with results from a simulation which spans the whole parameters
space. We consider ratios of the measurements in different
indicators to minimise the dependence of the result on the
intrinsic width of the MS, which is of course known in the
simulation, but is not necessarily available when considering
real data. We see from Equation (16), which is first order ap-

We show the result of this procedure in Figure 7. The
dashed lines show the result deduced from analytic expression in Equation (16) while the differently coloured areas
show 1-σ constraints from the numerical simulations. We
see that, although a single ratio of MS width measurements
of two indicators is not sufficient to break the degeneracy
between α and τbreak , combination of several indicators can
break this degeneracy and provide a unique solution for the
parameters of the process. This is not surprising, and is a
restatement of the fact that we need two different “measurements” in order to uniquely determine two free parameters.
It is also advantageous if the indicators cover substantially
different range of timescales, in order to be sensitive to different parts of the PSD. Given that we aim to be as agnostic
as possible to the intrinsic width of the MS and therefore
consider ratios of the MS width, this effectively requires a
measurement of the width of the MS with three indicators.
Addition of any more indicators or combinations of indicators will not bring more information in this plane, but can
be used as a consistency check.

Furthermore, we see that there is a small offset from
the input values and the values deduced from using Equation (16). This is a consequence of the fact that Equation
(16) is only the first order approximation to the full calculation of the width, as already discussed in Section 3.1.2
and Appendix B. We use full numerical simulations to avoid
this effect here and when we compare with the real data in
Section 5.
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories

13

1.5

[dex]

0.5

MS

1.0

0.5

0.0
1.0

SFR [M yr 1]

1.5
10
8
6

intrinsic
H
FUV
NUV

u
W3
UV + IR

4
2
0
1.00

1.05

1.10

1.15

1.20

time [Gyr]

1.25

1.30

1.35

1.40

Figure 8. Example of the SFH of a galaxy as seen by different SFR indicators. The upper panel shows the distance from the MS as a
function of time, while the bottom panel shows the absolute SFR, assuming the MS has a normalization of 1 M yr−1 at all times and
stellar masses. We show a small zoomed-in section from one of the simulated SFH, starting at 1 Gyr. The intrinsic SFH is shown in
black, while the purple, blue, cyan, green, orange and red lines show the SFH as seen by the Hα, FUV, NUV, u, W3, and UV+IR SFR
indicators, respectively. Since Hα probes short timescales (see Figure C1), it tracks the intrinsic SFH well. On the other hand, if the
SFR indicator probes longer timescales, the overall SFH is much smoother and there is an overall bias towards higher SFRs, leading to
an offset of the inferred MS ridgeline.

4

FINDING PARAMETERS OF STOCHASTIC
STAR-FORMATION HISTORY WITH
REALISTIC RESPONSE FUNCTIONS

We highlighted in the previous section that the MS scatter for the SFR average over different timescales can give
a tight constraint on the PSD of the underlying stochastic
process. In this section, we present a detailed investigation
quantifying how does the normalisation and width of the MS
change when probed with different SFR indicators, which
themselves trace different timescales. In Section 5, we will
use this information to show example of constraining the
PSD from observations.

4.1

SFR tracers

There are multiple methods for determining SFRs from observational tracers such as from the UV, IR and emission
lines. In the end, all the methods – irrespective of whether
the observable is directly starlight, dust-reradiated starlight
or nebular line emission – quantitatively link the observable
to the intrinsic emission from hot young stars. Therefore, a
crucial part of each method deals with how to correct for
dust attenuation. Similarly, the IMF, in particular the highMNRAS 000, 1–24 (2019)

mass end slope, and the star-formation history play a role
in the exact luminosity-SFR calibration.
In the scope of this work, we are primarily interested
in the distribution of SFRs probed by different tracers and
hence timescales. We assume that measurements of dustcorrected SFRs as provided in the literature are accurately
dust corrected, i.e., we do not discuss any dust effects. Similarly, we assume a Chabrier (2003) IMF and solar metallicity throughout. Variations in metallicity, dust attenuation
(in particular differential dust effect between young and old
stars) and IMF could be, in principle, important. We will address this in an upcoming publication, where we will study
the effect of variability of SFHs, IMF and dust attenuation in the observational plane of luminosities. In general,
these effects would increase the scatter, implying that our
results are basically an upper limit on the variability. In Section 5, we focus on a galaxy sample in a small mass range
(M? = 1010 − 1010.5 M ) in order to minimize variations in
IMF, metallicity and dust content.
We are considering the following standard SFR tracers
(see Kennicutt 1998; Kennicutt & Evans 2012; Davies et al.
2016):
• Hα: Hα photons arise from the gas ionized by young

14

Caplar & Tacchella

density

4

= 1.0
break = 10 Myr

= 1.0
break = 100 Myr

= 1.0
break = 1000 Myr

= 2.0
break = 10 Myr

= 2.0
break = 100 Myr

= 2.0
break = 1000 Myr

3
2
1
0

density

4
3
2
1
0

density

4

= 3.0

= 3.0

break = 10 Myr

= 3.0

break = 100 Myr

break = 1000 Myr

3

intrinsic
H
FUV
NUV

2

u
W3
UV + IR

1
0 1.0

0.5

MS

0.0

[dex]

0.5

1.0

1.0

0.5

MS

0.0

[dex]

0.5

1.0

1.0

0.5

MS

0.0

[dex]

0.5

1.0

Figure 9. Distribution about the MS ridgeline as seen by different SFR indicators. This figure is similar to Figure 4, but this time
for realistic SFR indicators. Each panel shows the resulting distributions for a given PSD, with increasing α and τbreak from top left to
bottom right. The thick black histogram indicates the intrinsic distribution, which has by construction a mean of 0.0 and a scatter of
0.4 dex for all α and τbreak . The purple, blue, cyan, green, orange and red histograms show the distribution of galaxies as seen by the Hα,
FUV, NUV, u, W3, and UV+IR SFR indicator, respectively. The larger the timescale probed by the indicator, the larger the MS offset
and the smaller the MS scatter. The effects are the largest for small α and τbreak since the PSD has a lot of power on short timescales
relative to the long timescales.

(< 20 Myr) stars. Thus, Hα provides a measure of the current
SFR in galaxies.
• FUV and NUV: UV continuum emission arises from
hot, massive O and B stars with M? > 3 M , and hence is a
good tracer of more recent star formation, though on longer
timescales than Hα.
• u-band: The rest-frame u-band (∼ 3500 Å) emission
arises from the photospheres of young, massive stars, tracing
< 100 Myr timescales. This emission is
the star formation on ∼
less strongly affected by dust obscuration than the UV, but
the possible large contribution from older stellar populations
makes it more difficult to interpret.
• WISE W3: Probing infrared (IR) flux from star-forming
galaxies in the 3 − 100 µm range gives a reliable estimate for
the ongoing star-formation: the amount of flux emitted in

the IR is directly related to the UV emission from newly
formed stars (Calzetti et al. 2007, e.g.). We consider the
Wide-field Infrared Survey Explorer (WISE ) passband W3
at rest-frame 12 µm to estimate the SFR (Cluver et al. 2014).
• UV+IR: As discussed above, UV emission arises directly from star-forming regions, while some fraction of this
emission is absorbed and reprocessed by dust, being reemitted in the IR. We therefore sum both UV and total
IR luminosities to obtain the total SFR, based on the bolometric luminosity of OB stars.
In order to now predict what the SFH, as seen by a certain indicator looks like, we need to convolve the intrinsic
SFH with the response function of that indicator. Response
functions for the aforementioned indicators are shown and
discussed in Appendix C. Briefly, we predict the luminosity
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
H

3.5

FUV

0.40

NUV

3.0

0.36

2.5
0.32

2.0
1.5

0.28

[dex]

powerlaw slope

4.0

1.0
4.0

powerlaw slope

15

u

3.5

W3

0.24

UV + IR

3.0

0.20

2.5
0.16

2.0
1.5
1.01.0

1.5

log

2.0
break

2.5

[Myr]

3.01.0

1.5

log

2.0
break

2.5

[Myr]

3.01.0

1.5

log

2.0
break

2.5

[Myr]

3.0

0.12

Figure 10. The scatter of the MS as seen by different indicators. Each panel shows the MS scatter as seen by a certain indicator as a
function of the PSD parameters τbreak and α. The panels from the top left to the bottom right show the results for the Hα, FUV, NUV,
u, W3, and UV+IR SFR indicator. In general, the burstier the SFR (see Figure 3), the smaller the measured scatter with the indicator.

evolution for a Simple Stellar Population (SSP) using the
Flexible Stellar Population Synthesis code (FSPS3 ; Conroy
et al. 2009). FSPS has been extensively calibrated against a
suite of observational data (for details see Conroy & Gunn
2010). Throughout this work, we adopt the MILES stellar library and the MIST isochrones. Since the W3 and UV+IR
SFR tracers are based on emission from a large wavelength
range, these indicators depends on the dust attenuation prescription. We assume a uniform screen with Cardelli et al.
(1989) attenuation curve and an opacity of τ = 0.5 at 5500 Å,
motivated by findings by Salim et al. (2018) in the local universe. Changing this prescription does not affect our findings
here significantly. As expected, and shown in Appendix C,
the Hα SFR indicator shows a rapid response function, followed by the FUV SFR indicator and the other indicators.
Figure 8 shows the effect on the SFH by convolving the
SFH with the response functions for the different indicators.
In particular, the upper panel shows the distance from the
MS, while the lower panel shows the absolute SFR under
the assumption that the MS has a SFR of 1 M yr−1 at
all times and masses. This SFH has PSD described with a
high frequency power-law slope of α = 2 and a decorrelation
timescale of τbreak = 100 Myr.
The SFR inferred from Hα traces the intrinsic SFH
well, only missing fluctuations on the shortest timescale (∼ 4
Myr). All other tracers, which probe longer timescales, show
a much larger differences compared to the intrinsic SFH. We
find that the SFHs are not only smoother, but because of

3

https://github.com/cconroy20/fsps

MNRAS 000, 1–24 (2019)

the long-timescale tail in the response function, the SFRs are
biased high. There is an overall mean offset of the MS. Additionally, we find that all the variability on short timescales
(< 20 Myr) are washed out, giving rise to a narrower MS
width. This is overall consistent with the simple analysis
presented in the previous section.

4.2

Shape of the MS as seen by different SFR
indicators: normalization and scatter

We go now one step further and look how the effect on the
MS depends on the PSD itself. Figure 9 is a remake of Figure 4, showing the distribution of the distances from the MS
ridgeline for different SFR indicators. We see the same qualitative behavior that we discussed extensively in Figure 4,
when we discussed the simplified case in which we simply
averaged SFRs over a certain timescale. Measurements in
Hα, which probe star-formation on the shortest timescale,
follows the intrinsic distribution closely for all but the most
“bursty” set of parameters. On the other hand, all other indicators show some level of deviation, and produce a narrower
distribution that is offset from the intrinsic value of the MS.
Indicators that act on longer time-scales tend do produce
narrower distributions, which is in very good aggrement with
observations (e.g., Figure 7 from Davies et al. 2019). The differences in the shapes, even if not so pronounced as in the
simple case shown in Figure 4, can be again used to infer
the intrinsic properties of the underlying stochastic process.
Although both the normalisation as well as the width
of the MS as seen by different indicators can in principle be
used to derive the PSD, we are focusing now on the width

Caplar & Tacchella

log SFRFUV /SFRH

1.5

log SFRFUV /SFRH

break = 10 Myr

= 1.0,

break = 100 Myr

= 1.0,

break = 1000 Myr

1.0

0.5
0.5

0.0
0.5
1.5

= 2.0,

break = 10 Myr

= 2.0,

break = 100 Myr

= 2.0,

break = 1000 Myr

0.0

1.0
0.5
0.0
0.5
1.5

log SFRFUV /SFRH

= 1.0,

1.0

log SFR1Myr /SFR100Myr

16

0.5

= 3.0,

break = 10 Myr

= 3.0,

break = 100 Myr

= 3.0,

break = 1000 Myr

1.0

1.0

0.5
0.0
0.5

1.5
0.5

0.0

0.5

1.0

log SFRu /SFRH

1.5 0.5

0.0

0.5

1.0

log SFRu /SFRH

1.5 0.5

0.0

0.5

1.0

log SFRu /SFRH

1.5

Figure 11. The distribution of galaxies in the plane of SFRFUV /SFRHα versus SFRu /SFRHα . Each panel shows the resulting distributions
for a given PSD, with increasing α and τbreak from top left to bottom right. The color-coding corresponds to the ratio of the SFR measured
over 1 Myr and the SFR measured over 100 Myr. The shapes of these distributions differ - highlighting the possibility to constrain the
PSD with such observations.

of the MS. We do this because the overall normalisation
depends on the exact conversion used to derive SFRs from
fluxes, which are uncertain and depend on several assumption like the IMF, metallicity, as well as the assumed SFH.
On the other hand, the width of the MS is a relative measure that depends only on the rank-ordering in the galaxy
sample and as such it is largely independent on the exact
flux-SFR conversion.
Figure 10 shows how the scatter of the MS changes when
traced by different SFR indicators. This figure assumes that
the intrinsic width of the MS is 0.4 dex (probed on a 1 Myr
timescale). Specifically, each panel shows the MS scatter as
a function of the PSD parameters α and τbreak . We see a similar pattern that we have also seen when we have discussed
“burstiness” (Figure 3). Consistent with the previous figure,
measurements in Hα follow the intrinsic width closely for
large parts of the parameter space. Measurements in other
indicators that depend more heavily on the previous SFH
provide a measurement which is less readily interpretable.
In general, as discussed in Section 2, processes with low α
and τbreak that oscillate wildly, lead to tighter observed MS,
courtesy of the central limit theorem. Although measured

width in different indicators are relatively similar, the differences between them enable us to constraint parameters
of the underlying process in Section 5.

4.3

Ratio of SFRs with different indicators

We now move forward to a MS-independent discussion and
directly compare different SFR tracers with each other in
Figure 11. Specifically, we plot the ratio of FUV and Hα
SFRs versus the ratio of u-band and Hα SFRs. The colorcoding corresponds to the ratio of the SFR measured over 1
Myr and the SFR measured over 100 Myr. There are three
trends visible from this figure. Firstly, the tightness of the
relation increases with increasing burstiness. This arises because all SFR indicators probe the same SFR if the SFR
varies on shorter timescales than the timescales of the SFR
indicators. Secondly, the slope decreases with decreasing
burstiness. This can be explained by the fact that the Hα and
FUV SFR indicators are able to probe short-term variability
better than the u-band SFR indicator, which, in the case of
slowly varying SFHs, leads to a FUV-to-Hα ratio close to 1
while the u-band-to-Hα ratio shows significantly more scatMNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
ter. Thirdly, the color-coding shows that if the SFH quickly
increases, Hα is able to probe this, leading to ratios smaller
than 1, while if the SFH quickly decreases, the ratios are all
larger than 1. Overall, this figure highlights that – in the
framework presented in this work – there are quantifiable
consequences which arise when simply investigating the relation between the SFR measured with different indicators.

5

OBSERVATIONAL CONSTRAINTS

In this section, we wish to apply our insights about different stochastic processes and their influence on observed MS
properties. The main goal is to use the MS width measurements to determine parameters of the stochastic process,
i.e., slope α and decorrelation timescale τbreak of the PSD,
that govern the evolution of star-forming galaxies about the
MS ridgeline. The analysis in this section should be regarded
only as a proof of concept as we work with the simplest possible assumptions, in order to highlight the power of our approach. We show that the result for the parameters that we
derive are consistent when using different indicators, which
is highly encouraging.

5.1

Main result

The ideal dataset should contain statistically significant
sample of galaxies and be covered in a several observational
bands, in order to check consistency between different SFR
indicators. Additionally, the analysis is simplified in the case
of a galaxy sample at low redshift. This is because of (a) the
slow evolution of the MS as a function of time, which simplifies interpretation of measured SFRs as an offset from
the virtually non-changing MS; and (b) the slow growth of
mass, meaning that measurement of total stellar mass and
star-formation are independent quantities. We discuss these
issues more in Section 5.2. Additionally, low redshift sample
also avoids potential problems and systematics that might
arise due to K-correction.
We find the measurement of the MS width presented
in Davies et al. (2019) to be well suited for this analysis.
Davies et al. (2019) used data from Galaxy and Mass Assembly Survey (GAMA; Driver et al. 2011; Liske et al. 2015;
Driver et al. 2016; Baldry et al. 2018) and conducted an
analysis which was explicitly measuring width of the MS
with different SFR indicators. The sample consists of 9005
galaxies and is restricted to z < 0.1, satisfying our requirement to work with a large sample at low redshift. It includes
only galaxies which are not classified as being a member of
a group or a pair in the GAMA group catalogue, as described in Robotham & Driver (2011). This means that our
final result will be more suited to describing star-formation
fluctuations due to “secular” evolution instead of mergers.
We consider the following measurements: (a) extinctioncorrected Hα SFRs, measured with the process outlined in
Gunawardhana et al. (2011); Hopkins et al. (2013); Gunawardhana et al. (2015) and using line measurements from
Gordon et al. (2017), (b) UV+IR SFRs, derived from the
galaxy spectra as described in Brown et al. (2014), and (c)
extinction-corrected u-band SFRs from rest-frame u-band
luminosity Davies et al. (2016). SFRs have been derived usMNRAS 000, 1–24 (2019)

17

ing Chabrier IMF. We refer the reader to Davies et al. (2019)
for more details.
We consider MS width measurements for SFR selected
galaxies between 1010.0 and 1010.5 M as we expect that the
measurement errors are the smallest for this subset of galaxies. Furthermore, more massive galaxies are transitioning
from the star-forming to the quiescent population (quenching, e.g., Peng et al. 2010), which could lead to an artificially large scatter of the MS, which itself would depends
heavily on the selection of star-forming galaxies. We estimate, using Equation (27) from Peng et al. (2010) with reasonable quenching time of 1 Gyr, that only around 2% of
star-forming galaxies at this mass are being “quenched” at
redshift 0. Additionally, considering the rather narrow mass
range makes our result less affected by possible variations of
dust and IMF within the sample. In order to then derive the
observational constraints, we assume a relative error on the
ratios of 7% to include possible observational uncertainties
in the error budget (Davies et al. 2019).
The final result is shown in Figure 12. As elaborated in
Section 3, we consider ratios of the MS widths measured with
different indicators to reduce the influence of the unknown
intrinsic width of the MS on our measurement. We see the
similar structure as in Figure 7, with the general degeneracy
between α and τbreak . We wish to highlight the consistency
between the parameter space covered by all three combination of the indicators used, albeit the ratio σu,MS /σUV+IR,MS
is quite uninformative as it covers large part of the considered parameters space. Nevertheless, we find the consistency
between all of the indicators very encouraging, especially
given the simplicity of our assumptions and minimal consideration of the dust and IMF effects.
Unfortunately, with this data and simplicity of our analysis is not possible to resolve the degeneracy between α and
τbreak , as it has been possible in the simplified case considered in Section 3.2. This is due to combination of two
factors. Firstly, this is due to larger uncertainties in the observational measurement of the σMS , driven by the smaller
number of galaxies in the sample and by the observational
uncertainties. Secondly, fact that realistic indicators are not
a simple step functions but have non-trivial time dependence
that mixes many timescales reduces our ability to differentiate between the influence of α and τbreak in observations
(see Figure 10 and Appendix C).
In order to quantify our final result in one number, we
report τbreak after setting the high-frequency slope at α = 2,
i.e., for the case of damped random walk. We emphasize
however that the data itself does not prefer α = 2 over any
other particular value for α and our choice for reporting
τbreak for damped random walk is driven by theoretical and
empirical reasons outside of the scope of this paper. The
first reason for considering the damped random walk is its
theoretical and physical simplicity. Secondly, the slope of
α = 2 is seen when studying time-variability properties of
galaxies in simulations (Iyer et al. in prep.). In the case of
α = 2, we find that the region of the τbreak parameter space
that is within 1-σ contours for all combinations of indicators is given with τbreak = 178+104
Myr. We intentionally do
−66
not conduct further statistical consideration of the allowed
region, given that we believe that systematic uncertainties,
due to variation of dust, IMF and observational uncertainties dominate our error budget and would make any such

18

Caplar & Tacchella
4.0

u/ H
UV + IR/ H
u/ UV + IR

3.5
3.0
2.5
2.0
1.5

1.0
1.00 1.25 1.50 1.75 2.00 2.25 2.50 2.75 3.00

log

break

[Myr]

Figure 12. Observational constraints on the PSD. We plot current observational constraints from the width of the MS in the
plane of α and τbreak . Specifically, the blue, red and green shaded
regions show the constraints obtained from the ratio of the width
of the MS as measured using the u-band and Hα, UV+IR and
Hα, and u-band and UV+IR, respectively. The overlapping region
gives a tighter constraint in τbreak than α. Assuming α ≈ 2, we obtain τbreak = 178+104
Myr, which is indicated by the horizontal red
−66
errorbar.

analysis highly uncertain. We do note that measurement of
the width of MS by other indicators available in Davies et al.
(2019) are in broad agreement with the estimated value that
is reported above.

5.2
5.2.1

Discussion
Mass dependence

The result of τbreak = 178+104
Myr that we have derived is
−66
only valid for the sample that we considered, consisting of
isolated galaxies with log(M?/M ) = 10.0−10.5. As such, the
derived timescale is not necessarily the same for the whole
range of masses and environments in the Universe. We do
note that there is a mass dependence in the measurements
of the width of the MS in Davies et al. (2019). We do not
conduct the mass dependence analysis in this work given the
possible mass dependence in the dust and IMF properties.
We do however note that the measured widths of the MS
suggest similar or somewhat shorter timescale for τbreak for
the smaller masses within the dataset (8 < log(M/M ) < 10),
with some dependence on the exact set of indicators used.

5.2.2

complete SFH of the galaxy. Hence, the measurement of the
MS width is only meaningful if the total stellar mass added
over the period that a given indicator is measuring is small
compared to the total stellar mass of a galaxy. Given that
the mass doubling time for star-forming galaxies today is
very long, i.e., comparable to Hubble time, the mass added
over the time effectively probed by the different indicators is
negligible (see also Appendix D). This effect, however, needs
to be accounted for at higher redshifts (e.g., z > 1) where
the timescale of the measurement of star-formation in slowresponse indicators starts being a non-negligible fraction of
the lifetime of the Universe (e.g., Tacchella et al. 2018).
Similarly, when conducting our analysis of observational
results we have assumed that the overall change of the mean
SFR of the MS is negligible. Consider the timescale of 400
Myr, which is more than twice as long as the τbreak derived
above. We show in Appendix C that by this timescale all of
the considered indicators have outputted more than 60% of
their complete luminosity, i.e., are very weakly sensitive to
the star-formation on longer timescales. If we assume relatively steep evolution of the sSFR of the MS, such as (1 + z)3
(e.g., Lilly et al. 2013, and references therein), we find that
the ratio between sSFRMS (400 Myr)/sSFRMS (today) ≈ 1.1 .
As such this change will have minimal effect on the inferred
result in this study, but it needs to be considered at higher
redshifts.
Finally, observational uncertainties introduce scatter
and, hence, increase the MS width obtained by Davies et al.
(2019). These uncertainties arise, beside other things, from
the aperture correction, the dust attenuation correction, and
the assumption that all galaxies have the same IMF and
metallicity. It is beyond the scope of this paper to assess the
impact of those uncertainties in detail, but these all contribute to relatively large error on measured σind,MS that we
have used.

Caveats

Of course, our analysis comes with several caveats. One complication that we consider is the intrinsic correlation between
the stellar mass and measured SFR. As we have elaborated,
the measured SFR can be considered as an imperfect averaging over the intrinsic SFR, where the length of this averaging
is dependent on the indicator used for the measurement. On
the other hand, the stellar mass of a galaxy is also obviously
related with the previous SFR, given by the integral over the

6

SUMMARY AND CONCLUSIONS

The knowledge of how the SFR changes as a function of time
for individual galaxies is a critical ingredient needed for understanding the evolution of galaxies. SFHs encode information about the variability on short and long timescales that
arise from different physical processes, such as gas accretion,
mergers, and feedback from stars and black holes. The best
method to model, and mathematical describe, SFHs is is still
being debated.
In this paper, we present a framework for modelling
SFHs of galaxies as a stochastic process. We focus on starforming galaxies and assume that a stochastic process describes how these galaxies move about the MS ridgeline. We
also assume that at any moment the intrinsic distribution of
SFRs around the MS ridgeline is log-normal. We define this
stochastic process through a power spectrum density. The
functional form of the PSD is given by a broken power-law,
with high-frequency slope α that flattens out at a frequency
corresponding to τbreak . The physical meaning of the PSD
is that SFHs are correlated on short timescales, where the
strength of this correlation is described by the slope α, and
they decorrelate to resemble white noise at a timescale that
is proportional to τbreak . Specifically, when the slope of the
PSD is shallow and/or τbreak is small, the SFH violently osMNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
cillates around the mean and is very quickly decorrelated.
On the other hand, steeper slopes and longer τbreak lead to
slower oscillations and a more correlated behavior.
We demonstrate that, even though we can not observationaly follow the time-evolution of individual galaxies, we
can deduce the properties of the stochastic process. This can
be done by measuring properties of the MS, such as the MS
normalisation and the MS scatter, with different observational indicators that are sensitive to different timescales.
There exists a degree of degeneracy between the influence of
the parameters α and τbreak , that can be roughly described
by the “burstiness”, i.e., by the fact that galaxies described
with smaller α and shorter τbreak tend to more often have
SFRs which are outside of the 1-σ width of the MS. We
show that this degeneracy can be broken, in principle, by
measuring the properties of the MS in several observational
indicators.
We then consider realistic observational SFR indicators,
and show results for the measured properties of the MS in
Hα, FUV, NUV, u-, W3 and UV+IR bands. We use those
results to, as a proof of concept, deduce parameters of the
underlying stochastic process from the data from the GAMA
survey, presented in Davies et al. (2019). For a sample of
isolated galaxies with log(M?/M ) = 10.0 − 10.5 and using
MS widths measured from Hα, u- and UV+IR bands, we
find the area of the parameter space that is consistent with
this data. With an assumption that the high-frequency slope
Myr. The
is given with α = 2, we obtain τbreak = 178+104
−66
motivation for α = 2 stems from numerical simulations as
well as the theoretical attractiveness of the damped random
walk process. The quoted errobars are deduced from the
observational 1-σ errors of all the available indicators.
Our result of τbreak ≈ 200 Myr indicates that the SFHs
of galaxies decorrelate, i.e., lose memory of their previous
SFH, on roughly this timescale. This is shorter than the
dynamical time of the dark matter halo, which is roughly
10% of the Hubble time (i.e., a bit more than a Gyr at z ∼
0). Therefore, we conclude that baryonic effects within the
halos, which act on dynamical timescales of galaxies, play an
important role in shaping the SFHs of galaxies. Examples of
such effects could include feedback and reincorporation of
galactic winds.
In the future, we will apply this framework to a wide
range of numerical and semi-analytical models, where we can
measure the PSD directly of the models’ SFHs. Preliminary
results show that the obtained PSDs are well described by a
broken power-law with nearly all theoretical models producing α ≈ 2, while having different values for τbreak . We show
that the PSD is set by physical ingredients in the models
and hence that the PSD contains a wealth of information
that has not yet been researched. On the observational side,
we will address many issues that complicate precise determination of the PSD in observations, including possible variations in the IMF and dust attenuation. There we also wish to
use these insights to analyse properties of galaxies at higher
redshifts, where it is especially important to consider these
complications.
MNRAS 000, 1–24 (2019)

19

ACKNOWLEDGEMENTS
We thank Luke Davis for sharing his measurements from
the GAMA survey with us. Furthermore, we are thankful
to Charlie Conroy, Luke Davis, Daniel Eisenstein, Kartheik
Iyer, Ben Johnson, Daniel Kelson, Joel Leja, and Michael
Strauss for very useful comments. We thank Sophie Reed
and Hassan Siddiqui for proofreading the manuscript. This
research made use of NASA’s Astrophysics Data System
(ADS), the arXiv.org preprint server, the Python plotting
library matplotlib (Hunter 2007), astropy, a communitydeveloped core Python package for Astronomy (Astropy Collaboration et al. 2013), and the python binding of FSPS
(Foreman-Mackey et al. 2014). S.T. is supported by the
Smithsonian Astrophysical Observatory through the CfA
Fellowship.

REFERENCES
Abramson L. E., Gladders M. D., Dressler A., Oemler Jr. A.,
Poggianti B., Vulcani B., 2015, ApJ, 801, L12
Applebaum E., Brooks A. M., Quinn T. R., Christensen C. R.,
2018, preprint, (arXiv:1811.00022)
Astropy Collaboration et al., 2013, A&A, 558, A33
Baldry I. K., Glazebrook K., Brinkmann J., Ivezić Ž., Lupton
R. H., Nichol R. C., Szalay A. S., 2004, ApJ, 600, 681
Baldry I. K., et al., 2018, MNRAS, 474, 3875
Barro G., et al., 2017, ApJ, 840, 47
Behroozi P. S., Wechsler R. H., Conroy C., 2013, ApJ, 770, 57
Boogaard L. A., et al., 2018, A&A, 619, A27
Bouché N., et al., 2010, ApJ, 718, 1001
Brinchmann J., Charlot S., White S. D. M., Tremonti C., Kauffmann G., Heckman T., Brinkmann J., 2004, MNRAS, 351,
1151
Brown M. J. I., et al., 2014, ApJS, 212, 18
Calzetti D., et al., 2007, ApJ, 666, 870
Caplar N., Lilly S. J., Trakhtenbrot B., 2015, ApJ, 811, 148
Caplar N., Lilly S. J., Trakhtenbrot B., 2017, ApJ, 834, 111
Caplar N., Lilly S. J., Trakhtenbrot B., 2018, ApJ, 867, 148
Cardelli J. A., Clayton G. C., Mathis J. S., 1989, ApJ, 345, 245
Carnall A. C., Leja J., Johnson B. D., McLure R. J., Dunlop J. S.,
Conroy C., 2018, preprint, (arXiv:1811.03635)
Carollo C. M., et al., 2013, ApJ, 773, 112
Ceverino D., Klypin A., Klimek E. S., Trujillo-Gomez S.,
Churchill C. W., Primack J., Dekel A., 2014, MNRAS, 442,
1545
Chabrier G., 2003, PASP, 115, 763
Chang Y.-Y., van der Wel A., da Cunha E., Rix H.-W., 2015,
ApJS, 219, 8
Cluver M. E., et al., 2014, ApJ, 782, 90
Connolly S., 2015, preprint, (arXiv:1503.06676)
Conroy C., 2013, ARA&A, 51, 393
Conroy C., Gunn J. E., 2010, ApJ, 712, 833
Conroy C., Gunn J. E., White M., 2009, ApJ, 699, 486
Daddi E., et al., 2007, ApJ, 670, 156
Daddi E., et al., 2010, ApJ, 713, 686
Damjanov I., Hwang H. S., Geller M. J., Chilingarian I., 2014,
ApJ, 793, 39
Damjanov I., Zahid H. J., Geller M. J., Utsumi Y., Sohn J.,
Souchereau H., 2018, preprint, (arXiv:1809.10705)
Davé R., Finlator K., Oppenheimer B. D., 2012, MNRAS, 421,
98
Davies L. J. M., et al., 2015, MNRAS, 452, 616
Davies L. J. M., et al., 2016, MNRAS, 461, 458
Davies L. J. M., et al., 2019, MNRAS, 483, 1881
Dekel A., Mandelker N., 2014, MNRAS, 444, 2071

20

Caplar & Tacchella

Dexter J., Agol E., 2011, ApJ, 727, L24
Djorgovski S., Davis M., 1987, ApJ, 313, 59
Driver S. P., et al., 2011, MNRAS, 413, 971
Driver S. P., et al., 2016, MNRAS, 455, 3911
Elbaz D., et al., 2007, A&A, 468, 33
Emmanoulopoulos D., McHardy I. M., Uttley P., 2010, MNRAS,
404, 931
Faber S. M., Jackson R. E., 1976, ApJ, 204, 668
Fagioli M., Carollo C. M., Renzini A., Lilly S. J., Onodera M.,
Tacchella S., 2016, ApJ, 831, 173
Feldmann R., 2017, MNRAS, 470, L59
Foreman-Mackey D., Sick J., Johnson B., 2014, Zenodo
Freeman P., Rosolowsky E., Kruijssen J. M. D., Bastian N.,
Adamo A., 2017, MNRAS, 468, 1769
Genzel R., et al., 2010, MNRAS, 407, 2091
Genzel R., et al., 2015, ApJ, 800, 20
Gladders M. D., Oemler A., Dressler A., Poggianti B., Vulcani
B., Abramson L., 2013, ApJ, 770, 64
Goh K.-I., Barabási A.-L., 2008, EPL (Europhysics Letters), 81,
48002
Gordon Y. A., et al., 2017, MNRAS, 465, 2671
Graves G. J., Schiavon R. P., 2008, ApJS, 177, 446
Grudić M. Y., Hopkins P. F., Faucher-Giguère C.-A., Quataert
E., Murray N., Kereš D., 2018, MNRAS, 475, 3511
Gunawardhana M. L. P., et al., 2011, MNRAS, 415, 1647
Gunawardhana M. L. P., et al., 2015, MNRAS, 447, 875
Guo K., Zheng X. Z., Fu H., 2013, ApJ, 778, 23
Guo Y., et al., 2016, ApJ, 833, 37
Henriques B. M. B., White S. D. M., Thomas P. A., Angulo R.,
Guo Q., Lemson G., Springel V., Overzier R., 2015, MNRAS,
451, 2663
Hollyhead K., Bastian N., Adamo A., Silva-Villa E., Dale J., Ryon
J. E., Gazak Z., 2015, MNRAS, 449, 1106
Hopkins A. M., et al., 2013, MNRAS, 430, 2047
Hopkins P. F., Kereš D., Oñorbe J., Faucher-Giguère C.-A.,
Quataert E., Murray N., Bullock J. S., 2014, MNRAS, 445,
581
Hunter J. D., 2007, Computing In Science & Engineering, 9, 90
Ivezić, Ž., Connolly, A. J., Vanderplas, J. T. and Gray, A. 2014,
Statistics, Data Mining and Machine Learning in Astronomy.
Princeton University Press
Iyer K., Gawiser E., 2017, ApJ, 838, 127
Iyer K., et al., 2018, ApJ, 866, 120
Johnson B. D., et al., 2013, ApJ, 772, 8
Kelly B. C., Bechtold J., Siemiginowska A., 2009, ApJ, 698, 895
Kelly P. L., et al., 2015, Science, 347, 1123
Kelson D. D., 2014, preprint, (arXiv:1406.5191)
Kelson D. D., Benson A. J., Abramson L. E., 2016, preprint,
(arXiv:1610.06566)
Kennicutt Jr. R. C., 1998, ARA&A, 36, 189
Kennicutt R. C., Evans N. J., 2012, ARA&A, 50, 531
Kormendy J., 1977, ApJ, 218, 333
Lawrence A., 2018, Nature Astronomy, 2, 102
Leitner S. N., 2012, ApJ, 745, 149
Leja J., et al., 2018a, arXiv e-prints,
Leja J., Carnall A. C., Johnson B. D., Conroy C., Speagle J. S.,
2018b, preprint, (arXiv:1811.03637)
Lilly S. J., Carollo C. M., Pipino A., Renzini A., Peng Y., 2013,
ApJ, 772, 119
Liske J., et al., 2015, MNRAS, 452, 2087
MacLeod C. L., et al., 2010, ApJ, 721, 1014
MacLeod C. L., et al., 2012, ApJ, 753, 106
Madau P., Dickinson M., 2014, ARA&A, 52, 415
Marinucci D., Robinson P. M., 1999, Journal of Statistical Planning and Inference, 80, 111
Matthee J., Schaye J., 2018, preprint, (arXiv:1805.05956)
Mosleh M., Tacchella S., Renzini A., Carollo C. M., Molaeinezhad

A., Onodera M., Khosroshahi H. G., Lilly S., 2017, ApJ, 837,
2
Muñoz J. A., Peeples M. S., 2015, MNRAS, 448, 1430
Murray N., Quataert E., Thompson T. A., 2010, ApJ, 709, 191
Noeske K. G., et al., 2007, ApJ, 660, L47
Pacifici C., et al., 2016, ApJ, 832, 79
Peng Y.-j., et al., 2010, ApJ, 721, 193
Peng Y., Maiolino R., Cochrane R., 2015, Nature, 521, 192
Pillepich A., et al., 2018, MNRAS, 473, 4077
Porter L. A., Somerville R. S., Primack J. R., Johansson P. H.,
2014, MNRAS, 444, 942
Priestley M. B., 1981, Spectral Analysis and Time Series. Academic Press
Robotham A. S. G., Driver S. P., 2011, MNRAS, 413, 2570
Rodighiero G., et al., 2010, A&A, 518, L25
Rodrı́guez-Puebla A., Primack J. R., Behroozi P., Faber S. M.,
2016, MNRAS, 455, 2592
Salim S., Boquien M., Lee J. C., 2018, ApJ, 859, 11
Schaye J., et al., 2015, MNRAS, 446, 521
Schreiber C., et al., 2015, A&A, 575, A74
Shivaei I., et al., 2018, ApJ, 855, 42
Simm T., Salvato M., Saglia R., Ponti G., Lanzuisi G., Trakhtenbrot B., Nandra K., Bender R., 2016, A&A, 585, A129
Somerville R. S., Davé R., 2015, ARA&A, 53, 51
Speagle J. S., Steinhardt C. L., Capak P. L., Silverman J. D.,
2014, ApJS, 214, 15
Tacchella S., Trenti M., Carollo C. M., 2013, ApJ, 768, L37
Tacchella S., Dekel A., Carollo C. M., Ceverino D., DeGraf C.,
Lapiner S., Mandelker N., Primack Joel R., 2016, MNRAS,
457, 2790
Tacchella S., Carollo C. M., Faber S. M., Cibinel A., Dekel A.,
Koo D. C., Renzini A., Woo J., 2017, ApJ, 844, L1
Tacchella S., Bose S., Conroy C., Eisenstein D. J., Johnson B. D.,
2018, ApJ, 868, 92
Tacconi L. J., et al., 2013, ApJ, 768, 74
Tarnopolski M., 2016, Physica A Statistical Mechanics and its
Applications, 461, 662
Thomas D., Maraston C., Bender R., Mendes de Oliveira C., 2005,
ApJ, 621, 673
Timmer J., Koenig M., 1995, A&A, 300, 707
Torrey P., et al., 2018, MNRAS, 477, L16
Vogelsberger M., et al., 2014, MNRAS, 444, 1518
Weisz D. R., et al., 2012, ApJ, 744, 44
Whitaker K. E., van Dokkum P. G., Brammer G., Franx M., 2012,
ApJ, 754, L29
Whitaker K. E., et al., 2014, ApJ, 795, 104
Williams C. C., et al., 2017, ApJ, 838, 94
Zahid H. J., Geller M. J., 2017, ApJ, 841, 32
Zolotov A., et al., 2015, MNRAS, 450, 2327
van der Wel A., et al., 2014, ApJ, 788, 28

APPENDIX A: FRACTIONAL BROWNIAN
MOTION AND HURST PARAMETER
In this appendix, we shortly discuss the connection between
the description of the stochastic processes that we have used
in this work and the fractional Brownian motion described
with the Hurst parameter, as used in Kelson (2014)4 . Frac-

4

Here we discuss “type 2” fractional Brownian motion, which is
more suited for descriptions of physical process as in that description the future events are only dependent on the previous events.
“Type 1” processes are dependent on both future and past events,
violating causality.
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories
1.0

3.5

0.9

Hurst parameter

4.0

3.0

0.8

2.5

0.7

2.0

case, it is crucial to note that any such a connection is essentially only an approximation, given the different definitions
of both processes. In Figure A1 we show the Hurst parameter
which best approximates the SFHs generated with different
α and τbreak . The SFHs used here have a length of 4.2 Gyr
as described in Section 2.3. We see similar dependence as in
when we have discussed “burstiness” and widths of the MS
measured in different indicators. As expected, a larger Hurst
parameter is found for SFHs that are well correlated (larger
τbreak and α) while less correlated, “bursty” SFHs (smaller
τbreak and α) lead to lower Hurst parameters.

0.6

1.5
1.01.0

1.5

log

2.0
break

2.5

3.0

[Myr]

0.5

Figure A1. Hurst parameter, H, in the plane of the break
timescale τbreak and power-law slope α of the PSD. H increases
towards ∼ 1 with increasing τbreak and α, consistent with the SFHs
shown in Figures 1 and 2. At α > 2 and log τbreak /Myr > 1.5, the
Hurst parameter converges to ∼ 1 and is not able to quantify any
differences in the PSD.

APPENDIX B: CONNECTION BETWEEN
STAR-FORMATION MEASUREMENTS IN
DIFFERENT INDICATORS
In this appendix we extend our analytical calculation of the
measured width of MS, as seen after measurement in different indicators. We start by noticing that the star formation
rate measured by a given indicator is connected to the previous star formation and is given by the intensity of that
star-formation episode and a response of that particular indicator to the star formation, i.e.,
SFRind (t) = SFR(t 0 ) find (t − t 0 ),

tional Brownian motion is process described with the ACF
(Marinucci & Robinson 1999):

ACF(t) =


 



1
1
1
−(t)2H g
+ (t + 1)2H + (t − 1)2H g
− t 2H
2
t
t−1
(A1)

g(t ) = 1 + 2H

(B1)

where SFRind is the measured star-formation, SFR is the actual star-formation, and find are response functions (the ones
that we have used in this work are presented in Appendix
C). In the case of continuous star-formation the measured
star-formation is given by
∫ t
SFRind (t) =
SFR(t 0 ) find (t − t 0 )dt 0,
(B2)
−∞

where
0

21

∫ t0 
0

(1 + s) H−1/2 − s H−1/2

2

ds,

(A2)

and H is called the “Hurst exponent” or “Hurst parameter”
and it is bound between 0 and 1. In the limit when t → ∞
the relation simplifies to (Marinucci & Robinson 1999):

1
(t + 1)2H − 2(t)2H + (t − 1)2H .
(A3)
ACF(t) =
2
Tarnopolski (2016) shows that when H > 1/2, which describes a physically interesting case where observations are
more correlated at shorter timescales, the autocorrelation
function behaves as ACF(t) ∝ t 2−2H . The fact that the ACF
decreases slower than t −1 is often expressed as a statement
that the process has a “long-range” dependence. One can
compare this to ACFs that we present in right panel of Figure 2 (see also Equation (4)), which all reach ACF(t) ∼ 0
at timescales correlated with τbreak . In other words, by
modelling the PSD as broken power law, where the smallfrequency slope is zero (mimicking white noise), we have
explicitly allowed for the system to decorrelate.
Given that the processes that we use in this work have
an explicit timescale built into them through the τbreak parameter, we see that any connection that we want to derive
between these two different approaches (fractional Brownian
motion and broken-law PSD) will fundamentally depend on
the timescale over which the connection is measured. In any
MNRAS 000, 1–24 (2019)

where we have convolved the total star-formation history
with an appropriate response function up to the time of the
measurement. When discretized the above integral is written
as a sum
SFRind (ti ) =

∞
Õ

SFR(ti − t j )wind (t j ),

(B3)

t j =0

where SF Rind (ti ) is the measured star-formation in bin ti and
wind (t j ) is the discretized version of the response function:
wind (t j ) =

∫ t j +δ/2
t j −δ/2

find (t 0 )dt 0,

(B4)

where δ is the duration of the discretization bin. In this
work we use δ = 1 Myr (see Section 2 for justification of this
time-scale).
Now, consider the ensemble of galaxies moving around
Main-Sequence in stochastic fashion with a log-normal distribution function. Lets denote with ∆5 log-distance from
the median value of MS i.e., (see Equations (8) and (9)):
∆ = log SFR − log SFRMS .

5

(B5)

As mentioned in the main body of the text, we use just ∆ as
shorthand for ∆MS in order to reduce the size and complexity of
our expressions.

22

Caplar & Tacchella
ering only the first term of the expansion above :

We rewrite the Equation (B3) in terms of ∆:

∞
∞
Õ

∆ind (ti ) = log

10∆(ti −t j ) wind (t j ).

(B6)

t j =0

We note that that factors in the exponent ∆(i − j) are in
general expected to be small as they are bound by the width
of the MS. In that case we can use the MacLauren expansion:

10 x = 1 + ln(10)x +

1
1
ln(10)2 x 2 + ln(10)3 x 3 + ...
2
6

∞
Õ


 
− E ∆(ti − t j )wind (t j ) E ∆(ti − t j 0 )wind (t j 0 )
∞ Õ
∞


Õ
=
wind (t j )wind (t j 0 )E ∆(ti − t j )∆(ti − t j 0 )
t j =0 t j 0 =0

=

∞ Õ
∞
Õ
t j =0 t j 0 =0

2
= σMS



wind (t j )wind (t j 0 ) · COV ∆(ti − t j ), ∆(ti − t j 0 )

∞ Õ
∞
Õ
t j =0 t j 0 =0

wind (t j )wind (t j 0 )ACF(t j − t j 0 ),
(B11)

1 + ln(10)∆(ti − t j )

j=0


1
+ ln(10)2 ∆2 (ti − t j ) + .... wind (t j )
2
 Õ
∞
© ∞
©Õ
ª
ª
= log ­
wind (t j )® + ln(10) ­
∆(ti − t j )wind (t j )®
 j=0
«t j =0
¬
¬
«

∞
Õ

1
©
ª
+ ln(10)2 ­
∆2 (ti − t j )wind (t j )® + ....
2

«t j =0
¬


∞
Õ

= log 1 + ln(10)
∆(ti − t j )wind (t j )

t j =0


∞

1
©Õ 2
ª
+ ln(10)2 ­
∆ (ti − t j )wind (t j )® + .... .
2

«t j =0
¬

(B8)
where we have used the property that the response function
Í
has to sum to unity, i.e., ∞
t j =0 wind (t j ) = 1. We now expand
the log function using

log(1 + x) =

t j =0 t j 0 =0

(B7)

Lets continue by taking first two orders of expansion above
in Equation (B7):

∆ind (ti ) = log

©Õ
ª
2
σind,MS
(ti ) = VAR ­
∆(ti − t j )wind (t j )®
«t j =0
¬
∞ Õ
∞


Õ
=
E ∆(ti − t j )wind (t j )∆(ti − t j 0 )wind (t j 0 )

x2
x3
x
−
+
+ ...
ln(10) 2 ln(10) 3 ln(10)

(B9)

and we find the expression

where we have used the fact that the co-variance of the pro2 ACF(t −t ) and where
cess is given by COV(∆(ti ), ∆(t j ) = σMS
i
j
we have used symbol E to denote expectation value. We have
also used the definition of the covariance together with the
fact that the expectation value of a stationary process equals
zero:



COV ∆(ti − t j )∆(ti ) = E ∆(ti − t j )∆(ti ) − E ∆(ti − t j ) E (∆(ti ))

= E ∆(ti − t j )∆(ti ) .
(B12)
Taking into the account next order terms in Equation (B10)
will lead to extra terms in the summation (B11), with
4 . This is bethe smallest order being proportional to σMS
3
cause all σMS terms will inevitably be connected with terms
E(∆2 (ti )) · E(∆(t j )) or E(∆(ti )) · E(∆2 (t j )) which are equal to
zero, given the stationary of our problem. For the realis4 terms are subtic widths of MS (σMS ∼0.4±0.1) these σMS
dominant and therefore lead only to relatively small corrections (e.g., see the relatively small difference between the
input and recovered parameters in Figures 6 and 7).
In the simplest case, discussed in Section 3, in which
we assume that a given SFR indicator is given by a step
function lasting N j time units, i.e.,
(
1/N j 1 ≤ t j ≤ N j
wind (t j ) =
0
otherwise.
the last expression in Equation (B11) can be written as
2
σind,MS
(ti ) =

 ∞
ln(10) © Õ 2
ª
∆ind (ti ) =
∆(ti − t j )wind (t j ) +
∆ (ti − t j )wind (t j )®
­
2 
t j =0
¬
«t j =0
2
∞
©Õ
ª 
−­
∆(ti − t j )wind (t j )®  + ...

«t j =0
¬ 
(B10)
∞
Õ

Let us now find variance of the measured MS after consid-

Nj Õ
Nj
2 Õ
σMS

N j2 t =1 t 0 =1
j
j

ACF(t j − t j 0 ),

(B13)

and we can now recognize Equation (15) used in the main
body of the text.

APPENDIX C: LUMINOSITY EVOLUTION OF
A SIMPLE STELLAR POPULATION (SSP)
As we have extensively discussed in the main text of the paper, the ability to differentiate different stochastic processes
MNRAS 000, 1–24 (2019)

Stochastic modeling of star-formation histories

0.015

0.8

Ltot( < t) / Ltot

0.020

L / Ltot

1.0

H
FUV
NUV
u band
g band
W3
UV + IR

0.025

0.010
0.005
0.000
0

23

0.6
0.4
0.2

5

10

15

time [Myr]

20

25

30

0.0 1

0

1

2

log time [Myr]

3

4

Figure C1. Luminosity evolution of different SFR tracers for a Simple Stellar Population (SSP). The left panel shows the luminosity
∫ 25Gyr
as a function of time (L(t)), in bins of 0.1 Myr, normalized by total luminosity emitted over 25 Gyr (Ltot, Ltot ≡ 0
L(t)dt). The
right panel shows the cumulative luminosity evolution. The purple, blue, cyan, green, orange and red line show the luminosity of the Hα
emission line, FUV band, NUV band, u band, g band, WISE-3 band, and UV+IR, respectively. Clearly, the Hα emission line has the
fastest reaction timescale (50% of the total luminosity is emitted in the first ∼ 3 Myr), followed by the FUV and other traces which test
redder part of the spectrum.

that govern star-formation is dependent on being able to
measure the SFR with different indicators that probe different timescales. To be sensitive to a wider range of different PSDs, these response functions of the SFR indicators
would ideally be well differentiated and cover a large range of
timescales. We show in Figure C1 the luminosity evolution,
seen in different passbands, of a Simple Stellar Population
(SSP). These are effective response functions, i.e., the observed SFH in any of these bands can be considered as a
convolution of the intrinsic SFH with these luminosity evolutions. In the left panel, we see that all of the traces exhibit
peak at early times (∼ 5 Myr), followed by an exponentiallike decline. The right panel shows the cumulative luminosity
evolution, indicating more clearly the long term behaviour
of the different indicators. Hα responds very quickly to starformation – therefore, the measurement of the MS width in
Hα is very similar to the intrinsic MS width for almost the
whole range of parameter space that we have considered, as
seen in Figure 10. As expected, the indicators corresponding
to longer wavelengths tend to have slower responses, showing long “memory” of the previous SFH. The fact that all
of these indicators are a mixture of the recent and longterm star-formation complicates matters and makes the interpretation of the measurements, such as width of MS, quite
unintuitive, but they can be modelled through simulations
(Figure 10).

APPENDIX D: TIMESCALES OF DIFFERENT
SFR TRACERS
We have shown in the main body of the manuscript how the
key relations are simplified and well understood in the case
where the SFR response function is a simple step function.
On the other hand, in Appendix C we show that the real response functions have non-trivial time dependence and that
MNRAS 000, 1–24 (2019)

they are clearly not well described by a step function. Crucially, the timescales that best approximate different SFR
tracers actually depend on the property of the SFH itself.
In practice, similar to the derivation of the luminosity-SFR
calibration, one usually assumes a constant SFR and then
determines the luminosity-weighted mean age of the stellar
population (e.g., Kennicutt 1998; Kennicutt & Evans 2012;
Madau & Dickinson 2014). A more sophisticated approach
is to consider more realistic SFHs from numerical and analytical simulations, with the caveat that the variability of
the SFHs is simulation-dependent and it might bias the measurement (e.g., Tacchella et al. 2018). Already Johnson et al.
(2013) showed – based on empirical SFHs – that fluctuations
in the SFHs alone can cause factor of ∼ 2 variations in the
UV luminosities relative to the assumption of a constant
SFH over the past 100 Myr. Thanks to our framework of
stochastic SFHs introduced in Section 2, we are able to generate and understand SFHs that have different variability
properties according to a power spectral density.
Here we are looking to derive a singular timescale over
which to average the realistic star-formation response to
best approximate complex and realistic functions with a step
function of a given duration. We will first briefly express our
problem analytically and afterwards derive these timescales
numerically for the different indicators that we used in Section 4 (Hα, FUV, NUV, u, W3 and UV+IR).
The statement about approximating realistic starformation responses as a step function can be expressed as
a search for the best Napprox to approximate Equation (B6):

< ∆(ti ) > Napprox  log

∞
Õ
t j =1

10∆(ti −t j ) wind (t j ),

(D1)

24

Caplar & Tacchella

powerlaw slope

3.0

H

2.5
2.0
1.5

powerlaw slope

1.0
3.0

u

2.5
2.0
1.5
1.01.0

1.5

log

2.0

break

2.5

[Myr]

3.0

18
16
14
12
10
8
6
4
2
0
480
420
360
300
240
180
120
60
0

100
90
80
70
60
50
40
30
20
280

FUV

W3

NUV

UV + IR

240
200
160
120
80
40

1.0

1.5

log

2.0

break

2.5

[Myr]

3.0

0

1.0

1.5

log

2.0
break

2.5

[Myr]

3.0

320
280
240
200
160
120
80
40
0
240
210
180
150
120
90
60
30
0

Figure D1. Effective timescale for different SFR tracers, as a function of parameters describing the underlying stochastic process (α
and τbreak ). Effective timescale is defined as a timescale over which the averaged SFH is most similar to actual SFR measured in a given
indicator, and is indicated by the colour bar for each panel. This timescale depend not only on the indicator used, but also on the
parameters of the stochastic process. To the first order, the burstier the SFH (see Section 2.4), the shorter the timescale. Furthermore,
the Hα and FUV SFR indicators trace the shortest timescale.

where
< ∆(ti ) > Napprox = log

NÕ
approx

10∆(ti −t j ) .

(D2)

t j =1

Comparing the expressions within the logarithms we see that
the condition simplifies to the following equation for Napprox :
NÕ
approx
t j =1

10∆(ti −t j ) =

∞
Õ

10∆(ti −t j ) wind (t j )

(D3)

t j =0

From here we can see that in order to derive Napprox we have
to consider both the properties of stochastic process, that
govern time dependence of ∆(ti − t j ) term, and various indicators with their response function described with wind (t j ).
In other words, as stated before, the timescale associated
with each SFR traces depend on the previous SFH (in addition to the properties of each indicator).
In order to derive the timescales of the different SFR
tracers numerically, we generate SFHs with different α and
τbreak , as described in Section 2. We estimate the timescale
of the SFR tracer by solving Equation (D1) in a statistical sense, by minimizing the RMS difference of the SFR
of the tracer and the intrinsic SFR averaged over different
timescales. In other words, we search for Napprox that minimizes the variance of the quantity ∆ind (ti )− < ∆(ti ) > Napprox .
In Figure D1, we present the result of this analysis for
Hα, FUV, NUV, u, W3 and UV+IR. As expected, Hα corresponds to shortest timescale while UV+IR and u-band
correspond to longer timescales (e.g., see Figure C1). We
however note large variations across the parameter space of

τ and α, confirming our intuition about the importance of
considering the underlying stochastic process on making a
statement about timescales probed by different indicators.
The differences are obviously larger for the longer indicators. Intuitively, when the indicator is very quick, as is the
case for Hα or FUV, effect of “mixing in” of the underlying
process is reduced and changes of τbreak and α that affect
longer timescale are not probed in this analysis.
For the set of parameters that we have deduced in Section 5, α = 2 and τbreak = 178+104
Myr, we find that the
−66
effective times of the indicators are teff (Hα) = 2.0+0.4
Myr,
−0.1
+8
+2
teff (FUV) = 63−1 Myr , teff (NUV) = 119−2 Myr , teff (u-band) =
164+15
Myr, teff (W3) = 96+7
Myr, and teff (UV+IR) =
−14
−16
+6
84−5 Myr. Of course, these estimates suffer from the same
caveats that we have discussed in Sections 5 and just therefore only be taken as a general guidance, rather than strict
quantitative measurement.
This paper has been typeset from a TEX/LATEX file prepared by
the author.

MNRAS 000, 1–24 (2019)

