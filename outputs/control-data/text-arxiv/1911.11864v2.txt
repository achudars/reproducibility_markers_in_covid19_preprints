Submitted to the Annals of Statistics

FRÉCHET CHANGE-POINT DETECTION∗
By Paromita Dubey and Hans-Georg Müller

arXiv:1911.11864v2 [stat.ME] 14 Jan 2020

University of California, Davis
We propose a method to infer the presence and location of changepoints in the distribution of a sequence of independent data taking values in a general metric space, where change-points are viewed
as locations at which the distribution of the data sequence changes
abruptly in terms of either its Fréchet mean or Fréchet variance or
both. The proposed method is based on comparisons of Fréchet variances before and after putative change-point locations and does not
require a tuning parameter except for the specification of cut-off intervals near the endpoints where change-points are assumed not to
occur. Our results include theoretical guarantees for consistency of
the test under contiguous alternatives when a change-point exists and
also for consistency of the estimated location of the change-point if it
exists, where under the null hypothesis of no change-point the limit
distribution of the proposed scan function is the square of a standardized Brownian Bridge. These consistency results are applicable for a
broad class of metric spaces under mild entropy conditions. Examples include the space of univariate probability distributions and the
space of graph Laplacians for networks. Simulation studies demonstrate the effectiveness of the proposed methods, both for inferring
the presence of a change-point and estimating its location. We also
develop theory that justifies bootstrap-based inference and illustrate
the new approach with sequences of maternal fertility distributions
and communication networks.

1. Introduction. Change-point detection has become a popular tool for identifying
locations in a data sequence where an abrupt change occurs in the data distribution. A data
sequence {Y1 , Y2 , . . . , Yn } has a change-point at n0 if Y1 , . . . , Yn0 comes from a distribution
P1 , while Yn0 +1 , . . . , Yn comes from a different distribution P2 . In the classical framework,
{Y1 , . . . , Yn } assume values in R. Change-point detection is an important task in many areas
and has been studied thoroughly for univariate data (Carlstein, Müller and Siegmund, 1994;
Niu, Hao and Zhang, 2016).
The multivariate setting, where the {Y1 , Y2 , . . . , Yn } take values in Rd , presents additional
challenges over the univariate case and can be considered a precursor of the even more
challenging case of metric-space valued objects that we study here; in both cases the Yi
∗

Research supported by NSF grant DMS-1712864
MSC 2010 subject classifications: Primary 60K35, 60K35; secondary 60K35
Keywords and phrases: Bootstrap, Brownian Bridge, Dynamics of Networks, Empirical Processes, Graph
Laplacians, Metric Space, Object Data, Random Densities, Random Objects

1

2

P. DUBEY AND H.-G. MÜLLER

cannot be ordered. Change-point detection in multivariate settings has been studied both
using parametric (Srivastava and Worsley, 1986; James, James and Siegmund, 1987, 1992;
Csörgö and Horváth, 1997; Chen and Gupta, 2011) and nonparametric (Lung-Yut-Fong,
Lévy-Leduc and Cappé, 2015; Matteson and James, 2014; Jirak, 2015; Wang and Samworth,
2018) approaches in various settings.
With modern statistical applications moving towards the study of more complex phenomena, statistical analysts increasingly encounter data that correspond to random objects
in general spaces that cannot be characterized as univariate or multivariate data. Often
such data objects do not even reside in Euclidean spaces, for example when one deals with
observations that correspond to sequences of networks such as brain networks or communication networks. Other types of such random objects include covariance matrices as
encountered in brain connectivity in neuroscience (Ginestet et al., 2017) and in the analysis of spoken language (Tavakoli et al., 2019), as well as sequences of random probability
distributions, which are quite common (Cazelles et al., 2018; Petersen and Müller, 2019a).
We refer to such data as random objects, which are random variables that take values in
a general metric space, generalizing the notion of random vectors. The challenge when
dealing with such data is that vector space operations are not available and one does not
have much more to go by than pairwise distances between the objects.
Existing results on change-point detection for the case when the data sequence takes
values in a general metric space are quite limited. Parametric approaches exist for change
detection in a sequence of networks (De Ridder, Vandermarliere and Ryckebusch, 2016; Peel
and Clauset, 2015; Wang, Yu and Rinaldo, 2018). These approaches have been developed
for special cases and are not applicable more generally. There are very few approaches that
are more generally applicable to metric space valued random objects, and they include
kernel based (Arlot, Celisse and Harchaoui, 2012; Garreau et al., 2018) and graph based
(Chen and Zhang, 2015; Chu and Chen, 2019) methods. A major disadvantage of the
kernel based methods is that they heavily depend on the choice of the kernel function
and its tuning parameters. Graph based methods are applicable in general metric spaces.
However, their starting point is a similarity/dissimilarity graph of the data sequence, which
then plays the role of a tuning parameter that critically impacts the resulting inference.
Graph based methods also lack theoretical guarantees for the consistency of the estimated
change-point when there is a true change-point in the data sequence; furthermore, inference
for the presence of a change-point has not yet been developed.
In this paper, we introduce a tuning-free (except for the choice of the size of small
intervals at the end-points where change-points are assumed not to occur) method for
change-point detection and inference in a sequence of data objects taking values in a general
metric space. We provide a test for the presence of a change-point in the sequence, obtain its
consistency under contiguous alternatives, and derive a consistency result for the estimated
change-point location. We consider the offline approach, where the entire sequence of data
is available to conduct inference and assume that the data objects Yi are independent
and ordered with some meaningful ordering. The starting point of the proposed method

FRÉCHET CHANGE-POINT DETECTION

3

is similar in spirit to classical analysis of variance and builds upon a recently proposed
two sample test for random objects (Dubey and Müller, 2019), aiming at inference for the
presence of differences in Fréchet means (Fréchet, 1948) and Fréchet variances for samples
of random objects.
Fréchet means and variances provide a generalization of center and spread for metric
space valued random variables. Our goal in this paper is to develop a method for the
detection and specifically a test for the presence of a change-point in terms of Fréchet
means and or Fréchet variances of the distributions of the data sequence taking values in
a general metric space. The needed assumptions are relatively weak and apply to a broad
class of metric spaces, including the space of univariate probability distributions and the
space of networks, under suitable metrics. We provide theoretical guarantees for type I error
control under the null hypothesis of no change-point by deriving a distribution free limiting
distribution of the proposed test statistic under the null, where we show that the proposed
scan function converges weakly to the square of a standardized Brownian Bridge (Theorem
1). When there is a change-point, we show that the proposed estimate of the location of
the change-point is consistent (Proposition 1 and Theorem 2) and demonstrate that the
proposed test is consistent and gains power under contiguous alternatives for increasing
sample sizes (Theorem 3). We also provide theoretical support for bootstrap versions of
the proposed test (Theorem 4).
The organization of the paper is as follows. In Section 2 we describe and explore the
proposed test statistic and motivate the proposed estimate of the location of the changepoint, starting from an improved version of the two-sample version of the Fréchet test
for random objects (Dubey and Müller, 2019). Theoretical results on the behavior of the
proposed test under the null hypothesis of no change-point and the alternative that a
change-point is present and on the estimated location of the change-point if it is present
are in Section 3, while Section 4 is devoted to a study of the finite sample performance
of the proposed test statistic under several simulation settings. The proposed inference
method for change-points is illustrated in Section 5 with an analysis of Finnish fertility
data that reflect the evolution of maternal age distributions over calendar years, and also
with change-point detection in dynamic networks for the Enron e-mail network data, where
in both cases we find strong evidence for the presence of change-points.
2. Methodology.
2.1. Model. Let Y1 , Y2 , . . . , Yn be a sequence of independent random objects taking
values in a metric space (Ω, d) that is totally bounded, i.e., for any  > 0 there is a finite
number of open -balls the union of which covers Ω. Given different probability measures
P1 and P2 on (Ω, d), we are interested to test the null hypothesis,
(2.1)

H0 : Y1 , Y2 , . . . , Yn ∼ P1

4

P. DUBEY AND H.-G. MÜLLER

against the single change-point alternative,
(2.2)

(
Y1 , Y2 , . . . , Y[nτ ] ∼ P1
H1 : there exists 0 < τ < 1 such that
Y[nτ ]+1 , Y[nτ ]+2 , . . . , Yn ∼ P2 ,

where τ denotes the change-point. In most practical situations, differences in distributions
arise either in location or in scale. Fréchet means and variances (Fréchet, 1948) provide
a generalization of the notion of location and scale for probability measures on Euclidean
spaces to the case of general metric spaces.
Our goal is to detect differences in Fréchet means or Fréchet variances of the distributions
P1 and P2 . Fréchet means µ1 and µ2 of P1 and P2 , respectively, are defined as


µ1 = argmin E1 d2 (Y, ω) where Y ∼ P1 , and µ2 = argmin E2 d2 (Y, ω) where Y ∼ P2 ,
ω∈Ω

ω∈Ω

and the corresponding Fréchet variances as


V1 = min E1 d2 (Y, ω) where Y ∼ P1 , and V2 = min E2 d2 (Y, ω) where Y ∼ P2 .,
ω∈Ω

ω∈Ω

where our assumptions below will ensure that these notions are well defined when we
employ them in the following. Here E1 (·) and E2 (·) denote expectations taken with respect
to P1 and P2 respectively, and we will use this notation throughout in the following, which
then implicitly specifies the assumed distribution of the generic random object Y . Under
the null hypothesis H0 of no change-point we have P1 = P2 = P and use the notations
µ = µ1 = µ2 and V = V1 = V2 to denote the Fréchet mean and Fréchet variance of P .
While the alternative space is the entire complement, our methods and power analysis aim
at alternatives H1 for which at least one of µ1 6= µ2 or V1 6= V2 applies, i.e., alternatives
that entail changes in mean or scale.
It is easy to see that for real valued random variables, Fréchet means and variances are
the same as the expectation and variance of the distributions P1 and P2 . For Rd valued
random variables, the Fréchet mean is the ordinary mean vector of the distribution and
the Fréchet variance corresponds to the trace of the covariance matrix, which captures the
total variability of the data. For more general spaces, for example the space of networks or
the space of probability distributions, Fréchet means provide a notion of center of the probability distribution generating the random data objects and the Fréchet variance measures
the spread of the random objects around the Fréchet mean. However the Fréchet mean
lives in the object space and therefore is not amenable to operations like addition and multiplication, while the Fréchet variance as a scalar is easier to handle. Classical analysis of
variance can provide intuition how to harness Fréchet variances to determine whether data
segments differ or not, which is essential when testing for the presence of change-points.
Like other change-point detection techniques we partition the data sequence into two
segments and then maximize differences between these segments to develop inference and

5

FRÉCHET CHANGE-POINT DETECTION

change-point estimation. Both segments need to contain a minimum number of observations
in order to represent their Fréchet means and variance adequately, and hence we assume
that τ lies in a compact interval Ic = [c, 1 − c] ⊂ [0, 1] for some c > 0, an assumption that
is commonly adopted in the Euclidean case.
2.2. Test statistic for a single change-point alternative. Here we describe how we construct the new test statistic for testing the null hypothesis H0 (2.1) of no change-point
versus the alternative H1 (2.2). Our approach is inspired by a recent two-sample test for
detecting differences in Fréchet means or Fréchet variances of metric space valued data
samples (Dubey and Müller, 2019). Each u ∈ Ic could be a possible value of τ under the
alternative. For each u ∈ Ic , we consider two data segments: A first segment consisting
of all observations that are located before [nu] and a second segment consisting of the
observations located after [nu].
Let µ̂[0,u] and V̂[0,u] denote the estimated Fréchet mean and variance of all observations
coming before [nu],
[nu]

µ̂[0,u]

1 X 2
= argmin
d (Yi , ω),
ω∈Ω [nu]
i=1

[nu]

V̂[0,u] =

1 X 2
d (Yi , µ̂[0,u] ),
[nu]
i=1

and analogously for observations coming after [nu], set
µ̂[u,1] = argmin
ω∈Ω

V̂[u,1] = argmin
ω∈Ω

n
X
1
d2 (Yi , ω),
(n − [nu])

1
(n − [nu])

[nu]+1
n
X

d2 (Yi , µ̂[u,1] ).

[nu]+1

Next we define “contaminated” versions of Fréchet variances of the data segments, obtained
by plugging in the Fréchet mean from the complementary data segment,
[nu]

(2.3)

C
V̂[0,u]

1 X 2
=
d (Yi , µ̂[u,1] )
[nu]
i=1

and

C
V̂[u,1]

n
X
1
=
d2 (Yi , µ̂[0,u] ).
n − [nu]
[nu]+1

By definition, the contaminated Fréchet variances of the data segments are at least as large
as the correct Fréchet variances.
Intuitively, under H0 the population Fréchet means and variances of observations do
not depend on u and therefore we expect µ̂[u,1] to be close to µ̂[0,u] , which in turn implies
C − V̂
C
that under H0 , the differences V̂[0,u]
[0,u] and V̂[u,1] − V̂[u,1] are small. Moreover, since

6

P. DUBEY AND H.-G. MÜLLER

the Fréchet variances of the two data segments are also the same under H0 , we expect the
absolute difference |V̂[0,u] − V̂[u,1] | to be small.
It is instructive to consider the special case Ω = R. Without loss of generality, assume
u > τ and let Ȳ0,τ denote the mean of all observations before [nτ ], Ȳτ,u the mean of all
observations coming after [nτ ] but before [nu] and Ȳu,1 the mean of all observations coming
after [nu]. It is easy to see that
µ̂[0,u] ≈

τ
(u − τ )
Ȳ0,τ +
Ȳτ,u
u
u

and µ̂[u,1] = Ȳu,1 ,

and a simple calculation leads to the approximation
τ
(u − τ )
C
C
− V̂[u,1] ≈ ( Ȳ0,τ +
− V̂[0,u] = V̂[u,1]
V̂[0,u]
Ȳτ,u − Ȳu,1 )2 .
u
u
If µ1 6= µ2 , one expects that for large n, Ȳ0,τ is close to µ1 and Ȳτ,u and Ȳu,1 are close to
)
τ
2
2
µ2 , which implies that ( uτ Ȳ0,τ + (u−τ
u Ȳτ,u − Ȳu,1 ) is close to ( u (µ1 − µ2 )) . The latter is
C
C
maximized when u = τ . Here one can view the terms V̂[0,u] − V̂[0,u] and V̂[u,1] − V̂[u,1] as the
between group variance of the two data segments, the size of which is expected to reflect
differences in the means.
Comparing the within group variances of the data segments, let V̂0,τ denote the variance
of the observations located before [nτ ], V̂τ,u the variance of the observations located after
[nτ ] but before [nu] and V̂u,1 the variance of the observations located after [nu]. Again by
a simple calculation
V̂[0,u] ≈

τ
u−τ
τ u−τ
V̂0,τ +
V̂τ,u +
(Ȳ0,u − Ȳτ,u )2
u
u
u u

and V̂[u,1] = V̂u,1 .

If µ1 = µ2 and V1 6= V2 , then for large n, (V̂[0,u] − V̂[u,1] )2 is approximately equal to
( uτ (V1 − V2 ))2 and is maximized at u = τ . The term (V̂[0,u] − V̂[u,1] )2 can be related to
between group variances of the data segments and is expected to account for variance
differences between the two groups in the absence of a mean difference. It can be shown
with a few steps of calculation that when both µ1 6= µ2 and V1 6= V2 , the term (V̂[0,u] −
C − V̂
C
2
V̂[u,1] )2 + (V̂[0,u]
[0,u] + V̂[u,1] − V̂[u,1] ) is also maximized at u = τ .
Now considering the general case, where the data sequence takes values in a general
C − V̂
C
2
metric space, the term (V̂[0,u]
[0,u] + V̂[u,1] − V̂[u,1] ) reflects differences in Fréchet means
of the data segments and the term (V̂[0,u] − V̂[u,1] )2 differences in Fréchet variances. For a
fixed u ∈ Ic , it can be shown p
that a central limit theorem for Fréchet variances (Dubey
√
and Müller, 2019) implies that u(1 − u)( n/σ)(V̂[0,u] − V̂[u,1] ) has an asymptotic standard
normal distribution under H0 , where σ is the asymptotic variance of the empirical Fréchet
variance. Another key result, which holds under H0 and for which we refer to Theorem 1
below and its proof in Appendix B in the Online Supplement is that under some regularity

FRÉCHET CHANGE-POINT DETECTION

7

assumptions and if µ1 = µ2 ,
√
C
C
− V̂[u,1] )2 = oP (1/ n).
− V̂[0,u] + V̂[u,1]
sup (V̂[0,u]

u∈Ic

We also require an estimate of σ 2 , for which we use
n

σ̂ 2 =

1X 4
d (Yi , µ̂) − V̂ 2 ,
n
i=1

an estimator that is known to be consistent under H0 (Dubey and Müller, 2019), where
n

(2.4)

1X 2
µ̂ = argmin
d (Yi , ω)
ω∈Ω n
i=1

n

1X 2
and V̂ =
d (Yi , µ̂).
n
i=1

The above considerations motivate the proposed statistics

2 
2 
u(1 − u) 
C
C
V̂[0,u] − V̂[u,1] + V̂[0,u] − V̂[0,u] + V̂[u,1] − V̂[u,1]
(2.5)
Tn (u) =
σ̂ 2
for u ∈ Ic . We refer to Tn (·) when considered as a function of u as the scan function.
We will show in Theorem 1 in section 3 that under mild regularity conditions,
{nTn (u) : u ∈ Ic } converges weakly to the square of a tight standardized Brownian Bridge
on the interval Ic under H0 , which is a stochastic process given by
)
(
B(u)
: u ∈ Ic ,
(2.6)
G= p
u(1 − u)
where {B(u) : u ∈ Ic } is a tight Brownian Bridge on Ic , i.e., a tight Gaussian process
indexed by Ic with zero mean and covariance structure given by K(s, t) = min(s, t) − st.
For the role of tightness in this connection, we refer to section 2.1.2 of Van der Vaart and
Wellner (1996). Other versions of the Brownian Bridge have surfaced in the context of
the asymptotics of change-point detection in various previous studies (Chernoff and Zacks,
1964; MacNeill, 1974; Siegmund, 1988; Csörgö and Horváth, 1997).
Specifically, for testing H0 versus H1 , we use the statistic
 
k
(2.7)
sup nTn (u) =
max
nTn
.
n
[nc]≤k≤n−[nc]
u∈Ic
Let q1−α be the (1 − α)th quantile of supu∈Ic G 2 (u). Under H0 and the regularity conditions
described in section 3, by Theorem 1 and the continuous mapping theorem, one obtains
the weak convergence, denoted here and in all of the following by ⇒,
sup nTn (u) ⇒ sup G 2 (u).
u∈Ic

u∈Ic

8

P. DUBEY AND H.-G. MÜLLER

A level α significance test is then characterized by the rejection region


(2.8)
Rn,α = sup nTn (u) > q1−α .
u∈Ic

In section 3.3 we describe how to obtain asymptotic and bootstrap critical values under
H0 . We will show in section 3 that under H1 , when a change-point is present at τ ∈ Ic ,
the process Tn (u) converges uniformly in probability to a limit process T (u), which has a
unique maximizer at u = τ , i.e.,
τ = argmax T (u).
u∈Ic

It is then natural to estimate the location of the change-point τ by
 
k
(2.9)
τ̂ = argmax Tn (u) = argmax Tn
.
n
u∈Ic
[nc]≤k≤n−[nc]
2.3. Population limit of the test statistic under H1 . To obtain the limit T (u) of the
process Tn (u) (2.5) under H1 (2.2), we first derive the pointwise limits of the sample based
estimators, which form the components of Tn (u). Starting with the Fréchet mean µ̂[0,u]
(2.3), we observe that if u ≤ τ , µ̂[0,u] converges to µ1 in probability pointwise in u, which
is a consequence of results in Dubey and Müller (2019). If u > τ , we have


[nτ ]
[nu]
 [nτ ] 1 X

X
1
([nu] − [nτ ])
µ̂[0,u] = argmin
d2 (Yi , ω) +
d2 (Yi , ω) ,

[nu]
([nu] − [nτ ])
ω∈Ω  [nu] [nτ ]
i=1

[nτ ]+1]

which intuitively implies that the pointwise limit of µ̂[0,u] for u > τ is

argmin
ω∈Ω


 u−τ

τ
2
2
E1 d (Y, ω) +
E2 d (Y, ω) .
u
u

We will show that the pointwise limit µ[0,u] of µ̂[0,u] is indeed
(2.10)

µ[0,u]

(
µ1 , u ≤ τ


=
argminω∈Ω uτ E1 d2 (Y, ω) +

u−τ
u E2


d2 (Y, ω) ,

u>τ

and that likewise the pointwise limit µ[u,1] of µ̂[u,1] (2.3) is
µ[u,1] =

n
(

−u
argminω∈Ω τ1−u
E1 d2 (Y, ω) +
µ2 ,

u>τ

1−τ
1−u E2

o
d2 (Y, ω) ,

u≤τ

.

9

FRÉCHET CHANGE-POINT DETECTION

We denote the pointwise limits of the Fréchet variances V̂[0,u] (2.3) and V̂[u,1] (2.3) by
V[0,u] and V[u,1] , respectively. They are given by
(
V1 , u ≤ τ
 u−τ

V[0,u] = τ
2
2
u > τ;
u E1 d (Y, µ[0,u] ) + u E2 d (Y, µ[0,u] ) ,
(
V[u,1] =

τ −u
1−u E1

V2 ,


d2 (Y, µ[u,1] ) +
u > τ.

1−τ
1−u E2


d2 (Y, µ[u,1] ) ,

u≤τ

C and V̂ C (2.3),
Similarly, the pointwise limits of the contaminated Fréchet variances V̂[0,u]
[u,1]
C and V C , are given by
denoted by V[0,u]
[0,1]

C
V[0,u]

(

E1 d2 (Y, µ[u,1] ) ,

= τ
2
u E1 d (Y, µ2 ) +
(

C
V[u,1]

=

τ −u
2
1−u E1 d (Y, µ1)
E2 d2 (Y, µ[0,u] ) ,



+

u≤τ
u−τ
u E2


d2 (Y, µ2 ) ,

1−τ
1−u E2


d2 (Y, µ1 )

u > τ;
u≤τ

u > τ.

Under H1 , the pooled sample Fréchet mean µ̂ (2.4) and Fréchet variance V̂ have the
pointwise limits


µ̃ = argmin τ E1 d2 (Y, ω) + (1 − τ )E2 d2 (Y, ω) ;
ω∈Ω


Ṽ = τ E1 d2 (Y, µ̃) + (1 − τ )E2 d2 (Y, µ̃) .
Key steps are that under H1 , σ̂ 2 converges in probability to


σ 2 = τ E1 d4 (Y, µ̃) + (1 − τ )E2 d4 (Y, µ̃) − Ṽ 2 ,
while under H0 , where P1 = P2 and therefore E1 = E2 , the limit is σ 2 = E(d4 (Y, µ̃)) − Ṽ 2 ;
and that under regularity conditions and H1 , Tn (u) converges uniformly in probability to

2 
2  C
u(1 − u)
C
V[0,u] − V[u,1] + V[0,u] − V[0,u] + V[u,1] − V[u,1]
,
(2.11)
T (u) =
σ2
as stated in Theorem 2 below, with detailed arguments provided in the proof in Appendix
B. At u = τ we have with




∆1 = E1 d2 (Y, µ2 ) − E1 d2 (Y, µ1 ) , ∆2 = E2 d2 (Y, µ1 ) − E2 d2 (Y, µ2 )
that
T (τ ) =

o
τ (1 − τ ) n
2
2
(V
−
V
)
+
(∆
+
∆
)
.
1
2
1
2
σ2

10

P. DUBEY AND H.-G. MÜLLER

Note that under the assumption of uniqueness of Fréchet means of the two populations
under H1 , ∆1 ≥ 0 and ∆1 = 0 if and only if µ1 = µ2 . Similarly, ∆2 ≥ 0 and ∆2 = 0 if and
only if µ1 = µ2 . This implies that T (τ ) = 0 if and only if either V1 = V2 or µ1 = µ2 . Hence
T (τ ) quantifies the divergence between P1 and P2 , where the term (V1 − V2 )2 accounts for
scale differences and the term (∆1 + ∆2 )2 accounts for location differences. Formally, we
will show in Proposition 1 in section 3 that under H1 and mild assumptions on existence
and uniqueness of Fréchet means, T (u) is maximized uniquely at u = τ , i.e.,
T (τ ) = sup T (u),
u∈Ic

which is the justification for the proposed estimate of τ in (2.9).
3. Theory.
3.1. Assumptions. For any α = {α1 , α2 , . . . , αn : 0 ≤ αi < 1,
(3.1)

Rn (ω, α) =

n
X

αi d2 (Yi , ω)

Pn

i=1 αi

= 1}, let

and µ̂α = argmin Rn (ω, α).
ω∈Ω

i=1

Furthermore, for any 0 ≤ γ ≤ 1, let


(3.2)
S(ω, γ) = γE1 d2 (Y, ω) + (1 − γ)E2 d2 (Y, ω)

and µγ = argmin S(ω, γ).
ω∈Ω

We need the following assumptions, which are assumed to hold irrespective of whether
H0 is true, and we show that this is possible for various salient examples, as discussed
below after the listing of the assumptions.
(A1) For any 0 ≤ γ ≤ 1, µγ exists and is unique. Additionally there exists ζ > 0 and
C > 0 such that
inf

inf

0≤γ≤1 d(ω,µγ )<ζ

{S(ω, γ) − S(µγ , γ) − Cd2 (ω, µγ )} ≥ 0.

Note that this implies that under H0 ,
(3.3)

{E(d2 (Y, ω)) − E(d2 (Y, µ)) − Cd2 (ω, µ)} ≥ 0.

inf
d(ω,µ)<ζ

P
(A2) For any α = {α1 , α2 , . . . , αn : 0 ≤ αi ≤ 1, ni=1 αi = 1}, µ̂α exists and is unique
almost surely. Additionally, for any ε > 0, there exists κ0 = κ0 (ε) > 0 such that as
n → ∞,


P inf inf {Rn (ω, α) − Rn (µ̂α , α)} ≥ κ0 → 1.
α d(ω,µ̂α )>ε

FRÉCHET CHANGE-POINT DETECTION

11

(A3) Let Bδ (ω) ⊂ Ω be a ball of radius δ centered at ω, which is any arbitrary element
in Ω, and let N (ε, Bδ (ω), d) be its covering number which is defined as the minimum
number of balls of radius ε > 0 needed to cover Bδ (ω) (see section 2.1.1 of Van der
Vaart and Wellner (1996) for the definition and further details). Then for any ω ∈ Ω,
Z 1p
log N (εδ, Bδ (ω), d)dε = O(1) as δ → 0.
0

Moreover, there exist constants K > 0 and 0 < β < 2 such that the covering number
of Ω satisfies that for any ε > 0,
(3.4)

log N (ε, Ω, d) ≤

K
.
εβ

(A4) There exist δ > 0 and C > 0 such that for all ω ∈ Bδ (µj ) one has


E1 d2 (Y, ω) − E1 d2 (Y, µ1 ) = Cd2 (ω, µ1 ) + O(δ 2 ) as δ → 0,
and analogously for all ω ∈ Bδ (µ2 ),


E2 d2 (Y, ω) − E2 d2 (Y, µ2 ) = Cd2 (ω, µ2 ) + O(δ 2 ) as δ → 0.
We note that the existence and uniqueness of the minimizers in (A1) and (A2) is guaranteed for the case of Hadamard spaces, the curvature of which is bounded above by 0
(Sturm, 2003, 2006). However, for positively curved manifolds such as spheres, the existence of minimizers depends intrinsically on the probability distribution on the space and
is not guaranteed; see Ahidar-Coutrix, Gouic and Paris (2018) where the authors study
conditions on probability distributions in positively curved metric spaces which imply existence and uniqueness of Fréchet means along with the condition in (3.3). Therefore, a
case by case analysis is inevitable to ascertain whether these assumptions are satisfied. In
the following we provide examples of spaces that satisfy assumptions (A1)-(A4) and that
we use in simulations and real data applications; see also Petersen and Müller (2019b).
1. RLet Ω be the set of univariate probability distributions F defined on R such that
2
R x dF (x) ≤ M for all F ∈ Ω and some M > 0 equipped with the 2-Wasserstein
metric dW . For two univariate probability distributions with quantile functions G1 (·)
and G2 (·) the metric dW is
Z 1
2
(3.5)
dW (G1 , G2 ) =
(G1 (t) − G2 (t))2 dt.
0

2. Let Ω be the set of covariance matrices of a fixed dimension r, with bounded variances
(uniformly bounded diagonals) equipped with the Frobenius metric dF . For two r × r
matrices Σ1 and Σ2 ,
(3.6)

d2F (Σ1 , Σ2 ) = trace (Σ1 − Σ2 )0 (Σ1 − Σ2 ) .

12

P. DUBEY AND H.-G. MÜLLER

3. Let Ω be the space of network adjacency matrices or graph Laplacians of a fixed
dimension r of undirected weighted graphs with bounded edge weights equipped
with the Frobenius metric dF . The space of graph Laplacians of simple graphs can
be used to characterize the space of networks (Ginestet et al., 2017).
More details on these spaces and proofs that they satisfy (A1)-(A4) are provided in
Appendix C in the Supplement, specifically in Propositions C.1 and C.2. Assumptions
(A1) and (A2) are commonly used to establish consistency of M-estimators such as µ̂[0,u]
and µ̂[u,1] for u ∈ Ic ; see Chapter 3.2 in Van der Vaart and Wellner (1996). In particular, one
Pn
1 P[nu] 2
1
2
needs to ensure weak convergence of processes [nu]
[nu]+1 d (Yi , ω)
i=1 d (Yi , ω) and n−[nu]
to their population counterparts under H0 (2.1) and H1 (2.2) in order to obtain convergence
of their minimizers.
Assumption (A3) is a restriction on the metric entropy of Ω and δ-balls in Ω, which
controls the complexity of Ω; in our case it controls uniform bracketing entropy integrals
that are used to provide tail bounds as in Theorem 2.14.2 in Van der Vaart and Wellner
(1996). It is common to assume that the uniform bracketing entropy integral is bounded;
for more details see section 3.2.2 in Van der Vaart and Wellner (1996). The condition in
(3.4) is satisfied by a wide class of metric spaces, including the three examples discussed
above, where β = 1 for the space of distributions with the Wasserstein-2 metric, since it can
be represented as a special case of the space of monotone functions from R to a compact
subset of R (Van der Vaart and Wellner, 1996). For the other two examples, the condition in
(3.4) is satisfied for any β > 0 since these spaces are subsets of a bounded Euclidean space.
Other examples include the space of all Lipschitz functions of degree 1/2 < γ ≤ 1 on the
unit interval [0, 1] with the L2 metric, where β = γ1 , as well as the class of bounded convex
functions on a compact, convex subset of Rd under certain restrictions, where β = d/2
(Guntuboyina and Sen, 2013).
Assumption (A4) appears in empirical process theory when one deals with approximate
M-estimators (Arcones, 1998). It ensures that under H0 , the contaminated Fréchet variC and V̂ C are sufficiently close to the correct Fréchet variances V̂
ances V̂[0,u]
[0,u] and V̂[u,1] .
[u,1]
d
For the special case of R with the Euclidean metric, assumptions (A1)-(A4) are satisfied
for bounded convex subsets of Rd . The proof follows the exact line of arguments as in the
proof of Proposition C.2 in Appendix C of the Online Supplement. The required entropy
condition (3.4) in assumption (A3) and some of the other proof techniques do not continue
to hold for unbounded subsets of Rd under the Euclidean metric. Extensions to unbounded
convex subsets of R might be possible in special cases. For non-convex subsets of Rd ,
existence and uniqueness of Fréchet means is not guaranteed.
3.2. Main results. In this section we state the main results, including the asymptotic
limit distribution of the proposed test statistic under H0 (2.1), consistency of the test
under contiguous alternatives and consistency of the estimated location of the change-point.
Detailed proofs for all results can be found in the Appendix in the Online Supplement. We

13

FRÉCHET CHANGE-POINT DETECTION

start with consistency of the estimated Fréchet means and variances to their population
targets under H0 using tools from Van der Vaart and Wellner (1996); Montgomery-Smith
and Pruss (2001). Note that under H0 , µ = µ1 = µ2 and V = V1 = V2 .
Lemma 1.

Under H0 (2.1) and assumptions (A1)-(A3),
√
√
n sup d(µ̂[0,u] , µ) = OP (1),
n sup d(µ̂[u,1] , µ) = OP (1)
u∈Ic

u∈Ic

and
σ̂ 2 − σ 2 = oP (1).
The proof of this and of most of the following results uses empirical process theory. To
obtain the first statement of the lemma, we introduce processes
[nu]

1 X 2
Mn (ω, u) =
d (Yi , ω) and M (ω) = E(d2 (Y, ω)),
[nu]
i=1

and show the weak convergence of the process {Mn (ω, u) − M (ω, u) : ω ∈ Ω} to zero
and the asymptotic equicontinuity of the processes {d(µ̂[0,u] , µ)}u∈Ic , which then implies
uniform convergence. To obtain the rate of uniform convergence, we find deviation bounds
√
over slices Sj,n = {ω ∈ Ω : 2j ≤ nd(ω, µ) < 2j+1 }. Details are in the Supplementary
Materials.
Observe that Fréchet variances are sums of dependent random variables because each
summand contains the Fréchet mean, which is estimated using all other data objects. A
key step in obtaining the limiting distribution of the test statistic in (2.7) under H0 is to
replace the estimated Fréchet means in the estimated Fréchet variances with the true mean
µ under H0 , for which the following Lemma is instrumental. Let
[nu]

Ṽ[0,u]

1 X 2
=
d (Yi , µ)
[nu]

and Ṽ[u,1] =

i=1

1
n − [nu]

n
X

d2 (Yi , µ),

i=[nu]+1

where µ is the true Fréchet mean of the data sequence under H0 . Note that Ṽ[0,u] and Ṽ[u,1]
are sums of independent random variables and can be thought of as oracle versions of V̂[0,u]
and V̂[u,1] with the true Fréchet means plugged in.
Lemma 2.
sup
u∈Ic

Under H0 (2.1) and assumptions (A1)-(A3),
√

n V̂[0,u] − Ṽ[0,u] = oP (1)

and

sup

√

n V̂[u,1] − Ṽ[u,1] = oP (1).

u∈Ic

The following result states that the contaminated Fréchet variances of the data segments
are close to the correct Fréchet variances of the data segments under H0 .

14

P. DUBEY AND H.-G. MÜLLER

Lemma 3.

Under H0 (2.1) and assumptions (A1)-(A4),
√
√
C
C
− V̂[0,u] = oP (1) and sup n V̂[u,1]
− V̂[u,1] = oP (1).
sup n V̂[0,u]
u∈Ic

u∈Ic

p
Recalling that G = {B(u)/ u(1 − u) : u ∈ Ic } is a standardized Brownian Bridge
process on Ic , where {B(u) : u ∈ Ic } is a tight Brownian Bridge process on Ic , Theorem
1 gives the weak convergence of the scan function Tn (·) in the absence of a change-point
and provides the asymptotic justification of the proposed test. The weak convergence is in
l∞ ([c, 1 − c]), the set of all uniformly bounded real functions on [c, 1 − c].
Theorem 1.

Under H0 (2.1) and assumptions (A1)-(A4),

{nTn (u) : u ∈ Ic } ⇒ G 2 (u) : u ∈ Ic ,

where the covariance function C(u, v) of G is C(u, v) = [u(1 − v)/v(1 − u)]1/2 for u ≤ v.
For the proof of this key result, we decompose Tn (u) = TnI (u) + TnII (u), where
TnI (u) =
and
TnII (u)

=

(V̂[0,u] − V̂[u,1] )2
σ̂ 2 (1/u + 1/(1 − u))

C − V̂
C
2
(V̂[0,u]
[0,u] ) + V̂[u,1] − V̂[u,1] )

σ̂ 2 (1/u + 1/(1 − u))

.

We then show that nTnI = {nTnI (u) : u ∈ Ic } converges weakly to G 2 and nTnII = {nTnII (u) :
u ∈ Ic } converges weakly to zero. Once the weak convergence of nTn is established, the
continuous mapping theorem implies
max nTn (u) ⇒ max G 2 (u).
u∈Ic

u∈Ic

Next we move away from assuming the null hypothesis H0 (2.1) of no change-point and
establish the convergence of µ̂[0,u] , µ̂[u,1] and σ̂ 2 in Lemma 4 and the convergence of the
correct and the contaminated Fréchet variances of the data segments to their population
targets in Lemma 5, using results from Ossiander (1987). Note that many of the following
results are only valid under H1 , as the change-point location τ is defined only under H1
but not under H0 . Two relevant results are as follows.
Lemma 4.

Under assumptions (A1)-(A3), with β as in assumption (A3),




− 1
− 1
sup d(µ̂[0,u] , µ[0,u] ) = OP n 2+β , sup d(µ̂[u,1] , µ[u,1] ) = OP n 2+β

u∈Ic

u∈Ic

and
σ̂ 2 − σ 2 = oP (1).

FRÉCHET CHANGE-POINT DETECTION

15

Lemma 5.
(3.7)

(3.8)

Under assumptions (A1)-(A3), with β as in assumption (A3),




1
1
and sup V̂[u,1] − V[u,1] = OP √
,
sup V̂[0,u] − V[0,u] = OP √
n
n
u∈Ic
u∈Ic



− 1
C
C
= OP n 2+β
− V[0,u]
sup V̂[0,u]

and

u∈Ic



− 1
C
C
= OP n 2+β .
− V[u,1]
sup V̂[u,1]

u∈Ic

Using these results, we show in the following Proposition that the limit process T (u)
(2.11) of Tn (u) (2.5) indeed has its maximum at u = τ .
Proposition 1.
has under H1 that

Assume µγ (3.2) exists and is unique for any 0 ≤ γ ≤ 1. Then one
T (τ ) = sup T (u)
u∈Ic

and T (τ ) > T (u) when u 6= τ .
Consistency of the estimated location of the change-point is a consequence of the uniform
convergence of the process Tn (u) to the limit process T (u) under H1 and the argmax
theorem, which guarantees convergence of the maximizers.
Theorem 2.

Under H1 (2.2) and assumptions (A1)-(A3),
sup |Tn (u) − T (u)| = oP (1)

and

|τ̂ − τ | = oP (1).

u∈Ic

In order to show consistency of the test (2.8) in a neighborhood of H0 , we construct a
sequence of local alternatives

(3.9)
H1,n = d2 (µ1 , µ2 ) = an , |V1 − V2 | = bn : an > 0 or bn > 0 .
When an → 0 and bn → 0 as n → ∞, {H1,n }n≥1 is a sequence of contiguous alternatives.
Let ψn be the power function for the test (2.8) when H1,n holds, i.e.
(3.10)

ψn = P (Rn,α ) ,

where Rn,α , as defined in equation (2.8), is the rejection region for a level α test. The
following result demonstrates the consistency of the test under contiguous alternatives
H1,n .
Theorem 3. Under H1 (2.2) and assumptions (A1)-(A3), it holds for sequences an →
0 and bn → 0 as in (3.9), that
ψn → 1
√
√
as n → ∞, if either nan → ∞ or nbn → ∞.

16

P. DUBEY AND H.-G. MÜLLER

3.3. Approximation of critical values by bootstrap. For obtaining a level α asymptotic
test as defined in (2.8), one needs to approximate the critical value q1−α . This can be done
2
in practice by taking a large number of Monte Carlo
 simulations of G (·) on the interval
k
2
[[nc], [n(1 − c)]], computing sup[nc]≤k≤[n(1−c)] G n in each simulation and then finding
the (1 − α)th quantile across all simulations.
The testing procedure described above is based on the weak convergence of the maximum of a scan function to the maximum of a squared standardized Brownian bridge as
established in Theorem 1. It is well known that the speed of convergence in limit theorems
of this type is often slow, and the problem is magnified when the dimension of the data
is moderate to high. Consequently the approximation of the level of the test may not be
accurate for finite sample sizes. This is borne out in simulations that we report in Section
4. In such situations it may be preferable to obtain critical values using a bootstrap approximation to ensure the accuracy of the test. We find that the bootstrap test, implemented
according to the following specifications, tends to have larger critical values compared with
the asymptotic test and is thus more conservative. While it typically has a level that is
very close to the nominal level, this also means that the bootstrap test also often has lower
power against alternatives, especially those that are close to the null.
A scheme for approximating q1−α with the bootstrap distribution of the test statistic
conditional on the observations instead of the asymptotic distribution is as follows.
Bootstrap Scheme:
Step I. Obtain a random sample of size m, Y1? , Y2? , . . . , Ym? with replacement from the
observations Y1 , Y2 , . . . , Yn .
Step II. For u ∈ Ic , define the bootstrap quantities
µ?[0,u]

[mu]
1 X 2 ?
1
= argmin
d (Yj , ω), µ?[u,1] = argmin
ω∈Ω [mu]
ω∈Ω (m − [mu])
j=1

?
V[0,u]

[mu]
1 X 2 ? ?
1
?
=
d (Yj , µ[0,u] ), V[u,1]
=
[mu]
(m − [mu])
j=1

C,?
V[0,u]
=

[mu]
1
1 X 2 ? ?
C,?
d (Yj , µ[u,1] ), V[u,1]
=
[mu]
(m − [mu])
j=1

m
X

m
X

d2 (Yj? , ω),

j=[mu]+1

d2 (Yj? , µ?[u,1] ),

j=[mu]+1
m
X

d2 (Yj? , µ?[0,u] ),

j=[mu]+1


2
m
m
m
X
X
X
1
1
1
µ? = argmin
d2 (Yj? , ω), (σ ? )2 =
d4 (Yj? , µ? ) − 
d2 (Yj? , µ? )
m
m
ω∈Ω m j=1
j=1
j=1



2 
2
u(1 − u)
C,?
C,?
?
?
?
?
?
and Tm,n (u) =
V[0,u] − V[u,1] + V[0,u] − V[0,u] + V[u,1] − V[u,1]
.
(σ ? )2

17

FRÉCHET CHANGE-POINT DETECTION
?
? (u) = max
?
Step III. Calculate T̃m,n
= supu∈Ic mTm,n
[mc]≤k≤[m(1−c)] mTm,n

k
m



.

We iterate Steps I-III B times. For each iteration, indexed by b, we obtain a bootstrap
?,b
?
version T̃m,n
of T̃m,n
for b = 1, 2, . . . , B. The following result shows that under very mild assumptions the distribution of supu∈Ic nTn (u) under H0 can be approximated in probability
? (u), given the observations Y , Y , . . . , Y .
by the conditional distribution of supu∈Ic mTm,n
1 2
n
This implies that the conditional distribution of the bootstrap statistics is consistent under
H0 . We can then use Monte Carlo approximations as described in Steps I-III for approxi?,b
mating the conditional distribution by the empirical distribution of T̃m,n
, b = 1, 2, . . . , B,
?,b
where q1−α is approximated as the empirical quantile of T̃m,n , b = 1, 2, . . . , B.
Let Y ? ∼ P|Y , which denotes the measure generated by resampling from Y1 , Y2 , . . . , Yn
uniformly with replacement. The following Theorem 4 provides the asymptotic consistency
of the bootstrap distribution of the test statistic. Its proof in the Supplementary Materials
makes use of key results of Jirak (2015).
Under H0 and assumptions (A1)-(A4), as m → ∞ and n → ∞,




?
sup P|Y sup mTm,n
(u) ≤ x − P sup G 2 (u) ≤ x = oP (1).

Theorem 4.
(3.11)

x

u∈Ic

u∈Ic

We note that in principle one could also use analytic approximations of the asymptotic
distribution of the test statistics under the null hypothesis, which has some tradition in
change-point analysis, with recent examples provided in Chen and Zhang (2015); Chu
and Chen (2019). However, given that the bootstrap approximation can be theoretically
justified and is seen to work well in practice, such approximations are less relevant for our
purposes.
4. Simulations. In order to study the power of the test (2.8) and the accuracy of
the estimated change-point location, we report here the results of simulations for various
settings. The random objects we consider in simulations are univariate probability distributions equipped with the 2-Wasserstein metric, graph Laplacians of scale free networks
from the Barabási-Albert model (Barabási and Albert, 1999) with the Frobenius metric
and multivariate data with the usual Euclidean metric.
It is usually harder to detect change-points that are located close to the endpoints of
a data sequence. Each data sequence in the simulation is of length 300 and is generated
such that the first and the second segments contain 100 and 200 data objects, respectively,
under the alternative where a change-point is present. Hence the change-point is placed
at one-third of the data sequence under the alternative, i.e., τ = 1/3 under H1 (2.2). We
select the interval Ic as [0.1, 0.9].
We construct power functions of the proposed test with certain parameters that we use
to generate the data as argument, and and we also quantify the accuracy of the estimated
change-point location. We compare the results for the new test with the generalized edge

18

P. DUBEY AND H.-G. MÜLLER

0.8
0.6
0.0

0.2

0.4

power(δ)

0.6
0.4
0.0

0.2

power(δ)

0.8

1.0

Scale

1.0

Location

0.0 0.2 0.4 0.6 0.8 1.0
δ

0.4

0.6

0.8

1.0

δ

Fig 1: Empirical power as function of δ for N (µ, 1) probability distributions with µ generated from a truncated N (δ, 0.75) distributions for observations before τ = 1/3 and truncated N (0, 0.75) distributions for observations after τ (left panel) and empirical power as
function of δ for N (µ, 1) probability distributions with µ generated from truncated N (0, δ)
for observations before τ and from truncated N (0, 1) distributions for observations after τ
(right panel). The solid black curves correspond to the proposed test (2.8) and the dashed
blue curves to the generalized scan function graph based test (Chu and Chen, 2019). The
line parallel to the x axis indicates the level of the tests, which is 0.05.

count scan function in Chu and Chen (2019), which was shown in this previous work to
dominate other graph based change-point detection approaches. For the graph based test,
we used these authors’ implementation in the R package gSeg and constructed similarity
graphs of the data sequences by constructing a 5−MST (minimal spanning tree) graph
from the pooled pairwise distance matrix, following the suggestion in Chen and Friedman
(2017). Here a k−MST is the union of the 1st , . . . , k th MSTs, where a k th MST is a spanning
tree connecting all observations that minimizes the sum of distances across edges, subject
to the constraint that this spanning tree does not contain any edge in the 1st , . . . , (k − 1)th
MST.
In the simulations we explored not only location differences but also differences in shape
and scale of the population segments. We carried out all tests at level α = 0.05. Under both
H0 and H1 , the power of the tests was computed by finding the proportion of rejections from
1000 runs of the simulation. The critical value for rejection of the test (2.8) was obtained
from the bootstrap scheme as described in section 3.3. We quantified the accuracy of the
estimated change-point location by mean absolute deviation (MAE), which was computed

19

FRÉCHET CHANGE-POINT DETECTION

Scale

60

0

20

40

MAE(δ)

40
20

MAE(δ)

60

80

80

Location

0.0 0.2 0.4 0.6 0.8 1.0

0.4

δ

0.6

0.8

1.0

δ

Fig 2: MAE as function of δ for N (µ, 1) probability distributions, which are generated as
described in Figure 1, with Fréchet mean change (left panel) and Fréchet variance change
(right panel). The solid black curves correspond to the new estimates (2.9) and the dashed
blue curves to those proposed in Chu and Chen (2019).

as follows: Denoting by τ̂i the estimated change-point in the ith simulation run,
M AE =

1000
1 X
|τ̂i − τ |,
1000
i=1

where lower values of MAE indicate greater accuracy in the estimate of the change-point.
The first type of data objects we study are random samples of univariate probability
distributions. Each datum is a N (µ, 1) distribution, where µ is random. As distance between
two probability distributions we choose the 2-Wasserstein metric. For investigating location
differences, for the first data segment we generated µ as a truncated normal distribution
N (δ, 0.75), constrained to lie in [−10, 10] and for the second data segment, as N (0, 0.75),
truncated within [−10, 10], and then computed the empirical power function of the test
and MAE for the estimated change-point for 0 ≤ δ ≤ 1, where δ = 0 represents H0 (2.1).
For investigating scale differences, µ was drawn randomly from N (0, δ) for the first data
segment and from N (0, 1) for the second data segment, truncated within [−10, 10] in both
cases, and empirical power and MAE for the estimated change-point were evaluated for
0.4 ≤ δ ≤ 1, where in this case δ = 1 represents H0 . The results are presented in Figures
1 and 2. It is seen that the proposed test outperforms the graph based test in both cases,
both in terms of power and accuracy of change-point detection.

20

100

0.0

0 20

60

MAE(δ)

0.6
0.4
0.2

power(δ)

0.8

1.0

140

P. DUBEY AND H.-G. MÜLLER

1.0

1.5

2.0
δ

2.5

3.0

1.0

1.5

2.0

2.5

3.0

δ

Fig 3: Empirical power (left panel) and MAE (right panel) as a function of γ for scalefree networks from the Barabási-Albert model, with γ = 3 for the first data segment and
1 ≤ γ ≤ 3 for the second data segment. The solid black curve corresponds to the proposed
approach (2.8) (2.9) and the blue dashed curve to the graph based approach.

Next we consider sequences where the data objects are graph Laplacians of scale free
networks from the Barabási-Albert model with the Frobenius metric. These popular networks have power law degree distributions and are commonly used for networks related
to the world wide web, social networks and brain connectivity networks. For scale free
networks the fraction P (c) of nodes in the network having c connections to other nodes for
large values of c is approximately c−γ , with γ typically in the range 1 ≤ γ ≤ 3. Specifically,
we used the Barabási-Albert algorithm to generate samples of scale free networks with 10
nodes. For the first segment of 100 observations, we set γ = 3 and for the second segment
of 200 observations we varied γ in the interval 1 ≤ γ ≤ 3 with γ = 3 representing H0 .
We computed the empirical power and MAE as a function of γ. The left panel in Figure
3 indicates that in this scenario the proposed test has better power behavior than the
graph based test. The graph based test has a high false positive rate near and at H0 . The
right panel in Figure 3 shows that in terms of accuracy of the estimated change-point the
proposed test in most parts of the alternative outperforms the graph based test.
For the multivariate case we assume a Gaussian setting. We consider Ω = [−10, 10]50 .
Let δ̃ = (δ, δ, δ, 0, 0, . . . , 0) be the random vector whose first three components are δ and the
remaining components are all 0. Let Id be the d×d identity matrix and Jd be a d×d matrix
with all entries equal to one. For location alternatives, we generated the first segment of the
data sequence from N (0, I50 ), truncated to lie in [−10, 10]50 , and the second segment from

21

FRÉCHET CHANGE-POINT DETECTION

0.0

0.2

0.4

0.6
δ

0.8

1.0

1.0
0.8
0.6

power(δ)

0.0

0.2

0.4

0.8
0.6

power(δ)

0.0

0.2

0.4

0.8
0.6
0.4
0.0

0.2

power(δ)

Covariance

1.0

Scale

1.0

Location

0.75

0.80

0.85

0.90
δ

0.95

1.00

0.3

0.4

0.5

0.6

0.7

0.8

0.9

δ

Fig 4: Empirical power as function of δ: (a) when the data segment is generated from
truncated N (0, I50 ) for observations before τ = 1/3 and truncated N (δ̃, I50 ) for observations
after τ (left panel); (b) for truncated N (0, δI50 ) for observations before τ = 1/3 and
truncated N (0, I50 ) for observations after τ (middle panel); (c) for N (0, 0.9I50 + δ 2 J50 ) for
observations before τ = 1/3 and truncated N (0, 0.9I50 + 0.92 J50 ) for observations after τ
(right panel). The solid black curves correspond to the proposed test (2.8) and the dashed
blue curves to the graph based test.

N (δ̃, I50 ). To study the power of the test and MAE of change-point estimates, we varied
δ between 0 ≤ δ ≤ 1, where δ = 0 represents H0 . For scale alternatives, we generated the
first segment of the data sequence from N (0, δI50 ), truncated to lie in [−10, 10]50 , and the
second segment from N (0, I50 ) and varied δ between 0.75 ≤ δ ≤ 1, where δ = 1 represents
H0 .
For detecting change-points in data correlation, we generated the first segment of the
data sequence from N (0, 0.9I50 + δ 2 J50 ), truncated to lie in [−10, 10]50 , and the second
segment from N (0, 0.9I50 + 0.92 J50 ) and varied δ as 0.3 ≤ δ ≤ 0.9 for studying power and
MAE, where δ = 0.9 represents H0 . Figure 4 illustrates that in terms of power performance
the proposed approach outperforms the graph based approach for scale alternatives and
has similar performance for location alternatives.
From Figure 5 we find that for location alternatives the proposed method has larger
MAE closer to H0 , but when moving away from H0 , the proposed method has lower MAE
than the graph based approach. For scale alternatives, the proposed method outperforms
the graph based approach. We also present a scenario in the multivariate Gaussian setting
where the change in the vectors at the change-point is not reflected in mean or shape
changes and the proposed test as expected has no power and is outperformed by the
graph-based test, which still performs reasonably well. We provide the details in Appendix
D in the Online Supplement. Interestingly, when choosing a different metric where the

22

P. DUBEY AND H.-G. MÜLLER
Scale

Covariance

80
MAE(δ)

20

20

0

0

20

40

60
40

MAE(δ)

60
40

MAE(δ)

60

80

80

100

100

Location

0.0

0.2

0.4

0.6

0.8

δ

1.0

0.75

0.80

0.85

0.90

0.95

1.00

δ

0.3

0.4

0.5

0.6

0.7

0.8

0.9

δ

Fig 5: MAE as function of δ when the data are generated from the settings (a) (left panel);
(b) (middle panel) and (c) (right panel) as described in Figure 4. In each panel, the solid
black curve corresponds to the proposed estimates (2.9) and the dashed blue curve to those
for the graph based method.

change is reflected in scale change, both tests perform equally well.
5. Data Examples.
5.1. Finnish Fertility Data. The Human Fertility Database provides cohort fertility
data for various countries and calendar years, which are available at www.humanfertility.
org. These data facilitate research on the evolution and inter-country differences in fertility
over a period spanning more than 30 calendar years. For any country and year, the raw
data consist of age-specific total live birth counts, aggregated per year. We treat these data
as histograms of maternal age when giving birth, with bins representing age of birth, bin
widths one year and the bin frequencies being equal to the total live births corresponding
to that age. These histograms are then smoothed (for which we employ local least squares
smoothing using the Hades package available at https://stat.ucdavis.edu/hades/) to
obtain smooth probability density functions for maternal age, where we consider the age
interval [12, 55].
Figure 6 displays the evolving densities for Finland over a period spanning 51 years
from 1960 to 2010. One can see that the mode of the distribution of maternal age shows
a shift between the early and later years with more abrupt changes taking place near
the end of the 1970s and beginning of the 1980s. These changes likely are attributable
to increasingly delayed childbearing age, a phenomenon that has been observed since the
1960s in many European countries and has been much studied in demography (Kohler,
Billari and Ortega, 2002; Hellstrand et al., 2019; Kohler, Billari and Ortega, 2006), where

23

FRÉCHET CHANGE-POINT DETECTION

improved contraception, more women opting for higher education and increased labor force
participation of women are discussed as possible causes.

0.1

0.08
0.07

0.05

0.06
0.05

0
2020

0.04
0.03

2000
0.02

1980

Calendar Year

1960

10

20

30

40

50

60

0.01
0

Maternal Age

Fig 6: Yearly maternal age distributions represented as density functions for the age interval
[12,55] during the time period 1960 to 2010 for the Finnish fertility data.
We chose the 2-Wasserstein metric as distance between probability distributions, which
has proved to be well suited for many applications (Bolstad et al., 2003) and applied
the proposed Fréchet variance based change-point detection method, with calendar year
serving as index for the sequence of fertility distributions. Figure 7 supports the intuition
that there is a change-point in the data. The estimated location of the change-point is
the year 1982. The test (2.8) for the presence of a change-point rejects the null hypothesis
of no change-point in the sequence with a bootstrap p-value indistinguishable from zero.
Figure 8 shows clear differences between the estimated Fréchet mean distributions before
and after 1982. We see that the mode of the pre-1982 Fréchet mean distributions is before
age 25 which shifts rapidly around 1982 to after age 25, indicating significant changes in
the pattern of fertility.

24

500
100

300

Tn(u)

700

P. DUBEY AND H.-G. MÜLLER

1970

1975

1980

1985

1990

1995

2000

Calendar Years

Fig 7: Scan function Tn (u) during the time period 1970 to 2000 for the Finnish fertility
data. The dotted line indicates the location of the estimated change-point in the year
1982. The proposed test for the presence of a change-point has a bootstrap p-value that is
indistinguishable from zero for the null hypothesis of no change point.
0.07
1982 or before
After 1982

0.06

0.05

0.04

0.03

0.02

0.01

0
10

20

30

40

50

60

Fig 8: Estimated Fréchet mean distributions of maternal age, represented as densities,
before the estimated change-point in 1982 (blue) and after (red) for the Finnish fertility
data.

25

FRÉCHET CHANGE-POINT DETECTION

1200
800
400

Jun 17−23, 2002

Dec 20, 2001

Jun 15, 2000

Aug 17, 2000

Dec 23, 1999

Jul 15, 1999

Nov 9, 1998

0

Number of emails

5.2. Enron E-mail Network Data. Enron Corporation was an American energy company, which became notorious in 2001 for accounting fraud that eventually led to the company’s bankruptcy. During the investigation after the company’s collapse, data containing
e-mail exchanges of the company’s employees were made public by the Federal Energy
Regulatory Commission. One of the versions is available at http://www.cis.jhu.edu/
~parky/Enron/. We study whether changes in e-mail patterns reflect important events in
the timeline of the company’s downfall. In our analysis, we consider the time period between
November 1998 to June 2002. The weekly total e-mail activity between the 150 employees
of the company during this time period is displayed in Figure 9. Peel and Clauset (2015)
previously analyzed the Enron e-mail network data and identified a total of 16 change
points corresponding to 25 events of interest during the 3 year timeline.

Fig 9: Weekly cumulative e-mail activity of Enron employees from November 5,1998 to
June 23, 2002. Some relevant weeks are indicated on the x-axis by their mid-week dates.
The Enron e-mail network includes 184 e-mail addresses. Since the time period of 3 years
is quite long, we break it into weekly intervals and then generate a network data sequence
of length 183 corresponding to the 183 weeks between November 1998 to June 2002, where
the 184 e-mail addresses were treated as nodes. For week i, from-to pairs extracted from
the e-mails are used to calculate the total number of e-mails exchanged between the e-mail
addresses j and k, which then is considered the edge weight in the network adjacency
matrix for that week. We used the Frobenius metric between network adjacency matrices
and applied the proposed method to this sequence of networks.
The scan function in the left panel of Figure 10 indicates that a change-point might
be present in week 88 with mid-week date August 17, 2000. The bootstrap version of
the proposed test confirms the significance with a p-value of p ≈ 0. This date is located
just before an important event in the timeline of Enron when its stock prices hit an all

26

P. DUBEY AND H.-G. MÜLLER

60

Apr 11,2002

Dec 20,2000

Aug 17,2000

Apr 11,2002

Aug 17,2000

Jan 4,1999

0

0

20

50

40

Tn(u)

Tn(u)

100

80

100

150

120

time high on August 23, 2000; for more details on the overall timeline of events we refer to
http://www.agsm.edu.au/bobm/teaching/BE/Enron/timeline.html. The Fréchet mean
networks also show clear distinctions before and after week 88, as illustrated in subfigures
(a) and (b) of Figure 11.

Fig 10: Weekly scan function Tn (u) for the entire network data sequence between January 4,
1999 to April 11, 2002 (left panel) and the network data sequence after the first change point
(week 88 with midpoint August 17, 2000, as detected in the left panel) between August
17, 2000 to April 11, 2002 (right panel) for the Enron e-mail data. In the right panel, a
change-point is located on December 20, 2000. Dotted lines indicate the location of the
estimated change-points. The test for the presence of a change-point has a bootstrap pvalue indistinguishable from zero for both panels, indicating the significance of the presence
of these change-points.
On December 2, 2001, Enron filed for Chapter 11 bankruptcy protection and on January
9, 2002 it was confirmed that a criminal investigation was started against the company. We
separately analyzed the network sequence starting from week 89 to week 183, which is the
period starting right after week 88 which we detected to be a change point, as discussed
above. The right panel of Figure 10 shows that the proposed test discovered a change-point
in week 158, which is is the week December 17 to December 23, 2001, with mid-week date
December 20, 2001. This is shortly after Enron filed for bankruptcy and just before the
criminal investigation began. The Fréchet mean networks are again seen to clearly differ as
illustrated in the subfigures of Figure 11. When testing for change-points in the above time
intervals with the proposed test (2.2), the null hypothesis of no-change-point is rejected at
significance level 0.05, with bootstrap p-values indistinguishable from zero.

FRÉCHET CHANGE-POINT DETECTION

27

To investigate whether there are any additional relevant change points, we carried out
a binary segmentation approach and identified the following weeks to be candidates for
potential change points: July 12 to 18, 1999 (bootstrap p value=0.04), December 20 to
26, 1999 (bootstrap p-value=0) and June 12 to 18, 2000 (bootstrap p-value=0). The first
of these corresponds to the period right after June 28, 1999 which is when Enron’s CFO
was allowed to run a private equity fund LJM1 which later became one of Enron’s key
tools to maintain a public balance sheet; for details see http://www.agsm.edu.au/bobm/
teaching/BE/Enron/timeline.html. The second of these weeks is sandwiched between
the launch of Enron Online in December, 1999 and the launch of Enron Broadband Services
(EBS) in January, 1999; the third week with a change-point is right before a partnership
was launched between EBS and Blockbuster to provide video on demand.
6. Discussion. Change-point detection is challenging for data sequences that take values in a general metric space. Existing approaches like Chen and Zhang (2015); Chu and
Chen (2019) address this challenge by considering similarity/dissimilarity graphs between
the data objects as the starting point. In this approach the choice of the graph is a tuning
parameter that affects the conclusions; generally, the presence of a tuning parameter is undesirable in inference problems. Both the graph based and the proposed methods require a
cut-off parameter to determine intervals near both left and right endpoints where a changepoint cannot occur. This could be potentially circumvented by introducing a suitable weight
function, as pointed out by a reviewer, however the power of the test will invariably suffer
if a change-point occurs close to the endpoints. Neither the proposed test for the presence
of a change-point nor the proposed estimate of the location of the change-point require
additional tuning parameters. They possess several additional desirable features that are
not available for alternative approaches for change-point detection in general metric spaces,
including consistency of the test for the presence of a change-point and consistency of the
estimated change-point location.
The proposed test does not always work well; in Appendix D in the Supplement we
present a situation where a change in distribution occurs and consider the analysis under
two metrics, where for the first of these metrics the change in distributions is not reflected in
terms of mean or scale differences, while for the second metric the change in distributions is
associated with a scale difference. This has the consequence that under the first metric, the
proposed test is unable to detect the alternative, whereas the graph-based test of Chen and
Zhang (2015) performs well. Under the second metric, the same differences in distributions
are reflected in a scale change. Under this second metric, both tests perform equally well.
This demonstrates that in some situations the choice of the metric can play a critical role
for inference with random objects.

28

P. DUBEY AND H.-G. MÜLLER

(a) Nov 9, 1998 to Aug 20, 2000

(b) Aug 21, 2000 to June 23, 2002

(c) Aug 21, 2000 to Dec 23, 2001

(d) Dec 24, 2001 to June 23, 2002

Fig 11: Estimated Fréchet means of weekly network adjacency matrices for the time periods as
indicated.

Overall, it is an advantage of the proposed test statistic that in spite of the complexity
of metric-space valued objects it has an intuitive interpretation as it mimics change-points
that feature location-scale alternatives. The theoretical guarantees for the consistency of
the test under contiguous alternatives with such features (3.9) within small departures from

FRÉCHET CHANGE-POINT DETECTION

29

H0 (2.1) and the consistency of the estimated change-point location under H1 (2.2) are
distinguishing features of the proposed methods. Simulations and applications demonstrate
that the proposed theoretically justified bootstrap version is very helpful to obtain improved
inference in finite sample situations.
Lastly, the proposed approach is applicable for a wide class of random objects, as the
necessary assumptions are satisfied by various metric spaces of interest. There are many
open problems in this area, including sequential versions of the test or metric selection.
Acknowledgments. We wish to thank the referees for many helpful remarks and Adrian
Raftery for queries that led to the discovery of a preprocessing software bug that affected
the fertility data analysis in a previous version.
SUPPLEMENTARY MATERIAL
Supplementary Materials for “Fréchet Change-Point Detection”:
(http://www.e-publications.org/ims/support/dowload/imsart-ims.zip). The supplementary
materials contain all proofs of the main results and also various additional auxiliary lemmas
and their proofs. It also features a discussion of spaces (Ω, d), which satisfy assumptions
(A1) to (A4) in the paper, with formal results stated as Proposition C.1 and C.2 in Appendix C, and also additional simulation results in Appendix D.
References.
Ahidar-Coutrix, A., Gouic, T. L. and Paris, Q. (2018). Convergence rates for empirical barycenters in
metric spaces: curvature, convexity and extendible geodesics. arXiv preprint arXiv:1806.02740.
Arcones, M. A. (1998). A remark on approximate M-estimators. Statistics & Probability Letters 38 311–
321.
Arlot, S., Celisse, A. and Harchaoui, Z. (2012). Kernel change-point detection. arXiv preprint
arXiv:1202.3878 6.
Barabási, A.-L. and Albert, R. (1999). Emergence of scaling in random networks. Science 286 509–512.
Bolstad, B. M., Irizarry, R. A., Åstrand, M. and Speed, T. P. (2003). A comparison of normalization
methods for high density oligonucleotide array data based on variance and bias. Bioinformatics 19 185–
193.
Carlstein, E., Müller, H.-G. and Siegmund, D. (1994). (ed.) Change-point problems. IMS Lecture
Notes. IMS Lecture Notes and Monographs Series.
Cazelles, E., Seguy, V., Bigot, J., Cuturi, M. and Papadakis, N. (2018). Geodesic PCA versus logPCA of histograms in the Wasserstein space. SIAM Journal on Scientific Computing 40 B429–B456.
Chen, H. and Friedman, J. H. (2017). A new graph-based two-sample test for multivariate and object
data. Journal of the American Statistical Association 112 397–409.
Chen, J. and Gupta, A. K. (2011). Parametric Statistical Change Point Analysis: With Applications to
Genetics, Medicine, and Finance. Springer Science & Business Media.
Chen, H. and Zhang, N. (2015). Graph-based change-point detection. The Annals of Statistics 43 139–
176.
Chernoff, H. and Zacks, S. (1964). Estimating the current mean of a normal distribution which is
subjected to changes in time. The Annals of Mathematical Statistics 35 999–1018.
Chu, L. and Chen, H. (2019). Asymptotic distribution-free change-point detection for multivariate and
non-Euclidean data. Annals of Statistics 47 382–414.

30

P. DUBEY AND H.-G. MÜLLER

Csörgö, M. and Horváth, L. (1997). Limit Theorems in Change-Point Analysis. John Wiley & Sons Inc.
De Ridder, S., Vandermarliere, B. and Ryckebusch, J. (2016). Detection and localization of change
points in temporal networks with the aid of stochastic block models. Journal of Statistical Mechanics:
Theory and Experiment 2016 113302.
Dubey, P. and Müller, H.-G. (2019). Fréchet Analysis of Variance for Random Objects. Biometrika, to
appear – arXiv preprint arXiv:1710.02761.
Fréchet, M. (1948). Les éléments aléatoires de nature quelconque dans un espace distancié. Annales de
l’Institut Henri Poincaré 10 215–310.
Garreau, D., Arlot, S. et al. (2018). Consistent change-point detection with kernels. Electronic Journal
of Statistics 12 4440–4486.
Ginestet, C. E., Li, J., Balachandran, P., Rosenberg, S. and Kolaczyk, E. D. (2017). Hypothesis
testing for network data in functional neuroimaging. The Annals of Applied Statistics 11 725–750.
Guntuboyina, A. and Sen, B. (2013). Covering numbers for convex functions. IEEE Transactions on
Information Theory 59 1957–1965.
Hellstrand, J., Myrskylä, M., Nisén, J. et al. (2019). All-time low period fertility in Finland: drivers,
tempo effects, and cohort implications Technical Report, Max Planck Institute for Demographic Research,
Rostock, Germany.
James, B., James, K. L. and Siegmund, D. (1987). Tests for a change-point. Biometrika 74 71–83.
James, B., James, K. L. and Siegmund, D. (1992). Asymptotic approximations for likelihood ratio tests
and confidence regions for a change-point in the mean of a multivariate normal distribution. Statistica
Sinica 69–90.
Jirak, M. (2015). Uniform change point tests in high dimension. The Annals of Statistics 43 2451–2483.
Kohler, H.-P., Billari, F. C. and Ortega, J. A. (2002). The emergence of lowest-low fertility in Europe
during the 1990s. Population and development review 28 641–680.
Kohler, H.-P., Billari, F. C. and Ortega, J. A. (2006). Low fertility in Europe: Causes, implications
and policy options. The baby bust: Who will do the work 48–109.
Lung-Yut-Fong, A., Lévy-Leduc, C. and Cappé, O. (2015). Homogeneity and change-point detection
tests for multivariate data using rank statistics. Journal de la Société Française de Statistique 156 133–
162.
MacNeill, I. B. (1974). Tests for change of parameter at unknown times and distributions of some related
functionals on Brownian motion. The Annals of Statistics 2 950–962.
Matteson, D. S. and James, N. A. (2014). A nonparametric approach for multiple change point analysis
of multivariate data. Journal of the American Statistical Association 109 334–345.
Montgomery-Smith, S. J. and Pruss, A. R. (2001). A comparison inequality for sums of independent
random variables. Journal of Mathematical Analysis and Applications 254 35 - 42.
Niu, Y. S., Hao, N. and Zhang, H. (2016). Multiple change-point detection: A selective overview. Statistical Science 31 611–623.
Ossiander, M. (1987). A Central Limit Theorem under metric entropy with L2 bracketing. The Annals of
Probability 15 897–919.
Peel, L. and Clauset, A. (2015). Detecting change points in the large scale structure of evolving networks.
In AAAI 15 1–11.
Petersen, A. and Müller, H.-G. (2019a). Wasserstein covariance for multiple random densities.
Biometrika 106 339-351.
Petersen, A. and Müller, H.-G. (2019b). Fréchet regression for random objects with Euclidean predictors. Annals of Statistics 47 691–719.
Siegmund, D. (1988). Confidence sets in change-point problems. International Statistical Review 56 31–48.
Srivastava, M. and Worsley, K. J. (1986). Likelihood ratio tests for a change in the multivariate normal
mean. Journal of the American Statistical Association 81 199–204.
Sturm, K.-T. (2003). Probability measures on metric spaces of nonpositive curvature. Heat Kernels and
Analysis on Manifolds, Graphs, and Metric Spaces (Paris, 2002). Contemp. Math., 338. Amer. Math.

FRÉCHET CHANGE-POINT DETECTION

31

Soc., Providence, RI 357–390.
Sturm, K.-T. (2006). On the geometry of metric measure spaces. Acta Mathematica 196 65–131.
Tavakoli, S., Pigoli, D., Aston, J. A. and Coleman, J. (2019). A spatial modeling approach for
linguistic object data: Analysing dialect sound variations across Great Britain. Journal of the American
Statistical Association (to appear).
Van der Vaart, A. and Wellner, J. (1996). Weak Convergence and Empirical Processes. Springer, New
York.
Wang, T. and Samworth, R. J. (2018). High dimensional change point estimation via sparse projection.
Journal of the Royal Statistical Society: Series B (Statistical Methodology) 80 57–83.
Wang, D., Yu, Y. and Rinaldo, A. (2018). Optimal change point detection and localization in sparse
dynamic networks. arXiv preprint arXiv:1809.09602.
Department of Statistics
University of California, Davis
One Shields Avenue
Davis, CA 95616, USA
E-mail: pdubey@ucdavis.edu
hgmueller@ucdavis.edu

