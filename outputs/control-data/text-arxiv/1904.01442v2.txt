arXiv:1904.01442v2 [math.PR] 15 Sep 2019

Weak Closed-Loop Solvability of Stochastic Linear
Quadratic Optimal Control Problems of Markovian
Regime Switching System∗
Jiaqiang Wen†,

Xun Li‡,

Jie Xiong§

September 17, 2019

Abstract. In this paper, we investigate open-loop and weak closed-loop solvabilities of stochastic
linear quadratic (LQ, for short) optimal control problem of Markovian regime switching system.
Interestingly, these two solvabilities are equivalent on [0, T ). We first provide an alternative characterization of the open-loop solvability of LQ problem using a perturbation approach. Then, we
study the weak closed-loop solvability of LQ problem of Markovian regime switching system, and
establish the equivalent relationship between open-loop and weak closed-loop solvabilities. Finally,
we present an example to shed on light on finding weak closed-loop optimal strategies within the
framework of Markovian regime switching system.
Key words: stochastic linear quadratic optimal control, Markovian regime switching, Riccati
equation, open-loop solvability, weak closed-loop solvability.
AMS subject classifications. 93E20, 49N10, 49N35.

1

Introduction

Linear quadratic (LQ, for short) optimal control can be traced back to the works of Kalman [11] for
the deterministic cases, and Wonham [22] for the stochastic cases (also see Davis [6], Bensoussan
[2], Yong and Zhou [25] and the references therein). In the classical setting, under some mild
conditions on the weighting coefficients in the cost functional such as positive definiteness of the
weighting control matrix, the stochastic LQ optimal control problems can be solved elegantly via
Riccati equation approach (see Yong and Zhou [25, Chapter 6]). Chen, Li and Zhou [3] studied
∗

This work is supported partially by Southern University of Science and Technology Start up fund Y01286120 and
National Natural Science Foundation of China grants 61873325 and 11831010. Also, this work is partially supported
by Research Grants Council of Hong Kong under grants 15255416 and 15213218.
†
Department of Mathematics, Southern University of Science and Technology, Shenzhen, Guangdong, 518055,
China (wenjq@sustech.edu.cn).
‡
Corresponding author. Department of Applied Mathematics, The Hong Kong Polytechnic University, Hong Kong
(malixun@polyu.edu.hk).
§
Department of Mathematics and SUSTech International center for Mathematics, Southern University of Science
and Technology, Shenzhen, Guangdong, 518055, China (xiongj@sustech.edu.cn).

1

stochastic LQ optimal control problems with indefinite weighting control matrix as well as financial
applications such as continuous time mean-variance portfolio selection problems (see Zhou and Li
[32], Li, Zhou and Lim [15]). Since then, there has been an increasing interest in the so-called
indefinite stochastic LQ optimal control (see Ait Rami, Moore and Zhou [1], Li, Zhou and Ait Rami
[14]).
A topic of state systems involving random jumps, such as Poisson jumps or regime switching
jumps, is of interest and of importance in various fields such as engineering, management, finance,
economics, and so on. For example, Wu and Wang [23] considered the stochastic LQ optimal control
problems with Poisson jumps and obtained the existence and uniqueness of the deterministic Riccati
equation. Using the technique of completing squares, Hu and Oksendal [8] discussed the stochastic
LQ optimal control problem with Poisson jumps and partial information. Yu [26] investigated a
kind of infinite horizon backward stochastic LQ optimal control problems. Li, Wu and Yu [12]
solved the indefinite stochastic LQ optimal control problem with Poisson jumps. Meanwhile, there
has been dramatically increasing interest in studying this family of stochastic control problems as
well as their financial applications, see, for examples, Zhou and Yin [33, 24], Zhang, Siu and Meng
[30], Zhang, Elliott and Siu [28], Zhang, Sun and Xiong [31], Mei and Yong [17], Hu, Liang and Tang
[7] and Sun and Wang [19]. Moreover, Ji and Chizeck [9, 10] formulated a class of continuous-time
LQ optimal controls with Markovian jumps. Zhang and Yin [27] developed hybrid controls of a
class of LQ systems modulated by a finite-state Markov chain. Li, Zhou and Ait Rami [14] initiated
indefinite stochastic LQ optimal controls with regime switching jumps. Liu, Yin and Zhou [16]
considered near-optimal controls of regime switching LQ problems with indefinite control weight
costs. Some other recent development concerning regime switching jumps see Donnelly and Heunis
[5], and Li and Zheng [13].
Recently, Sun and Yong [20] investigated the two-person zero-sum stochastic LQ differential
games. It was shown in [20] that the open-loop solvability is equivalent to the existence of an
adapted solution to a forward-backward stochastic differential equation (FBSDE, for short) with
constraint and the closed loop solvability is equivalent to the existence of a regular solution to the
Riccati equations. As a continuation work of [20], Sun, Li and Yong [18] fundamentally studied
the open-loop and closed-loop solvabilities for stochastic LQ optimal control problems. Moreover,
the equivalence between the strongly regular solvability of the Riccati equation and the uniform
convexity of the cost functional is established. Wang, Sun and Yong [21] introduced the notion of
weak closed-loop optimal strategy for LQ problems, and obtained its existence which is equivalent
to the open-loop solvability of the LQ problem. Zhang, Li and Xiong [29] studied the open-loop
and closed-loop solvabilities for stochastic LQ optimal control problems with Markovian regime
switching jumps, and established the equivalent relationship between the strongly regular solvability
of the Riccati equation and the uniform convexity of the cost functional in the circumstance of
Markovian regime switching system. In this paper, we further study the weak closed-loop solvability
of stochastic LQ optimal control problems with Markovian regime switching system. In order to
present our work more clearly, we describe the problem in detail.
Let (Ω, F, F, P) be a complete filtered probability space on which a standard one-dimensional
Brownian motion W = {W (t); 0 6 t < ∞} and a continuous time, finite-state, Markov chain
2

α = {α(t); 0 6 t < ∞} are defined, where F = {Ft }t>0 is the natural filtration of W and α
augmented by all the P-null sets in F, and Fα = {Ftα }t>0 is the filtration generated by α, with the
related expectation Eα . We identify the state space of the chain α with a finite set S , {1, 2 . . . , D},
where D ∈ N and suppose that the chain is homogeneous and irreducible. Let 0 6 t < T and consider
the following controlled Markovian regime switching linear stochastic differential equation (SDE,
for short) over a finite time horizon [t, T ]:

h
i

dX(s)
=
A(s,
α(s))X(s)
+
B(s,
α(s))u(s)
+
b(s)
ds




h
i
(1.1)
+
C(s,
α(s))X(s)
+
D(s,
α(s))u(s)
+
σ(s)
dW (s), s ∈ [t, T ],





X(t) = x,
α(t) = i,

where A, C : [0, T ] × S → Rn×n and B, D : [0, T ] × S → Rn×m are given deterministic functions,
called the coefficients of the state equation (1.1); b, σ : [0, T ]×Ω → Rn are F-progressively measurable
processes, called the nonhomogeneous terms; and (t, x, i) ∈ [0, T ) × Rn × S is called the initial pair.
In the above, the process u(·), which belongs to the following space:
Z T
o
n
m
|u(s)|2 ds < ∞ ,
U [t, T ] , u : [t, T ] × Ω → R
u is F-progressively measurable and E
t

is called the control process, and the solution X(·) of (1.1) is called the state process corresponding
to (t, x, i) and u(·). To measure the performance of the control u(·), we introduce the following
quadratic cost functional:
(
D
E
D
E
J(t, x, i; u(·)) , E G(α(T ))X(T ), X(T ) + 2 g(α(T )), X(T )
+

Z

t

T

!
!
!+
X(s)
X(s)
Q(s, α(s)) S(s, α(s))⊤
,
S(s, α(s)) R(s, α(s))
u(s)
u(s)
*
!
!+ # )
q(s, α(s))
X(s)
+2
,
ds ,
ρ(s, α(s))
u(s)

"*

(1.2)

where G(i) ∈ Rn×n is a symmetric constant matrix, and g(i) is an FT -measurable random variable
taking values in Rn , with i ∈ S; Q : [0, T ] × S → Rn×n , S : [0, T ] × S → Rm×n and R : [0, T ] × S →
Rm×m are deterministic functions with both Q and R being symmetric; q : [0, T ] × S → Rn and
ρ : [0, T ] × S → Rm are deterministic functions. In the above, M ⊤ stands for the transpose of a
matrix M . The problem that we are going to study is the following:
Problem (M-SLQ). For any given initial pair (t, x, i) ∈ [0, T ) × Rn × S, find a control u∗ (·) ∈
U [t, T ], such that
J(t, x, i; u∗ (·)) =

inf

u(·)∈U [t,T ]

J(t, x, i; u(·)),

∀u(·) ∈ U [t, T ].

(1.3)

The above is called a stochastic linear quadratic optimal control problem of the Markovian regime
switching system. Any u∗ (·) ∈ U [t, T ] satisfying (1.3) is called an open-loop optimal control of Problem (M-SLQ) for the initial pair (t, x, i); the corresponding state process X(·) = X(· ; t, x, i, u∗ (·))
3

is called an optimal state process; and the function V (·, ·, ·) defined by
V (t, x, i) ,

inf

u(·)∈U [t,T ]

J(t, x, i; u(·)),

(t, x, i) ∈ [0, T ] × Rn × S,

(1.4)

is called the value function of Problem (M-SLQ). Note that in the special case when
b(·, ·), σ(·, ·), g(·), q(·, ·), ρ(·, ·) = 0, the state equation (1.1) and the cost functional (1.2), respectively, become

h
i

dX(s)
=
A(s,
α(s))X(s)
+
B(s,
α(s))u(s)
ds




h
i
(1.5)
+
C(s,
α(s))X(s)
+
D(s,
α(s))u(s)
dW (s),
s ∈ [t, T ],





X(t) = x,
α(t) = i,
and

(
D
E
J (t, x, i; u(·)) = E G(α(T ))X(T ), X(T ))
0

+

Z

T
t

*

Q(s, α(s)) S(s, α(s))⊤
S(s, α(s)) R(s, α(s))

!

!
!+ )
X(s)
X(s)
,
ds .
u(s)
u(s)

(1.6)

We refer to the problem of minimizing (1.6) subject to (1.5) as the homogeneous LQ problem associated with Problem (M-SLQ), denoted by Problem (M-SLQ)0 . The corresponding value function
is denoted by V 0 (t, x, i). Moreover, when all the coefficients of (1.1) and (1.2) are independent of
the regime switching term α(·), the corresponding problem (1.3) is called Problem (SLQ).
Following the works of [20, 18], Zhang, Li and Xiong [29] investigated the open-loop and closedloop solvabilities for stochastic LQ problems of Markovian regime switching system. It was shown
that the open-loop solvability of Problem (M-SLQ) is equivalent to the solvability of a forwardbackward stochastic differential equation with constraint. They also showed that the closed-loop
solvability of Problem (M-SLQ) is equivalent to the existence of a regular solution of the following
general Riccati equation (GRE, for short):

Ṗ (s, i) + P (s, i)A(s, i) + A(s, i)⊤ P (s, i) + C(s, i)⊤ P (s, i)C(s, i) + Q(s, i)




D

X
⊤
−1
−Ŝ(s, i) R̂(s, i) Ŝ(s, i) +
λik (s)P (s, k) = 0, a.e. s ∈ [0, T ], i ∈ S,


k=1



P (T, i) = G(i),

where

(1.7)

Ŝ(s, i) = B(s, i)⊤ P (s, i) + D(s, i)⊤ P (s, i)C(s, i) + S(s, i),
R̂(s, i) = R(s, i) + D(s, i)⊤ P (s, i)D(s, i).

It can be found (see Zhang, Li and Xiong [29]) that, for the stochastic LQ optimal control problem
of Markovian regime switching system, the existence of a closed-loop optimal strategy implies the
existence of an open-loop optimal control, but not vice versa. Thus, there are some LQ problems
4

that are open-loop solvable, but not closed-loop solvable. Such problems cannot be expected to get
a regular solution (which does not exist) to the associated GRE (1.7). Therefore, the state feedback
representation of the open-loop optimal control might be impossible. To be more convincing, let us
look at the following simple example.
Example 1.1. Consider the following one-dimensional state equation
(
p


dX(s) = − α(s)X(s) + u(s) ds + 2α(s)X(s)dW (s),
X(t) = x,

α(t) = i,

s ∈ [t, 1],

and the nonnegative cost functional
J(t, x, i; u(·)) = E|X(1)|2 .
In this example, the GRE reads (noting that Q(·, i) = 0, R(·, i) = 0, D(·, i) = 0 for every i ∈ S, and
0−1 = 0):

D
X


 Ṗ (s, i) +
λik (s)P (s, k) = 0, a.e. s ∈ [t, 1],
(1.8)
k=1


 P (T, i) = 1, i ∈ S.

It is not hard to check that GRE (1.8) has no regular solution (see Section 3 for the definition of
regular solution), thus the corresponding LQ problem is not closed-loop solvable. A usual Riccati
equation approach specifies the corresponding state feedback control as follows (noting that Q(·, i) =
0, R(·, i) = 0, D(·, i) = 0 for every i ∈ S, and 0−1 = 0):
h
i−1h
i
u∗ (s) , − R(s, i)+D(s, i)⊤P (s, i)D(s, i)
B(s, i)P (s, i)+D(s, i)⊤P (s, i)C(s, i)+S(s, i) X(s) ≡ 0,
which is not an open-loop optimal control for any nonzero initial state x. In fact, let (t, x, i) ∈
[0, 1) × R × S be an arbitrary but the fixed initial pair with x 6= 0. By Itô’s formula, the state
process X ∗ (·) corresponding to (t, x, i) and u∗ (·) is expressed as

 Z s
Z sp
∗
2α(r)dW (r) ,
s ∈ [t, 1].
α(r)dr +
X (s) = x · exp −2
t

t

Thus,

J(t, x, i; u∗ (·)) = E|X ∗ (1)|2 = x2 > 0.
On the other hand, let ū(·) be the control defined by
 Z s

Z sp
x
2α(r)dW (r) ,
α(r)dr +
· exp −2
ū(s) ≡
t−1
t
t

s ∈ [t, 1].

By the variation of constants formula, the state process X̄(·), corresponding to (t, x, i) and ū(·),
can be presented by
 Z s

Z sp
2α(r)dW (r)
α(r)dr +
X̄(s) = exp −2



Z rp
Z s t  Z r t
α(v)dv −
exp 2
· x+
2α(v)dW (v) · ū(r)dr
t
t
 tZ s
 

Z sp
s−t
α(r)dr +
= exp −2
2α(r)dW (r) · x +
x ,
s ∈ [t, 1],
t−1
t
t
5

which satisfies X̄(1) = 0. Hence,
J(t, x, i; ū(·)) = E|X̄(1)|2 = 0 < J(t, x, i; u∗ (·)).
Since the cost functional is nonnegative, the open-loop control ū(·) is optimal for the initial pair
(t, x, i), but u∗ (·) is not optimal.
The above example suggests that the usual solvability of the GRE (1.7) no longer helpfully
handles the open-loop solvability of certain stochastic LQ problems. It is then natural to ask:
When Problem (M-SLQ) is merely open-loop solvable, not closed-loop solvable, is it still possible to
get a linear state feedback representation for an open-loop optimal control within the framework of
Markovian regime switching system? The goal of this paper is to tackle this problem.
The contribution of this paper is to study the weak closed-loop solvability of stochastic LQ
optimal control problems with Markovian regime switching system. In detail, we provide an alternative characterization of the open-loop solvability of Problem (M-SLQ) using the perturbation
approach adopted in [18]. In order to obtain a linear state feedback representation of open-loop
optimal control for Problem (M-SLQ), we introduce the notion of weak closed-loop strategies in the
circumstance of stochastic LQ optimal control problem of Markovian regime switching system. We
prove that as long as Problem (M-SLQ) is open-loop solvable, there always exists a weak closed-loop
strategy whose outcome actually is an open-loop optimal control. Consequently, the open-loop and
weak closed-loop solvability of Problem (M-SLQ) are equivalent on [0, T ). Comparing with [21], this
paper further develops the results in [21] to the case of stochastic LQ optimal control problems with
Markovian regime switching system, which could be applied to financial market models with Markov
process, such as interest rate, stocks return and volatility. However, the regime switching jumps will
bring some difficulties. For example, the first problem is how to define the closed-loop solvability
and weak closed-loop solvability in the circumstance of Markovian regime switching system. The
second problem is how to prove the equivalent between the open-loop and weak closed-loop solvability of Problem (M-SLQ) in the circumstance of Markovian regime switching system. We will
use the methods of [18], [21] and [29] to overcome these difficulties.
The rest of the paper is organized as follows. In Section 2, we collect some preliminary results
and introduce a few elementary notions for Problem (M-SLQ). Section 3 is devoted to the study
of open-loop solvability by a perturbation method. In section 4, we show how to obtain a weak
closed-loop optimal strategy and establish the equivalence between open-loop and weak closed-loop
solvability. Finally, an example is presented in Section 5 to illustrate the results we obtained.

2

Preliminaries

Throughout this paper, and recall from the previous section, let (Ω, F, F, P) be a complete filtered
probability space on which a standard one-dimensional Brownian motion W = {W (t); 0 6 t < ∞}
and a continuous time, finite-state, Markov chain α = {α(t); 0 6 t < ∞} are defined, where
F = {Ft }t>0 is the natural filtration of W and α augmented by all the P-null sets in F. In the rest
6

of our paper, we will use the following notation:
Rn
M⊤
tr [M ]
R(M )
M −1
h· , ·i
Rn×m

the n-dimensional Euclidean space;
the transpose of any vector or matrix M ;
the trace of a square matrix M ;
the range of the matrix M ;
the Moore-Penrose pseudo-inverse of the matrix M ;
the inner products in possibly different Hilbert spaces;
the Euclidean space of all n × m real matrices endowed
p with inner
⊤
product hM, N i 7→ tr [M N ] and the norm |M | = tr [M ⊤ M ];
the set of all n × n symmetric matrices,

Sn

and for an Sn -valued function F (·) on [t, T ], we use the notation F (·) ≫ 0 to indicate that F (·) is
uniformly positive definite on [t, T ], i.e., there exists a constant δ > 0 such that
F (s) > δI,

a.e. s ∈ [t, T ].

Next, for any t ∈ [0, T ) and Euclidean space H, we further introduce the following spaces of functions
and processes:
n
o
C([t, T ]; H) = ϕ : [t, T ] → H ϕ(·) is continuous ,


Z T
p
p
|ϕ(s)| ds < ∞ , 1 6 p < ∞,
L (t, T ; H) = ϕ : [t, T ] → H
t
(
)
L∞ (t, T ; H) =

ϕ : [t, T ] → H esssup |ϕ(s)| < ∞ ,
s∈[t,T ]

and
n
o
L2FT (Ω; H) = ξ : Ω → H ξ is FT -measurable, E|ξ|2 < ∞ ,

Z
2
LF (t, T ; H) = ϕ : [t, T ] × Ω → H ϕ(·) is F-progressively measurable, E



|ϕ(s)| ds < ∞ ,
#
"

T
t

2

L2F (Ω; C([t, T ]; H))

=

L2F (Ω; L1 (t, T ; H))


Z
= ϕ : [t, T ] × Ω → H ϕ(·) is F-progressively measurable, E

ϕ : [t, T ] × Ω → H ϕ(·) is F-adapted, continuous, E

2

sup |ϕ(s)|

s∈[t,T ]


<∞ ,

T
t

|ϕ(s)|ds

2


<∞ .

Now we start to formulate our system. We identify the state space of the chain α with a finite
set S , {1, 2 . . . , D}, where D ∈ N and suppose that the chain is homogeneous and irreducible. To
specify statistical or probabilistic properties of the chain α, for t ∈ [0, ∞), we define the generator
λ(t) , [λij (t)]i,j=1,2,...,D of the chain under P. This is also called the rate matrix, or the Q-matrix.
Here, for each i, j = 1, 2, . . . , D, λij (t) is the constant transition intensity of the chain from state
P
i to state j at time t. Note that λij (t) > 0, for i 6= j and D
j=1 λij (t) = 0, so λii (t) 6 0. In what
7

follows for each i, j = 1, 2, . . . , D with i 6= j, we suppose that λij (t) > 0, so λii (t) < 0. For each
fixed j = 1, 2, · · · , D, let Nj (t) be the number of jumps into state j up to time t and set
λj (t) ,

Z

t

0

λα(s−) j I{α(s−)6=j} ds =

Z
D
X

i=1,i6=j

t
0

λij (s)I{α(s−)=i} ds.

ej (t) , Nj (t) − λj (t) is an (F, P)-martingale.
Then for each j = 1, 2, · · · , D, the term N

To guarantee the well-posedness of the state equation (1.1), we adopt the following assumption:

(H1) For every i ∈ S, the coefficients and nonhomogeneous terms of (1.1) satisfy
(
A(·, i) ∈ L1 (0, T ; Rn×n ), B(·, i) ∈ L∞ (0, T ; Rn×m ), b(·) ∈ L2F (Ω; L1 (0, T ; Rn )),
C(·, i) ∈ L2 (0, T ; Rn×n ),

D(·, i) ∈ L∞ (0, T ; Rn×m ),

σ(·) ∈ L2F (0, T ; Rn ).

The following result, whose proof is similar to the result in [20, Proposition 2.1], establishes the
well-posedness of the state equation under the assumption (H1).
Lemma 2.1. Under the assumption (H1), for any initial pair (t, x, i) ∈ [0, T ) × Rn × S and control
u(·) ∈ U [t, T ], the state equation (1.1) has a unique adapted solution X(·) ≡ X(· ; t, x, i, u(·)).
Moreover, there exists a constant K > 0, independent of (t, x, i) and u(·), such that




Z T
Z T
2 Z T
2
2
2
2
|u(s)| ds .
(2.1)
E sup |X(s)| 6 KE |x| +
|σ(s)| ds +
|b(s)|ds +
t6s6T

t

t

t

To ensure that the random variables in the cost functional (1.2) are integrable, we assume the
following holds:
(H2) For every i ∈ S, the weighting coefficients in the cost functional (1.2) satisfy
(
G(i) ∈ Sn , Q(·, i) ∈ L1 (0, T ; Sn ), S(·, i) ∈ L2 (0, T ; Rm×n ), R(·, i) ∈ L∞ (0, T ; Sm ),
g(i) ∈ L2FT (Ω; Rn ),

q(·, i) ∈ L2 (0, T ; Rn ),

ρ(·, i) ∈ L2 (0, T ; Rm ).

Remark 2.2. Suppose that (H1) holds. Then according to Lemma 2.1, for any initial pair (t, x, i) ∈
[0, T ) × Rn × S and control u(·) ∈ U [t, T ], the state equation (1.1) admits a unique (strong) solution
X(·) ≡ X(·; t, x, i, u(·)) which belongs to the space L2F (Ω; C([t, T ]; H)). In addition, if (H2) holds,
then the random variables on the right-hand side of (1.2) are integrable, and hence Problem (MSLQ) is well-posed.
Let us recall some basic notions of stochastic LQ optimal control problems.
Definition 2.3 (Open-loop). Problem (M-SLQ) is said to be
(i) (uniquely) open-loop solvable for an initial pair (t, x, i) ∈ [0, T ] × Rn × S if there exists a
(unique) u∗ (·) = u∗ (· ; t, x, i) ∈ U [t, T ] (depending on (t, x, i)) such that
J(t, x, i; u∗ (·)) 6 J(t, x, i; u(·)),

∀u(·) ∈ U [t, T ].

Such a u∗ (·) is called an open-loop optimal control for (t, x, i).
8

(2.2)

(ii) (uniquely) open-loop solvable if it is (uniquely) open-loop solvable for all the initial pairs
(t, x, i) ∈ [0, T ] × Rn × S.

Definition 2.4 (Closed-loop). Let Θ : [t, T ] × S → Rm×n to be deterministic function and v :
[t, T ] × Ω → Rm be an F-progressively measurable process.
(i) We call (Θ(·, ·), v(·)) a closed-loop strategy on [t, T ] if
Z
Z T
2
|Θ(s, α(s))| ds < ∞, and E
E

t

t

T

|v(s)|2 ds < ∞.

(2.3)

The set of all closed-loop strategies (Θ(·, ·), v(·)) on [t, T ] is denoted by C [t, T ].

(ii) A closed-loop strategy (Θ∗ (·, ·), v ∗ (·)) ∈ C [t, T ] is said to be optimal on [t, T ] if
J(t, x, i; Θ∗ (·, α(·))X ∗ (·) + v ∗ (·)) 6 J(t, x, i; Θ(·, α(·))X(·) + v(·)),
∀(x, i) ∈ Rn × S,

∀(Θ(·, ·), v(·)) ∈ C [t, T ],

(2.4)

where X ∗ (·) is the solution to the closed-loop system under (Θ∗ (·, ·), v ∗ (·)):
n
o



dX ∗ (s) = A(s, α(s)) + B(s, α(s))Θ∗ (s, α(s)) X ∗ (s) + B(s, α(s))v ∗ (s) + b(s) ds



n




+ C(s, α(s)) + D(s, α(s))Θ∗ (s, α(s)) X ∗ (s)
o

∗


+D(s,
α(s))v
(s)
+
σ(s)
dW (s),
s ∈ [t, T ],



 ∗
X (t) = x,
(2.5)
and X(·) is the solution to the closed-loop system (2.5) corresponding to (Θ(·, ·), v(·)).
(iii) For any t ∈ [0, T ), if a closed-loop optimal strategy (uniquely) exists on [t, T ], Problem
(M-SLQ) is (uniquely) closed-loop solvable.
Remark 2.5. We emphasize that, in the above definition, Θ is a deterministic function, and in (2.3)
the randomness of Θ(·, α(·)) comes from α(·). Moreover, (2.4) must be true for all (x, i) ∈ Rn × S.
The same remark applies to the definition below.
Definition 2.6 (Weak closed-loop). Let Θ : [t, T ] × S → Rm×n be a deterministic function and
v : [t, T ] × Ω → Rm be an F-progressively measurable process such that for any T ′ ∈ [t, T ),
Z T′
Z T′
2
E
|Θ(s, α(s))| ds < ∞, and E
|v(s)|2 ds < ∞.
t

t

(i) We call (Θ(·, ·), v(·)) a weak closed-loop strategy on [t, T ) if for any initial state (x, i) ∈ Rn ×S,
the outcome u(·) ≡ Θ(·, α(·))X(·) + v(·) belongs to U [t, T ] ≡ L2F (t, T ; Rm ), where X(·) is the
solution to the weak closed-loop system:
n
o



dX(s)
=
A(s,
α(s))
+
B(s,
α(s))Θ(s,
α(s))
X(s)
+
B(s,
α(s))v(s)
+
b(s)
ds



n





+ C(s, α(s)) + D(s, α(s))Θ(s, α(s)) X(s)
(2.6)
o



+D(s,
α(s))v(s)
+
σ(s)
dW
(s),
s
∈
[t,
T
],




X(t) = x.
9

The set of all weak closed-loop strategies is denoted by Cw [t, T ].
(ii) A weak closed-loop strategy (Θ∗ (·, ·), v ∗ (·)) ∈ Cw [t, T ] is said to be optimal on [t, T ) if
J(t, x, i; Θ∗ (·, α(·))X ∗ (·) + v ∗ (·)) 6 J(t, x, i; Θ(·, α(·))X(·) + v(·)),
∀(x, i) ∈ Rn × S,

∀(Θ(·, ·), v(·)) ∈ Cw [t, T ],

(2.7)

where X(·) is the solution of the closed-loop system (2.6), and X ∗ (·) is the solution to the
weak closed-loop system (2.6) corresponding to (Θ∗ (·, ·), v ∗ (·)).
(iii) For any t ∈ [0, T ), if a weak closed-loop optimal strategy (uniquely) exists on [t, T ), Problem
(M-SLQ) is (uniquely) weakly closed-loop solvable.

3

Open-Loop Solvability: A Perturbation Approach

In this section, we study the open-loop solvability of Problem (M-SLQ) through a perturbation
approach. We begin by assuming that, for any choice of (t, i) ∈ [0, T ) × S,
J 0 (t, 0, i; u(·)) > 0,

∀u(·) ∈ U [t, T ],

(3.1)

which is necessary for the open-loop solvability of Problem (M-SLQ) according to [29, Theorem 4.1].
In fact, assumption (3.1) means that u(·) → J 0 (t, 0, i; u(·)) is convex, and one can actually prove
that assumption (3.1) implies the convexity of the mapping u(·) → J(t, x, i; u(·)) for any choice of
(t, x, i) ∈ [0, T ) × Rn × S (see [18, 29]).
For ε > 0, consider the LQ problem of minimizing the perturbed cost functional
Z T
|u(s)|2 ds
Jε (t, x, i; u(·)) , J(t, x, i; u(·)) + εE
t
(
D
E
D
E
= E G(α(T ))X(T ), X(T ) + 2 g(α(T )), X(T )
+

Z

T
t

"*

!
!
!+
Q(s, α(s))
S(s, α(s))⊤
X(s)
X(s)
,
u(s)
u(s)
S(s, α(s)) R(s, α(s)) + εIm
*
!
!+ # )
q(s, α(s))
X(s)
+2
,
ds ,
ρ(s, α(s))
u(s)

(3.2)

subject to the state equation (1.1). We denote this perturbed LQ problem by Problem (M-SLQ)ε
and its value function by Vε (·, ·, ·). Notice that the cost functional Jε0 (t, x, i; u(·)) of the homogeneous
LQ problem associated with Problem (M-SLQ)ε is
Z T
0
0
|u(s)|2 ds,
Jε (t, x, i; u(·)) = J (t, x, i; u(·)) + εE
t

which, by (3.1), satisfies
Jε0 (t, 0, i; u(·))

> εE

Z

t

10

T

|u(s)|2 ds.

The Riccati equations associated with Problem (M-SLQ)ε follow

Ṗε (s, i) + Pε (s, i)A(s, i) + A(s, i)⊤ Pε (s, i) + C(s, i)⊤ Pε (s, i)C(s, i) + Q(s, i)




D

X
−Ŝε (s, i)⊤ [R̂ε (s, i) + εIm ]−1 Ŝε (s, i) +
λik (s)Pε (s, k) = 0, a.e. s ∈ [0, T ], i ∈ S,


k=1



Pε (T, i) = G(i),
(3.3)
where for every (s, i) ∈ [0, T ] × S and ε > 0,
Ŝε (s, i) , B(s, i)⊤ Pε (s, i) + D(s, i)⊤ Pε (s, i)C(s, i) + S(s, i),
R̂ε (s, i) , R(s, i) + D(s, i)⊤ Pε (s, i)D(s, i).

(3.4)

We say that a solution Pε (·, ·) ∈ C([0, T ] × S; Sn ) of (3.3) is said to be regular if


R Ŝε (s, i) ⊆ R R̂ε (s, i) ,

a.e. s ∈ [0, T ], i ∈ S,

R̂ε (·, i)−1 Ŝε (·, i) ∈ L2 (0, T ; Rm×n ),
R̂ε (s, i) > 0,

i ∈ S,

a.e. s ∈ [0, T ], i ∈ S.

(3.5)
(3.6)
(3.7)

A solution Pε (·, ·) of (3.3) is said to be strongly regular if
R̂ε (s, i) > λI,

a.e. s ∈ [0, T ],

(3.8)

for some λ > 0. The system of Riccati equations (3.3) is said to be (strongly) regularly solvable,
if it admits a (strongly) regular solution. Clearly, condition (3.8) implies (3.5)-(3.7). Thus, a
strongly regular solution Pε (·, ·) must be regular. Moreover, it follows from [29, Theorem 6.3]
that, under the assumption (3.1), Riccati equations (3.3) have a unique strongly regular solution
Pε (·, ·) ∈ C([0, T ] × S; Sn ), and from (3.7), we have
R̂ε (s, i) + εIm > εIm ,

a.e. s ∈ [0, T ].

ε (·)) be the adapted solution of the following BSDE:
Furthermore, let (ηε (·), ζε (·), ξ1ε (·), · · · , ξD


n
⊤

dη
(s)
=
−
A(s, α(s)) + B(s, α(s))Θε (s, α(s)) ηε (s)

ε





⊤



+
C(s,
α(s))
+
D(s,
α(s))Θ
(s,
α(s))
ζε (s)
ε





⊤



+ C(s, α(s)) + D(s, α(s))Θε (s, α(s)) Pε (s, α(s))σ(s)


o
⊤
+
Θ
(s,
α(s))
ρ(s,
α(s))
+
P
(s,
α(s))b(s)
+
q(s,
α(s))
ds
ε
ε






D

X


ek (s), s ∈ [0, T ],

+ζε (s)dW (s) +
ξkε (s)dN




k=1




ηε (T ) = g(i),
11

(3.9)

and let Xε (·) be the solution of the following closed-loop system:

n
o




dX
(s)
=
A(s,
α(s))
+
B(s,
α(s))Θ
(s,
α(s))
X
(s)
+
B(s,
α(s))v
(s)
+
b(s)
ds
ε
ε
ε
ε




n




+ C(s, α(s)) + D(s, α(s))Θε (s, α(s)) Xε (s)
o



+D(s,
α(s))v
(s)
+
σ(s)
dW (s), s ∈ [t, T ],

ε





Xε (t) = x,

(3.10)

where Θε : [0, T ] × S → Rm×n and vε : [0, T ] × Ω → Rm are defined by

Θε (s, α(s)) = −[R̂ε (s, α(s)) + εIm ]−1 Ŝε (s, α(s)),
−1

vε (s) = −[R̂ε (s, α(s)) + εIm ]

(3.11)

ρ̂ε (s, α(s)),

(3.12)

with
ρ̂ε (s, i) = B(s, i)⊤ ηε (s) + D(s, i)⊤ ζε (s) + D(s, i)⊤ Pε (s, i)σ(s) + ρ(s, i).

(3.13)

Then from Theorem 5.2 and Corollary 6.5 in Zhang, Li and Xiong [29], the unique open-loop optimal
control of Problem (M-SLQ)ε , for the initial pair (t, x, i), is given by
uε (s) = Θε (s, α(s))Xε (s) + vε (s),

s ∈ [t, T ].

Remark 3.1. In equation (3.9), the term of Markovian switching is the sum

(3.14)
D
P

k=1

is equivalent to the sum

D
P

k,l=1

ε (s)dÑ (s)
ξkl
kl

ξkε (s)dÑk (s), which

as in Donnelly and Heunis [5], and Li and Zheng [13],

because their filtration is the same, where Ñkl (s) is defined as follows:
Ñkk (t) ≡ 0,

Ñkl (t) = Nkl (t) − λ̃kl (t),

for 1 6 k, l 6 D, k 6= l,

where Ñkl (t) is the number of jumps from state k to state l up to time t and λ̃kl (t) =
Rt
1
2
0 λkl (s)I{α(s−)=k} ds. In fact, for simplicity we could let N = (N1 , ..., ND ) and N = (Njk , ...).
2
1
On the one hand, it is easy to know that FtN ⊆ FtN . On the other hand, since
{α(t) = k} = {∃s < t, ∆N 1 (r) = 0, s < r < t, ∆Nk (s) = 1},
1

1

where ∆Nk (s) = Nk (s) − Nk (s−), we have α(t) ∈ FtN . So N 2 (t) ≡ (Njk (t), ...) ∈ Ftα ⊆ FtN ,
2
1
which implies that FtN ⊆ FtN . So their filtration is the same.
Before studying the main result of this section, we prove the following lemma.
Lemma 3.2. Under Assumptions (H1) and (H2), for any initial pair (t, x, i) ∈ [0, T ) × Rn × S, one
has
lim Vε (t, x, i) = V (t, x, i).
(3.15)
ε↓0

12

Proof. Let (t, x, i) ∈ [0, T ) × Rn × S be fixed. On the one hand, for any ε > 0 and any u(·) ∈ U [t, T ],
we have
Z T
Jε (t, x, i; u(·)) = J(t, x, i; u(·)) + εE
|u(s)|2 ds > J(t, x, i; u(·)) > V (t, x, i).
t

Taking the infimum over all u(·) ∈ U [t, T ] on the left hand side implies that
Vε (t, x, i) > V (t, x, i).

(3.16)

On the other hand, if V (t, x, i) is finite, then for any δ > 0, we can find a uδ (·) ∈ U [t, T ], independent
of ε > 0, such that
J(t, x, i; uδ (·)) 6 V (t, x, i) + δ.
It follows that
δ

Vε (t, x, i) 6 J(t, x, i; u (·)) + εE
Letting ε → 0, we obtain

Z

T
t

2

δ

|u (s)| ds 6 V (t, x, i) + δ + εE

Z

t

T

|uδ (s)|2 ds.

lim Vε (t, x, i) 6 V (t, x, i) + δ.

(3.17)

ε↓0

Since δ > 0 is arbitrary, by combining (3.16) and (3.17), we obtain (3.15). A similar argument
applies to the case when V (t, x, i) = −∞.
Now, we present the main result of this section, which provides a characterization of the openloop solvability of Problem (M-SLQ) in terms of the family {uε (·)}ε>0 .
Theorem 3.3. Let Assumptions (H1)-(H2) and (3.1) hold. For any given initial pair (t, x, i) ∈
[0, T ) × Rn × S, let uε (·) be defined by (3.14), which is the outcome of the closed-loop optimal
strategy (Θε (·, ·), vε (·)) of Problem (M-SLQ)ε . Then the following statements are equivalent:
(i) Problem (M-SLQ) is open-loop solvable at (t, x, i).
(ii) The family {uε (·)}ε>0 is bounded in L2F (t, T ; Rm ), i.e.,
sup E
ε>0

Z

t

T

|uε (s)|2 ds < ∞.

(iii) The family {uε (·)}ε>0 is convergent strongly in L2F (t, T ; Rm ) as ε → 0.
Proof. We begin by proving the implication (i) ⇒ (ii). Let v ∗ (·) be an open-loop optimal control
of Problem (M-SLQ) for the initial pair (t, x, i). Then for any ε > 0,
∗

∗

Vε (t, x, i) 6 Jε (t, x, i; v (·)) = J(t, x, i; v (·)) + εE
Z T
|v ∗ (s)|2 ds.
= V (t, x, i) + εE
t

13

Z

t

T

|v ∗ (s)|2 ds

(3.18)

On the other hand, since uε (·) is optimal for Problem (M-SLQ)ε with respect to (t, x, i), we have
Z T
|vε (s)|2 ds
Vε (t, x, i) = Jε (t, x, i; vε (·)) = J(t, x, i; vε (·)) + εE
t
(3.19)
Z T
2
|vε (s)| ds.
> V (t, x, i) + εE
t

Combining (3.18) and (3.19) yields that
Z T
Z T
Vε (t, x, i) − V (t, x, i)
2
|uε (s)| ds 6
E
|v ∗ (s)|2 ds.
6E
ε
t
t

(3.20)

This shows that {uε (·)}ε>0 is bounded in L2F (t, T ; Rm ).
For (ii) ⇒ (i), the proof is similar to [21] (See Remark 3.4 below), and the implication (iii) ⇒
(ii) is trivially true.
Finally, we prove the implication (ii) ⇒ (iii). We divide the proof into two steps.
Step 1: The family {uε (·)}ε>0 converges weakly to an open-loop optimal control of Problem
(M-SLQ) for the initial pair (t, x, i) as ε → 0.
To verify this, it suffices to show that every weakly convergent subsequence of {uε (·)}ε>0 has the
same weak limit which is an open-loop optimal control of Problem (M-SLQ) for (t, x, i). Let u∗i (·),
i = 1, 2 be the weak limits of two different weakly convergent subsequences {ui,εk (·)}∞
k=1 (i = 1, 2)
∗
of {uε (·)}ε>0 . The same argument as in the proof of (ii) ⇒ (i) shows that both u1 (·) and u∗2 (·) are
optimal for (t, x, i). Thus, recalling that the mapping u(·) 7→ J(t, x, i; u(·)) is convex, we have


1
1
u∗1 (·) + u∗2 (·)
6 J(t, x, i; u∗1 (·)) + J(t, x, i; u∗2 (·)) = V (t, x, i).
J t, x, i;
2
2
2
This means that

u∗1 (·)+u∗2 (·)
2

is also optimal for Problem (M-SLQ) with respect to (t, x, i). Then we

can repeat the argument employed in the proof of (i) ⇒ (ii), replacing v ∗ (·) by
(see (3.20))
Z T ∗
Z T
u1 (s) + u∗2 (s) 2
ds,
i = 1, 2.
|ui,εk (s)|2 ds 6 E
E
2
t
t
Now, note that
Z
06E

t

T

|ui,εk (s) −

u∗i (s)|2 ds

=E

Z

T

t

which implies that
2E

Z

t

T

hui,εk (s), u∗i (s)ids

Taking inferior limits then yields
Z
Z T
∗
2
|ui (s)| ds = 2 lim inf E
E
t

εk →0

t

T

−E

h
Z

u∗1 (·)+u∗2 (·)
2

to obtain

i
|ui,εk (s)|2 − 2hui,εk (s), u∗i (s)i + |u∗i (s)|2 ds,

t

T

|u∗i (s)|2 ds

hui,εk (s), u∗i (s)ids
14

6E

−E

Z

Z
T

t

T
t

|ui,εk (s)|2 ds.

|u∗i (s)|2 ds

6 lim inf E
εk →0

Z

T

2

|ui,εk (s)| ds 6 E

t

Z

T

t

 u∗ (s) + u∗ (s) 2
2

1

2

i = 1, 2.

ds

Adding the above two inequalities and then multiplying by 2, we get
 Z
2 E

T
t

|u∗1 (s)|2 ds

+E

Z

T

t

|u∗2 (s)|2 ds



6E

Z

T

t

|u∗1 (s) + u∗2 (s)|2 ds,

or equivalently (by shifting the integral on the right-hand side to the left-hand side),
E

Z

T
t

|u∗1 (s) − u∗2 (s)|2 ds 6 0.

It follows that u∗1 (·) = u∗2 (·), which establishes the claim.
Step 2: The family {uε (·)}ε>0 converges strongly as ε → 0.
According to Step 1, the family {uε (·)}ε>0 converges weakly to an open-loop optimal control
of Problem (M-SLQ) for (t, x, i) as ε → 0. By repeating the argument employed in the proof
of (i) ⇒ (ii) with u∗ (·) replacing v ∗ (·), we obtain

u∗ (·)

E

Z

T

2

|uε (s)| ds 6 E

t

Z

T
t

|u∗ (s)|2 ds,

ε > 0.

(3.21)

On the other hand, since u∗ (·) is the weak limit of {uε (·)}ε>0 , we have
E

Z

t

T

∗

2

|u (s)| ds 6 lim inf E
ε→0

Z

t

T

|uε (s)|2 ds.

(3.22)

RT
RT
Combining (3.21) and (3.22), we see that E t |uε (s)|2 ds actually has the limit E t |u∗ (s)|2 ds.
Therefore (recalling that {uε (·)}ε>0 converges weakly to u∗ (·)),
Z

T

|uε (s) − u∗ (s)|2 ds
t Z T
Z
2
= lim E
|uε (s)| ds + E
lim E

ε→0

ε→0

t

t

T

∗

2

|u (s)| ds − 2E

0,

Z

T

t

∗

hu (s), uε (s)ids



which means that {uε (·)}ε>0 converges strongly to u∗ (·) as ε → 0.
Remark 3.4. A similar result recently appeared in Zhang, Li and Xiong [29], which asserts that if
Problem (M-SLQ) is open-loop solvable at (t, x, i), then the limit of any weakly/strongly convergent
subsequence of {uε (·)}ε>0 is an open-loop optimal control for (t, x, i). Our result sharpens that in
[29] by showing the family {uε (·)}ε>0 itself is strongly convergent when Problem (M-SLQ) is openloop solvable. This improvement has at least two advantages. First, it serves as a crucial bridge to
the weak closed-loop solvability presented in the next section. Second, it is much more convenient
for computational purposes because subsequence extraction is not required.
15

Remark 3.5. In Example 1.1, since B = 1 and D = S = R = 0, we have
Ŝε (s, i) , B(s, i)⊤ Pε (s, i) + D(s, i)⊤ Pε (s, i)C(s, i) + S(s, i) = Pε (s, i) with Pε (T, i) = 1,
R̂ε (s, i) , R(s, i) + D(s, i)⊤ Pε (s, i)D(s, i) = 0.


So the condition R Ŝε (s, i) ⊆ R R̂ε (s, i) , a.e. s ∈ [0, T ], i ∈ S is not satisfied, which implies that
GRE (1.8) has no regular solution.

4

Weak Closed-Loop Solvability

In this section, we study the equivalence between open-loop and weak closed-loop solvabilities of
Problem (M-SLQ). We shall show that Θε (·, ·) and vε (·) defined by (3.11) and (3.12) converge locally
in [0, T ), and that the limit pair (Θ∗ (·, ·), v ∗ (·)) is a weak closed-loop optimal strategy.
We start with a simple lemma, which enables us to work separately with Θε (·, ·) and vε (·). Recall
that the associated Problem (M-SLQ)0 is to minimize (1.6) subject to (1.5).
Lemma 4.1. Under Assumptions (H1) and (H2), if Problem (M-SLQ) is open-loop solvable, then
so is Problem (M-SLQ)0 .
Proof. For arbitrary (t, x, i) ∈ [0, T ) × Rn × S, we note that if b(·, ·), σ(·, ·), g(·), q(·, ·), ρ(·, ·) = 0,
ε (·)) to BSDE (3.9) is identically zero, and hence
then the adapted solution (ηε (·), ζε (·), ξ1ε (·), · · · , ξD
the process vε (·) defined by (3.12) is also identically zero. By Theorem 3.3, to prove that Problem
(M-SLQ)0 is open-loop solvable at (t, x, i), we need to verify that the family {uε (·)}ε>0 is bounded
in L2F (t, T ; Rm ), where (see (3.14) and note that vε (·) = 0),
uε (·) = Θε (·, α(·))Xε (·),
with Xε (·) is the solution to the following equation:





dX
(s)
=
A(s,
α(s))
+
B(s,
α(s))Θ
(s,
α(s))
Xε (s)ds
ε
ε




+
C(s,
α(s))
+
D(s,
α(s))Θ
(s,
α(s))
Xε (s)dW (s),
ε




Xε (t) = x.

(4.1)

s ∈ [t, T ],

(4.2)

To this end, we return to Problem (M-SLQ). Let vε (·) be defined in (3.12) and denote by Xε (· ; t, x, i)
and Xε (· ; t, 0, i) solutions to (3.10) with respect to the initial pairs (t, x, i) and (t, 0, i), respectively.
Since Problem (M-SLQ) is open-loop solvable at both (t, x, i) and (t, 0, i), by Theorem 3.3, the
families
uε (s; t, x, i) , Θε (s, α(s))Xε (s; t, x, i) + vε (s),
s ∈ [t, T ],
(4.3)
uε (s; t, 0, i) , Θε (s, α(s))Xε (s; t, 0, i) + vε (s),
are bounded in L2F (t, T ; Rm ). Note that due to that the process vε (·) is independent of the initial
state, the difference Xε (· ; t, x, i) − Xε (· ; t, 0, i) also satisfies the same equation (4.2). Then by the
uniqueness of adapted solutions of SDEs, we obtain that
Xε (·) = Xε (· ; t, x, i) − Xε (· ; t, 0, i),
16

which, combining (4.1) and (4.3), implies that
uε (·) = uε (·, t, x, i) − uε (·, t, 0, i).
Since {uε (·, t, x, i)}ε>0 and {uε (·, t, 0, i)}ε>0 are bounded in L2F (t, T ; Rm ), so is {uε (·)}ε>0 . Finally,
it follows from Theorem 3.3 that Problem (M-SLQ)0 is open-loop solvable.
Next, we prove that the family {Θε (·, ·)}ε>0 defined by (3.11) is locally convergent in [0, T ).
Proposition 4.2. Let (H1) and (H2) hold. Suppose that Problem (M-SLQ)0 is open-loop solvable.
Then the family {Θε (·, ·)}ε>0 defined by (3.11) converges in L2 (0, T ′ ; Rm×n ) for any 0 < T ′ < T ;
that is, there exists a locally square-integrable deterministic function Θ∗ : [0, T ) × S → Rm×n such
that
Z ′
T

lim E

ε→0

0

|Θε (s, α(s)) − Θ∗ (s, α(s))|2 ds = 0,

∀ 0 < T ′ < T.

Proof. We need to show that for any 0 < T ′ < T , the family {Θε (·)}ε>0 is Cauchy in L2 (0, T ′ ; Rm×n ).
To this end, let us first fix an arbitrary initial (t, i) ∈ [0, T )×S and let Φε (·) ∈ L2F (Ω; C([t, T ]; Rn×n ))
be the solution to the following SDE:






 dΦε (s) = A(s, α(s)) + B(s, α(s))Θε (s, α(s)) Φε (s)ds


(4.4)
+ C(s, α(s)) + D(s, α(s))Θε (s, α(s)) Φε (s)dW (s),
s ∈ [t, T ],




Φε (t) = In .
Clearly, for any initial state x, from the uniqueness of SDEs, the solution of (4.2) is given by
Xε (s) = Φε (s)x,

s ∈ [t, T ].

Since Problem (M-SLQ)0 is open-loop solvable, by Theorem 3.3, the family
uε (s) = Θε (s, α(s))Xε (s) = Θε (s, α(s))Φε (s)x,

s ∈ [t, T ],

ε>0

is strongly convergent in L2F (t, T ; Rm ) for any x ∈ Rn . It follows that {Θε (·, ·)Φε (·)}ε>0 converges
strongly in L2F (t, T ; Rm×n ) as ε → 0. Denote Uε (·) = Θε (·, ·)Φε (·) and let U ∗ (·) be the strong limit
of Uε (·). By Jensen’s inequality, we get
Z T
Z T
2
2
∗
Uε (s) − U ∗ (s) ds → 0 as ε → 0.
(4.5)
E[Uε (s)] − E[U (s)] ds 6 E
t

t

Eα [Φ

Moreover, from (4.4), one see that
ε (·)] satisfies the following ODE:

n
o
 dEα [Φε (s)] = A(s, α(s))Eα [Φε (s)] + B(s, α(s))Eα [Uε (s)] ds,
s
s
s
 Eα [Φ (t)] = I .
t

ε

s ∈ [t, T ],

n

By the standard results of ODE, combining (4.5), the family of continuous functions Eα [Φε (·)]
converges uniformly to the solution of

n
o
 dEα [Φ∗ (s)] = A(s, α(s))Eα [Φ∗ (s)] + B(s, α(s))Eα [U ∗ (s)] ds, s ∈ [t, T ],
s
s
s
 Eα [Φ∗ (t)] = I .
t

n

17

Thus, by noting that Eαt [Φ∗ (t)] = In , we can choose some small constant ∆t > 0 such that for small
ε > 0,
(a) Eαs [Φε (s)] is invertible for all s ∈ [t, t + ∆t ], and
(b) |Eαs [Φε (s)]| >

1
2

for all s ∈ [t, t + ∆t ].

We claim that the family {Θε (·, i)}ε>0 is Cauchy in L2 (t, t + ∆t ; Rm×n ) for each i ∈ S. Indeed, first
note that when s ∈ [t, t + ∆t ], note that (a) and (b), one has
Uε (s) = Θε (s, α(s))Φε (s) =⇒ Eαs [Uε (s)] = Θε (s, α(s))Eαs [Φε (s)]
=⇒ Θε (s, α(s)) = Eαs [Uε (s)]Eαs [Φε (s)]−1 .
Then we have
Z t+∆t
2
Θε1 (s, α(s)) − Θε2 (s, α(s)) ds
E
t
Z t+∆t
2
Eαs [Uε1 (s)]Eαs [Φε1 (s)]−1 − E[Uε2 (s)]Eαs [Φε2 (s)]−1 ds
=E
t
Z
t+∆t
2
2
Eαs [Uε1 (s) − Uε2 (s)] · Eαs [Φε1 (s)]−1 ds
6 2E
t
Z t+∆t
2
2
Eαs [Uε2 (s)] · Eαs [Φε1 (s)]−1 − Eαs [Φε2 (s)]−1 ds
+2E
t
Z t+∆
t
2
2
Eαs [Uε1 (s) − Uε2 (s)] · Eαs [Φε1 (s)]−1 ds
= 2E
t
Z t+∆t
2
2
2
2
Eαs [Uε2 (s)] · Eαs [Φε1 (s) − Φε2 (s)] · Eαs [Φε1 (s)]−1 · Eαs [Φε2 (s)]−1 ds
+2E
t
Z t+∆t
Z t+∆


t
2
2
2
E[Φε1 (s)] − E[Φε2 (s)] .
sup
E[Uε2 (s)] ds ·
E[Uε1 (s) − Uε2 (s)] ds + 32
68
t6s6t+∆t

t

t

Since {Uε (·)}ε>0 is Cauchy in L2F (t, T ; Rm×n ) and {E[Φε (·)]}ε>0 converges uniformly on [t, T ], the
last two terms of the above inequality approach to zero as ε1 , ε2 → 0, which implies that {Θε (·, i)}ε>0
is Cauchy in L2 (t, t + ∆t ; Rm×n ) for each i ∈ S.
Next we use a compactness argument to prove that, for each i ∈ S, {Θε (·, i)}ε>0 is actually
Cauchy in L2 (0, T ′ ; Rm×n ) for any 0 < T ′ < T . Take any T ′ ∈ (0, T ). From the preceding argument
we see that for each t ∈ [0, T ′ ], there exists a small ∆t > 0 such that {Θε (·, i)}ε>0 is Cauchy in
L2 (t, t + ∆t ; Rm×n ). Since [0, T ′ ] is compact, we can choose finitely many t ∈ [0, T ′ ], say, t1 , t2 , ..., tk ,
S
such that {Θε (·, i)}ε>0 is Cauchy in each L2 (tj , tj + ∆tj ; Rm×n ) and [0, T ′ ] ⊆ kj=1 [tj , tj + ∆tj ]. It
follows that
Z T
2
Θε1 (s, α(s)) − Θε2 (s, α(s)) ds
E
6

t
k
X
j=1

E

Z

t

tj +∆tj

2

Θε1 (s, α(s)) − Θε2 (s, α(s)) ds → 0 as

The proof is therefore completed.
18

ε1 , ε2 → 0.

The following result shows that the family {vε (·)}ε>0 defined by (3.12) is also locally convergent
in [0, T ).
Proposition 4.3. Let (H1) and (H2) hold. Suppose that Problem (M-SLQ) is open-loop solvable.
Then the family {vε (·)}ε>0 defined by (3.12) converges in L2 (0, T ′ ; Rm ) for any 0 < T ′ < T ; that
is, there exists a locally square-integrable deterministic function v ∗ (·) : [0, T ) → Rm such that
Z T′
|vε (s) − v ∗ (s)|2 ds = 0,
∀ 0 < T ′ < T.
lim E
ε→0

0

Proof. Let Xε (s), 0 6 s 6 T , be the solution to the closed-loop system (3.10) with respect to initial
time t = 0. Then, on the one hand, from the linearity of the state equation (1.1) and Lemma 2.1,
we have


Z
E

sup |Xε1 (s) − Xε2 (s)|2 6 KE

06s6T

T

0

|uε1 (s) − uε2 (s)|2 ds.

On the other hand, since Problem (M-SLQ) is open-loop solvable, Theorem 3.3 implies that the
family
uε (s) = Θε (s, α(s))Xε (s) + vε (s),
s ∈ [0, T ];
ε>0
(4.6)

is Cauchy in L2F (0, T ; Rm ), i.e.,
Z T
|uε1 (s) − uε2 (s)|2 ds → 0 as
E
0

Therefore

E



2

sup |Xε1 (s) − Xε2 (s)|

06s6T



→0

as

ε1 , ε2 → 0.

(4.7)

ε1 , ε2 → 0.

(4.8)

Now for every 0 < T ′ < T . Since Problem (M-SLQ) is open-loop solvable, according to Lemma 4.1
and Proposition 4.2, the family {Θε (·, i)}ε>0 is Cauchy in L2 (0, T ′ ; Rm×n ) for every i ∈ S. Thus,
combining (4.8), we have
Z T′
2
E
Θε1 (s, α(s))Xε1 (s) − Θε2 (s, α(s))Xε2 (s) ds
0


Z T′
|Θε1 (s, α(s)) − Θε2 (s, α(s))|2 ds · E sup |Xε1 (s)|2
6 2E
0

+2E

Z

T′

0

2

|Θε2 (s, α(s))| ds · E

−→ 0 as



06s6T ′

2

sup |Xε1 (s) − Xε2 (s)|

06s6T ′



ε1 , ε2 → 0,

which combing (4.6) and (4.7), implies that
Z T′
E
|vε1 (s) − vε2 (s)|2 ds
0
Z T′
2
=E
[uε1 (s) − Θε1 (s, α(s))Xε1 (s)] − [uε2 (s) − Θε2 (s, α(s))Xε2 (s)] ds
0
Z T′
Z T′
2
6 2E
|uε1 (s) − uε2 (s)| ds + 2E
|Θε1 (s, α(s))Xε1 (s) − Θε2 (s)Xε2 (s, α(s))|2 ds
0

−→ 0

0

as

ε1 , ε2 → 0.
19

This shows that the family {vε (·)}ε>0 converges in L2F (0, T ′ ; Rm ).
We are now ready to state and prove the main result of this section, which establishes the
equivalence between open-loop and weak closed-loop solvability of Problem (M-SLQ).
Theorem 4.4. Let (H1) and (H2) hold. If Problem (M-SLQ) is open-loop solvable, then the limit
pair (Θ∗ (·, ·), v ∗ (·)) obtained in Propositions 4.2 and 4.3 is a weak closed-loop optimal strategy of
Problem (M-SLQ) on any [t, T ). Consequently, the open-loop and weak closed-loop solvability of
Problem (M-SLQ) are equivalent.
Proof. From Definition 2.6, it is obvious that the weak closed-loop solvability of Problem (M-SLQ)
implies the open-loop solvability of Problem (M-SLQ). In the following, we consider the inverse
case.
Take an arbitrary initial pair (t, x, i) ∈ [0, T ) × Rn × S and let {uε (s); t 6 s 6 T }ε>0 be the
family defined by (3.14). Since Problem (M-SLQ) is open-loop solvable at (t, x, i), by Theorem 3.3,
{uε (s); t 6 s 6 T }ε>0 converges strongly to an open-loop optimal control {u∗ (s); t 6 s 6 T }ε>0 of
Problem (M-SLQ) (for the initial pair (t, x, i)). Let {X ∗ (s); t 6 s 6 T }ε>0 be the corresponding
optimal state process; i.e., X ∗ (·) is the adapted solution of the following equation:

h
i


∗
∗
∗

dX
(s)
=
A(s,
α(s))X
(s)
+
B(s,
α(s))u
(s)
+
b(s)
ds



h
i
∗
∗
+
C(s,
α(s))X
(s)
+
D(s,
α(s))u
(s)
+
σ(s)
dW (s),





 X ∗ (t) = x.

s ∈ [t, T ],

If we can show that

u∗ (s) = Θ∗ (s, α(s))X ∗ (s) + v ∗ (s),

t 6 s < T,

(4.9)

then (Θ∗ (·, ·), v ∗ (·)) is clearly a weak closed-loop optimal strategy of Problem (M-SLQ) on [t, T ).
To justify the argument, we note first that by Lemma 2.1, we obtain
E



∗

2

sup |Xε (s) − X (s)|

t6s6T



6 KE

Z

T

t

|uε (s) − u∗ (s)|2 ds → 0

as

ε → 0,

where {Xε (s); t 6 s 6 T }ε>0 is the solution of equation (3.10). Second, by Propositions 4.2 and
4.3, one has

Z T′



lim
E
|Θε (s, α(s)) − Θ∗ (s, α(s))|2 ds = 0,
∀0 < T ′ < T,
 ε→0
0
Z T′



|vε (s) − v ∗ (s)|2 ds = 0,
∀0 < T ′ < T.
 lim E
ε→0

0

20

It follows that for any 0 < T ′ < T ,
Z

T′

 
2
Θε (s, α(s))Xε (s) + vε (s) − Θ∗ (s, α(s))X ∗ (s) + v ∗ (s) ds
0
Z T′
Z T′
|vε (s) − v ∗ (s)|2 ds
|Θε (s, α(s))Xε (s) − Θ∗ (s, α(s))X ∗ (s)|2 ds + 2E
6 2E
0

 0 Z T′
Z T′
|Θε (s, α(s))|2 ds · E sup |Xε (s) − X ∗ (s)|2 + 2E
6 4E
|vε (s) − v ∗ (s)|2 ds
E



06s6T ′

0

+4E
−→ 0

Z

T′

0

as

|Θε (s, α(s)) − Θ∗ (s, α(s))|2 ds · E



sup |X ∗ (s)|2

06s6T ′



0

ε → 0.

Recall that uε (s) = Θε (s, α(s))Xε (s) + vε (s) converges strongly to u∗ε (s), t 6 s 6 T , in L2F (t, T ; Rm )
as ε → 0. Thus, (4.9) must hold. The above argument shows that the open-loop solvability implies
the weak closed-loop solvability. Consequently, the open-loop and weak closed-loop solvability of
Problem (M-SLQ) are equivalent. This completes the proof.

5

Examples

There are some (M-SLQ) problems that are open-loop solvable, but not closed-loop solvable; for such
problems, one could not expect to get a regular solution (which does not exist) to the associated GRE
(3.3), so that the state feedback representation of the open-loop optimal control might be impossible.
In fact, Example 1.1 has illustrated this conclusion. However, Theorem 4.4 shows that the openloop and weak closed-loop solvability of Problem (M-SLQ) are equivalent. In the following, we
present another example to illustrate the procedure for finding weak closed-loop optimal strategies
for some (M-SLQ) problems that are open-loop solvable (and hence weakly closed-loop solvable)
but not closed-loop solvable.
Example 5.1. In order to present the procedure more clearly, we simplify the problem. Let T = 1
and D = 2, that is, the state space of α(·) is S = {1, 2}. For the generator λ(s) , [λij (s)]i,j=1,2 ,
P
note that 2j=1 λij (s) = 0 for i ∈ S, then
λ(s) =

λ11 (s) λ12 (s)
λ21 (s) λ22 (s)

!

=

!
λ11 (s) −λ11 (s)
,
−λ22 (s) λ22 (s)

s ∈ [0, 1].

Consider the following Problem (M-SLQ) with one-dimensional state equation

h
i
p
 dX(s) = − α(s)X(s) + u(s) + b(s) ds + 2α(s)X(s)dW (s),

X(t) = x, α(t) = i,

and the cost functional

J(t, x, i; u(·)) = E|X(1)|2 ,
21

s ∈ [t, 1],

(5.1)

where the nonhomogeneous term b(·, ·) is given by
Z s

Z s

p
1

 √
2α(r)dW (r) − 2
· exp
α(r)dr ,
1−s
0
0
b(s) =


0,
if s = 1.

if s ∈ [0, 1);

It is easy to see that b(·, i) ∈ L2F (Ω; L1 (0, 1; R)) for each i ∈ S. In fact,
Z s
 2
Z 1
2
Z 1
Z s
p
1
√
· exp
α(r)dr ds
2α(r)dW (r) − 2
|b(s)|ds = E
E
1−s
0
0
0
0
Z 1
Z s
 2
Z s
p
1
√
6E
· exp
α(r)dr ds
2α(r)dW (r) −
1−s
0
0
0
2
Z 1
Z s
Z s
p
1
√
α(r)dr
2α(r)dW (r) −
6E
ds · sup exp
1−s
06s61
0
0
0
2
2

Z s
Z 1
Z s
p
1
√
α(r)dr
ds · E sup exp
=
2α(r)dW (r) −
1−s
06s61
0
0
0

Z s
2
Z s
p
= 4 E sup exp
.
α(r)dr
2α(r)dW (r) −
06s61

0

nR p
s

Rs

0

o

Since the term exp 0 2α(r)dW (r) − 0 α(r)dr is a square-integrable martingale, note that α(·)
belongs to S = {1, 2}, it follows from Doob’s maximal inequality that
 Z 1
2


Z s
Z s
Z 1
p
p
6
4E
exp
2
α(r)dr
α(r)dr
2α(r)dW (r) −
2α(r)dW (r) − 2
E sup exp
06s61

0

0

0

0

4

6 4e .

Thus,
E

Z

1
0

|b(s)|ds

2

6 16e4 ,

which implies that b(·, i) ∈ L2F (Ω; L1 (0, 1; R)) for each i ∈ S.
We first claim that this (M-SLQ) problem is not closed-loop solvable on any [t, 1]. Indeed, the
generalized Riccati equation associate with this problem reads
(
Ṗ (s, 1) + λ11 (s)P (s, 1) − λ11 (s)P (s, 2) = 0,
a.e. s ∈ [t, 1],
for i = 1,
P (1, 1) = 1,
and

(

Ṗ (s, 2) − λ22 (s)P (s, 1) + λ22 (s)P (s, 2) = 0,

P (1, 2) = 1,

a.e. s ∈ [t, 1],

for i = 2,

whose solutions are P (s, 1) = P (s, 2) = 1, or P (s, i) ≡ 1, for (s, i) ∈ [0, 1] × S. Then for any s ∈ [t, 1]
and i ∈ S, we have



R Ŝ(s, i) = R(1) = R,
=⇒
R Ŝ(s, i) * R R̂(s, i) .

R R̂(s, i) = R(0) = {0},
22

where
Ŝ(s, i) , B(s, i)⊤ P (s, i) + D(s, i)⊤ P (s, i)C(s, i) + S(s, i),

(5.2)

R̂(s, i) , R(s, i) + D(s, i)⊤ P (s, i)D(s, i).
Therefore, the range inclusion condition is not satisfied. This implies that our claim holds.

In the following, we use Theorem 3.3 to conclude that the above (M-SLQ) problem is open-loop
solvable (and hence, by Theorem 4.4, weakly closed-loop solvable). Without loss of generality, we
consider only the open-loop solvability at t = 0. To this end, let ε > 0 be arbitrary and consider
Riccati equations (3.3), which, in our example, read:

 Ṗ (s, 1) − 1 P (s, 1)2 + λ (s)P (s, 1) − λ (s)P (s, 2) = 0,
ε
11
ε
11
ε
ε
ε

Pε (1, 1) = 1,

a.e. s ∈ [t, 1],

for i = 1,

a.e. s ∈ [t, 1],

for i = 2.

and


 Ṗ (s, 2) − 1 P (s, 2)2 − λ (s)P (s, 1) + λ (s)P (s, 2) = 0,
ε
ε
22
ε
22
ε
ε

Pε (1, 2) = 1,

Solving the above equations yields

Pε (s, 1) = Pε (s, 2) =

ε
,
ε+1−s

s ∈ [0, 1].

Or
Pε (s, i) =

ε
,
ε+1−s

(s, i) ∈ [0, 1] × S.

Noting that the state space of α(s) is S = {1, 2}, we let
Θε (s, α(s)) , −[R̂ε (s, α(s)) + εIm ]−1 Ŝε (s, α(s))
Pε (s, α(s))
1
=−
=−
,
s ∈ [0, 1].
ε
ε+1−s

(5.3)

Then, the corresponding BSDE (3.9) reads
n
o

p


dη
(s)
=
−
Θ
(s,
α(s))
−
α(s)
η
(s)
+
2α(s)ζ
(s)
+
P
(s,
α(s))b(s)
ds
ε
ε
ε

ε
ε





2
X
ek (s),
+ζε (s)dW (s) +
ξkε (s)dN
s ∈ [0, 1],



k=1




ηε (1) = 0.

Let f (s) =

√1 .
1−s

Using the variation of constants formula for BSDEs, and noting that W (·) and
23

ek (·) are (F, P)-martingales, we obtain
N


 Z s
Z sp
ε
2α(r)dW (r)
α(r)dr −
· exp 2
ηε (s) =
ε+1−s
0
0
Z r
Z 1


Z r
p
b(r) · exp
·E
2α(r̄)dW (r̄) − 2
α(r̄)dr̄ dr Fs
s
0
 Z 0s

Z sp
ε
α(r)dr −
· exp 2
2α(r)dW (r)
=
ε+1−s
0
0

 Z r


Z 1
Z r
p
2α(r̄)dW (r̄) − 4
f (r) · E exp 2
·
α(r̄)dr̄ Fs dr
s
0
Z s 0
 Z 1
Z
s
p
ε
2α(r)dW (r) − 2
· exp
=
f (r)dr,
α(r)dr ·
ε+1−s
0
s
0

s ∈ [0, 1].

It should be point out that, in the above equality, we use the Fibini’s Theorem and the martingale
property, i.e.,


 Z r
Z r
p
2α(r̄)dW (r̄) − 4
α(r̄)dr̄ Fs
E exp 2
0
0

 Z s
Z s
p
α(r̄)dr̄ ,
0 6 s 6 r 6 1.
2α(r̄)dW (r̄) − 4
= exp 2


0

0

Now, let
ηε (s)
vε (s) , −[R̂ε (s, α(s)) + εIm ]−1 ρ̂ε (s, α(s)) = −
εZ
Z s
 Z 1
s
p
1
=−
2α(r)dW (r) − 2
· exp
α(r)dr ·
f (r)dr,
ε+1−s
0
0
s

(5.4)
s ∈ [0, 1].

Then, the corresponding closed-loop system (3.10) can be written as
n
o

p

 dXε (s) = Θε (s, α(s)) − α(s) Xε (s) + vε (s) + b(s) ds + 2α(s)Xε (s)dW (s),


s ∈ [0, 1],

Xε (0) = x,

By the variation of constants formula for SDEs, we get
Z

Z

sp

s



α(r)dr
Xε (s) = (ε + 1 − s) · exp
2α(r)dW (r) − 2
0
0 


Z s
Z r
Z rp

1
·
α(r̄)dr̄ · vε (r) + b(r, α(r)) dr
2α(r̄)dW (r̄) + 2
· exp −
ε+1−r
0
0
0
Z s

Z s
p
ε+1−s
2α(r)dW (r) − 2
· exp
+x·
α(r)dr ,
s ∈ [0, 1].
ε+1
0
0
In light of Theorem 3.3, in order to prove the open-loop solvability at (0, x, i), it suffices to show
24

the family {uε (·)}ε>0 defined by
uε (s) , Θε (s, α(s))Xε (s) + vε (s)
Z s

Z s
p
2α(r)dW (r) − 2
= − exp
α(r)dr
 Z r 0


Z r
Z s 0
p

1
· exp −
2α(r̄)dW (r̄) + 2
α(r̄)dr̄ · vε (r) + b(r, α(r)) dr
·
ε+1−r
0
0
0

Z s
Z
s
p
x
α(r)dr + vε (s),
s ∈ [0, 1],
2α(r)dW (r) − 2
· exp
−
ε+1
0
0
(5.5)
2
is bounded in LF (0, 1; R). For this, let us first simplify (5.5). On the one hand, by Fubini’s theorem,


 Z r
Z r
Z s
p
1
α(r̄)dr̄ · vε (r) dr
· exp −
2α(r̄)dW (r̄) + 2
ε+1−r
0
0
Z s
Z 1 0
1
=−
f (r̄)dr̄dr
2
0 (ε + 1 − r)
r
Z r̄
Z s
Z s
Z 1
1
1
f (r̄)
f (r̄)
=−
drdr̄ −
drdr̄
2
2
0 (ε + 1 − r)
0 (ε + 1 − r)
Z0 s
Z 1s
Z 1
1
1
1
=−
· f (r̄)dr̄ +
f (r̄)dr̄ −
f (r̄)dr̄.
ε+1 0
ε+1−r s
0 ε+1−r
Similarly, on the other hand,
 Z r


Z s
Z s
Z r
p
1
1
2α(r̄)dW (r̄) + 2
· exp −
f (r)dr.
α(r̄)dr̄ · bε (r, α(r)) dr =
ε+1−r
0
0
0 ε+1−r
0
Consequently, we get

Z s


Z 1
Z s
p
1
x
+
f (r)dr · exp
α(r)dr
2α(r)dW (r) − 2
uε (s) = −
ε+1 ε+1 0
0
0
Z s

Z s
p
x+2
2α(r)dW (r) − 2
=−
· exp
α(r)dr .
ε+1
0
0

(5.6)

A short calculation gives

E

Z

0

1

2

|uε (s)| ds =



x+2
ε+1

2

6 (x + 2)2 ,

∀ε > 0.

Therefore, {uε (·)}ε>0 is bounded in L2F (0, 1; R). Now, let ε → 0 in (5.6), we get an open-loop
optimal control:
Z s

Z s
p
∗
u (s) = −(x + 2) · exp
α(r)dr ,
s ∈ [0, 1].
2α(r)dW (r) − 2
0

0

From the above discussion, similar to the state process X(·) of (5.1), the open-loop optimal control
u∗ (·) also depends on the regime switching term α(·). That is to say, as the value of the switching
α(·) varies, the open-loop optimal control u∗ (·) will be changed too.
25

Finally, we let ε → 0 in (5.3) and (5.4) to get a weak closed-loop optimal strategy (Θ∗ (·, ·), v ∗ (·)):
1
,
s ∈ [0, 1),
Θ∗ (s, α(s)) = lim Θε (s, α(s)) = −
ε→0
1−s
Z
 Z 1
Z s
sp
1
∗
· exp
v (s) = lim vε (s) = −
2α(r)dW (r) − 2
α(r)dr ·
f (r)dr
ε→0
1−s
0
0
s
Z s

Z s
p
2
· exp
2α(r)dW (r) − 2
= −√
α(r)dr ,
s ∈ [0, 1).
1−s
0
0

We put out that neither Θ∗ (·, ·) and v ∗ (·) is square-integrable on [0, 1). Indeed, one has
E

Z

1

0

E

Z

0

1

|Θ∗ (s, α(s))|2 ds =
∗

2

|v (s)| ds = E
=E

Z

1

0

Z

0

6

1

Z

1

1
ds = ∞,
(1
−
s)2
0
 Z s

Z s
p
4
· exp 2
α(r)dr ds
2α(r)dW (r) − 4
1−s
0
0
4
ds = ∞.
1−s

Conclusions

In this paper, we mainly study the open-loop and weak closed-loop solvabilities for a class of
stochastic LQ optimal control problems of Markovian regime switching system. The main result is
that these two solvabilities are equivalent. First, using the perturbation approach, we provide an
alternative characterization of the open-loop solvability. Then we investigate the weak closed-loop
solvability of the LQ problem of Markovian regime switching system, and establish the equivalent
relationship between open-loop and weak closed-loop solvabilities. Finally, we present an example
to illustrate the procedure for finding weak closed-loop optimal strategies in the circumstance of
Markovian regime switching system.

Competing interests
Conflict of Interest: The authors declare that they have no conflict of interest.

Acknowledgements
The authors would like to thank the editors and the anonymous referees for many helpful comments
and valuable suggestions on this paper.

References
[1] Ait Rami, M., Moore, J.B., Zhou. X.Y.: Indefinite stochastic linear quadratic control and
generalized differential Riccati equation. SIAM J. Control Optim. 40, 1296–1311 (2001).
26

[2] Bensoussan, A.: Lectures on stochstic control, part I, in nonlinear filtering and stochastic
control. Lecture Notes in Mathematics, vol. 972. Springer, Berlin (1982).
[3] Chen, S.P., Li, X.J., Zhou, X.Y.: Stochastic linear quadratic regulators with indefinite control
weight costs. SIAM J. Control Optim. 36, 1685–1702 (1998).
[4] Chen, S.P., Yong, J.M.: Stochastic linear quadratic optimal control problems. Appl. Math.
Optim. 43, 21–45 (2001).
[5] Donnelly, C., Heunis, A.J.: Quadratic risk minimization in a regime-switching model with
portfolio constraints. SIAM J. Control Optim. 50, 2431–2461 (2012).
[6] Davis, M.H.A.: Linear estimation and stochastic control. Chapman and Hall, London (1977).
[7] Hu, Y., Liang, G.C., Tang, S.J.: Systems of infinite horizon and ergodic BSDE arising in regime
switching forward performance processes. arxiv.org/abs/1807.01816.
[8] Hu, Y.Z., Oksendal, B.: Partial information linear quadratic control for jump diffusions. SIAM
J. Control Optim. 47, 1744–1761 (2008).
[9] Ji, Y., Chizeck, H.J.: Controllability, stabilizability, and continuous-time Markovian jump
linear quadratic control. IEEE Trans. Automat. Control 35, 777–788 (1990).
[10] Ji, Y., Chizeck, H.J.: Jump linear quadratic Gaussian control in continuous time. IEEE Trans.
Automat. Control 37, 1884–1892 (1992).
[11] Kalman., R.E.: Contributions to the theory of optimal control. Bol. Soc., Mat. Mex. 5, 102–119
(1960).
[12] Li, N., Wu, Z., Yu, Z.Y.: Indefinite stochastic linear-quadratic optimal control problems with
random jumps and related stochastic Riccati equations. Science China-Mathematics 61, 563–
576 (2018).
[13] Li, Y.S., Zheng, H.: Weak necessary and suficient stochastic maximum principle for Markovian
regime-switching diffusion models. Appl. Math. Optim. 71, 39–77 (2015).
[14] Li, X., Zhou, X.Y., Ait Rami, M.: Indefinite stochastic linear quadratic control with Markovian
jumps in infinite time horizon. J. Global Optim. 27, 149–175 (2003).
[15] Li, X., Zhou, X.Y., Lim, A.E.B.: Dynamic mean-variance portfolio selection with no-shorting
constraints, SIAM J. Control Optim. 40, 1540–1555 (2002).
[16] Liu, Y.J., Yin, G., Zhou, X.Y.: Near-optimal controls of random-switching LQ problems with
indefinite control weight costs. Automatica 41, 1063–1070 (2005).
[17] Mei, H.W., Yong, J.M.: Equilibrium strategies for time-inconsistent stochastic switching systems. ESAIM: COCV. To appear (2019).
[18] Sun, J.R., Li, X., Yong, J.: Open-loop and closed-loop solvabilities for stochastic linear
quadratic optimal control problems. SIAM J. Control Optim. 54, 2274–2308 (2016).
[19] Sun, J.R., Wang, H.X.: Mean-Field Stochastic Linear-Quadratic Optimal Control Problems:
Weak Closed-Loop Solvability. Arxiv.org/abs/1907.01740.
[20] Sun, J.R., Yong, J.M.: Linear quadratic stochastic differential games: open-loop and closedloop saddle points. SIAM J. Control Optim. 52, 4082–4121 (2014).
[21] Wang, H.X., Sun, J.R., Yong, J.M.: Weak Closed-Loop Solvability of Stochastic LinearQuadratic Optimal Control Problems. Disc. Conti. Dyn. Sys.-A 39: 2785–2805 (2019).
27

[22] Wonham, W.M.: On a matrix Riccati equation of stochastic control. SIAM J. Control Optim.
6, 681–697 (1968).
[23] Wu., Z., Wang, X.R.: FBSDE with Poisson process and its application to linear quadratic
stochastic optimal control problem with random jumps. Acta Automatica Sinica 29, 821–826
(2003).
[24] Yin, G., Zhou, X.Y.: Markowitz’s mean-variance portfolio selection with regime switching:
From discrete-time models to their continuous-time limits. IEEE Trans. Automat. Control 49,
349–360 (2004).
[25] Yong, J.M., Zhou, X.Y.: Stochastic Controls: Hamiltonian Systems and HJB Equations.
Springer-Verlag, New York (1999).
[26] Yu, Z.Y.: Infinite horizon jump-diffusion forward-backward stochastic differential equations
and their application to backward linear-quadratic problems. ESAIM: COCV. 23, 1331–1359
(2017).
[27] Zhang, Q., Yin, G.: On nearly optimal controls of hybrid LQG problems. IEEE Trans. Automat. Control 44, 2271–2282 (1999).
[28] Zhang, X., Elliott, R.J., Siu, T.K.: A stochastic maximum principle for a Markov regimeswitching jump-diffusion model and its application to finance. SIAM J. Control Optim. 50,
964–990 (2012).
[29] Zhang, X., Li, X., Xiong, J.: Open-loop and closed-loop solvabilities for stochastic linear quadratic optimal control problems of Markov Regime-Switching System.
arxiv.org/abs/1809.01891.
[30] Zhang, X., Siu, T.K., Meng, Q.B.: Portfolio selection in the enlarged Markovian regimeswitching market. SIAM J. Control Optim. 48, 3368–3388 (2010).
[31] Zhang, X., Sun, Z.Y., Xiong, J.: A general stochastic maximum principle for a Markov regime
switching jump-diffusion model of mean-field type. SIAM J. Control Optim. 56, 2563–2592
(2018).
[32] Zhou, X.Y., Li, D.: Continuous-time mean-variance portfolio selection: A stochastic LQ framework, Appl. Math. Optim. 42, 19–33 (2000).
[33] Zhou, X.Y., Yin, G.: Markowitz’s mean-variance portfolio selection with regime switching: A
continuous-time model. SIAM J. Control Optim. 42, 1466–1482 (2003).

28

