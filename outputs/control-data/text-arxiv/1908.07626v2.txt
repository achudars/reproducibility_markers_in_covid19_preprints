Optimal Investment with Correlated Stochastic Volatility Factors
Maxim Bichuch

∗

Jean-Pierre Fouque

†

arXiv:1908.07626v2 [q-fin.MF] 4 Jun 2020

Monday 8th June, 2020

Abstract
The problem of portfolio allocation in the context of stocks evolving in random environments, that is
with volatility and returns depending on random factors, has attracted a lot of attention. The problem
of maximizing a power utility at a terminal time with only one random factor can be linearized thanks to
a classical distortion transformation. In the present paper, we address the problem with several factors
using a perturbation technique around the case where these factors are perfectly correlated reducing the
problem to the case with a single factor. We illustrate our result with a particular model for which we
have explicit formulas. A rigorous accuracy result is also derived using a verification result for the HJB
equation involved. In order to keep the notations as explicit as possible, we treat the case with one stock
and two factors and we describe an extension to the case with two stocks and two factors.

AMS subject classification 91G80, 60H30.
JEL subject classification G11.
Keywords Optimal investment, asymptotic analysis, utility maximization, stochastic volatility.

1

Introduction

The portfolio optimization problem was first introduced and studied in the continuous-time framework in
[16, 17], which provided explicit solutions on how to trade stocks and/or how to consume so as to maximize
one’s utility, with risky assets following the Black-Scholes-Merton model (that is, geometric Brownian motions
with constant returns and constant volatilities), and when the utility function is of specific types (for instance,
Constant Relative Risk Aversion (CRRA)).
Stochastic volatility models have been widely studied over the last thirty years in the context of option
pricing and the presence of several factors driving volatility has been well documented (see for instance [9],
[12] and references therein). In general settings, the models are intractable and often asymptotic solutions
are sought, see e.g. [19], [10], [11], [5].
In a general setting, [15] showed existence and uniqueness of an optimal strategy using the duality
approach. As an alternative approach, in a Markovian setting, the portfolio optimization problem with factors
driving returns and volatility can be solved directly be describing it as a solution to an HJB equation with
terminal condition given by the utility function. Example of the latter approach in a portfolio optimization
problem with multiscale factor models for risky assets include [13], where return and volatility are driven
by fast and slow factors. Specifically, the authors heuristically derived the asymptotic approximation to the
value function and the optimal strategy for general utility functions. This analysis is complemented in [6]
and in [7] in a non-Markovian context. The multiscale feature is essential to be able to consider multiple
factors, because each factor requires a unique time scale. The analysis simplifies considerably in the case of
∗ Department of Applied Mathematics & Statistics, Johns Hopkins University, Baltimore, MD 21218, USA mbichuch@jhu.edu.
Work is partially supported by NSF grant DMS-1736414. Research is partially supported by the Acheson J. Duncan Fund for
the Advancement of Research in Statistics.
† Department of Statistics and Applied Probability, South Hall 5504, University of California Santa Barbara, CA 93106
fouque@pstat.ucsb.edu. Work supported by NSF grant DMS-1814091.

1

a single factor and power utilities thanks to a distortion transformation which linearizes the problem (see
[20], [13], [7]).
Our aim in this paper is to solve a problem with multiple factors of the same time scale. We do so by
considering the case with multi factors and power utility as a perturbation problem around the case where
the factors are perfectly correlated which in turns allows for an explicit solution given by a linear problem.
Additionally, we find a “nearly-optimal” strategy, among all admissible strategies, without limiting them to
strategies that asymptotically a-priori converge to the zeroth order strategy. The “nearly-optimal” strategy,
if followed, produces an expected utility of the terminal wealth matching the value function at both zeroth
and first order asymptotic expansion.
The main idea of this paper is to first calculate a heuristic asymptotic expansion in the correlation
parameter. Then, based on this expansion, we derive a verification result for the HJB equation, which in
turn, allows us to bound the value function from above and below similar to the method used e.g. in [2] and
[3]. This procedure also produces a “nearly-optimal” strategy, and shows that the expected utility of the
terminal wealth associated with this strategy is also within the same bounds as the value function.
The rest of the paper is structured in the following way. In Section 2, we study in details the case of
investments in one stock and a risk-free account where the returns and volatility of the stock are driven
by two factors. Our asymtotics around the case of perfect correlation between these two factors reveals a
simple correction to the value function, which takes into account an imperfect correlation as well as a simple
strategy which generates the corrected value function.
In Section 3, we extend the model studied in [4] which admits explicit formulas and enables us to illustrate
the accuracy of our approximation. A proof of this accuracy is given in Section 4.
Finally, to demonstrate that our approach generalizes to the case with multi assets, we consider in Section
5.1 two assets driven by two factors nearly fully correlated. We also extend the model of [4] in that case and
we discuss the difference with the models considered in [1].

2

Models with one Stock and two Factors

We consider a model with a stock price driven by two correlated stochastic volatility factors:
dS(t)
= µ(Z1 (t), Z2 (t))dt + σ(Z1 (t), Z2 (t)) dW (t),
S(t)
dZi (t) = αi (Zi (t)) dt + βi (Zi (t)) dBi (t) i = 1, 2.

(1)
(2)

The three Brownian motions B1 , B2 , and W are defined on a filtered probability space (Ω, F, (Ft )t≥0 , P). We
assume that the two Brownian motions B1 , B2 are correlated according to d hB1 , B2 it = ρ12 dt, and that they
are correlated to the Brownian motion W according to d hW, Bi it = ρi dt, i = 1, 2, with constant coefficients
ρ12 , ρ1 , ρ2 such that |ρ12 | ≤ 1, |ρ1 | < 1, |ρ2 | < 1 and
1 + 2ρ1 ρ2 ρ12 − ρ21 − ρ22 − ρ212 ≥ 0.

(3)

Throughout the paper, we work under standing classical hypotheses on the coefficients of the system (1)-(2)
ensuring existence and uniqueness of a strong solution.
We assume also that the market contains a bond, that carries zero interest rate for convenience. Let πt
be the number of shares of stock held at time t. Thus, the evolution of the wealth process Xt following the
self-financing strategy πt is given by:
dX(t) = πt

dS(t)
= πt µ(Z1 (t), Z2 (t))dt + πt σ(Z1 (t), Z2 (t)) dW (t),
S(t)

(4)

and the value function of the optimal investment problem with terminal time T and utility U is the following:
v(t, x, z1 , z2 ) = sup Et,x,z1 ,z2 [U(XT )] ,

(5)

π

where Et,x,z1 ,z2 [·] denotes the conditional expectation E[·|X(t) = x, Z1 (t) = z1 , Z2 (t) = z2 ], and the supremum is taken over all admissible Markovian strategies πs = π(s, X(s), Z1 (s), Z2 (s)) such that X(s) stays
2

nonnegative for all t ≤ s ≤ T given X(t) = x, Z1 (t) = z1 , Z2 (t) = z2 , and satisfy the integrability condition
(Z
)
T

πt2 σ 2 (Z1 (t), Z2 (t))dt

E

< ∞.

(6)

0

In this paper we consider the case with utility functions U being of power type:
U(x) =

xp
,
p

p 6= 0.

p < 1,

Define the differential operators
1 ,ρ2
Lπ,ρ
x,z1 ,z2 = πµ(z1 , z2 )

Lρz112,z2 =

2
X

2
X
∂
1
∂2
∂2
+ π 2 σ 2 (z1 , z2 ) 2 + πσ(z1 , z2 )
ρi βi (zi )
,
∂x 2
∂x
∂x∂zi
i=1
2

αi (zi )

i=1

∂2
∂
1X 2
∂2
+
βi (zi ) 2 + ρ12 β1 (z1 )β2 (z2 )
.
∂zi
2 i=1
∂zi
∂z1 ∂z2

(7)

The value function v satisfies:
1 ,ρ2
∂t v + Lρz112,z2 v + sup Lπ,ρ
x,z1 ,z2 v = 0,

(8)

π

v(T, x, z1 , z2 ) = U(x).
Maximization over π gives:
π∗ = −

1
µ(z1 , z2 ) vx
−
2
σ (z1 , z2 ) vxx
σ(z1 , z2 )

P2

i=1

ρi βi (zi )vxi
,
vxx

(9)

where vi denotes a derivative with respect to zi , i = 1, 2. Substituting (9) into (8), it follows that

∂t v + Lρz112,z2 v −

λ(z1 , z2 )vx +

P2

i=1 ρi βi (zi )vxi

2vxx

2
= 0.

(10)

µ(z1 ,z2 )
.
where the Sharpe ratio λ is defined by λ(z1 , z2 ) = σ(z
1 ,z2 )
We proceed in the next section to solve the problem when the two factors are perfectly correlated. It
turns out that this solution follows [6]. We then compute the first order perturbation adjustment, around the
perfectly correlated case. In Section 4, using these zero and first order perturbations, we construct sub- and
super-solutions to the original PDE (10), and rigorously show the error of the constructed approximation.

2.1

Fully Correlated Factors

Our goal is to find the value function v and the optimal strategy to achieve the maximum expected utility
of the terminal wealth. We start by recalling the result from [13] as applied to our case. More specifically,
in the case of fully correlated factors Z1 , Z2 we are able to easily adapt the computations there as follows.
Let us temporarily assume that ρ12 = 1, then, condition (3) forces us to also assume that ρ1 = ρ2 = ρ, with
|ρ| < 1. We consider the “distortion transformation” used in [20] and [13]:
v(t, x, z1 , z2 ) =

q
xp  (0)
Ψ (t, z1 , z2 ) ,
p

where the superscript (0) indicates that this function will be the zeroth order in the asymptotics presented
in the following section. Denoting
Γ=

p
,
1−p

so that

Γ > −1

and

3

Γ 6= 0,

since

p < 1, p 6= 0,

the function Ψ(0) satisfies
2
X
Γ 2
(0)
λ (z1 , z2 )Ψ(0) + Γρλ(z1 , z2 )
βi (zi )Ψi
2q
i=1
P
2
(0)
2

i=1 βi (zi )Ψi
1
(q − 1) + qρ2 Γ
= 0.
+
2
Ψ(0)

∂t Ψ(0) + L1z1 ,z2 Ψ(0) +

Choosing
q=

1
,
1 + Γρ2

so that

1
,
1 − ρ2

0<q<

and q = 1

if ρ = 0,

(11)

the equation for Ψ(0) becomes linear:
Γ 2
λ (z1 , z2 )Ψ(0) = 0,
2q

(0)
∂t Ψ(0) + L1,ρ
+
z1 ,z2 Ψ

(12)

Ψ(0) (T, z1 , z2 ) = 1,
where
1
L1,ρ
z1 ,z2 φ = Lz1 ,z2 φ + Γρλ(z1 , z2 )

2
X

βi (zi )φi ,

(13)

i=1

and L1z1 ,z2 is given by (7) with ρ12 = 1. Note that in this case, we may assume that B1 (t) = B2 (t) = B(t),
and we get a Feynman–Kac type formula:
i
h Γ RT 2
(14)
Ψ(0) (t, z1 , z2 ) = Ẽt,z1 ,z2 e 2q t λ (Z1 (s),Z2 (s))ds ,
where P̃ is defined so that B̃(t) = B(t) − Γρ

2.2

Rt
0

λ(Z1 (s), Z2 (s))ds is a standard Brownian motion under it.

Asymptotics Around the Fully Correlated Case

We now go back to the general correlation structure (3). Our goal is to expand around the fully correlated
case when ρ12 = 1, and ρ1 = ρ2 , presented in the previous section. Accordingly, we now assume that
ρ1 , ρ2 , ρ12 have the following form:
(1)

(1)

ρi = ρ + ρi ε, i = 1, 2 and ρ12 = 1 + ρ12 ε,

(15)

(1)

where ρ12 < 0 and ε is a small parameter, 0 < ε  1, small enough to ensure a proper covariance structure
satisfying (3).
Consider the ansatz
q
xp  (0)
Ψ (t, z1 , z2 ) + εΨ(1) (t, z1 , z2 ) + O(ε2 ) ,
(16)
v(t, x, z1 , z2 ) =
p
where the exponent q is given by (11): q =

1
1+Γρ2

=

1−p
1−p(1−ρ2 ) .

Plugging this ansatz in the HJB equation

(10) and canceling terms of zero order in ε gives that the function Ψ(0) satisfies (12) and, therefore, is given
by (14). Cancelling the terms of order one in ε, we deduce that the function Ψ(1) must satisfy:
(1)
∂t Ψ(1) + L1,ρ
+
z1 ,z2 Ψ

Γ 2 (1)
λ Ψ + f1 (Ψ(0) , ∇Ψ(0) , H(Ψ(0) )) = 0,
2q

Ψ(1) (T, z1 , z2 ) = 0,

4

(17)

where the operator L1,ρ
z1 ,z2 is given by (13), and
(0)

f1 (Ψ

(0)

, ∇Ψ

(0)

, H(Ψ

qΓρ
)) = (0)
Ψ
+ Γλ

(0) (0) (1)
β1 β2 Ψ1 Ψ2 (ρ1

−

(1)
ρρ12

+

(1)
ρ2 )

+

2
X

!
(1)
(0)
βi2 ρi (Ψi )2

i=1
2
X

(1)

(0)

ρ i β i Ψi

(1)

(0)

+ ρ12 β1 β2 Ψ12 .

i=1

The probabilistic representation of Ψ(1) is given by the Feynman–Kac type formula:
"Z
T

Ψ

(1)

e

(t, z1 , z2 ) = Ẽt,z1 ,z2

Rs

Γ
2q

t

λ2 (Z1 (τ ),Z2 (τ ))dτ

(0)

f1 (Ψ

, ∇Ψ

(0)

, H(Ψ

(0)

#

))(Z1 (s), Z2 (s))ds ,

(18)

t

under the same probability measure P̃ as in (14).
We now consider a zeroth order approximation to π ∗ given in (9), by substituting the zeroth order
p
q
approximation for v from (16), namely, v(t, x, z1 , z2 ) ≈ xp Ψ(0) (t, z1 , z2 ) , and by using ρ12 = 1, ρ1 = ρ2 =
ρ, the zeroth order approximation from (15). We obtain
!
P2
(0)
x
0
i=1 βi Ψi
.
(19)
λ + ρq
π =
(1 − p)σ
Ψ(0)
0

Note that X (π ) > 0, and therefore once we show the appropriate integrability conditions in Corollary 2, it
will follows that π 0 is an admissible strategy.
Next, we consider the value
h
i
0
(π 0 )
v (π ) (t, x, z1 , z2 ) = Et,x,z1 ,z2 U(XT ) ,
obtained by following the strategy π 0 in (4). It satisfies the linear equation:
∂t v (π
v

(π 0 )

0

)

+ Lρz112,z2 v (π

0

)

0

π ,ρ1 ,ρ2 (π
+ Lx,z
v
1 ,z2

0

)

= 0,

(T, x, z1 , z2 ) = U(x).

A classical regular expansion argument for linear PDEs (as in [13][Section 6.3.2] for instance) shows that
with U(x) = xp /p,
0

v (π ) (t, x, z1 , z2 ) =

q
xp  (0)
Ψ (t, z1 , z2 ) + εΨ(1) (t, z1 , z2 ) + O(ε2 ) ,
p

where the function Ψ(0) and Ψ(1) are exactly those obtained in the previous section in (12) and (17) respec0
tively. Up to the first order in ε, v (π ) is identical to v expended heuristically in (16). Once we will have
proved in Section 4 that the expansion (16) for v is accurate, we will be able to conclude that the strategy
π 0 given by (19) generates up to order ε the value v given by (5) or (8).

3

An Example with Explicit Formula

We consider the following model inspired by the one presented in Chacko and Viceira [4]. We make the
following specific choice of a model (1)-(2):
σ̄
,
σ(z1 , z2 ) = √
z1 + z2
√
βi (zi ) = β̄ 2zi , i = 1, 2,

µ(z1 , z2 ) = µ̄,
αi (zi ) = m − zi ,

where we assume that m ≥ 1 so that the two square-root processes Z1 and Z2 stay positive. We will
consider these processes starting at a point (z, z) with z > 0. Note that in the fully correlated case ρ12 = 1,
5

we have Z1 (t) = Z2 (t) for all time t which will enable explicit formulas for Ψ(0) (t, z, z) := Ψ̃(0) (t, z) and
Ψ(1) (t, z, z) := Ψ̃(1) (t, z). However, in the general non-fully correlated case, the process (Z1 , Z2 ) will not stay
on the diagonal and an explicit formula for the value function will not be available making our approximation
pratical.
From (14), Ψ(0) becomes
i
h Γ RT 2
i
h Γ RT 2
Ψ(0) (t, z, z) = Ẽt,z,z e 2q t λ (Z1 (s),Z2 (s))ds = Ẽt,z e 2q t λ (Z1 (s),Z1 (s))ds = Ψ̃(0) (t, z),
√
√
with λ(z, z) = σ̄µ̄ 2z = λ̄ 2z. Note, that the original function Ψ(0) (t, z1 , z2 ) is hard to compute, as opposed
to Ψ̃(0) (t, z) which can be easily computed. Indeed, Ψ̃(0) (t, z) solves:
(0)

2
(0)
(0)
Ψ̃t + (m − z)Ψ̃(0)
z + β̄ z Ψ̃zz + 2Γρλ̄β̄ z Ψ̃z +

Γλ̄2 (0)
z Ψ̃ = 0,
q

(20)

Ψ̃(0) (T, z) = 1.
Using the ansatz Ψ̃(0) (t, z) = eA(t)z+B(t) , we get the system of ODEs:



Γλ̄2
0
2 2
, A(T ) = 0,
A = − β̄ A + 2Γλ̄ρβ̄ − 1 A +
q

(21)

B 0 = −mA, B(T ) = 0.
Assuming the right hand side of (21) has two distinct solutions,


s
2
2

4Γλ̄ β̄ 
1 
2
a± =
1 − 2Γλ̄ρβ̄ ±
,
1 − 2Γλ̄ρβ̄ −
q
2β̄ 2
which, in particular is the case when p < 0, we get that
2

A(t) = a+ a−

1 − eβ̄ (T −t)(a+ −a− )
,
a− − a+ eβ̄ 2 (T −t)(a+ −a− )

B(t) = −m

1
log
β̄ 2

2

a− − a+ eβ̄ (a+ −a− )(T −t)
a− − a+

!

!
− a+ (T − t) .

(0)

(0)

Thus, since Z1 (s) = Z2 (s) a.s. for s ∈ [t, T ], it follows that Ψ1 (t, z, z) = Ψ2 (t, z, z). Separately, note
(0)
(0)
(0)
(0)
(0)
that Ψ1 (t, z, z) + Ψ2 (t, z, z) = Ψ̃z (t, z). Together it therefore follows that Ψ1 (t, z, z) = Ψ2 (t, z, z) =
(0)
(0)
(0)
1 (0)
1 (0)
2 Ψ̃z (t, z). Similar calculation shows also that Ψ11 (t, z, z) = Ψ12 (t, z, z) = Ψ22 (t, z, z) = 4 Ψ̃zz (t, z).
We conclude from (19) that when z1 = z2 = z we also have that
π0 =


2xz
λ̄ + ρq β̄A(t) .
(1 − p)σ̄

From (18), Ψ(1) becomes
Ψ

(1)

"Z

#

T

(t, z, z) = Ẽt,z,z

e

Γ
2q

Rs
t

λ2 (Z1 (τ ),Z2 (τ ))dτ

(0)

f1 (Ψ

, ∇Ψ

(0)

(0)

, H(Ψ

))(Z1 (s), Z2 (s))ds

t

"Z
= Ẽt,z

#

T

e

Γ
2q

Rs
t

λ2 (Z1 (τ ),Z1 (τ ))dτ

f˜1 (s)Z1 (s)Ψ̃

(0)

(Z1 (s))ds = Ψ̃(1) (t, z),

t

where


(1)
(1)
(1)
(1)
(1)
(1)
f¯1 (t) = 2qΓρβ̄ 2 A2 (t) 2ρ1 − ρρ12 + 2ρ2 + 2Γλ̄β̄A(t)(ρ1 + ρ2 ) + 2ρ12 β̄ 2 A2 (t).

6

It is again difficult to compute Ψ(1) (t, z1 , z2 ), however finding Ψ̃(1) (t, z) is easier. Indeed, Ψ̃(1) (t, z) satisfies
the following linear PDE:
(1)

2
(1)
(1)
Ψ̃t + (m − z)Ψ̃(1)
z + β̄ z Ψ̃zz + 2Γρλ̄β̄ z Ψ̃z +

Γλ̄2 (1) ¯
z Ψ̃ + f1 (t)zΨ(0) (t, z) = 0,
q

Ψ̃(1) (T, z) = 0.
We look for a solution of the form
Ψ̃(1) = (zA1 (t) + B1 (t)) Ψ̃(0) .
In this case, A1 and B1 must satisfy the ODEs:

A01 (t) + 2A(t)β̄ 2 − 1 + 2Γρλ̄β̄ A1 + f¯1 (t) = 0,
B10 (t)

+ mA1 (t) = 0,

A1 (T ) = 0,

B1 (T ) = 0.

It then follows that
Z
A1 (t) =

T

e

Rs
t

(2A(u)β̄ 2 −1+2Γρλ̄β̄)du

f¯1 (s)ds,

Z

t

3.1

T

B1 (t) = m

A1 (s)ds.
t

Numerical Illustration

We illustrate our finding numerically, in the example of the extended Chacko and Viceira [4] model from
Section 3. We use the parameters:
µ̄ = 0.05, m1 = m2 = 26, σ̄ = 0.2, λ̄ =

0.05
ε
µ̄
=
, ρ12 = 1 − ε, ρ1 = 0.5, ρ2 = 0.5 − ,
σ̄
0.2
2

β̄ = 5, p = −1, T = 1.
The graphs are all drawn as functions of (0, z, z), z ≥ 0 at the point t = 0. In this case it is easily seen
that the Feller condition for the diffusions Z1 , Z2 is satisfied, which guarantees that Z1 (t), Z2 (t) > 0. Figure
1 illustrates the numerical solution of Ψ, together
with the approximations Ψ(0) , and Ψ(0) + εΨ(1) (left);

(0)
(0)
(1)
and the errors Ψ − Ψ , Ψ − Ψ + εΨ
(right), for ε = 0.1. Figure 2 illustrates these for ε = 0.05. As
expected, these errors are of order O(ε) and O(ε2 ) respectively.
0.8
20

40

60

80

100

-0.02

0.6

-0.04
0.4

-0.06
-0.08
20

40

60

80

100

-0.10

Figure 1: Left: graph of the numerical solution of Ψ (blue), zero order and first order approximations
Ψ(0)

(0)
(1)
(0)
(0)
(1)
(orange), Ψ + εΨ (green). Right: graph of the errors Ψ − Ψ (blue), Ψ − Ψ + εΨ
(orange).
Both graphs are done as a function of (0, z, z), for 0 ≤ z ≤ 100, with parameter ε = 0.1.

7

0.8
20

0.7

40

60

80

100

-0.01
0.6
0.5

-0.02

0.4

-0.03

0.3

-0.04

0.2
-0.05
20

40

60

80

100

Figure 2: Left: graph of the numerical solution of Ψ (blue), zero order and first order approximations
Ψ(0)

(0)
(1)
(0)
(0)
(1)
(orange), Ψ + εΨ (green). Right: graph of the errors Ψ − Ψ (blue), Ψ − Ψ + εΨ
(orange).
Both graphs are done as a function of (0, z, z), for 0 ≤ z ≤ 100, with parameter ε = 0.05.

4

Proof of Accuracy

We now go back to the general case as in Section 2. The goal is to make rigorous the previous heuristic
results. In other words, we prove that the expansion in (16) is correct. Moreover, as explained at the end of
Section 2.2, we justify that the zeroth order strategy π 0 from (19) indeed, achieves the maximum value up
to order ε.
We again consider the HJB equation (10) for the value function v, and we perform the substitution
v(t, x, z1 , z2 ) =

xp
q
(Ψ(t, z1 , z2 )) .
p

(22)

Then, Ψ must satisfy:
∂t Ψ + Lρz112,z2 Ψ +
1
+
2Ψ

2
X

2
X
Γ 2
ρi βi (zi )Ψi
λ (z1 , z2 )Ψ + Γλ(z1 , z2 )
2q
i=1

!
(q − 1) +

qρ2i Γ



βi2 (zi )Ψ2i

+ β1 (z1 )β2 (z2 )(ρ12 (q − 1) + qρ1 ρ2 Γ) Ψ1 Ψ2

= 0,

i=1

Ψ(T, z1 , z2 ) = 1.
Note that we still assume that q is given by (11), but, however, the equation for Ψ remains fully nonlinear.
The distortion transformation (22) will be key to build sub- and super-solutions for (10), but first, we need
some smoothness properties for the functions Ψ(0) and Ψ(1) .

4.1

Smoothness of Ψ(0) and Ψ(1)

We have the following:
Lemma 1. Assume that λ, αi , βi , i = 1, 2 are bounded, twice differentiable with bounded derivatives, and
that σ, βi , i = 1, 2 are bounded away from zero. Then, Ψ(0) and Ψ(1) , the solutions of (12) and (17)
respectively, exist and they are unique and bounded. Moreover, their derivatives up to order two are bounded.
Additionally, Ψ(0) and Ψ(1) are also given by their Feynman–Kac representations (14) and (18) respectively.
Proof. We show the proof for Ψ(0) , whereas the proof for Ψ(1) is similar.
First, note that under our coefficient assumptions, the operator L1,ρ
z1 ,z2 appearing in (13) is (degenerate)
(0)
elliptic. Then, existence and uniqueness of the classical solution Ψ of (12) follows from [18][Theorem 6].
Therefore, it is easily seen that all the assumptions of Feynman–Kac formula in [14][Theorem 5.7.6] hold.
Thus, from (14), it follows that Ψ(0) is bounded.
8

(0)

Since Ψ(0) is a classical solution to (12), it is differentiable, and we can consider Ψi , its derivative with
respect to zi , i = 1, 2. By differentiating (12), we obtain the system of PDEs:
(0)

∂t Ψi

+

Γ 2
(0)
(0)
λ (z1 , z2 )Ψi + L1,ρ
z1 ,z2 Ψi
2q

 (0)
+ αi0 (zi ) + βi (zi )βi0 (zi )∂zi + βi0 (zi )βj (zj )∂zj + Γρ (λi (z1 , z2 )βi (zi ) + λ(z1 , z2 )βi0 (zi )) Ψi
Γ
(0)
= − λ(z1 , z2 )λi (z1 , z2 )Ψ(0) − Γρλi (z1 , z2 )βj (zj )Ψj ,
q

(23)

(0)

Ψi (T, z1 , z2 ) = 0, i, j = 1, 2 i 6= j.
Note that λi here, as per our convention, denotes the partial derivative of λ with respect to zi , i = 1, 2.
(0)
(0)
Denoting by DΨ(0) the vector (Ψ1 , Ψ2 )T and by Dλ the vector(λ1 , λ2 )T , the system of equations (23) can
be rewritten:
(0)
∂t DΨ(0) + L1,ρ
+ V (z1 , z2 )DΨ(0) +
z1 ,z2 I2×2 DΨ

Γ
λ(z1 , z2 )Ψ(0) Dλ = 0,
q

DΨ(0) (T, z1 , z2 ) = 0,

where I2×2 is the 2 × 2 identity matrix, V is a 2 × 2 potential matrix, and the last term being a source term.
Therefore, the assumptions of [14][Theorem 5.7.6] again hold, and DΨ(0) is given by the Feynman-Kac
formula,
#
"Z


T R
s
Γ (0)
(0)
V (Z1 (u),Z2 (u))du
t
DΨ (t, z1 , z2 ) = Ẽt,z1 ,z2
λΨ Dλ (Z1 (s), Z2 (s))ds .
e
q
t
(0)

(0)

Under our coefficient assumptions, this shows that Ψ1 and Ψ2 are bounded. Differentiating the system
(0)
(0)
(0)
(23) with respect to zi , i = 1, 2, one obtains equations for the second order derivatives Ψ11 , Ψ12 , Ψ22 and
their boundedness is derived by using again a Feynman–Kac representation and our coefficient assumptions.
Here, we omit these straightforward lengthy details as well as the calculation details for Ψ(1) given by (17)
and its derivatives. Finally, we similarly conclude that the Feynman–Kac representation (18) of Ψ(1) holds.
Corollary 2. Under the assumptions of Lemma 1, the strategy π 0 given in (19) is admissible.
0

Proof. As noted previously, the process X (π ) is a generalized geometric Brownian Motion, and thus is
(0)
positive. Moreover, under our assumptions from
 (14) , we havethat Ψ is also bounded away from zero.
From Lemma 1, it follows that so is

1
(1−p)σ

λ + ρq

P2

(0)
βi Ψi
(0)
Ψ

i=1

. Therefore, π 0 satisfies the admissibility

constraint (6).

4.2

Building Sub- and Super-Solutions

The goal is now to obtain bounds for the value function v, solution to the HJB equation (10), and to justify
the approximation (16). Consider Ψ(0) and Ψ(1) given as solutions to (12) and (17) respectively and under
the assumptions of Lemma 1. Using those and the distortion transformation (22), define
v ± (t, x, z1 , z2 ) =

q
xp  (0)
Ψ (t, z1 , z2 ) + εΨ(1) (t, z1 , z2 ) ± ε2 M (T − t) ,
p

(24)

where M > 0 is a constant to be determined later independently of ε, and where q is given by (11). Here,
we assume 0 < p < 1 to start with and the case p < 0 will be treated in Section 4.2.5.
Observe that from the boundary conditions of Ψ(0) and Ψ(1) , we have v ± (T, x, z1 , z2 ) = U(x). Note also
that from the Feynman–Kac formula (14), the function Ψ(0) is bounded, positive, and bounded away from
zero. On the other hand, the function Ψ(1) is bounded, and, therefore, for ε small enough, Ψ(0) (t, z1 , z2 ) +
εΨ(1) (t, z1 , z2 ) ± ε2 M (T − t) > 0, and consequently, v ± is well defined and nonnegative for 0 < p < 1.

9

4.2.1

Strategy of the proof of accuracy

From (8), we define the operator Qπ
π,ρ1 ,ρ2
Qπ = ∂t + Lρz112,z2 + Lx,z
,
1 ,z2
(1)

(1)

where ρ12 = 1 + ρ12 ε, ρi = ρ + ρi ε. We will show that there exists M such that for ε small enough we
have
0

Qπ [v − ] ≥ 0, and

sup Qπ [v + ] ≤ 0,

(25)

π

where the strategy π 0 is given by (19) and the strategy π is any admissible strategy. By Itô’s formula and a
justification of the martingale property which will be given later, we then conclude that
h
i
h
i
0
0
v(t, x, z1 , z2 ) ≥ Et,x,z1 ,z2 U(X (π ) (T )) = Et,x,z1 ,z2 v − (T, X (π ) (T ), Z1 (T ), Z2 (T ))
"Z
#
T
0
0
Qπ [v − ](s, X (π ) (s), Z1 (s), Z2 (s))ds
= v − (t, x, z1 , z2 ) + Et,x,z1 ,z2
t
−

≥ v (t, x, z1 , z2 ),

(26)

h
i
h
i
Et,x,z1 ,z2 U(X (π) (T )) = Et,x,z1 ,z2 v + (T, X (π) (T ), Z1 (T ), Z2 (T ))
"Z
#
T
+
π +
(π)
= v (t, x, z1 , z2 ) + Et,x,z1 ,z2
Q [v ](s, X (s), Z1 (s), Z2 (s))ds
t

≤ v + (t, x, z1 , z2 ) + Et,x,z1 ,z2

"Z
t

#

T

sup Qπ [v + ](s, X (π) (s), Z1 (s), Z2 (s))ds
π

+

≤ v (t, x, z1 , z2 ),

(27)

and, by taking a supremum over π:
h
i
v(t, x, z1 , z2 ) = sup Et,x,z1 ,z2 U(X (π) (T )) ≤ v + (t, x, z1 , z2 ).

(28)

π

In other words, v − is a submartingale along π 0 and v + is a supermartingale along any admissible π. In
turns, (26) and (28) show that v − is a sub-solution and v + is a super-solution. Using again the definition
(22) of v ± , we deduce that our proposed approximation is accurate at the order ε:
v−

q
xp  (0)
= xp O(ε2 ),
Ψ + εΨ(1)
p

(29)

uniformly in (t, z1 , z2 ). This is formalized in the following:
Theorem 3. In addition to the coefficient assumptions in Lemma 1, we assume that λ is bounded and
bounded away from zero, and 0 < p < 1. Then, there exits a constant M > 0 such that, for ε small enough,
the functions v ± defined in (24) are sub- and super-solutions, and the accuracy of approximation (29) holds.
Moreover, the strategy π 0 given by (19), is “nearly-optimal”, in other words, if followed, then the expected
utility of the terminal wealth will differ from the value function by O(ε2 ), i.e.
 
p 
1
(π 0 )
0 ≤ v(t, x, z1 , z2 ) − Et,x,z1 ,z2
XT
= xp O(ε2 ),
(30)
p
uniformly in (t, z1 , z2 ).
Proof. The proof follows the argument presented at the begining of Section 4.2.1 and will mainly consists
(1)
(1)
in deriving the key inequalities (25). Recall that ρ12 = 1 + ρ12 ε, ρi = ρ + ρi ε, and that the strategy π 0 is
given by (19).
10

4.2.2

0

Sub-solution, computation of Qπ [v − ]

By direct computation, we get:
 p

q−1  
0
x
Γ
(0)
Qπ [v − ] = q
Ψ(0) + εΨ(1)
∂t Ψ(0) + λ2 Ψ(0) + L1,ρ
Ψ
z1 ,z2
p
2q



 p
q−1
Γ 2 (1)
x
(1)
(0)
(0)
(0)
∂t Ψ(1) + L1,ρ
Ψ
+
Ψ(0) + εΨ(1)
λ
Ψ
−
f
(Ψ
,
∇Ψ
,
H(Ψ
))
+ εq
1
z1 ,z2
p
2q



 p


q−1
Γ
x
Φ
Ψ(0)
M 1 + λ2 (T − t) +
+ ε2 q
+ xp O(ε3 )+M xp O(ε3 ), (31)
p
2q
2(1 − p)(Ψ(0) )2
where the O(ε3 ) terms are independent of x, M and are uniform in (t, z1 , z2 ), and the quantity Φ is given by
" 2

X 
(1)
(0)
(1) (0) (1)
(1)
(0) 2
Φ = (Ψ )
βi2 qp(ρi )2 (Ψi )2 + 4qpρρi Ψi Ψi − (q − 1)(p − 1)(Ψi )2
i=1


2
X
(1)
(1)
(1) (0)
(1) (0)
+ 2β1 β2 [qpρ
ρi − (q − 1)(p − 1)ρ12 ](Ψ1 Ψ2 + Ψ2 Ψ1 )
i=1

− (q − 1)(p −
"
+ 2Ψ

(0)

Ψ

(1)

2
X

(1) (1)
1)Ψ1 Ψ2

+

(1) (1) (0) (0)
qpρ1 ρ2 Ψ1 Ψ2

#



(1)
(0)
(0) (1)
βi2 −qpρρi (Ψi )2 + (q − 1)(p − 1)Ψi Ψi

i=1

+ β1 β2

[−qpρ

2
X

!#
(1)
ρi

+ (q − 1)(p −

(1)
(0) (0)
1)ρ12 ]Ψ1 Ψ2

+ (q − 1)(p −

(0) (1)
1)(Ψ1 Ψ2

+

(0) (1)
Ψ 2 Ψ1 )

i=1

"
(0) 3

− 2(Ψ

)

β1 β2 (p −

(1) (1)
1)ρ12 Ψ12

#
2
X
(1) (1)
(βi ρi Ψi ) + (q − 1)(1 − p)(Ψ(1) )2
− λp
i=1

2
X

!2
(0)
β i Ψi

.

(32)

i=1

From the equations (12) and (17) satisfied by Ψ(0) and Ψ(1) respectively,
the terms ofiorder one and of
h
Γ 2
λ (T − t) > 0. Therefore,
order ε in (31) cancel. For 0 < p < 1, we have Γ > 0 and consequently 1 + 2q
from the boundedness of Φ, one can choose M > 0 independently of ε such that the term in ε2 in (31) is
positive. Finally, an explicit computation of both terms O(ε3 ) shows that it does not change that sign for ε
0
small enough. We omit here this lengthy but straightforward computation. The estimate (25) for Qπ [v − ]
follows.
Note that for deriving (26) from this estimate, one needs to check that the martingale parts are true
martingales. This can be seen by writing these quantities explicitly and using again the boundedness of the
derivatives of Ψ(0) and Ψ(1) and the admissibility of π 0 . We omit the details.
4.2.3

Super-solution, computation of supπ Qπ [v + ]

+
Using the fact that vxx
< 0, a similar calculation with any admissible strategy π reveals:

2 

P2
+
+
ρ
β
v
λv
+
i
i
x
i
i=1


Qπ [v + ] ≤ sup Qπ [v + ] = ∂t v + + Lρz112,z2 v + −

+
2vxx
π



q−1  
xp  (0)
Γ 2 (0)
(1)
(0)
1,ρ
(0)
=q
Ψ + εΨ
∂t Ψ + λ Ψ + Lz1 ,z2 Ψ
p
2q
 p



q−1
x
Γ 2 (1)
(0)
(1)
(1)
1,ρ
(1)
(0)
(0)
(0)
+ εq
Ψ + εΨ
∂t Ψ + Lz1 ,z2 Ψ + λ Ψ − f1 (Ψ , ∇Ψ , H(Ψ ))
p
2q
 p





q−1
x
Γ
Φ + pΘ2
2
2
(0)
+ε q
Ψ
−M 1 + λ (T − t) +
+ xp O(ε3 )+M xp O(ε3 ),(33)
p
2q
2(1 − p)(Ψ(0) )2


11

where Φ is given by (32) and
2

2 2

Θ =q ρ

(1)

Ψ

2
X

(0)
βi Ψi

i=1

−Ψ

(0)

2
X

!2
(1)
β i Ψi

.

i=1

As before, both O(ε3 ) terms in (33) are independent of x, M and are uniform in (t, z1 , z2 ), and the terms
of order one and of order ε cancel. We chooses M > 0 such that the term in ε2 is negative and the O(ε3 )
terms are absorbed for ε small enough. We conclude that the inequality (25) for supπ Qπ [v + ] holds. The
martingale terms in (27) are handled as before, before taking the supremum in the admissible π.
Finally, from (26) and (27), we deduce
 
q
p  xp 
1
(π 0 )
= xp O(ε2 ),
XT
−
Ψ(0) + εΨ(1)
Et,x,z1 ,z2
p
p
uniformly in (t, z1 , z2 ). Note that here, the O(ε2 ) term depends on M . The “near-optimality” estimate (30)
for the strategy π 0 follows easily from (29).

4.2.4

Remarks

Remark 1. Note that, as it should be, the additional term of oder ε2 from (31) to (33)
 p
q−1 
x
pΘ2
(0)
2
Ψ
ε q
p
2(1 − p)(Ψ(0) )2
is positive as p simplifies, q > 0, and 1 − p > 0.
Remark 2. The model used in our example given in Section 3 based on square-root processes does not satisfy
the assumptions of Theorem 3. Extending the accuracy result to that case requires a stopping argument at
the first time one of the two processes Z1 or Z2 exits the interval [δ, δ −1 ] for some small parameter δ > 0.
The stopped model satisfies the assumption but doesn’t anymore allow for explicit formulas for the functions
Ψ(0 and Ψ(1) . A careful argument is needed to pass to the limit δ → 0 uniformly in ε. This was done, for
instance, for another nonlinear perturbation problem in [8] in the context of stochastic volatility uncertainty.
It is quite technical and beyond the scope of this paper.
4.2.5

The case p < 0

The conclusion of Theorem 3 holds modulo the following adjustements.
The proof in the case p < 0 needs a different definition of v ± because in that case Γ =
h
i
Γ 2
therefore, the quantity 1 + 2q
λ (T − t) may change sign. We redefine them as
v ± (t, x, z1 , z2 ) =

p
1−p

q
xp  (0)
Ψ (t, z1 , z2 ) + εΨ(1) (t, z1 , z2 ) ± ε2 M (−t) ,
p

h
so that v − < v + since p < 0. The inequalities (25) still hold as we have now replaced − 1 +
h
i
Γ 2
by 1 + 2q
λ (−t) and Γ < 0. Now, we need to pay attention at terminal values.
v ± (T, x, z1 , z2 ) =
so that v − (T, x, z1 , z2 ) <

xp
p

< 0 and,

Γ 2
2q λ (T

q
xp
1 ± ε2 M (−T ) ,
p
p

and v + (T, x, z1 , z2 ) > xp . Then, the first line of (26) is replaced by
h
i
h
i
0
0
v(t, x, z1 , z2 ) ≥ Et,x,z1 ,z2 U(X (π ) (T )) ≥ Et,x,z1 ,z2 v − (T, X (π ) (T ), Z1 (T ), Z2 (T )) ,

and the first line of (27) is replaced by
h
i
h
i
Et,x,z1 ,z2 U(X (π) (T )) ≤ Et,x,z1 ,z2 v + (T, X (π) (T ), Z1 (T ), Z2 (T )) .
The rest of the proof follows the same lines as in the case 0 < p < 1.
12

i
− t)

5

Extension to Models with Multi Assets

We now show how to extend our results to a model with multi-assets, and multi-factors. Consider a model
with multiple assets governed by
dSi (t)
= µi (Z(t))dt + σi (Z(t)) dWi (t), i = 1, 2, · · · , n,
Si (t)
dZk (t) = αk (Zk (t)) dt + βk (Zk (t)) dBk (t), k = 1, 2, · · · , m,

(34)
(35)

where we use the vector notation Z := [Z1 , . . . , Zm ]T and the correlation structure between the Brownian
motions (W1 , · · · , Wn , B1 , · · · , Bm ) is given by:
d hWi , Wj it = ρW
ij dt,

d hBk , Bl it = ρB
kl dt,

d hWi , Bk it = ρik dt,

1 ≤ i, j ≤ n, 1 ≤ k, l ≤ m,

B
W
B
with parameters (ρW
ij , ρkl , ρik ) ensuring a proper correlation structure (in particular ρii = ρkk = 1 and
W
W
B
B
symmetries ρij = ρji , ρkl = ρlk ).
Assuming that the wealth is fully invested in the n stocks in a self-financed way, then the wealth process
is given by:

dX(t) =

n
X

n

πi (t)

i=1

dSi (t) X
πi (t) [µi (Z(t))dt + σi (Z(t)) dWi (t)] ,
=
Si (t)
i=1

where πi (t) is the amount invested in asset i at time t. The value function of the optimal investment problem
with terminal time T and utility U is:
v(t, x, z) = sup Et,x,z [U(XT )] ,

U(x) =

π

xp
, p < 1, p 6= 0.
p

We define the following operators:
W

Lπ,ρ
x,z

,ρ

Lρz

B



n,m
n
X
1X W
∂
∂2
∂2

µi (z)πi
+
ρij πi πj σi (z)σj (z)
=
+
ρ
π
σ
(z)β
(z
)
,
ik
i
i
k
k
∂x 2 i,j=1
∂x2
∂x∂zk
i=1
i=1,k=1


m
m
X
1X B
∂2 
∂
+
ρkl βk (zk )βl (zl )
.
=
αk (zk )
∂zk
2
∂zk ∂zl
n
X

k,l=1

k=1

The value function v then satisfies:
B

W

∂t v + Lρz v + sup Lπ,ρ
x,z

,ρ

v = 0,

(36)

π

v(T, x, z) = U(x).
Our asymptotics will be around the case where the Brownian motions Bk are fully correlated. In order
to model this regime, we define:
(1)

ρik = ρi + ρik ε, 1 ≤ i ≤ n, 1 ≤ k ≤ m,
(1,B)

(1,B)

with ρkk = 0 and ρkl
covariance structure.

and

(1,B)

ρB
kl = 1 + ρkl

ε,

(37)

< 0, and ε is a small parameter, 0 < ε  1, small enough to ensure a proper

Remark 3. The model that we are perturbing corresponding to ε = 0 in (37), cannot be of eigenvalue equality
(EVE) type as considered in [1] unless m = 1, that is models with a single factor. Indeed, the matrix ρρT
with ρik = ρi , 1 ≤ i ≤ n, 1 ≤ k ≤ m, admits zero as eigenvalue as soon as m ≥ 2 and therefore, cannot
satisfy the EVE condition ρρT = cI unless in the uncorrelated case ρ = 0.
In order to keep the formulas as explicit as possible, we present the case with two assets and two factors.

13

5.1

Model with Two Assets

We continue illustrate the calculation of the expansions in an example with two assets and two driving
factors. Therefore the model will now be governed by (34)–(35) with n = m = 2. Maximization over π in
(36) gives:
 P

 P

2
2
σj σi k=1 βk ρik vxk + µi vx − ρW
βk ρjk vxk + µj vx
12 σi σj
k=1
 2
, i, j = 1, 2, i 6= j,
(38)
πi∗ =
2
(ρW
12 ) − 1 σi σj vxx
2
where vk denotes a derivative with respect to zk , k = 1, 2, and (ρW
12 ) < 1 to ensure that the two stocks are
not fully correlated. Substituting (38) into (36), it follows that
ρB

∂t v + Lz12 v
 2


P2
2
W
2
2
W
W
vx,1 vx,2
i=1 βi −2ρ2i ρ1i ρ12 + ρ1i + ρ2i vx,i + 2β1 β2 ρ21 ρ22 − ρ12 ρ12 + ρ11 ρ12 − ρ22 ρ12
−
2 )v
)
2(1 − (ρW
xx
!12
 2
2
2
X

λ21 − 2λ1 λ2 ρW
vx
12 + λ2 vx
W
−
βi vx,i ρ1i (λ1 − λ2 ρW
)
+
ρ
(λ
−
λ
ρ
)
−
= 0,
2i 2
1 12
12
2
2
(1 − (ρW
2(1 − (ρW
12 ) )vxx
12 ) )vxx
i=1
where λi (z1 , z2 ) =
5.1.1

µi (z1 ,z2 )
σi (z1 ,z2 ) ,

i = 1, 2.

Fully Correlated Case

Analogous to Section 2.2, we temporarily assume that the two stochastic volatility factors are fully correlated:
ρB
12 = 1, B1 (t) = B2 (t) = B(t), and d hWi , Bit = ρi dt, i, j = 1, 2.
We consider the ansatz
q
xp  (0)
v(t, x, z1 , z2 ) =
Ψ (t, z1 , z2 ) .
p
Let Γ =

∂t Ψ

(0)

p
1−p .

1
+
2



Then, it follows that Ψ(0) satisfies
(0)
β12 Ψ11

+

(0)
β1 β2 Ψ12

1
(0)
+ β22 Ψ22
2








Γβ1
(0)
W
W
+ α1 +
λ1 ρ1 − ρ2 ρ12 + λ2 ρ2 − ρ1 ρ12
Ψ1
2
1 − (ρW
)
12



2


Γ λ21 − 2λ1 λ2 (ρW
Γβ2
(0)
12 ) + λ2
W
W
λ1 ρ1 − ρ2 ρ12 + λ2 ρ2 − ρ1 ρ12
Ψ(0)
Ψ2 +
W )2 )
2
1 − (ρW
2q(1
−
(ρ
)
12
12

2
(0)
(0)



2
2
W
W 2
β
Ψ
+
β
Ψ
2
1
1
2
(q − 1) + p q ρ1 + ρ2 − 1 + 1 − 2qpρ1 ρ2 (ρ12 ) + (1 − q)(1 − p)(ρ12 )
+
= 0.
(0)
2)
Ψ
2(1 − p)(1 − (ρW
)
12

+ α2 +

Choosing

q=

1+Γ

ρ21 + ρ22 − 2ρ1 ρ2 ρW
12
2
1 − (ρW
)
12

−1

linearizes the equation to get:
∂t Ψ(0) +

 (0)
Γ
2
λ21 − 2λ1 λ2 (ρW
+ LΨ(0) = 0,
12 ) + λ2 Ψ
W
2
2q(1 − (ρ12 ) )
Ψ(0) (T, z1 , z2 ) = 1,

where
2

Lφ = L1z φ +


 X
Γ
W
λ 1 ρ1 − ρ2 ρW
βi (zi )φi .
12 + λ2 ρ2 − ρ1 ρ12
W
2
1 − (ρ12 )
i=1
14

(39)

We have the Feynman–Kac representation:
i
h Γ RT 2
Ψ(0) (t, z1 , z2 ) = Ẽt,z1 ,z2 e 2q t λ (Z1 (s),Z2 (s))ds ,
where P̃ is defined so that
B̃t = Bt −

Γ
2
1 − (ρW
12 )

Z

t



W
λ1 (Z1 (s), Z2 (s)) ρ1 − ρ2 ρW
ds
12 + λ2 (Z1 (s), Z2 (s)) ρ2 − ρ1 ρ12

0

is standard Brownian Motion under it, and we denoted
λ2 =
5.1.2

λ21 + λ22 − 2λ1 λ2 ρW
12
.
2
1 − (ρW
)
12

Asymptotics

In the general case, we will assume a correlation structure of the form (37):
(1)

ρik = ρi + ρik ε, i, k = 1, 2,

and

(1,B)

ρB
12 = 1 + ρ12

ε,

(40)

(1,B)

with ρ12 < 0 and ε is a small parameter, 0 < ε  1, small enough to ensure a proper covariance structure.
As was done previously in the case with one stock and a risk-free asset, we will now expand the general case,
around the known case of ε = 0, and calculate the asymptotic expansion similar to (16).
v(t, x, z1 , z2 ) =

q
xp  (0)
Ψ (t, z1 , z2 ) + εΨ(1) (t, z1 , z2 ) + O(ε2 ) ,
p

(41)

Note that the expansion has the same number of arguments as before, as there are still two factors, though
the functions Ψ(i) , i = 0, 1, will be different.
Expanding the correlation coefficients as in (40) and the value function as in (41), we see that Ψ(1)
satisfies an equation similar to (17):
∂t Ψ(1) + LΨ(1) +

 (1)
Γ
2
λ21 − 2λ1 λ2 (ρW
+ f1 (Ψ(0) , ∇Ψ(0) , H(Ψ(0) )) = 0,
12 ) + λ2 Ψ
W
2
2q(1 − (ρ12 ) )

(42)

where
f1 (Ψ(0) , ∇Ψ(0) , H(Ψ(0) )) =
(0) (0)
+β1 β2 Ψ1 Ψ2



(ρ1 −

qΓ
2
(0)
(1 − (ρW
12 ) )Ψ

(1)
ρ2 ρW
12 )(ρ11

+

(1)
ρ12 )

2
X



(1)
(1)
(0)
W
βi2 (ρ1 − ρ2 ρW
)ρ
+
(ρ
−
ρ
ρ
)ρ
(Ψi )2
2
1 12 2i
12 1i

i=1
(1)

(1)

(1,B)

2
2
W
+ (ρ2 − ρ1 ρW
12 )(ρ21 + ρ22 ) − (ρ1 + ρ2 − 2ρ1 ρ2 ρ12 )ρ12



2 

X
Γ
(1)
(1)
(0)
(1,B)
(0)
W
(λ1 − λ2 ρW
βi Ψi − ρ12 β1 β2 Ψ12 .
12 )ρ1i + (λ2 − λ1 ρ12 )ρ2i
W
2
1 − (ρ12 ) i=1

We now consider π 0 , the first order approximation to π ∗ given in (38),
q by substituting the first order
p
approximation for v from (16), namely, v(t, x, z1 , z2 ) ≈ xp Ψ(0) (t, z1 , z2 ) .
Therefore,

 
 (0) 
 (0)
W
x q β1 ρi1 − ρj1 ρW
+ Ψ(0) (λi − λj ρW
12 )
12 Ψ1 + β2 ρi2 − ρj2 ρ12 Ψ2

i, j = 1, 2, i 6= j. (43)
πi0 =
2 σ Ψ(0)
(1 − p) 1 − (ρW
i
12 )
We next use (π1 , π2 ) = (π10 , π20 ) in the supremum of (36) together with the expansions (40), (41) and evaluate

15

the equation, to get that:
ρB

0

W

∂t v + Lz12 v + Lπx,z,ρ ,ρ v
v
"

 
(0)
(1)
= q Ψ + εΨ
∂t Ψ(0) +

 (0)
Γ
2
λ21 − 2λ1 λ2 (ρW
+ LΨ(0)
12 ) + λ2 Ψ
W
2
2q(1 − (ρ12 ) )



#

Γ
2
(1)
+ ∂t Ψ(1) + LΨ(1) +
λ21 − 2λ1 λ2 (ρW
− f1 (Ψ(0) , ∇Ψ(0) , H(Ψ(0) ) ε + O(ε2 )
12 ) + λ2 Ψ
2
2q(1 − (ρW
12 ) )


= O(ε2 ),
where the last equality is obtained by cancelling the first two terms using the equations (39) and (42) satisfied
by Ψ(0) and Ψ(1) respectively.
To summarize, this formal computation shows that the strategy (π1 , π2 ) = (π10 , π20 ) given by (43) generates
the value v given by (36) up to order ε.
5.1.3

Explicit Formulas

We again consider a specific choice of a model, inspired by a model of Chacko and Viceira
√ [4], given by:
i
2zi , for i = 1, 2,
i
=
1,
2,
and
α
(z
)
=
m
−
z
together
with
β
(z
)
=
β̄
µi (z1 , z2 ) = µ̄i , σi (z1 , z2 ) = √zσ̄1 +z
i i
i
i i
2
in (34) and (35) with n = m = 2. As in the exemple in Section 3, we assume m ≥ 1 so that the processes Z1
and Z2 stay positive. We consider again these processes starting at a point (z, z) with z > 0. Using again
the notation Ψ̃(0) (t, z) = Ψ(0) (t, z, z) and the equation (39) for Ψ(0) , the equation for Ψ̃(0) becomes
Γλ̄2 (0)
(0)
2
(0)
(0)
¯
Ψ̃t + (m − z)Ψ̃(0)
z Ψ̃ = 0,
z + β̄ z Ψ̃zz + 2Γρλ̄β̄ z Ψ̃z +
q

(44)

Ψ̃(0) (T, z) = 1,
with the notation
2
λ̄2 − 2λ̄1 λ̄2 ρW
12 + λ̄2
λ̄ = 1
,
2
1 − (ρW
12 )
2



W
λ̄1 ρ1 − ρ2 ρW
12 + λ̄2 ρ2 − ρ1 ρ12
¯
λ̄ =
2
1 − (ρW
12 )

¯ = λ̄ and equation (44) is identical to (20).
Note that if ρ1 = ρ2 , then λ̄
The derivation of explicit formulas for Ψ̃(0) and Ψ̃(1) is very similar as in Section 3 and we omit the
details. In the end, we obtain Ψ̃(0) (t, z) = eC(t)z+D(t) and Ψ̃(1)(t,z) = (C1 (t)z + D1 (t)) Ψ̃(0) (t, z) where C is
the solution of a Riccati equation, and D, C1 , D1 are solution to linear equations.

6

Conclusion

The problem of portfolio optimization with power utilities when returns and volatilities are driven by a single
factor can be linearized by using a classical distortion transformation. In this paper we proposed to treat this
same problem in the presence of several factors. Our approach is to consider a perturbation around the case
where the factors are fully correlated which can be linearized and amenable to explicit solutions. We identify
the leading order term for the value function corresponding to a Merton’s portfolio and we characterize the
first order correction as the solution to a linear equation. An example with explicit solutions is given to
illustrate the quality of the approximation. Under a set of reasonable assumptions, we rigorously establish an
accuracy result for this regular perturbation problem by using the construction of sub- and super-solutions
to the fully nonlinear HJB equation characterizing the value function. In turn, we deduce that the leading
order approximation of the optimal strategy generates the value function up to the first order of accuracy.

16

Acknowledgement
The authors would like to thank Ruimeng Hu for her comments on an earlier version of the paper. The
authors are also grateful to the two referees whose comments and suggestions helped a lot in improving the
paper.

References
[1] L. Avanesyan, M. Shkolnikov, and R. Sircar. Construction of forward performance processes in stochastic factor
models and an extension of widder’s theorem. arXiv:1805.04535v1, 2018.
[2] M. Bichuch. Asymptotic analysis for optimal investment in finite time with transaction costs. SIAM Journal on
Financial Mathematics, 3(1):433–458, 2012.
[3] M. Bichuch and R. Sircar. Optimal investment with transaction costs and stochastic volatility part ii: Finite
horizon. SIAM Journal on Control and Optimization, 57(1):437–467, 2019.
[4] G. Chacko and L. M. Viceira. Dynamic consumption and portfolio choice with stochastic volatility in incomplete
markets. Review of Financial Studies, 18(4):1369–1402, 2005.
[5] J. Feng, M. Forde, and J.-P. Fouque. Short-maturity asymptotics for a fast mean-reverting heston stochastic
volatility model. SIAM Journal on Financial Mathematics, 1(1):126–141, 2010.
[6] J.-P. Fouque and R. Hu. Asymptotic optimal strategy for portfolio optimization in a slowly varying stochastic
environment. SIAM Journal on Control and Optimization, 5(3), 2017.
[7] J.-P. Fouque and R. Hu. Optimal portfolio under fractional stochastic environment. Mathematical Finance,
29(3), 2019.
[8] J.-P. Fouque and N. Ning. Uncertain volatility models with stochastic bounds. SIAM Journal on Financial
Mathematics, 9(4):1175–1207, 2018.
[9] J.-P. Fouque, G. Papanicolaou, and R. Sircar. Derivatives in financial markets with stochastic volatility. Cambridge University Press, 2000.
[10] J.-P. Fouque, G. Papanicolaou, and R. Sircar. Mean-reverting stochastic volatility. International Journal of
theoretical and applied finance, 3(01):101–142, 2000.
[11] J.-P. Fouque, G. Papanicolaou, R. Sircar, and K. Solna. Multiscale stochastic volatility asymptotics. Multiscale
Modeling & Simulation, 2(1):22–42, 2003.
[12] J.-P. Fouque, G. Papanicolaou, R. Sircar, and K. Solna. Multiscale Stochatic Volatility for Equity, Interest-Rate
and Credit Derivatives. Cambridge University Press, 2011.
[13] J.-P. Fouque, R. Sircar, and T. Zariphopoulou. Portfolio optimization & stochastic volatility asymptotics.
Mathematical Finance, 2016.
[14] I. Karatzas and S. Shreve. Brownian motion. In Brownian Motion and Stochastic Calculus, pages 47–127.
Springer, 1998.
[15] D. Kramkov and W. Schachermayer. Necessary and sufficient conditions in the problem of optimal investment
in incomplete markets. The Annals of Applied Probability, 13(4):1504–1516, 2003.
[16] R. C. Merton. Lifetime portfolio selection under uncertainty: The continuous-time case. Review of Economics
and statistics, 51:247–257, 1969.
[17] R. C. Merton. Optimum consumption and portfolio rules in a continuous-time model. Journal of economic
theory, 3(4):373–413, 1971.
[18] O. Oleinik. On the smoothness of solutions of degenerating elliptic and parabolic equations. In Doklady Akademii
Nauk, volume 163, pages 577–580. Russian Academy of Sciences, 1965.
[19] R. Sircar and G. Papanicolaou. Stochastic volatility, smile & asymptotics. Applied Mathematical Finance,
6:107–145, 1999.
[20] T. Zariphopoulou. Optimal investment and consumption models with non-linear stock dynamics. Mathematical
Methods of Operations Research, 50(2):271–296, 1999.

17

