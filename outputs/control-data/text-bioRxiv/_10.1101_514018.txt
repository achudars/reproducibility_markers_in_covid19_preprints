bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Cooperation and Stability for Complex Systems in
Resource-Limited Environments
Stacey Butler,1 James O’Dwyer,2∗
1
2

∗

Department of Mathematics, University of Illinois,Urbana, IL 61801, USA

Department of Plant Biology, University of Illinois, Urbana, IL 61801, USA

To whom correspondence should be addressed; E-mail: jodwyer@illinois.edu.

Resource-limited complex systems are ubiquitous in the natural world, as is the potential for
instability in such systems. Classic models of interacting species have provided a basis for our
understanding of stability in these systems, and suggest that stable coexistence requires weak,
rare, and asymmetric interactions. But missing from these models is an explicit understanding
of how resource exchange and resource limitation can drive or prevent instability. Here we
show that systems based on general rules for the consumption and exchange of resources are
guaranteed to be stable when exchange of resources is reciprocated by each pair of partners.
These cooperative, mutualistic interactions can be arbitrarily strong and yet not disrupt stability.
More general modes of exchange will lead to instability when supply rates are low, but when
resource supply from outside the system is sufficiently high, arbitrary exchange is consistent
with a stable equilibrium.

1

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1 Introduction
The general properties of large, interacting ecological systems have often been modeled using
pairwise interactions between species, where changes in the population size of one species directly affect the growth rate of another (1, 2). While the strength of any given interaction is
challenging to infer from empirical community data (3–5), simple null models have been used
to gain general insights into equilibria and stability in these systems (6, 7). These results have
shown that equilibria will tend to become unstable to small perturbations once either the number or strength of interactions passes a certain threshold (8), and that asymmetric mutualistic
interactions enhance stability (9). Beyond strictly ecological applications, these insights have
been leveraged in other complex biological and social networks comprising multiple, heterogenous component parts (10–13). For example, while nodes in an ecological network are species
and links typically represent interactions, in economic systems nodes have been interpreted as
financial entities and links in terms of transactions between them (14). It is therefore fair to
say that these stability results have deeply informed our understanding of interacting complex
systems in general.
However, missing from this approach are the explicit mechanisms underlying interactions
between individuals. Consumer-resource models meet this need by explicitly considering the
consumption and preferences of individuals for resources (15–22), and can lead to dynamics
that differ from models based on direct species interactions (4, 23). Recent work has extended
these analyses to large, open systems with extensive exchange of resources (24–26), and incorporating resource exchange as the mechanism underlying mutualistic interactions already leads
to contradictions with the classical analyses using pairwise interactions. For example, if each
species in a community specializes on a single resource, then local stability is guaranteed when
each pair of species exchanges resources symmetrically (24), independent of how strong those

2

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

interactions are. This counters both the idea that there is a limit on the strength and prevalence of interactions, and the result that asymmetry enhances stability in the case of mutualistic
interactions, leveraged in both biological (9) and social systems (14).
These earlier results establish the importance of incorporating explict resource exchange
even when tackling basic questions related to equilibria and stability, but were limited in their
scope to specific modes of consumption. Here, we allow for relatively general forms for consumption and organism growth rates as a function of available resources, and use these models
to address two open questions related to resource exchange in complex ecological communities. First, we show that the connection between reciprocity and stability is general, extending
to more realistic models of consumption where each species’ growth is colimited by multiple,
essential resources. We find that exact reciprocity is again sufficient for ecological stability,
regardless of the strength or prevalence of exchange.
Second, we consider the effects of environmental context on stability in terms of resource
supply rates. This question has been raised in systems with resource subsidies from outside (27–29), but has not been addressed for large, complex communities exchanging resources
arbitrarily. It has been unclear how to model the effect of a changing environment on interaction
strengths in models of direct interactions (30, 31), and so here, we consider the impact of the
resource inflow rates on stability for communities that consume and exchange resources. We
focus initially on the case of communities where consumers specialize on a single resource, and
prove that in the limit of scarce resources any departure from a strict set of criteria for exchange
will tend to destabilize the system. These criteria include reciprocity, alongside other limited
modes of exchange. Conversely, for sufficiently large resource inflows, any mode of exchange
can have a stable positive equilibrium. We subsequently generalize this proof to arbitrary modes
of consumption, and show numerical examples for specific cases. These illustrate that when
generic modes of consumption are combined with generic modes of exhange, the result can be
3

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

compatible with a stable equilibrium, so long as resource inflows are sufficiently large, and suggest that in real complex systems there will be important interplays between resource exchange,
ecological stability, and environmental context.

2 Model of Consumption and Exchange
Our model of consumption and exchange is based on a set of m abiotic resources with densities
Rα , and m species with population sizes Ni . We first give three classic models of consumption
processes, in order to build up the intuition for what a reasonable consumption process look
like. We’ll then prove a set of results that apply to each of these three examples, and also extend
this to more general consumption processes that incorporate these three as special cases.

2.1

Specialism

In our first example, each species specializes on a single resource, and cannot grow without the
resource being available. Exchange of resources is incorporated by allowing each species i to
recycle a given proportion of its biomass back into the common pool, at a rate Pαi for resource
α, while resource α is supplied to the system from outside at a specific rate ρα and removed
(due to degredation or outflow) at rate ηα . Species undergo mortality (with biomass not recycled
into usable resources) at rates µi .
(
P
P
Ṙα = ρα − Rα i ci δαi Ni + i Pαi Ni − ηα Rα
P
P T
Ṅi = Ni ci α Rα δαi − µi − α Piα

(1)

Here, ci is the specific rate of consumption of species i, and the Kronecker delta symbol δiα
indicates that consumption only occurs when α is equal to i.
These equations have equilibrium solutions
(
P T
Rα∗ = δαi c1i ( β Piβ
+ µi )
P
−1
Ni∗ = α Miα (ρα − Rα∗ ηα )
4

(2)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

P T
where Mαi = δαi ( β Piβ
+µi )−Pαi . Not all combinations of ρα and µi will lead to positive
(so-called feasible) equilibria. Whil the equilibrium solutions for Rα∗ are always positive in this
model, Ni∗ is not guaranteed to be positive. However, for a given set of Ni∗ , we may find {ρα }
and {ηα } such that Ni∗ is a solution.

2.2

Substitutable Resources

In our second example, each species can consume multiple distinct resources, with uptake rates
determined by Cαi , which could also be thought of as the preference of species i for resource
α. A given consumer still cannot grow without availability of the right resources, but can now
have a wider range of options. Exchange of resources is again incorporated by allowing each
species i to recycle a given proportion of its biomass back into the common pool, at a rate Pαi
for resource α, with rates ρα , ηα and µi defined as before.
(
P
P
Ṙα = ρα − Rα i Cαi Ni + i Pαi Ni − ηα Rα
P T
P
Ṅi = Ni
α Piα
α Cαi Rα − µi −
These equations have equilibrium solutions
(
P
P T
Rα∗ = i (C T )−1
αi (
β Piβ + µi )
P
−1
∗
Ni = α Miα (ρα − Rα∗ ηα )

(3)

(4)

Where Mαi = Rα∗ Cαi − Pαi .
Although in the model, feasibility is not guaranteed, for any given set of positve Rα∗ , there
exists a set of µi such that Rα∗ is a solution and for a given set of Ni∗ , we may find {ρα } and
{ηα } such that Ni∗ is a solution.

2.3 Colimitation by Multiple Resources
In this system, each species is colimited by a distinct set of resources, so that species i requires
precisely Kαi units of resource α to grow new biomass. We model this consumption process
5

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

using multiplicative colimitation (23, 32–34), though we also note that it would also be reasonable to consider other models of colimitation, for example Liebig’s law (16,35–37), where each
species has a single limiting resource at any given time. Each species i has a resource conversion rate of ri . Exchange of resources is as usual incorporated by allowing each species i to
recycle a given proportion of its biomass back into the common pool, at a rate Pαi for resource
α, with ρα , ηα and µi retaining their previous definitions.
The resulting dynamics are described by the following ordinary differential equations:
(
Q K
P
P
Ṙα = ρα − i Kαi ri Ni β Rβ βi + i Pαi Ni − ηα Rα
(5)
Q
P T
Ṅi = Ni (ri α RαKαi − µi − α Piα
)
These equations have equilibrium solutions where consumption and production balance supply
and mortality:
(

P
P −1
log(µi /ri + β Pβi /ri ))
Rα∗ = exp( i Kiα
(6)
P
−1
(ρα − Rα∗ ηα )
Ni∗ = α Miα
P
where the matrix M is given by Mαi = Kαi (µi + β Pβi ) − Pαi . Clearly not all combinations
of ρ, µ, ri , K and P will lead to positive (so-called feasible) solutions. On the other hand,
all positive values Ni∗ are possible for some choice of resource inflow ρα . Conversely, not all
resource concentrations are possible—the recycling of resources into the common pool typically
places lower bounds on equilibrium resource concentrations for a given K and P , as discussed
in Methods.

2.4 General Model of Consumption and Exchange
This variety in consumption processes simply reflects that when competition is modeled mechanistically, via the uptake and conversion of resources into biomass, there are then many distinct
ways for this mechanism to occur. This contrasts with modeling competition implicitly, via direct species interactions (e.g. the competitive Lotka-Volterra equations), and means that while
we may gain new insights by incorporating more explicit mechanism, we also have to deal with
6

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

a potentially broader array of models. This in turn means that if we want to derive general results, for example about the stability of equilibria, we may need to make sure that these results
hold for this broad range of models, and not just one special case.
With this in mind, we now define a more general model of consumption, incorporating
as special cases the three examples above, but allowing for combinations of processes (e.g.
the possibility that a consumer may generate biomass through more than one combination of
essential resources—i.e. by one of multiple metabolic pathways). This model takes the form:
(
P
P
∂gi
Ṙα = ρα − i Rα Ni ∂R
+ i Pαi Ni − ηα Rα
α
(7)
P
Ṅi = Ni (gi ({Rα }) − α Pαi − µi )
The freedom in choosing the consumption function, gi ({Rα }), as a function of resource concentrations allows us to straightforwardly recover any of the three earlier examples, in addition
to a broad range of generalizations. Third, the form of the depletion of resources as a result of
P
∂gi
because we assume that the dependence
consumption generically takes the form i Rα Ni ∂R
α
of gi on Rα captures the effective number of units of resource α required to build one new
consumer, as in the case of multiplicative colimitation. We note that while covering a large set
of plausible forms of consumption, and hence we describe it as general, this model is far from
completely general. For example, a Michaelis-Menten form for resource uptake and depletion
would not fall into this category. In essence, what we generalize to here is cases where uptake
is limited by the rate of finding all necessary resources moving diffusively in a given environment. Finally, we put a restriction on the functional form of the consumption process, detailed
in Methods Section 5.3—in simple terms, this condition imposes that resource depletion can’t
decrease if resource concentrations increase.

2.5

Quantifying Species Interactions Strengths

In models where interactions are not mediated by explicit resources, the rate or strength of a
species interaction is a part of the definition of the model. That’s not the case here, and so if
7

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

we want to state or discuss the properties of these models and how they depend on species interactions, we first need the right definition of interaction strength. In earlier work on exchange
among specialist consumers, it was natural to define the elements of the exchange matrix P as
the strength of mutualism between each pair of species, because there was a one-to-one relationship between resource use and consumer identity. I.e. the entries of the exchange matrix P
already gave us a natural definition of mutualism. However, in all of our more general cases,
from substitutable resources through to the general consumption process encoded by Eq. (7),
the ‘strength’ of mutualism is more subtle.
Therefore to make progress we now derive a metric to measure the strength of mutualism
due to exchange between each pair of species. To simplify notation, we will in places use
~ N
~ , ~g , ρ~, µ
matrix-vector notation. Specifically, we define R,
~ and ~η to represent vectors of the
values of Rα , Ni , gi , ρα , µi and ηα respectively. We define Rd , Nd and Gd to be matrices formed
~ N
~ or ~g along the diagonal with zeros on the off-diagonal. We also define Dg by
by placing R,
Dgαi =

∂gi
∂Rα

and we let W = Rd DgG−1
d . First, we interpret the matrix, W . Its components

look like
∂gi

Wαi = Rα ∂Rα
gi

(8)

So that Wαi represents the current relative effect of resource α on species i’s growth rate multiplied by the current resource density. We assume that the matrix W ∗ = Rd∗ Dg ∗ (G∗d )−1 is of
full rank, and hence invertible. In essence, this is an assumption that each species is distinct in
terms of its phenotype. We can therefore define a matrix
Θ∗ = [W ∗ ]−1 P

(9)

where P is the matrix describing the production of resources by each species. In our Methods
section we show that the production of resources by species j is a sum of components, each
proportional to the resource requirements of another species, i, with the constant of proportion8

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

ality equal to Θ∗ij . Hence, for all Θ∗ij positive, we interpret Θ∗ij biologically as the strength of
exchange from species j to species i. Our sufficient condition for stability will also require that
all Θ∗ij are non-negative, and so we consider it reasonable in this context to restrict our analyses
to systems with non-negative Θ∗ .

3 Results
3.1

Reciprocity Implies Stability

Our model with generalized consumption, restated using matrix-vector notation is
(˙
~ = ρ~ − W (Gd − Θ)N
~ − Rd ~η
R
~˙ = Nd (~g − (W Θ)T ~1 − µ
N
~)

(10)

In our methods section we prove that the equilibrium solution to (10) will be stable to small
perturbations when the following conditions are met:
1. Dg ∗ is nonsingular
2. µ
~ > |[Θ∗ ]T |~1 − [Θ∗ ]T [W ∗ ]T ~1
3.

Θ∗ij Nj∗
G∗i

=

Θ∗ji Ni∗
G∗j

The first condition states that species’ responses to changes in resource densities should be
sufficiently different. The second condition ensures that the eigenvalues of G∗d − Θ∗ will be
positive. This can be interpreted as the total strength of a species’ production/exchange being
bounded by its consumption. The third condition is a reciprocity condition that tells us that if
species j produces as much of what species i needs relative to its growth rate, as species i does
for species j, for all pairs i and j, then (when combined with the other conditions) the whole
community will stably coexist.

9

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

3.1.1 Specialism
We now explore these criteria and their intepretation in each of our three example models. The
specialist consumer model rewritten using matrix-vector notation is
(˙
~ = ρ~ − (R
~ d C − P )N
~ −R
~ d ~η
R
~˙ = N
~ d (C T R
~ − P T ~1 − µ
N
~)

(11)

Where C is a diagonal matrix.
The three conditions for stability become
1. C is nonsingular
~ ∗ ]−1 ]T ~1
2. µ
~ > |P |T ~1 − P T [Rd∗ C[C T R
d
3.

(Pαj δαi )Nj∗
∗δ
ci Rα
αi

=

(Pαi δαj )Ni∗
∗δ
cj R α
αj

By definition, this model satisfies the first condition. The second condition holds because P
~ ∗ ]−1 ]T = I. Only the third condition (reciprocity)
is non-negative, µ
~ is positive and [Rd∗ C[C T R
d
may or may not hold. If we consider the special case of ci = c and Ni∗ = n for all i, and Rα∗ = r
for all α. Then if P is symmetric, the third condition will hold, recapitulating the earlier result
in (24).
3.1.2 Substitutable Resources
The model for substitutable resources rewritten using matrix-vector notation is
(˙
~ = ρ~ − (R
~ d C − P )N
~ −R
~ d ~η
R
~˙ = N
~ d (C T R
~ − P T ~1 − µ
N
~)
and the sufficient conditions take the form
1. C is nonsingular
10

(12)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

~ ∗ ]−1 ]T ~1
2. µ
~ > |Θ∗ |T ~1 − [Θ∗ ]T [Rd∗ C[C T R
d
3. C −1 [Rd∗ ]−1 P Nd∗ is symmetric
~ ∗ ]d C −1 [R∗ ]−1 P . We assume the first condition for our model. This
Where Θ∗ = [C T R
d
~ ∗ ]−1 ]T ~1 = ~1. In order
model satisfies the second condition for positive Θ∗ because [Rd∗ C[C T R
d
to ensure stability, the third condition must be verified using the equilibrium values for a given
model.
3.1.3 Colimitation by Multiple Resources
The model in matrix-vector notation is
(˙
~ = ρ~ − (KGd − P )N
~ − Rd ~η
R
~˙ = Nd (~g − P T ~1 − µ
N
~)

(13)

The sufficient conditions for stability become
1. [Rd∗ ]−1 KG∗d is nonsingular
2. µ
~ > |Θ|T ~1 − ΘT K T ~1
3. [G∗d ]−1 ΘNd∗ is symmetric
Where Θ = K −1 P and Gd is the diagonal matrix with (Gd )ii = ri

Q

α

RαKαi . The first

condition holds for full-rank K and (G∗d )ii > 0, which we assume for our model. The second
condition holds for Θ with non-negative entries by noticing that K has integer entries is assumed
nonsingular so that K T ~1 ≥ ~1. Only reciprocity, the third condition, may fail for this model.

3.2 Abundant Resource Inflow Implies Stability
This connection between reciprocity and stability may seem like it must be highly finely tuned—
i.e. a very unlikely special case. We now think about the implications for non-reciprocal
11

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

exchange, and show that (making some additional assumptions) non-reciprocal modes of exchange can lead to stable equilibria, but in some cases only when resource inflows are large.
Viewed in this light, even being near to a condition of reciprocity may extend the range of environmental contexts in which a given system will have a stable, positive equilbria. In other
words, reciprocity guarantees stability in our models for any set of resource supply rates, but a
broader range of modes of exchange will be compatible with stability in a given environmental
context defined by a finite set of supply rates.
To explore this, we first consider our simplest example above, where each species specializes
on a single resource. We choose ηα = 0 and choose ρα and µi such that each resource has the
~ ∗ = r~1, and each species has the same equilibrium abundance
same equilibrium concentration, R
~ ∗ = n~1. Hence also all consumers have the same growth rate at this equilibrium G
~ ∗ = g~1,
N
balanced by mortality.
For this model, the condition defining the equilibrium solution is:
(
µ
~ = g~1 − ΘT ~1
ρ~ = (gI − Θ)n~1

(14)

and the Jacobian matrix for small perturbations around this feasible equilibrium solution is:
 gn

− r I −(gI − Θ)
L=
.
(15)
gn
I
0
r
From the block form of this matrix, if λ is an eigenvalue of L, and γ is an eigenvalue of Θ, then
these eigenvalues are related by:
1
λ=
2

gn
−
±
r

r 
gn 2
r

gn
− 4 (g − γ)
r

!
(16)

The condition for the equilibrium to be stable to local perturbations (Re(λ) < 0) leads to the
following necessary and sufficient condition for all γ (24):
(Im(γ))2 <

gn
(g − Re(γ)).
r
12

(17)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

We now consider what happens when environmental conditions cause the resource influx rate to
be reduced. We assume the resource influx is rescaled to F ρ~, where F is a positive real number,
and F may vary. Then the conditions defining the equilibrium solution become:
(
µ
~ = g~1 − ΘT ~1
F ρ~ = (gI − Θ)F n~1.

(18)

So now the equilibrium abundances of all consumers are F n, and the necessary and sufficient
criterion for stability becomes
(Im(γ))2 < F

gn
(g − Re(γ)).
r

(19)

In the limit of scarce resources, i.e. as F → 0, the only Θ that will satisfy this inequality are such
that Im(γ) = 0 for all γ, thus restricting the form of Θ to a relatively specific set of matrices,
including reciprocal exchange, alongside (for example) exchange networks without feedback


Im(γ)2
loops. On the other hand, when resources are plentiful, i.e. when F > sup gn (g−Re(γ))
, where
r

the supremum is taken over all eigenvalues of Θ, then this system will be stable.
In Methods Section 5.5 (no resource outflow) and Supplementary Information (with resource outflow) we extend this result, and show that for our more general consumption process
positive equilibria will be stable for sufficiently high resource inflow rates, even if they are unstable for lower resource rates. To prove this we state some specific conditions on growth and
exchange, but importantly we do not assume reciprocity or any specific structure for the matrix of mutualistic interactions, Θ. To illustrate the implications of this result, we also picked
out some explicit examples and solved for their dynamics numerically, shown in Figs 1–3. We
note that this contrasts with the well-known paradox of enrichment (27), and related results on
the effect of spatial subsidies on stability (28, 29). We also note that there is no guarantee in
our models that the magnitude of the largest eigenvalue of the appropriate Jacobian decreases
monotonically with increasing resource inflow, and so it is possible that in some cases there may
13

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

be phenomena of ‘oscillating’ stability and instability as a function of resource inflow, although
always (eventually) resulting in stable equilibria beyond some threshold level.
3.2.1 Transition from Stability to Instability in a Slowly Changing Environment
The effect of a variable environment on individual species extinction has previously been quantified via the raw, direct effect of environmental parameters on species growth rates (38–40),
but there is a more limited understanding of how environmental variability might impact collective properties like community stability, in particular when species can exchange resources as
well as consume them. We have been agnostic in this paper with respect to how exchange has
evolved over time (41,42). But it is clear that generic modes of exchange could evolve (if adaptive) in the context of high resource supply rates, only to lead to community instability when
supplies dry up. We provide an explicit example of this phenomenon in our methods section for
a three-species community with specialized consumers, and the exchange matrix


1 0 2
Θ= 1 1 0 
0 1 1
For a sufficiently high set of resource inflow rates, this system has a stable equilibrium—i.e.
this is just a specific example of the general case above. We now consider resource inflows to
change, but now in the other direction, so that resource inflow is slowly reduced over time. If
inflow rates are rescaled by a factor F , as above, and this factor varies slowly enough that the
system reaches a new equilibrium for each value of F , then this system will become unstable for
a sufficiently small F . In Methods 5.4 we derive the threshold explicitly for this specific system,
though the phenomenon is quite general for specialist consumers and matrices Θ with any complex eigenvalues. This suggests that the condition of stability under a range of environmental
contexts may be an important filter during the evolution of cooperation.

14

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

4 Discussion
Our study has identified two important connections between resource exchange and community
stability, in the context of consumption of a set of essential resources. Our approach builds
on classic consumer-resource dynamics (16–18, 20, 22), but incorporates the possibility of arbitrary exchanges of resources between consumers, which could be thought of in terms of the
recycling of biomass into usable matter following mortality. Using this framework, we generalized an earlier connection between pairwise reciprocity in the exchange of resources and
community stability for a complex ecological system (24). Specifically, reciprocity of resource
exchange is a sufficient condition for the local stability of a positive equilibrium, even when
consumption requirements of species are a complicated combination of distinct resource types.
So long as reciprocity holds, the strength of interactions and dependencies between species can
be arbitrarily strong. The difference between this conclusion and the classic results arising from
pairwise interactions reinforces the importance of considering explicit mechanisms underlying species interactions—even to gain an understanding of quite basic properties like the local
stability of equilibria.
Second, we identified a connection between the environmental context, characterized by
the rates of resource supply from outside, and community stability. We proved that generic
modes of exchange lead to stable equilibrium if resource supply rates are sufficiently high.
When resources are scarce, many modes of exchange will lead to instability, but in times of
(sufficient) plenty any mode of exchange can lead to a stable equilibrium, in contrast to classic
work based on smaller, but trophically-structured networks (27). This well-known paradox of
enrichment considers the interaction of nutrients, prey, and predators, and for a certain set of
functional forms for predator-prey interactions we know that increasing nutrient availability for
the prey species will lead to instability. Our models do not not have this three-level trophic

15

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

interaction, but do allow for a much more complex ‘horizontal’ network of exchange. And yet
we find, for essentially any form of this horizontal structure, that a large enough increase in
external resource inflow will eventually lead to stability.
Taken in combination, our two results suggest some extensions to the dictionary of how
to be stable. An intuitive reason for the instability in systems with direct species interactions
described by May and others (7, 8) is that if there are sufficiently many randomly-placed links
between species, and they are strong enough, then these interactions will tend to generate destabilizing feedbacks. Avoiding feedbacks therefore is a reasonable lesson to take from these systems. Some of the intuition behind these results is similar—for example in the case of species
that specialize on a single resource, acyclic exchange (like reciprocity) is an example of the
special modes of exchange that will guarantee stability under all environmental contexts. On
the other hand, the idea that reciprocity leads to stability is somewhat invisible in the direct
interactions approach, where the received wisdom has been that asymmetric mutualisms are
more likely to lead to stability (9). Yet here we have shown that reciprocity is a general way to
ensure stability across different modes of resource consumption. Interactions and transactions
in social systems may often be based on exchange, for example in financial networks (11). It is
therefore possible that their dynamics more closely mirror the set-up of our system than models
of direct species interactions, and hence the fact that reciprocity (rather than asymmetry) leads
to stability here may be important in understanding stability in complex social systems, as well
as in biological examples.
Finally, we did not make reference to the evolution of cooperation, which in this context
would allow for changes in production and exchange over time (41), and in the right circumstances can lead to reciprocity (42, 43). Everything considered here is for fixed species phenotypes, and ecological rather than evolutionary stability. On the other hand, our analysis demonstrates that ecological stability may be a non-trivial criterion along the way for any evolving
16

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

system of cooperating species. In particular, if exchange evolves when resources are plentiful, we demonstrated that the very same exchange process can lead to instability and possible
collapse if at some later point the same resources are much more scarce.

Acknowledgements
JOD acknowledges the Simons Foundation Grant #376199, McDonnell Foundation Grant #220020439,
NSF #DEB1557192.

17

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 1: Resource Supply and the Onset of Instability for Specialist Consumers. This example
shows four communities of 20 consumer species, each specializing on one of 20 distinct resources, with
consumption rates drawn from the absolute values of a normal distribution with mean zero and standard
deviation one. Inflow and mortality rates are chosen so that equilibrium concentrations and abundances
are also randomly drawn from the absolute values of a normal distribution, and the exchange matrix
Θ has a connectance =0.2, with non-zero entries drawn from the absolute values of a Gaussian (also
with mean zero and sd one). From left to right we show the effect of changing resource supply on the
dynamics of this community near equilibrium. Resource supply rates, F ρ
~, are increased by a factor
of ten from each panel to the next, reflected in the increase of consumer abundances by the same factor.
This shift demonstrates that reducing resource supplies alone can change a stable community equilibrium
into an unstable equilibrium, mediated by the corresponding change in consumer abundances. The top
panels illustrate the same phenomenon by focusing on the eigenvalue spectrum of the Jacobian near the
equilibrium in each case. As resource supply is increased, the spectrum loses eigenvalues with positive
real part.

18

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 2: Resource Supply and the Onset of Instability for Substitutable Resources. This example
shows four communities of 20 consumer species, each able to use two of 20 distinct resources. Consumption rates are such that the matrix C has diagonal entries non-zero, and also one other entry non-zero for
each row and column. Entries are again drawn from absolute values of normal distributions.Inflow and
mortality rates are chosen so that equilibrium concentrations and abundances are also randomly drawn
from the absolute values of a normal distribution, and the exchange matrix Θ has a connectance =0.2,
with non-zero entries drawn from the absolute values of a Gaussian with mean zero and sd one. Resource
supply rates, F ρ
~, are increased by a factor of ten from each panel to the next, reflected in the increase
of consumer abundances by the same factor. The top panels illustrate the same phenomenon by focusing
on the eigenvalue spectrum of the Jacobian near the equilibrium in each case. As resource supply is
increased, the spectrum loses eigenvalues with positive real part.

19

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 3: Resource Supply and the Onset of Instability for Essential Resources. This example shows
four communties of 20 consumer species, each using an essential combination of multiple resources
drawn from a set of 20 distinct resources. The matrix Kαi describing how many units of resource α are
needed by species i was chosen to have a connectance of 0.3, and each entry is randomly drawn from
a list containing 1, 2 and 3 with different weightings. I.e. each species uses on average 6 resources,
and requires either one, two or three units of each, with one unit being the most likely in this example,
followed by two and three. From left to right we show the effect of changing resource supply on the
dynamics of this community near equilibrium. Resource supply rates, F ρ
~, are increased by a factor of
ten from each panel to the next, reflected in the increase of consumer abundances by the same factor.
The top panels illustrate the same phenomenon by focusing on the eigenvalue spectrum of the Jacobian
near the equilibrium in each case. As resource supply is increased, the spectrum loses eigenvalues with
positive real part.

20

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

5 Materials and Methods
5.1

Feasible Equilibrium Solutions

We consider the following equilibrium solutions of Eq. (7):
(
µ
~ = ~g ∗ − [W ∗ Θ∗ ]T ~1
~ ∗ + R∗ ~η
ρ~ = W ∗ (G∗d − Θ∗ )N
d
(
~g ∗ = P T ~1 + µ
~
∗
∗
~ ∗ + R∗ ~η
ρ~ = (Rd Dg − P )N
d

(20)

(21)

Positive values of Dgαi ensure the existence of positive ρ~ and µ
~ . If Dgαi > 0 for all α, i,
~ ∗ such that µ = ~g ∗ − P T ~1 > 0 and ρ~ = (R∗ Dg ∗ − P )N
~ ∗ + R∗ ~η > 0. Also,
then there exists R
d
d
given ~g ∗ , sufficiently small production P allows for positive µ
~ and especially when Dg ∗ > 0 or
~η > 0.
5.1.1 Specialism
We consider the equilibrium solutions of (1)
(

where Mαi = δαi (

P

β

P T
Rα∗ = δαi c1i ( β Piβ
+ µi )
P
−1
∗
Ni = α Miα (ρα − Rα∗ ηα )

(22)

T
Piβ
+ µi ) − Pαi .

The equilibrium solutions for Rα∗ should always be feasible in this model. All of the parameters in the equation for Rα∗ are positive. For Ni∗ , the matrix M is an M-matrix and so is
inverse-positive, meaning that all of the entries of M are positive. For a given set of Ni∗ , we
may find ρα and ηα such that Ni∗ is a solution.
5.1.2 Substitutable Resources
We consider the following equilibrium solutions of (3):

21

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

(

P
P T
Rα∗ = i (C T )−1
αi (
β Piβ + µi )
P
−1
∗
Ni = α Miα (ρα − Rα∗ ηα )

(23)

Where Mαi = Rα∗ Cαi − Pαi .
Although in the model, feasibility is not guaranteed for Rα∗ , for any given set of positve Rα∗ ,
there exists a set of µi such that Rα∗ is a solution. For a given set of Ni∗ , we may find ρα and ηα
such that Ni∗ is a solution.
5.1.3 Colimitation by Multiple Resources
We consider the following equilibrium solutions of (5):
(

P
P −1
log(µi /ri + β Pβi /ri ))
Rα∗ = exp( i Kiα
(24)
P
−1
(ρα − Rα∗ ηα )
Ni∗ = α Miα
P
where the matrix M is given by Mαi = Kαi (µi + β Pβi ) − Pαi . Clearly not all combinations
of ρ, µ, ri , K and P will lead to positive (so-called feasible) solutions. On the other hand,
all positive values Ni∗ are possible for some choice of resource inflow ρα . Conversely, not all
resource concentrations are possible—the recycling of resources into the common pool typically
places lower bounds on equilibrium resource concentrations for a given K and P .
More explicitly, consider
(
µ
~ = ~g ∗ − ΘT K T ~1
~∗
ρ~ = K(G∗d − Θ)N
where ~g ∗ is a vector of equilibrium growth rates gi∗ = ri

(25)
Q

α

Rα∗Kαi , definined in the same

way as in the main text, and G∗d is a diagonal matrix with diagonal elements equal to ~g ∗ .
~ ∗, N
~ ∗ }, are possible posWhen production (i.e. the matrix Θ) is non-zero, not all pairs, {R
itive (also known as feasible) equillibrium solutions. The primary constraint is that the input
rate ρ~ and mortality rate of consumers µ
~ must both be non-negative in order to have a plausible
~ ∗, N
~ ∗}
biological interpretation. So this means that the question is how to determine which {R
22

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

are solutions for positive µ
~ and ρ~, given a fixed set of resource requirements K and production
defined by the matrix Θ.
~ ∗ , which may or may not be a feasible solution with
First, we note that given a vector R
~ ∗ will arise from a positive
positive µ
~ , there is always some positive constant, a such that aR
~ ∗ are possible, but there is always a set of resource densities in the same
vector µ
~ . So not all R
~ ∗.
ratios that is a feasible solution. Conversely, all positive µ
~ lead to positive R
~ ∗ , and large enough R
~ ∗ , the product (G∗ − Θ)N
~ ∗ will be positive and thus
Second, given N
d
~ ∗ is possible, given a sufficiently large set of resource densities R
~ ∗.
so will ρ~. So any positive N
In summary, we can rule out the existence of pathological combinations of K and P —all pairs
allow for at least some range of feasible equilibria.

5.2

Definition of Mutualistic Interaction Strengths

We can interpret the components of Θ∗ defined in the main text by considering their relationship
to the components of W ∗ and P :
Pαj =

X

∗
Θ∗ij Wαi

i

so that
 ∗ 
 ∗ 

 ∗ 
P1j
W11
W12
W1m
∗
∗
∗
W
W
W2m
P
22 
21 

 2j 
∗ 
∗ 
∗ 
 ..  = Θ1j  ..  + Θ2j  ..  + . . . + Θmj  .. 
.
.
.
.
∗
∗
∗
Wmm
Wm1
Wm2
Pmj


which can be written concisely as
P~ (j) =

X

~∗
Θ∗ij W

(i)

i

~ ∗ (i) is a vector describing the resource requirements of species i (i.e. the ith column
where W
of the matrix W ∗ ) and P~ (j) describes the production of resources by species j. It can be seen
that the production of resources by j is a sum of components, each proportional to the resource
23

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

requirements of another species, i, with the constant of proportionality equal to Θ∗ij .Hence, for
all Θ∗ij positive, we interpret Θ∗ij biologically as the strength of exchange from species j to
species i. We note though that our sufficient condition for stability will require that all Θ∗ij are
non-negative, and so we restrict our analysis to systems with non-negative Θ∗ .

5.3 Local Stability for Arbitrary Consumption Requirements
We first put a restriction on the functional form of the consumption process, by requiring that
the matrix with components

1 ∂ 
1 ∂
−Ṙα =
Rα ∂Rα̂
Rα ∂Rα̂

X
i

∂gi
+ ηα Rα
Ni Rα
∂Rα

!
(26)

is a positive semi-definite matrix. More explicitly, this condition imposes that if we inflate or
deflate resource centrations by allowing Rα → Rα (1 + α ) for an arbitrary vector of small
quantities α , then
X

α ∆Ṙα ≤ 0

(27)

α

where ∆Ṙα is the small change in growth rates Ṙα caused by the small change in resource
concentrations α Rα . As an example, if all resources are inflated by a the same factor, so
that α = , then this condition tells us that the sum of all depletion rates must increase. In
essence, this condition imposes that resource depletion can’t decrease if resource concentrations
increase.
Next, writing production in terms of the matrix Θ as defined in (9), the Jacobian at equilibrium is given by

L=

−W ∗ (G∗d − Θ∗ )
−A
Nd∗ [Dg ∗ ]T
0

24


(28)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Where A is defined as
Aαα̂ =

X

Ni∗



i

∂
∂Rα̂



∂gi
Rα
∂Rα

∗
+ δαα̂ ηα

(29)

If all the real parts of the eigenvalues of this Jacobian are negative, then this equilibrium is
locally stable.
To start with, we show that λ = 0 is not an eigenvalue of L. Assume it is, then there is an
eigenvector,~v , associated with λ = 0. Write ~v as

~v =

~x
~y


(30)

where ~x = (v1 , v2 , ..., vm ) and ~y = (vm+1 , vm+2 , ..., vm+n ) then
A~x −W ∗ (G∗d − Θ∗ )~y = 0
(31)

Nd∗ [Dg ∗ ]T ~x

=0

so that ~x must be in the nullspace of Nd∗ [Dg ∗ ]T .

However, for feasible equilibria,

rank(Nd∗ [Dg ∗ ]T ) = rank(Dg ∗ ). We assume rank(Dg ∗ ) = m and so with Dg ∗ an m × m
matrix, then we must have ~x = ~0. Similarly, ~y must be in the nullspace of −W ∗ (G∗d − Θ∗ ) and
thus ~y = ~0 so long as G∗d − Θ∗ has no zero eigenvalues.
To determine conditions under which the real parts of all the eigenvalues of L are negative,
we first note that the eigenvalue equation det(L − λI) = 0 is given by

det(L − λI) = det

−A − λI −W ∗ (G∗d − Θ∗ )
Nd∗ [Dg ∗ ]T
−λI

25


= 0.

(32)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

So long as λ 6= 0, then −λI is invertible, and so
0 = det(L − λI)
= det(−λI)
× det((−A − λI) − (−W ∗ (G∗d − Θ∗ ))([−λI]−1 )(Nd∗ [Dg ∗ ]T ))
1
= det(−λI − (A + W ∗ (G∗d − Θ∗ )Nd∗ [Dg ∗ ]T ))
λ
1
= det(−λI − (A + Rd∗ Dg ∗ [G∗d ]−1 (G∗d − Θ∗ )Nd∗ [Dg ∗ ]T ))
q λ
p
p
1 p ∗ ∗ ∗ −1 ∗
= det(−λI − ( [Rd∗ ]−1 A Rd∗ +
Rd Dg [Gd ] (Gd − Θ∗ )Nd∗ [Dg ∗ ]T Rd∗ ))
λ
We will next assume Re(λ) ≥ 0 and look for a contradiction. We will also assume that
[G∗d ]−1 Θ∗ Nd∗ is symmetric, which we interpret in terms of reciprocity between species.
p
p
p
We wish to find a contradiction by proving the eigenvalues of [Rd∗ ]−1 A Rd∗ + λ1 Rd∗ Dg ∗ [G∗d ]−1 (G∗d −
p
Θ∗ )Nd∗ [Dg ∗ ]T Rd∗ have positive real part and so it will be sufficient to show that the Hermitian
p
p
p
p
part, H( [Rd∗ ]−1 A Rd∗ + λ1 Rd∗ Dg ∗ [G∗d ]−1 (G∗d − Θ∗ )Nd∗ [Dg ∗ ]T Rd∗ ), is positive definite.
p
p
p
We will do this by looking at the two matrices [Rd∗ ]−1 A Rd∗ and λ1 Rd∗ Dg ∗ [G∗d ]−1 (G∗d −
p
p
p
Θ∗ )Nd∗ [Dg ∗ ]T Rd∗ seperately. For λ1 Rd∗ Dg ∗ [G∗d ]−1 (G∗d − Θ∗ )Nd∗ [Dg ∗ ]T Rd∗


q 
1 p ∗ ∗ ∗ −1 ∗
∗ ~∗
∗ T
~∗
H
Rd Dg [Gd ] (Gd − Θ )Nd [Dg ]
R
d
λ
p
Re(λ) p ∗ ∗ ∗ −1 ∗
∗
∗
∗ T
R
Dg
[G
Rd∗
=
]
(G
−
Θ
)N
[Dg
]
d
d
d
d
|λ|2
which is T congruent to [G∗d ]−1 (G∗d − Θ∗ )Nd∗ and so we want the eigenvalues of [G∗d ]−1 (G∗d −
Θ∗ )Nd∗ to be all positive. [G∗d ]−1 (G∗d − Θ∗ )Nd∗ is symmetric, and is T congruent to, and thus has
p
p
the same inertia as G∗d [Nd∗ ]−1 [G∗d ]−1 (G∗d −Θ∗ )Nd∗ G∗d [Nd∗ ]−1 which has the same eigenvalues
as G∗d [G∗d ]−1 (G∗d − Θ∗ )Nd∗ [Nd∗ ]−1 = G∗d − Θ∗ .
Thus we wish to find a condition ensuring all eigenvalues of G∗d − Θ∗ are positive. From
P
∗ T
Gershgorin’s theorem, this will be true if G∗i >
j [|Θ |]ij for all i. Using that for feasible

26

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

equilibria, G∗ = µ
~ + [Θ∗ ]T [W ∗ ]T ~1, the condition becomes
µ
~ > |[Θ∗ ]T |~1 − [Θ∗ ]T [W ∗ ]T ~1

(33)

p ∗
p
p
p
[Rd ]−1 A Rd∗ . We can write this as Rd∗ [Rd∗ ]−1 A Rd∗
p
p
and so if the Hermitian part of [Rd∗ ]−1 A is positive definite so will be [Rd∗ ]−1 A Rd∗ . Note
Now looking at the Hermitian part of

that [Rd∗ ]−1 A is symmetric.
[[Rd∗ ]−1 A]αα̂


∗
1 X ∗ ∂Rα ∂gi
1
∂ 2 gi
= ∗
Ni
+ ∗ δαα̂ ηα
+ Rα
Rα i
∂Rα̂ ∂Rα
∂Rα ∂Rα̂
Rα

(34)

5.3.1 The example models satisfy [[Rd∗ ]−1 A]αα̂ is positive definite
Specialism
1
∂ 2 gi ∗
1 X ∗ ∂Rα ∂gi
+
R
) + ∗ δαα̂ ηα
N
(
α
i
∗
Rα i
∂Rα̂ ∂Rα
∂Rα ∂Rα̂
Rα
1 X
= δαα̂ ∗ (
δαi Cαi Ni∗ + ηα )
Rα i

[[Rd∗ ]−1 A]αα̂ =

(35)

which is a positive definite matrix.
Substitutable Resources
1
∂ 2 gi ∗
1 X ∗ ∂Rα ∂gi
N
(
+
R
) + ∗ δαα̂ ηα
α
i
∗
Rα i
∂Rα̂ ∂Rα
∂Rα ∂Rα̂
Rα
1 X
= δαα̂ ∗ (
Cαi Ni∗ + ηα )
Rα i

[[Rd∗ ]−1 A]αα̂ =

which is a positive definite matrix.

27

(36)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Colimitation by Multiple Resources
[[Rd∗ ]−1 A]αα̂



∗
1 X ∗
∂
∂gi
1
= ∗
Ni
Rα
+ ∗ δαα̂ ηα
Rα i
∂Rα̂
∂Rα
Rα


∗
∂
1
1 X ∗
Ni
(Kαi gi ) + ∗ δαα̂ ηα
= ∗
Rα i
∂Rα̂
Rα


∗
1 X ∗ Kαi Kαi
1
= ∗
Ni
gi + ∗ δαα̂ ηα
Rα i
Rα̂
Rα


∗
X
Kαi Kα̂i
1
=
Ni∗
gi + ∗ δαα̂ ηα
Rα Rα̂
Rα
i

(37)

and so
[[Rd∗ ]−1 A] = [Rd∗ ]−1 KNd∗ G∗d K T [Rd∗ ]−1 + [Rd∗ ]−1 ηd

(38)

is the sum of two positive definite matrices.

5.4

Transitions in Stability with Changing Environment for Specialist Consumers

Here, we show an example of how changing environment can allow for the development of
exchange when resources are plentiful, but a subsequent decrease in resources destabilizes the
system. We begin with no exchange, i.e. Θ = 0. This system always has feasible equilibria for
any positive ρ and µ, and these equilibria is locally stable. Set µ
~ = (2, 2, 1), ρ~ = (2, 4, 4). Then
~ ∗ = (2, 2, 1), N
~ ∗ = (1, 2, 4) and with ri =
G

4
3

~ ∗ = ( 3 , 3 , 3 ).
for all i, then R
2 2 4

We next suppose that over time, production is introduced as:


1 0 2
Θ= 1 1 0 
0 1 1
which has eigenvalues, γj = 1 −

√
3

2ei

(2j+1)π
3

for j = 0, 1, 2. The equilibrium values of this

~ ∗ = g~1 with g = 4, R
~ ∗ = r~1 with r = 3 and N
~ ∗ = n~1
system with production, Θ, are G
with n = 2. This system is stable. The eigenvalues of the Jacobian for this equilibrium are

28

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

approximately {−0.82 ± 2.86i, −1.84 ± 2.86i, −1.33 ± 1.69i} (i.e., the equilibrium is stable to
local perturbations).
So we have a system with asymmetric exchange, which nevertheless in this environmental
context has a stable equilibrium. We now rescale ρ~ to F ρ~, as above so that consumer abundances
are rescaled to n = 2F . The criterion above then tells us that:
8
(Im(γj ))2 < F (4 − Re(γj )).
3

(39)

for all γi . In other words, there is a threshold value of F at which this equilibrium will become
unstable.
We now define F0 as this threshold value of F , below which (39) fails for some eigenvalue,
γj , of Θ. The largest F0 comes from the stability criterion applied to γ2
F0 =

3 (Im(γ2 ))2
8 (4 − Re(γ2 ))

(40)

≈ 0.12
Therefore, for resource inflow levels below ρ = F0 × (2, 4, 4), the system with production defined by Θ is unstable. However, the original system with no resource exchange, where Θ = 0,
would still have had a positive, stable equilibrium under these reduced resource inflow conditions, implying that (with the benefit of hindsight) the addition of exchange was detrimental to
stability.

5.5 Abundant Resource Inflow Implies Stability
5.5.1 Generalized Consumption with no resource outflow
Here we consider our model for generalized consumption requirements with no resource outflow, so that ~η = 0. From section 5.3 in Methods we have the eigenvalue equation

q
p
p
1 p ∗ ∗ ∗ −1 ∗
det(−λI − ( [Rd∗ ]−1 A Rd∗ +
Rd Dg [Gd ] (Gd − Θ∗ )Nd∗ [Dg ∗ ]T Rd∗ )) = 0
λ
29

(41)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

which is equivalent to

2

det(−λ I − (λ

q

[Rd∗ ]−1 A

p

Rd∗ +

p

Rd∗ Dg ∗ [G∗d ]−1 (G∗d − Θ∗ )Nd∗ [Dg ∗ ]T

p
Rd∗ )) = 0

(42)

Now consider increasing resource inflow so that ρ~ → F ρ~ for positive real F . Then by
~ ∗ → FN
~ ∗ and the eigenvalue equation
(10), the new equilibrium species abundances become N
becomes

2

det(−λ I − F (λ

q

[Rd∗ ]−1 A

p

Rd∗ +

Rd∗ Dg ∗ [G∗d ]−1 (G∗d − Θ∗ )Nd∗ [Dg ∗ ]T

p

p

Rd∗ )) = 0 (43)

Now for some notation changes. First lets drop the ∗ (which from now on will denote
q
√
√
complex conjugate transpose). Next define U as U = Rd−1 A Rd and V as V = Rd Dg and
we rewrite the eigenvalue equation as

det(−λ2 I − F (λU + V M V T )) = 0

(44)

Where M = G−1
d (Gd − Θ)Nd .
We wish to show that for large enough F , λ such that Re(λ) ≥ 0 cannot be a solution.
We will not need to consider which λ actually solve (44). We will only need to eliminate the
ones with positive real part. We assume, as before, that V is nonsingular and that U is positive
definite. We also assume that the field of values of M , F(M ) = {x∗ M x : x∗ x = 1, x ∈ Cn }
is contained strictly in the right half of the complex plane. This condition is somewhat stricter
than that used in conjunction with symmetry for the stability proof in the paper, which was that
M had all positive eigenvalues.
Let λ = a + bi. Assume a ≥ 0 and, by symmetry, it is only necessary to consider b ≥ 0
so assume that as well. We show for such λ that there exists an Fλ such that for all F > Fλ ,
30

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

−λ2 ∈
/ F(F (λU + V M V T )) and thus −λ2 cannot be an eigenvalue of F (λU + V M V T ). Then
we argue that we can bound our {Fλ }.
Note that from the properties of field of values we have
F(F (λU + V M V T )) = F (F(λU + V M V T ))
(45)
⊂ F (λF(U ) + F(V M V T ))
We will essentially show that we can use F to push λF(U ) + F(V M V T ) too far from the
origin, beyond |−λ2 |. Because of this, it is the values of λF(U ) and F(V M V T ) with minimum
modulus that will be important.
First, we want to describe F(V M V T ).
F(V M V T ) = {x∗ V M V T x : x∗ x = 1}
= {y ∗ M y : y = V T x, x∗ x = 1}

(46)

For every y = V T x with x∗ x = 1, we have that there exists an x̃ with x̃∗ x̃ = 1 such that
y = α{V,x̃} x̃ for some real number α{V,x̃} . And so continuing
{y ∗ M y : y = V T x, x∗ x = 1} = {α{V,x̃} x̃∗ M α{V,x̃} x̃ : x̃∗ x̃ = 1}
= {(α{V,x̃} )2 x̃∗ M x̃ : x̃∗ x̃ = 1}

(47)

so that every point in the field of values F(V M V T ) is a point in F(M ) stretched/shrunk
by some value (α{V,x̃} )2 . We want to be sure F(V M V T ) is contained in the right half of
the complex plane and so need to consider the shrink. Because V T is non-singular, from the
singular value decomposition of V
min(α{V,x̃} )2 = min(||V T x||2 ) for x∗ x = 1
= λmin (V V T )

(48)

>0
Where λmin (V V T ) is the smallest eigenvalue of V V T . Now because F(M ) is in the right
half of the complex plane and λmin (V V T ) > 0 we may conclude that F(V M V T ) is contained
31

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

in the right half of the complex plane. Because a field of values is a compact, convex set,
which for a real matrix will be symmetric about the real line, we may without loss of generality,
assume that F(V M V T ) is a closed disk, D, centered at c with radius r. And because we know
that every value in F(V M V T ) has positive real part, we have that r < c.

Figure 4: The disk, D, which represents F(V M V T ). It is symmetric about the real line and is contained
strictly in the right half of the complex plane.

Now lets look at λF(U ). Because U is positive definite, F(U ) is just a closed interval of
positive real numbers, [κ0 , κ1 ]. So to summarize, for each λ = a + bi with a, b ≥ 0 we are
looking for an Fλ such that F > Fλ implies −λ2 ∈
/ F ([κ0 λ, κ1 λ] + D) where we define the
sum of two sets by: S1 + S2 = {s1 + s2 : s1 ∈ S1 , s2 ∈ S2 }
The distance of [κ0 λ, κ1 λ] + D to the origin can be no less than c − r and so we can find Fλ

32

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

such that
|λ|2 < Fλ (c − r)

(49)

Now we will show that we only need to consider λ in a bounded region. First note that for
λ = |λ|eiθ such that θ ∈ [0, π4 ], we have −λ2 = |λ|2 ei(2θ+π) with 2θ + π ∈ [π, 3π
] and so for all
2
F , −λ2 ∈
/ F ([κ0 λ, κ1 λ] + D).
Consider, λ = a + bi such that κ0 b > r, then [κ0 λ, κ1 λ] + D lies entirely above the real
axis, however, for all λ = a + bi such that a, b ≥ 0, −λ2 is in the lower half of the complex
plane. Thus we have a region, R, bounded by the imaginary axis, the ray θ =
z =x+

π
4

and the line

r
i.
κ0

Figure 5: The region, R, in the complex plane. For λ outside of this region, −λ2 ∈
/ F ([κ0 λ, κ1 λ] + D)
for all F > 0.

From (49), larger magnitude λ require larger Fλ . Consider λ0 = a + bi such that a = b and
33

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

b=

r
.
κ0

Then |λ0 | > |λ| for any λ in R and so can be used along with (49) to give an upper

bound, F0 , for {Fλ }
2

|λ0 | = 2
And so F0 =

2r2
κ20 (c−r)



r
κ0

2
< F0 (c − r)

is the desired bound for {Fλ }.

34

(50)

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

References and Notes
1. A. J. Lotka, Science Progress in the Twentieth Century (1919-1933) 21, 341 (1926).
2. V. Volterra, Nature 118, 558 (1926).
3. T. W. Schoener, The American Naturalist 122, 240 (1983).
4. D. Tilman, The American Naturalist 129, 769 (1987).
5. S. Marino, N. Baxter, G. Huffnagle, J. Petrosino, P. Schloss, Proc Natl Acad Sci (2013).
6. M. R. Gardner, W. R. Ashby, Nature 228, 784 (1970).
7. R. M. May, Nature 238, 413 (1972).
8. S. Allesina, S. Tang, Nature 483, 205 (2012).
9. J. Bascompte, P. Jordano, J. M. Olesen, Science 312, 431 (2006).
10. J. D. Farmer, Industrial and Corporate Change 11, 895 (2002).
11. A. G. Haldane, R. M. May, Nature 469, 351 (2011).
12. S. Suweis, P. D’Odorico, PloS one 9, e101851 (2014).
13. M. Bardoscia, S. Battiston, F. Caccioli, G. Caldarelli, Nature Communications 8, 14416
(2017).
14. R. M. May, S. A. Levin, G. Sugihara, Nature 451, 893 (2008).
15. R. MacArthur, Theoretical population biology 1, 1 (1970).
16. D. Tilman, Ecology 58, 338 (1977).

35

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

17. D. Tilman, The American Naturalist 116, 362 (1980).
18. D. Tilman, Resource Competition and Community Structure. (Mpb-17) (Princeton University Press, 1982).
19. W. M. Schaffer, Ecological monographs 51, 383 (1981).
20. P. Chesson, Theoretical Population Biology 37, 26 (1990).
21. P. Chesson, Annual Review of Ecology and Systematics 31, 343 (2000).
22. P. A. Abrams, The American Naturalist 174, 321 (2009).
23. J. P. O’Dwyer, Theoretical Ecology pp. 1–12 (2018).
24. S. Butler, J. P. O’Dwyer, Nature Communications 9, 2970 (2018).
25. A. Goyal, V. Dubinkina, S. Maslov, The ISME journal p. 1 (2018).
26. R. Marsland III, et al., arXiv preprint arXiv:1805.12516 (2018).
27. M. L. Rosenzweig, Science 171, 385 (1971).
28. G. A. Polis, W. B. Anderson, R. D. Holt, Annual review of ecology and systematics 28, 289
(1997).
29. S. J. Leroux, M. Loreau, Ecology letters 11, 1147 (2008).
30. M. W. Cadotte, C. M. Tucker, Trends in ecology & evolution 32, 429 (2017).
31. Y. Xiao, et al., Nature communications 8, 2042 (2017).
32. M. Droop, Journal of the Marine Biological Association of the United Kingdom 54, 825
(1974).
36

bioRxiv preprint doi: https://doi.org/10.1101/514018; this version posted January 8, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

33. M. A. Saito, T. J. Goepfert, J. T. Ritt, Limnology and Oceanography 53, 276 (2008).
34. W. S. Harpole, et al., Ecology Letters 14, 852 (2011).
35. J. F. von Liebig, Principles of agricultural chemistry: With special reference to the late
researches made in England (Walton & Maberly, 1855).
36. S. K. Gleeson, D. Tilman, The American Naturalist 139, 1322 (1992).
37. H. De Baar, Progress in Oceanography 33, 347 (1994).
38. E. Leigh, J Theor Biol 90, 213 (1981).
39. R. Lande, The American Naturalist 142, 911 (1993).
40. T. Fung, J. P. O’Dwyer, R. A. Chisholm, Ecological Complexity (2017).
41. R. Axelrod, W. D. Hamilton, Science 211, 1390 (1981).
42. P. D. Taylor, T. Day, Proceedings of the Royal Society B: Biological Sciences 271, 669
(2004).
43. J.-B. André, T. Day, Journal of theoretical biology 247, 11 (2007).

37

