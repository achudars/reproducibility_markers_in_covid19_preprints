bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

1

Avoiding potential biases in ses.PD estimations with the Picante software package

2

Rafael Molina-Venegas1

3

1. Institute of Plant Sciences, University of Bern, Altenbergrain 21, Bern 3013,

4

Switzerland.

5

Contact: rmolina@us.es

6

Running title: avoiding biases in ses.PD estimations

7

1

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

8

Abstract

9

1. Faith‚Äôs phylogenetic diversity (PD) is one of the most widespread used indices of

10

phylogenetic structure in the eco-phylogenetic literature. The metric became

11

notably popular with the publication of the function pd as part of the Picante R

12

package, which is nowadays a reference software for phylogenetic analyses.

13

2. Because PD is not statistically independent of species richness, the routine

14

procedure is to standardize the observed PD values for unequal richness across

15

samples. The function ses.pd, which is also implemented in the Picante R

16

package, is the reference function to conduct such standardization.

17

3. Unfortunately, I have detected an anomaly in the function that may result in biased

18

estimations of standardized PD values, particularly in communities with low

19

species richness (i.e. less than four species) and unbalanced phylogenies.

20
21

4. I conduct a simple simulation exercise to illustrate the issue and propose two
alternative and easy to implement solutions to go around the problem.

22
23

Keywords: Phylogenetic diversity; Picante; ses.pd; standardization.

24

2

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

25
26

Introduction
Faith‚Äôs phylogenetic diversity (PD; Faith, 1992), defined as the sum of all

27

branch lengths connecting taxa in a sample, is one of the most widespread used indices

28

of phylogenetic structure in the eco-phylogenetic literature. The metric became notably

29

popular with the publication of the function pd as part of the Picante software (Kembel

30

et al., 2010), which is nowadays a reference R package for phylogenetic analyses. The

31

pd function includes three arguments: (i) ‚Äúsamp‚Äù, a community data matrix (samples in

32

rows and species in columns), (ii) ‚Äútree‚Äù, a phylo tree object including all the species in

33

the community data matrix, and (iii) ‚Äúinclude.root‚Äù, which is a logical argument. If the

34

latter is set to TRUE (default = TRUE), then the PD of all samples in the community

35

data matrix will include the distance from the most recent common ancestor (MRCA) of

36

the species in each sample and the root of the supplied phylogeny (hereafter ‚ÄúMRCA ‚Äì

37

root‚Äù distance). Otherwise, the MRCA ‚Äì root distance is excluded from the

38

computations.

39

Importantly, PD is not statistically independent of species richness, and the

40

routine procedure is to standardize the observed PD values for unequal richness across

41

samples (see documentation for the pd function in Picante R package, Kembel et al.,

42

2010). Typically, the observed PD is compared to a null distribution of PD values

43

generated by shuffling species names across the phylogenetic tips a high number of

44

times (e.g. 999 times). The function ses.pd, which is also implemented in the Picante

45

software, is the reference function to conduct such standardization. In addition to the

46

arguments of pd, ses.pd includes multiple null models that can be used to generate null

47

distributions (the default model is ‚Äútaxa.labels‚Äù, which shuffles taxa labels across the

48

phylogenetic tips). Since ses.pd calls internally to pd, the user can specify if the MRCA

49

‚Äì root distance should be included in the calculation of the observed PD and the

3

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

50

corresponding null PD values. However, I have noted that ses.pd computes null PD

51

values without including the MRCA ‚Äì root distance regardless of the logical value that

52

is specified in the include.root argument. This is, if include.root = TRUE (default =

53

TRUE), the observed PD will include the MRCA ‚Äì root distance, but the null PD values

54

will not (see Supplementary Material). Unfortunately, this anomaly in the ses.pd

55

function may result in biased estimations of standardized PD values (hereafter

56

‚Äúses.PD‚Äù), particularly in samples with low species richness. This is because the lower

57

the species richness in the samples, the lower the probability for the phylogenetic

58

branches connecting species in the null samples to traverse the root node of the supplied

59

phylogeny, and therefore the higher the impact of excluding the MRCA ‚Äì root distance

60

from the computations when it should be included (i.e. when include.root = TRUE).

61

Here, I conducted a simple simulation exercise to illustrate this issue.

62
63

Materials and Methods

64

I simulated four different community data matrices with n = 50 samples (rows)

65

and m = 25, 50, 100 and 200 species (columns) respectively. Then, I used the function

66

pbtree implemented in Phytools R package (Revell, 2012) to simulate 500 pure-birth

67

phylogenies (root to tip distance scaled to unit) of m = 25, 50, 100 and 200 tips,

68

respectively (2000 phylogenies in total), representing the species in the community data

69

matrices. Finally, I simulated four different community datasets per community data

70

matrix (each community data matrix represents a different species pool) with fixed

71

species richness within datasets (i.e. equal row sums). To do so, I assigned n = 2, 4, 8

72

and 16 species, respectively, to each of samples in the community data matrices by

73

randomly picking species from the corresponding pools. For each dataset (16 in total), I

74

computed ses.PD values for the samples using 500 simulated phylogenies and the ses.pd

4

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

75

function as implement in Picante (Kembel et al., 2010, hereafter ‚Äúses.pd-Picante‚Äù). The

76

argument include.root was set to TRUE, and null distributions were generated using the

77

taxa.labels model and 999 randomizations. Then, I reanalyzed the data using a corrected

78

version of the ses.pd-Picante function that actually includes the MRCA ‚Äì root distance

79

in all the computations if the argument include.root is set to TRUE. Both functions are

80

identical in all other respects (see Supplementary Material). I used the same seed

81

(random number generator) to analyze the data with both functions. Finally, I compared

82

$
the ses.PD values derived from each function using cross-validation R-squared (ùëÖ"#
)

83

$
(Molina-Venegas, Moreno-Saiz, Castro, Davies, Peres-Neto & Rodr√≠guez, 2018). ùëÖ"#
=

84

$
1 indicates perfect match between ses.PD values obtained from both functions, and ùëÖ"#

85

$
< 1 indicates imperfect match. ùëÖ"#
varies from 1 to minus infinity. Since I used the

86

same seed to analyze the data with both functions, the randomization pattern was

87

$
preserved, and therefore ùëÖ"#
will be equal to 1 in case both functions yield identical

88

results. The R code to reproduce all the analyses along with the corrected version of the

89

ses.pd-Picante function is provided as Supplementary Material. All analyses were

90

conducted using Picante version 1.7 (latest version) and R version 3.4.3 (R Core Team.,

91

2017), yet results were the same regardless of the version of the package (the ses.pd

92

function was first implemented in Picante version 0.7-2 and delivered in CRAN R

93

repository in July 2009).

94
95
96

Results and Discussion
I found substantial mismatch between the ses.PD values derived from the ses.pd-

97

Picante function and its corrected version, particularly at low species richness and

98

regardless of the size of the species pool (Figs. 1 and S1 in Appendix 1). More

99

specifically, the ses.pd-Picante function yielded higher ses.PD values than expected (i.e.

5

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

100

above the 1:1 line) in the negative side of the distribution (Figs. 2 and S2 in Appendix

101

1). However, results derived from both functions rapidly converged following an

102

exponential trend as species richness increased (Figs. 1 and S1 in Appendix 1),

103

suggesting that the ses.pd-Picante function will introduce biases only when species

104

richness is very low (i.e. less than four species). Fortunately, such low-richness levels

105

are rare in natural communities, yet they are eventually reported along with their ses.PD

106

values (e.g. Mennes, Moerland, Rath, Smets & Merckx, 2015; Geedicke, Schultz,

107

Rudolph & Oldeland, 2016; Nowakowski, Frishkoff, Thompson, Smith & Todd, 2018).

108

On the other hand, some simulation analyses have also reported ses.PD values for

109

samples including only two species (e.g. Mazel et al., 2016), and diversity experiments

110

often include plots with very few species (e.g. Symstad et al., 2003).

111

Figs. 3 and S3 show that mismatches were more likely to occur with highly

112

unbalanced trees (i.e. those with internal nodes defining divergent lineages of unequal

113

size). This is because the higher the imbalance of the phylogeny, the lower the

114

probability for the phylogenetic branches connecting species in the null samples to

115

traverse the root node of the supplied phylogeny, and therefore the higher the impact of

116

excluding the MRCA ‚Äì root distance when it should be included. Given the unbalanced

117

nature of most real phylogenies, I conclude that future studies will avoid potential

118

biases in ses.PD estimations (particularly in communities with very low species

119

richness) by either removing the MRCA ‚Äì root distance from all the computations

120

conducted by the ses.pd-Picante function (i.e. setting the include.root argument to

121

FALSE) or using its corrected version if the MRCA ‚Äì root distance is to be included

122

(see Supplementary Material).

123
124

Acknowledgments

6

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

125

I thank the Scientific Computation Centre of Andalusia (CICA) for the computing

126

services they provided.

127
128

Supporting Information

129

Appendix 1. R code used for the analyses.

130
131

REFERENCES

132

Faith, D. P. (1992). Conservation evaluation and phylogenetic diversity. Biological

133
134

Conservation, 61, 1‚Äì10. doi:10.1016/0006-3207(92)91201-3
Geedicke, I., Schultz, M., Rudolph, B., & Oldeland, J. (2016). Phylogenetic clustering

135

found in lichen but not in plant communities in European heathlands.

136

Community Ecology, 17, 216‚Äì224. doi:10.1556/168.2016.17.2.10

137

Kembel,S.W., Cowan, P. D., Helmus, M. R., Cornwell, W. K., Morlon, H, Ackerly, D.

138

D., ‚Ä¶ , Webb, C. O. (2010). Picante: R tools for integrating phylogenies and

139

ecology. Bioinformatics, 26, 1463‚Äì1464.

140

Mazel, F., Davies, T. J., Gallien, L., Renaud, J., Groussin, M., M√ºnkem√ºller, T., &

141

Thuiller, W. (2016). Influence of tree shape and evolutionary time-scale on

142

phylogenetic diversity metrics. Ecography, 39, 913‚Äì920.

143

doi:10.1111/ecog.01694

144

Mennes, C. B., Moerland, M. S., Rath, M., Smets, E. F., & Merckx, V. S. F. T. (2015).

145

Evolution of mycoheterotrophy in Polygalaceae: The case of Epirixanthes.

146

American Journal of Botany, 102, 598‚Äì608. doi:10.3732/ajb.1400549

147

Molina-Venegas, R., Moreno-Saiz, J. C., Parga, I. C., Davies, T. J., Peres-Neto, P. R., &

148

Rodr√≠guez, M. √Å. (2018). Assessing among-lineage variability in phylogenetic

149

imputation of functional trait datasets. Ecography, 41, 1740‚Äì1749

150

doi:10.1111/ecog.03480

151

Nowakowski, A. J., Frishkoff, L. O., Thompson, M. E., Smith, T. M., & Todd, B. D.

152

(2018). Phylogenetic homogenization of amphibian assemblages in human-

153

altered habitats across the globe. Proceedings of the National Academy of

154

Sciences, 115, E3454‚ÄìE3462. doi:10.1073/pnas.1714891115

7

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

155
156
157
158

R Core Team (2017) R: a language and environment for statistical computing. R
Foundation for Statistical Computing, Vienna, Austria.
Revell, L. J. (2012). phytools: an R package for phylogenetic comparative biology (and
other things). Methods in Ecology and Evolution, 3, 217‚Äì223.

159

Symstad, A. J., Chapin, F. S., Wall, D. H., Gross, K. L., Huenneke, L. F., Mittelbach, G.

160

G., ‚Ä¶ Tilman, D. (2003). Long-term and large-scale perspectives on the

161

relationship between biodiversity and ecosystem functioning. BioScience, 53,

162

89‚Äì98. doi:10.1641/0006-3568(2003)053[0089:LTALSP]2.0.CO;2

163

8

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

164

Figure 1. Violin plot showing the cross-validation R-squared scores for the

165

comparisons between ses.PD values derived from the function ses.pd-Picante (Kembel

166

et al., 2010) and its corrected version. Analyses were conducted using datasets with

167

species richness = 2, 4, 8 and 16, respectively, 500 simulated phylogenies and a species

168

pool (community data matrix) of n = 25 species (see Fig. S1 in Appendix 1 for results

169

derived from community data matrices with n = 50, 100 and 200 species).

170

171
172

9

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

173

Figure 2. Scatter plots showing the relationship between ses.PD values (25,000 per

174

plot) derived from the function ses.pd-Picante (Kembel et al., 2010, y-axis) and its

175

corrected version (x-axis). Analyses were conducted using datasets with species

176

richness n = 2, 4, 8 and 16, respectively, 500 simulated phylogenies and a species pool

177

of 25 species (see Fig. S2 for results derived from species pools of 50, 100 and 200

178

species). The grey lines represent the expected 1:1 relationship.

179

180
181

10

bioRxiv preprint doi: https://doi.org/10.1101/579300; this version posted March 15, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

182

Figure 3. Relationship between cross-validation R-squared scores (y-axis) and tree

183

imbalance (i.e. Colless‚Äô index, x-axis). Analyses were conducted using datasets with

184

species = 2, 4, 8 and 16, respectively, 500 simulated phylogenies and a species pool of

185

25 species (see Fig. S3 for results derived from species pools of 50, 100 and 200

186

species). The higher the value of the Colless‚Äô index, the higher the imbalance of the

187

phylogeny (values scaled between 0 and 1).

188

189
190

11

