bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1

Hierarchical Domain Structure Reveals the Divergence of

2

Activity among TADs and Boundaries

3
4
5
6
7
8
9
10
11
12
13
14
15
16
17

Lin An1, Tao Yang1, Jiahao Yang2, Johannes Nuebler3, Guanjue Xiang1, Ross C. Hardison4, Qunhua
Li5*, Yu Zhang5*
1

Bioinformatics and Genomics program, Pennsylvania State University, University Park,

PA, 2Tsinghua University, Beijing, China, 3 Institute for Medical Engineering and Science,
Massachusetts Institute of Technology, Cambridge, MA, 4Department of Biochemistry and Molecular
Biology, Pennsylvania State University, University Park, PA, 5 Department of Statistics, Pennsylvania
State University, University Park, PA
*To whom correspondence should be addressed.

Email addresses:
LA: lua137@psu.edu; TY: txy146@psu.edu; JY: yangjh14@mails.tsinghua.edu.cn; JN:
jnuebler@mit.edu; RH: rch8@psu.edu; QL: qunhua.li@psu.edu; YZ: yzz2@psu.edu.

18

Abstract

19

The spatial organization of chromatin in the nucleus has been implicated in many aspects of

20

regulated gene expression. Maps of high frequency interactions between different segments of

21

chromatin have revealed Topologically Associating Domains (TADs), within which most of the

22

regulatory interactions are thought to occur. Recent studies have shown that TADs are not

23

homogeneous structural units, but rather they appear to be organized into a hierarchy. However,

24

precise identification of hierarchical TAD structures remains a challenge. We present OnTAD,

25

an Optimized Nested TAD caller from Hi-C data, to identify hierarchical TADs. Compared to

26

existing methods, OnTAD has significantly improved accuracy and running speed. Results from

27

OnTAD reveal new biological insights on the role of different TAD levels, boundary usage in

28

gene regulation, the loop extrusion model, and compartmental domains. The software and

29

documentation for OnTAD are available at: https://github.com/anlin00007/OnTAD

30
31

Background

32

Previous studies have shown that the human genome is spatially organized at different levels in

33

the nucleus, with each level of organization playing a role in gene regulation [1]. Starting with

34

the original Chromatin Conformation Capture (3C) assay [2] for measuring chromatin interaction

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

35

frequencies, many higher throughput, sequencing-based methods such as 4C, 5C, ChIA-PET,

36

Hi-C, and Hi-ChIP have been developed to measure 3D interaction frequencies at different

37

resolutions [3–8]. These maps of interaction frequencies between segments of chromatin are

38

interpreted in terms of chromatin structures. Among the methods, Hi-C [9] obtains measurement

39

of chromatin interaction frequencies across the entire genome. Within some local regions in a

40

genome, interactions are significantly higher than they are to adjacent regions; these highly

41

interacting regions are termed ‘Topologically Associating Domains’ (TADs) [10,11]. The proteins

42

CTCF and cohesin are frequently enriched at TAD boundaries, and they have been implicated

43

in the formation of an isolated local environment [11]. Furthermore, the positions of many TADs

44

are similar across different cell-types and even conserved between species [11,12]. As a result,

45

TADs have been widely interpreted as a basic architectural unit within which many gene

46

regulatory interactions occur. To date, several computational methods have been developed to

47

locate TADs in the genome. For example, Dixon et al. [11] developed a ‘Directionality Index’

48

based on the shift of interaction direction from upstream to downstream to estimate boundaries

49

of TADs. Other methods, such as TOPDOM [13] and Insulation Score [14], convert the TAD

50

boundary finding problem to a local minimum identification problem by calculating average

51

interaction frequency of surrounding regions at each locus.

52

While many earlier TAD calling methods treat TADs as a single structure, recent high-

53

resolution studies have shown that TADs contains internal substructures, with sub-TADs nested

54

within larger TADs [15–19]. Several recently developed TAD calling methods aimed to identify

55

nested TAD structures. For example, TADtree [15] identifies TADs based on a relationship

56

between the enrichment of contact frequency and TAD size, and assembles TADs into a TAD

57

tree that best fit the contact matrix. rGMAP [16] assumes that the interaction frequency in sub-

58

TADs is different from those in larger TADs, and applies a Gaussian Mixture model to identify

59

both types of TADs. Arrowhead [17] identifies corners of TADs at multiple sizes, allowing TADs

60

and subTADs to be detected simultaneously. 3D-Net [18] utilizes a maximization of network

61

modularity to identify TADs at different levels. And finally, IC-Finder [19] uses a hierarchical

62

clustering method to identify the TAD hierarchy.

63

Although the aforementioned methods provide useful tools for identifying TADs and their

64

internal substructure, we still lack comprehensive understanding of the functions of the

65

hierarchical structures within TADs. Recent work on low-resolution Hi-C data [20] has shown

66

that, at the large scale (> 1Mb), TADs can form a hierarchy of domains-within-domains

67

(“metaTAD”) through TAD-TAD interactions, and the successive levels of metaTAD organization

68

correlate with key epigenomic and expression features. This raises the natural question: do the

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

69

hierarchical levels within TADs also correlate with distinctive functional roles in chromosome

70

organization and gene regulation? However, most existing TAD callers focus on identifying the

71

locations of TADs and subTADs, rather than the hierarchical organization within TADs, making

72

them less suitable for investigating the biological functions of TAD hierarchy. Furthermore, many

73

existing callers are computationally inefficient for high-resolution Hi-C data and often lack a

74

principled approach to choosing algorithmic parameters [16]. These issues limit the utility of

75

existing TAD callers for investigating finer TADs structures using high-resolution data.

76

We present OnTAD, an Optimized Nested TAD caller that efficiently and robustly

77

uncovers hierarchical TAD structures from Hi-C data. Our approach first identifies candidate

78

TAD boundaries by scanning through the genome with a sliding window at a series of different

79

window sizes, using an approach inspired by TOPDOM [13]. Then, the candidate boundaries

80

are assembled into the optimized hierarchical TADs structures using a recursive dynamic

81

programming algorithm based on a scoring function. Our systematic evaluation shows that

82

OnTAD substantially outperforms existing TAD callers for both TAD boundary identification and

83

hierarchical TAD assembly. Using OnTAD, we uncovered novel insights on the potential

84

biological functions of TAD structures. In particular, we observed that active epigenetic states

85

are substantially more enriched in inner TADs than in outer TADs. OnTAD results revealed two

86

categories of TADs, those with or without hierarchical structures, that appear functionally distinct.

87

Compared to nonhierarchical TADs, the boundaries of TADs with hierarchical structures show a

88

higher CTCF enrichment, more active epigenetic states, and a higher level of gene expression.

89

In addition, we observed an apparent asymmetry in TAD boundary sharing, supporting the

90

asymmetric loop extrusion model for the formation of TADs [21]. Together, these results

91

demonstrate that OnTAD is a powerful tool for inferring different levels of chromatin organization

92

across a genome in high-resolution Hi-C data, which should facilitate improved investigations

93

into the roles of chromatin organization in gene regulation.

94
95

Results

96

The OnTAD algorithm

97

OnTAD takes a Hi-C contact matrix as the input and calls TADs in two steps. In the first step,

98

the method finds candidate TAD boundaries using an adaptive local minimum search algorithm

99

inspired by TOPDOM [13]. Specifically, it scans along the diagonal of a Hi-C matrix using a W

100

by W diamond-shaped window (Figure 1a), calculating the average contact frequency within

101

each window. The locations at which the average contact frequency reaches a significant local

102

minimum (1.96 standard deviations less than local maximum) are identified as candidate TAD

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

103

boundaries (see Methods). Because the sizes of TADs are unknown, OnTAD repeats the above

104

steps using a series of window-sizes, W= 1,2.,…,K, to uncover all possible boundaries for TADs

105

in different sizes. Here, K depends on the resolution of the Hi-C matrix and the maximum TAD

106

size that the user aims to call. For instance, for a 10kb resolution Hi-C matrix and a maximum

107

TAD size of 2Mb, K=2000/10=200. The union of the candidate boundaries of all window sizes is

108

used to assemble TADs in the next step (Figure 1b).

109
110

In the second step, OnTAD assembles TADs by selectively connecting pairs of candidate

111

boundaries using a dynamic programming algorithm (see Methods). To form a TAD between a

112

pair of boundaries, OnTAD requires the mean contact frequency within the potential TAD area

113

between the boundaries to exceed that of the surrounding area outside of the TAD by a user-

114

defined margin ( ); otherwise, no TAD is formed between the boundaries. The dynamic

115

programming algorithm is formulated to recursively identify the optimal partition of the genome

116

for yielding the largest rightmost subTADs within each identified TAD according to a score

117

function (Supplementary Figure 1) that de-convolutes the contact frequency signals across the

118

TAD hierarchy (Supplementary Figure 2). At the end of the recursive procedure, the optimized

119

solution that maximizes the score function is obtained (defined in Methods), producing a

120

hierarchical TAD organization that best fits the observed Hi-C contact matrix. The locations of

121

the identified TADs are provided to the users as a plain text file and a bedgraph file ready for

122

visualization on genome browsers.

123
124

Comparison with existing TAD calling methods

125

We compared OnTAD with four representative TAD calling methods (DomainCaller, rGMAP,

126

Arrowhead and TADtree) using the Hi-C data in GM12878 from Rao et al.[17]. Each method

127

was run using the settings recommended in its manual (see Supplementary file 1 for the version

128

and parameters for each method). All the evaluations were performed using 10kb resolution for

129

the normalized genome-wide Hi-C data, unless specified otherwise. We also tested OnTAD on

130

raw data, and the results obtained were similar to those observed for normalized data

131

(Supplementary Figure 9).

132
133

Accuracy of TAD boundary detection

134

We first evaluated the accuracy of TAD boundary detection using enrichment of architectural

135

proteins at boundaries as a reference for accuracy. CTCF is an architectural protein implicated

136

in formation of TAD structures [10]. Thus, we expect a high concentration of CTCF signal (from

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

137

ChIP-seq data) at accurately called TAD boundaries. We computed the average CTCF ChIP-

138

seq signal in the boundaries identified by each TAD calling method as well as their

139

neighborhood regions. As shown in Figure 2a (left panel), all methods showed enrichment of

140

CTCF signal in the identified TAD boundaries over that in the surrounding regions (fold change >

141

1.63). Among them, OnTAD had the highest CTCF enrichment (mean signal 1.22X greater than

142

that of the second highest method, T-test p-value = 1.91e-28). A similar result was obtained for

143

the enrichment of the RAD21 and SMC3 subunits of the cohesin complex, which are also key

144

components in the formation of TADs [21]. The boundaries identified by OnTAD showed a

145

higher enrichment than those identified by other methods (mean signal 1.14X and 1.04X greater

146

than that of the second highest method, T-test p-value = 9.34e-16 and 1.91e-12, respectively)

147

(Figure 2a middle and right panel). The stronger enrichment of CTCF and cohesin signals

148

suggests that OnTAD produces more accurate calls of TAD boundaries than the other methods.

149
150

Accuracy of TAD assembly

151

We next evaluated the accuracy of TAD calling. If TADs are accurately called, one would expect

152

that a high proportion of the variation in the contact frequencies in the Hi-C matrix is explained

153

by TAD calls. We developed a metric called TAD-adjR2, which is a modified version of the

154

adjusted R2 (see Methods), to measure the proportion of Hi-C signal variation explained by TAD

155

calls. Because contact frequencies decay over the genomic distance between a pair of

156

interacting loci, we stratified the contacts by their genomic distance and calculated TAD-adjR2

157

within each stratum. As shown in Figure 2b, OnTAD has a higher TAD-adjR2 than that of the

158

other methods across almost the entire span of genomic distances examined (0-1.5Mb)

159

(Average TAD-adjR2: OnTAD: 0.33, Arrowhead: 0.26, DomainCaller: 0.26, rGMAP: 0.23 and

160

TADtree: 0.06). This high level of explained Hi-C variance indicates that OnTAD produces a

161

better classification between TADs and non-TAD regions compared to other methods.

162
163

Reproducibility of TAD calls and boundaries

164

Another important criterion for TAD calling is the reproducibility of the identified TADs and their

165

boundaries. To measure the reproducibility of TAD boundaries, we calculated the agreement of

166

boundaries (Figure 2c-e) between two TAD calling results using the Jaccard index. To measure

167

the reproducibility of TADs, we treated each region covered by a TAD as a cluster of bins in the

168

genome, and then measured the agreement of cluster assignments between two TAD calling

169

results using the adjusted rand index (Supplementary Figure 3a-c). We evaluated the

170

reproducibility in three scenarios: 1) between biological replicates (GM12878, 10Kb) (Figure 2c,

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

171

Supplementary Figure 3a); 2) across different resolutions (5Kb, 10Kb, 25Kb) (Figure 2d,

172

Supplementary Figure 3b); and 3) at different sequencing depths (original sequencing depth

173

versus 1/4, 1/8, 1/16 and 1/32 of the total number of reads) (Figure 2e, Supplementary Figure

174

3c). As shown in Figure 2c-e and Supplementary Figure 3b, both the boundaries and the TADs

175

identified by OnTAD were fairly reproducible, consistently having either the highest or the

176

second highest Jaccard index or Adjusted Rand index in all scenarios.

177
178

Run time comparison

179

We recorded the run time of different methods on the same high-performance computing cluster

180

(Xeon E5-2680CPU and 72Gb RAM). OnTAD ran notably faster than all the other methods

181

(Supplementary Table 1). For example, it took OnTAD 655 seconds to analyze 10Kb resolution

182

data for the whole genome, which was 3X faster than Arrowhead, 24X faster than DomainCaller,

183

28X faster than rGMAP, and 263X faster than TADtree.

184
185

Level of TAD hierarchy is related to gene activity and epigenomic states

186

We systematically studied the biological features of the TAD hierarchy, again using the Hi-C

187

data in GM12878 from Rao et al.[17]. Overall, 75.7% of the genome was covered by the TADs

188

identified by OnTAD; the rest of the genome was not assigned to any TADs, and we refer to

189

these TAD-free regions as gaps. Among all TADs identified by OnTAD, the majority (92.2%)

190

contained or belonged to hierarchical structures, while a small fraction had no hierarchical

191

structure. We referred to the former as ‘hierarchical TADs’ or ‘nested TADs’, and the latter as

192

‘singletons’ (Figure 3a). We hypothesized that chromatin organized into these two types of

193

TADs may be playing distinctive roles in regulation, and thus we examined their association with

194

various epigenetic marks.

195
196

Boundaries of hierarchical TADs have a higher CTCF enrichment

197

We first compared the CTCF enrichment (see Methods) at the boundaries of the two types of

198

TADs. Indeed, the boundaries of hierarchical TADs were substantially more enriched with CTCF

199

signal than singleton boundaries (Figure 3b) (mean CTCF signals are 3.51 and 2.25,

200

respectively, T-test p-value = 1.52e-18). This enrichment of CTCF signal arose from a higher

201

average number of CTCF peaks at the boundaries of hierarchical TADs. The mean number of

202

CTCF peaks per boundary of a hierarchical TAD was 0.451, whereas it was only 0.181 for

203

boundaries of singleton TADs (T-test p-value = 4.52e-30).

204

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

205

Hierarchical TADs have a stronger association with active epigenetic states

206

Chromatin interactions are strongly associated with local, active epigenetic profiles [12,17, 22].

207

We thus expected to observe a positive association between the enrichment of active epigenetic

208

states and the levels of TADs. Starting with the 36 epigenetic states defined by IDEAS

209

segmentation [23] on 6 ENCODE cell lines, we evaluated the association between active

210

epigenetic states and TAD hierarchies. We classified hierarchical TADs into five levels, with

211

level one being the outermost TADs, level two being the immediate subTADs nested under one

212

layer of level one TAD, and so forth until level five, which contains the subTADs nested under

213

four or more layers of TADs in the hierarchy. We observed that the proportion of active

214

epigenetic states increase along the levels of TADs (Figure 3c, d). In contrast, singletons are

215

notably less active compared with hierarchical TADs (especially when level >2). In fact,

216

singleton TADs showed enrichments similar to those for the gap regions. A similar pattern of

217

enrichment for active states in hierarchical TADs was also observed in other cell types (K562

218

and HUVEC) (Supplementary Figure 4). Taken together, our results showed that hierarchical

219

TADs are on average more active than singletons; and within hierarchical TADs, inner TADs

220

(e.g., subTADs) are more active than outer TADs.

221
222

Hierarchical TADs have more active gene expression

223

We further investigated how gene expression is associated with TAD hierarchies. Using the

224

RNA-seq data of GM12878 from the ENCODE consortium (www.encodeproject.org) [24], we

225

defined expressed genes as those with FPKM > 5. Then within TADs at each level, we

226

computed the density of expressed genes (the number of expressed genes per bin, i.e., 10Kb

227

region). If a gene was covered by more than one TAD, we associated it with the innermost

228

TADs. We found that, as the TAD level increases, the density of expressed genes also

229

increases, i.e., genes are more frequently activated within inner TADs than outer TADs (ANOVA

230

test p-value of < 2.2e-16) (Figure 3e). Similarly, we observed the same trend of positive

231

association between density of expressed genes and the TAD level (ANOVA test p-value <

232

2.2e-16) in the K562 cell line (Figure 3f).

233
234

Shared TAD boundaries are asymmetric and more active than other boundaries

235

It has been reported that TAD boundaries are interaction hotspots [25]. We also observed that,

236

for TADs at all levels, the number of expressed genes and the enrichment of active epigenetic

237

states are significantly higher at the TAD boundaries than at the internal regions of TADs (all T-

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

238

test p-values < 0.001) (Supplementary Figure 5a&b). Thus we undertook an additional analysis

239

of TAD boundaries.

240

We observed that the boundaries of hierarchical TADs were frequently shared by

241

multiple TADs. We hypothesized that the boundary usage may play an important role in

242

maintaining hierarchical structures and regulating gene activities. To investigate this hypothesis,

243

we classified boundaries into five categories, according to the maximum number of TADs that

244

use a boundary on one of the two sides of the boundary (Figure 4a). A boundary is classified as

245

level one if it is used by no more than one TAD on either side, level two if it is used by exactly

246

two TADs on one side and less or equal to two TADs on the other side, and so forth to level five

247

if it is used by five or more TADs on either side. For example, a boundary shared by two TADs

248

to its left and three TADs to its right was classified as level three. The number of boundaries

249

assigned to each category is shown in Supplementary Figure 7.

250
251

Epigenetic and genomic profiles

252

We examined the enrichment of active epigenetic states at different boundary levels. We

253

observed a significant positive correlation between the enrichment (fold change) of active

254

epigenetic states and the number of times each boundary is shared (e.g., Tss state: Pearson

255

coefficient = 0.89; TssCtcf state: Pearson coefficient = 0.92) (Figure 4b). We further studied the

256

relationship between gene expression level and boundary sharing. Again, we observed a

257

significant positive association between the number of times a boundary was shared and the

258

gene expression level (ANOVA test p-value = 1.97e-05). In particular, the gene expression level

259

at the boundaries that were shared by 5 or more TADs was substantially higher than that at

260

boundaries that were shared by fewer TADs (Figure 4c). At a higher level boundary, multiple

261

genomic loci (the boundary plus the other ends of the TADs) must be in proximity in three-

262

dimensional space. This situation is reminiscent of chromatin hubs, and thus, we call the

263

boundaries shared by 5 or more TADs “hub-boundaries”. We posited that hub-boundaries are

264

more active in gene regulation than boundaries that are shared by fewer TADs.

265
266

The asymmetric loop extrusion model

267

Interestingly, we also observed some asymmetry in boundary usage and TAD formation in

268

hierarchical TADs. Specifically, we have observed (1) a significant difference in boundary usage

269

between the left and the right boundaries of the same outer TAD (Z-test p-value < 2.2e-16) and

270

(2) a significant difference in the numbers of TADs formed by a boundary on its left and right

271

sides (Z-test p-value < 2.2e-16) (Supplementary Table 2).

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

272

We therefore asked if the observed asymmetry is related to the mechanism of loop formation. A

273

recent study in yeast suggested that loops are formed in an asymmetric process, where the loop

274

extrusion complex anchors on one side and DNA reels through from the other side [26]. We

275

here hypothesize that loop extruders are preferentially loaded at or near a specific TAD

276

boundary. Then the asymmetric loop extrusion would start from this site on one end, and it

277

could stop at different sites on the other end. Thus, the TADs formed by multiple stops of loop

278

extrusion in this process would all share the anchor site as the boundary on one side, but each

279

has a different boundary on the other side, leading to the observed asymmetric boundary usage

280

(Figure 4d). Another recent study in Drosophila Schneider 2 (S2) cells showed that promoters

281

prefer to interact with enhancers downstream of the transcriptional unit [27], leading to a

282

directional preference in TAD formation. Indeed, as shown in Figure 4b, the boundaries shared

283

by multiple TADs are highly enriched with promoters, thus the observed orientation asymmetry

284

in TAD formation around these boundaries could reflect this interaction preference in promoters.

285
286

While some proteins (e.g. Ycg1 HEAT-repeat and Brn1 kleisin subunits) have been found to be

287

related to the anchor sites in yeast [28], little is known about the proteins supporting the anchor

288

sites in human. We therefore performed a transcription factor (TF) enrichment analysis using

289

161 TF ChIP-seq data from the ENCODE consortium [29–31]. By comparing the fold

290

enrichment of each TF signal in hub-boundary (level 5) with the ones at low level (level 1), we

291

found a group of TFs that were highly enriched in hub-boundaries (Fold Change > 2 in either

292

GM12878 (n = 8) or K562 (n = 37)) (Figure 4e). These hub-boundary-enriched TFs were

293

strongly associated with chromosome organization function in Gene Ontology Analysis (FDR =

294

1.33e-06). They were also shown to be highly connected (p-value < 1.0e-16) in the protein-

295

protein interaction database, STRING (Supplementary Figure 7), suggesting that they may

296

potentially form a protein complex. Together, these results suggest that the enriched TFs may

297

play an important role in forming the anchor sites in the asymmetric extrusion process.

298
299

Hierarchical TAD calling unveils distinct epigenetic features of inner TADs

300

It has been reported that genomic loci within the same TADs tend to possess similar epigenetic

301

features [22], while loci in different adjacent TADs may show different epigenetic features [17].

302

However, it remains unclear if the divergence of epigenetic profiles also takes place at the

303

subTAD level. To explore the possible answer to this question, we performed OnTAD on Hi-C

304

data from the mouse G1E-ER4 cell [32]. We observed that the majority of TADs (87.1%) are in

305

active compartments. As shown in the OnTAD genome browser track in Figure 5, the region of

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

306

(chr19:11.3Mb – 12.2Mb) contains multiple nested TADs. Among them, two adjacent subTADs

307

(11.8Mb – 11.9Mb and 11.9Mb – 12.0Mb) that belong to the same outer TAD (chr19: 11.5Mb –

308

12.0Mb) exhibit distinct epigenetic features, with enriched repressive epigenetic signal

309

(H3K27me3) in the left subTAD and enriched active epigenetic signal (H3K27ac, H3K4me3 and

310

H3K36me3) in the right subTAD. This demonstrates that, although TADs were traditionally

311

considered to be a fundamental unit of chromatin organization, epigenetic features can be

312

distinctively different between subTADs. Our results show that the subTADs identified by

313

OnTAD better represent homogeneous units associated with epigenetic functions, capturing

314

distinct functional features within subTADs. By identifying these subTADs, OnTAD enables a

315

finer investigation of the hierarchy of chromatin organization and its functionally homogeneous

316

structures.

317
318

Interestingly, we observed that whereas the outer TAD (11.8Mb – 12.0Mb) had clear CTCF

319

signals at its boundaries, the shared boundary between the two subTADs (11.8Mb – 11.9Mb

320

and 11.9Mb – 12.0Mb) had no CTCF signals from the CTCF ChIP-seq data. This indicates that

321

the formation of these two subTADs is probably independent of CTCF. Furthermore, we

322

performed a high-resolution compartment analysis (See Methods). It showed that the two

323

subTADs fall in different compartments. These results can be interpreted within the framework

324

of recently proposed ‘compartmental domains’ [33,34], which are hypothesized to be formed by

325

A/B compartment without the involvement of CTCF. We will discuss this mechanism further in

326

the discussion.

327
328

Discussion

329

While hierarchical structures in TAD formation have been reported [15,16,18,19], the

330

involvement of these hierarchies in gene regulation mechanisms remains poorly understood.

331

This is partly due to the lack of a method that systematically identifies TAD hierarchies from Hi-

332

C data and investigates the association of TAD hierarchies with epigenetic features. Here we

333

introduce OnTAD, a new method to uncover the hierarchical TAD structures from Hi-C data.

334

Based on a dynamic programming procedure that recursively finds the best domain partition of

335

Hi-C contact matrix in a hierarchical manner, OnTAD identifies the hierarchy of TADs and their

336

boundaries. It produces a convenient output for visualizing the hierarchy in a genome browser,

337

greatly facilitating the investigation of the interplay between hierarchical TADs and other

338

epigenetic features in gene regulation. Our comprehensive evaluation shows that OnTAD

339

substantially outperforms the existing TAD calling methods in both accuracy and computational

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

340

efficiency. These results demonstrated the effectiveness of OnTAD for identifying TAD

341

hierarchies and investigating their biological functions.

342
343

Using the results from OnTAD, we investigated how hierarchies within TADs were associated

344

with features related to function. In particular, we observed that, on average, hierarchical TADs

345

were significantly more active than TADs without hierarchies (i.e. singletons). The active

346

epigenetic states and active genes were also significantly more enriched in the boundaries

347

shared by multiple TADs (e.g. hub-boundaries) than those used exclusively by a single TAD.

348

These observations echo those on the hierarchy of metaTADs, which also showed a positive

349

association between the enrichments in promotor activity and gene density and boundary usage

350

[20]. Interestingly, we also observed a significant asymmetry in boundary usage between the left

351

and right boundaries in the hierarchical TADs and an asymmetry in the orientation of TAD

352

formation around hub-boundaries, supporting the asymmetric loop extrusion model [26] and

353

preferential orientation of promoter interaction [27].

354
355

Our results pose several interesting questions about the mechanisms utilized to form these

356

structures. First, how are these hierarchical TADs structures formed? Are they produced by

357

hierarchical chromatin folding in single cells, or does the nesting reflect a collection of different

358

interaction patterns in individual cells that looks like a hierarchy when the data from a population

359

of cells is aggregated in bulk cell Hi-C data? Single-allele chromatin interactions do reveal

360

regulatory hubs [35], supporting the interpretation that these complex interactions occur in

361

individual cells. A recent single-cell analysis of high-throughput Oligopaint labeling and imaging

362

on Chr21 of A549 cell, showed that both TAD and sub-TAD structures exist in single cells [36].

363

Furthermore, nested TAD structures could be formed by multi-site interactions in a single cell

364

[36]. However, as acknowledged by the authors, it is still possible that some other domain

365

structures resulted from population averaging. In principle, OnTAD can also be applied to

366

single-cell Hi-C data to explore this question. However, the genome coverage in current single-

367

cell Hi-C data is still low and can only support the analysis at the resolution of ~100Kb, limiting

368

the detection of finer domain structures (typically ~50Kb for subTADs we identified). Future

369

studies with higher resolution single-cell Hi-C data will be valuable for addressing this question

370

at a genome-wide scale.

371
372

Second, what are the mechanisms to form the hierarchical structures? As observed in our

373

analyses (Figure 5), though the majority of the outer TAD boundaries were bound by CTCF,

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

374

some subTADs appear to be formed without CTCF binding at their boundaries. The formation

375

of the latter can be explained by the recently proposed ‘compartmental domains’ mechanism

376

[34], which forms domains by establishing A/B compartments without the involvement of CTCF

377

or loop extrusion. Because OnTAD does not rely on CTCF information for TAD identification, it

378

can capture all domain structures, regardless the formation mechanisms. The example in Figure

379

5 could be explained by joint processes of loop extrusion (for the outer TAD) and establishment

380

of ‘compartmental domains’ [34] for the inner TADs.

381
382

In summary, we have demonstrated that the hierarchies of TAD structures are

383

associated with gene regulation and have provided a powerful tool for exploring this association.

384

Though previous results based on low-resolution data suggest that the majority of TAD

385

structures are conservative across cell lines [11], recent analyses found that certain locally

386

frequent interaction regions within TADs are cell type specific [25]. It will be particularly

387

interesting to use OnTAD to systematically investigate how the finer domain structures within

388

TADs differ across cell types, for example, how the levels of hierarchy differ across cell types,

389

and how the changes in hierarchy are associated with differential gene regulation. The

390

biological insights generated by analyses of the finer domain structures should help improve our

391

understanding of the role of chromatin conformation in gene regulation.

392
393
394

Methods

395

Notations and data preprocessing

396

Let X denote a symmetric Hi-C matrix, where each entry (i,j) in the matrix is a value quantifying

397

the strength of the chromatin interaction of between bins i and j. The Hi-C matrix can be raw

398

contact matrix or the normalized matrix produced by the normalization procedures such as ICE

399

[37] and KR [17]. Let X[a:b, c:d] = {(i,j): a ≤ i ≤ b, c ≤ j ≤ d} denote a sub-matrix of X. A candidate

400

TAD between bins a and b corresponds to a diagonal block matrix X[a,b]=X[a:b, a:b], where the

401

mean of the entries in X[a,b] is expected to be higher than that in its neighboring matrices.

402

Because of the distance dependency in Hi-C data, i.e., the dependence of contact frequency on

403

the proximity of the interaction loci, we normalize the Hi-C matrix before TAD calling by

404

subtracting the mean counts at each distance.

405
406

Identification of candidate TAD boundaries

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

407

We identify candidate TAD boundaries using a procedure motivated from the TOPDOM method

408

[13]. This procedure scans the diagonal of the Hi-C matrix, using a sliding square submatrix

409

whose bottom corner locates on the diagonal (Figure 1a), and computes the mean Hi-C signals

410

covered by the submatrix at each location, which is the TOPDOM statistic in [13]. As shown in

411

[13], when the corner of the submatrix lands on a TAD boundary, the TOPDOM statistic reaches

412

a local minimum. Thus, the local minimums of the TOPDOM statistic can be used as candidate

413

boundaries. The original TOPDOM paper only computed the statistics at a fixed window size. To

414

identify all candidate TAD boundaries for TADs in different sizes, the TOPDOM statistics are

415

calculated at all window sizes (W), ranging from 1 to a maximum TAD size (d) specified by

416

users. Here, we set the minimum size =3 bins, because structures smaller than 3 bins are too

417

small to form a domain. We set the maximum size=200 for 10kb Hi-C data, because TADs are

418

known to be smaller than a few Mbs.

419

For each window size W, we first obtained a set of local minimums of the TOPDOM statistics,

420

which are defined as the smallest value in the neighborhood of [i-Lsize, i+Lsize]. To reduce

421

false positives due to noise, the local minimums that are not significantly smaller than the local

422

maximums in the same neighborhood are pruned. Here we required the local minimums to be at

423

least 1.96S smaller than the local maximums to be qualified as a candidate boundary, where S

424

is the standard deviation of the TOPDOM statistic in the entire matrix. The parameter 1.96 is

425

chosen based on the 95% confidence level of a normal distribution, which reasonably

426

approximates the distribution of TOPDOM scores.

427

Figure 1b shows examples of the local minimums on the genome at different window sizes.

428

Because different window sizes capture the information of TADs in different sizes, we took the

429

union of the pruned local minimums over all window sizes, and used the corresponding bins as

430

candidate TAD boundaries. We selected z according to the procedure described in the section

431

of Parameter Selection. For all the analyses in this work, we used Lsize = 5. It can be adjusted

432

by users.

433
434

Recursive TAD calling algorithm

435

We developed a TAD calling algorithm to assemble TADs from the candidate boundaries.

436

Several issues need to be considered in the design of the algorithm in order to produce

437

biologically meaningful TADs. First, because a region may be shared by multiple TADs, the

438

scores of these TADs can be strongly correlated. Second, in the TADs with nested structures,

439

the scores of the TADs and their nested sub-TADs are convoluted. Third, some boundaries may

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

440

be shared between TADs. Last, the algorithm needs to be computationally efficient to call TADs

441

in the genome scale.

442

To address these issues, we developed a recursive algorithm to identify the TADs that give the

443

optimal partition of the genome according to a scoring function g(X) related to the strength of Hi-

444

C signals (see the next section). Our algorithm assumes that any given two TADs are either

445

disjoint (but can share one boundary) or nested (i.e. one TAD is completely within the other).

446

This assumption is required for the dynamic programming to find an optimal solution in

447

polynomial time. While this assumption sometimes may not be true, it greatly reduces the

448

complexity of the problem while still enabling us to 1) de-convolute nested TAD structures, 2)

449

impose shared boundaries, and 3) obtain an efficient algorithmic solution. Our evaluation

450

showed that the majority of the genome follows this assumption (see the subsection below).

451

Even when it is violated, i.e., the boundaries of the TADs cross each other, our method can still

452

produce a reasonable approximation (Supplementary Fig.1C).

453

Briefly, the algorithm works as follows. Given a matrix X[a,b], the algorithm starts at the root level

454

to first find the best bin i (a≤i<b) to partition the matrix into two submatrices, X[a,i] and X[i,b], such

455

that X[i,b] is the largest right-most TAD in X[a,b]. Since X[a,i] and X[i,b] are disjointed, the TADs

456

within each submatrix can be called separately in a recursive manner. At each recursive step,

457

the parent matrix is partitioned into two sub-matrices, and TADs are called within each sub-

458

matrix using the same recursive formula (Supplementary Fig.2A). The recursion stops when i=a,

459

i.e., the sub-matrix X[a,i] contains no TAD. After a recursive step is completed, it identifies the

460

best TADs in the current branch according to the scoring function, de-convolutes the TAD

461

signals in the parent matrix by removing signals of inner TADs, and evaluates if the parent

462

matrix itself is a TAD. This process is repeated until the recursion returns to the root level

463

(Supplementary Fig.2B). Note that, because every TAD is the largest right-most TAD of a parent

464

matrix in a recursive branch, this recursive procedure guarantees to traverse all TADs, even

465

though only the largest right-most TAD is called at each step.

466
467

Evaluation of the violation of the hierarchical TAD assumption

468

To investigate the frequency of the violation of the hierarchical TAD assumption, we ran OnTAD

469

on high resolution (10Kb) in-situ Hi-C data in GM12878. We segregated regions around the

470

corner of each TAD into four 5*5 quadrants and calculated the average contact frequency of

471

each quadrant (Supplementary figure 8). If this assumption holds, the interaction frequency is

472

expected to be high in the quadrant within TAD (quadrant 1) and relatively low in at least one of

473

the two quadrants (2 & 3) on the two sides outside of TAD corner. As shown in the

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

474

Supplementary figure 8, the mean frequency patterns of the four quadrants for most of the TAD

475

corners are consistent with our expectations. This suggests that this assumption holds for a

476

majority of the genome. The violation can be remedied by removing the signals from the called

477

TADs and then rerunning OnTADs on the de-clumped Hi-C data to identify additional TADs.

478
479

The scoring function

480

Our scoring function  ,  for matrix X[a,b] is defined as

481

 ,   

0


max 0,  ,    , 



   1, … ,   1

(1)

482

where  ,    ,   Δ , |sub TADs

483

Here,  ,  is the score of TADs within X[a,b], not including the score for X[a,b] itself being a

484

TAD. It is calculated by finding the best left boundary of the largest right-most TAD in X[a,b].

485

 ,  is the score of the largest right-most TAD in X[a,b]. It is the sum of the score of TADs

486

within  , and the score of  , itself being a TAD, namely Δ , sub TADs . For any

487

diagonal block matrix to be called a TAD, its mean signal is required to be greater than the

488

means of its neighboring regions on both sides. We therefore define

489
Δ , |!" TADs
 # , |sub TADS$
'''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''
%i:b, i#b-i+1$: b#b-i+1$$& 
% i‐-#b-i+1$: b-#b-i+1$$,i:b&, 
 max

490
491

where m(X[i,b]|sub TADs) denotes the mean of X[i,b], excluding the TADs within X[i,b], returned by

492

the

493

( i--b-i+1: b-b-i+1$,i:b) and (i:b, ib-i+1:

494

diagonal matrices in the adjacent flanking regions of X[i,b]; and finally, and ' denotes the mean

495

of X. We note that Δ , |!" TADs is calculated based on the TADs returned from # , $.

496

That is, we do not directly optimize  ,   Δ , |!" TADs. The parameter

497

threshold for TAD calling. That is, a TAD will be called only when the mean contact frequency

498

within the potential TAD area between the boundaries exceeds that of the surrounding area

499

outside of the TAD by the margin of . The procedure for selecting

500

Selection.

recursion;

is

a

user-specified

nonnegative
bb-i+1$)

penalty

parameter

;

are two (b-i+1)-by-(b-i+1) off-

serves as a

is described in Parameter

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

501

When the score of a candidate TAD is <0, it is likely not a real TAD. We therefore set a lower

502

bound on the score at 0 and do not output the “TAD” with a score 0.

503
504

Parameter Selection

505

We selected the value of

506

The FDR is calculated as follows. First, the entries in the real Hi-C matrix are permuted within

507

each genomic distance. This results in a null Hi-C matrix that has the same marginal signal

508

distribution as the original Hi-C matrix but without biologically meaningful TAD structures. Next,

509

OnTAD is run on both the original and the permuted Hi-C matrix for a series of . The TADs

510

identified from the original Hi-C matrix are treated as ‘discoveries’ (R), which is a mixture of

511

false and true discoveries, and those from the permuted Hi-C matrix are treated as ‘false

512

discoveries’ (V), which is used to approximate the proportion of false discoveries in R. Recall

513

that OnTAD assigns each TAD a score according to the scoring function (1). Given a TAD size,

514

the magnitude of the score reflects the strength of evidence to call TAD. Because larger TADs

515

tend to have a lower mean contact frequency after removing their inner TADs, the score is

516

usually smaller for larger TADs. Therefore, we computed the FDR accounting for TAD size.

517

Specifically, for a given value of , the identified TADs are first stratified by their sizes and

518

scores. Let n be the total number of TADs identified on the original matrices, and * and + be

519

the numbers of TADs in the

520

respectively. Then if a TAD (j) is in the th stratum, the probability for the TAD to be a false

521

discovery (a.k.a. local false discovery rate [38] is

based on the False Discovery Rate (FDR) of TADs identification.

th stratum from the original and the permuted matrices,

522

,  min # ೔ , 1)

523

The overall FDR for the TAD identification is computed as the average of the probability to be a

524

false discovery over all TADs identified on the original matrix, based on the relationship between

525

local fdr and FDR [38]:



೔

/0* 

∑

,

526

2
The above FDR calculation is repeated for each value of , and the

527

cutoff of 0.05 is selected.

528

In our analysis, the stratum is formed by dividing the TAD calls into 25 equal shares according

529

to the ranking of TAD size (or TAD score, respectively) on the real matrix. This leads to

530

25*25=625 strata in total. As shown in Supplementary table 3, the FDR is close to 0.05 at λ =

531

0.1 for GM12878 dataset (10kb). To test the robustness of the tuned parameter, we also

532

performed the same procedure on the mouse G1E-ER4 Hi-C data from Hsu et al. [32] at 10Kb

corresponding to the FDR

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

533

resolution. The FDR was also controlled at the 0.05 level when λ = 0.1 (Supplementary table 4).

534

Therefore, we used λ = 0.1 as the default value in our analyses. In the OnTAD software, we

535

allow users to specify the value of λ to offer more flexibility.

536

Another important tuning parameter is Lsize, which is the span of the interval (i.e. the interval

537

size = 2*Lsize +1) for searching local minimums of the TOPDOM statistics. This parameter

538

affects the selection of candidate boundaries. If Lsize is too large, some potential boundaries

539

will be missed. If Lsize is too small, the candidate boundary set may include many false

540

positives, increasing the computational burden for the assembly step and the quality of final

541

results. We chose Lsize in the similar way as for choosing

542

Specifically, we ran OnTAD for different values of Lsize (range=3-10), corresponding to the

543

interval size of 7-21 bins. We chose this range because it is sufficient to cover various TAD

544

sizes. As shown in Supplementary table 5, Lsize=5 (i.e. interval size=11) renders an FDR close

545

to 0.05. Therefore, we chose Lsize=5 for all analyses. To evaluate the robustness of this choice,

546

we evaluate the similarity of the identified TAD structures between Lsize=5 and Lsize=6-10, and

547

found that they are similar, with the median of the adjusted rand indices >0.75 (Supplementary

548

figure 10). It indicates the result is relatively insensitive to the value of Lsize when Lsize=5~10.

on GM12878 data (10kb).

549
550

Computation complexity of the TAD calling algorithm

551

We performed an analysis on the computational complexity for our recursive algorithm. For an

552

lxl Hi-C matrix, if all bins are potential boundaries, then the recursion needs to visit l(l+1)/2

553

diagonal block sub-matrices. As there are l size 1 diagonal block matrices, the computation

554

complexity for computing the scores of all size 1 matrices is O(l). Given the scores of size 1

555

matrices, we can calculate the scores of size 2 matrices. There are (l-1) of them, each

556

enumerating through (2-1) partitions. Hence the time complexity is O((2-1)(l-1)). Following the

557

same calculation, the scores of one sub-matrix of size k will be computed by enumerating (k-1)

558

partitions. As there are (l-k+1) of them, the time complexity is O((k-1)(l-k+1)). Similar calculation

559

can be done for the mean of sub-matrices. As a result, the total complexity to obtain the scores

560

of all sub-matrices from size 1 to l is O(l3).

561

Empirically, the computational complexity is much lower than the above due to some further

562

reductions. First, because potential TAD boundaries are limited to the TOPDOM local minimums,

563

this substantially reduces the number of partitions from O(l3) to O(m3), where m is the number of

564

candidate boundaries. Second, because TADs usually are smaller than 2Mb, the maximum TAD

565

size to be called (d) typically is much smaller than l. This constraint effectively reduces the time

566

complexity of our algorithm from O(m3) to O(md2). Furthermore, because TADs usually are

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

567

formed between neighboring boundaries, we set a constraint in the recursive procedure to limit

568

the TADs to be formed only between candidate boundaries that are no more than five neighbors

569

apart.

570
571

TAD-adjR2 for assessing accuracy of TAD calling

572

Because TADs are regions with frequent local interactions, a reasonable TAD caller is expected

573

to classify the regions with high contact frequencies as TADs and the regions with low contact

574

frequencies as non-TADs, i.e. gaps between TADs. At any given genomic distance, the

575

variation between Hi-C signals should be largely explained by the classification of TADs. How

576

well the variation can be explained by the classification of TADs can reflect the accuracy of TAD

577

calling. Based on this intuition, we developed a metric similar to the R-square in regression

578

models to evaluate the accuracy of TAD calling. Let 3 denote the contact frequency of the th

579

bin, n denote the number of bins at the same genomic distance as this bin, p denotes the

580

number of called TADs whose sizes are greater than or equal to the genomic distance. For bins

581

within TAD,

582

TAD, excluding regions covered by higher level TADs. For those bins not in any TADs,

583

average of contact frequency in the gap region at that genomic distance. And

584

overall mean contact frequency across all the bins at a given genomic distance. For each

585

genomic distance, the TAD-adjR2 is defined as

^

denotes the average contact frequency at given genomic distance within that

^




1
  1∑
 1
1
  1∑











^

^

is the

 denote the





 



586

This quantity essentially measures the proportion of variance in Hi-C signal that is explained by

587

the classification of TADs, adjusting for the number of TADs and genomic distance.

588
589

Enrichment of expressed genes

590

To evaluate the activity of gene expression, we downloaded the RNA-seq data from ENCODE

591

(See Data), merged the biological replicates of RNA-seq data, and computed the average

592

FPKM for each gene. Genes with FPKM > 5 were deemed as expressed genes. For each TAD

593

level, we compute the density of expressed gene as the number of expressed genes per 10Kb.

594

For TADs with nested structures, genes covered by the inner level TADs are excluded in the

595

calculation of gene density for outer TADs.

596
597

Enrichment of CTCF or cohesin protein signals

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

598

To compute the enrichment of CTCF (or cohesin protein) signals at the identified boundaries

599

and their surrounding regions, we computed the average CTCF (or cohesin proteins) signals

600

from ChIP-seq data at the identified boundaries and the bins within their 10bins flanking regions.

601

The processed signals in bigwig file was used in this process.

602
603

Epigenetic state enrichment

604

We downloaded the IDEAS segmentation (see Data), which segments the genome into 36

605

epigenetic states based on 10 epigenomic marks [23]. We used it to evaluate the enrichment of

606

epigenetic state in the identified (sub)TADs and boundaries. Let ni denote the total number of

607

200bp windows that have IDEAS-assigned epigenetic states at a TAD boundary i, and 

608

denote the number of 200bp windows annotated as state s at a TAD boundary i. For a given

609

state s, its enrichment in a set of M boundaries is computed as

  

,

∑  1
 ∑  1
,







610

where  is the proportion of state s in the whole genome. The 1’s in the formula of E(s) are

611

added to avoid dividing by 0.

612
613

A/B compartments calling

614

We used CscoreTool [39] to infer A/B compartments from mouse G1E-ER4 Hi-C data (10Kb

615

resolution, default parameter). The A/B compartments is determined by correlation coefficient

616

between compartment score and ATAC-seq signal. If a positive correlation coefficient is

617

observed, then regions with score>0 are in compartment A. Otherwise, if the correlation

618

coefficient is below 0, the regions with score < 0 are in compartment A. We reversed the

619

compartment scores on the chromosomes that has correlation coefficient < 0. Thus,

620

compartment A is shown with positive score and compartment B is shown with negative score.

621
622

Data

623

Hi-C data: The human Hi-C data is obtained from Rao et al. 2014 (GEO accession number:

624

GSE63525). Among them, three cell types (B-lymphoblastoid cells (GM12878), umbilical vein

625

endothelial cells (HUVEC) and erythrocytic leukemia cells (K562)) were included in this study.

626

The normalized (by Knight-Ruiz balancing method) Hi-C matrices at 5Kb, 10Kb and 25Kb

627

resolutions were used in this study. The mouse Hi-C data is obtained from Hsu et al. 2017

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

628

[32](GEO accession number: GSE95476). The 10Kb raw Hi-C matrices from G1E-ER4 and two

629

Brd2 knockouts were used in this study.

630
631

Transcriptomic data: The gene expression data were downloaded from the ENCODE project

632

(https://www.encodeproject.org/). The processed signal (FPKM) was used to measure the

633

expression activity.

634
635

Epigenomic data: The histone modification data were downloaded from the NIH Roadmap

636

Epigenomics project (http://www.roadmapepigenomics.org/), including H2A.Z, H3K27ac,

637

H3K27me3, H3K36me3, H3K4me1, H3K4me2, H3K4me3, H3K79me2, H3K9ac, H3K9me3 and

638

H4K20me1. The ChIP-seq data of CTCF and cohesin protein (Rad21 and Smc3) were

639

downloaded from ENCODE project (https://www.encodeproject.org/). The downloaded data

640

were in BigWig format. The ‘bigWigAverageOverBed’ was used to segment signal into windows

641

according to the resolution of Hi-C data. The mouse ChIP-seq data were downloaded from the

642

VISION project (http://www.bx.psu.edu/~giardine/vision/).

643
644

Epigenetic states: The IDEAS segmentation of the 6 ENCODE cell type/tissues (GM12878,

645

H1h-ESC, Hela-S3, HepG2, HUVEC, K562) was downloaded from (http://main.genome-

646

browser.bx.psu.edu/). The 36-state IDEAS model trained on 10 marks (H3K4me1, H3K4me2,

647

H3K4me3, H3K9ac, H3K27ac, H3K27me3, H3K36me3, H3K20me1, PolII and CTCF), as well

648

as DNase-seq and Faire-seq, was applied to this study.

649
650

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

651

Figure Legends

652

Figure 1 | Overview of the OnTAD pipeline. a, OnTAD uses a sliding diamond-shaped

653

window to calculate the average contact frequency within the window at each locus on the

654

genome. The five loci marked by letters ‘a’-’e’ are examples being evaluated as potential TAD

655

boundaries, with ‘d’ being a clear false positive. b, Identification of candidate TAD boundaries in

656

OnTAD. Blue curve: the average contact frequency of the diamond-shaped windows, calculated

657

at different window sizes (W) and different loci. Red arrows: the location of significant local

658

minimums of the average contact frequency, i.e. candidate TAD boundaries. c, OnTAD

659

assembles candidate boundary pairs using a Dynamic Programming algorithm (see methods) d,

660

Visualization of the final output from OnTAD. In the genome browser, the identified hierarchical

661

TAD is displayed as a series of horizontal bars, where each (sub)TAD is represented as a

662

horizontal bar colored according to its TAD level.

663
664

Figure 2 | Evaluation of TAD calling methods. a, Average ChIP-Seq signal at TAD

665

boundaries and surrounding regions (+/- 10 bins) (from left to right, CTCF, SMC3 and RAD21).

666

b, Proportions of Hi-C signal variability explained by the called TADs (measured by TAD-adjR2)

667

at different genomic distance between two interacting loci. (Average TAD-adjR2: OnTAD: 0.33,

668

Arrowhead: 0.26, DomainCaller: 0.26, rGMAP: 0.23 and TADtree: 0.06). c-e, Reproducibility of

669

TAD boundaries (Jaccard index): c, between two biological replicates (GM12878, 10Kb) d,

670

between resolutions (5Kb vs 10Kb) and (10Kb vs 25Kb). e, across different down sampled

671

sequencing depths (GM12878, original vs 1/4, 1/8, 1/16 and 1/32 of the original sequencing

672

depth, raw data was used). Note: TADtree was not included in d, because it has difficulty

673

handling data with 5Kb resolution due to its large memory consumption. It also has difficulty for

674

chr1-3 at 10Kb resolution either. Thus these three chromosomes were excluded for all TAD

675

callers in all comparisons.

676
677

Figure 3 | Hierarchical TADs are more active than singletons. a, An illustration of

678

hierarchical levels of TADs. The levels are assigned from external to internal. The TADs

679

covered by cyan dash line are assigned to level 1, by blue dash line are assigned to level 2, by

680

orange dash line are assigned to level 3, and singletons are also assigned to level 1 (cyan). b,

681

mean CTCF signal at the boundaries specific to hierarchical TADs (light green), specific to

682

singletons (cyan), and shared between hierarchical TADs and singletons (orange). The

683

boundaries of hierarchical TADs have the highest enrichment of CTCF signal. c-d, Enrichment

684

of epigenetic states at the regions covered by different levels of TADs. The enrichment (fold

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

685

change) of active states (marked in orange in c) increases as the TAD level increases. The

686

trend is visualized for the states of Tss, Enh and PromCtcf in d. The whole-genome average is

687

used as the background for calculating enrichments. e-f, Density of expressed gene in different

688

levels of TADs in GM12878 (e) and K562 (f).

689
690

Figure 4 | Hub-boundaries are highly active in gene regulation. a, An illustration of the TAD

691

boundary levels. The boundary levels are defined as the maximum number of TADs that use a

692

boundary on either its left or right side. The yellow, purple and red dots refer to boundaries of

693

level 1, 2, and 3, respectively. b, Enrichment of epigenetic states at different levels of TAD

694

boundaries. Hub-boundaries (i.e. boundaries with level =5) are significantly enriched with Tss

695

related states than others. (Active epigenetic states are marked in orange) c, Distribution of

696

gene expression levels for genes whose transcription start sites overlap with TAD boundaries.

697

Genes are classified by the level of TAD boundaries. d, Illustration of hierarchical TAD and

698

asymmetric loop extrusion. The red boundary denotes the ‘anchor’ site that starts the loop

699

extrusion in asymmetric loop extrusion model. Boundaries in other colors are the stopping sites

700

of the loop extrusion. The hierarchical TADs are formed by multiple stops of the loop extrusion

701

that share the same start site. e, TFs enriched (Fold Change >2) at hub-boundaries in

702

GM12878 and K562 cell lines. The fold change of ChIP-seq TF peaks at hub-boundaries (level

703

=5) against level 1 boundaries is shown.

704
705

Figure 5 | subTADs exhibit distinctive epigenetic profiles. The captured region is

706

chr19:11.3Mb – 12.2Mb in mouse G1E-ER4. The Hi-C heatmap shows a nested TAD structure

707

in this region. OnTAD results are displayed in the genome browser track: blue line denotes level

708

1 TAD, green line denotes level 2 TAD, purple denotes level 3 TAD and orange denotes level 4

709

TAD. The two subTADs (orange lines) exhibit distinctive epigenetic features, with one enriched

710

with repressive signals (H3K27me3) and silenced expression (low RNA-Seq signal) and the

711

other enriched with active signals (H3K27ac, H3K4me3, and H3K36me3) and expression (high

712

RNA-Seq signal). The shared boundary (marked by dash box) between these two subTADs has

713

no CTCF peak, indicating the formation of these two subTADs may not involve loop extrusion.

714
715

Supplementary figure 1 | Illustration of convoluted TAD structures. a, Candidate TADs (a,c)

716

and (b,d) are both suboptimal, as their scores may be driven by a real TAD (b,c). b, Two real

717

TADs (a,c) and (b,c) are nested, which makes the score of (a,c) convoluted with the score of

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

718

(b,c). c, Real TADs (a,c) and (b,d) are partially overlapping, which may be recaptured as nested

719

TADs (b,c), (a,c) and (a,d).

720
721

Supplementary figure 2 | Illustration of the recursive TAD calling algorithm. a, At the first

722

step of the algorithm, the entire Hi-C matrix is partitioned into two matrices, the one forming the

723

largest right-most TAD (i.e. triangles marked in black) and the remaining part, according to a

724

score function. Then the same function is called on each sub-matrix to recursively identify

725

nested TAD structures. b, Each recursion step identifies the best set of TADs in its matrix under

726

consideration according to the score function, and returns the TAD calls back to its parent until

727

the root.

728
729

Supplementary figure 3 | TAD reproducibility under different measurements. a, Adjusted

730

rand index between TADs from two biological replicates (GM12878, 10Kb). b, Adjusted rand

731

index across TADs from Hi-C data in multiple resolutions (GM12878, 5Kb, 10Kb and 25Kb).

732

TADtree is not included because it has difficulty finishing the computation on high resolution

733

data due to its high memory consumption. c, Adjusted rand index between TADs from Hi-C data

734

in original sequencing depth and in different down sampled sequencing depth (GM12878, 1/4,

735

1/8, 1/16 and 1/32 of original sequencing depth).

736
737

Supplementary figure 4 | Enrichment of epigenetic states at the boundaries of different

738

levels of TADs. Enrichment of epigenetic states at the regions covered by different levels of

739

TADs. The enrichment (fold change) of active states (orange states) increases as the TAD level

740

increases. a, K562 b, Huvec

741
742

Supplementary figure 5 | Comparison between boundaries and inside TADs a, Distribution

743

of RNA-seq signal (FPKM) at the boundaries (blue) and within TADs (red) b, Enrichment of

744

active epigenetic states at the TAD boundaries (solid line) versus inside TADs (dashed line). Y-

745

axis denotes fold enrichment of three active epigenetic states (Tss, Enh and PromCtcf). X-axis

746

denotes the boundaries and TADs at different levels.

747
748

Supplementary figure 6 | Distribution of the levels of TAD boundaries.

749
750

Supplementary figure 7 | Protein-protein interaction network of hub-boundary-enriched

751

TFs from STRING database. Each node denotes a TF that are at least 2-fold enriched at hub-

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

752

boundary over level1 boundary (n=37). Each edge denotes the interaction potential between

753

two TFs, with thicker edges corresponding to higher interaction confidence. Interaction data was

754

downloaded from STRING database (https://string-db.org/)

755
756

Supplementary figure 8 | Contact frequency is unbalanced between the two sides of

757

hierarchical TAD corners. The regions around TAD corners are segregated into four

758

quadrants (1-4 on the top right figure). We then averaged contact frequency of each TAD corner

759

by quadrants. As shown in the heatmap, the majority quadrant 2 and 3 shows unequal average

760

contact frequencies, suggesting that the inner TADs tend to be formed on one side of the outer

761

TADs, rather than on both sides. Quadrant 1 has the highest average contact frequency

762

because it is within TADs.

763
764

Supplementary Figure 9 | Comparison of OnTAD results between raw Hi-C and

765

normalized Hi-C in GM12878 (10kb). a, Enrichment of CTCF signal at identified TAD

766

boundaries and surrounding regions (+/- 10 bins) in raw Hi-C matrix and normalized Hi-C matrix.

767

Y-axis: The average ChIP-Seq signal. b, TAD-adjR2 of OnTAD results at difference genomic

768

distance in raw Hi-C matrix and normalized Hi-C matrix. The results on normalized data show a

769

slightly higher enrichment of CTCF at boundary and a higher TAD-adjR2. The normalized Hi-C

770

matrices were generated by Knight-Ruiz balancing [40] method. c, The proportion of boundaries

771

identified in raw data that are recovered in normalized data. Grey: exact match; Green: one bin

772

offset allowed when matching the boundaries identified in raw and normalized data. Half of the

773

boundaries identified in the raw data precisely match with the boundaries identified in the

774

normalized data. If we allow one bin offset when matching the locations of the boundaries, over

775

71% of the high-level TAD boundaries (level 2+) are matched between the results from raw data

776

and normalized data.

777
778

Supplementary Figure 10| Similarity between the (sub)TADs identified at Lsize = 5 and at

779

other Lsizes.

780
781

Supplementary Table 1 | Comparison of running time of different methods on high

782

resolution Hi-C data (GM12878 10Kb) (unit: seconds).

783
784

Supplementary Table 2 | Number of TADs on each side of a boundary that share this

785

boundary (GM12878 10Kb).

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

786
787

Supplementary Table 3 | The FDR and number of TADs under each penalty value.

788

(GM12878, average on 100 permutations)

789
790

Supplementary Table 4 | The FDR and number of TADs under each penalty value. (G1E-

791

ER4, average on 100 permutations)

792
793

Supplementary Table 5 | The FDR and number of TADs under each Lsize. (GM12878,

794

average on 100 permutations)

795
796

Supplementary File1 | Commands for operating other TAD calling methods.

797
798

Declarations

799

Acknowledgments

800

This work was supported by the NIH R01 GM121613, NIH R01GM109453 and NIH R24

801

DK106766, NIH training grant T32 GM102057 (CBIOS training program to The Pennsylvania

802

State University), a Huck Graduate Research Innovation Grant, and 4D Nucleome NIH Initiative

803

DK107980 (Center for 3D Structure and Physics of the Genome).

804
805

Availability of data and materials

806

OnTAD is available at https://github.com/anlin00007/OnTAD.

807
808

Authors’ contributions

809

YZ and LA implemented OnTAD. YZ and QL conceived the method. LA, TY, GX and JY

810

conducted the analysis. LA, YZ, QL, TY and RCH wrote the manuscript with assistance from the

811

other authors. JN assisted the interpretation of the results. All authors read and approved the

812

final manuscript.

813
814

Competing interests

815

The authors declare that they have no competing interests.

816
817

Reference

818
819

1. Won H, De La Torre-Ubieta L, Stein JL, Parikshak NN, Huang J, Opland CK, et al. Chromosome
conformation elucidates regulatory relationships in developing human brain. Nature. 2016;

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863

2. Dekker J, Rippe K, Dekker M, Kleckner N. Capturing chromosome conformation. Science (80- ).
2002;
3. Dekker J, Marti-Renom MA, Mirny LA. Exploring the three-dimensional organization of
genomes: Interpreting chromatin interaction data. Nat. Rev. Genet. 2013.
4. Fullwood MJ, Ruan Y. ChIP-based methods for the identification of long-range chromatin
interactions. J Cell Biochem. 2009;
5. Mumbach MR, Rubin AJ, Flynn RA, Dai C, Khavari PA, Greenleaf WJ, et al. HiChIP: Efficient
and sensitive analysis of protein-directed genome architecture. Nat Methods. 2016;
6. Dekker J. The three “C” s of chromosome conformation capture: Controls, controls, controls.
Nat Methods. 2006;
7. Dostie J, Richmond TA, Arnaout RA, Selzer RR, Lee WL, Honan TA, et al. Chromosome
Conformation Capture Carbon Copy (5C): A massively parallel solution for mapping interactions
between genomic elements. Genome Res. 2006;
8. Zhao Z, Tavoosidana G, Sjölinder M, Göndör A, Mariano P, Wang S, et al. Circular
chromosome conformation capture (4C) uncovers extensive networks of epigenetically
regulated intra- and interchromosomal interactions. Nat Genet. 2006;
9. Lieberman-Aiden E, Van Berkum NL, Williams L, Imakaev M, Ragoczy T, Telling A, et al.
Comprehensive mapping of long-range interactions reveals folding principles of the human
genome. Science (80- ). 2009;
10. Dixon JR, Gorkin DU, Ren B. Chromatin Domains: The Unit of Chromosome Organization.
Mol. Cell. 2016.
11. Dixon JR, Selvaraj S, Yue F, Kim A, Li Y, Shen Y, et al. Topological domains in mammalian
genomes identified by analysis of chromatin interactions. Nature. 2012;
12. Dixon JR, Jung I, Selvaraj S, Shen Y, Antosiewicz-Bourget JE, Lee AY, et al. Chromatin
architecture reorganization during stem cell differentiation. Nature. 2015;
13. Shin H, Shi Y, Dai C, Tjong H, Gong K, Alber F, et al. TopDom: An efficient and deterministic
method for identifying topological domains in genomes. Nucleic Acids Res. 2015;
14. Crane E, Bian Q, McCord RP, Lajoie BR, Wheeler BS, Ralston EJ, et al. Condensin-driven
remodelling of X chromosome topology during dosage compensation. Nature. 2015;
15. Weinreb C, Raphael BJ. Identification of hierarchical chromatin domains. Bioinformatics.
2016;
16. Yu W, He B, Tan K. Identifying topologically associating domains and subdomains by
Gaussian Mixture model and Proportion test. Nat Commun. 2017;
17. Rao SSP, Huntley MH, Durand NC, Stamenova EK, Bochkov ID, Robinson JT, et al. A 3D map
of the human genome at kilobase resolution reveals principles of chromatin looping. Cell. 2014;
18. Norton HK, Emerson DJ, Huang H, Kim J, Titus KR, Gu S, et al. Detecting hierarchical genome
folding with network modularity. Nat Methods. 2018;
19. Haddad N, Vaillant C, Jost D. IC-Finder: Inferring robustly the hierarchical organization of
chromatin folding. Nucleic Acids Res. 2017;
20. Fraser J, Ferrai C, Chiariello AM, Schueler M, Rito T, Laudanno G, et al. Hierarchical folding
and reorganization of chromosomes are linked to transcriptional changes in cellular
differentiation. Mol Syst Biol. 2015;
21. Sanborn AL, Rao SSP, Huang S-C, Durand NC, Huntley MH, Jewett AI, et al. Chromatin
extrusion explains key features of loop and domain formation in wild-type and engineered

bioRxiv preprint doi: https://doi.org/10.1101/361147; this version posted April 26, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906

genomes. Proc Natl Acad Sci. 2015;
22. Ho JWK, Jung YL, Liu T, Alver BH, Lee S, Ikegami K, et al. Comparative analysis of metazoan
chromatin organization. Nature. 2014;
23. Zhang Y, An L, Yue F, Hardison RC. Jointly characterizing epigenetic dynamics across multiple
human cell types. Nucleic Acids Res. 2016;
24. Dunham I, Kundaje A, Aldred SF, Collins PJ, Davis CA, Doyle F, et al. An integrated
encyclopedia of DNA elements in the human genome. Nature. 2012;
25. Schmitt AD, Hu M, Jung I, Xu Z, Qiu Y, Tan CL, et al. A Compendium of Chromatin Contact
Maps Reveals Spatially Active Regions in the Human Genome. Cell Rep. 2016;
26. Ganji M, Shaltiel IA, Bisht S, Kim E, Kalichava A, Haering CH, et al. Real-time imaging of DNA
loop extrusion by condensin. Science (80- ). 2018;
27. Zheng M, Tian SZ, Capurso D, Kim M, Maurya R, Lee B, et al. Multiplex chromatin
interactions with single-molecule precision. Nature. 2019;566:558–62.
28. Kschonsak M, Merkel F, Bisht S, Metz J, Rybin V, Hassler M, et al. Structural Basis for a
Safety-Belt Mechanism That Anchors Condensin to Chromosomes. Cell. 2017;
29. Gerstein MB, Kundaje A, Hariharan M, Landt SG, Yan KK, Cheng C, et al. Architecture of the
human regulatory network derived from ENCODE data. Nature. 2012;
30. Wang J, Zhuang J, Iyer S, Lin XY, Whitfield TW, Greven MC, et al. Sequence features and
chromatin structure around the genomic regions bound by 119 human transcription factors.
Genome Res. 2012;
31. Wang J, Zhuang J, Iyer S, Lin XY, Greven MC, Kim BH, et al. Factorbook.org: A Wiki-based
database for transcription factor-binding data generated by the ENCODE consortium. Nucleic
Acids Res. 2013;
32. Hsu SC, Gilgenast TG, Bartman CR, Edwards CR, Stonestrom AJ, Huang P, et al. The BET
Protein BRD2 Cooperates with CTCF to Enforce Transcriptional and Architectural Boundaries.
Mol Cell. 2017;
33. Rowley MJ, Nichols MH, Lyu X, Ando-Kuri M, Rivera ISM, Hermetz K, et al. Evolutionarily
Conserved Principles Predict 3D Chromatin Organization. Mol Cell. 2017;67:837–852.e7.
34. Rowley MJ, Corces VG. Organizational principles of 3D genome architecture. Nat Rev Genet.
2018;
35. Oudelaar AM, Davies JOJ, Hanssen LLP, Telenius JM, Schwessinger R, Liu Y, et al. Single-allele
chromatin interactions identify regulatory hubs in dynamic compartmentalized domains. Nat
Genet. 2018;
36. Bintu B, Mateo LJ, Su JH, Sinnott-Armstrong NA, Parker M, Kinrot S, et al. Super-resolution
chromatin tracing reveals domains and cooperative interactions in single cells. Science (80- ).
2018;
37. Imakaev M, Fudenberg G, McCord RP, Naumova N, Goloborodko A, Lajoie BR, et al. Iterative
correction of Hi-C data reveals hallmarks of chromosome organization. Nat Methods. 2012;
38. Efron B. Size, power and false discovery rates. Ann Stat. 2007;
39. Zheng X, Zheng Y. CscoreTool: Fast Hi-C compartment analysis at high resolution.
Bioinformatics. 2018;
40. Knight PA, Ruiz D. A fast algorithm for matrix balancing. IMA J Numer Anal. 2013;

Figure 1

b

a

b

c

d

W=150 bins

Avg. contact frequency

a

e

W=50 bins
W=10 bins
a b c

d

e

c

d

a

b

c

d

e

a

b

c

d

e

Figure 2
a

b

d

c

e

Figure 3
level 1

a

b

level 2

Nested
TADs

level 3
Singleton

d

c

e

GM12878

f

K562

Figure 4

a

level 1
level 2
level 3

b

c

d

e

Figure 5

Supplementary figure 1

a

b

c

Supplementary figure 2

Supplementary figure 3
a

c

b

Supplementary figure 4

a

b

Supplementary figure 5
a

b

Supplementary figure 6

Supplementary figure 7

contact frequency

Supplementary figure 8

color intensity

1

2

3

4

Supplementary figure 9

a

b

c

Supplementary figure 10

