bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

1

Benchmarking bacterial genome-wide association study (GWAS) methods

2

using simulated genomes and phenotypes

3
4

Morteza M. Saber1* and Jesse Shapiro1*

5
6

1

Département de Sciences Biologiques, Université de Montréal, Montreal, QC, Canada

7
8

* Corresponding authors

9

E-mail: jesse.shapiro@umontreal.ca , morteza.mahmoudisaber@umontreal.ca

10

	  

1	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

11

Abstract

12

Genome Wide Association Studies (GWASs) have the potential to reveal the genetics of microbial

13

phenotypes such as antibiotic resistance and virulence. Capitalizing on the growing wealth of bacterial

14

sequence data, microbial GWAS methods aim to identify causal genetic variants while ignoring

15

spurious associations. Bacteria reproduce clonally, leading to strong population structure and genome-

16

wide linkage, making it challenging to separate true “hits” (i.e. mutations that cause a phenotype)

17

from non-causal linked mutations. GWAS methods attempt to correct for population structure in

18

different ways, but their performance has not yet been systematically evaluated. Here we developed a

19

bacterial GWAS simulator (BacGWASim) to generate bacterial genomes with varying rates of

20

mutation, recombination, and other evolutionary parameters, along with a subset of causal mutations

21

underlying a phenotype of interest. We assessed the performance (recall and precision) of three

22

widely-used univariate GWAS approaches (cluster-based, dimensionality-reduction, and linear mixed

23

models, implemented in PLINK, pySEER, and GEMMA) and one relatively new whole-genome

24

elastic net model implemented in pySEER, across a range of simulated sample sizes, recombination

25

rates, and causal mutation effect sizes. As expected, all methods performed better with larger sample

26

sizes and effect sizes. The performance of clustering and dimensionality reduction approaches to

27

correct for population structure were considerably variable according to the choice of parameters.

28

Notably, the elastic net whole-genome model was consistently amongst the highest-performing

29

methods and had the highest power in detecting causal variants with both low and high effect sizes.

30

Most methods reached good performance (Recall > 0.75) to identify causal mutations of strong effect

31

size (log Odds Ratio >= 2) with a sample size of 2000 genomes. However, only elastic nets reached

32

reasonable performance (Recall = 0.35) for detecting markers with weaker effects (log OR ~1) in

33

smaller samples. Elastic nets also showed superior precision and recall in controlling for genome-

34

wide linkage, relative to univariate models. However, all methods performed relatively poorly on

35

highly clonal (low-recombining) genomes, suggesting room for improvement in method development.

36

These findings show the potential for whole-genome models to improve bacterial GWAS

	  

2	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

37

performance. BacGWASim code and simulated data are publicly available to enable further

38

comparisons and benchmarking of new methods.

39
40

Author summary:

41

Microbial populations contain measurable phenotypic differences with important clinical and

42

environmental consequences, such as antibiotic resistance, virulence, host preference and

43

transmissibility. A major challenge is to discover the genes and mutations in bacterial genomes that

44

control these phenotypes. Bacterial Genome-Wide Association Studies (GWASs) are family of

45

methods to statistically associate phenotypes with genotypes, such as point mutations and other

46

variants across the genome. However, compared to sexual organisms such as humans, bacteria

47

reproduce clonally meaning that causal mutations tend to be strongly linked to other mutations on the

48

same chromosome. This genome-wide linkage makes it challenging to statistically separate causal

49

mutations from non-causal false-positive associations. Several GWAS methods are currently

50

available, but it is not clear which is the most powerful and accurate for bacteria. To systematically

51

evaluate these methods, we developed BacGWASim, a computational pipeline to simulate the

52

evolution of bacterial genomes and phenotypes. Using simulated genomes, we found that GWAS

53

methods varied widely in their performance. In general, causal mutations of strong effect (e.g. those

54

under strong selection for antibiotic resistance) could be easily identified with relatively small

55

samples sizes of around 1000 genomes, but more complex phenotypes controlled by mutations of

56

weaker effect required 3000 genomes or more. We found that a recently-developed GWAS method

57

called elastic net was particularly good at identifying causal mutations in highly clonal populations,

58

with strong linkage between mutations – but there is still room for improvement. The BacGWASim

59

computer code is publicly available to enable further comparisons and benchmarking of new

60

methods.

61

	  

3	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

62

Introduction

63

Recent progress in sequencing technologies and consequently rapid expansion of bacterial genomic

64

data repositories have provided enormous opportunities to identify the genomic elements underlying

65

clinically, environmentally and industrially important bacterial phenotypes and their evolutionary

66

responses to changing environmental circumstances. Such discoveries could immensely improve our

67

knowledge of the molecular mechanisms of important microbial phenotypes such as antibiotic

68

resistance and virulence, thus contributing to the development of new drugs, vaccines and antibiotics.

69

By identifying statistical associations between genotype and phenotype, Genome Wide Association

70

Studies (GWASs) can be used to dissect the genetic components of any measurable and heritable

71

phenotype in an unbiased hypothesis-free manner. In humans, GWASs have been used to investigate

72

genotype-phenotype association since the early 2000s, leading to the discovery of more than 149,000

73

trait-associated genomic markers in thousands of publications (1). In bacteria, the GWAS approach

74

can be traced back to a 2005 attempt to unravel the genomic elements responsible for transforming

75

harmless Neisseria meningitidis into a lethal pathogen causing cerebrospinal meningitis using Multi

76

Locus Sequence Typing (MLST) (2). The difficulties and limitations of bacterial GWASs imposed by

77

population structure were appreciated soon thereafter (3). Nevertheless, over the past decade GWASs

78

applied to Single Nucleotide Polymorphisms (SNPs) and K-mers (i.e. DNA words of length K) in

79

microbial genomes has identified mutations and genes associated with antibiotic resistance (4–10),

80

cancer (11), virulence (2,12,13) and host preference (14). In contrast to human GWAS, however,

81

bacterial association mapping is technically challenging due to the unique characteristics of bacterial

82

populations, and optimal approaches for bacterial GWASs have yet to be established.

83

The objective of a GWAS method is to maximize statistical precision and power, in order to identify

84

true causal genomic elements while ignoring spurious associations. To do so, GWAS methods must

85

overcome confounding factors which are particularly acute in bacterial populations. The two main

86

confounding elements in bacteria are genome-wide linkage disequilibrium interrupted by homologous

87

recombination tracts, and strong population structure resulting from clonal expansions.

	  

4	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

88

Genome-wide linkage disequilibrium (LD) leads to type I errors (false positives) in GWAS tests

89

because linked non-causal mutations may hitchhike on the same genomic background (“clonal

90

frame”) as a causal mutation. A naïve GWAS approach will find the entire set of linked mutations to

91

be associated with the phenotype. In bacterial species such as M. tuberculosis that are virtually non-

92

recombinogenic, most of the genome is in complete LD, posing a major risk of type I error. In humans

93

and other sexual species, LD is broken down by homologous recombination every generation,

94

allowing GWAS tests to map the causal variants to a small genomic region. In bacteria, LD may span

95

the entire genome, complicating fine mapping of causal variants. Even in bacterial species with

96

relatively high rates of homologous recombination (e.g. S. pneumoniae), LD may still extend across

97

the entire chromosome.

98

Population structure refers to a situation in which subpopulations have systematic differences in allele

99

and phenotype frequencies (15,16). This can result in spurious associations between genotypes and

100

phenotypes due to shared ancestry rather than causal associations. To control for the confounding

101

effect of population structure, microbial GWAS tools have adapted approaches already used in human

102

GWASs, including cluster-based techniques (6,12,17) , dimensionality reduction (18–22), Linear

103

Mixed Models (LMMs) (4,8,10,23,24), and recently, artificial intelligence using whole-genome

104

models (25–27). Although each of these approaches has been successful to varying extents,

105

population structure is still a challenge in microbial GWASs and no gold standard solution has been

106

established.

107

The power of a GWAS to identify causal variants underlying a phenotype is influenced by several

108

other factors, including the sample size and the distribution of effect sizes. In human GWASs, most of

109

the detected causal variants underlying complex phenotypes have odds ratio (OR) < 1.5 (28) due to

110

the polygenicity of the traits and the fact that many human phenotypes of interest are disease traits

111

that have been largely shaped by neutral evolution rather than strong selection. In bacteria, however,

112

many phenotypes of interest such as antibiotic-resistance or host-association tend to be shaped by

113

recent positive selection. Therefore, the genomic elements controlling bacterial traits are expected to

114

have larger effect sizes (17). For example, mutations conferring antibiotic resistance in

	  

5	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

115

Mycobacterium tuberculosis (29) and Steptococcous pneumoniae (6) tend to have large effect sizes

116

(OR > 10). However, it has yet to be investigated whether smaller effect sizes are detectable, and if

117

so, by which methods.

118

To determine best practices for microbial GWAS, it is essential to compare current GWAS methods

119

in terms of their performance across a range of realistic effect sizes, recombination rates, and sample

120

sizes. For this purpose, here we developed a simulation platform called BacGWASim which simulates

121

bacterial genomes along a defined phylogenetic tree to capture mutation and recombination events in

122

a clonal population structure. BacGWASim is tunable for a variety of evolutionary parameters in

123

order to simulate a wide range of bacterial species. It then simulates bacterial phenotypes based on

124

adjustable values of heritability, number of causal variants, and their effect sizes. The major different

125

classes of GWAS methods currently in use were then evaluated in terms of their precision and power

126

to identify true causal variants in the simulated bacterial populations. In summary, we provide an

127

extensible framework for simulating the evolution of bacterial genotypes and phenotypes, and for

128

benchmarking new GWAS approaches as they become available.

129

Results

130

Simulating bacterial genomes and phenotypes

131

To systematically benchmark bacterial GWAS approaches, we first developed an appropriate

132

simulator of bacterial genomes and phenotypes, BacGWASim (Methods; Figure 1a). The simulator

133

starts from a real reference genome with gene annotations and then allows this genome to evolve

134

along a user-defined or simulated phylogenetic tree capturing the population structure (Figure 1b).

135

Phenotypes are simulated according to a heritability function of causal SNPs, with user-defined effect

136

sizes. Realistic sources of noise, such as sequencing error and read mapping, are also included.

137

Although other evolutionary parameters (e.g. mutation rates) are tunable in the simulation, here we

138

varied three key parameters with a likely effect on GWAS performance: sample size, recombination

139

rate, and effect size of causal mutations. We began with the genome sequence and phylogenetic tree

140

of a well-studied species, Streptococcus pneumoniae (although the user could alternatively choose to

141

simulate a phylogeny de novo using a birth-death process). A range of genome wide linkage
	  

6	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

142

disequilibrium (LD) was then simulated to approximate the range of LD observed in bacterial species

143

with high, moderate and low recombination rates. While not an exact match, these simulations

144

approximate the LD landscapes of S. pneumoniae, E. coli, and M. tuberculosis, respectively (Figure

145

2). We will begin by focusing on the high-recombining, low LD simulations to explore the effects of

146

sample and effect sizes on GWAS performance, and then revisit the effects of LD to conclude. In all

147

simulations, phenotype heritability was set to one, with an equal number of cases and controls in each

148

dataset. The BacGWASim codes are publicly available at:

149

https://github.com/Morteza-M-Saber/BacGWASim .

150

GWAS power to detect variants of large effect reaches a plateau at 3000 genomes

151

Early GWASs were able to identify causal variants of large effect with relatively small sample sizes

152

(on the order of 100 genomes) likely because the phenotypes investigated were under strong positive

153

selection (4,9,12,14,17). However recent advances in high-throughput sequencing technologies now

154

makes it feasible to sequence thousands of genomes. To evaluate the effect of increasing sample size

155

on the power to detect causal mutations within a range of effect sizes, we measured the performance

156

of bacterial GWAS methods on a range of sample sizes. Simulating a high-recombining, low LD

157

population (Figure 2e), the elastic net whole-genome model implemented in pyseer was consistently

158

amongst the most accurate across the range of sample sizes, with F1 score ranging between 0.44 to

159

0.60 (Figure 3a) and fewer than 50 false positives out of 100,000 tested markers (Figure 3c). The

160

linear mixed model (LMM) implemented in GEMMA and clustering approach implemented in plink

161

also showed low rates of false positives comparable to elastic nets (Figure 3c); however, they had

162

lower recall (Figure 3b). FaST-LMM implemented in pyseer, despite its high recall (Figure 3b)

163

achieved lower F1 scores due to its relatively high false positive rates (Figure 3c). With relatively

164

small sample sizes (<1000), all methods except for elastic net showed poor performance in detecting

165

causal variants with low effect sizes.

166

A general pattern observed across all methods is that after a rapid surge in recall rate by increasing the

167

sample size to 1000, the power improvement slows down and reaches a plateau around 3000 samples

	  

7	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

168

(Figure 3b). Breaking down these comparisons by effect size shows that, as expected, causal markers

169

with low effect size (log (OR) ≈1) are the most sensitive to sample size. The power to detect such

170

variants is < 0.1 in univariate methods and < 0.35 in elastic nets in samples sizes below 1,000. Power

171

improves to 0.37-0.48 for univariate methods and 0.68 for elastic nets at sample size of 3,000 (Figure

172

3d). In contrast, recall rate (power) for causal markers with higher effect sizes (log (OR) ≈2 and log

173

(OR) ≈3) is more uniform across methods and reaches a maximum of 0.78 in univariate models and

174

0.91 in elastic nets, with only 1,000 genomes sampled. Beyond 1,000 samples, the increase in recall

175

tends to be small, reaching a plateau around 3,000 samples for most methods (Figure 3e and 3f).

176

Correcting for population structure

177

We next investigated how GWAS power varies across the four methods to correct for population

178

structure: univariate models including cluster-based approaches, dimensionality reduction, and linear

179

mixed models, and the whole-genome model using elastic nets. In univariate models, the correlation

180

between each of the markers (SNPs or K-mers) and the desired phenotype is investigated separately.

181

Therefore, the covariance between the markers due to population structure needs to be included

182

explicitly. Whole-genome models, on the other hand, include all the genetic variants at once and by

183

this means, covariance between the variants are implicitly included in the analysis. Our findings show

184

that the whole-genome elastic net model has superior power relative to univariate models in

185

controlling for population structure and genome-wide LD, especially in small sample sizes (Figure 3d,

186

e, f) and when there is strong linkage across the genome, as discussed below. First, we consider each

187

of the univariate methods separately.

188

Cluster-based approaches. One of the classic methods for controlling the confounding effect of

189

population structure is to identify clusters of related individuals within the overall population and then

190

test for association conditional on these subpopulations. Subpopulations can be inferred using a

191

variety of methods (30–33) and then a weighted association test is performed for each genomic

192

marker across the defined clusters (e.g. with the Cochran–Mantel–Haenszel test). The proportion of

193

population structure captured in this approach, however, depends on the threshold used for clustering.

194

Choosing a strict threshold for clustering will improve the precision of the test but at the expense of
	  

8	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

195

reducing the recall score. To measure the effect of the choice of clustering threshold on the power of

196

cluster-based methods, we performed linkage agglomerative clustering based on IBS distances

197

implemented in PLINK across a range of thresholds. The threshold was defined as the maximum

198

number of individuals allowed to group in one cluster. By relaxing the threshold, a larger number of

199

samples with lower genetic similarity are included in each cluster and therefore, population structure

200

will not be fully captured. In contrast, setting a very strict threshold will make the association test

201

conservative by over-correcting for population structure.

202

Using simulated datasets of 3,000 genomes with low LD (Figure 2e), we varied the population

203

structure correction from strict (maximum number of two individuals per cluster) to weak (up to a

204

hundred individuals per cluster). As expected, going from strict to weak correction improves recall

205

(from 0.56 to 0.75) at the expense of precision, which drops from 0.57 to 0.38 (Figure 4a). The choice

206

of clustering threshold significantly affects the ability to detect variants of low effect (log OR≈1), but

207

has little effect on variants of larger effect (Figure 4b). In the absence of established standards to

208

choose a clustering threshold, our results suggest that the choice may not matter for the detection of

209

large-effect variants, but could significantly bias the detection of markers with low effect sizes.

210

Dimensionality reduction. In dimensionality reduction, a relatedness matrix of samples is projected

211

onto a lower number of components, and then a certain number of these components are chosen as

212

fixed effect factors in the linear regression (or logistic regression in the case of binary phenotypes) to

213

account for population structure. The two most popular methods for dimensionality reduction in

214

GWAS are principal component analysis (PCA) of variance-standardized relationship matrix based on

215

SNP data (33) and metric multidimensional scaling (MDS) of genetic similarities based on pairwise

216

distance matrix constructed using the shared k-mer content between all samples (18). The former has

217

been widely used in eukaryotic GWAS studies where there is low variation in pan-genome size, while

218

the latter is specifically designed for bacterial GWAS and uses an alignment-free k-mer based

219

approach to estimate genetic similarities based on core and accessory genome distances. Like cluster-

220

based approaches, the proportion of population structure controlled in this approach depends on the

221

number of included components as covariates in the regression analysis. Although there are some

	  

9	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

222

recommended methods for determining the optimal number of included components such as visual

223

estimation using the scree plot (34), the number of included components is subjective and is a matter

224

of sensitivity-specificity tradeoff. Including more components is likely to improve the precision of

225

GWAS and reduce Type I error caused by population structure, at the expense of decreasing the recall

226

score.

227

To evaluate the effect of the number of included components in dimensionality reduction-based

228

bacterial GWAS, we tested the SEER method implemented in pyseer on a simulated high-

229

recombining dataset of 3,000 samples (Figure 2e). According to the scree plot, 4 or 11 are good

230

choices of the number of components to be included in the regression analysis, as there are major and

231

minor drops after these number of dimensions (Supplementary Figure 1). However, the F1 score

232

reaches its maximum after inclusion of 30 dimensions (Figure 4c). By increasing the number of

233

components from 4 to 30, the precision significantly improved from 0.23 to 0.45, then reaches a

234

plateau. Meanwhile, the recall score is relatively unaffected (dropping from 0.79 to 0.73), leading to

235

total improvement of F1 score (from 0.33 to 0.55) with an increasing number of components. As

236

expected, recall is better for markers of high or medium effect, but recall does not vary much with

237

increasing components for any category of effect size (Figure 4d). In general, our results indicate that

238

the choice of included components significantly affects the performance of dimensionality reduction-

239

based stratification correction, and the lack of the standard protocol to identify the optimum number

240

of included principal components can limit the application of this method.

241

Linear mixed models (LMMs). The LMM is an extension of linear regression, which allows the

242

inclusion of both fixed and random effects as covariates. By using a kinship matrix to model the

243

variance of a random effect, LMMs consider the genetic relationships between all samples rather than

244

selecting a proportion of the population structure (as in the cluster-based and dimensionality-reduction

245

approaches described above) and has been shown to control type I error without loss of power (35).

246

GEMMA (36) and FaST-LMM (37) are two popular LMM-based GWAS methods and have been

247

used in recent bacterial GWASs, either as standalone methods, or as implemented in BugWAS (23),

248

DBGWAS (24), or pyseer (34).

	  

10	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

249

To compare the power of LMM-based GWAS methods, we tested the performance of GEMMA and

250

FaST-LMM implemented in pyseer on the same simulated high-recombining dataset of 3,000 samples

251

(Figure 2e). Pyseer provides the option to construct the kinship matrix using either variant-based

252

genetic distances or by extracting patristic distances from the phylogeny, while GEMMA

253

recommends using the centered genotype matrix. Averaged across effect sizes, GEMMA is the most

254

efficient method to control for type I errors caused by population structure and results in the highest

255

F1 score (Figure 5a). In FaST-LMM, the phylogeny-based correction for population structure

256

outperforms the genotype matrix, mainly due to a boost in precision (Figure 5a). However, in this case

257

the ‘true’ phylogeny (known from the simulation) was used, but must be estimated in real

258

applications. Therefore, the accuracy of a phylogenetic correction might be lower depending on the

259

choice of methods to construct the phylogenetic tree. FaST-LMM has slightly higher recall (power)

260

than GEMMA, and its advantage was most pronounced for variants with low effect sizes (Figure 5b).

261

All methods had high and nearly equal power (> 0.85) in identifying causal variants with high effect

262

sizes (log (OR) ≈2 and log (OR) ≈3). However, for detecting low effect-size causal variants (log (OR)

263

≈1), FaST-LMM has higher power (Figure 5b).

264

Current GWAS methods perform poorly under moderate to high LD

265

Higher genome-wide LD is expected to reduce the precision of association testing, because

266

hitchhiking non-causal mutations are identified as false positives. To assess the influence of LD on

267

GWAS performance, we tested each method across a range of simulated datasets with low, moderate,

268

or high genome-wide LD (Figure 2). In general, the elastic net implemented in pyseer considerably

269

outperforms other methods at moderate or high LD (Figure 6). At low LD, elastic nets perform

270

similarly to GEMMA, the best univariate method (Figure 6a). At high LD, elastic nets achieve ~75%

271

power, compared to ~60% in univariate methods (Figure 6b). All methods suffer a loss of precision

272

with increasing LD, but elastic nets retain the highest precision at high LD (Figure 6c). Still, the

273

median precision of elastic nets at high LD is ~8%, suggesting significant room for improvement. The

274

FaST-LMM approach using the genotype-matrix for population structure correction was most

275

severely affected by LD, with precision dropping from 0.36 at low LD to <0.001 at high LD (Figure

	  

11	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

276

6c). On the other hand, FaST-LMM with the phylogeny-based correction showed comparable results

277

to the best performing univariate-model methods. Amongst the univariate models, the mixed model

278

approach implemented in GEMMA tended to perform somewhat better than others at moderate or

279

high LD (Figure 6a). Q-Q plots further indicate GEMMA to be the best performing method across

280

the range of LD among the univariate models (Supplementary Figure 2).

281

Discussion

282

We developed a platform to simulate bacterial genomes and phenotypes based on the emergence and

283

evolution of causal variants along a phylogenetic tree. The simulator is tunable for relevant

284

evolutionary parameters. Although it was designed for benchmarking GWAS tools, it could also be

285

used for other applications in bacterial population genomics and epidemiology. Here we focused on

286

how GWAS method performance is affected by sample size, recombination (linkage disequilibrium),

287

and causal variant effect sizes. We only considered point mutations in the core genome as causal

288

variants, but this could be extended to causal variants in the pangenome (i.e. gene presence/absence),

289

which can be identified with k-mer approaches like SEER. Although a full exploration of core and

290

pangenome associations is beyond the scope of the current work, we expect our major findings to hold

291

when causal variants in the pangenome are included. Our evolutionary model is also ‘neutral’ in that it

292

does not consider positive selection on causal variants (e.g. antibiotic resistance mutations that have a

293

selective advantage). Future versions of BacGWASim could explicitly model an increased replication

294

rate (clonal expansion) of bacteria encoding causal variants, perhaps more realistically capturing the

295

evolution of certain phenotypes.

296

Our results confirmed the suspicion that currently popular GWAS methods perform poorly when

297

applied to bacteria with relatively clonal population structures yielding moderate or high LD (e.g. E.

298

coli or M. tuberculosis). In such clonal populations, fine-mapping of causal mutations may be

299

impossible and identification of phenotype-associated lineages may be the best possible outcome (23).

300

More encouragingly, causal variants can be detected with relatively high power and precision in

301

higher-recombining populations, akin to S. pneumoniae. These results highlight the importance of

302

assessing the LD landscape of the target organisms before deciding on a sample size and GWAS
	  

12	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

303

design. It also suggests significant room for improvement in GWAS method development,

304

particularly for highly clonal bacteria. Promising methods include phyC (9) and treeWAS (15) which

305

detect homoplastic (convergent) mutations along a clonal phylogeny, providing strong control over

306

population structure given accurate phylogenetic tree. Due to the high computational burden of these

307

tests, especially with large sample sizes (35), we did not evaluate these methods here. Moreover,

308

although homoplasies do occur in our simulations (Figure 1b), their rate is not explicitly controlled

309

and thus their impact is hard to assess. In the future, BacGWASim could be extended to explicitly

310

model homoplastic mutations and to assess the performance of homoplasy-based methods.

311

Of the GWAS methods evaluated here, the elastic net whole-genome model generally performed best,

312

followed by the mixed model approach implemented in GEMMA. The clustering approach

313

implemented in PLINK also performed well, but varied significantly depending on the clustering

314

threshold, which can be challenging to optimize. Elastic nets implemented in pyseer also provide the

315

possibility to perform a GWAS on k-mers or unitigs, whereas this is not as easily done in GEMMA or

316

PLINK. Although elastic nets had the highest precision of the methods tested, there is significant

317

room for improvement, as mentioned above.

318

Our results also help explain the success of early bacterial GWASs with low sample sizes. We found

319

that, in a high-recombining population, a sample size ~1,000 is sufficient to reliably detect causal

320

variants of strong effect (log OR >= 2) with high power (>0.80). Such strong effect sizes may be

321

common for antibiotic resistance mutations, and other variants under strong positive selection.

322

However, samples sizes >3,000 will likely be needed to detect variants of lower effect (log OR ~1),

323

which may be more common for more ‘complex’ phenotypes with lower heritability. Of course, the

324

sample size required to achieve a desired power will vary depending on the recombination rate and

325

population structure of the organism of interest. BacGWASim thus provides a tool for study-specific

326

power calculations.

327

In an age of a rapidly growing array of options for performing GWASs, we hope that our results are

328

instructive in quantifying general trends and sources of bias, and that our simulation platform can

329

continue to be used to benchmark novel methods as they appear. For example, machine learning has
	  

13	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

330

recently been used in bacterial GWAS, with successful application in highly clonal species such as

331

Mycobacterium tuberculosis (25–27,38). These methods have the advantages of being highly versatile

332

with high computational efficiency. Although not all artificial intelligence methods are currently

333

packaged for the purpose of bacterial GWAS, our findings suggest great potential for whole-genome

334

models to further fine-tune bacterial GWAS. Our simulation platform also provides a means to

335

evaluate and benchmark their performance against the traditional methods as they emerge.

336
337

Methods

338

Overview of the Bacterial GWAS Simulator (BacGWASim)

339

BacGWASim was developed with the goal of simulating a range of evolutionary parameters which

340

can potentially confound microbial genome-wide association studies. In this first release, we primarily

341

focused on simulating population structure and genome-wide linkage disequilibrium, and evaluating

342

GWAS to identify SNPs underlying a phenotype. BacGWASim starts with a bacterial whole genome

343

and its annotations and simulates a population across a pre-defined or simulated phylogenetic tree

344

(Figure 1a). A binary or continuous phenotype is then assigned to each genome in the population

345

based on the emergence and evolution of randomly chosen set of causal variants with a user-defined

346

range of effect sizes.

347

BacGWASim simulate bacterial genotypes and phenotypes in three main steps: (1) generating a

348

phylogenetic tree, (2) evolving genomes along the phylogenetic tree, and (3) simulating phenotypes.

349

Generating the phylogenetic tree

350

A neutral model of speciation-extinction developed by Genhard (39) implemented in Artificial Life

351

Framework (ALF) (40) was used for the simulation of phylogenetic trees. This model allows for

352

simulation of bacterial populations across a wide range of birth rates (λ), death rates (µ) and branch

353

length distributions. A custom phylogenetic tree can also be provided by the user to provide the option

354

for simulation of scenarios inferred from real bacterial populations.

	  

14	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

355

Simulation of genome evolution

356

For simulation of realistic genomic content, BacGWASim accepts any bacterial whole genome and

357

the corresponding feature annotations as starting input. The elements of the genome are then extracted

358

and classified in two groups of protein coding genes and intergenic regions (defined as sequence not

359

annotated as a CDS). These two categories are often under distinct evolutionary constraints and their

360

evolution is best captured by different evolutionary parameters. Artificial Life Framework (ALF) was

361

used for the simulation of protein coding gene and DAWG v.2 for the intergenic regions (41). These

362

implementations allowed for simulation of three categories of genomic events: 1) site-level events

363

including codon and nucleotide substitution rates, insertion and deletion rates, and rate variation

364

across sites, 2) gene-level events including gene deletion, duplication and gene fission/fusion, and 3)

365

genome-level events including inversion, translocation and recombination through horizontal gene

366

transfer. The resulting sequences of coding and intergenic regions at the tips of phylogenetic tree are

367

then combined while accounting for gene loss and transfer. Synthetic sequencing reads with Illumina-

368

specific sequencing errors were generated for each simulated sample using ART next-generation

369

sequencing read simulator (42). These synthetic reads were then mapped to the reference genome

370

using BWA (43) with default setting and the simulated variants were called using GATK Haplotype

371

caller by setting ‘ploidy’ to 1 (44).

372

Phenotype simulation

373

After genome simulation, a binary or continuous phenotype was then simulated for each member of

374

population based on an additive genetic model implemented in GCTA (45). For this purpose, a user-

375

defined number of causal variants, minor allele frequency cutoff, and range of effect sizes in units of

376

odds ratio are used to randomly select a set of “true” causal variants from the pool of simulated

377

markers. The phenotype labels are then simulated according to the presence/absence of the causal

378

variants in each genome, user-defined values of heritability, and prevalence of the desired phenotype.

379
380

	  

15	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

381

Benchmark datasets and methods of Bacterial GWAS

382

Bacterial genomes were simulated within ranges of three features of interest, keeping other

383

parameters constant:

384

•

385

Sample size: bacterial populations with a range of 400 to 3000 sampled genomes were
simulated to evaluate the effect of sample size on GWAS.

386

•

Recombination rate: Recombination rates in highly-recombining Streptococcus pneumoniae

387

estimated by Chewapreecha et al. (46) (average ρ/θ≈0.20) were used for simulation of highly

388

recombining populations. Moderate- and low-recombining populations were respectively

389

simulated with ρ/θ ratios of 0.1 and 0.001.

390

•

Effect size distribution: Eighteen causal markers with odds ratio (effect sizes) of 2, 3, 4, 7,

391

10, 11, 15 and 20 (Natural logarithm in the range of 1 to 3) with minor allele frequency >0.1

392

were randomly chosen for phenotype simulation. The linkage disequilibrium between the

393

selected markers were measured using bcftools (47) and markers with r2 > 0.6 were

394

discarded.

395

To measure the range of LD in real bacterial species, genome data were retrieved from the CARD

396

database (48), SNPs were called using Snippy (49) and linkage levels were measured in 1,000

397

markers using Haploview (50) (Figure 2).

398
399

In every set of simulations, 100,000 randomly selected markers with minor allele frequency >0.01

400

were retained for GWAS analysis. An equal number of markers was selected in each simulation to

401

make them comparable without any confounding effect of multiple testing across replicates. For each

402

genome simulation, ten sets of randomly chosen markers were then used to generate ten replicate

403

phenotype simulations. Using the called variants and phenotype labels as benchmark datasets, we then

404

used the following methods to perform GWAS:

	  

16	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

405

•

Plink v1.9 using linkage agglomerative clustering based on pairwise identity-by-state (IBS)

406

distances for population structure correction, and using Bonferroni corrections for multiple

407

tests (33).

408

•

SEER implement in pyseer v 1.2.0 using multi-dimensional scaling of pairwise k-mer based

409

genetic distances to correct for population structure, using unique patterns to estimate

410

significance threshold, and by removing the markers tagged with “af-filter”, “bad-chisq”,

411

“pre-filtering-failed”,

412

“matrix-inversionerror” after the analysis (18,34).

413

•

”lrt-filtering-failed”, “perfectly-separable-data”,

“firth-fail” and

Fast-LMM implemented in pyseer 1.2.0 using pairwise variant-based distances to correct

414

for population structure, using unique patterns to estimate significance threshold, and by

415

removing the tagged markers mentioned above (as for SEER) after the analysis (34,37).

416

•

Fast-LMM implemented in pyseer 1.2.0 using phylogeny-based patristic distances to

417

correct for population structure, using unique patterns to estimate significance threshold, and

418

by removing the tagged markers mentioned above after the analysis (34,37).

419

•

420

GEMMA v.98 using pairwise variant-based genetic distances to correct for population
structure and setting the option ‘gk’ to 1 for generating the relationship matrix.

421

•

Elastic-net whole-genome model implemented in pyseer 1.2.0, by setting the alpha value to

422

1, without sequence reweighting, and using Bonferroni correction for multiple tests, based on

423

the second round of model fitting and feature selection (34).

424

The performance of each GWAS method was assessed based on the mean values of precision, recall

425

and F1 scores, and the corresponding standard deviations across ten replicate simulations for each

426

parameter combination, where:

427

Precision = True Positives / (True Positives + False Positives),

428

Recall = True Positives / (True Positives + FalseNegatives) , and

429

F1 = 2*(Precision*Recall)/Precision+Recall.

	  

17	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

430

Acknowledgements

431

This work was supported by a Genome Canada and Génome Québec grant to BJS. We are indebted to

432

John Lees for useful discussions and valuable advice during the preparation of this manuscript.

433
434

Supporting information

435

Supplementary figures S1 and S2. A document containing all the supplementary figures referenced

436

in the text. (PDF)

437

Author Contributions

438

Conceptualization: Morteza M. Saber, B. Jesse Shapiro.

439

Formal analysis: Morteza M. Saber.

440

Funding acquisition: Jesse Shapiro.

441

Investigation: Morteza M. Saber, B. Jesse Shapiro.

442

Methodology: Morteza M. Saber, B. Jesse Shapiro.

443

Project administration: Jesse Shapiro.

444

Software: Morteza M. Saber.

445

Visualization: Morteza M. Saber.

446

Writing– original draft: Morteza M. Saber, B. Jesse Shapiro.

447

Writing – review & editing: Morteza M. Saber, B. Jesse Shapiro.

448

	  

18	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

449

References:

450

1.

Buniello A, MacArthur JAL, Cerezo M, Harris LW, Hayhurst J, Malangone C, et al. The

451

NHGRI-EBI GWAS Catalog of published genome-wide association studies, targeted arrays

452

and summary statistics 2019. Nucleic Acids Res. 2019;47:D1005–12.

453

2.

454
455

bacteriophage in invasive meningococci. J Exp Med. 2005;201:1905–13.
3.

456
457

Bille E, Zahar J-R, Perrin A, Morelle S, Kriz P, Jolley KA, et al. A chromosomally integrated

Falush D, Bowden R. Genome-wide association mapping in bacteria? Trends Microbiol.
2006;14:353–5.

4.

Alam MT, Petit RA, Crispell EK, Thornton TA, Conneely KN, Jiang Y, et al. Dissecting

458

vancomycin-intermediate resistance in Staphylococcus aureus using genome-wide association.

459

Genome Biol Evol. 2014;6:1174–85.

460

5.

Desjardins CA, Cohen KA, Munsamy V, Abeel T, Maharaj K, Walker BJ, et al. Genomic and

461

functional analyses of Mycobacterium tuberculosis strains implicate ald in D-cycloserine

462

resistance. Nat Genet. 2016;48:544–51.

463

6.

Chewapreecha C, Marttinen P, Croucher NJ, Salter SJ, Harris SR, Mather AE, et al.

464

Comprehensive identification of single nucleotide polymorphisms associated with beta-lactam

465

resistance within pneumococcal mosaic genes. PLoS Genet. 2014;10:e1004547.

466

7.

Lees JA, Croucher NJ, Goldblatt D, Nosten F, Parkhill J, Turner C, et al. Genome-wide

467

identification of lineage and locus specific variation associated with pneumococcal carriage

468

duration. Elife. 2017;6.

469

8.

Li Y, Metcalf BJ, Chochua S, Li Z, Walker H, Tran T, et al. Genome-wide association

470

analyses of invasive pneumococcal isolates identify a missense bacterial mutation associated

471

with

472

http://dx.doi.org/10.1038/s41467-018-07997-y

	  

meningitis.

Nat

Commun.

19	  

2019;10:1–11.

Available

from:

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

473

9.

Farhat MR, Shapiro BJ, Kieser KJ, Sultana R, Jacobson KR, Victor TC, et al. Genomic

474

analysis identifies targets of convergent positive selection in drug-resistant Mycobacterium

475

tuberculosis. Nat Genet. 2013;45:1183–1189.

476

10.

Farhat MR, Freschi L, Calderon R, Ioerger T, Snyder M, Meehan CJ, et al. GWAS for

477

quantitative resistance phenotypes in Mycobacterium tuberculosis reveals resistance genes and

478

regulatory

479

http://dx.doi.org/10.1038/s41467-019-10110-6

480

11.

regions.

Nat

Commun.

2019;10:2128.

Available

from:

Berthenet E, Yahara K, Thorell K, Pascoe B, Meric G, Mikhail JM, et al. A GWAS on

481

Helicobacter pylori strains points to genetic variants associated with gastric cancer risk. BMC

482

Biol 2018;16:84. Available from: https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-

483

018-0550-3

484

12.

485
486

Laabei M, Recker M, Rudkin JK, Aldeljawi M, Gulay Z, Sloan TJ, et al. Predicting the
virulence of MRSA from its genome sequence. Genome Res. 2014;24:839-49.

13.

Maury MM, Tsai Y-H, Charlier C, Touchon M, Chenal-Francisque V, Leclercq A, et al.

487

Uncovering Listeria monocytogenes hypervirulence by harnessing its biodiversity. Nat Genet.

488

2016;48:308–13.

489

14.

Sheppard SK, Didelot X, Meric G, Torralbo A, Jolley KA, Kelly DJ, et al. Genome-wide

490

association study identifies vitamin B5 biosynthesis as a host specificity factor in

491

Campylobacter. Proc Natl Acad Sci U S A. 2013;110:11923–7.

492

15.

Collins C, Didelot X. A phylogenetic method to perform genome-wide association studies in

493

microbes that accounts for population structure and recombination. PLoS Comput Biol.

494

2018;14:e1005958.

495

16.

496

Power RA, Parkhill J, de Oliveira T. Microbial genome-wide association studies: lessons from
human GWAS. Nat Rev Genet. 2017;18:41–50.

	  

20	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

497

17.

498
499

Chen PE, Shapiro BJ. The advent of genome-wide association studies for bacteria. Curr Opin
Microbiol 2014;25:17–24. Available from: http://dx.doi.org/10.1016/j.mib.2015.03.002

18.

Lees JA, Vehkala M, Välimäki N, Harris SR, Chewapreecha C, Croucher NJ, et al. Sequence

500

element enrichment analysis to determine the genetic basis of bacterial phenotypes. Nat

501

Commun. 2016;7:12797. Available from: https://doi.org/10.1038/ncomms12797

502

19.

Salipante SJ, Roach DJ, Kitzman JO, Snyder MW, Stackhouse B, Butler-Wu SM, et al. Large-

503

scale genomic sequencing of extraintestinal pathogenic Escherichia coli strains. Genome Res.

504

2015;25:119–28. Available from: https://www.ncbi.nlm.nih.gov/pubmed/25373147

505

20.

Bartha I, Carlson JM, Brumme CJ, McLaren PJ, Brumme ZL, John M, et al. A genome-to-

506

genome analysis of associations between human genetic variation, HIV-1 sequence diversity,

507

and

508

https://www.ncbi.nlm.nih.gov/pubmed/24171102

509

21.

viral

control.

Elife.

2013;2:e01123–e01123.

Available

from:

Mostowy R, Croucher NJ, Andam CP, Corander J, Hanage WP, Marttinen P. Efficient

510

Inference of Recent and Ancestral Recombination within Bacterial Populations. Mol Biol

511

Evol. 2017;34:1167–82.

512

22.

Power RA, Davaniah S, Derache A, Wilkinson E, Tanser F, Gupta RK, et al. Genome-Wide

513

Association Study of HIV Whole Genome Sequences Validated using Drug Resistance. PLoS

514

One. 2016;11:e0163746. Available from: https://doi.org/10.1371/journal.pone.0163746

515

23.

Earle SG, Wu CH, Charlesworth J, Stoesser N, Gordon NC, Walker TM, et al. Identifying

516

lineage effects when controlling for population structure improves power in bacterial

517

association

518

http://www.ncbi.nlm.nih.gov/pubmed/27572646

	  

studies.

Nat

Microbiol.

21	  

2016;1:16041.

Available

from:

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

519

24.

Jaillard M, Lima L, Tournoud M, Mahe P, van Belkum A, Lacroix V, et al. A fast and agnostic

520

method for bacterial genome-wide association studies: Bridging the gap between k-mers and

521

genetic events. PLoS Genet. 2018;14:e1007758.

522

25.

Arango-Argoty G, Garner E, Pruden A, Heath LS, Vikesland P, Zhang L. DeepARG: a deep

523

learning approach for predicting antibiotic resistance genes from metagenomic data.

524

Microbiome. 2018;6:23.

525

26.

Drouin A, Giguere S, Deraspe M, Marchand M, Tyers M, Loo VG, et al. Predictive

526

computational

527

comparisons. BMC Genomics. 2016;17:754.

528

27.

phenotyping

and

biomarker

discovery

using

reference-free

genome

Pesesky MW, Hussain T, Wallace M, Patel S, Andleeb S, Burnham C-AD, et al. Evaluation of

529

Machine Learning and Rules-Based Approaches for Predicting Antimicrobial Resistance

530

Profiles in Gram-negative Bacilli from Whole Genome Sequence Data. Front Microbiol.

531

2016;7:1887. Available from: https://www.frontiersin.org/article/10.3389/fmicb.2016.01887

532

28.

533
534

Hodge SE, Greenberg DA. How Can We Explain Very Low Odds Ratios in GWAS? I.
Polygenic Models. Hum Hered. 2016;81:173–80.

29.

Miotto P, Tessema B, Tagliani E, Chindelevitch L, Starks AM, Emerson C, et al. A

535

standardised method for interpreting the association between mutations and phenotypic drug

536

resistance in Mycobacterium tuberculosis. Eur Respir J. 2017;50. Available from:

537

http://erj.ersjournals.com/content/50/6/1701354.abstract

538

30.

Suzuki R, Shimodaira H. Pvclust: an R package for assessing the uncertainty in hierarchical

539

clustering.

540

https://doi.org/10.1093/bioinformatics/btl117

	  

Bioinformatics.

2006;22:1540–2.

22	  

Available

from:

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

541

31.

Corander J, Marttinen P, Sirén J, Tang J. Enhanced Bayesian modelling in BAPS software for

542

learning genetic structures of populations. BMC Bioinformatics. 2008;9:539. Available from:

543

https://doi.org/10.1186/1471-2105-9-539

544

32.

545
546

Lees JA, Harris SR, Tonkin-Hill G, Gladstone RA, Lo SW, Weiser JN, et al. Fast and flexible
bacterial genomic epidemiology with PopPUNK. Genome Res. 2019;29:304–16.

33.

Purcell S, Neale B, Todd-Brown K, Thomas L, Ferreira MAR, Bender D, et al. PLINK: a tool

547

set for whole-genome association and population-based linkage analyses. Am J Hum Genet.

548

2007;81:559–75.

549

34.

Lees JA, Galardini M, Bentley SD, Weiser JN, Corander J. pyseer: a comprehensive tool for

550

microbial pangenome-wide association studies. Bioinformatics. 2018;34:4310–2. Available

551

from: https://www.ncbi.nlm.nih.gov/pubmed/30535304

552

35.

Corander J, Croucher NJ, Harris SR, Lees JA, Tonkin-Hill G. Bacterial Population Genomics

553

[Internet]. Handbook of Statistical Genomics. 2019. p. 997–1020. (Wiley Online Books).

554

Available from: https://doi.org/10.1002/9781119487845.ch36

555

36.

556
557

Nat Genet. 2012;44:821–4. Available from: https://www.ncbi.nlm.nih.gov/pubmed/22706312
37.

558
559

Zhou X, Stephens M. Genome-wide efficient mixed-model analysis for association studies.

Lippert C, Listgarten J, Liu Y, Kadie CM, Davidson RI, Heckerman D. FaST linear mixed
models for genome-wide association studies. Nat Methods. 2011;8:833–5.

38.

Yang Y, Niehaus KE, Walker TM, Iqbal Z, Walker AS, Wilson DJ, et al. Machine learning for

560

classifying tuberculosis drug-resistance from DNA sequencing data. Bioinformatics.

561

2018;34:1666–71.

562

39.

	  

Gernhard T. The conditioned reconstructed process. J Theor Biol. 2008;253:769–78.

23	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

563

40.

564
565

genome evolution. Mol Biol Evol. 2012;29:1115–23.
41.

566
567

42.

Huang W, Li L, Myers JR, Marth GT. ART: a next-generation sequencing read simulator.
Bioinformatics. 2012;28:593–4.

43.

570
571

Cartwright RA. DNA assembly with gaps (Dawg): simulating sequence evolution.
Bioinformatics. 2005 Nov;21 Suppl 3:iii31-8.

568
569

Dalquen DA, Anisimova M, Gonnet GH, Dessimoz C. ALF--a simulation framework for

Li H, Durbin R. Fast and accurate short read alignment with Burrows-Wheeler transform.
Bioinformatics. 2009;25:1754–60.

44.

McKenna A, Hanna M, Banks E, Sivachenko A, Cibulskis K, Kernytsky A, et al. The Genome

572

Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing

573

data. Genome Res. 2010;20:1297–303.

574

45.

575
576

Yang J, Lee SH, Goddard ME, Visscher PM. GCTA: a tool for genome-wide complex trait
analysis. Am J Hum Genet. 2011;88:76–82.

46.

Chewapreecha C, Harris SR, Croucher NJ, Turner C, Marttinen P, Cheng L, et al. Dense

577

genomic sampling identifies highways of pneumococcal recombination. Nat Genet.

578

2014;46:305:309

579

47.

Li H. A statistical framework for SNP calling, mutation discovery, association mapping and

580

population genetical parameter estimation from sequencing data. Bioinformatics [Internet].

581

2011;27:2987–93. Available from: https://www.ncbi.nlm.nih.gov/pubmed/21903627

582

48.

Jia B, Raphenya AR, Alcock B, Waglechner N, Guo P, Tsang KK, et al. CARD 2017:

583

expansion and model-centric curation of the comprehensive antibiotic resistance database.

584

Nucleic Acids Res. 2017;45:D566–73.

	  

24	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

585

49.

586
587

Torsten Seemann. Snippy: fast bacterial variant calling from NGS reads. 2019. Available
from: https://github.com/tseemann/snippy

50.

588

Barrett JC, Fry B, Maller J, Daly MJ. Haploview: analysis and visualization of LD and
haplotype maps. Bioinformatics. 2005;21:263–5.

589
590
591

	  

25	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

592

Figures

593
594

Figure 1. Overview of the bacterial GWAS simulation (BacGWASim) pipeline.

595

(a) Taking a bacterial genome and annotations as input, evolutionary events are simulated across the

596

branches of the phylogenetic tree (either user-defined or simulated based on a birth-death model),

597

producing the final genomes and simulated markers as output. A phenotype is then assigned to each

598

simulated sample based on the presence/absence of a set of causal SNPs. (b) Binary phenotypic states,

599

shown as red or blue branches, mostly cluster in monophyletic subpopulations of closely-related

600

individuals due to population structure. The external rings denote the allele (red or blue) at each of the

601

simulated causal loci (shown as concentric rings).

	  

26	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

602
603

Figure 2. Landscape of genome-wide linkage disequilibrium (LD) in bacterial species compared

604

to BacGWASim simulations. The distribution of linkage, measured as r2 scores binned into three

605

categories, is shown as a function of distance in the genome, in units of kilobase pairs, within

606

genomes of simulated (left panels) and real (right panels) bacteria.

	  

27	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

607
608

Figure 3. Performance of GWAS methods in simulations with low LD. The boxplots on the left (a,

609

b, c) show the median and interquartile range, averaged across a range of effect sizes (log (OR=1 to 3)

610

The surface plots on the right (d, e, f) show recall rates in separate categories of effect sizes. (a) F1

611

score of bacterial GWAS methods across a range of sample sizes under low LD. (b) Recall rates

612

across the range of sample sizes. (c) Precision rates across the range of sample sizes.

613

	  

28	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

614
615

Figure 4. GWAS performance varies according to different levels of correction for population

616

structure in a dataset of 3,000 genomes simulated under low LD.

617

(a) Effect of the clustering threshold in terms of the maximum number of individuals per cluster on

618

GWAS. (b) GWAS power (recall) across a range of clustering thresholds for identifying causal

619

markers within separate categories of effect sizes. (c) Effect of variation in the number of included

620

principal components as covariates used for correction. (d) GWAS power (recall) across a range of

621

included principal components for detecting causal markers within separate categories of effect sizes.

622
623

	  

29	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

624
625

Figure 5. Performance of LMM-based GWAS methods in a dataset of 3,000 simulated genomes

626

under low LD.

627

(a) Comparison of different implementations of linear mixed models in terms of precision, recall and

628

F1 scores. (b) Comparison of the recall (power) of different implementations of linear mixed models

629

in identifying causal markers within separate categories of effect sizes.

630

	  

30	  

bioRxiv preprint doi: https://doi.org/10.1101/795492; this version posted October 7, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC 4.0 International license.

631
632

Figure 6. Effect of LD on GWAS performance.

633

(a) F1 score (b) recall and (c) precision of GWAS methods in datasets of 3000 genomes with low,

634

moderate and high genome-wide LD levels.

	  

31	  

