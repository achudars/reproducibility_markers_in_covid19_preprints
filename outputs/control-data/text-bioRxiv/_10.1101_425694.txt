bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Propagation of orientation selectivity in a spiking
network model of layered primary visual cortex
Benjamin Merkt1,2 , Friedrich Schüßler1 and Stefan Rotter1,2∗
1
2

Bernstein Center Freiburg, University of Freiburg, 79104 Freiburg, Germany
Faculty of Biology, University of Freiburg, 79104 Freiburg, Germany
* stefan.rotter@bio.uni-freiburg.de

1

Abstract

22

Neurons in different layers of sensory cortex generally have different functional
properties. But what determines firing rates and tuning properties of neurons in
different layers? Orientation selectivity in primary visual cortex (V1) is an interesting case to study these questions. Thalamic projections essentially determine
the preferred orientation of neurons that receive direct input. But how is this
tuning propagated though layers, and how can selective responses emerge in layers that do not have direct access to the thalamus? Here we combine numerical
simulations with mathematical analyses to address this problem. We find that a
large-scale network, which just accounts for experimentally measured layer and celltype specific connection probabilities, yields firing rates and orientation selectivities
matching electrophysiological recordings in rodent V1 surprisingly well. Further
analysis, however, is complicated by the fact that neuronal responses emerge in
a dynamic fashion and cannot be directly inferred from static neuroanatomy, as
some connections tend to have unintuitive effects due to recurrent interactions and
strong feedback loops. These emergent phenomena can be understood by linearizing and coarse-graining. In fact, we were able to derive a low-dimensional linear
dynamical system effectively describing stimulus-driven activity layer by layer. This
low-dimensional system explains layer-specific firing rates and orientation tuning by
accounting for the different gain factors of the aggregate system. Our theory can
also be used to design novel optogenetic stimulation experiments, thus facilitating
further exploration of the interplay between connectivity and function.

23

Author summary

2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21

24
25
26
27
28
29
30
31
32
33
34
35
36
37

Understanding the precise roles of neuronal sub-populations in shaping the activity of networks is a fundamental objective of neuroscience research. In complex
neuronal network structures like the neocortex, the relation between the connectome and the algorithm implemented in it is often not self-explaining. To this end,
our work makes three important contributions. First, we show that the connectivity
extracted by anatomical and physiological experiments in visual cortex suffices to
explain important properties of the various sub-populations, including their selectivity to visual stimulation. Second, we introduce a novel system-level approach
for the analysis of input-output relations of recurrent networks, which leads to the
observed activity patterns. Third, we present a method for the design of future
optogenetic experiments that can be used to devise specific stimuli resulting in a
predictable change of neuronal activity. In summary, we introduce a novel framework to determine the relevant features of neuronal microcircuit function that can
be applied to a wide range of neuronal systems.

1

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

38

39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83

Introduction
Understanding the complex computations performed by neural networks in the nervous
system is a central challenge in neuroscience. In recent years, research in rodent sensory systems has provided access to many new facts, but has also raised new theoretical
questions. In particular, the role of cortical layers (Niell and Stryker, 2008; Potjans and
Diesmann, 2014) and other distinct subpopulations (Durand et al., 2016; Pakan et al.,
2016) has received increasing attention. While the anatomical path of sensory input from
the thalamus through cortical layers has been particularly well characterized for the visual
system, it provides little explanation yet how the information is processed and transformed
in transit. Here, we apply computational neuroscience techniques to gain new insight into
the various computational steps within a highly recurrent neural network.
From a theoretical perspective, the cortical network constitutes a dynamical system,
which operates on different types of sensory input. To study basic properties of such
networks, its input has been assumed to be identical for all neurons (Amit and Brunel,
1997; Brunel, 2000). In a sensory system, however, the input varies across neurons,
as sensors extract different aspects of the stimulus. The primary visual cortex (V1)
represents an interesting example to study such systems (Hansel and van Vreeswijk, 2012;
Sadeh et al., 2014). In this case, non-homogeneous input for example carries information
about the orientation of moving gratings or light bars presented to the eye of an animal
(Hubel and Wiesel, 1959).
A major difference of rodent visual cortex compared to carnivores and primates is
the absence of orientation columns and maps (Ohki et al., 2005). Although the ”saltand-pepper” organization of orientation preferences implies that lateral interactions are
quite unspecific (Jia et al., 2010; Ko et al., 2011), neurons nevertheless exhibit responses
that are strongly tuned with respect to oriented light bars or gratings (Niell and Stryker,
2008; Hofer et al., 2011; Durand et al., 2016). Interestingly, this output tuning is already
present at eye opening in juvenile mice, where recurrent connectivity appears to be functionally random (Ko et al., 2013). In recent theoretical studies, this phenomenon could
be explained by a strong attenuation of the untuned component of the distributed input,
due to the dominance of inhibition in the recurrent network (Hansel and van Vreeswijk,
2012; Pehlevan and Sompolinsky, 2014; Sadeh et al., 2014; Sadeh and Rotter, 2014, 2015).
While these previous works identified the mechanism underlying strong output tuning in
the primary visual cortex of rodents, they provide no explanation for the different degrees
of orientation selectivity in different sub-populations, like cortical layers.
In the present work, we apply computational network modeling techniques to study
the emergence of orientation selectivity in a layered cortical network model, with a focus
on the differences between layers and neuronal subpopulations. As a starting point, we
adopt the anatomically and physiologically founded network model developed by Potjans
and Diesmann (2014) and extend it by orientation selective input similar to Sadeh et al.
(2014). We model an experiment in which an animal is shown a sinusoidal grating as a
visual stimulus. By this approach, we can focus on the influence of synaptic connectivity
on neuronal tuning as all other parameters are chosen to be the same over all populations.
Without any adaptation or fine-tuning of parameters, the resulting model matches the
distributions of orientation selectivity found in electrophysiological recordings, including
the weak tuning of inhibitory neurons as well as L5 pyramidal neurons. We then show
that these specific properties cannot be attributed to any specific projection in the circuit.

2

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

89

Rather, it is an emergent network feature of the entire recurrent microcircuit. Furthermore, we suggest a concept for the design of novel optogenetic stimulation experiments.
Applying this concept to the V1 cortical microcircuit, we can make specific predictions
for the outcome of experiments to manipulate the orientation selectivity of L5 principal
cells. The analysis of such experiments can eventually confirm or refute our analysis of
the circuit.

90

Methods

91

A multiplayer model of primary visual cortex

84
85
86
87
88

92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127

The network model considered throughout our study is, in essence, the same as the recurrent network model developed by Potjans and Diesmann (2014), extended by thalamic
input with a weak orientation bias as described in Sadeh et al. (2014). Potjans and Diesmann (2014) created a full-scale neural network model, matching as close as possible the
nervous tissue underneath 1 mm2 of neocortex. They incorporated a large set of experimental studies, most prominently the ones by Thomson et al. (2002) and Binzegger et al.
(2004). They derived a generic connectivity map between eight populations of neurons
situated in four layers (L2/3, L4, L5, L6), one excitatory (e) and one inhibitory (i) population in each layer (see Fig 1A for an illustration of the model). The model network
consists of close to 80 000 leaky integrate-and-fire neurons, where the respective size of
individual subpopulations varies strongly across layers. While the two largest populations (L4e and L2/3e) contain more than 20 000 neurons, L5e comprizes only about 5 000
neurons (Fig 1D). Throughout all layers, inhibitory populations are considerably smaller
than the respective excitatory populations, by a factor of four on average. In our work,
the leaky integrate-and-fire neurons are all equipped with delta synapses, i.e. with each
incoming spike, the membrane potential is instantaneously deflected by a fixed voltage J,
decaying with the membrane time constant τ . The synaptic efficacy J varies depending
on the source and target population, respectively.
Our model has a fixed number of synapses for each projection, i.e. each neuron of
the postsynaptic population P receives the same number of synaptic inputs KP T from
the presynaptic population T . For any postsynaptic neuron in the target population, the
presynaptic neurons are drawn randomly from the source population. The numbers KP T ,
which are the essential parameters of our model, were derived by Potjans and Diesmann
(2014) and are graphically represented in Fig 1B.
In addition to recurrent synaptic connections, neurons of the model network receive
external input from two different sources (Fig 1A). The first type of input, termed “background input” throughout this paper, is targeting all populations. It represents axons
from other cortical and subcortical regions, including gray matter and white matter projections (Fig 1B/E), but excludes those originating from the thalamus. These background
inputs are independent of the stimulus. In all simulations, they are modeled as Poisson
processes with rate νbg .
The second type of input is represented by thalamocortical projections that originate
from the lateral geniculate nucleus (LGN) (Fig 1B/F). In primary visual cortex, these
projections are the main source of information about a stimulus. This is the component
where we made an important addition to the original model of Potjans and Diesmann
(2014). We replaced the unspecific thalamic input with an input that depends in a specific
3

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 1: Model parameters. A Schematic of the model with eight populations in four
layers, thalamic and other background input. Triangles and circles denote excitatory and
inhibitory populations, respectively. B Total number of synapses each neuron receives (indegree) from any other neuronal population in the model, including input. C Input rate
variation over stimulus angles for single neurons in L4 and L6. The angle corresponding
to the peak of the curve is the preferred orientation of the thalamic input to that neuron.
D Total number of neurons in each of the eight subpopulations. E-F Input in-degree for
each neuron in each of the eight populations. Numbers are identical to the two right-most
columns of the matrix shown in B.

128
129
130
131
132
133

134
135
136
137
138
139
140
141

way on the stimulus. Throughout this paper, the stimuli considered were oriented moving
gratings, which are commonly used in visual neuroscience. Similar to Sadeh et al. (2014),
each neuron in one of the two populations that receive input (i.e. L4 and L6) is randomly
assigned a preferred orientation θ̂i to represent the tuning of the effective compound input
from all pre-synaptic thalamic neurons. Specifically, the input to each neuron depends on
the orientation θ of the stimulus and varies according to


(1)
νith (θ) = KPth ν0th 1 + m cos(2(θ − θ̂i )) .
Here, KPth is the in-degree of this projection, and ν0th is the mean rate of individual
thalamic neurons. We only require the compound input to be tuned and do not make
any assumptions about the origin of this tuning. An illustration of the input variation is
provided in Fig 1C. Note that orientations vary between 0◦ and 180◦ as we do not consider
direction selectivity in this study. Similar to the background input, the thalamic input
was conceived as a homogeneous Poisson process.
It is instructive to analyze and compare two different modes of operation. The stimulation condition is the situation described above, emphasizing the presentation of a
4

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

146

structured visual stimulus (here, a moving oriented grating) to the animal. In contrast,
the spontaneous condition emulates the presentation of a homogeneous gray screen to
the animal. In this case, the intensity of thalamic inputs is the same as the rate of the
background inputs. Moreover, the angular modulation m is set to zero, removing any
information about stimulus orientation from the input.

147

Implementations of the model

142
143
144
145

148
149
150
151
152

153
154
155
156
157
158
159
160
161
162

163
164
165
166
167
168
169

The results of this study are based on three different adaptations of the network model.
Each of them makes additional assumptions about the network dynamics to achieve different levels of abstraction and simplification. At the same time, all renderings are based
on the same connectivity parameters and the same single neuron model. In the following,
the three models will be briefly described.
Model A: spiking neuronal network model. The starting point for our analysis is
a spiking neuronal network, very similar to the implementation by Potjans and Diesmann
(2014). Here, for each of the close to 80 000 neurons, the temporal evolution of the membrane potential Vi (t) is simulated for each neuron i using standard numerical methods.
The interaction among neurons in the network is mediated by discrete spike events. Each
spike emitted by a pre-synaptic neuron depolarizes or hyperpolarizes the membrane potential of the post-synaptic neuron. The output of the recurrent network is defined in
terms of the spike trains of all neurons. Like Potjans and Diesmann (2014), we use the
spiking network simulation tool NEST (Gewaltig and Diesmann, 2007) to perform all the
necessary numerical simulations.
Model B: nonlinear firing rate model. Based on the spiking neural network model,
we also developed a neuron-by-neuron firing rate model, applying the theory developed by
Brunel (2000) to single neurons (Ostojic, 2014; Sadeh and Rotter, 2015). This approximation assumes that neuronal spike trains have Poissonian statistics and that correlations
among neurons are insignificant.
The network is characterized by the input-output transfer function Fi of each neuron,
leading to the network-level self-consistency equation
νi = Fi (ν, ν bg , ν th ),

170
171
172
173
174
175

176
177
178
179

(2)

where i = 1, . . . , N is the neuron index and ν, ν bg and ν th are the vectors of recurrent neuronal firing rates and input rates, respectively. Throughout this work, variables denoted
by th and bg refer to quantities originating from the thalamus or other external inputs,
respectively. Consequently, the model results in a high-dimensional system of nonlinear
algebraic equations to be solved numerically, yielding the firing rate νi of each individual
neuron.
Model C: linearized network model. Finally, based on Model B, we also derive a
linearized network model of the microcircuit. Fixing a point of linearization, for any input
perturbation ∆ν th , it predicts the perturbation of the single neuron firing rates ∆ν. In
the linear model, these can be explicitly calculated by
∆ν = (11 − W )−1 B ∆ν th .
5

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201

202
203
204
205

The matrices W and B are given by appropriate partial derivatives of the transfer function (Eq. 2). As the linearization point, we choose the activity into which the network
settles when thalamic neurons are completely silenced. This choice provides the greatest
flexibility in the further analysis. Consequently, with this linearization point, we have
∆ν th = ν th (Eq. 1).
The perturbation ∆ν th has different values for the two simulated conditions. In the
spontaneous condition, it is given by a homogeneous vector with the compound thalamic
baseline rate in all entries. In the stimulated condition, it contains the homogeneous
(constant) as well as the non-homogeneous (proportional to m) terms in Eq. 1. The
latter, therefore, also represents the specific, orientation dependent perturbation for each
neuron.
While the spiking network model (Model A) is the most realistic version from a biological perspective, accounting for irregular spike trains and activity fluctuations, it is
at the same time computationally expensive and analytically intractable. The firing rate
model (Model B) makes additional assumptions about the network activity, like negligible
correlations, but it has the advantage of being numerically tractable. Finally, while the
linear network model (Model C) ignores non-linear effects by construction, it has the great
benefit of allowing the application of a powerful linear algebra toolbox and enabling an
explicit solution of the system (Sadeh and Rotter, 2015).
Importantly, considering different implementations of the same model is only justified
if their predictions are consistent. Therefore, whenever possible throughout this work, we
cross-check the results of the different models.
Parameter variation. In addition to the standard parameter set adopted from Potjans
and Diesmann (2014), we also performed simulations with crucial model parameters varied. Hereby, we were able to evaluate the robustness of our results, and of the conclusions
drawn from them. In total, we used six different parameter sets:

206

• Standard: Default parameter set described below.

207

• High background: Background firing rate ν bg increased by a factor of 2.

208

• Low background:Background firing rate ν bg reduced by a factor of 2.

210

• Strong inhibition: Relative strength of inhibitory synapses increased by a factor of
2.

211

• Strong synapses: Strength of all recurrent synapses increased by a factor of 2.

212

• Low connectivity: Recurrent indegrees reduced by a factor of 2.

209

213

214
215
216
217

218
219

Data analysis
Measuring orientation selectivity. In order to quantify orientation selectivity, we
adopt a measure from circular statistics (Batschelet, 1981; Piscopo et al., 2013). If νk (θ)
is the firing rate of neuron k for stimulation angle θ, the orientation selectivity vector
(OSV) is calculated by
P
i2θ
θ νk (θ)e
,
OSVk = P
θ νk (θ)
which yields a complex number, equivalent to a vector with two real components. Here,
the two sums are running over all stimulation angles θ, or a uniform sample of angles in
6

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

220
221

a simulation. The orientation selectivity index (OSI) is then defined as the length of the
OSV
OSIk = |OSVk |.

223

The preferred orientation (PO) of a single neuron can be calculated from the angle of the
OSV
P Ok = arg(OSVk ).

224

Note that this definition of OSI is identical to

222

OSI =
225
226
227
228
229
230
231
232
233

where F 0 and F 1 are the zeroth and first Fourier components of the tuning curve, giving
rise to a more intuitive interpretation of the OSI. Here, F 0 accounts for the average firing
rate over all stimulation angles, and F 1 is to the amplitude of a cosine function accounting
for the lowest-order modulation over all angles. A perfect cosine tuning curve as assumed
for the input provided by thalamic neurons yields OSI = m2 , where m is the modulation
amplitude of the tuning curve (Eq. 1). The OSI as defined here provides a robust measure
of tuning strength, in particular for neurons with low firing rates and noisy responses.
An alternative measure for orientation selectivity also used in the literature is based
on the neuronal firing rates at the preferred and orthogonal orientation
OSIk∗ =

234
235
236
237

238
239
240

241
242
243
244

F1
F0

νk (P Ok ) − νk (P Ok − 90◦ )
νk (P Ok ) + νk (P Ok − 90◦ )

For noisy measurements, in particular for low firing rates, an estimation according to this
recipe is problematic. Therefore, we fit a cosine function with offset to the tuning curve
of each individual neuron and extract the maximum and minimum firing rates from this
fit.
Input currents. Our model uses a simple integrate-and-fire neuron model with deltasynapses. In this model, the mean current received by neuron i through synaptic input
from neuron j is given by
Iij = Cm Jij ν̄j ,
(3)
where ν̄j is the mean rate of neuron j. In order to quantify the information about the
stimulus contained in the input current received from any neuron in the network, we also
define a tuning vector (TV) of each synaptic connection. For a given pre-synaptic neuron
j and post-synaptic neuron i, it is defined by
TVij = Cm Jij ν̄j OSVj .

245
246
247
248

(4)

where ν̄j is the firing rate of neuron j averaged over all angles. Note that this is identical
to the first Fourier component (F1) of the tuning curve of the input current. The single
neuron tuning vectors TVij can then be used to quantify the combined tuning information
each neuron in the network receives from a given source population P by calculating
X
T ViP =
Kij TVij ,
j∈P

7

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

249

where Kij = 1 if neuron j makes a synapse onto neuron i, and Kij = 0 otherwise.

250

Detailed model descriptions

254

In the following, the mathematical model implementations are described in detail. While
this documentation allows to fully reproduce the model, it is not essential for the comprehension of the results of the study. In the main text of the manuscript we do not refer
to these details, and the reader may choose to directly jump to Results.

255

Model A: Spiking neural network model

251
252
253

256
257
258
259
260
261
262

263
264
265

We start by describing the spiking neural network model in detail. To a large extent, it is
identical to the original model introduced by Potjans and Diesmann (2014). It consists of
N = 77 169 neurons distributed over eight populations, one excitatory and one inhibitory
population in each out of four layers, respectively (Fig 1A). The individual population
sizes are summarized in Fig 1C and Table 2. We use the linear leaky integrate-and-fire
neuron model throughout this study. In this point neuron approximation, the membrane
potential Vi (t) of each individual neuron follows the differential equation


τm V̇i (t) = − Vi (t) − Vr + RIi (t).
(5)
Here, τm is the membrane time constant and Vr is the resting potential. The total input
current has three separate components Ii (t) = Iirec (t) + Iibg (t) + Iith (t). The recurrent
input is given by
N X
X
rec
Jij δ(tjk + dij − t),
RIi (t) = τm
j=1

266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286

k

where tjk is the time of the k-th spike of neuron j, dij is the transmission delay of the
connection, and Jij is the amplitude of the post-synaptic potential (synaptic “efficacy”)
from neuron j to neuron i. Each time the pre-synaptic neuron j fires a spike at time tjk ,
the membrane potential of neuron i is deflected by Jij at time tik + dij . If the membrane
potential reaches the threshold voltage Vthr , the neuron emits a spike that is transmitted
to all its post-synaptic neurons. Following each spike, the membrane potential is clamped
at the reset potential Vi = Vr for a refractory period τref . In our work, the synapse
model slightly differs from the original model of Potjans and Diesmann (2014). While
they used exponential post-synaptic currents, in our model all of the charge is delivered
instantaneously, as expressed by the δ-function in Eq. 5. Numerical values for the single
neuron parameters are summarized in Table 1.
The connectivity of the model was compiled in Potjans and Diesmann (2014) based on
a large number of anatomical and electrophysiological measurements, most prominently
by Thomson et al. (2002) and Binzegger et al. (2004). The connectivity map shown in
Fig 1B and Table 3 summarizes the result of an extended review of the literature. In our
implementation, these numbers describe the exact number of synapses each post-synaptic
neuron receives from randomly chosen pre-synaptic neurons in each of the eight populations. All connections are unitary, and self-connections are excluded. This fixed in-degree
connectivity deviates from the original model, where a fixed number of synapses was distributed by randomly drawing both target and source neurons, resulting in approximately
binomially distributed in- and out-degrees. Our modification results in a somewhat lower
8

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

parameter
value
τm
10
2
τref
40
R
Cm
250
-50
Vthr
Vr
-65
Je
0.15 ± 0.015
g
4
1.5 ± 0.75
dexc
dinh
0.7 ± 0.35
8
νbg
ν0th
30
0.3
m
θ
0, 15, ..., 165
θ̂i
[0, 180)
T
100
0.1
∆t

unit
ms
ms
MΩ
pF
mV
mV
mV
ms
ms
Hz
Hz
◦
◦

s
ms

Table 1: Single neuron parameter values. Shown are variable names, numerical
parameter values and, if applicable, the standard deviation of the Gaussian distribution,
as well as physical units.
population
size

L2/3e
20 683

L2/3i
L4e
L4i
L5e
L5i
L6e
L6i
5 834 21 915 5 479 4 850 1 065 14 395 2 948
Table 2: Populations sizes.

variability of rates and orientation selectivities in the populations.

postsynaptic

287

L2/3e
L2/3i
L4e
L4i
L5e
L5i
L6e
L6i

L2/3e L2/3i
L4e
2 199 1 079
979
2 990
860
703
159
34 1 117
1 480
16 1 813
2 188
374 1 135
1 165
159
570
325
38
467
766
5
74

presynaptic
L4i L5e L5i
L6e L6i
467 159
0
109
0
289 380
0
60
0
794
32
0
667
0
953
16
0 1 608
0
31 420 496
296
0
12 300 404
124
0
91 285 21
581 752
2 136
8
979 459

bg
1 600
1 500
2100
1 900
2 000
1 900
2 900
2 100

th
0
0
93
57
0
0
47
17

Table 3: In-degrees for individual projections.
288
289
290
291
292

Synaptic efficacies Jij are drawn from a normal distribution with a mean that depends
on the type of connection, and a standard deviation corresponding to 10% of the mean.
The mean is Je for excitatory and Ji = −g Je for inhibitory connections. As in the
model by Potjans and Diesmann (2014), the projection from L4e to L2/3e neurons is
an exception, where a mean efficacy of 2 Je is imposed. This modification is due to
9

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

293
294
295
296
297
298
299
300
301
302
303
304

inconclusive data for this particular projection, see (Feldmeyer et al., 2006; Potjans and
Diesmann, 2014) for details. For all unconnected pairs, we set Jij = 0. In order to obey
Dale’s principle, the normal distributions are clipped at zero. Similarly, delays dij are also
drawn from two normal distributions with fixed means and variances, dexc for excitatory
and dinh for inhibitory connections, respectively. The delay distributions are clipped at the
simulation time step ∆t. Numerical values for the distributions of connection strengths
and delays can be found in Table 1.
In addition to recurrent connections, neurons receive two types of external input. The
constant background input represents connections from other brain regions as well as
from neurons within V1, which are not part of the model network. It is realized as a
homogeneous Poisson input for each neuron. The resulting input current to each single
neuron is
X
RIibg (t) = τm
Jbg δ(t − tik ).
k

305
306
307
308
309
310
311
312

In this case Jbg = Je is the connection strength of background synapses, and tik is the time
of k-th spike of the Poisson process of neuron i. The rate of each Poisson process depends
on the population P the neuron belongs to and is given by νPbg = KPbg νbg . Here, KPbg is
the number of background synapses connecting to individual neurons in the respective
target population (Fig 1B/D and Table 3) and νbg is the rate of individual background
neurons.
Similar to background input, the thalamocortical input is also conceived as a homogeneous Poisson process. The current from the connections is given by
X
RIith (t) = τm
Jth δ(t − tik )
k

313
314
315

with Jth = Je . In contrast to the homogeneous background input to each individual
neuron, the rate of the thalamic input depends on the orientation θ of a grating that
represents the visual stimulus (Fig 1C). The resulting orientation-tuned input is given by

316



νith = KPth ν0th 1 + m cos(2(θ − θ̂i )) ,
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332

(6)

where KPth denotes the number of thalamocortical synapses per neuron in population P
(Fig 1B/E), ν0th is the fixed mean rate of thalamic neurons, m is the modulation strength
and θ̂i the preferred orientation of the input to this neuron. The latter is drawn from a
uniform distribution on [0◦ , 180◦ [. The network is simulated for twelve stimulation angles
θ from 0◦ to 165◦ in steps of 15◦ . Again, numerical values for all parameters can be found
in Table 1 and Table 3.
The non-homogeneous thalamic input is our most significant modification of the model
by Potjans and Diesmann (2014) to account for visual stimulation of the network. The
original model used a population of 902 thalamic neurons. However, in order to include
orientation tuning into the projection, it would be necessary to make assumptions on
how the input tuning is generated by the thalamocortical afferents. Because our work
concentrates on the cortical processing of tuning information, we replaced the thalamic
neurons by Poisson type tuned input.
Stimulation by a grating with each of the twelve angles θ is simulated for a total of
T = 100 s, with a simulation time step of ∆t = 0.1 ms. In addition, before the stimulation
starts, the network is simulated for a warm-up time of 200 ms to exclude onset transients
10

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

334

from the analysis. Spike times and the exact synaptic connectivity for all pairs of neurons
are extracted and stored for further analysis.

335

Model B: nonlinear firing rate model

333

336
337
338
339

To derive a firing rate model for the system under study, we apply the mean field approach
put forward by Brunel (2000) to each single neuron in all eight populations. We assume
that the total input to each neuron i amounts to a mean current µi and additive current
fluctuations (Gaussian white noise) η(t) with variance σi2
√
RIi (t) = µi + σi τm η(t).

340
341
342

This way, we can characterize the stationary state, in which µi and σi are fixed parameters
that depend on the thalamic input. Similar to the total input current, the mean and
variance can be separated into three sources
bg
th
µi = µrec
i + µi + µi
2

2

2

σi2 = σirec + σibg + σith .
343

For each source, the respective mean and variance are approximately given by
µrec
i

= τm

N
X

2
σirec

Jij νj ,

= τm

j=1

th
µth
i = τm Jth νi ,

345
346
347
348

Jij2 νj

j=1
2
σibg
2
σith

bg
µbg
i = τm Jbg νi ,

344

N
X

2
= τm Jbg
νibg
2 th
= τm Jth
νi ,

where independence of all input components has been assumed. As for the spiking model,
the in-degrees of the external input has been accounted for in νibg and νith . Furthermore,
νith accounts for the non-homogeneous input each individual neuron receives due to the
oriented stimulus according to Eq. 6. The self-consistent solutions of the associated firstpassage time problem (Siegert, 1951) yield the steady-state firing rates of all neurons

349

νi = Fi (ν, νith ),
350

with the transfer function Fi being defined by
Fi (ν, νith ) =

351

where
Φi (ν, νith )

352
353
354
355
356

(7)

√

= τref + τm π

1
Φi (ν, νith )
Vthr −µi
σi

Z

Vr −µi
σi

2

ex (1 + erf(x)) dx,

where erf is the standard error function. Solving this non-linear algebraic set of equations
yields the desired estimates for the firing rate of each single neuron.
The challenge is now to actually solve this 77 169-dimensional system of highly nonlinear self-consistency equations. This can be achieved by re-formulating the problem as
a Wilson-Cowan type model (Wilson and Cowan, 1972). Since we are only interested in
11

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

357
358
359

the fixed point describing the steady-state of the system, and not in its exact temporal
evolution, we choose a unit time constant and introduce a pseudo-time s. This allows to
write the problem as a system of ordinary differential equations

dν(s)
= −ν(s) + Fi ν(s), ν th .
ds

363

Assuming stability, these differential equations converge to a steady-state rate vector ν ∗
= 0. For the numerical solution,
which solves the system in Eq. 7 characterized by dν(s)
ds
we applied an explicit Runge-Kutta method of order (4)5 including adaptive step size
control (Hairer et al., 1993).

364

Model C: linearized network model

360
361
362

365
366
367

The linear model is derived from the rate coding model described above using a standard linearization procedure. We start by calculating the total derivative of the transfer
function Eq. 7
N
X
∂Fi
∂Fi
.
(8)
∆νj + th ∆νith
∆νi =
∂ν
∂ν
j
i
j=1
ν=νOP

368

The partial derivatives of the transfer function are given by
∂Fi
1 ∂Φi
=− 2
∂νj
Φi ∂νj
∂Φi
∂Φi ∂µi ∂Φi ∂σi
=
+
∂νj
∂µi ∂νj
∂σi ∂νj

369

where the partial derivatives of Φi are




Vthr − µi −1
Vr − µi −1
∂Φi
= erfcx −
− erfcx −
∂µj
σi
σi
σi
σi




∂Φi
Vthr − µi Vthr − µi
V r − µ i Vr − µ i
= erfcx −
− erfcx −
.
∂σj
σi
σi2
σi
σi2
2

370
371
372

Here, the Leibniz integral rule was used, and erfcx(x) = ex (1 − erf(x)) is the scaled
complementary error function. Finally, the partial derivatives of the mean and standard
deviation of the input are given by
∂µi
= τm Jij
∂νj
∂σi
1
=
τm Jij2 .
∂νj
2σi

373
374
375
376
377
378

Note that in all partial derivatives above, an explicit mention of the evaluation point
ν = νOP was omitted for the sake of a compact notation.
The operating point νOP at which the derivatives are evaluated can be chosen freely.
However, the precision of the linear approximation depends on the nature of the nonlinearity of the activity of the network, and how far the linearization point is away from
the regime of interest. Here, it is chosen as the activity with zero thalamic input, ν th = 0.
12

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

379
380
381
382
383
384

This choice provides the greatest flexibility in the predictions to be derived from the
model. In this case, for both conditions considered here, the thalamic input perturbation
is identical to the thalamic input rates, ∆νith = νith . Note that, while thalamic neurons do
not fire at the linearization point, the network does still receive background input from
other sources, leading to non-zero network activity at this point.
The derivatives of the transfer function are organized in a matrix W
Wij =

385

ν=νOP

and the diagonal matrix
Bij =

386

∂Fi
∂νj

∂Fi
∂νjth

.
ν=νOP

Eq. 8 can then be compactly written as
0 = (W − 11) ∆ν + B ∆ν th ,

387
388
389
390

where we also summarized the input and output rate perturbations into the vectors ∆ν
and ∆ν th . Assuming that (W − 11) is invertible, which is almost always the case for
the large random matrices considered here, and defining the scaled effective input ∆β =
B ∆ν th , we obtain the explicit expression for the output perturbation
∆ν = (11 − W )−1 ∆β.

391

(9)

In a next step, the effective input perturbation can be decomposed into
∆β = ∆βB + ∆βM ,

392
393
394
395
396
397
398

399
400
401

where ∆βB is the baseline and ∆βM is the modulation component, respectively (Sadeh
et al., 2014). The former is defined by ∆βB i = E[∆βi ], the vector of expected effective
input rates. Note that the expectation values are identical across all neurons of each
population. With this, we define ∆βM = ∆β−∆βB as the vector containing the deviations
from the population means.
Along the same lines, the matrix W can also be decomposed into two matrices such
that
W =Q+S
where Q is a block-wise constant matrix containing expectation values Qij = E[Wij ], and
S is composed of the zero-mean deviances S = W − Q. Combining the decomposition of
the input perturbation and the matrix, we can define two linear systems
∆νB = (11 − Q)−1 ∆βB
∆νM = (11 − S)−1 ∆βM .

402
403
404
405

(10)

In analogy to what was suggested by Sadeh et al. (2014), these two systems can be
interpreted as two separate processing pathways of the network. In the baseline system,
the matrix Q defines the processing of the untuned baseline input, while in the modulation
system, the matrix S is responsible for the input modulation. However, this characterizes

13

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

406
407
408
409
410
411
412
413
414
415
416
417
418

the system only, if there is no interference between the two pathways: The output ∆νB
should not contain a modulation component, and the output ∆νM should not contain a
baseline component. Furthermore, it is not obvious that the combination ∆ν = ∆νB +
∆νM solves the original W -system described in Eq. 9.
We start verifying these requirements by showing that ∆νB is constant across populations and thus does not contain a modulation component. To this end, a symmetry
argument can be applied: Let ∆νB i = x and ∆νB j = y for two neurons i and j of the
same population, then ∆νB i = y, ∆νB j = x must also be a solution of the system, as Q
is block-wise constant. As the operator (11 − Q)−1 is invertible and the system has only
one solution, it follows that x = y and ∆νB must be constant for all neurons from the
same population.
In order to show that ∆νM does not have a baseline component, we look at the
modulation system (Eq. 10) in its element-wise, implicit form
N
X

(δij − Sij ) ∆νM j = ∆νM i −

j=1
419
420

N
X

Sij ∆νM j = ∆βM i ,

j=1

where δij is the Kronecker delta function. Changing to the expectation value of the
expression and assuming independence of Sij and ∆νM j leads to
E[∆νM i ] −

N
X

E[Sij ] E[∆νM j ] = E[∆βM i ].

j=1
421

Noting that E[Sij ] = 0 and E[∆βM i ] = 0 by construction, this shows that
E[∆νM i ] = 0

422
423
424

(11)

and thus that ∆νM has no baseline component.
Finally, we show that ∆ν = ∆νB + ∆νM yields an approximate solution of the W system. For this, we substitute this ansatz and the decomposition W = Q + S into Eq. 9

425

(11 − W ) ∆ν = (11 − Q − S) (∆νB + ∆νM ) =
= ∆νB + ∆νM − Q ∆νB − Q ∆νM − S ∆νB −S ∆νM .
| {z } | {z }
(a)

426

427
428
429

431

(b)

We will now analyze the two interference terms (a) and (b) in more detail
1. The matrix Q is block-wise constant with value Qij = qP T for neurons i and j in
populations P and T , respectively. For each element in the vector Q ∆νM , we then
have
XX
X
X
(Q ∆νM )i =
Qij ∆νM j =
qP T
∆νM j .
T

430

(12)

Using Eq. 11, we know that

j∈T

P

j∈T

T

j∈T

∆νM ≈ 0 and therefore also Q ∆νM ≈ 0.

2. Similarly, for each element of the second interference term, we can write
X
X
(S ∆νB )i =
∆νB T
Sij ,
T

14

j∈T

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

432
433
434
435
436

where now ∆νB j = ∆νB T are the values of the population-wise constant vector ∆νB .
The matrix S is defined as the zero-mean deviations between W and Q. Therefore,
for sufficiently
large population sizes and small variances in the connectivity, we
P
have j∈T Sij ≈ 0 which leads to S ∆νB ≈ 0.
Combining these findings with Eq. 12, the expression can be reduced to
(11 − W ) ∆ν ≈ (11 − Q) ∆νB + (11 − S) ∆νM = ∆βB + ∆βM = ∆β,

437
438
439
440
441
442

443
444
445
446
447
448
449
450
451

by definition of ∆νB and ∆νM (Eq. 10), meaning that ∆ν = ∆νB + ∆νM indeed provides
an approximate solution to the system.
To summarize, we showed that instead of solving the linear model via the W -system
directly, it can also be studied in terms of the two pathways defined by Eq. 10. Provided
the two interference terms in Eq. 12 can indeed be neglected for the network at hand, this
is approximately equivalent and potentially more informative than the direct solution.
External stimulation. In addition to the synaptic input provided by the background
and the thalamus, neurons can also receive additional external stimulation I stim in an
experiment. Such an input could, for example, model optogenetic microstimulation. In
the single neuron rate model (Model B), this can be accounted for by an additional term
= RI stim . As we consider here only constant
in the total mean input µi given by µstim
i
2
stimulation, the variance σistim of this input is zero.
In the linear model (Model C), applying a current results in an additional input perturbation and an extra term in the total derivative (Eq. 8). In the explicit expression
Eq. 9, this can be accounted for by
∆ν = (11 − W )−1 (∆β + ∆γ).

452

The components of ∆γ are defined in analogy to the thalamic perturbation by
∆γi =

∂Fi
∆Ii
∂Ii

.
ν=νOP

453

Results

454

Spiking neuronal network simulations

455
456
457
458
459
460
461
462
463
464
465
466

The results of the spiking neural network simulations performed in NEST, and of the
detailed data analysis performed on the simulated data, are summarized in Fig 2, both
for the spontaneous (weak, untuned thalamic input) and stimulated (tuned thalamic
input) condition. Note that we do not subtract the spontaneous rates in the stimulated
condition for our analysis.
As expected, the single neuron firing rates (Fig 2B/C) match the values reported
by Potjans and Diesmann (2014). Fig 2D/E compares the firing rates of the model
with experimental values obtained by Niell and Stryker (2008) from adult mouse visual
cortex. In the spontaneous condition (Fig 2D), the model firing rates are somewhat lower
compared to experimental values, but are otherwise in good qualitative agreement with
them. We find very low activity in L2/3 and higher rates in the granular and infragranular
layers, with the exception of population L6e, where rates are also low.
15

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 2: Spiking neuronal network. A 250 ms raster plot for both spontaneous
and stimulated conditions, depicting 500 neurons of each of the eight subpopulations.
B-C Box plots of the firing rate distribution within each population, for spontaneous
(B) and stimulated (C) conditions, respectively. Shown are the median (central line),
lower and upper quartiles (box) as well as 5% and 95% percentiles (whisker bars). DE Comparison of median spontaneous (D) and evoked (E) rates between model results and
experimental values reported by (Niell and Stryker, 2008). Evoked rates are given by the
maximal response over all angles. The experimental results were obtained by summing the
spontaneous and evoked rates from (Niell and Stryker, 2008) for direct comparison. For
the model results, the inhibitory rates are averaged over all layers for better comparison
with the data from experiments.

467
468
469
470
471
472
473
474
475
476
477
478
479
480
481

For the stimulus condition, Fig 2E compares the evoked rates of the model with the
results of Niell and Stryker (2008). The evoked rates are defined as the maximal rate
of the individual neurons over all angles. Therefore, they differ from the median values
shown in Fig 2C. In this condition, the model rates vary more strongly across layers as
compared to the experimental values.
The mean and standard deviation (SD) of the pairwise spike-count correlations over
all populations are (0.2±10.3)·10−3 and (0.3±10.4)·10−3 for spontaneous and stimulated
conditions, respectively (10 ms bin size). The mean and SD of the coefficient of variation
(CV) of the inter-spike intervals are 0.9 ± 0.1 for both conditions. Both measures show
only small variations over different populations (see SFig 1 and SFig 2 for populationwise quantification). The low correlation and Poisson-like irregularity indicate that the
network indeed operates in the asynchronous irregular regime (Brunel, 2000; Renart et al.,
2010), as illustrated by the raster plot in Fig 2A.
The activity of the network is robust to changes in important parameters which are
not well constrained by experiments. Although average firing rates vary across parameter
16

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528

sets, their distribution remained qualitatively similar (SFig 4-9A/B). Only for very low
background input, the network operates in a more synchronous regime with increased
correlations (SFig 3B/C/SFig 6D). In this case, the network activity also changes qualitatively. Surprisingly, this is only the case for reduced input. For a two-fold increase, the
activity remains stable (SFig 3B/SFig 5D)
Our model extends the work of Potjans and Diesmann by giving the thalamic input
a weak orientation bias, as described previously (Hansel and van Vreeswijk, 2012; Sadeh
et al., 2014). The macroscopic connectivity pattern of the network (Fig 1A) already gives
a rough idea of the signal flow through the network. Thalamic afferents project mainly to
L4 and to a smaller extent also to L6. From L4, the signal is transmitted to L2/3, which is
thought to be the central processing unit of the microcircuit. Signals are then forwarded
to higher brain areas as well as to L5, which is the major output unit for projections to
sub-cortical brain areas.
In order to dissect the computations performed by the network, we extract tuning
curves of all neurons in the model network. As expected from previous studies (Hansel
and van Vreeswijk, 2012; Sadeh et al., 2014; Sadeh and Rotter, 2014, 2015), during stimulation, the weak orientation bias of the thalamic input is amplified to strongly orientation
selective responses in the input population (Fig 3). Interestingly, L2/3e also shows strong
tuning although these neurons only receive input via random connections from L4 neurons. This phenomenon was previously described by Hansel and van Vreeswijk (2012),
where projections from L4e to L2/3 were studied independently of other parts of the network. The strong tuning in L2/3e can be explained by a recurrent tuning amplification
in inhibition dominated networks (Hansel and van Vreeswijk, 2012; Sadeh et al., 2014).
This effect is enough to create strong output tuning from a small bias in the input, which
in turn is due to random sampling of preferred orientations in L4. In this context it may
seem even more surprising that orientation selectivity of L5 neurons appears to be weaker
compared to the other layers. This finding, which is a direct consequence of the underlying experimentally determined connectivity, is consistent with several measurements of
orientation selectivity performed in different rodent species (Heimel et al., 2005; Girman
et al., 1999; Niell and Stryker, 2008; Sun et al., 2016; Durand et al., 2016) (Fig 4D).
However, it cannot be easily explained by visual inspection of the connectivity matrix.
Even though synaptic connectivity is stronger for the projection to L2/3e, L5e neurons
also receive a large fraction of their input from L4e (Fig 1B, Table 3). Therefore, as the
output tuning of L2/3e neurons is essentially inherited from these neurons, one might
expect a stronger tuning also in L5e.
In order to understand in more detail the differences in orientation selectivity between
layers, we extracted the orientation selectivity index (OSI) of all neurons in the model
network (Fig 4B/C). We employ a measure based on the circular variance to quantify
orientation selectivity (see Methods for details). For each neuron, the OSI is calculated
as the ratio of first (F1) and zeroth (F0) Fourier component of the tuning curve (Fig 4A).
A stronger modulation of the firing rate over angles (higher F1), leads to a higher OSI,
while a higher mean rate (higher F0) reduces the OSI. Experimental studies often use
a different measure for orientation selectivity based on the activity at the preferred and
orthogonal orientation. To allow direct comparison with these works, we also calculated
this alternative quantity (SFig 10). While the absolute numbers are generally higher
for this measure, the qualitative results are identical. Note that also the distribution of
orientation tuning is quite robust against variations in parameters (SFig 4-9C).
17

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 3: Single neuron tuning curves. A Single neuron tuning curves are centered
at their respective preferred orientation and then binned over angles (bin size 10◦ ). 5%,
25%, 50% (median), 75% and 95% percentiles are then calculated for each bin independently and plotted using different line styles. Gray lines indicate median firing rates in
the spontaneous condition. B Sample tuning curves from each population in polar representation. Gray lines indicate rates of the same neuron in the spontaneous condition.

529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551

Consistent with experimental findings and throughout all layers, inhibitory neurons
have a lower OSI than the corresponding excitatory neurons (Niell and Stryker, 2008;
Scholl et al., 2015; Durand et al., 2016) (Fig 4D). While this might be expected for L4
and L6 due to the lower number of thalamic afferents, it is not at all obvious for L2/3. In
this population, it is a consequence of the recurrent network connectivity, as our analysis
will show.
Note that during spontaneous activity, neurons also exhibit weak apparent orientation
selectivity (Fig 4B). This is essentially due to fluctuations in the spiking process. Neurons
may randomly fire a few action potentials more for one orientation as compared to another,
which results in weak but nonzero orientation selectivity. The magnitudes found here are
consistent with a Poisson process with the same rate and recording time (data not shown).
The orientation selectivity is measured as the ratio of first and zeroth Fourier component of the tuning curves (Fig 4A). Analyzing the tuning curves in Fig 3A in more
detail, we see that although the F1 component in L5e is stronger than in L2/3e, this is
overcompensated by the high F0 component of this population, leading to weaker tuning
in L5e.
This raises two questions: First, which projections onto L2/3e and L5e lead to the
observed difference in activity? Second, why is the tuned (F1) component of L5e not as
strongly amplified as the mean rate (F0), similar to the situation in L2/3? In the following, we will address these questions, employing suitable mathematical and computational
methods. While the first question can be answered by analyzing the input currents received by the different populations, the second question requires an approach, which takes
the strongly recurrent nature of the circuit across layers into consideration.
18

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 4: Orientation selectivity in the spiking neural network. A Every single
neuron integrates its thalamic input with a large number of differently tuned inputs from
various cortical populations (right) and generates tuned output from it (left). The orientation selectivity index (OSI) of the neuron is measured by the relative strength of the
first (F1) as compared to the zeroth (F0) Fourier component of the output tuning curve
(circular variance). B-C OSI quantified for neurons in all layers, measured both under
spontaneous and stimulated conditions. Percentiles are the same as in Fig 2. D Comparison of mean orientation selectivities in the model with experimental values from (Niell
and Stryker, 2008).

552

553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570

Operating point of the network
Each neuron in the eight populations of the network receives inputs from several presynaptic populations, possibly all with different tuning curves, and forms its own output
tuning from those (Fig 4A). It has been shown in experiments that this scenario also
reflects the situation in rodents (Jia et al., 2010). Which projections are most potent for
driving the the target neuron is not immediately obvious from the anatomical connectivity between neurons (Fig 1B). The activity of pre-synaptic neurons is of course also
relevant for the total input current to a given neuron. In Fig 5A, the mean input current
(Eq. 3) for each projection between populations is shown. While the difference between
inputs to L2/3e and L5e seems insignificant when looking at the underlying connectivity
(Fig 1B), the picture changes completely if the activity of pre-synaptic neurons is taken
into consideration (Fig 5A). The input to L2/3e neurons is mostly determined by L2/3i,
both L4 populations and the constant background. Input to L5e, on the other hand, is
dominated by L5i and background input, but only to a lesser extent by inputs from L2/3i,
L4e and L5e. As a result, due to the different excitation-inhibition (EI) balance, the net
currents imply a higher mean input to L5e compared to L2/3e (Fig 5C).
The marked difference between anatomically defined connectivity (Fig 1B) and the
total input current in the stationary balanced state (Fig 5A) highlights the contribution
of activity dynamics in recurrent networks (Van Vreeswijk and Sompolinsky, 1996, 1998;
19

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 5: Neuronal input analysis. A Mean input currents for all projections between
all the involved neuronal populations. B Mean projection tuning vector length for all
recurrent projections (see text for explanation). C-E Output firing rates (F0 of tuning
curves), output modulations (F1 of tuning curves) and resulting OSI, averaged over each
population. F Illustration of single neuron input tuning vector addition. Each small
arrow represents the tuning vector of a single pre-synaptic neuron. Linearly adding the
vectors of all pre-synaptic neurons of one population results in the tuning vector that
characterizes the projection to one post-synaptic neuron.

571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589

Brunel, 2000). While the situation for L5e and L2/3e is very similar when counting the
number of excitatory and inhibitory synapses that terminate in each population, the actual current drive they receive is quite different. Since the activity of the whole network
autonomously settles in an operating point where the EI balance is dynamically maintained, this can have very different consequences for the various populations, irrespective
of the anatomical connectivity.
Having demonstrated how the dynamic equilibrium and the resulting operating point
of the layered network explains the high firing rate of L5 neurons, we can now ask the
same question with regard to orientation tuning in each neuronal population. In combination, these two aspects fully determine the orientation selectivity index (OSI) of all
neurons. To achieve this, we calculate for each neuron a tuning vector summarizing the
information about the stimulus conveyed by the input currents to that neuron. Its magnitude measures the tuning strength of the combined input to the post-synaptic neuron,
whereas its direction indicates its preferred orientation (Fig 5F inset, Eq. 4). The total
tuning input from one specific source population to a single neuron can then be calculated
as the sum of all tuning vectors of neurons in the pre-synaptic population which connect
to the post-synaptic neuron. If all tuning curves are cosine-like, this concept exactly corresponds to linear summation of inputs. In any case are the magnitudes of the tuning
vectors identical to the first Fourier component (F1) of the tuning curves for the current
20

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

609

input.
Fig 5B summarizes the mean lengths of all projection tuning vectors, summarizing
the information flow in the system. The tuning information enters the cortical network
in L4 and L6 and then spreads to the other populations. Although both L4 and L6
neurons show significant tuning to stimulus orientation, due to the low firing rates of
L6e neurons it is mostly L4, which provides tuning information to the other populations.
In contrast to what would be expected from the connectivity alone (Fig 1B), also L5e
neurons receive most of the tuned current from L4. Comparing the input to L2/3e and
L5e neurons in more detail reveals that L2/3e neurons mostly integrate tuned input from
both populations in L4, while L5e neurons receive less tuned input almost exclusively
from L4e.
Considering only the output modulation of the different populations (Fig 5D), which
is defined as the first Fourier component of the tuning curves (Fig 4A), it surprises that
despite the less tuned input to L5e, these neurons still show a stronger output modulation
than L2/3e. This highlights that, besides the input strength, the input sensitivity of
neurons is relevant as well. However, the large modulation component of the output of
L5e neurons cannot compensate their high firing rates, leading to a lower OSI (Fig 5CE). Comparing the distribution of firing rates and output modulations over the eight
populations (Fig 5C/D), it is evident that these two components are subject to different
gain factors. In the following, these dependencies will be studied in more detail.

610

Two processing pathways: baseline and modulation

590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608

611
612
613
614
615
616
617
618
619
620
621
622
623
624
625

Our analyses so far disentangled the input to neurons in different populations, which
explain the observed features of neuronal output. However, the multi-population model
is highly recurrent. Therefore, it is not yet clear why the input to all neurons settled in
the observed operating point. We face a chicken-and-egg problem here, as in the recurrent
network, the output of all populations is simultaneously the input to the same populations,
eventually settling in the dynamical operating point. In order to tackle this problem, we
now change our perspective from analyzing the input-output relation of single neurons
to input-output behavior of the entire network. The idea is to manage the problem by
considering the network as a distributed system, which can perform its function only as
a whole.
This approach is best realized by linearizing the network dynamics about its operating
point. We obtain our close to 80 000-dimensional linearized network model (Model C)
by first formulating a single neuron firing rate model based on the single neuron transfer
function Fi (ν, ν th ) (Model B). The firing rate model is then linearized about its dynamical
operating point, leading to the explicit input-output relation
∆ν = (11 − W )−1 ∆β.

626
627
628
629
630
631
632

(13)

Here, ∆ν is a vector summarizing all single neuron rate changes due to a change in the
effective input ∆β, which in turn is the change in thalamic input rate scaled by the
input sensitivities of the different populations. These sensitivities can also be understood
as the feed-forward gains of the system (Sadeh et al., 2014), see Methods for details.
Furthermore, the behavior of the recurrent model is governed by the matrix W , which
is the matrix of effective recurrent connections, which are a product of the anatomically
and physiologically defined synaptic weights and the input-output sensitivities (gains)
21

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679

of individual post-synaptic neurons at their operating point. In combination with the
activity at the operating point ν0 , the rate change ∆ν results in the output activity
ν = ν0 + ∆ν of the linear network model.
The explicit form of Eq. 13 also supports the idea of considering the network as an
integrated system with one single vector-valued input-output relation. Importantly, this
relation is governed by the inverse of the effective connectivity 11−W . Because the entries
in Wij are a function of Kij , this inversion potentially distributes the influence of each
single connectivity parameter Kij over the entire network. This observation also explains
why the effects of individual connectivity parameters can be counterintuitive (Tsodyks
et al., 1997).
The firing rate model (Model B) as well as the linear network model (Model C) can
be considered as simplifications of the spiking neural network (Model A), as they make
additional assumptions about its dynamics. Therefore, before analyzing these models
in more detail, it is important to establish the consistency of their respective behavior.
SFig 11 compares the results from a simulation of all three models, for matched network
parameters. We found that the single neuron firing rates of the three models are in good
agreement. While the similarity between the non-linear rate model (Model B) and the
linear model (Model C) is quite high, both exhibit mild discrepancies from the spiking
network model (Model A). In particular, for the larger firing rates of L5e, the non-linear
rate model and the linear model tend to slightly underestimate them. Generally, also
the preferred orientations and orientation selectivities are in good agreement between the
different models. While the match is again excellent for the non-linear firing rate model
and linear network model, both slighly deviate from the spiking network model . This can
be explained by the role played by activity fluctuations in this model. In particular, the
observed orientation selectivities are somewhat higher here, reflecting the same positive
bias as the one observed during spontaneous activity.
The match between the three models is also very robust with respect to changes in
parameters (SFig 4-9A-C). In fact, even for reduced background input, when there is
substantial synchrony in the spiking activity, the non-linear rate and linear models still
provide reasonable approximations (SFig 6A-C).
Now that the general consistency in the behavior of the different models is established,
we can analyze the linearized network and be confident that our conclusions are also valid
for the spiking network. In previous work, a separation into two separate, non-interfering
pathways were postulated, exploiting that the network can have different gains for different
components of its input (Sadeh et al., 2014) (Fig 6A). Specifically, the effective input
perturbation is split into a baseline and a modulation component such that ∆β = ∆βB +
∆βM . Here, we generalize this decomposition to our present multi-population model.
Furthermore, we present a novel analytical approach for their analysis.
For each population, the baseline ∆βB is conceived as the mean input these neurons
receive during stimulation. Since the mean input is different for each population, this
leads to a population-wise constant input vector (Fig 6B, red curve). The modulation
∆βM , in contrast, accounts for all neuron-by-neuron deviations from the population baseline, ∆βM := ∆β −∆βB , yielding a vector with zero mean in each of the eight populations
(Fig 6B, inset). Most importantly, the modulation component includes the tuning information that each neurons receives, based on the neuron-specific orientation bias of the
stimulus. In other words, the deviation of ∆βM from the baseline is determined by the
orientation of the stimulus, as described by Eq. 6.
22

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 6: Separate amplification/attenuation of non-informative baseline and
tuned modulation. A The input perturbation ∆β can be decomposed into baseline and
modulation, which are then amplified or attenuated by the network with different gains. B
Input perturbation for one particular orientation of the oriented stimulus. The effective
change in input rate is shown for each neuron in the eight populations of the layered
network (blue). The baseline (population mean) is depicted in red. The modulation,
which is the entry-wise difference between the two, is plotted in the inset (green). C
Solutions for the baseline and modulation system. Shown are the baseline (green) and
baseline plus modulation (red) output rates. For comparison, also the solution of the full
W system is shown (blue). The inset shows a magnification for a small sample of neurons
in population L4e.

680
681
682
683
684
685
686
687

Note that the baseline and modulation components are both only indirectly related
to mean rate (F0) and tuning strength (F1) discussed in the previous section. While
the latter were calculated for the tuning curve of each single neuron independently, the
baseline and modulation of the input were calculated over all neurons in one population,
for a single stimulation angle.
Separation of baseline and modulation pathway means that the two input components
∆βB and ∆βM are processed by two independent mechanisms with possibly distinct gains
γB and γM . As shown in Methods, the two pathways are governed by
∆νB = (11 − Q)−1 ∆βB
∆νM = (11 − S)−1 ∆βM ,

688
689

where the decomposition W = Q + S was used. Thereby, Q contains population-wise
expectation values, resulting in an 8 × 8 block structure, and S are the individual modu23

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

714

lations S = W −Q of single connections in the network. Importantly, there is no cross-talk
between the two pathways. A change in the input baseline ∆βB does not lead to change
in the output modulation ∆νM , and vice versa.
Solving these two systems independently yields two output rate changes ∆νB and ∆νM .
If the cross-terms in the calculations are indeed negligible, the solution ∆ν = ∆νB + ∆νM
provides a good approximation to the network behavior (see Eq. 12ff). For the network
under study here, the mean magnitudes µ of the cross-terms are µ[|Q∆νM |] = 0.02 and
µ[|S∆νB |] = 0.09 as compared to µ[|∆β|] = 3.63, implying that the system can indeed be
studied by treating the baseline and the modulation pathway separately. Similar numbers
are also obtained for the other parameter sets SFig 3E.
The solutions of the baseline and modulation systems, ∆νB and ∆νM , are shown in
Fig 6C in comparison to the solution of the W -system. Throughout all populations, the
separation solution is in excellent agreement with the direct solution. The modulation
part, which conveys the tuning information of the neurons, matches almost perfectly
(Fig 6C inset). The good agreement is further confirmed by the high coefficient of determination (“variance explained”) of R2 = 99.1%. For the different parameter sets, the
lowest R2 is obtained for increased background input with R2 = 98.0% (SFig 3D/SFig 49E). This demonstrates the robustness of the baseline and modulation decomposition also
with respect to changes in parameters.
In previous sections, we identified the high baseline rate of L5e as the main cause for
the low orientation selectivity of its neurons. This becomes manifest in a high baseline
output rate ∆νB for this particular population (Fig 6C). While this observation still does
not fully reveal the underlying reason for the high rates, it hints at the effective mean
connectivity represented by Q. In the following, we will therefore study the baseline
pathway in more detail.

715

Mode decomposition

690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713

716
717
718

We start by summarizing the results of Sadeh et al. (2014, 2015), where a similar scenario
for a two population EI network was studied. In analogy to the present model, the two
population system can also be described by a linear system of the form
∆ν = (11 − W )−1 ∆β,

719
720
721
722
723
724
725
726
727

where the dimensionality of the system equals the total number of neurons. In order to
study the network behavior, it is instrumental to inspect the eigenvalue spectrum of the
matrix W . In the two population case, when both populations receive the same input, the
eigenvalue spectrum consists of a bulk of known radius localized at the origin and a single
exceptional eigenvalue λ (Rajan and Abbott, 2006). For inhibition dominated networks,
this exceptional eigenvalue is real and negative (Fig 7A). Furthermore, the eigenvector
Ψ corresponding to that exceptional eigenvalue is the uniform vector, with all entries
identical. In this two-population network model, the baseline component of the input
perturbation is also proportional to the uniform vector
 
1
 .. 
∆βB ∝ Ψ ∝  .  .
1

24

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 7: Eigenmode analysis of input-output relations. A Eigenvalue spectrum
of the linearized model of Brunel (2000). The exceptional eigenvalue is shown in red, the
bulk spectrum in green. B Eigenvalues of the close to 80 000-dimensional linear system.
Blue and green dots indicate the exceptional and bulk eigenvalues of W , respectively.
Crosses mark eigenvalues of Q. C Eigenvalues of the matrix (11 − Q)−1 . D The eight
output modes of the Q system. Shown are the change in output rate for each single
neuron, due to each mode. Inset: Input perturbation decomposed into the eight modes,
which are also the right eigenvectors of Q.

728
729

Therefore, exploiting the eigenvector property of a baseline perturbation, the exceptional
eigenvalue can be transformed into the gain factor of the baseline
∆νB = (11 − W )−1 ∆βB = (1 − λ)−1 ∆βB = λ̃ ∆βB .

730
731
732
733
734
735
736
737
738
739
740
741
742

For inhibition dominated networks, this gain factor λ̃ has a small magnitude and thus
results in a strong attenuation of the baseline component. This, in turn, amplifies the
orientation selectivity of the network.
Generalizing the two-population scenario to the eight-population network considered
here, two major differences in terms of the eigenvalue spectrum of W become apparent.
First, instead of a single exceptional eigenvalue, the spectrum of the effective connectivity
is more complex (Fig 7B). In addition to the bulk of eigenvalues (diameter indicated
in green in Fig 7B), there are seven eigenvalues with a significantly larger magnitude
(blue dots in Fig 7B). In a random matrix theory context, it was previously shown that
the exceptional and bulk eigenvalues are due to the expectation values and variances
of the distribution of the elements of W . Therefore, the exceptional eigenvalues are
asymptotically identical to the eigenvalues of Q (Aljadeff et al., 2016). Indeed, the first
seven eigenvalues are in good agreement with the numerical calculations on W (crosses

25

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

743
744
745
746
747
748
749
750
751
752

in Fig 7B). Furthermore, an eighth exceptional eigenvalue is identified, which lies in the
middle of the bulk and could therefore not be distinguished from bulk eigenvalues in
numerical calculations on W .
The second difference compared to the two-population scenario is the fact that the
constant vector is not any more an eigenvector of an exceptional eigenvalue. Instead, the
eigenvectors of the baseline system Q are only population-wise constant (cf. Fig 7D inset).
However, also the input perturbation is not proportional to the constant vector in this
case. For each population, it depends on the sensitivity to thalamic input, also resulting
in a population-wise constant function. In order to study the input-output behavior, the
input can therefore be decomposed into the eight eigenvectors (cf. Fig 8 left)
∆βB =

8
X

ξi Ψi .

i=1
753
754
755
756
757
758
759

Here, Ψi are the eigenvectors of Q and ξi are the coefficients of the modes. The weighted
components ξi Ψi can be considered as the input modes of the input perturbation ∆βB .
The eight modes which represent the perturbation of the stimulation are shown in the inset
of Fig 7D. Note that the sum over these modes is identical to ∆βB in Fig 6B. Applying
the decomposition to the linear baseline system of Eq. 14 results in a decomposition of
the output rates of the network, where the eight exceptional eigenvalues define the gain
factors of the individual modes by (Fig 8 right)
∆νB =

8
X

λ̃i ξi Ψi .

(14)

i=1
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781

The transformed gain factors λ̃i are shown in Fig 7C. The individual parts of this decomposition can be considered as output modes of the system, with a direct one-to-one
relation to the input modes. The effect of the exceptional eigenvalues λ is quite similar to
the two-population scenario described previously, where the single exceptional eigenvalue
defined the gain of the homogeneous common mode. In the multi-population case, each
input mode is amplified with the respective gain λ̃i to form the output perturbation of
the network. The eight output modes are shown in Fig 7D. Note that, similar to the
input perturbation ∆βB , the sum of the modes is identical to the baseline component
∆νB shown in Fig 6C.
Studying the output modes in more detail, it is apparent that the high rates of L5e
neurons, and thus also their low orientation selectivity, are mostly due to one specific mode
(orange line in Fig 7D). On the other hand, the same mode has a similar strength as the
other components in the input space (orange line, Fig 7D inset). As the corresponding
eigenvalue of W has a very small magnitude, however, the gain factor λ̃ of that mode is
much larger compared to the other modes (Fig 7C, orange dot). Due to this gain, the mode
is dominant in the output rate change, resulting in high firing rates in L5e. The fact that
only a single mode is responsible for this strong amplification underlines our conclusion
that this effect is a feature of the whole network, which cannot be pinned down to one
specific connection in a meaningful way. Importantly, although the eigenvalue spectrum
and mode structure can change to some degree, the observation that a single mode with
a strong gain is responsible for the high rates of L5e is consistent for all parameter sets
considered (SFig 4-9F/G).
26

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 8: Eigenmode decomposition of input and output. Left: The baseline
component of the input perturbation ∆βB is decomposed into the eight input modes ξi Ψi .
Center: By the network action, each mode is amplified or attenuated by its individual
gain factor λ̃i . Right: The sum of all scaled output modes λ̃i ξi Ψi results in the baseline
component of the output perturbation ∆νB .

782

783
784
785
786
787
788
789
790
791
792
793
794
795

796
797
798
799
800
801
802
803
804
805
806
807
808
809
810

Predictions for new stimulation experiments
Having identified the large gain of a specific mode in the input as the source of the high
firing rates in L5e, we now apply our theory to predict the network behavior for a scenario,
where that particular mode is absent in the input. For two reasons the mode cannot be
directly removed from the input firing rates. First, that mode has nonzero coefficients
for all populations, which leads to non-zero thalamic input also to L2/3 and L5. While
it is technically possible to implement this in a computational model, it is infeasible as a
biological experiment. The second problem is more fundamental: Subtracting the mode
from the input perturbation would lead to negative firing rates, which cannot be realized.
Therefore, instead of using altered Poisson input to neurons, we designed an external
current stimulation, which has an equivalent effect on the neuronal output rates. It is
conceivable to realize such an input, for example by specific optogenetic stimulation. In
the linear model (Model C), an external current results in an additional input perturbation
∆γ such that
∆ν = (11 − W )−1 (∆β + ∆γ).
In order to delete a specific mode Ψk from the input, we can set ∆γ = −ξk Ψk . As
a consequence, when the two inputs ∆β and ∆γ are combined, the mode cancels out,
resulting in altered output perturbation.
The required input current for single neurons in each population are shown in Fig 9A.
They are not directly proportional to the deleted mode, due to the scaling by the individual
feed-forward gain of each population, as well as due to the highly recurrent processing
of the network. As expected, since the rate of L5e neurons should be suppressed, these
neurons receive a strongly negative current. More surprisingly, L2/3e requires a positive
input current of similar magnitude, although the desired change in rate of that population
is much smaller.
When the current is applied with an intensity that exactly removes the mode from the
input, the change in output exactly matches the sum of the remaining modes (Fig 9B,
relative intensity 1). For stronger stimulation intensities, the input mode is overcompensated. The mean population rates of the linearized network and spiking network model
are in good agreement. Also in the spiking neural network model, the mean rates change
27

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Figure 9: Predictions for future current stimulation experiments. A-C Current
stimulus 1: Effective deletion of a distinct mode from the input. D-F Current stimulus
2: Selective suppression of L5e activity. A,D Single neuron current stimulation required
to achieve the effect. B,E Change of the mean rate of excitatory populations upon current stimulation. Inhibitory populations are omitted for simplicity. x-axis shows current
intensity relative to values in A,D, respectively. In all panels, lines represent the linear
model (Model C), and dashed lines the spiking neural network simulations (Model A).
C,F Change of orientation selectivity in L2/3e and L5e due to the two different current
stimulations.

811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830

almost linearly, even if the input mode is overcompensated by a factor of two.
As expected, the reduction of L5e firing rates leads to an increase in orientation selectivity of 250% from 0.02 to 0.07 in the linearized network model (75% in the spiking
network model, Fig 9C). Simultaneously, due to the increase in firing rate in L2/3e, the
orientation selectivity of this population decreases by 66% from 0.12 to 0.04 in the linearized network model (25% in the spiking network model). The discrepancy between
the OSI of the spiking and linearized network model can be partially explained by the
bias of random tuning due to the fluctuations of the spiking process, which were also the
reason for non-zero OSIs observed in the spontaneous, unstimulated condition in Fig 4B.
Other contributions could come from a weak crosstalk between the baseline and modulation pathways, or from deviations from the assumptions of Poisson firing statistics and
negligible correlations.
Effectively deleting the mode from the input is not the only option to reduce the
activity of L5e neurons. From our analytic calculations, all feed-forward and recurrent
baseline gains are known. Exploiting this knowledge, we can design yet another current
stimulus that exclusively affects L5e neurons, leaving the mean firing rates of all other
populations unchanged (Methods). The desired change of rates for this stimulus can be
conveniently summarized in a vector ∆ν L5e . This vector is zero for all populations except
L5e. For this population, it contains the negative of the mean rates in the stimulation
condition such that the resulting rates vanish. The required effective external perturbation

28

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

831

can then be calculated by
∆γ = (11 − W ) ∆ν L5e ,

855

which are the external currents scaled with the known neuron sensitivities.
The required stimulation currents are shown in Fig 9D. Surprisingly, in this case, the
input currents to L5e neurons all need to be positive, although the desired effect on the
output rates is negative, and the rates of these neurons are reduced. It is also interesting
that input currents to all neurons except L4 are of similar strength. It is clear that
the other populations also require substantial stimulation to maintain their original rate,
since the altered rate of L5e neurons needs to be compensated. However, the magnitude
of these currents surprises as L5 does not serve as a major input to any other population
within the network (Fig 1B, Fig 5A). This highlights again the strongly recurrent and
often unintuitive nature of such networks.
Fig 9E shows that the new current stimulus successfully reduces the rate of L5e neurons, while keeping all other firing rates unchanged. Similar to the first current stimulus
discussed above, the two models match quite well. Only for strong stimulation intensities,
when the rates of L5e neurons approach zero, the two models show discrepancies. In this
regime, the rates of L5e begin to be rectified. Since this is a non-linear effect, it can of
course not be captured by the linearized version of the model.
Analogously to our first prediction for current stimulation, L5e neurons show a strong
increase in orientation selectivity (Fig 9F). In the linear model, the OSI rises very sharply
for large current intensities. This is an artifact of the neglected rectification of neuron
rates, as already observed above. In the more realistic spiking network model (Model A),
the OSI also increases strongly by about 150% (from 0.04 to 0.1). However, in contrast
to the first current stimulus discussed above, in this case orientation selectivity of L2/3e
neurons is not compromised by the additional input currents. The OSIs of the other
excitatory and inhibitory populations also remain unchanged (data not shown).

856

Discussion

832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854

857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873

Model. The goal of this work was to study signal propagation across layers in primary
visual cortex of rodents, with a particular focus on the emergence of orientation tuning in
layers that have no direct access to thalamic input. We decided to employ a model that
was developed previously by Potjans and Diesmann (2014). The synaptic connectivity
defining this model was rigorously derived from the results of anatomical and electrophysiological measurements. The parameters describing neuronal connectivity depend on
the pre-synaptic and post-synaptic population, but they do not depend on the functinal
properties (tuning) of individual neurons. Furthermore, in order to focus our analysis on
the impact of neuronal connectivity on dynamics, single-neuron parameters were chosen
the same for all neurons, independently of the population they belong to.
Since not all required connectivity data are available, Potjans and Diesmann (2014)
combined data from different species (cat and rat) into one single generic model circuit.
In addition, the measurements were performed in several different brain regions, so it
is debatable whether this model can account for information processing in mouse visual
cortex at all. In view of this, it may be surprising that the predictions of our study with
regard to neuronal activity are in very good agreement with direct electrophysiological
measurements performed in mouse visual cortex. This finding is in fact compatible with
29

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920

the idea of a universal cortical circuit which is found in different species and in different
cortical regions devoted to the processing of sensory information. It will be interesting
to see, to which degree a neural network model based on the full mouse/rat visual cortex
connectome (when it becomes available) at all deviates from the present model.
In our work, the model proposed by Potjans and Diesmann (2014) was extended by
adding neuron-specific thalamic input, which is tuned to the orientation of a visual stimulus, i.e., a moving grating. This input was provided to both the excitatory and inhibitory
populations in L4 and L6. From experiments, it is known that neurons modulate their
firing rate with the temporal frequency of the grating (Niell and Stryker, 2008; Durand
et al., 2016). However, in order to keep the already complex model and analysis as simple
as possible, we did not include this aspect of visual processing into our considerations.
In fact, our analysis showed that the cortical network operates in a quasi-linear regime.
Therefore, we expect that the additional temporal modulation of firing rates would not
have a significant impact on the mean values studied and reported here.
Via random connections, the very weak orientation bias in the input was enough to
induce strong orientation tuning in L2/3, see Hansel and van Vreeswijk (2012) and Sadeh
et al. (2014); Sadeh and Rotter (2014, 2015) for an analysis of this generic effect. Note,
however, that we did not make any assumptions about the origin of the orientation bias
in the input. It could be a consequence of the alignment of the receptive fields of afferent
neurons (Hubel and Wiesel, 1962), or it could be inherited from already tuned thalamic
neurons (Marshel et al., 2012; Piscopo et al., 2013; Scholl et al., 2013). While the input
was assumed to convey information about a visual stimulus throughout the present study,
our analysis of the layered network described here does not rely on this interpretation.
Our approach could therefore also be applied to study feature selectivity in other sensory
modalities, like in somatosensory or auditory cortex.
The distributions of orientation selectivity that emerge in our model across the different layers and neuronal populations are qualitatively very similar to experimental recordings (Heimel et al., 2005; Girman et al., 1999; Niell and Stryker, 2008; Sun et al., 2016;
Durand et al., 2016) (see also (Van den Bergh et al., 2010) for some inconclusive results).
This represents a remarkable result, as the model is based on measured connectivity in
different cortical regions in different species, and it was not at all designed and tuned
as a specific model of rodent visual cortex. Furthermore, the recordings cited above
were performed in adult mice, which are known to have some degree of feature-specific
connectivity. Our model, in contrast, entirely lacks specific connectivity, resembling the
situation at eye opening (Ko et al., 2013). Our analysis demonstrates that well-tuned
neuronal responses can emerge in all cortical layers without feature-specific connections
between neurons. On the other hand, it is known that specific connectivity can work
as a concurrent mechanism to improve orientation selectivity and yield the higher values
observed experimentally (see also (Sadeh et al., 2015)).
While the distribution of firing rates in spontaneous and evoked conditions are qualitatively similar to experimental findings (Niell and Stryker, 2008; Durand et al., 2016), there
are also discrepancies in several respects (Fig 2D/E). It is difficult to asses the impact of
these differences for the findings of our work. However, our results are generally robust to
changes in central network parameters, despite considerable rate changes. Therefore, we
expect that the neuronal mechanisms described in our work still apply when more precise
and detailed models of the microcircuit are developed.
In the present model, the mouse which is subject to visual stimulation is assumed to
30

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

921
922
923
924
925
926

927
928
929
930
931
932
933
934
935
936
937
938
939

940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957

958
959
960
961
962
963
964

be non-moving. As shown in a recent study (Durand et al., 2016), neuronal responses
in primary visual cortex of rodents are very similar in awake and anesthetized animals.
In contrast, the responses dramatically change during locomotion behavior (Niell and
Stryker, 2010). Different inhibitory neuronal subtypes play a central role in this (Pakan
et al., 2016). A future enhanced version of our model might account for such effects as
well.
Microcircuit perspective. While analyzing network activity in terms of firing rates
and orientation tuning, it becomes apparent that a direct interpretation of connectivity
cannot fully explain all features of the dynamics observed in network simulations. For
example, although afferent connectivity originating from L4e is very similar, firing rates
and orientation selectivity in L2/3e and L5e are quite different. As the input is comprised
of both excitatory and inhibitory projections that partially cancel each other, a small
difference in the input may have strong effects on the operating point the two populations
eventually settle in (Van Vreeswijk and Sompolinsky, 1996, 1998). Such effects are not
straight-forward to predict, since in a highly recurrent network neuronal output simultaneously also provides input to the same network. Sometimes this leads to non-intuitive
effects like effective inhibitory influence of excitatory neuron populations (Tsodyks et al.,
1997). To master such difficulties in the analysis, a system-level view of complex microcircuits is inevitable (Yuste, 2015; Bassett and Sporns, 2017).
Baseline and modulation pathways. Previously, inhibition dominated recurrent networks were shown to exhibit two distinct processing pathways (Sadeh et al., 2014). While
the untuned and uninformative component (baseline) of the input is strongly attenuated
by the recurrent network, the modulated component, which conveys all the information
about the stimulus, has a much higher gain. This results in a net amplification of feature
selectivity through the input-output transformation exerted by the network.
By separating the (linearized) layered model into two systems, we were able to analytically calculate the feed-forward and recurrent gains of the baseline pathway also for a
multi-population system. In combination, these two gains describe how the input to one
population affects the output of any other population. In contrast to our model, neurons
in the model of Potjans and Diesmann (2014) have binomially distributed in-degrees,
leading to a certain degree of cross-talk between the two pathways by non-vanishing interference terms in Eq. 12. While this introduces some discrepancies between the direct
and separate solutions of the linear model, it does not impair the described mechanism.
It should be emphasized that the separation between baseline and modulation pathways, its different gains, and thus also tuning amplification are purely linear effects. This
is possible, as a linear transformation may impose different scaling factors to different
input components.
Mode decomposition. Instead of analyzing the operation of a network from the viewpoint of neuronal populations, we chose a basis that is more natural for the network in
question. We decomposed the input into eigenmodes of the system, where the eigenvalues of the effective connectivity correspond to the gains of the individual input modes.
Interestingly, the high gain of L5e can be attributed to a single mode, which has a much
higher gain than all the other modes. Due to this mode, L5e neurons exhibit a high firing
rate and a weak selectivity for stimulus orientation.
31

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

965
966
967
968
969
970
971
972
973

974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004

1005
1006
1007

What is the functional significance of having a mode with this exceptionally high gain?
For a preliminary answer, it is important to take into consideration that the different populations in the layered cortical network play different roles for information processing. For
instance, L2/3e neurons project to higher brain areas and need to transmit information
in a reliable way (Felleman and Van, 1991). Therefore, it is desirable that this population has a strong attenuation of the baseline and, thus, strong tuning amplification.
L5e neurons, on the other hand, mainly project to sub-cortical brain regions, including
thalamus (Sherman, 2016). It is likely that this population is involved in feedback control
mechanisms, where tuning information may be less relevant.
Predictions for optogenetic intervention. Using the theory developed in this work,
we are in the position to devise external (e.g. optogenetically applied) stimuli which effectively manipulate the orientation tuning of L5e neurons. We designed two different such
stimuli which reduce the mean firing rates of these neurons, thus increasing their tuning.
Interestingly, although the effect on the rate of L5e is identical, one stimulus requires a
positive current, while the other utilizes a negative current. This can be explained by the
indirect effect of the stimulus on other populations, propagated via the recurrent network.
Our calculations constitute strong predictions of our model, which can be tested with
some effort in experiments. Different subpopulations can be stimulated by a combination of channelrhodopsin and halorhodopsin with different wavelength sensitivities, as
described by Klapoetke et al. (2014), possibly in combination with locally confined optical stimulation.
Throughout our study, and in particular for the derived predictions, the consistency
of results between the spiking network and the linear model are remarkable. Only for
very strong stimulation, when non-linear rectification sets in, some deviations become
evident. This confirms previous findings that a network of highly nonlinear neurons can
be effectively linearized about its dynamical operating point, which corresponds to the
balanced state of the excitatory-inhibitory network (Van Vreeswijk and Sompolinsky,
1996, 1998).
In our work, the newly developed mathematical tools were applied to design current
stimuli which effectively and selectively suppress L5e activity. In our model, all rate gains
are known from the decomposition into baseline and modulation pathways. Therefore,
other types of experiments can be performed as well, even for complex multi-population
networks different from the primary visual cortex. This makes the suggested method an
ideal tool for the design of external current stimuli in a large variety of experiments.
In summary, we presented a novel method for analyzing the dynamics of multipopulation networks in terms of their input-output relations. We applied the approach to
the analysis of a layered model of rodent visual cortex, revealing interesting and to some
degree also unexpected and non-intuitive consequences of the underlying connectivity.
In addition, we derived predictions for future optogenetic experiments, which could be
performed to test the power of our computational analysis.

Acknowledgments: This work was partially supported by the European Union’s Seventh Framework Programme (FP7/2007-2013) under Grant Agreement 600925 (NeuroSeeker), by the BMBF (grant BFNT 01GQ0830) and DFG (grant EXC 1086). The
32

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1012

HPC facilities are funded by the state of Baden-Württemberg through bwHPC and DFG
grant INST 39/963-1 FUGG. In addition, our work was promoted by the German Academic Exchange Service (DAAD) and the Carl Zeiss Stiftung. We thank Uwe Grauer
from the Bernstein Center Freiburg as well as Bernd Wiebelt and Michael Janczyk from
the Freiburg University Computing Center for their assistance with HPC applications.

1013

Code Accessibility: Simulation and analysis code is available upon request.

1014

Conflict of interests: The authors declare no competing financial interests.

1015

References

1008
1009
1010
1011

1016
1017

1018
1019

1020
1021

1022
1023

1024
1025

1026
1027

1028
1029
1030
1031

1032
1033
1034

1035
1036

1037
1038

1039
1040

1041
1042

Aljadeff, J., Renfrew, D., Vegué, M., and Sharpee, T. O. (2016). Low-dimensional dynamics of structured random networks. Physical Review E, 93(2):022302.
Amit, D. J. and Brunel, N. (1997). Model of global spontaneous activity and local structured activity during delay periods in the cerebral cortex. Cerebral Cortex, 7(3):237–252.
Bassett, D. S. and Sporns, O. (2017). Network neuroscience. Nature Neuroscience,
20(3):353.
Batschelet, E. (1981). Circular statistics in biology. ACADEMIC PRESS, 111 FIFTH
AVE., NEW YORK, NY 10003, 1981, 388.
Binzegger, T., Douglas, R. J., and Martin, K. A. (2004). A quantitative map of the circuit
of cat primary visual cortex. Journal of Neuroscience, 24(39):8441–8453.
Brunel, N. (2000). Dynamics of sparsely connected networks of excitatory and inhibitory
spiking neurons. Journal of Computational Neuroscience, 8(3):183–208.
Durand, S., Iyer, R., Mizuseki, K., de Vries, S., Mihalas, S., and Reid, R. C. (2016). A
comparison of visual response properties in the lateral geniculate nucleus and primary
visual cortex of awake and anesthetized mice. Journal of Neuroscience, 36(48):12144–
12156.
Feldmeyer, D., Lübke, J., and Sakmann, B. (2006). Efficacy and connectivity of intracolumnar pairs of layer 2/3 pyramidal cells in the barrel cortex of juvenile rats. The
Journal of physiology, 575(2):583–602.
Felleman, D. J. and Van, D. E. (1991). Distributed hierarchical processing in the primate
cerebral cortex. Cerebral Cortex, 1(1):1–47.
Gewaltig, M.-O. and Diesmann, M. (2007). Nest (neural simulation tool). Scholarpedia,
2(4):1430.
Girman, S. V., Sauvé, Y., and Lund, R. D. (1999). Receptive field properties of single
neurons in rat primary visual cortex. Journal of neurophysiology, 82(1):301–311.
Hairer, E., Nørsett, S. P., and Wanner, G. (1993). Solving ordinary differential equations.
i, springer series in computational mathematics.

33

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1043
1044
1045

1046
1047
1048

1049
1050
1051

1052
1053

1054
1055

1056
1057

1058
1059
1060

1061
1062
1063

1064
1065
1066

1067
1068
1069

1070
1071

1072
1073

1074
1075
1076

1077
1078

1079
1080
1081

Hansel, D. and van Vreeswijk, C. (2012). The mechanism of orientation selectivity in
primary visual cortex without a functional map. Journal of Neuroscience, 32(12):4049–
4064.
Heimel, J. A., Van Hooser, S. D., and Nelson, S. B. (2005). Laminar organization of
response properties in primary visual cortex of the gray squirrel (sciurus carolinensis).
Journal of neurophysiology, 94(5):3538–3554.
Hofer, S. B., Ko, H., Pichler, B., Vogelstein, J., Ros, H., Zeng, H., Lein, E., Lesica, N. A.,
and Mrsic-Flogel, T. D. (2011). Differential connectivity and response dynamics of
excitatory and inhibitory neurons in visual cortex. Nature Neuroscience, 14(8):1045.
Hubel, D. H. and Wiesel, T. N. (1959). Receptive fields of single neurones in the cat’s
striate cortex. The Journal of Physiology, 148(3):574–591.
Hubel, D. H. and Wiesel, T. N. (1962). Receptive fields, binocular interaction and functional architecture in the cat’s visual cortex. The Journal of Physiology, 160(1):106–154.
Jia, H., Rochefort, N. L., Chen, X., and Konnerth, A. (2010). Dendritic organization of
sensory input to cortical neurons in vivo. Nature, 464(7293):1307.
Klapoetke, N. C., Murata, Y., Kim, S. S., Pulver, S. R., Birdsey-Benson, A., Cho, Y. K.,
Morimoto, T. K., Chuong, A. S., Carpenter, E. J., Tian, Z., et al. (2014). Independent
optical excitation of distinct neural populations. Nature Methods, 11(3):338.
Ko, H., Cossell, L., Baragli, C., Antolik, J., Clopath, C., Hofer, S. B., and Mrsic-Flogel,
T. D. (2013). The emergence of functional microcircuits in visual cortex. Nature,
496(7443):96.
Ko, H., Hofer, S. B., Pichler, B., Buchanan, K. A., Sjöström, P. J., and Mrsic-Flogel, T. D.
(2011). Functional specificity of local synaptic connections in neocortical networks.
Nature, 473(7345):87.
Marshel, J. H., Kaye, A. P., Nauhaus, I., and Callaway, E. M. (2012). Anteriorposterior direction opponency in the superficial mouse lateral geniculate nucleus. Neuron, 76(4):713–720.
Niell, C. M. and Stryker, M. P. (2008). Highly selective receptive fields in mouse visual
cortex. Journal of Neuroscience, 28(30):7520–7536.
Niell, C. M. and Stryker, M. P. (2010). Modulation of visual responses by behavioral state
in mouse visual cortex. Neuron, 65(4):472–479.
Ohki, K., Chung, S., Ch’ng, Y. H., Kara, P., and Reid, R. C. (2005). Functional imaging
with cellular resolution reveals precise micro-architecture in visual cortex. Nature,
433(7026):597.
Ostojic, S. (2014). Two types of asynchronous activity in networks of excitatory and
inhibitory spiking neurons. Nature Neuroscience, 17(4):594.
Pakan, J. M., Lowe, S. C., Dylda, E., Keemink, S. W., Currie, S. P., Coutts, C. A., and
Rochefort, N. L. (2016). Behavioral-state modulation of inhibition is context-dependent
and cell type specific in mouse visual cortex. Elife, 5.
34

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1082
1083

1084
1085
1086

1087
1088
1089

1090
1091

1092
1093

1094
1095

1096
1097

1098
1099

1100
1101
1102

1103
1104
1105

1106
1107
1108

1109
1110

1111
1112

1113
1114
1115

1116
1117
1118
1119

Pehlevan, C. and Sompolinsky, H. (2014). Selectivity and sparseness in randomly connected balanced networks. PLoS One, 9(2):e89992.
Piscopo, D. M., El-Danaf, R. N., Huberman, A. D., and Niell, C. M. (2013). Diverse
visual features encoded in mouse lateral geniculate nucleus. Journal of Neuroscience,
33(11):4642–4656.
Potjans, T. C. and Diesmann, M. (2014). The cell-type specific cortical microcircuit:
Relating structure and activity in a full-scale spiking network model. Cerebral Cortex,
24:785–806.
Rajan, K. and Abbott, L. (2006). Eigenvalue spectra of random matrices for neural
networks. Physical Review Letters, 97(18):188104.
Renart, A., De La Rocha, J., Bartho, P., Hollender, L., Parga, N., Reyes, A., and Harris,
K. D. (2010). The asynchronous state in cortical circuits. Science, 327(5965):587–590.
Sadeh, S., Cardanobile, S., and Rotter, S. (2014). Mean-field analysis of orientation
selectivity in inhibition-dominated networks of spiking neurons. SpringerPlus, 3(1):148.
Sadeh, S., Clopath, C., and Rotter, S. (2015). Processing of feature selectivity in cortical
networks with specific connectivity. PloS one, 10(6):e0127547.
Sadeh, S. and Rotter, S. (2014). Distribution of orientation selectivity in recurrent networks of spiking neurons with different random topologies. PloS one, 9(12):e114237.
Sadeh, S. and Rotter, S. (2015). Orientation selectivity in inhibition-dominated networks
of spiking neurons: effect of single neuron properties and network dynamics. PLoS
Computational Biology, 11(1):e1004045.
Scholl, B., Pattadkal, J. J., Dilly, G. A., Priebe, N. J., and Zemelman, B. V. (2015). Local
integration accounts for weak selectivity of mouse neocortical parvalbumin interneurons.
Neuron, 87(2):424–436.
Scholl, B., Tan, A. Y., Corey, J., and Priebe, N. J. (2013). Emergence of orientation
selectivity in the mammalian visual pathway. Journal of Neuroscience, 33(26):10616–
10624.
Sherman, S. M. (2016). Thalamus plays a central role in ongoing cortical functioning.
Nature Neuroscience, 19(4):533.
Siegert, A. J. (1951). On the first passage time probability problem. Physical Review,
81(4):617.
Sun, W., Tan, Z., Mensh, B. D., and Ji, N. (2016). Thalamus provides layer 4 of primary visual cortex with orientation-and direction-tuned inputs. Nature Neuroscience,
19(2):308.
Thomson, A. M., West, D. C., Wang, Y., and Bannister, A. P. (2002). Synaptic connections and small circuits involving excitatory and inhibitory neurons in layers 2–5
of adult rat and cat neocortex: triple intracellular recordings and biocytin labelling in
vitro. Cerebral Cortex, 12(9):936–953.
35

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1120
1121
1122

1123
1124
1125

1126
1127

1128
1129

1130
1131

1132
1133

Tsodyks, M. V., Skaggs, W. E., Sejnowski, T. J., and McNaughton, B. L. (1997). Paradoxical effects of external modulation of inhibitory interneurons. Journal of Neuroscience,
17(11):4382–4388.
Van den Bergh, G., Zhang, B., Arckens, L., and Chino, Y. M. (2010). Receptive-field
properties of v1 and v2 neurons in mice and macaque monkeys. Journal of Comparative
Neurology, 518(11):2051–2070.
Van Vreeswijk, C. and Sompolinsky, H. (1996). Chaos in neuronal networks with balanced
excitatory and inhibitory activity. Science, 274(5293):1724–1726.
Van Vreeswijk, C. and Sompolinsky, H. (1998). Chaotic balanced state in a model of
cortical circuits. Neural Computation, 10(6):1321–1371.
Wilson, H. R. and Cowan, J. D. (1972). Excitatory and inhibitory interactions in localized
populations of model neurons. Biophysical Journal, 12(1):1–24.
Yuste, R. (2015). From the neuron doctrine to neural networks. Nature Reviews Neuroscience, 16(8):487.

36

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1134

Supporting information

SFig 1: Correlation and spike regularity in the spontaneous condition. A-B
Mean and standard deviation of spike count correlations between neurons from different
populations. A bin size of 10ms was used. C Distributions of coefficient of variation of
inter-spike-intervals for neurons in different populations. Same quantiles as described in
Fig 2 are shown.

SFig 2: Correlation and spike regularity in the stimulated condition. Same
values as in SFig 1 are shown for the stimulated condition.

37

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 3: Characteristic quantities compared over parameter sets. A Abbreviations used in other panels. B Mean and SD of correlation coefficient over all populations.
C Mean and SD of CV of inter-spike-intervals over all populations. D Coefficient of determination (R2 ) quantifying fit between direct linear solution and baseline and modulation
decomposition. E Magnitudes of interference terms in Eq. 12 on logarithmic scale (blue:
∆β, red: Q∆νM , green: S∆νB ).

38

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 4: Central results summarized for standard parameter set. A/B Mean
firing rates for spontaneous and stimulated condition. For each population, the results of
the spiking model (Model A, top), rate model (Model B, middle) and linear model (Model
C, bottom) are shown. C Mean orientation selectivities for stimulated condition from all
three models. D Raster plot for the stimulated condition for 250ms of 500 neurons in each
population. E Comparison of baseline and modulation solution with direct solution of
the linear model (c.f. Fig 6C). F Eigenvalue spectrum of the effective connectivity W (c.f.
Fig 7B). G Input perturbation ∆βB (inset) and output perturbation ∆νB decomposed
into input and output modes, respectively (c.f. Fig 7D).

39

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 5: Central results summarized for high background parameter set. See
SFig 4 for a description of the individual panels.

40

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 6: Central results summarized for low background parameter set. See
SFig 4 for a description of the individual panels.

41

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 7: Central results summarized for strong inhibition parameter set. See
SFig 4 for a description of the individual panels.

42

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 8: Central results summarized for strong synapses parameter set. See
SFig 4 for a description of the individual panels.

43

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 9: Central results summarized for low connectivity parameter set. See
SFig 4 for a description of the individual panels.

44

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 10: Comparison of orientation selectivity measures. Left column: Distribution of orientation selectivity measure based on circular statistics (OSI). Middle column:
Orientation selectivity measure based on cosine fit (OSI∗ ). Right column: Comparison
of the two orientation selectivity measures. Each dot represents a single neuron in the
respective population.

45

bioRxiv preprint doi: https://doi.org/10.1101/425694; this version posted March 28, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

SFig 11: Model comparison. Comparison of the three central observables of the
different network models. Top row: single neuron firing rates, middle row: preferred
orientation (PO), bottom row: orientation selectivity index (OSI). The first column compares the spiking network model (Model A) with the firing rate model (Model B), the
second column compares the firing rate model with linearized network model (Model C)
and the third column compares the spiking network model with the linearized network
model. Same color code is used as in previous figures to indicate the eight different
populations.

46

