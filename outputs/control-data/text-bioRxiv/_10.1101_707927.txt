bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1

Instability of cooperation in finite populations

2

Chai Molina1a,b,c and David J. D. Earnc

3

a

4
5

Department of Ecology and Evolutionary Biology, Princeton University, Princeton 08544 NJ, USA
b
International Institute for Applied Systems Analysis, Laxenburg, A-2361, Austria
c
Department of Mathematics & Statistics, McMaster University, Hamilton ON L8S 4K1, Canada

6

July 18, 2019 @ 19:22

7

Abstract
Evolutionary game theory has been developed primarily under the implicit assumption of an infinite population. We rigorously analyze a standard model for the evolution
of cooperation (the multi-player snowdrift game) and show that in many situations in
which there is a cooperative evolutionarily stable strategy (ESS) if the population is
infinite, there is no cooperative ESS if the population is finite (no matter how large).
In these cases, contributing nothing is a globally convergently stable finite-population
ESS, implying that apparent evolution of cooperation in such games is an artifact of the
infinite population approximation. The key issue is that if the size of groups that play
the game exceeds a critical proportion of the population then the infinite-population
approximation predicts the wrong evolutionary outcome (in addition, the critical proportion itself depends on the population size). Our results are robust to the underlying
selection process.

8
9
10
11
12
13
14
15
16
17
18
19

cooperation | public goods games | evolutionary game theory
ORCID IDs of authors: CM 0000-0001-9722-4446; DE 0000-0002-7562-1341

1

Corresponding author; e-mail: chai.molina@gmail.com

1

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

20

1

Introduction

53

Many evolutionary games assume—for mathematical convenience—that populations are infinitely large (e.g., (1–7)). This assumption is sometimes justified on the grounds that
“[p]opulations which stay numerically small quickly go extinct by chance fluctuations” (8,
§2.1). Of course, all real populations are finite, and important differences in evolutionary
dynamics between finite and infinite populations have been demonstrated (9–15). In spite
of the technical challenges of working with finite populations, some exact analytical results
have been obtained for two-player games with discrete strategy sets (9, 12, 14–16). However, most existing finite-population results rely on approximation methods and simulations
(11, 15, 17–21). Notably, almost all finite-population results involve discrete strategy sets,
such as when individuals must choose between making a fixed positive contribution to a
public good, or nothing at all (e.g., (9, 12, 14–16)). Yet, evolutionary games involving continuous strategy sets (e.g., allocating time or effort to a communal task) are both widely
applicable and extensively studied using infinite-population models (22). Moreover, to our
knowledge, all existing results for finite populations depend on a choice of selection process
(e.g., Moran or Wright-Fisher (23, 24)).
Here, we present mathematically rigorous results that identify critical differences in the
predictions of evolutionary games in finite and infinite populations. We focus on a standard
model for exploring the evolution of cooperation—the continuous multi-player snowdrift
game (3)—which has previously been studied in infinite populations using exact analysis
and simulations (3, 7, 25–27) and in finite populations using approximations and simulations
(11, 21, 28, 29).
We show that evolutionary outcomes in finite and infinite populations can be dramatically
different. In particular, for a class of snowdrift games for which a cooperative ESS exists
in infinite populations (30), we find conditions under which there is no cooperative ESS
when played in finite populations. This qualitative difference in predictions for finite and
infinite populations can occur no matter how large the finite population is, and is universal
in the sense that it is independent of the selection process (31). To our knowledge, there
are no other examples in the literature of qualitatively different dynamics in finite and
infinite populations that persist for arbitrarily large populations and are independent of the
selection process; other studies that demonstrate such differences (e.g., (32)) are restricted
to particular selection processes.
The results we present are supported by formal mathematical theorems, which we state
in Results and prove in Methods and Supporting Information.

54

2

21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52

55
56
57
58
59
60
61

Terminology

The snowdrift game is an abstraction of the situation in which a group of individuals
encounters a snowdrift that blocks their path. We suppose that n players are drawn from a
population of self-interested individuals (n is the group size), and that each player chooses
how much to contribute to a public good—e.g., snow cleared off the path—from which all
group members benefit. A focal individual contributing x incurs a cost C(x) that depends
only on its own contribution, whereas its benefit B(τ ) depends on the total good τ contributed by the group as a whole. The focal individual’s payoff—which is interpreted as a

2

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

62

change in fitness—is then
W (x, τ ) = B(τ ) − C(x) .

63

64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85

If x is a continuous variable, as we assume here, the game is said to be continuous. Positive
contributions represent cooperative strategies, and individuals who contribute nothing
are said to defect. If the population is finite and contains N individuals, then for convenience
we refer to the ratio G = N/n as the number of groups; however, we do not assume that
the population is simultaneously subdivided into groups of n individuals (and in particular,
G need not be an integer).
To avoid mathematical complexities that are not relevant to the biological issues that
concern us, we impose a few natural conditions on the cost and benefit functions and refer
to the natural snowdrift game (NSG; see Methods §5.1). The NSG was introduced in
(30), where it was shown that—when played in infinite populations—the game always has
a cooperative ESS. Cost, benefit and fitness functions for an NSG example are shown in
figure 1.
Traditionally, an evolutionarily stable strategy (ESS) is one such that, when adopted
by the entire population, a single mutant individual playing a different strategy cannot invade the population (33). Because the phenotypic changes caused by mutations are often
small, local ESSs are of particular interest: a population of individuals playing a local ESS
is resistant to the invasion of a single individual playing a slightly different strategy. A
strategy is convergently stable if a population playing a different strategy evolves toward
it (34); convergence can be either global or local.
In infinite populations, the theory of adaptive dynamics (2, 8, 35) identifies
a singular

strategy as one at which the selection gradient, ∂x W x, x + (n − 1)X x=X , vanishes (36,
Table 1); for an NSG, this reduces to
B 0 (nX) − 1 = 0 .

86
87

88
89
90
91
92
93

N −n 0
B (nX) − 1 = 0 ,
N −1

95

97
98
99
100
101
102
103

(2)

A singular strategy for which the mutant fitness is concave near the singular strategy is a
local ESS.∗ Local convergent stability of singular strategies is also defined via a condition on
the local fitness difference [see Table 1 of (2)].
The definition of singular strategies can be extended to finite populations: The defining
feature of a singular strategy is that when it is played by a resident population, directional
selection vanishes; for an NSG, this condition reduces to

94

96

(1)

(3)

[see definition 4.3.5 of (37) and equation (28)]. The finite-population extension of the concept
of evolutionary stability is more involved, because it must account for the fact that selection
can favour fixation of a mutant strategy, even if selection opposes its invasion (9). Thus,
the standard definition of an evolutionary stable strategy in a finite population (ESSN
(9)) requires that selection oppose both invasion by, and fixation of, mutant strategies. In
addition, the presence of one or more mutants in a finite population has a non-negligible
effect on the fitness of residents (whereas finitely many mutants cannot affect the mean
fitness of residents in an infinite population).
∗

We assume throughout this paper that the strategy space is one-dimensional.

3

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

30

Cost

Fitness cost

25
20
15
10
5
0
0

5

10

15

20

25

30

25

30

Fitness benefit

Focal individual’s contribution x

Benefit

15
10
5

τmin

0
0

5

10

τmax

15

20

Total group contribution τ

Fitness

Residents play 9.6 (ESSN )
Residents play 5 (< ESSN )
Residents play 0 (defect)

nplayers = 2

Fitness

5

0

-5

τmin

-10
0

5

10

τmax

15

20

25

30

Focal individual’s contribution x

Figure 1: Example cost, benefit and fitness functions for a natural snowdrift game (NSG, defined
in Methods §5.1). Top panel: The cost function is simply C(x) = x. Middle panel: The benefit
function B(τ ) is given in Methods equation (23); parameter values are L = 10, k = 1, m =
1.5, τturn = 15. Bottom panel: Fitness is shown for three situations involving groups of n =
2 individuals. (i) Residents cooperate and contribute the ESSN (light green, Xres = 9.63) (ii)
Residents cooperate but contribute less than the ESSN (medium green, Xres = 5). (iii) Residents
defect, i.e., contribute nothing (dark green, Xres = 0). Resident strategies are indicated by vertical
lines in the same colour as the associated fitness function. In the case of defecting residents, a focal
individual’s fitness function does not depend on the group size (n) and has a local maximum at the
maximizing total good (τmax = 19.3, thin grey vertical line).

4

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

114

Fixation probabilities depend on the selection process (31), i.e., the stochastic process
by which differences in fitnesses of individuals playing different strategies generate changes in
the frequencies of strategies in the population over time. As a result, the strategies that are
evolutionarily stable in finite populations depend on the selection process. Variants of the
Moran and Wright-Fisher processes (23, 38, 39) are commonly assumed, but are idealizations
that do not exactly describe realistic populations (e.g., (40)). We are spared this complication
in this paper because, for the games we consider, every ESS is a universal ESS , that is, all
ESSs are evolutionarily stable irrespective of the selection process. Consequently, we need
not specify the population-genetic processes underlying selection, and we obtain general
results about evolutionary stability. We use the term universal more generally to indicate
that a property or statement holds for any selection process.

115

3

104
105
106
107
108
109
110
111
112
113

116
117

118

119
120

121
122
123
124

125

126
127
128
129
130

131
132
133
134
135

136

137

Results

ESSs in infinite populations. As we have previously shown (30), if an NSG (Methods §5.1) is played in an infinite population then there are always two (and only two) ESSs:
defect: contribute nothing (x = 0), or
cooperate: make a positive contribution that is inversely proportional to the group size
∗
> 0).
n (x = X∞
Both ESSs are global, and both are locally convergently stable [theorem 4.1 of (30)]. At
the cooperative ESS, everyone contributes an equal share of the amount that maximizes
individual fitness given that everyone contributes equally. In terms of this maximizing
total good τmax (see Methods §5.1 and figure 1), the cooperative ESS is
∗
X∞
=

τmax
.
n

(4)

ESSs in finite populations. In a finite population, NSGs do not necessarily have a cooperative ESSN , and when they do it is not necessarily possible to find an explicit formula for
evolutionarily stable cooperation levels in terms of the parameters of an NSG (nevertheless,
cooperative ESSN s are always easy to find numerically within the interval (6) identified in
the following theorem).
Theorem 1 (Existence and universality of stable cooperation levels in the natural snowdrift
game). Consider a finite population (of N individuals) that is subject to selection resulting
from groups of n individuals playing an NSG [defined in Methods §5.1]. A strategy X is
singular if and only if
n−1
B 0 (nX) = 1 +
,
(5)
N −n
and any such strategy X lies in the open interval
τ
τmax 
min
,
.
(6)
n
n

5

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

138
139

Necessary condition for ESSN : Any cooperative ESSN (X > 0) satisfies both equa∗
tion (5) (which implies X < X∞
) and
B 00 (nX) ≤ 0 .

140

141

Sufficient condition for universal ESSN :

143

144
145
146

147
148
149
150
151
152
153

154
155
156
157

158

159

If X satisfies equation (5) and

B 00 (nX) < 0 ,

142

(7)

(8)

then X is a universal ESSN that is (universally) locally convergently stable.
ESSN s in large populations: If B 00 (τmax ) 6= 0 and the group size n is either fixed, or
) N →∞
satisfies n(N
−−−→ 0, then for any sufficiently large population size N , there is a universal
N
∗
as N → ∞.
ESSN X = XN∗ satisfying inequality (8). Moreover, XN∗ → X∞
While the evolutionarily stable cooperation levels in finite and infinite populations are never
exactly the same, theorem 1 shows that the difference is negligible in sufficiently large populations if as the population size N → ∞, groups become a vanishingly small proportion of
the population (cf. figure 2). However, if group size is not sufficiently small relative to the
total population size then evolutionary predictions from finite population models differ qualitatively from the predictions for infinite ones: it may actually be impossible for cooperation
to evolve at all. This is formalized in the next theorem.
Theorem 2 (ESSN s of the natural snowdrift game). Consider a finite population (of N
individuals) that is subject to selection resulting from groups of n individuals playing an
NSG [defined in Methods §5.1 with fitness W defined by equation (20)]. Let m denote the
maximal marginal fitness, i.e.,


 ∂W 
0
= max B (τ ) − 1 .
(9)
m ≡ max
τ ≥0
τ ≥0
∂x
Then m > 0 and there is a critical maximal marginal fitness threshold,
mc =

160

such that†
m > mc

m = mc

m < mc

N −1
− 1,
N −n

(10)

=⇒


Generically, at least one cooperative local ESSN (X =


 ∗
XN > 0) exists that is universal and universally locally
convergently stable. In addition, defection is (univer


sally) a locally convergently stable ESSN .

(11a)

=⇒

(
Generically, no cooperative ESSN exists. Defection is
(universally) globally evolutionarily stable and locally
convergently stable.

(11b)

=⇒


No cooperative ESSN exists. Defection is (universally)
globally evolutionarily and convergently stable.

(11c)

†

In (11a), “generically” means excluding the unlikely possibility of singular strategies also being inflection
points of B(nx); in (11b), it excludes the possibility of the marginal benefit B 0 (τ ) being constant in a
neighbourhood of arg max B 0 (τ ).

6

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

161
162
163
164
165
166
167
168
169
170
171
172
173

174
175

176

177
178
179
180
181
182

183
184
185
186
187
188
189

190
191

192

193
194

This theorem predicts qualitatively different evolutionary outcomes, depending on the maximal marginal fitness (m): Equation (10) gives the critical maximal marginal fitness above
which a cooperative ESSN exists, and below which defection is the only ESSN . Theorem 2
thus connects the maximal marginal fitness—a property of the fitness function that relates
investments in the communal task to fitness benefits—with properties of the population of
interacting agents: the population size (N ), the number of players in a group (n), and the
number of groups (G = N/n).
Equation (10) expresses the critical maximal marginal fitness in terms of a given population size and given group size. To clarify the roles of group size and number of groups in the
evolution of cooperation, it is useful to think instead of the maximal marginal fitness (m) as
given (i.e., as a fixed property of the strategic interaction). Then, in the inequality m > mc
[see (11a)], we can replace mc by the expression on the right hand size of Equation (10), and
solve for a critical number of groups (Gc ) or critical group size (nc ).
ESS conditions in relation to the number of groups (G). Condition (11a) can be
expressed equivalently as
1
1
m+1
=1+
1−
,
(12)
G > Gc ≡
m + (1/N )
m
n
i.e., the number of groups G must be greater than Gc , the minimum number of groups that
support cooperation in a population of size N (or in groups of n players). For any given
number of players in a group (n), if we multiply inequality (12) by n we see that cooperation
cannot evolve—i.e., no cooperative ESSN exists—unless the population size is greater than
a critical population size‡ ,
n−1
N > Nmin ≡ n +
.
(13)
m
Figure 2 illustrates this result for the particular NSG specified by the benefit function shown
in figure 1. Put another way, for a given group size n, if the population size N is too small
then there is no cooperative ESSN , but if N is sufficiently large then there is a (universal)
cooperative ESSN . For any given population size N , there are group sizes n and benefit
functions B(τ ) that yield Nmin > N , so a qualitative difference between the evolutionary
outcomes in finite and infinite populations can occur either for small or large population
sizes.
ESS conditions in relation to group size (n). Rearranging condition (11a) again, we
can write
(
1
if m < 1/(G − 1) ,
mN + 1
(14)
= 1−m(G−1)
n < nc ≡
m+1
∞
otherwise.
i.e., for cooperation to evolve, the group size n must be less than nc , the maximum size of
groups that support cooperation in a population of size N (or a population divided into G
‡

Condition (c) in the definition of the NSG (§5.1) implies that m > 0, so Nmin is always well-defined in
(13).

7

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

nplayers
2
4
8
16

8

∗
∗
X∞
and XN

6

4

2

0
0

5

10

15

20

25

30

Population size N
Figure 2: Evolutionarily stable strategies in the natural snowdrift game (Methods §5.1, with the
sigmoidal benefit function shown in figure 1). For several group sizes (n), the infinite population ESS
∗ , equation (4)) is shown as a horizontal line, and the finite population ESS (X ∗ ) is shown with
(X∞
N
N
dots as a function of population size N . The vertical line segments indicate the critical population
size threshold (Nmin , inequality (13)). A cooperative ESSN exists if and only if N > Nmin .

8

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

195

196

197
198
199

200
201
202
203
204
205

206

207
208
209
210
211

groups§ ). Multiplying inequality (14) by G and rearranging, we obtain
(
G
if m < 1/(G − 1) ,
N < Nmax ≡ 1−m(G−1)
∞
otherwise,

i.e., if the number of groups is fixed (and smaller than 1+1/m) then in order for a cooperative
ESSN to exist, the population size must be less than the threshold in inequality (15), as
illustrated in figure 3.
Lack of ESSN for any population size. It is even possible that there is a cooperative
ESS if the population is infinite, but no cooperative ESSN for any finite population size
N . This is easy to verify for an NSG as follows. As noted above, an NSG always has an
infinite-population cooperative ESS (4). An ESSN exists if and only if inequality (11a) [or
inequality (14) or inequality (12)] is satisfied. Rearranging inequality (12) [or equation (10)],
we can write, equivalently,
1 − (G/N )
,
(16)
m > mc ≡
G−1
i.e., there is a cooperative ESSN if and only if the maximum marginal fitness m exceeds
the threshold mc (exactly the same threshold that appears in equation (10), but expressed
here in terms of G rather than n). Suppose now that the population is divided into a given
number of groups, G ≥ 2. There must be at least two individuals in each group, so N ≥ 2G
and hence G/N ≤ 1/2. Consequently, for any possible population size N , we have
mc ≥

212

213

216
217
218
219
220
221
222
223
224

225
226
227

1
.
2(G − 1)

(17)

Therefore, if the benefit function is such that
m<

214

215

(15)

1
2(G − 1)

(18)

then no cooperative ESSN exists, no matter how large the population size N . Yet, when the
game defined by the same cost and benefit functions is played in an infinite population, a
cooperative ESS exists (regardless of the group size n). Given G, in the example of the NSG
defined using equation (23), it is easy to satisfy inequality (18) since the only constraint on
m is that it must be positive.
Above, we have considered populations divided into a given number of groups. Alternatively, we could consider groups of a given size (n), and ask whether it is possible for a
public goods game to have a cooperative ESS if the population is infinite but no cooperative
ESSN for any finite population size. As we show elsewhere, NSGs do not have this property,
but there are snowdrift games that do have it (41).
Confirmation with both selection and mutation. Lastly, in figure 4 we complement
our rigorous analyses with individual-based simulations of finite populations in which individuals undergo both selection and mutation (see appendix 5.2 for details). Simulations such
§

Note that nc is always finite for a given population size, but when the number of groups G is fixed and
larger than 1 + 1/m, then there is an ESSN for any number of players n.

9

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

ngroups = 4
Ncrit = 4.71

ngroups = 12
Ncrit = 26.7

m = 0.05
L = 1000
τturn = 7

100

50

200

200

150

150

∗
∗
X∞
and XN

150

∗
∗
and XN
X∞

∗
∗
and XN
X∞

200

100

50

2

5

20 50

200

100

50

2

Population size N

5

20 50

200

2

Population size N

ngroups = 18
Ncrit = 120

200

150

150

150

50

∗
∗
X∞
and XN

200

100

50

2

5

20 50

200

Population size N

20 50

200

Population size N

200

100

5

ngroups = 20
Ncrit = 400

∗
∗
X∞
and XN

∗
∗
X∞
and XN

ngroups = 16
Ncrit = 64

ngroups = 21
Ncrit = ∞

100

50

2

5

20 50

200

Population size N

2

5

20 50

200

Population size N

Figure 3: Evolutionarily stable strategies in the natural snowdrift game (Methods §5.1), with the
sigmoidal benefit function B(τ ) given in Methods equation (23); parameter values are L = 1000,
∗ ,
k = 1, m = 0.05, τturn = 7. For several numbers of groups (G), the infinite population ESS (X∞
∗
equation (4)) is shown as a curve, and the finite population ESSN (XN ) is shown with dots as a
function of population size N . For each number of groups, the minimum population considered
is N = G + 1. The vertical line segments indicate the critical population size threshold (Nmax ,
inequality (15)), below which a cooperative ESSN exists (in contrast to the situation in which the
group size n is fixed and an ESSN exists only above a critical population size; cf. figure 2).

10

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

230

as these confirm that rigorous game-theoretical analyses—which are based on selection acting
with only two types in the population—correctly predict evolutionary outcomes in realistic
populations in which each individual can, in principle, be playing a different strategy.

231

4

228
229

232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270

Discussion

We have seen that the evolutionary dynamics of the class of natural snowdrift games (NSGs,
defined in Methods §5.1) are different when played in finite vs. infinite populations. Since all
real populations are finite, it is important to understand how inferences based on infinitepopulation analyses of the multi-player snowdrift game (e.g., (3, 30, 42)) might be affected.
More generally, under what circumstances are infinite-population analyses of the evolution
of cooperation likely to lead to invalid inferences about real populations?
We have shown that there are games for which it is possible that cooperation can evolve in
an infinite population but not in any finite population (no matter how large). This extreme
possibility emphasizes that inferences drawn from infinite population analyses should always
be regarded cautiously.
The infinite-population approximation is likely to predict incorrect evolutionary outcomes
if the number of individuals playing the game (the group size, n) is substantial relative to
the total population size (N ). Exactly what “substantial” means will depend on the game
in question and the population size; we have specified this threshold precisely for NSGs in
inequality (14). Evolutionary predictions derived from infinite population analyses can be
incorrect for finite populations of any size (figure 2 and theorem 2). The origin of such
erroneous inferences is that finite groups (no matter how large) are always negligible in
size compared to an infinite underlying population, but not compared to a finite underlying
population.
Intuition for how different predictions arise in finite and infinite populations can be
developed by considering a thought experiment in which the population (of size N ) is simultaneously divided into G groups that play the game. If a single mutant invades the
resident population, the probability that a randomly chosen group contains the mutant is
1/G. If the population size were then increased by adding more and more groups of the
same size (G → ∞, keeping n fixed), then the effect of the mutant on the residents would
be “infinitely diluted” (the mutant would have a negligible effect on residents’ fitnesses as
N → ∞).
If, instead, the population size were increased by adding individuals to the
existing groups (without increasing the number of groups) then the probability that a randomly selected group contains the mutant would not change; however, in this version of the
thought experiment, the limit N → ∞ entails the size of each group also becoming infinitely
large.
Adaptive dynamics, which has been extensively used in the study of evolutionary dynamics [e.g., (3, 42, 43), as well as (44) and references therein], relies on an infinite-population
approximation (8). Previous work has presented reasonable arguments to justify this approximation (e.g., (35)) and reported general agreement between adaptive dynamics and
stochastic simulations of finite populations (see (45) for a review). In addition, specific
agreement has been noted (15) between the finite- and infinite-population evolutionary dynamics of the multi-player snowdrift game with discrete strategies. These results appear to
contrast those presented here, though (15) did observe that defectors prevail when the group
11

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 4: Individual-based simulations (details in appendix 5.2) of populations playing an NSG
with cost and benefit functions as in figure 1 and group size n = 15, for population sizes N = 225
(red), 165 (black) and 120 (grey). The horizontal axis is the number of generations elapsed, and the
vertical axis is the strategy (contribution level) of each individual in the population. The strategies
present in the population in each generation are plotted on a vertical line intersecting the horizontal
axis at the corresponding point. For N = 120, defecting is the unique, globally convergently stable
ESSN ; for N > 155, a cooperative ESSN is predicted at X ∗ = 3.54 (marked with a horizontal
∗ = 3.56. Note in these
yellow line). The ESS for an infinite population playing this game is X∞
simulations, the mutation rate is high enough that populations contain more than two strategies at
any given generation (in contrast to our rigorous mathematical analysis of dimorphic populations).

12

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

282

size approaches the population size (even in situations in which cooperators and defectors
can coexist in an infinite population). In other work, there has been a focus on situations in
which the group size is much smaller than the population size, which reduces the chance of
discovering discrepancies between finite and infinite population evolutionary predictions.
Our analysis of the class of natural snowdrift games is rigorous (theorems 1 and 2), and
our conditions for existence of a cooperative ESSN are universal (in the sense of being entirely independent of the selection process). Broadly, our results indicate that approximating
large populations by infinite ones may generate misleading conclusions. In particular, inferences based on adaptive dynamics are not necessarily applicable to real (finite) populations.
There is a general need to reevaluate the theoretical justification for approximating large
populations by infinite ones, and to derive clear conditions for when such approximations
are useful.

283

5

284

5.1

271
272
273
274
275
276
277
278
279
280
281

285
286
287
288
289
290
291
292
293
294
295

296
297

Methods
The natural snowdrift game (NSG)

This biologically motivated version of the continuous snowdrift game (§2) was introduced
in (30). We consider a population of individuals that are identical except (possibly) with
respect to the strategy (contribution level) adopted when playing the snowdrift game. In
particular, there is no age, spatial, social or other structure in the population. Evolution
affects only the contribution levels of individuals, so at any time the population is completely
characterized by the set of strategies present in the population and the numbers of individuals
(or population proportions) playing each strategy. An individual’s fitness is determined
entirely by its payoff from the continuous snowdrift game played in groups of n individuals.
We say that this population plays a natural snowdrift game (NSG) if, in addition, the
cost and benefit functions have the following properties (which are satisfied by the example
shown in figure 1):
(a) The cost to the focal individual of a contribution x is measured in units of its impact
on this individual’s fitness, that is,
C(x) = x .

(19)


W (x, τ ) = B τ − x ,

(20)

298

299

300

301

302
303

304
305
306
307
308

Thus, the focal individual’s fitness is

where τ is the total contribution in the focal individual’s group.
(b) The benefit B(τ ) is a smooth function of the total contribution τ (more precisely, B 00 (τ )
exists for all τ ≥ 0).
(c) There exist total contribution levels τmin and τmax (0 ≤ τmin < τmax ) such that B(τ ) − τ
decreases for τ < τmin and τ > τmax and increases for τmin < τ < τmax . Consequently,
given condition (a), if only one member of a group contributes anything then that
individual’s fitness [take x = τ in equation (20)] is locally minimized (maximized) if
its contribution is x = τmin (τmax ).
13

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

309
310

(d) There is a net fitness cost to an an individual who contributes τmax when all other
group members contribute nothing,
B(τmax ) < C(τmax ) ,

(21)

but there is a net incremental fitness benefit for contributing τmax /n if other group
members contribute that amount,

τ 
τmax 
B(τmax ) − B (n − 1)
> C max .
(22)
n
n

311
312

313
314

317

In an infinite population, condition (c) implies that τmax /n and 0 are the only local
ESSs (30). Adding condition (d) guarantees that they are both global ESSs [0 via and
condition (21) and τmax /n via condition (22); see (30)].

318

5.1.1

315
316

319
320
321
322
323
324

325

326

327

328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343

Benefit function used for numerical examples

For the purpose of making example graphs and running simulations, we have used sigmoidal
benefit functions. The biological motivation for this is that one would expect a nonlinear
increase in the ease of passing the barrier as more snow is cleared, but eventually there can
be no further benefit from additional work because all the snow has been cleared.
Specifically, for any integer k > 0 and real numbers m > 0, L > 0 and τturn ≥ 0, consider
the benefit function
!

Γ 1/(2k)
(τ − τturn ) ,
τ ≥ 0,
(23)
B(τ ) = L erf 2k (m + 1)
2kL
where erf ` (x) is the generalized error function (46) of order `,
Z x
`
`
erf ` (x) =
e−t dt ,
Γ (1/`) 0

(24)

and Γ(x) is the gamma function [equation (50a)]. We analyze this flexible class of sigmoidal
benefit functions in appendix B, where we show that the parameters L and τturn are the
horizontal asymptote and the inflection point, respectively, k controls the “width” of the
sigmoid¶ , and m + 1 is the maximal marginal benefit (so that m is the maximal marginal
fitness that results from this functional form, justifying our notation).
Figure 1 shows the benefit function (23) for particular values of k, m, L and τturn , together
with the corresponding fitness function (20) that results if residents defect, or—in groups
of two individuals—if residents play the infinite population ESS [equation (4)]. Based on
∗
equation (23), in appendix B we derive explicit formulae for τmin , τmax , and X∞
and XN∗ (in
terms of m, L, τturn and k).
The class of sigmoids based on generalized error functions is much more flexible than
the more common “logistic” sigmoid used by (30, 42) (which is based on shifting, and horizontally and vertically stretching, the hyperbolic tangent function, tanh(x)). Whereas the
maximum slope, horizontal asymptote and position of the inflection point uniquely determine the “width” of a logistic sigmoid, the generalized error function allows the width to be
set independently via the parameter k [see equation (60)].
¶

More precisely, for a given maximal marginal fitness (m) and horizontal asymptote (L), k controls
the distance between the benefit function’s inflection point (τturn ) and the total contribution at which the
marginal benefit is half of its maximum.

14

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

344

345
346
347
348
349

5.2

Individual-based simulations

The three individual-based simulations shown in figure 4 [for population sizes N = 120
(grey), 165 (black) and 250 (red)] were run using algorithm 1, which we implemented in an
R (47) package. In the following description, we denote the normal distribution truncated
to the interval (l, u) by TruncNormal(µ, σ, l, u). It is a assumed that values of the following
parameters have been set:

350

• Parameters (k, m, L and τturn ) of the benefit function (23).

351

• Group size (n) and population size (N ), such that G = N/n is an integer.

352

• Number of repetitions of the NSG between reproductive events (nreps ).

353

• Maximum number of generations to evolve (nGen).

354

• Upper bound for contribution level (xmax ).

355
356
357
358
359
360
361
362
363

364

• Mean (µx ) and standard deviation (σx ) of an underlying Normal(µx , σx ) distribution of strategies; the initial strategies (xi , i = 1, . . . , N ) are to be sampled from
TruncNormal(µx , σx , 0, xmax ).
• Mutation probability (pmut ) per individual per generation.
• Standard deviation (σ) of an underlying Normal(0, σ) distribution of the strategy
changes caused by mutations, and upper and lower bounds on mutation sizes, (l, u);
when an individual playing strategy x mutates, its new strategy is sampled from
TruncNormal(x, σ, max {0, x − l} , min {xmax , x + u}), so that the mutation is within
the interval [l, u] and the mutated strategy is in [0, xmax ].

Acknowledgments

370

DE was supported by the Natural Sciences and Engineering Research Council of Canada
(NSERC). CM was supported by the Ontario Trillium Foundation, the United States Defense
Advanced Research Project Agency NGS2 program (grant no. D17AC00005), and the Army
Research Office (grant no. W911NF1810325). We are grateful to Sigal Balshine, Ben Bolker,
Michael Doebeli, Jonathan Dushoff, Gil Henriques, Paul Higgs and Rufus Johnstone for
valuable discussions and comments.

371

References

365
366
367
368
369

372
373
374
375

376
377
378

[1] Lehmann L. The stationary distribution of a continuously varying strategy in a
class-structured population under mutation-selection-drift balance. Journal of evolutionary biology. 2012;25(4):770–787. Available from: https://doi.org/10.1111/j.
1420-9101.2012.02472.x.
[2] Geritz SAH, Kisdi É, Meszéna G, Metz JAJ. Evolutionarily singular strategies and the
adaptive growth and branching of the evolutionary tree. Evolutionary Ecology. 1998
Jan;12(1):35–57. Available from: https://doi.org/10.1023/A:1006554906681.

15

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Algorithm 1 Individual-based simulation algorithm
1
2
3

xi ← TruncNormal(µx , σx , 0, xmax ), i = 1, . . . , N

iGen ← 1

Compute fitnesses:

5

Wi ← 0,

7
8
9

. initialize individual fitnesses

for iRep ← 1 to nreps do

. estimate fitness from nRep interactions

Permute (x1 , . . . , xN )
. randomly assign individuals into groups of size n
Pn
τj ← k=1 xk+(j−1)n , j = 1, . . . , G
. total contribution in group j

Wi ← Wi + W (xi , τdi/ne ),

i = 1, . . . , N

end for

11

Wi ← Wi − min{Wj : 1 ≤ j ≤ N } + 1

12

Selection by Wright-Fisher process:

13

x̃ ← unique(x)

15
16
17
18

N2 times

20

for i = 1 to N do

24

. total fitness of each unique strategy

` = 1, . . . , nuniq

. normalized total fitness
. how many x̃` in next generation
. new population

Nnuniq times

u ← Uniform[0, 1]

. random uniform deviate

if u < pmut then

. mutate with probability pmut

xi ← TruncNormal(xi , σ, max {0, xi − l} , min {xmax , xi + u})

end if

25

end for

26

iGen ← iGen + 1

27

` = 1, . . . , nuniq

x ← (x̃1 , . . . , x̃1 , x̃2 , . . . , x̃2 , . . . , x̃nuniq , . . . , x̃nuniq )
| {z } | {z }
|
{z
}

Mutation:

23

. shift fitnesses so minimum is 1

. number of unique strategies

(N1 , . . . , Nnuniq ) ← Multinom(N ; p̃1 , . . . , p̃nuniq )

19

22

. individual fitness via (20), (23)

. subset of unique strategies

nuniq ← dimension(x̃)
f` ← P
W
{i : xi =x̃` } Wi ,
f` / Pnuniq W
f` ,
p̃` ← W
`=1

N1 times

21

. evolve to nGen or fixation

i = 1, . . . , N

10

14

. generation counter

while iGen < nGen and not all xi ’s are identical do

4

6

. randomly sample initial strategies

end while

16

. random shift

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

379
380
381

382
383
384

385
386
387

388
389
390
391

392
393
394

395
396
397
398
399

400
401
402

403
404
405

406
407
408

409
410
411

412
413
414

415
416
417

[3] Doebeli M, Hauert C, Killingback T. The evolutionary origin of cooperators and defectors. Science. 2004;306(5697):859–862. Available from: https://doi.org/10.1126/
science.1101456.
[4] Zheng DF, Yin H, Chan CH, Hui P. Cooperative behavior in a model of evolutionary snowdrift games with N-person interactions. EPL (Europhysics Letters).
2007;80(1):18002. Available from: https://doi.org/10.1209/0295-5075/80/18002.
[5] Brown JS, Vincent TL. Evolution of cooperation with shared costs and benefits.
Proceedings of the Royal Society B. 2008 Sep;275(1646):1985–1994. Available from:
http://dx.doi.org/10.1098/rspb.2007.1685.
[6] Brännström Å, Gross T, Blasius B, Dieckmann U. Consequences of fluctuating group size for the evolution of cooperation. Journal of Mathematical Biology. 2010 Oct;63(2):263–281.
Available from: http://dx.doi.org/10.1007/
s00285-010-0367-3.
[7] Deng K, Chu T. Adaptive Evolution of Cooperation through Darwinian Dynamics
in Public Goods Games. PLoS ONE. 2011 Oct;6(10):e25496. Available from: http:
//dx.doi.org/10.1371/journal.pone.0025496.
[8] Metz JA, Geritz SA, Meszéna G, Jacobs FJ, Van Heerwaarden JS. Adaptive dynamics, a geometrical study of the consequences of nearly faithful reproduction. In: van
Strien SJ, Verduyn Lunel S, editors. Stochastic and Spatial Structures of Dynamical
Systems. Amsterdam: North-Holland: Proceedings of the Royal Dutch Academy of
Science (KNAW Verhandelingen); 1996. p. 183–231.
[9] Nowak MA, Sasaki A, Taylor C, Fudenberg D. Emergence of cooperation and evolutionary stability in finite populations. Nature. 2004;428(6983):646–650. Available from:
https://doi.org/10.1038/nature02414.
[10] Crawford VP. Nash equilibrium and evolutionary stability in large-and finite-population
playing the field models. Journal of Theoretical Biology. 1990;145(1):83–94. Available
from: https://doi.org/10.1016/S0022-5193(05)80536-3.
[11] Wakano JY, Iwasa Y. Evolutionary branching in a finite population: deterministic
branching versus stochastic branching. Genetics. 2012;p. 229–241. Available from:
https://doi.org/10.1534/genetics.112.144980.
[12] Hauert C, Traulsen A, née Brandt HDS, Nowak MA, Sigmund K. Public goods
with punishment and abstaining in finite and infinite populations. Biological Theory.
2008;3(2):114–122. Available from: https://doi.org/10.1162/biot.2008.3.2.114.
[13] Fogel GB, Andrews PC, Fogel DB. On the instability of evolutionary stable strategies in
small populations. Ecological Modelling. 1998;109(3):283–294. Available from: https:
//doi.org/10.1016/S0304-3800(98)00068-4.
[14] Imhof LA, Nowak MA. Evolutionary game dynamics in a Wright-Fisher process. Journal
of Mathematical Biology. 2006;52(5):667–681. Available from: https://doi.org/10.
1007/s00285-005-0369-8.
17

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

418
419
420

421
422
423

424
425
426

427
428
429

430
431
432

433
434

435
436
437
438

439
440
441

[15] Souza MO, Pacheco JM, Santos FC. Evolution of cooperation under N-person snowdrift
games. Journal of Theoretical Biology. 2009;260(4):581–588. Available from: https:
//doi.org/10.1016/j.jtbi.2009.07.010.
[16] Antal T, Nowak MA, Traulsen A. Strategy abundance in 2× 2 games for arbitrary
mutation rates. Journal of Theoretical Biology. 2009;257(2):340–344. Available from:
https://doi.org/10.1016/j.jtbi.2008.11.023.
[17] Traulsen A, Claussen JC, Hauert C. Coevolutionary dynamics in large, but finite populations. Physical Review E. 2006;74(1):011901. Available from: https://doi.org/10.
1103/PhysRevE.74.011901.
[18] Lessard S. Long-term stability from fixation probabilities in finite populations: new
perspectives for ESS theory. Theoretical population Biology. 2005;68(1):19–27. Available
from: https://doi.org/10.1016/j.tpb.2005.04.001.
[19] Wakano JY, ‘n L. Evolutionary and convergence stability for continuous phenotypes
in finite populations derived from two-allele models. Journal of Theoretical Biology.
2012;310:206–215. Available from: https://doi.org/10.1016/j.jtbi.2012.06.036.
[20] Li K, Cong R, Wu T, Wang L. Social exclusion in finite populations. Physical Review E.
2015 Apr;91(4). Available from: http://dx.doi.org/10.1103/PhysRevE.91.042810.
[21] Chen X, Szolnoki A, Perc M, Wang L. Impact of generalized benefit functions on
the evolution of cooperation in spatial public goods games with continuous strategies.
Physical Review E. 2012 Jun;85(6). Available from: http://dx.doi.org/10.1103/
PhysRevE.85.066133.
[22] McGill BJ, Brown JS. Evolutionary Game Theory and Adaptive Dynamics of Continuous Traits. Annual Review of Ecology and Systematics. 2007 Dec;38(1):403–435.
Available from: http://dx.doi.org/10.1146/annurev.ecolsys.36.091704.175517.

443

[23] Ewens WJ. Mathematical Population Genetics 1: Theoretical Introduction. vol. 27.
Springer Science & Business Media; 2012.

444

[24] Hartl DL, Clark AG. Principles of Population Genetics. Sinauer Associates; 2007.

442

445
446
447
448

449
450
451

452
453
454

[25] Ito K, Ohtsuki H, Yamauchi A. Relationship between aggregation of rewards and the
possibility of polymorphism in continuous snowdrift games. Journal of Theoretical
Biology. 2015 May;372:47–53. Available from: http://dx.doi.org/10.1016/j.jtbi.
2015.02.015.
[26] Sasaki T, Okada I. Cheating is evolutionarily assimilated with cooperation in the
continuous snowdrift game. Biosystems. 2015 May;131:51–59. Available from: http:
//dx.doi.org/10.1016/j.biosystems.2015.04.002.
[27] McNamara JM, Barta Z, Fromhage L, Houston AI. The coevolution of choosiness and
cooperation. Nature. 2008 Jan;451(7175):189–192. Available from: http://dx.doi.
org/10.1038/nature06455.

18

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

455
456
457

458
459
460

461
462
463

464
465
466

467
468
469

470
471

472
473
474

475
476
477

478
479
480

[28] Zhong LX, Qiu T, Xu JR. Heterogeneity Improves Cooperation in Continuous Snowdrift
Game. Chinese Physics Letters. 2008 May;25(6):2315–2318. Available from: http:
//dx.doi.org/10.1088/0256-307X/25/6/107.
[29] Zhang Y, Fu F, Wu T, Xie G, Wang L. A tale of two contribution mechanisms for
nonlinear public goods. Scientific Reports. 2013 Jun;3. Available from: http://dx.
doi.org/10.1038/srep02021.
[30] Molina C, Earn DJD. Evolutionary stability in continuous nonlinear public goods games.
Journal of Mathematical Biology. 2017;74(1-2):499–529. Available from: https://doi.
org/10.1007/s00285-016-1017-1.
[31] Molina C, Earn DJD. On selection in finite populations. Journal of Mathematical Biology. 2018 Feb;76(3):645–678. Available from: https://doi.org/10.1007/
s00285-017-1151-4.
[32] Traulsen A, Claussen JC, Hauert C. Coevolutionary Dynamics: From Finite to Infinite
Populations. Phys Rev Lett. 2005 Dec;95:238701. Available from: https://link.aps.
org/doi/10.1103/PhysRevLett.95.238701.
[33] Maynard Smith J. Evolution and the Theory of Games. Cambridge University Press;
1982.
[34] Eshel I. On the changing concept of evolutionary population stability as a reflection of a
changing point of view in the quantitative theory of evolution. Journal of Mathematical
Biology. 1996;34(5-6):485–510.
[35] Dieckmann U, Law R. The dynamical theory of coevolution: a derivation from stochastic ecological processes. Journal of Mathematical Biology. 1996 May;34(5):579–612.
Available from: https://doi.org/10.1007/BF02409751.
[36] Brännström Å, Johansson J, von Festenberg N. The Hitchhiker’s Guide to Adaptive
Dynamics. Games. 2013;4(3):304–328. Available from: https://doi.org/10.3390/
g4030304.

482

[37] Molina C. The good, the finite, and the infinite [PhD dissertation]. McMaster University.
Hamilton, ON, Canada; 2016. Available from: http://hdl.handle.net/11375/18951.

483

[38] Moran PAP. The statistical processes of evolutionary theory. Clarendon Press; 1962.

481

484
485

486
487
488

489
490
491

[39] Nowak MA. Evolutionary dynamics: Exploring the equations of life. Harvard University
Press; 2006.
[40] Der R, Epstein CL, Plotkin JB. Generalized population models and the nature of genetic
drift. Theoretical Population Biology. 2011;80(2):80 – 99. Available from: https:
//doi.org/10.1016/j.tpb.2011.06.004.
[41] Molina C, Earn DJD. Selection may oppose invasion, yet favour fixation: consequences
for evolutionary stability. bioRxiv. 2019;Available from: https://www.biorxiv.org/
content/early/2019/07/18/706879.
19

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

492
493
494

495
496
497

498
499
500

501
502
503
504

505
506

[42] Cornforth DM, Sumpter DJ, Brown SP, Brännström Å. Synergy and group size in
microbial cooperation. The American Naturalist. 2012;180(3):296. Available from:
https://doi.org/10.1086/667193.
[43] Killingback T, Doebeli M, Hauert C. Diversity of cooperation in the tragedy of the
commons. Biological Theory. 2010;5:3–6. Available from: https://doi.org/10.1162/
BIOT_a_00019.
[44] Waxman D, Gavrilets S. 20 questions on adaptive dynamics. Journal of Evolutionary Biology. 2005;18(5):1139–1154. Available from: https://doi.org/10.1111/j.
1420-9101.2005.00948.x.
[45] Doebeli M. Adaptive dynamics: a framework for modeling the long-term evolutionary
dynamics of quantitative traits. In: Svensson E, Calsbeek R, editors. The adaptive
landscape in evolutionary biology. Oxford, U.K.: Oxford University Press; 2012. p.
227–242.
[46] Yin L, Qi F. Some functional inequalities for generalized error function. J Comput Anal
Appl. 2018;25:1366–1372.

508

[47] R Core Team. R: A Language and Environment for Statistical Computing. Vienna,
Austria; 2016. Available from: https://www.R-project.org/.

509

[48] Ross SM. A First Course in Probability. Pearson Prentice Hall; 2010.

507

510
511
512

[49] Thomson BS, Bruckner JB, Bruckner AM. Elementary Real Analysis. 2nd ed.
www.classicalrealanalysis.com.; 2008. Available from: https://books.google.com/
books?id=vA9d57GxCKgC.

20

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

513

SUPPORTING INFORMATION

514

A

515

A.1

Proofs

516

517
518

Our main results are stated in theorems 1 and 2 (§ 3). Before developing the proofs in detail,
it is useful to note that:
• τmin > 0 (where τmin is defined in assumption (c) of the definition of the NSG, § 5.1).
To see this, suppose that τmin = 0. Then assumption (c) implies that B(τmax ) ≥ τmax ,
contradicting assumption (d).

519
520
521

• The benefit function B(τ ) is twice-differentiable. This follows from assumption (b) in
the definition of the NSG (§ 5.1).

522
523

• B 0 (τmin ) = B 0 (τmax ) = 1, B 0 (τ ) > 1 for τmin < τ < τmax , and B 0 (τ ) < 1 otherwise [these
properties of B(τ ) follow from assumption (c)]. Consequently, m > 0 and B 00 (τmax ) ≤ 0.

524
525

526

527
528
529
530
531
532

A.1.1

535
536
537
538

539
540

The mean fitness difference between mutants and residents

Consider a population of N individuals, comprised of Mp mutants who play x and N − Mp
residents who play X, and denote the proportion of mutants in the population by  = Mp /N .
Suppose that groups of n individuals are randomly sampled from this population without
replacement, which implies that the number of mutants in each such group is hypergeometrically distributed with parameters N , Mp and n (37, 48); thus, the probability of k mutants
occurring in a random sample of n individuals is


N −Mp Mp
Pr (Mg = k) =

533

534

Analysis of the natural snowdrift game (NSG; §5.1) in a finite
population

n−k

k
N
n



.

(25)

Suppose, moreover, that a focal individual is selected from the population by first sampling a
group of n individuals, and then selecting one of the members of this group. Lastly, suppose
for simplicity that individual fitnesses are given by the payoffs from a single round of the
NSG played in such randomly selected groups# . We show elsewhere (37, eq. 4.61, p. 137)
that the expected difference between the mutant and resident fitnesses is then


n
N −Mp Mp 
X

kN − Mp n 
n−k
k

δW (x, X) = X − x +
B
kx
+
(n
−
k)X
.
(26)
N −1
Mp (N − Mp )
n−1
k=0
#

Equation (26) remains valid if individual fitnesses are obtained by averaging payoffs from an arbitrary
(either fixed or random) number of rounds of the NSG, as long as groups are selected independently in each
round.

21

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

541

Differentiating equation (26) yields
∂x δW (x, X) = −1 +

542

= −1 +

543
544
545

N −Mp Mp
kN − Mp n
n−k
k
kB 0
N −1
M
(N
−
M
)
p
p
n−1


N −Mp Mp −1
kN − Mp n 0
n−k
k−1

·
B
N −1
N − Mp
n−1

n
X



k=0
n
X
k=0



kx + (n − k)X



kx + (n − k)X



(27)

Differentiating with respect to x and setting x = X, we find (37, pp. 138–139)
N −n 0
B (nX) ,
N− 1


(n − 1)
N − n N − 2n
+2
N  B 00 nX .
=
N −1 N −2
N −2

546

∂x δW (x, X)|x=X = −1 +

(28a)

547

∂x2 δW (x, X)|x=X

(28b)

548
549

From these expressions we see that

550

• ∂x δW (x, X)|x=X is independent of , and

551

• ∂x2 δW (x, X)|x=X is linear in .

552

We will exploit these facts below.

553

A.1.2

554
555
556
557
558
559

560
561
562

563
564
565
566
567
568
569
570
571
572
573
574
575
576
577

Evolutionary and convergent stability of defection

Lemma 3 (Evolutionary stability of defection). If the NSG (§ 5.1) is played in a finite
population then not contributing (X = 0) is a locally convergently stable ESSN for any
selection process. Moreover, if the population and group sizes are the same (N = n, so the
entire population plays the game together) then defecting is the unique ESSN and is globally
evolutionarily and convergently stable.
Proof. B 0 (0) < 1 because B(τ ) − τ decreases for 0 ≤ τ < τmin , so using equation (28a),
N −n 0 
B 0 − 1 < 0.
∂x δW (x, 0)|x=0 =
(29)
N −1

Because ∂x δW (x, X)|x=X is continuous in X,

∂x δW (x, X)|x=X < 0 ,

(30)

for X sufficiently small. From Theorem 4.3.9 in (37), it follows that X = 0 (defection)
is convergently stable, and selection opposes invasion of mutants contributing a sufficiently
small but positive amount, x > 0. To establish that X = 0 is evolutionarily stable, observe
that equation (29) implies that δW (x, 0) < 0 for sufficiently small x, so such mutants are
selected against, regardless of their proportion () in the population. Thus, corollary 5.4 of
(31) implies that selection also opposes the fixation of such mutants.
Now suppose groups constitute the entire population, i.e., N = n. Then, for any resident
strategy X > 0 and any number of mutants Mp ∈ {1, 2, . . . , N − 1}, mutants contributing
less than residents to the public good (0 ≤ x < X) have a higher payoff than residents; hence
defection is the unique ESSN and is globally convergently stable. Defection is also globally
evolutionarily stable because for any mutant strategy x > 0 and any number of mutants
(Mp < N ), residents obtain a higher payoff than mutants (because they receive the same
benefit without paying a cost).
22

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

578

579
580
581
582

583
584
585

586
587

588
589
590
591
592
593
594

595
596
597

598

599

600

601

602
603

604

A.1.3

Proof of theorem 1

Inserting equation (28a) into the definition of an evolutionarily singular strategy (definition
4.3.5 of (37)) implies that cooperative singular strategies are characterized by equation (5).
Any solution of equation (5) must satisfy nXN∗ ∈ (τmin , τmax ), because the right hand side of
equation (5) is greater than 1 and, as noted above, if τ 6∈ (τmin , τmax ) then B 0 (τ ) ≤ 1.
Necessary condition for ESSN : Suppose that X solves equation (5) but B 00 (nX) >
0. Plugging equation (5) into equation (28a) gives ∂x δW (x, X)|x=X = 0. Rearranging
equation (28b), we have



(n − 1)
N −n
2
(31)
1+2
(N  − 1) B 00 nX
∂x δW (x, X)|x=X =
N −1
N −2
so ∂x2 δW (x, X)|x=X is increasing in  and positive for any  ≥ 1/N (i.e., any mixed population). Thus, when mutants play x sufficiently close to X, ∂x δW (x, X)|x=X is negative for
x < X and positive for x > X; hence, since δW (X, X) = 0, we must have δW (x, X) > 0
for any x that is near but not equal to X (and this is true for any number of mutants
Mp = 1, . . . , N − 1). Corollary 5.4 of (31) then implies that selection favours the fixation of
such mutants, so X is not an ESSN , regardless of the selection process. Thus, if XN∗ > 0 is
an ESSN then it cannot be that B 00 (nX) > 0, i.e., inequality (7) holds.
Sufficient condition for universal ESSN : The sufficient condition for local universal
evolutionary and convergent stability follows immediately from theorem 4.D.1 of (37) and
equation (28).
ESSN s in large populations: Suppose that B 00 (τmax ) 6= 0 and consider the equation
f (X, y) = B 0 (nX) − y = 0 .

(32)

Noting that f (τmax /n, 1) = 0 and that
∂X f (X, y)|(X,y)=(τmax /n,1) = B 00 (τmax ) 6= 0 ,

(33)

from the implicit function theorem (49, Theorem 12.40), there exists a differentiable function
X(y) defined in a neighbourhood of y = 1, such that X(1) = τmax /n and


(34)
f X(y), y = yB 0 nX(y) − y = 0 .

605

Now suppose that the group size n is either fixed, or varies with population size but satisfies

606

n(N ) N →∞
−−−→ 0 .
N

607
608
609
610
611
612

If we define yN := 1 + Nn−1
then yN → 1, so for all sufficiently large population sizes N ,
−n
equation (34) can be solved implicitly for XN∗ := X(yN ). Such XN∗ then solve equation (5),
N →∞
∗
and XN∗ −−−→ X∞
because X(y) is continuous. Recalling that B 00 (τmax ) ≤ 0 and B 00 (τmax ) 6=
0 by assumption, we have B 00 (τmax ) < 0, so for sufficiently large N , B 00 (nXN∗ ) < 0. Theorem
4.D.1 of (37) then implies that for sufficiently large N , XN∗ is a universal local ESSN and is
locally convergently stable.
23

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

613

614
615
616
617
618

619
620

621
622
623
624

625

A.1.4

First, note that X = 0 is always a locally convergently stable ESSN (lemma 3). From
Corollary 4.3.8 of (37), selection opposes invasion of a cooperative resident strategy X > 0
by sufficiently similar mutant strategies only if X is singular, which (using equation (28a))
occurs iff X satisfies
n−1
.
(35)
B 0 (nX) = 1 +
N −n
Because B 0 (nX) > 1 only if
in this interval.

628

630
631
632
633

if a cooperative ESSN exists then it must lie

B 0 (nX̃) > B 0 (nXN∗ ) = 1 +

634

n−1
.
N −n

(38)

From the intermediate value theorem, there exists X ∈ S such that

635

X > X̃ > XN∗ = max S ,

636

(39)

a contradiction.

Thus B 00 nXN∗ < 0 and C 00 (X) = 0, so theorems 4.D.1 and 4.3.9 of (37) imply that
XN∗ is a local ESSN and is locally convergently stable.

637
638
639

643

τmax
,
n

(this maximum exists because the continuity of B 0 (nX) on a closed interval implies
sup S ∈ S).


Genericallyk , B 00 nXN∗ 6= 0. We claim that B 00 nXN∗ < 0. To see this, suppose,
in order to derive a contradiction, that B 00 nXN∗ > 0. Then, B 0 (nX) increases in a
neighbourhood of XN∗ , so there exists X̃ such that XN∗ < X̃ < τmax /n and

629

642

<X<

Note that from theorem 1, S ⊂ (τmin /n, τmax /n). Denote the largest solution of equation (35) by XN∗ , i.e.,
XN∗ = max S
(37)

627

641

τmin
n

Case m > mc . Because B 0 (τmax ) = 1 and B 0 (nX) is a continuous function of X on the
interval [τmin /n, τmax /n], it follows from the intermediate value theorem (49) that equation (5) has a solution in this interval. Let S be the set of singular strategies, i.e.,
solutions of equation (5),


n−1
0
.
(36)
S = X B (nX) = 1 +
N −n

626

640

Proof of theorem 2

Case m = mc . Suppose, in order to derive a contradiction, that X > 0 is a cooperative
ESSN . From theorem 1, X must solve equation (35) so, from the definition of mc in
equation (10),
N −1
B 0 (nX) =
= mc + 1 .
(40)
N −n
k

∗
We need to avoid the situation in which singular strategy XN
is also an inflection point of B(nx). This
∗
occurs when nXN is both a critical point and an inflection point of B (x) − (N − 1) x/ (N − n), which is
generically not the case.

24

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

644
645
646
647

Suppose further that arg max B 0 (τ ) does not contain an interval (i.e., the marginal
benefit B 0 is not maximal for an interval of total contributions τ ), which happens
generically. Then, any total contribution in arg max B 0 (τ ) is a local maximum of B 0 (τ ).
It follows that if x < X and x is sufficiently close to X, then
 N −1
,
B 0 x + (n − 1)X <
N −n

648

649

and therefore from equation (27),

650

∂x δW (x, X) = −1 +

651

< −1 +

652

653

654

655
656
657
658
659
660
661

662
663

664

665
666

(41)

N −Mp Mp −1
kN − Mp n 0
n−k
k−1 ·
B kx + (n −
N −1
N − Mp
n−1
k=0
!


n
N −Mp Mp −1
X
kN − Mp n N − 1
n−k
k−1

·
,
N −1
N − Mp
N −n
n−1
k=0

n
X





k)X

which, together with the identity (37, equation (4.63), p. 138),


n
N −K K−1 
X
kN − Kn  N − n
n−k
k−1

=
,
N −1
N
−
K
N
−
1
n−1
k=0



(42)

(43)

implies that ∂x δW (x, X) < 0. Hence, similar to an argument in the proof of theorem 1,
since δW (X, X) = 0, we must have δW (x, X) > 0 for any x that is slightly less than
but not equal to X (and this is true for any number of mutants Mp = 1, . . . , N − 1).
Consequently, selection favours the invasion and replacement of X by any such x, so
X is not evolutionarily stable.
To see that defection is globally evolutionarily stable, substitute X = 0 in equation (27)
to get


n
N −Mp Mp −1
X

kN − Mp n 0
n−k
k−1

·
∂x δW (x, 0) = −1 +
B
kx
.
(44)
N −1
N − Mp
n−1
k=0

Noting that for all x > 0, B 0 kx ≤ mc + 1, we have
∂x δW (x, 0) ≤ −1 +

n
X
k=0

N −Mp Mp −1
n−k
k−1
N −1
n−1





kN − Mp n
·
N − Mp

!
(mc + 1) = 0 ,

(45)

672

where we have used equations (10) and (43) in the last equality. Thus, δW (x, 0) is
non-decreasing in x. Moreover, if x < τmin /n, then B 0 kx < 1 for all k = 0, . . . , n, so
similarly, equations (43) and (44) imply that ∂x δW (x, 0) < 0. Because δW (0, 0) = 0,
it follows that δW (x, 0) < 0 for all x > 0 (regardless of the proportion of mutants
in the population). Thus, from (31, corollary 5.4), when residents defect, selection
opposes invasion and fixation of any mutants.

673

Case m < mc . In this case, equation (5) has no solution, and no cooperative ESSN exists.

667
668
669
670
671

25

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

To see that defection (X = 0) is globally evolutionarily and convergently stable, observe
first that m < mc implies

674
675

B 0 (τ ) < 1 +

676

for all

τ ≥ 0.

(46)

Then, using equations (27), (46) and equation (4.63) on p.1̇38 of (37), it follows that
!


n
N −Mp Mp −1
X
kN − Mp n N − 1
n−k
k−1

∂x δW (x, X) < −1 +
·
N −1
N − Mp
N −n
n−1
k=0
 N − n  N − 1 
= 0,
= −1 +
N −1 N −n

677

678

679
680

so δW (x, X) decreases with x ≥ 0 for any X ≥ 0. Thus, from (31, corollary 5.4),
defection (X = 0) is a globally evolutionarily and convergently stable strategy.

681
682

683

n−1
N −1
=
,
N −n
N −n

B

684

Analysis of the benefit function used for numerical
examples

687

In this appendix we define the class of sigmoidal benefit functions that we have used to
illustrate our results, and derive a variety of analytical formulae that we have found useful
when working with these functions.

688

B.1

685
686

689

690

691

692

693
694

695
696
697

698
699

Sigmoids using generalized error functions

For any integer k > 0 and real m > 0, L > 0 and τturn ≥ 0, consider the benefit function
!

Γ 1/(2k)
(τ − τturn ) ,
τ ≥ 0,
(47)
B(τ ) = L erf 2k (m + 1)
2kL
where erf ` (x) is the generalized error function of order `,
Z x
`
`
erf ` (x) =
e−t dt .
Γ (1/`) 0

(48)

This class of functions generalizes the the error function, erf, which is recovered for ` = 2
or, equivalently, k = 1; see § B.2.
Expressing generalized error functions using gamma functions: It is sometimes
convenient to express erf ` in terms of gamma functions. For x > 0, the transformation
1
z = t` (t = z 1/` and dt = z ` −1 dz/`) gives
 

!
Z x`
1
1
1
1
1
erf ` (x) =
z ` −1 e−z dz =
Γ
−Γ
, x`
,
(49)
Γ (1/`) 0
Γ (1/`)
`
`

26

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

700

where
Z

∞

Γ (s) =

701

0

Z

(50a)

ts−1 e−t dt ,

(50b)

∞

Γ (s, x) =

702

ts−1 e−t dt ,

x

703

706

are the gamma∗∗ , and upper incomplete gamma functions, respectively. Note that we are
only interested in generalized error functions of even order (` = 2k), which are odd functions
of x.

707

Parameter meanings: Because equation (49) implies

704
705

708

lim erf ` (x) = 1 ,

(51)

lim B (x) = L .

(52)

x→∞
709

it follows that

710

x→∞
711
712
713

We show below that the inflection point of B (47) is τturn , and that the maximal marginal
fitness given the benefit function B is m.
From the integral definition of the generalized error function [equation (48)]
`
d erf ` (x)
`
=
e−x ,
dx
Γ (1/`)
2
`
d erf ` (x)
`
=−
`x`−1 e−x ,
2
dx
Γ (1/`)

714

715
716
717

718

719

720

721

722
723

(53a)
(53b)

so
 "
#2k 


√
Γ 1/(2k) (2k)!
Γ 1/(2k)
πL

 (m + 1)
√ exp − (m + 1)
B 0 (τ ) =
(τ − τturn ) 
2kL
2kL
π
Γ 2k Γ 1/(2k)
 "
#2k 

Γ 1/(2k)
= (m + 1) exp − (m + 1)
(τ − τturn )  ,
(54a)
2kL
"
 #2k
Γ
1/(2k)
B 00 (τ ) = −2k (m + 1)
(τ − τturn )2k−1
2kL
 "
#2k 

Γ 1/(2k)
× (m + 1) exp − (m + 1)
(τ − τturn ) 
2kL
"
 #2k
Γ 1/(2k)
= −2k (m + 1)
(τ − τturn )2k−1 B 0 (τ ) .
(54b)
2kL
∗∗

For any positive integer k, Γ(k) = (k − 1)!.

27

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

726

Consequently, τturn is the unique solution of B 00 (τ ) = 0, and is thus the only inflection point.
B 0 (τ ) is always positive, and hence B (τ ) is monotonically increasing. However, B 00 (τ ) > 0
for τ < τturn and B 00 (τ ) < 0 for τ > τturn , and hence

727

max B 0 (τ ) = B 0 (τturn ) = m + 1 ,

724
725

(55)

τ ≥0

728

729

730
731
732
733
734
735

736

737
738
739
740

741

742
743
744

745

746

747

748

749

750

751
752

so from equation (9), the maximal marginal fitness is
 ∂W 
= max B 0 (τ ) − 1 = m .
max
τ ≥0
τ ≥0
∂x

(56)

The minimizing and maximizing total goods: Since B 0 (τ ) is monotonic on each of
the intervals, (−∞, τturn ) and (τturn , ∞) and B 0 (τ ) is even, for any b ∈ B 0 (R≥0 ) = (0, m + 1],
we can find two real values of τ for which B 0 (τ ) = b (although one of these values may
be negative and therefore biologically irrelevant, because total contributions to the public
good cannot be negative). To find these values of total contribution τ , we set B 0 (τ ) = b in
equation (54a), and get
"
#2k

Γ 1/(2k)
m+1
= (m + 1)
(τ − τturn )
,
(57)
log
b
2kL
r
2kL
m+1
2k
 log
τ = τturn ±
.
(58)
b
(m + 1) Γ 1/(2k)
To find τmax and τmin , we substitute b = B 0 (τ ) = 1 in equation (58) and, noting that B 00 (τ )
changes sign from positive to negative at τturn , we have
p
2kL
 2k log (m + 1) ,
(59a)
τmin = τturn −
(m + 1) Γ 1/(2k)
p
2kL
 2k log (m + 1) ,
(59b)
τmax = τturn +
(m + 1) Γ 1/(2k)
and the distance between the location of the fitness minimum and maximum is
p
4kL
 2k log (m + 1) .
∆τ = τmax − τmin =
(m + 1) Γ 1/(2k)

(60)

The infinite-population cooperative ESS: Equation (4) then gives
∗
X∞

τ
1
= max =
n
n

p
2kL
 2k log (m + 1)
τturn +
(m + 1) Γ 1/(2k)

!
.

(61)

Using B 0 (τmax ) = 1 and equation (59b) in equation (54b), we have
"
 #2k
(m
+
1)
Γ
1/(2k)
∗
bcurve := B 00 (τmax ) = B 00 (nX∞
) = −2k
(τmax − τturn )2k−1
2kL
"
!2k−1
 #2k
2k−1
(m + 1) Γ 1/(2k)
2kL

= −2k
(log (m + 1)) 2k
2kL
(m + 1) Γ 1/(2k)
 
1
1 m+1
= −Γ
(log (m + 1))1− 2k .
(62)
2k
L
28

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

753

754
755

756
757
758
759

760

761
762

763

764

765
766

767

768
769

770

771

772

773

774
775

776
777
778

Using equation (47) and the fact that erf 2k is odd,
p

B(τmax ) − B(τmin ) = 2L erf 2k 2k log (m + 1) .

(63)

Singular and evolutionarily stable cooperative strategies in finite populations:
In a finite population of size N , a singular strategy XN∗ of the NSG is a solution of equation (5), that is,
N −1
n−1
=
.
(64)
B 0 (nXN∗ ) = 1 +
N −n
N −n
so equation (58) implies that at the ESS, the total contribution must be one of
s 

2kL
N −n
2k
 log (m + 1)
τ = τturn ±
.
(65)
N −1
(m + 1) Γ 1/(2k)
There are therefore two singular strategies,
XN∗ ±

1
=
n

2kL

τturn ±
(m + 1) Γ 1/(2k)

s
2k

N −n
log (m + 1)
N −1


!
.

(66)

Similarly to τmin and τmax , B 00 (nXN∗ + ) > 0 and B 00 (nXN∗ − ) < 0, so from theorem 1, the unique
ESSN is
s 
!
2kL
N −n
1
 2k log (m + 1)
τturn +
.
(67)
XN∗ =
n
N −1
(m + 1) Γ 1/(2k)
The curvature of the benefit function at the ESSN : Similar to equation (62), we
have
"
 #2k
(m + 1) Γ 1/(2k)
N −1
00
∗
B (nXN ) = −2k
(nXN∗ − τturn )2k−1
(68)
2kL
N −n
"
!2k−1
 #2k
(m + 1) Γ 1/(2k)
2kL

= −2k
2kL
(m + 1) Γ 1/(2k)

 ! 2k−1
2k
N −n
N −1
× log (m + 1)
N −1
N −n

N − 1 Γ 1/(2k)
= − (m + 1)
N −n
L

 ! 2k−1
2k
N −n
× log (m + 1)
.
(69)
N −1
Condition for the fitness difference having a minimum when a single mutant
defects and residents play the ESS: To guarantee that when a single mutant invades a
population playing the ESS, the fitness difference has both a minimum and a maximum (as a
29

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

779
780
781

782
783
784

785

function of the mutant strategy), we need the mutant contribution that minimizes fitness to
be positive (or equivalently, the contribution of the nonfocal individuals—all residents—must
be less than the minimizing total good τmin ),
n−1
τ > 0.
n max
Using equations (59b) and (60), this is equivalent to τmax > n∆τ , or
τmin −

n<

τmax
=
∆τ

(70)

τturn
1
p
+
2k
 log (m + 1) 2

4kL

(m+1)Γ 1/(2k)

786
787
788

789
790

791
792
793

794

795
796
797
798

799
800


m + 1 Γ 1/(2k)
1
p
= τturn
+
.
4kL 2k log (m + 1) 2
Rewriting this condition in terms of the horizontal asymptote L,

τturn (m + 1) Γ 1/(2k)
p
L<
.
2k (2n − 1) 2k log (m + 1)

(71)

(72)

The payoff extrema difference: We now calculate the payoff extrema difference (PED),
∆Ψ, that is, the difference between a mutant’s local minimum and maximum fitnesses when
residents contribute the infinite-population ESS.



h
n−1
τmax i
− B(τmin ) − τmin −
τ
∆Ψ = B(τmax ) −
n
n max
= B(τmax ) − B(τmin ) − (τmax − τmin )
= B(τmax ) − B(τmin ) − ∆τ ,
(73)
so using equations (60) and (63), we have
p

∆Ψ = 2L erf 2k 2k log (m + 1) −

p
4kL
 2k log (m + 1) .
(m + 1) Γ 1/(2k)

(74)

807

The mean fitness slope: To choose parameter values that generate a fitness difference
with a distinct peak at the ESS (when residents play the ESS), we would like to find the mean
fitness slope between the extrema, i.e., the ratio of the PED, ∆Ψ, and the distance between
the fitness extrema as a function of our parameters. To that end, using equation (70), the
distance between the fitness extrema is


τmax
n−1
− τmin −
τ
= τmax − τmin = ∆τ .
(75)
n
n max

808

Equations (60) and (74) then yield

801
802
803
804
805

806


log
(m
+
1)
∆Ψ
p
=
−1
4kL
 2k log (m + 1)
∆τ
(m+1)Γ 1/(2k)
p

2k
erf
log
(m
+
1)
2k
Γ (1/ (2k))
p
= (m + 1)
− 1,
2k
2k
log (m + 1)
2L erf 2k

809

810
811

p
2k

30

(76)

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

812
813

which only depends on the maximal marginal fitness, m (and the order of the generalized
error function, 2k). Note also that using equation (48) and L’Hôpital’s rule (49),
`
`
erf ` (x)
`
= lim
e−x =
,
x→0 Γ (1/`)
x→0
x
Γ (1/`)
lim

814

815
816

817

so

∆Ψ
= 0.
m→0 ∆τ
In addition, equation (49) implies that for any x > 0,
lim

(78)

lim erf ` (x) = 1 ,

818

(79)

k→∞
819

(because Γ(x) → ∞ as x → 0, and Γ

1
, x`
`



x→0
821

lim

k→∞

824

825

(80)

x→0

so we have

822

823

is bounded), and

lim xΓ(x) = lim Γ(x + 1) = 1 ,

820

(77)

∆Ψ
= m.
∆τ

(81)

The ratio of ESSs in infinite and finite populations: Using equations (60), (61) and
(67),
p
2kL
 2k log (m + 1)
τ
+
turn
∗
(m+1)Γ 1/(2k)
X∞
q
=

∗
XN
2kL
−n
 2k log (m + 1) N
τturn +
N −1
(m+1)Γ 1/(2k)

826

=

827

=

2τturn + ∆τ
r
N −n
2k log((m+1) N −1 )
2τturn + ∆τ
log(m+1)
2τturn + ∆τ
r
2τturn + ∆τ

2k

1+

828

829

830

∗
X∞
=
XN∗

2τturn + ∆τ
s

834

.


log

2k

2τturn + ∆τ

833

(82)

Rewriting the population size as N = nG,

831

832

.
−n
log( N
N −1 )
log(m+1)

1+

G−1
1
G− n

(83)



log(m+1)

∗
∗
We see that the ratio X∞
/XN∗ → 1 as G → ∞ with n fixed. However, X∞
/XN∗ approaches
∗
a (finite) value greater than 1 as n → ∞ with G fixed (assuming XN exist for all N ; see
inequality (15)).

31

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

835

836

837

838

839

840
841
842

843

844

B.2

Sigmoid using standard error-function

√
In the special case k = 1 (i.e., ` = 2), since Γ (1/2) = π, equation (47) reduces to


√
π
B(τ ) = L erf (m + 1)
(τ − τturn ) ,
τ ≥ 0.
2L

Then, setting k = 1 in equation (85) gives the maximizing and minimizing total goods,
r
2L
log (m + 1)
,
(85a)
τmin = τturn −
m + 1r
π
2L
log (m + 1)
τmax = τturn +
,
(85b)
m+1
π
and the distance between the location of the fitness minimum and maximum is
r
log (m + 1)
L
.
∆τ = τmax − τmin = 4
m+1
π

∗
X∞

850
851

852

853

854

855

856
857
858

859
860

1
=
n

2L
τturn +
m+1

r

log (m + 1)
π

!
,

(87)

and equation (62) becomes
bcurve = B 00 (τmax ) = −

847
848

849

(86)

Equation (61) then gives

845

846

(84)

m + 1p
π log (m + 1) .
L

(88)

From equation (63),
B(τmax ) − B(τmin ) = 2L erf

p



log (m + 1) .

Equation (67) gives the unique ESSN :
s


N −n
log
(m
+
1)
1
2L
N −1 
,
XN∗ = τturn +
n
m+1
π

(89)

(90)

and equation (68) becomes
B

00

(nXN∗ )

m+1
=−
L

s



N −n
π log (m + 1)
.
N −1

(91)

Condition (71), which guarantees that when a single mutant invade a population playing
the ESS, the fitness difference has both a minimum and a maximum (as a function of the
mutant strategy), reduces to
r
τturn m + 1
π
1
n < τmax /∆τ =
+ ,
(92)
4
L
log (m + 1) 2
32

bioRxiv preprint doi: https://doi.org/10.1101/707927; this version posted July 19, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

861

862
863

864

865
866

the PED, ∆Ψ (equation (74)) becomes
∆Ψ = 2L erf

L
log (m + 1) − 4
m+1

p



r

log (m + 1)
,
π

and the mean fitness slope (equation (76)) between the extrema reduces to
r
p

m+1
π
∆Ψ
=
erf
log (m + 1) − 1 .
∆τ
2
log (m + 1)

33

(93)

(94)

