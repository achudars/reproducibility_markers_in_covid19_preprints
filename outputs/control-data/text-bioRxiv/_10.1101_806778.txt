bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25

Parallel Factor Analysis (PARAFAC) for multidimensional decomposition of
fNIRS data - A validation study
Hüsser, Alejandra*, 1,2, Caron-Desrochers, Laura*, 1,2, Tremblay, Julie1, Vannasing, Phetsamone1,
Martínez-Montes, Eduardo†, 3 & Gallagher, Anne†, 1, 2
*

Co-First author
Co-Senior author
Corresponding author: anne.gallagher@umontreal.ca
†

1

Neurodevelopmental Optical Imaging Laboratory (LIONLab)
Research Center of the Sainte-Justine University Hospital Center
3175, Chemin de la Côte-Sainte-Catherine
Montreal, QC H3T 1C5, Canada
2

Department of Psychology
Université de Montréal
Pavillon Marie-Victorin
P.O. Box 6128 Centre-ville Station, 2900 Boulevard Édouard-Montpetit
Montreal, QC H3T 1J4, Canada
3

Cuban Neurosciences Center (CNEURO)
Street 190 e / 25 and 27 Cubanacan
Playa Havana, CP 11600, Cuba

26

1

Abstract

27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45

Functional near infrared spectroscopy (fNIRS) is a neuroimaging technique that uses light
at two different wavelengths in the near infrared spectrum to estimate cerebral hemodynamic
response, based on concentration changes in both oxygenated and deoxygenated hemoglobin. A
multi-dimensional decomposition technique, parallel factor analysis (PARAFAC), has recently
been validated for the identification of artifacts and cerebral activation patterns in
electroencephalography. Our objective was to introduce and validate the use of the PARAFAC
model for the analysis of fNIRS data, which is inherently multidimensional (time, space,
wavelength). Eighteen healthy adults underwent fNIRS acquisition during a semantic verbal
fluency task. Both the signal-to-noise ratio and Pearson’s correlation were used to evaluate the
efficacy of PARAFAC for motion artifact correction. Temporal, spatial and hemodynamic
characteristics of the PARAFAC component allowed us to validate the identification of task-related
cerebral activation. Using PARAFAC, results revealed a significant improvement in data quality
after movement artifact correction. Compared to traditional two-dimensional approaches (e.g.
ICA, PCA), PARAFAC offered some advantages. Although PARAFAC revealed a slightly more
distributed functional network, temporal and spatial characteristics of the task-related brain
activation identified with PARAFAC mostly overlapped with commonly used approaches (e.g.
general linear model, global average). This study describes the first implementation of PARAFAC
in fNIRS and supports it as a promising data-driven alternative for multi-dimensional data analyses
in fNIRS.

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
46

2

Keywords

47
48
49

Near-infrared spectroscopy, multidimensional decomposition, parallel factor analysis,
canonical decomposition, artifact correction, language paradigm.

50

3

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89

Functional near-infrared spectroscopy (fNIRS) is a non-invasive neuroimaging technique
that uses light of at least two different wavelengths in the near-infrared spectrum in order to assess
brain activity based on neurovascular coupling. The specific absorption properties of oxygenated
(HbO) and deoxygenated (HbR) hemoglobin allow individual assessments of concentration
changes in both HbO and HbR (Jobsis, 1977). Thus, data can be interpreted not only for temporal
and spatial characteristics, but also for the wavelength or hemodynamic domain. Compared to
functional magnetic resonance imaging (fMRI), fNIRS offers lower spatial resolution but allows
a more comprehensive representation of the hemodynamic response, and at a faster time resolution
(≈ 0.1s). Currently, many of the fNIRS data analysis approaches (e.g. wavelet filtering,
decomposition, spline interpolation, etc.) do not take fully into account the multidimensional
structure of the fNIRS signal and are limited to two dimensions, often considering either time and
space, or time and wavelength (Brigadoi et al., 2014; Cooper et al., 2012; Sungho Tak & Ye, 2014).
Two-dimensional (2D) analyses require that data with more dimensions, such as fNIRS data,
undergo superficial unfolding before processing, for example, treating both wavelengths or HbO
and HbR independently. Hence, some of these 2D analysis tools are forced to impose other nonphysiological constraints, such as orthogonality or statistical independence. To overcome these
limitations, a multidimensional (≥3D) approach called parallel factor analysis (PARAFAC; Bro,
1998; Harshman, 1970), or less frequently referred to as canonical decomposition (Carroll &
Chang, 1970), could be considered as an alternative for the analysis of fNIRS data.
Multidimensional decomposition was initially introduced in the field of psychometrics and
linguistics as a tool for multi-factor analysis (Carroll & Chang, 1970; Harshman, 1970; Tucker,
1966). Over time, its use was extended to neuroimaging signals, such as the analysis of eventrelated potentials (ERPs) assessed by electroencephalogram (EEG). For this application,
decomposition took into account three dimensions: time, space and participants (Field & Graupe,
1991; Möcks, 1988). Later, PARAFAC was introduced for data analysis in continuous EEG
recordings, taking into account the 3D structure of the EEG signal (time × space × frequency)
(Martínez-Montes, Valdés-Sosa, Miwakeichi, Goldman, & Cohen, 2004; Miwakeichi et al., 2004).
The growing popularity of PARAFAC in neuroimaging stems from the intrinsic advantage of
multidimensional decomposition, because most data gathered in neuroscience are naturally
multidimensional. Also, the data-driven approach could enlighten new aspects of neuroimaging
data (Calhoun, 2018).
PARAFAC is a decomposition technique applicable to any dataset that can be described in
more than two dimensions (e.g. time, space, frequency, participants, conditions, signal
characteristics) and allows for the extraction of different signatures present in the data. It assumes
multilinear relations between the different dimensions and usually does not need any other
mathematical constraints to find a unique decomposition of the data. It may therefore be used in
the data pre-processing steps to isolate artifacts, as well as in the actual data analyses to extract a
predominant brain activation, or other relevant characteristics of the signal. Indeed, using a 3D
wavelet transformation in EEG data, Miwakeichi and colleagues (2004) revealed PARAFAC as an

Introduction

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

2

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135

appropriate tool for both the detection of ocular movement artifacts and the identification of
dominant brain activation patterns. In this study, some of the components identified using
PARAFAC were highly similar to those extracted with principal component analysis (PCA), an
established approach for 2D decomposition. Specifically, significant overlap was shown for
eigenvalues and peaks of time/frequency components, as well as their topographical
representations found with PCA and PARAFAC. PARAFAC, using the dimensions of time, space
and frequency, has also been applied successfully to the EEG data of individuals with epilepsy, for
the purposes of artifact detection and the identification of aberrant cerebral activation (Acar, AykutBingol, Bingol, Bro, & Yener, 2007). Overall, these studies suggest that in the context of time ×
space × frequency analysis of EEG data, PARAFAC achieves comparable results to wellestablished approaches while allowing for easier interpretation, and doing so without imposing
non-physiological constraints (Martínez-Montes et al., 2004). Multidimensional decomposition
with PARAFAC is not limited to 3D and could potentially be expanded to n-dimensions. In the
context of ERP data, PARAFAC as a five-way analysis has successfully been used to identify
differences and common characteristics of inter-trial phase coherence across conditions and
subjects, including the dimensions of time, channels, frequency, subjects, and conditions (Mørup,
Hansen, Herrmann, Parnas, & Arnfred, 2006).
Although PARAFAC has been applied on NIRS data in the food industry (Bro, 1998), it
has not yet been used in neuroscience. Its application to fNIRS brain data could allow simultaneous
analysis of temporal, spatial and wavelength dimensions, the latter codifying the information for
concentration changes in HbO and HbR. Hence, after the optical intensities from both wavelengths
are transformed into HbO and HbR concentration changes, it can be referred to as the
hemodynamic dimension. Thus, data analyses with PARAFAC could take into account all relevant
dimensions contributing to the fNIRS signal, without artificially separating information delivered
by the use of multiple wavelengths in each channel. As described above, because PARAFAC does
not impose independence and orthogonality constraints (e.g. Miwakeichi et al., 2004), it can
therefore represent the real underlying physiological signals that are mixed in a multilinear
structure.
A highly useful application of PARAFAC is that of artifact correction. Although the fNIRS
signal is considered to be relatively tolerant to movement (Lloyd-Fox, Blasi, & Elwell, 2010), it
does include some movement artifacts that can lead to abrupt changes in the light intensity, thus
reducing the quality of data. It has been shown that the dynamics of both wavelengths provide
important information for artifact detection and correction (Cui, Bray, & Reiss, 2010). However,
current techniques for movement artifact correction typically consider only two dimensions of the
signal’s structure simultaneously (e.g. time and space) simultaneously and can only separate
artifacts that are orthogonal or independent of physiologically relevant signals (Brigadoi et al.,
2014; Cooper et al., 2012; Sungho Tak & Ye, 2014).
The bi-dimensional (time-space) decomposition of fNIRS data into components for the
purposes of artifact correction is typically performed using principal component analysis (PCA)
and independent component analysis (ICA). Although there are several ways to approach PCA
(classification: James, Witten, Hastie, & Tibshirani, 2013; e.g. dimensionality reduction: Han
Zhang et al., 2011), from the signal decomposition view, PCA aims to extract the principal
component, that is the component that explains the greatest amount of variance of the signal (X.
Zhang, Noah, Dravida, & Hirsch, 2017). It has been used for artifact removal because it helps to
isolate the artifact’s signature, or to extract other relevant activities in fNIRS (Cooper et al., 2012;
Peng et al., 2014; Sungho Tak & Ye, 2014; X. Zhang et al., 2017). The data is decomposed into a

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

3

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181

sum of components, each one formed by the product of two vectors: one representing the temporal
principal component and the other, the corresponding topography (scores for each channel). A
basic problem with PCA is that the components defined by only two signatures (time and space)
are not uniquely determined. Therefore, in PCA, orthogonality is imposed between the
corresponding temporal signatures of the different components (Becker, Comon, Albera, Haardt,
& Merlet, 2011; Miwakeichi et al., 2004; Sungho Tak & Ye, 2014). Orthogonality is, however, a
rather non-physiological constraint. Even with this restriction, the extracted principal components
are not totally unique, given that the arbitrary rotation of axes does not change the explained
variance of the data. This has led researchers to use different mathematical criteria as the basis for
choosing specific rotations (e.g. Varimax, Quartimax, Promax). In fNIRS, PCA has also been
applied to target time intervals (tPCA), that is to say only during periods where artifacts related to
articulation or other head movements occurred, instead of during the entire unsegmented signal
(Behrendt, Firk, Nelson, & Perdue, 2018; Yücel, Selb, Cooper, & Boas, 2014). This type of
targeted correction resulted in better signal quality, as compared to two other approaches, while
also reducing the risk of altering the signal’s global integrity (Yücel et al., 2014). We therefore
decided to use the tPCA approach for our analyses in this study.
More recently, ICA has become a popular tool for this type of decomposition in fNIRS (e.g.
Kamran, Mannan, & Jeong, 2016; Tachtsidis & Scholkmann, 2016; H Zhang et al., 2010). It has
the benefit of preventing rotational freedom (Jung, Theis, Puntonet, & Lang, 2001). However,
uniqueness is achieved at the cost of necessitating the imposition of a constraint even stronger than
orthogonality, namely, statistical independence of the temporal signatures (Comon, 1994; Jutten &
Herault, 1991). Statistical independence is appropriate for identifying reproducible artifact
signatures (e.g. ocular movements). In ICA, the maximal number of components (hypothesized
sources) equals the number of observations, which in neuroimaging is often rather high. Therefore,
if too high a number of components is selected, it could become difficult to identify the artifact’s
signature, which could be split into several components.
In addition to being used for movement artifact correction, PARAFAC could also be
considered as a tool for the analysis of the hemodynamic response. Typically, cerebral activation
is characterized by a relative increase of the HbO concentration level, with a slight decrease of the
HbR concentration level (Boas et al., 2001; Obrig, Rossi, Telkemeyer, & Wartenburger, 2010;
Quaresima, Bisconti, & Ferrari, 2012; Schroeter, Kupka, Mildner, Uludağ, & von Cramon, 2006).
Despite the advantage of measuring signals that reflect both HbO and HbR concentration changes,
the estimation of cerebral activation in fNIRS studies is often mainly based on HbO concentration
changes (Quaresima et al., 2012; Wolf & Greisen, 2009). This is because the HbO increase is often
easier to identify than changes to HbR concentration, due to its greater amplitude and the higher
signal-to-noise ratio. Furthermore, contradictory findings exist regarding the occurrence of HbR
decrease, which is also why many studies favor the interpretation of HbO concentration changes
only, without further investigation of HbR changes. However, ignoring concentration changes in
HbR poses the risk of false positive results, because higher levels of HbO could actually, for
example, be due to an artifact (Cui et al., 2010). Simultaneous treatment of both wavelengths or
HbO and HbR with PARAFAC would help to overcome this limitation and allow for the
identification of typical hemodynamic signatures, i.e. increase of HbO and slight decrease of HbR.
Therefore, the main objective of the current study is to validate PARAFAC for the
decomposition of the fNIRS signal to 1) extract and correct movement artifacts, and 2) characterize
task-related brain activation. For that purpose, we acquired fNIRS data of 18 healthy adults while
they performed aloud a semantic verbal fluency task. First, we compared the use of PARAFAC to

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

4

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
182
183
184
185
186
187

two commonly used decomposition techniques for motion artifacts (target PCA (tPCA), and
independent component analysis or ICA). Subsequently, we evaluated the spatial and temporal
characteristics of language-related brain activation as identified with the PARAFAC model, and
compared them to those revealed by commonly used approaches (general linear model (GLM),
global average).

188

4

189

Methods
4.1

Sample

190
191
192
193
194
195
196

Eighteen native French-speaking adults (Mage = 22.8 years, SD = 2.0 years; female = 10 /
male = 8) participated in this study. Inclusion criteria were: being French unilingual (no second
language acquired before the age of five), right-handed, born at term, having normal hearing,
normal or corrected-to-normal vision, and no history of neurological, chronic or psychiatric
disorders. Experimental procedures were approved by the local ethics committee.

197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212

Participants sat comfortably in a soundproof and electrically shielded room. They were
instructed to relax, to avoid any intentional movements or muscular tension, and to fix their gaze
on the center of a screen placed at a distance of 114 cm. After the installation of a cap which held
optodes and detectors, participants underwent a fNIRS recording while they performed a verbal
fluency task previously validated for expressive language-related activation (Gaillard et al., 2003;
Gallagher, Tremblay, & Vannasing, 2016; Paquette et al., 2015). The task consisted of 11 different
semantic categories (e.g. animals, colors, fruits, etc.), for which participants had to say aloud as
many words as possible for each category. The name of the category was presented visually on the
screen (Presentations®, Neurobehavioral Systems, 2018). We used a block design paradigm in
which periods of rest (fixation cross presented on the screen) and task (semantic category) alter in
30-seconds intervals. A video camera filmed the entire session, allowing for the visual
identification of movements during offline pre-processing. Audio data was used to count the
number of words reported per category and to identify the timing of the words, since articulation
can induce movement artifacts.

213
214
215
216
217
218
219
220
221
222
223

fNIRS data was acquired using a frequency-domain fNIRS device (Imagent Tissue
Oxymeter, ISS Inc., IL, USA) equipped with 60 emitters, each regrouping two light sources of
different wavelengths (690 and 830 nm), and 14 detectors. Emitters and detectors coupled at a
distance of 3-4.5 cm allowed for the recording of a total of 106 channels for both wavelengths.
Optodes were held in place perpendicularly, using a cap that was fitted on the head of participants
in accordance with the 10-20 system(Klem, Lüders, Jasper, & Elger, 1999). Optical intensity was
measured with a sampling rate of 19.53 Hz (Boxy, ISS Inc., IL, USA). The setup covered both
hemispheres equally and included the regions of interest for the investigation of language
functions, i.e. frontal, temporal and parietal lobes (see Figure 1). Two short-distance emitterdetector pairs with a distance of one cm were placed at the midline in the occipital region and on
the participants’ wrist. These short-distance pairs enable the control for continuous physiological

4.2

4.3

Procedure and verbal fluency task

fNIRS data acquisition

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

5

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
224
225
226
227

contamination (cardiac frequency, respiration, Mayer waves) in the superficial layer, which is not
directly related to cerebral activation (Brigadoi & Cooper, 2015; Scarpa et al., 2013).

228
229
230
231
232
233
234

Figure 1. fNIRS setup with 14 detectors (large dark circles), and 60 light emitters (small light dots)
each sending light at two different wavelengths (𝜆= 690 and 830 nm). The reflection of light
emitted by each source is captured by one or several proximal detectors. The combination of a
light emitter and a detector represents a channel (dark grey lines), for a total of 106 channels.

235
236
237
238
239
240
241
242
243

Data analysis was conducted with the use of a homemade toolbox (LIONNIRS created by
J. Tremblay, eng.) adapted in SPM12 (Statistical Parametric Mapping; Villringer & Dirnagl, 1995)
in MATLAB® (The MathWorks, Inc., MA, USA). Pre-processing steps included segmentation of
the signal into blocks of 50 seconds (5s resting-state baseline, 30s task and 15s resting-state). Every
block was normalized by dividing each time point by the mean of the baseline. A low-pass filter
with a cut-off frequency of 0.2 Hz was applied, in order to remove oscillations caused by heartbeat
and respiration.

244
245
246
247
248
249
250
251
252
253
254

Since our language paradigm required participants to name words aloud, artifacts were
mostly due to facial movements related to the muscular contraction of articulation. We performed
a semi-automatic artifact detection using primarily an algorithm, to mark segments where an
abrupt change exceeded three times the average variance of the signal (e.g. Aarabi & Huppert,
2016). Visual inter-rater inspection based on the signal’s characteristics combined with the video
recording led to the final identification of the time intervals with artifacts. These time intervals
would subsequently be used to compare the efficacy of different movement artifact correction
techniques intended to increase the signal quality (see section 4.7 on statistical analysis). Artifact
correction was then applied to these segments using PARAFAC and two commonly used 2D
decomposition techniques in fNIRS, namely those of tPCA and ICA.

4.4

4.5

Pre-processing

Movement artifact detection and correction

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

6

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
255

4.5.1

Two-dimensional signal decomposition for artifact detection and correction

256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283

For both ICA and tPCA, the decomposition of the 2D data matrix 𝑋 (whose elements 𝑥%&
are indexed by 𝑖 channel and 𝑗 time points), leads to 𝑁* components as defined in equation 1 and
illustrated in Figure 2. The matrix 𝑋%& combines two separate data matrices (𝑋+%& , 𝑋-%& ) in order to
take into account the 2D structure for both wavelengths. The maximum number of components 𝑁*
could be equal to or less than the 𝑋 matrix dimension, i.e. number of channels or number of time
points. Each component is modeled as the product of two factors/vectors (𝑎%* 𝑏&* ) which represent
signatures of the space 𝑎%* and time dimensions 𝑏&* . The unexplained part of the data is considered
irrelevant activity or noise (𝜀%& ).

284
285
286
287
288
289
290
291
292
293
294
295
296
297
298

The fNIRS data naturally offers the time courses of all channels for two wavelengths, i.e.
two separate data matrices. This data can be arranged in a tri-dimensional array, as illustrated in
Figure 2a. In this study, we used this 3D array of the parallel factor model (PARAFAC), a
multidimensional decomposition technique, for 1) performing artifact correction, and 2) studying
the brain response during a language task.
The 3D array will be used for the artifact correction application. The dimensions are time
(indexed by the time points in the analyzed segment), space (indexed by 106 channels) and
wavelength (indexed by the two wavelengths). As explained above, PARAFAC establishes a
trilinear decomposition of each element of the fNIRS data array (𝑋678 ) in 𝑁* components, each
being the product of three factors (Bro, 1998):

(1)

4*

𝑥%& = ∑*5+ 𝑎%* 𝑏&* + 𝜀%&

tPCA was integrated into our homemade LIONnirs toolbox. Artifact correction with tPCA
was performed on each time interval previously identified as containing artifacts. From the
obtained components we subtracted only the first, which explains most of the variance. This is in
keeping with the assumption that the highest variance in the data for each segment is caused by
the artifact.
Artifact correction with ICA was done using Brain Vision Analyzer (Brain Products GmbH,
Gilching), and followed the steps proposed by Plank (2013). First, raw fNIRS data were exported
and ICA was applied on the entire unsegmented signal, as per the method commonly reported in
the literature (H Zhang et al., 2010). Noisy intervals reflecting artifacts were identified by semiautomatic inter-rater artifact detection, as explained in section 4.5. We selected components based
first on their time course, i.e. high variation of light intensity similar to the artifact signature.
Secondly, we rejected those whose subtraction would induce artificial artifacts elsewhere. Data
was subsequently imported back into SPM. Then, segmentation and normalization were applied,
as described in section 4.4.
4.5.2

Multidimensional signal decomposition

4*

(2) 𝛸 678 = ∑*5+ 𝑎6* 𝑏7* 𝑐8* + 𝜀678
The estimated factors, 𝑎6* , 𝑏7* and 𝑐8* are the elements of the so-called loading matrices
𝛢, 𝐵 𝑎𝑛𝑑 𝐶, whose column vectors 𝑎* = A𝑎6* B, 𝑏* = A𝑏7* B, 𝑐* = A𝑐8* B, will represent the
Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

7

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
299
300
301
302
303
304
305
306
307
308
309
310
311

temporal, spatial and wavelength signatures of each component (Figure 2). The uniqueness of the
solution is guaranteed when the number of components (𝑁* ) is smaller than the sum of the ranks
of the three loading matrices. In the case of noisy data, it is very likely that the loading matrices
are always full rank, so uniqueness is guaranteed as long as the number of components (𝑁* ) is
smaller than half the sum of the number of time points (𝑁6 ), number of channels (𝑁C ), and number
(4 H4 H4 )
of wavelengths (𝑁8 ): 𝑁𝑓 ≤ G -I J − 1). For instance, even in a small array of 20 time points
and eight channels at two different wavelengths, a unique decomposition could be achieved, using
up to 14 components (20(𝑡) + 8(𝑚) + 2(𝑤) = 30 ÷ 2 = 15 − 1 = 14(𝑁𝑓)). Computationally,
the decomposition is achieved by the Alternating Least Squares algorithm, as it has been used in
previous studies on neuroscience data (e.g. Acar et al., 2007; Martínez-Montes et al., 2004;
Miwakeichi et al., 2004; Mørup et al., 2006).

312
313
314
315
316
317
318
319
320
321
322
323
324

Figure 2. Schematic representation of the decomposition models applied to fNIRS data. (a) The
data 𝑋 is arranged as a 3D data array with its dimensions being those of time (t), space (s) and
wavelengths (w). (b) PARAFAC decomposes this array into the sum of components, each being a
trilinear product of loading vectors representing temporal (𝑎6 * ), spatial (channel, 𝑏Y * ) and spectral
(wavelength, (𝑏Y∗8* )) signatures. tPCA/ICA decompose the array into components, each being a
bilinear product of the loading vectors representing temporal (𝑎6 * ) and spatial signatures (𝑏Y∗8 * ).
The wavelength signatures (𝑐𝑤* ) are represented in components including both wavelengths (𝑏𝑠 ∗
𝑤), without taking into account their spatial dependence. (c) PARAFAC consists of finding the
matrices 𝛢 = A𝑎* B, 𝐵 = A𝑏* B 𝑎𝑛𝑑 𝐶 = A𝑐* B that explain 𝑋 with minimal residual error. tPCA
and ICA specifies the matrices 𝛢8 = A𝑎* B, 𝐵8 = A𝑏* B, where the relative contribution of the
different wavelengths is implicitly included in the first and second halves of the rows of matrix B.
For example, for the same temporal signature of each component, there will be two topographies
corresponding to the two wavelengths.

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

8

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352

The main advantage of this method is that it provides a unique decomposition of the fNIRS
data into components that reflect different activities that do not need to be orthogonal or
statistically independent in any of the dimensions. As long as there is any activation resulting from
a different behavior in one of the dimensions, it can be extracted as a separate component. The
only indeterminacy in the least square solution is the order of the components and the relative
scaling of the signatures. The spatial dependency between wavelengths is therefore exploited in
order to perform the decomposition. In this work, we included the PARAFAC implementation
from the N-way Toolbox (Andersson & Bro, 2000) into our homemade toolbox (LIONIRS created
by J. Tremblay, eng.) so as to visualize and apply the decomposition exclusively during selected
time intervals and channels. Components are ordered according to their importance in explaining
the data’s variance (similar to PCA). The temporal scale used to visualize the components is kept
intact, while the other dimensions are normalized so as to have Frobenius norms equal to one.
Since measures from both wavelengths are sampled simultaneously at each specific
position on the scalp, movement artifacts affect their amplitudes similarly. During time intervals
containing artifacts, the time courses of the signal from the two wavelengths commonly show a
drastic and correlated increase as compared to the task-related or baseline signal (Cui et al., 2010).
By using multidimensional PARAFAC decomposition, we can take advantage of this information
for the adequate selection of components of the artifact’s signature.
PARAFAC decomposition was specified to sort between two to four components,
representing the artifacts characteristics and allowing a clear separation of the artifact signature
from the rest of the signal. The appropriate components were selected based on (1) a visual
inspection of their temporal overlap with the artifact, (2) the smallest number of possible
components that would sufficiently correct the artifact, and (3) components showing similar
weights for both wavelengths. Usually, one to three components were needed in order to achieve
a satisfactory correction of the artifact, without removing the characteristics related to the true
cerebral activity.

353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369

As a second step, to the clean signal we applied PARAFAC and other commonly used
methods, to characterize activation patterns and assess the utility of PARAFAC to model the brain
response in fNIRS. First, the optical intensity of the two wavelengths was transformed into relative
concentration changes of HbO and HbR, done so by use of the modified Beer-Lambert Law
(Kocsis, Herman, & Eke, 2006). For each participant, all blocks underwent detrending in order to
align the beginning and end of the segments. Then, in order to characterize the cerebral activation
pattern related to the verbal fluency task, three different approaches were applied to the 30-s task
period of each block: (i) the General Linear Model (GLM), (ii) the global averaged concentration
changes of each channel, and (iii) the PARAFAC analysis.
(i) General linear model (GLM) assumes that there exist linear relations between different
inputs (Friston, Ashburner, Kiebel, Nichols, & Penny, 2011). It has been applied in several fNIRS
studies to specify the hemodynamic response function (Minagawa-Kawai et al., 2011; Schroeter
et al., 2004; Sungho Tak & Ye, 2014). For each participant, the task-related cerebral activation (y)
is modeled separately for every single block, using a GLM defined as follows in Equation 3.

4.6

Characterizing fNIRS activation patterns

(3) 𝑦 = ß^ + ß+ 𝑎 + ß- 𝑏 + ɛ

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

9

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410

In this equation, ß^ is a constant. ß+ represents the relative contribution of the modeled
hemodynamic response (Glover, 1999) (concentration changes of HbO and HbR respectively)
based on the temporal characteristics of the stimuli defined in 𝑎. ß- represents the contribution of
physiological components measured with the short-distance (< 1cm) source-detector pair 𝑏, and ɛ
represents the unexplained part of the data related to noise or other unknown sources. ß+ of each
channel was averaged across blocks and used in a one sample t-test against 0 to identify channels
showing significant temporal overlap with the hemodynamic response function, which was
modeled based on the stimuli presentation. This allowed to derive the temporal and spatial
characterization of the dominant cerebral activation pattern during the semantic verbal fluency
task, as revealed by the GLM.
(ii) The computation of the global averaged concentration changes of each channel is a
straightforward approach to explore the spatial distribution of the task-related hemodynamic
response (Sungho Tak & Ye, 2014; X. Zhang et al., 2017). The relative weight of the short-distance
channel (ß- ) allows for the subtraction of physiological components from the fNIRS signal. The
global average of HbO and HbR concentration changes, for every channel and across each block,
is calculated on the corrected signal. For each block, the data used is from 5 to 20 seconds after
task onset. Channels with significant concentration changes are identified using T-tests on each
channel’s average signal as compared to 0.
(iii) PARAFAC. A PARAFAC decomposition with a single component was applied for each
block of each participant’s data set after the subtraction of physiological noise from the shortdistance channel (ß- ). We assumed that after removing artifacts and physiological noise, the
activation related to the verbal fluency task would stand out as the main component of the
PARAFAC decomposition. In some cases, we obtained an “inverted” component, i.e. that loaded
negatively on channels, and indicated a decrease in concentration changes of HbO related to the
task instead of an increase, with the inverse phenomenon for HbR. Thus, in order not to change
the meaning of the data, in this particular case, the signatures obtained by PARAFAC were
subjected to a sign adjustment. We based ourselves on the experimental fact that HbO
concentration changes are typically higher than those for HbR. Then, the sign of each pair of
signatures was changed to obtain components that represented activation scores of HbO higher
than those of HbR, while the mean of the temporal signature remains positive (see Figure 6 in
Appendix for a detailed description of the different cases found). This type of empirical
adjustments has also been reported in other neuroimaging studies (Bro & De Jong, 1997; Mørup
et al., 2006) (Bro & De Jong, 1997; Mørupe et al., 2005).
Similar to the coefficient in the GLM, which indicates how much the signal of a specific
channel contributes to the modeled hemodynamic response based on the time course of the stimuli,
the temporal signature of the PARAFAC component should represent the time course of the
cerebral activation related to the task. The spatial signature shows how much each channel
contributes to this component (topography), and the hemodynamic signature contains two relative
scores specifying how much its activation is represented in the HbO and HbR signals.

411
412
413
414
415

In order to evaluate the use of PARAFAC for the correction of movement artifacts in fNIRS
data, its performance is compared to the well-established 2D decomposition techniques (tPCA and
ICA), with the use of two quality measures.
First, we calculated an estimation of the signal-to-noise ratio (SNR), as defined by Sweeney and
colleagues (2012):

4.7

Statistical analysis

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

10

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
eg

(4) 𝑆𝑁𝑅 = 10𝑙𝑜𝑔+^ efg

416

h

417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454

Here, 𝜎-j represents the signal’s variance computed in segments of data, where no artifacts
were identified, while 𝜎-k represents the variance of the analyzed signal in a segment where an
artifact was identified. As the latter will usually be higher than the former (since it comprises both
the variance of the physiological signal and the variance of the artifact), the SNR is expected to be
negative whenever an artifact is present in the analyzed segment. After removing the artifact from
the analyzed signal, the SNR is computed in order to identify how effectively the artifact was
removed from the signal. A zero value for the SNR would indicate equal variances, meaning that
an artifact was eliminated to the extent that the corrected signal does not differ from periods in
which no artifact was identified. A negative value would suggest that there is some remaining
variance from the artifact, and a positive value would suggest that elimination of the artifact
probably subtracted part of the relevant physiological activity. Repeated-measures analysis of
variance (ANOVA) and post-hoc tests with Bonferroni corrected p-values were used to compare
statistically the differences between the SNR of the uncorrected signal and the signal corrected
with the three different methods for artifact correction.
Then, Pearson’s correlation coefficient between the time courses for both wavelengths was
used as a measure of the efficiency of the artifact correction (Cui et al., 2010). This is in line with
the assumption that a high correlation coefficient indicates the presence of artifactual signals, since
in a clean signal these temporal courses appear much less correlated. We used Fisher’s
transformation to convert correlation coefficients into z-values to obtain an approximately normal
distribution. Repeated-measures ANOVA allowed for the comparison of the mean Pearson’s
correlation coefficient between the uncorrected segment to those corrected, and this for each of the
three methods as well as for a time interval without artifacts (5-s baseline at rest). Pearson’s
correlation of the 5-s baseline served as a reference for a segment without artifacts and with no
task-related cerebral activation.
Regarding brain activation related to the verbal fluency task, we aimed to compare
temporal (time), topographical (space), and hemodynamic (HbO/HbR) results specified by the
PARAFAC component with results from the hemodynamic response function (HRF) estimated
with the GLM, as well as the global average for each channel. Temporal and hemodynamic
characteristics were visually compared, based on time courses of the task-related concentration
changes in HbO and HbR within the regions of interest (ROI) as revealed by each of the three
methods (PARAFAC, GLM, global average). Our ROI were defined as the left Broca’s area,
according to Brodmann 44, 45, and its homologous channels in the right hemisphere as the right
Broca’s area (see Figure 4). Comparisons of the spatial characteristics of the task-related activation
are conducted for the mean concentration changes of every channel. A one-sample t-test between
the relative weight (PARAFAC), the ß+ (GLM) and the mean HbO and HbR concentration changes
(global average) is tested against 0.

455

5

456
457
458
459

From the whole sample of 18 participants, one participant was excluded from analyses, as
artifact detection revealed a signal containing too many segments with noise, thus precluding the
use of the quality measures to compare artifact correction techniques. The final sample for the
validation of using PARAFAC for artifact correction included 17 participants who, on average,

Results

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

11

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
460
461
462
463

completed 10.4 ± 0.9 blocks of the verbal fluency task. During each 30s-blocks of the verbal
fluency task, participants named an average of 14 ± 2.2 words.

464
465
466
467
468
469
470
471
472
473
474
475
476
477

Figure 3 provides an example of target artifact correction with PARAFAC and tPCA,
illustrating the difference between the 2D and 3D target decomposition for motion artifact
correction. Time courses of the PARAFAC decomposition with three components allowed for easy
differentiation between two components, their distinct artifact signatures, and one component
representing the clean signal (Fig. 3b). We were able to identify components that showed similar
characteristics for both wavelengths, based on the wavelength weights (Fig. 3d). Artifacts are
known to affect both wavelengths similarly, thus equal contribution to a component of both
wavelengths is considered a reliable characteristic of an artifact component (Cui et al., 2010). On
the one hand the principal component of tPCA seems to catch the characteristics of one of the two
distinct artifacts, but not both (Fig. 3e). Signal correction that uses the two PARAFAC components
(Fig. 3g) subsequently results in a less noisy time interval. TPCA, on the other hand, only seems
to achieve a partial correction.

5.1

Artifact correction

c.

b.

d.

g.

Arb. unit

Components

Components

Time [s]

e.

Arb. unit

Arb. unit

a.

h.

Arb. unit

Arb. unit

f.

Time [s]

Time [s]

478
479
480
481
482
483
484
485
486
487
488
489
490

Component

Time [s]

Figure 3. Example of target 3D PARAFAC and 2D tPCA decomposition to correct motion artifacts
in a fNIRS data set. (a) shows the uncorrected segment. (b), (c) and (d) illustrate temporal, spatial
(channel) and wavelength characteristics of the components identified with PARAFAC. (e) and (f)
include the temporal and spatial characteristics of the signal, as revealed by the principal
component of tPCA. (g) and (h) reveal the corrected signal, illustrating the efficacy of movement
artifact correction with PARAFAC and tPCA respectively.
Our comparison of the signal-to-noise ratio (SNR) included 1,401 time intervals with
previously identified artifacts, and which contained a total number of 19,630 channels for
HbO/HbR. The uncorrected signal with artifacts has a SNR value of M = -0.69 dB (SD = 0.65 dB);
the signal corrected with PARAFAC, M = -0.31 dB (SD = 0.58 dB); tPCA, M = -0.33 dB (SD =
Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

12

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506

0.58 dB); and ICA, M = -0.50 dB (SD = 0.64 dB) respectively. Repeated-measures ANOVA for all
conditions (signal without correction, signal corrected with PARAFAC, tPCA or ICA) revealed a
significant global effect, F (2.3, 44966.3) = 7550.7, p < 0.001, ɲ = 0.28. Pairwise comparisons
with Bonferroni correction indicate a significant difference between all SNR. All three artifact
correction methods have an increase, as compared to the uncorrected signal, thus suggesting that
all of them resulted in a significant improvement of the signal’s quality, as compared to the
uncorrected signal (see Table 1). According to the mean SNR, PARAFAC achieves the highest
correction, followed by tPCA and then ICA. As the number of segments used for statistical
analyses was rather large, it is relevant to consider effect sizes. The differences between the SNR
of the PARAFAC corrected signal and the uncorrected signal, as well as between PARAFAC and
ICA corrected signal, represent large effects (ɲ = 0.45 and ɲ = 0.13, respectively; Cohen, 1988).
The difference in SNR between tPCA and PARAFAC corrections is a rather small effect (ɲ =
0.002).

507
508

Pairwise comparisons of the signal-to-noise ratio between correction techniques and the noncorrected signal

509
510
511
512
513
514
515
516
517
518
519
520
521

Table 1

Note. Parallel factor analysis (PARAFAC); target principal component analysis (tPCA);
independent component analysis (ICA). The table contains the mean differences between the
signal-to-noise ratio of the time interval with artifacts for the uncorrected signal, and the signal
where the three different motion artifact correction techniques, PARAFAC, tPCA and ICA, were
applied.
*Significant difference at p < 0.001 after Bonferroni correction for multiple comparisons.
Within segments with artifacts (n= 9815), Pearson’s correlations between the time courses
of the signal of both wavelengths was computed for all channels. Mean correlation coefficients
across all these segments were compared for the uncorrected segment, the one corrected with each
of the three different motion artifact correction techniques, as well as the artifact-free baseline
Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

13

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543

period. During the baseline, the time courses of the different wavelengths correlated on average at
r = 0.47 (SD = 0.33). Both wavelengths correlated on average at r = 0.74 (SD = 0.29) for the
uncorrected segments, at r = 0.51 (SD = 0.38) after PARAFAC correction, at r = 0.53 (SD = 0.38)
after tPCA correction, and at r = 0.67 (SD = 0.38) after ICA correction. The highest mean
correlation thus corresponded to the uncorrected signal with artifacts, followed by ICA, tPCA,
PARAFAC, and finally, the baseline reference.
Mean correlation coefficients of all channels were transformed into z-scores using Fisher
transformation, in order to achieve approximately normal distribution. Repeated-measures
ANOVA reveals a significant difference between the five conditions: F (3.2, 30969.8) = 1908.8, p
< 0.01, ɲ = 0.16. Pairwise comparisons with Bonferroni corrected p-value for multiple
comparisons further indicate significant differences of Pearson’s correlation of the time course of
both wavelengths between PARAFAC and all other conditions (see Table 2): 1) PARAFAC vs.
uncorrected signal: p < 0.001, ɲ = 0.35; 2) PARAFAC vs. tPCA: p < 0.001, ɲ = 0.01; 3) PARAFAC
vs. ICA: p < 0.001, ɲ = 0.14; and 4) PARAFAC vs. baseline: p < 0.001, ɲ = 0.01.
Differences in Pearson’s correlation coefficients between the PARAFAC corrected signal
and the uncorrected signal, as well as between PARAFAC and ICA corrected signal, represent
large effects (ɲ = 0.43 and ɲ = 0.18, respectively; Cohen, 1988)). Differences in correlation
coefficients between PARAFAC and tPCA, as well as between PARAFAC and the baseline signal,
represent small to medium effects (both ɲ = 0.02).

544

Mean Pearson’s Correlations between wavelengths

545
546
547
548
549
550
551

Note. The table shows the mean differences between the Pearson’s correlations of the time interval
with artifacts for the uncorrected signal, the time interval for which the three motion artifact
correction techniques, PARAFAC, tPCA and ICA were applied, and also for the baseline segment
at rest, where no artifact was identified.
*Bonferroni corrected p-value for multiple comparisons: p ≤ 0.001.

Table 2

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

14

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
552

5.2

Characterization of task-related cerebral activation

553
554
555
556
557
558
559
560
561
562

Four participants were excluded for the characterization of brain activation, for a total of
14 participants included in the analyses. In addition to the one excluded for the first part of the
study (motion artifact correction), three participants did not achieve satisfactory data quality even
after artifact correction (i.e. too many channels were missing due to aberrant amplitude or
frequency).
The complete topographical representation of all significant cerebral activation for the three
approaches, PARAFAC, GLM, and global average, are illustrated in Figure 4. Results revealed
significant activation within our ROI for all three approaches (see Table 3).

563
564
565
566
567
568
569
570
571
572

Figure 4. Topographical representation of significant task-related cerebral activation. Cerebral
activation as revealed by the PARAFAC component (i.e. time dimension × hemodynamic
dimension), the HRF from the GLM, and global average during 30s verbal fluency task. Only
significant mean concentration changes in HbO (left) and HbR (right), as revealed by the onesample t-tests against 0, are illustrated (t ≥ 1.64 for HbO, t ≤ -1.64 for HbR; one-tailed p < .05).
Relative contribution of each method (i.e. mean relative weights for the PARAFAC component,
mean Beta values for the HRF specified in the GLM, and global average per channel) are displayed
in a relative scale ranging from -1 to 1. A value of 1 indicates maximum increase of HbO
concentration, a value of -1 represents a maximum decrease of HbR concentration.

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

15

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
573

Table 3

574
575

Significant task-related cerebral activation associated to the verbal fluency task as revealed with
PARAFAC, GLM and global average for left and right Broca’s areas

576
577
578
579
580
581
582
583
584
585
586

Note. Relative contribution of channels in the ROI was evaluated using mean relative weights for
the PARAFAC component, mean ß+ values for the HRF from the GLM, and global average for
concentration changes. For each method, mean relative contribution during the 30s of the verbal
fluency task was tested against 0 by use of a one-sample t-test.
*One-tail p < 0.05.
Figure 5 is an illustration of the temporal courses of the task-related cerebral activation
obtained from the PARAFAC component, GLM and global averaging within our ROIs (left and
right Broca’s area) during the 30s period of the verbal fluency task.

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

16

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS

Arb. unit

3030

GLM
Global average
PARAFAC

20

Arb. unit

2010
0

10
-10
0

0

10

20

30

40

Time [s]

-10
0

10

20

30

40

Time [s]
587
588
589
590
591
592
593

Figure 5. Description of the task-related brain activation pattern. Representative time course of
hemodynamic response in the left Broca’s area during the 30s verbal fluency task, as identified
with the PARAFAC temporal component (solid line), modeled HRF as estimated by GLM (dashed
line), and global averaged channels (dotted line). Black lines represent concentration changes in
HbO, light grey lines are concentration changes in HbR.

594

6

595
596
597
598
599
600
601

This study aimed to introduce and validate parallel factor analysis (PARAFAC), a
multidimensional decomposition technique, for the analysis of fNIRS data. First, we investigated
the efficacy of PARAFAC for the detection and correction of movement artifacts, as it would offer
a very beneficial method in fNIRS. Second, we explored the usefulness of PARAFAC in
identifying the dominant task-related activation in noisy experimental data. For both parts of our
intended validation, results were compared to commonly used methods in fNIRS.

602
603
604
605
606
607

Discussion

6.1

Artifact detection and correction

Several studies have shown promising results by using PARAFAC for artifact detection
and correction, as well as to extract patterns of cerebral activation in EEG data (Martínez-Montes
et al., 2004; Miwakeichi et al., 2004; Mørup et al., 2006). Our results are in line with these,
expanding the application of PARAFAC for artifact correction and the extraction of cerebral
activation patterns, thus extending the method’s use in fNIRS.

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

17

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651

Signal quality was evaluated using the SNR for segments in which artifacts were detected.
All artifact correction techniques resulted in a significant improvement of the signal’s quality, and
thus a decrease of the noise in the artifact segments. ICA was applied, as reported in the literature,
to the entire signal (H Zhang et al., 2010), while tPCA and PARAFAC were target-based, i.e. only
decomposing the signal during specific segments where artifacts had been detected. In line with
previous findings, our analyses reveal an advantage in applying target corrections (tPCA and
PARAFAC) instead of whole-block (ICA) correction, resulting in a better signal quality (Behrendt
et al., 2018; Yücel et al., 2014). Furthermore, comparisons between tPCA and PARAFAC suggest
that the multidimensional approach of PARAFAC results in a slightly better correction. This means
concentration changes in artifact segments after PARAFAC corrections achieved the smallest
variance among the three methods. Nevertheless, it remains important to consider that the
difference observed between tPCA and PARAFAC, though significant, has a small effect size,
while the efficacy of PARAFAC is more robust as compared to ICA (large effect size). As proposed
by Yücel et al. (2014), target artifact correction prevents change in the overall composition of the
signal, and exclusively corrects the noisy time interval of the artifact. It allows the decomposition
to clearly sort a component representing the artifact signature, without considering the
characteristics of these channels during the intervals without artifacts. Target decomposition
techniques are thus beneficial for a precise identification of the artifact’s signature.
Signal quality was also evaluated using Pearson's correlation between the time course of
both wavelengths, based on the assumption that different wavelengths (related to HbO and HbR
concentrations) assessed at the same location are similarly affected by movement artifacts (Cui et
al., 2010). Thus, the signal shows higher correlation between wavelengths when it reflects the same
movement artifact, compared to a lower correlation for intervals where less or no artifact is present.
Of the three different decomposition techniques, correction with PARAFAC led to the lowest
correlation between HbO and HbR indices, as well as the correlation index that most resembles
the non-artifactual baseline reference. Even though the resting-state signal has been reported to
show slightly different hemodynamic changes, compared to the task-stimulation (Liu, 2013; Han
Zhang et al., 2011), we consider it a suitable reference for a time interval without artifacts, because
it should not be affected by articulation. Two-dimensional decomposition on the other hand, such
as ICA and tPCA, analyzes both wavelengths as independent measures of the fNIRS signal, even
though they are in fact highly related, since they are acquired at the same location (Cui et al., 2010)
Taken together, our results suggest that decomposition with PARAFAC allows an accurate
detection and correction of artifacts. Decomposition with PARAFAC offers an approach whereby
it is rather easy to make a selection of relevant components that differentiate between signatures
related to artifacts or other relevant characteristics of the signal. Its efficacy resembles that
obtained from tPCA, but its consideration of the intrinsically multidimensional structure of the
fNIRS signal, as well as the absence of orthogonality or independence constraints, stand out as
important advantages of PARAFAC. Even if fNIRS is considered to be less sensitive to
movements, compared to other neuroimaging techniques such as fMRI, appropriate tools for
artifact correction are essential, particularly for data acquired in populations where cooperation is
limited, such as children and clinical populations (S Tak, Kempny, Friston, Leff, & Penny, 2015).
PARAFAC thus appears to be a suitable alternative to the currently used approaches, and will be a
valuable add-on for fNIRS studies and clinical examinations by minimizing the amount of nonusable data and improving data quality.

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

18

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
652

6.2

Characterizing fNIRS activation patterns

653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693

We applied a PARAFAC model with one single component, because by using the shortdistance channel, we corrected our signal for systematic influences of physiology, and assumed
that the remaining dominant signature represented the task-related cerebral activation. If there are
empirical or theoretical reasons to expect more than one relevant component (e.g. resting state
functional connectivity analysis, epileptic activity, physiological aspects, etc.), PARAFAC would
also allow to for an increase in the number of components. In previous studies, the same semantic
verbal fluency paradigm that we applied in our study reliably elicited typical cerebral activation
within brain regions commonly associated with expressive language, namely the left Broca’s area
(Gaillard et al., 2003; Gallagher et al., 2016; Paquette et al., 2015). Therefore, we defined the ROI
as the left Broca’s area, as well as the homologous areas in the right hemisphere. We expected that
roughly 5 seconds after task onset, the temporal and hemodynamic distributions would be reflected
as an increase of HbO and a slight dip of HbR within the ROI (Glover, 1999).
The modeled time course indicates that, in contrast to GLM, both data-driven approaches,
PARAFAC and global average, indicate an earlier onset of the hemodynamic response. A datadriven approach therefore provides more flexibility in paradigms or populations where cerebral
activation may show alterations. Topographical representations of the task-related activation, on
the other hand, does not clearly differ between GLM and global average. Our analysis of the mean
relative weight of each channel for the PARAFAC component revealed significant task-related
concentration changes in HbO and HbR within the ROI. This result was validated with the GLM
and global average, which both showed a significant hemodynamic response within the ROI.
PARAFAC, however, provides a slightly more distributed activation pattern, compared to both
other approaches. Since the GLM imposes a modeled HRF with a specific time course, it may
exclude channels with minor temporal deviations, an aspect that has been discussed critically on
several previous studies (e.g. Monti, 2011; Scarpa et al., 2012). Global average intrinsically
represents an approach to both minimizing variability and outlining the most constant information
from the data, hence it is not surprising to obtain a more condensed spatial pattern. Both GLM and
global average likely show the most dominant activation representing a more simplified pattern of
cerebral activation. Topographical findings from PARAFAC reveal a brain activation that spreads
into more cerebral regions known to be involved in expressive language processing (e.g. Hickok
& Poeppel, 2000; Poeppel, Emmorey, Hickok, & Pylkkanen, 2012; Skeide & Friederici, 2016).
What is more, given that neither GLM nor global average treats HbO and HbR
simultaneously, their results may only demonstrate strong concentration changes in either
dimension, while ignoring the task-related dynamics of HbO and HbR. However, PARAFAC
components are based on matrices that simultaneously consider time, space and hemodynamic
dimensions, thus resulting in a component that considers the dynamics of both. Several studies
have emphasized the importance of including both indices of concentration changes, in order to
reliably interpret hemodynamic changes (Obrig et al., 2010; Quaresima et al., 2012; Wolf &
Greisen, 2009). Applying PARAFAC for data analysis in fNIRS would allow a better exploitation
of both HbO and HbR indices and their dynamics, hence leading to enriched results.

694
695
696

PARAFAC is a data-driven approach based on the linear relations of the three dimensions
of the fNIRS signal (Bro, 1998; Martínez-Montes et al., 2004; Miwakeichi et al., 2004). PARAFAC
has the advantage of allowing for the three-way arrays of data to be uniquely decomposed into a

6.3

Integration and utility of PARAFAC

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

19

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742

sum of components, each of which is a trilinear combination of factors or signatures. One of the
only statistical requirements of PARAFAC is that of a moderate linear independence across
components, i.e. their time course, topography and wavelength characteristics. This is a less
stringent requirement than previous models that underly space/time decompositions (PCA or ICA).
Each component provides characteristics of a particular pattern identified within the correlation
matrix. GLM and global average, on the other hand, treat each channel independently. These
techniques provide a narrower spatial representation of the dominant activation compared to
PARAFAC. In fact, PARAFAC analysis suggests a rather distributed activation pattern, while still
revealing a dominant activation within our ROI. This strongly corresponds to the current
understanding of cerebral processing, whereby large scale networks, and not isolated regions, are
involved in language processing (e.g. Hickok & Poeppel, 2000; Poeppel et al., 2012; Skeide &
Friederici, 2016). The use of PARAFAC to characterize hemodynamic patterns therefore appears
to be more suitable for reflecting the cerebral processes occurring in distributed networks, rather
than for the identification of a specific core region. Moreover, the topographic signature reflects
the whole time course of the extracted activations, and can easily be subjected to diffusion optical
tomography in order to locate the concentration changes in HbR and HbO in brain context
(Tremblay et al., 2018).
Different from ICA, PARAFAC components can be ordered according to their importance
in explaining the data’s variance (e.g. Choi, Hwang, & Timmerman, 2018). This is why many
studies using ICA apply data reduction or clustering techniques such as PCA prior to the execution
of ICA (e.g. Makeig et al., 2002; H Zhang et al., 2010). When using PARAFAC, the description of
data is based on more dimensions, and with less theoretical constraints (orthogonality,
independence) which lead to the identification of fewer relevant components (Deburchgraeve et
al., 2009; Martínez-Montes et al., 2004; Miwakeichi et al., 2004; Sidiropoulos & Bro, 2000).
Compared to ICA, the selection of the relevant components is thus simplified. Importantly, when
using PARAFAC, it is not recommended to ask for more than five components, as this increases
the risk of overfitting the data with the decomposition model. Usually, three to five components
sufficiently describe the signal’s characteristics (Acar et al., 2007). Similarly to PCA, a typical
choice made when using PARAFAC analysis, is that of ordering the extracted components
according to their contribution to explaining the variance of the data. In this sense, it can be
expected that the first PARAFAC component will always represent the highest activity, which, in
the case of target artifact correction, will correspond to the artifact activity. This makes PARAFAC
also a promising choice to explore the development of simple automatic methodologies for the
detection and correction of such artifacts.
Some challenges of PARAFAC have already been discussed in previous studies (MartínezMontes et al., 2004; Miwakeichi et al., 2004). First, PARAFAC assumes linear relations of the
temporal characteristics between different channels. Despite being one of the most common and
simple models, imposing linearity may not entirely reflect complex cerebral processes (Huppert,
2016). Some attempts have been made to introduce approaches that tolerate non-linear relations
(e.g. Freiwald et al., 1999; Hu & Liang, 2014). However, to date, linear models remain the most
popular approach for data analysis in neuroscience. Thus, it represents a general limit of the
domain, rather than one specific to PARAFAC.
A second limitation regards the need for careful preprocessing of data before characterizing
brain activity. When PARAFAC was introduced for the analysis of EEG data, the authors
emphasized the importance of searching for constant factors, outliers, and degeneracy (Field &
Graupe, 1991; Miwakeichi et al., 2004). Detailed information on how to deal with these aspects

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

20

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765

can be found in previous literature (e.g. Miwakeichi et al., 2004). In the current study, the way
PARAFAC has been implemented into the toolbox (LIONNIRS created by J. Tremblay, eng.) gave
us a certain flexibility regarding the channels and time segments to be included. Thus, deviant
channels were not considered.
An application of PARAFAC, not yet tested in fNIRS, is its use as a screening tool. For
instance, Miwakeichi and colleagues (2004) applied PARAFAC to an EEG dataset in order to
extract one component related to ocular movement artifacts, and subsequently used algorithms
based on that component to screen a second dataset in order to identify and correct similar artifacts.
Although this can be useful for correcting artifacts that have consistent topographical and
wavelength profiles, in our study, movement artifacts were mostly related to articulation, often
showing quite different signatures. A different paradigm may enable the testing of this application
of PARAFAC in fNIRS.
Our findings also encourage the general application of PARAFAC for multidimensional
decomposition in neuroimaging, where data can often be described on more than two dimensions.
Beyond the obvious dimensions of a technique such as that of time × space × wavelength (fNIRS)
or frequency (EEG), characteristics of the task paradigm or group variables could also be
considered in the decomposition model (Mørup et al., 2006). For instance, if a “group” dimension
was to be included, groups could be compared regarding their relative weight over the main
cerebral activation component that would have been outlined from the PARAFAC model. There is
thus potential for PARAFAC to become a tool for data analyses, because it takes advantage of the
full richness of data sets in neuroscience.

766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787

The use of a language paradigm allowed for the induction of artifacts that were mainly
related to articulation, which limits the generalization from our results. From video recordings,
however, we were able to acknowledge that swallowing, jaw or tongue movements, eye blinks,
and frowning also induced artifacts in our dataset. Further fNIRS studies using PARAFAC, and
including different task paradigms and resting-state, would show its utility for a wider or different
range of artifacts.
Another limitation related to the generalization of our results is the specific use of the
simple least square technique to implement PARAFAC. Other methods have been proposed for
estimating PARAFAC models, but some studies have shown that, given the uniqueness of the
solution, they do not usually outperform the simple least square technique (Faber, Bro, & Hopke,
2003).
The validation of PARAFAC for artifact correction was conducted by comparing results
with two other decomposition techniques. This could be considered one limit of the present study,
because we did not consider other correction approaches for comparison. The objective of this
study was not to conduct exhaustive and systematic comparisons in order to identify the best
method for artifact correction, but rather to introduce PARAFAC as an alternative and adequate
analysis method in fNIRS. Future studies could therefore advance the validation of PARAFAC and
extend comparisons of its performance to other tools that do not necessarily use decomposition,
such as spline interpolation or wavelet filtering. With relation to that, even if there were to be a
slight advantage of PARAFAC over tPCA in artifact correction results, the small difference might
not have a concrete impact on the applicability of those two methods. Qualitative differences
between tPCA and PARAFAC regarding the type of artifacts and corrected signal should be further

6.4

Limits of the current study

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

21

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
788
789
790

assessed and described in subsequent studies, to better understand how their efficacy may vary
according an artifact’s characteristics.

791

7

792
793
794
795
796
797
798

PARAFAC allows for the simultaneous treatment of both wavelengths or HbO and HbR
during fNIRS data analyses. Our findings validate previous findings in EEG data and promote
multidimensional decomposition by use of PARAFAC as a promising new tool for the extraction
of relevant signatures represented in the fNIRS signal. The validation of its use for the correction
of movement artifacts, as well as to extract the pattern of a task-related cerebral activation, paves
the way for its future use in the domain of fNIRS research.

799

8

800
801
802

Conclusion

Appendix
Case 1
∑#$%& "(t) > 0 and C HbO>HbR
1x 1x 1=1
A = A ; B=B ; C=C

Case 3
∑#$%& "(t) > 0 and C HbO<HbR
1 x -1 x -1 = 1
A = A ; B=-B ; C=-C

Case 2
∑#$%& "(t) < 0 and C HbO>HbR
-1 x -1 x 1 = 1
A =-A; B =-B; C=C

Case 4
∑#$%& "(t) < 0 and C HbO<HbR
-1 x 1 x -1 = 1
A=-A ; B=B ; C=-C

A Time factor
B Spactial factor
C Hemodynamic factor

Figure 6. Positivity and negativity adjustment for PARAFAC component. Force HbO/HbR answer
to be positive/negative in the sense that PARAFAC found 1x1x1 or 1x(-1)x(-1) without
discrimination in the decomposition.

803
804

9

References

805
806
807
808

Aarabi, A., & Huppert, T. J. (2016). Characterization of the relative contributions from systemic
physiological noise to whole-brain resting-state functional near-infrared spectroscopy data
using single-channel independent component analysis. Neurophotonics, 3(2), 025004.
https://doi.org/10.1117/1.NPh.3.2.025004

809
810

Acar, E., Aykut-Bingol, C., Bingol, H., Bro, R., & Yener, B. (2007). Multiway analysis of epilepsy
tensors. Bioinformatics, 23(13), i10–i18. https://doi.org/10.1093/bioinformatics/btm210

811
812

Andersson, C. A., & Bro, R. (2000). The N-way Toolbox for MATLAB. Chemometrics and
Intelligent Laboratory Systems, 52(1), 1–4. https://doi.org/10.1016/S0169-7439(00)00071-X

813
814
815

Becker, H., Comon, P., Albera, L., Haardt, M., & Merlet, I. (2011). Multi-way space-time-wavevector analysis for EEG source separation. Signal Processing, 92, 1021–1031.
https://doi.org/10.1016/j.sigpro.2011.10.014

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

22

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
816
817
818

Behrendt, H. F., Firk, C., Nelson, C. A., & Perdue, K. L. (2018). Motion correction for infant
functional near-infrared spectroscopy with an application to live interaction data.
Neurophotonics, 5(01), 1. https://doi.org/10.1117/1.NPh.5.1.015004

819
820
821

Boas, D. a, Gaudette, T., Strangman, G., Cheng, X., Marota, J. J., & Mandeville, J. B. (2001). The
accuracy of near infrared spectroscopy and imaging during focal changes in cerebral
hemodynamics. Neuroimage, 13(1), 76–90. https://doi.org/10.1006/nimg.2000.0674

822
823
824
825

Brigadoi, S., Ceccherini, L., Cutini, S., Scarpa, F., Scatturin, P., Selb, J., … Cooper, R. J. (2014).
Motion artifacts in functional near-infrared spectroscopy: A comparison of motion correction
techniques applied to real cognitive data. NeuroImage, 85, 181–191.
https://doi.org/10.1016/j.neuroimage.2013.04.082

826
827
828

Brigadoi, S., & Cooper, R. J. (2015). How short is short? Optimum source–detector distance for
short-separation channels in functional near-infrared spectroscopy. Neurophotonics, 2(2),
025005. https://doi.org/10.1117/1.NPh.2.2.025005

829
830

Bro, R. (1998). Multi-way Analysis in the Food Industry Models, Algorithms, and Applications
(Royal Veterinary and Agricultural University). Retrieved from http://newton.foodsci.kvl.dk.

831
832
833

Bro, R., & De Jong, S. (1997). A fast non-negativity-constrained least squares algorithm. Journal
of
Chemometrics,
11(5),
393–401.
https://doi.org/10.1002/(SICI)1099128X(199709/10)11:5<393::AID-CEM483>3.0.CO;2-L

834
835
836

Calhoun, V. (2018). Data-driven approaches for identifying links between brain structure and
function in health and disease. Dialogues in Clinical Neuroscience, 20(2), 87–99. Retrieved
from http://www.ncbi.nlm.nih.gov/pubmed/30250386

837
838
839

Carroll, J. D., & Chang, J.-J. (1970). Analysis of individual differences in multidimensional scaling
via an n-way generalization of “Eckart-Young” decomposition. Psychometrika, 35(3), 283–
319. https://doi.org/10.1007/BF02310791

840
841
842

Choi, J. Y., Hwang, H., & Timmerman, M. E. (2018). Functional Parallel Factor Analysis for
Functions of One- and Two-dimensional Arguments. Psychometrika, 83(1), 1–20.
https://doi.org/10.1007/s11336-017-9558-9

843
844

Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences (Second). New York, NY:
Lawrence Erlbaum Associates, Inc.

845
846

Comon, P. (1994). Independent component analysis, A new concept? Signal Processing, 36(3),
287–314. https://doi.org/10.1016/0165-1684(94)90029-9

847
848
849
850

Cooper, R. J., Selb, J., Gagnon, L., Phillip, D., Schytz, H. W., Iversen, H. K., … Boas, D. A. (2012).
A systematic comparison of motion artifact correction techniques for functional near-infrared
spectroscopy.
Frontiers
in
Neuroscience,
6(OCT),
1–10.
https://doi.org/10.3389/fnins.2012.00147

851
852
853
854

Cui, X., Bray, S., & Reiss, A. L. (2010). Functional near infrared spectroscopy (NIRS) signal
improvement based on negative correlation between oxygenated and deoxygenated
hemoglobin
dynamics.
NeuroImage,
49(4),
3039–3046.
https://doi.org/10.1016/j.neuroimage.2009.11.050

855
856

Deburchgraeve, W., Cherian, P. J. J., De Vos, M., Swarte, R. M. M., Blok, J. H. H., Visser, G. H.
H., … Van Huffel, S. (2009). Neonatal seizure localization using PARAFAC decomposition.
Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

23

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
857
858

Clinical
Neurophysiology,
120(10),
1787–1796.
Retrieved
https://www.sciencedirect.com/science/article/abs/pii/S1388245709004842

from

859
860
861

Faber, N. M., Bro, R., & Hopke, P. K. (2003, January 28). Recent developments in
CANDECOMP/PARAFAC algorithms: A critical review. Chemometrics and Intelligent
Laboratory Systems, Vol. 65, pp. 119–137. https://doi.org/10.1016/S0169-7439(02)00089-8

862
863
864

Field, A. S., & Graupe, D. (1991). Topographic component (Parallel Factor) analysis of
multichannel evoked potentials: Practical issues in trilinear spatiotemporal decomposition.
Brain Topography, 3(4), 407–423. https://doi.org/10.1007/BF01129000

865
866
867
868

Freiwald, W. A., Valdes, P., Bosch, J., Biscay, R., Jimenez, J. C., Rodriguez, L. M., … Singer, W.
(1999). Testing non-linearity and directedness of interactions between neural groups in the
macaque inferotemporal cortex. Journal of Neuroscience Methods, 94(1), 105–119.
https://doi.org/10.1016/S0165-0270(99)00129-6

869
870
871
872
873
874

Friston, K. J., Ashburner, J. T., Kiebel, S. J., Nichols, T. E., & Penny, W. D. (2011). Statistical
Parametric Mapping: The Analysis of Functional Brain Images. Retrieved from
https://books.google.ca/books?hl=de&lr=&id=G_qdEsDlkp0C&oi=fnd&pg=PP1&dq=Frist
on,+K.,+Ashburner,+J.,+Kiebel,+S.,+Nichols,+T.,+Penny,+W.,+2011.+Statistical+Parametr
ic+Mapping:+The+Analysis+of+Functional+Brain+Images:+The+Analysis+of+Functional
+Brain+Images

875
876
877
878

Gaillard, W. D., Sachs, B. C., Whitnah, J. R., Ahmad, Z., Balsamo, L. M., Petrella, J. R., …
Grandin, C. B. (2003). Developmental aspects of language processing: fMRI of verbal
fluency in children and adults. Human Brain Mapping, 18(3), 176–185.
https://doi.org/10.1002/hbm.10091

879
880
881

Gallagher, A., Tremblay, J., & Vannasing, P. (2016). Language mapping in children using restingstate functional connectivity: comparison with a task-based approach. Journal of Biomedical
Optics, 21(12), 125006. https://doi.org/10.1117/1.JBO.21.12.125006

882
883

Glover, G. H. (1999). Deconvolution of Impulse Response in Event-Related BOLD fMRI1.
NeuroImage, 9(4), 416–429. https://doi.org/10.1006/nimg.1998.0419

884
885
886

Harshman, R. A. (1970). Foundations of the PARAFAC procedure: Models and conditions for an
“explanatory” multimodal factor analysis (University Microfilms, Ann Arbor, Michigan; Vol.
16). Retrieved from http://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf

887
888
889

Hickok, G., & Poeppel, D. (2000). Towards a functional neuroanatomy of speech perception.
Trends in Cognitive Sciences, 4(4), 131–138. https://doi.org/10.1016/S1364-6613(00)014637

890
891

Hu, M., & Liang, H. (2014). A copula approach to assessing Granger causality. NeuroImage, 100,
125–134. https://doi.org/10.1016/j.neuroimage.2014.06.013

892
893
894

Huppert, T. J. (2016). Commentary on the statistical properties of noise and its implication on
general linear models in functional near-infrared spectroscopy. Neurophotonics, 3(1), 010401.
https://doi.org/10.1117/1.NPh.3.1.010401

895
896

James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). Classification. In An Introduction to
Statistical Learning (pp. 127–173). https://doi.org/10.1007/978-1-4614-7138-7_4

897
Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

24

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
898
899
900

Jobsis, F. F. (1977). Noninvasive, infrared monitoring of cerebral and myocardial oxygen
sufficiency and circulatory parameters. Science (New York, N.Y.), 198(4323), 1264–1267.
https://doi.org/10.1126/SCIENCE.929199

901
902
903

Jung, A., Theis, F. J., Puntonet, C. G., & Lang, E. W. (2001). Fastgeo-a histogram based approach
to linear geometric ICA. Proceedings of ICA Vol. 1, 349–354. Retrieved from
http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.16.924&rep=rep1&type=pdf

904
905
906

Jutten, C., & Herault, J. (1991). Blind separation of sources, part I: An adaptive algorithm based
on neuromimetic architecture. Signal Processing, 24(1), 1–10. https://doi.org/10.1016/01651684(91)90079-X

907
908
909

Kamran, M. A., Mannan, M. M. N., & Jeong, M. Y. (2016). Cortical Signal Analysis and Advances
in Functional Near-Infrared Spectroscopy Signal: A Review. Frontiers in Human
Neuroscience, 10, 261. https://doi.org/10.3389/fnhum.2016.00261

910
911
912
913

Klem, G. H., Lüders, H. O., Jasper, H. H., & Elger, C. (1999). The ten-twenty electrode system of
the International Federation. Electroencephalogr Clin Neurophysiol, 52(3), 3–6. Retrieved
from
http://www.clinph-journal.com/pb/assets/raw/Health
Advance/journals/clinph/Chapter1-1.pdf

914
915

Kocsis, L., Herman, P., & Eke, A. (2006). The modified Beer–Lambert law revisited. Physics in
Medicine and Biology, 51(5), N91–N98. https://doi.org/10.1088/0031-9155/51/5/N02

916
917

Liu, T. T. (2013). Neurovascular factors in resting-state functional MRI. NeuroImage, 80, 339–
348. https://doi.org/10.1016/J.NEUROIMAGE.2013.04.071

918
919
920

Lloyd-Fox, S., Blasi, A., & Elwell, C. E. (2010). Illuminating the developing brain: The past,
present and future of functional near infrared spectroscopy. Neuroscience and Behavioural
Reviews, 34, 269–284. https://doi.org/10.1016/j.neubiorev.2009.07.008

921
922
923

Makeig, S., Westerfield, M., Jung, T. P., Enghoff, S., Townsend, J., Courchesne, E., & Sejnowski,
T. J. (2002). Dynamic brain sources of visual evoked responses. Science, 295(5555), 690–
694. https://doi.org/10.1126/science.1066168

924
925
926

Martínez-Montes, E., Valdés-Sosa, P. A., Miwakeichi, F., Goldman, R. I., & Cohen, M. S. (2004).
Concurrent EEG/fMRI analysis by multiway Partial Least Squares. NeuroImage, 22(3),
1023–1034. https://doi.org/10.1016/j.neuroimage.2004.03.038

927
928
929

Minagawa-Kawai, Y., Van der Lely, H., Ramus, F., Sato, Y., Mazuka, R., & Dupoux, E. (2011).
Optical brain imaging reveals general auditory and language-specific processing in early
infant development. Cerebral Cortex, 21(2), 254–261. https://doi.org/10.1093/cercor/bhq082

930
931
932
933

Miwakeichi, F., Martínez-Montes, E., Valdés-Sosa, P. A., Nishiyama, N., Mizuhara, H., &
Yamaguchi, Y. (2004). Decomposing EEG data into space–time–frequency components
using
Parallel
Factor
Analysis.
NeuroImage,
22(3),
1035–1045.
https://doi.org/10.1016/j.neuroimage.2004.03.039

934
935

Möcks, J. (1988). Decomposing event-related potentials: A new topographic components model.
Biological Psychology, 26(1–3), 199–215. https://doi.org/10.1016/0301-0511(88)90020-8

936
937
938

Monti, M. (2011). Statistical Analysis of fMRI Time-Series: A Critical Review of the GLM
Approach.
Frontiers
in
Human
Neuroscience,
5,
28.
https://doi.org/10.3389/fnhum.2011.00028
Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

25

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
939
940
941

Mørup, M., Hansen, L. K., Herrmann, C. S., Parnas, J., & Arnfred, S. M. (2006). Parallel Factor
Analysis as an exploratory tool for wavelet transformed event-related EEG. NeuroImage,
29(3), 938–947. https://doi.org/10.1016/j.neuroimage.2005.08.005

942
943
944

Obrig, H., Rossi, S., Telkemeyer, S., & Wartenburger, I. (2010). From acoustic segmentation to
language processing: evidence from optical imaging. Frontiers in Neuroenergetics, 2(13), 13.
https://doi.org/10.3389/fnene.2010.00013

945
946
947
948

Paquette, N., Lassonde, M., Vannasing, P., Tremblay, J., Gonzalez-Frankenberger, B., Florea, O.,
… Gallagher, A. (2015). Developmental patterns of expressive language hemispheric
lateralization in children, adolescents and adults using functional near-infrared spectroscopy.
Neuropsychologia, 68, 117–125. https://doi.org/10.1016/j.neuropsychologia.2015.01.007

949
950
951

Peng, K., Khoa Nguyen, D., Tayah, T., Vannasing, P., Tremblay, J., Sawan, M., … Pouliot, P.
(2014). fNIRS-EEG study of focal interictal epileptiform discharges. Epilepsy Research, 108,
491–505. https://doi.org/10.1016/j.eplepsyres.2013.12.011

952

Plank, M. (2013). Ocular correction ICA. Brain Products Press Release, 49.

953
954
955

Poeppel, D., Emmorey, K., Hickok, G., & Pylkkanen, L. (2012). Towards a New Neurobiology of
Language.
Journal
of
Neuroscience,
32(41),
14125–14131.
https://doi.org/10.1523/JNEUROSCI.3244-12.2012

956
957
958

Quaresima, V., Bisconti, S., & Ferrari, M. (2012). A brief review on the use of functional nearinfrared spectroscopy (fNIRS) for language imaging studies in human newborns and adults.
Brain and Language, 121(2), 79–89. https://doi.org/10.1016/j.bandl.2011.03.009

959
960
961
962

Scarpa, F., Brigadoi, S., Cutini, S., Scatturin, P., Zorzi, M., Dell’Acqua, R., & Sparacino, G. (2013).
A reference-channel based methodology to improve estimation of event-related
hemodynamic response from fNIRS measurements. NeuroImage, 72, 106–119.
https://doi.org/10.1016/j.neuroimage.2013.01.021

963
964
965

Scarpa, F., Fabris, C., Brigadoi, S., Cutini, S., Scatturin, P., Dell’Acqua, R., & Sparacino, G.
(2012). A GLM-Based Approach to Estimate Stimulus- Evoked Hemodynamic Response from
fNIRS Measurements. 736–739.

966
967
968

Schroeter, M. L., Bücheler, M. M., Müller, K., Uludaǧ, K., Obrig, H., Lohmann, G., … Von
Cramon, D. Y. (2004). Towards a standard analysis for functional near-infrared imaging.
NeuroImage, 21(1), 283–290. https://doi.org/10.1016/j.neuroimage.2003.09.054

969
970
971

Schroeter, M. L., Kupka, T., Mildner, T., Uludağ, K., & von Cramon, D. Y. (2006). Investigating
the post-stimulus undershoot of the BOLD signal—a simultaneous fMRI and fNIRS study.
NeuroImage, 30(2), 349–358. https://doi.org/10.1016/J.NEUROIMAGE.2005.09.048

972
973
974

Sidiropoulos, N. D., & Bro, R. (2000). On the uniqueness of multilinear decomposition of N-way
arrays. Journal of Chemometrics, 14(3), 229–239. https://doi.org/10.1002/1099128X(200005/06)14:3<229::AID-CEM587>3.0.CO;2-N

975
976

Skeide, M. A., & Friederici, A. D. (2016). The ontogeny of the cortical language network. Nature
Reviews Neuroscience, 17(5), 323–332. https://doi.org/10.1038/nrn.2016.23

977
978

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

26

bioRxiv preprint doi: https://doi.org/10.1101/806778; this version posted October 16, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

Validation of parallel factor analysis (PARAFAC) for fNIRS
979
980
981
982

Sweeney, K. T., Ayaz, H., Ward, T. E., Izzetoglu, M., McLoone, S. F., & Onaral, B. (2012). A
Methodology for Validating Artifact Removal Techniques for Physiological Signals. IEEE
Transactions on Information Technology in Biomedicine, 16(5), 918–926.
https://doi.org/10.1109/TITB.2012.2207400

983
984
985

Tachtsidis, I., & Scholkmann, F. (2016). False positives and false negatives in functional nearinfrared spectroscopy: issues, challenges, and the way forward. Neurophotonics, 3(3),
031405. https://doi.org/10.1117/1.NPh.3.3.031405

986
987
988

Tak, S, Kempny, A. M., Friston, K. J., Leff, A. P., & Penny, W. D. (2015). Dynamic causal
modelling for functional near-infrared spectroscopy. NeuroImage, 111, 338–349.
https://doi.org/10.1016/j.neuroimage.2015.02.035

989
990

Tak, Sungho, & Ye, J. C. (2014). Statistical analysis of fNIRS data: A comprehensive review.
NeuroImage, 85, 72–91. https://doi.org/10.1016/j.neuroimage.2013.06.016

991
992
993
994

Tremblay, J., Martinez-Montes, E., Vannasing, P., Nguyen, D. K., Sawan, M., Lepore, F., &
Gallagher, A. (2018). Comparison of source localization techniques in diffuse optical
tomography for fNIRS application using a realistic head model. Biomedical Optics Express,
9(7), 448–454. https://doi.org/10.1364/BOE.9.002994

995
996
997

Tucker, L. R. (1966). Some mathematical notes on three-mode factor analysis. Psychometrika,
31(3),
279–311.
Retrieved
from
https://link.springer.com/content/pdf/10.1007%2FBF02289464.pdf

998
999
1000

Villringer, A., & Dirnagl, U. (1995). Coupling of brain activity and cerebral blood flow: basis of
functional neuroimaging. Cerebrovascular and Brain Metabolism Reviews, 7(3), 240–276.
Retrieved from http://www.ncbi.nlm.nih.gov/pubmed/8519605

1001
1002
1003

Wolf, M., & Greisen, G. (2009). Advances in near-infrared spectroscopy to study the brain of the
preterm and term neonate. Clinics in Perinatology, 36(4), 807–834, vi.
https://doi.org/10.1016/j.clp.2009.07.007

1004
1005
1006
1007

Yücel, M. A., Selb, J., Cooper, R. J., & Boas, D. A. (2014). Targeted principle component analysis:
A new motion artifact correction approach for near-infrared spectroscopy. Journal of
Innovative
Optical
Health
Sciences,
7(02),
1350066.
https://doi.org/10.1142/S1793545813500661

1008
1009
1010
1011

Zhang, H, Zhang, Y.-J., Lu, C.-M., Ma, S.-Y., Zang, Y.-F., & Zhu, C.-Z. (2010). Functional
connectivity as revealed by independent component analysis of resting-state fNIRS
measurements.
NeuroImage,
51,
1150–1161.
https://doi.org/10.1016/j.neuroimage.2010.02.080

1012
1013
1014

Zhang, Han, Zhang, Y.-J., Duan, L., Ma, S.-Y., Lu, C.-M., & Zhu, C.-Z. (2011). Is resting-state
functional connectivity revealed by functional near-infrared spectroscopy test-retest reliable?
Journal of Biomedical Optics, 16(6), 067008. https://doi.org/10.1117/1.3591020

1015
1016
1017

Zhang, X., Noah, J. A., Dravida, S., & Hirsch, J. (2017). Signal processing of functional NIRS
data
acquired
during
overt
speaking.
Neurophotonics,
4(04),
1.
https://doi.org/10.1117/1.NPh.4.4.041409

1018

Hüsser, Caron-Desrochers, Tremblay, Vannasing, Martínez-Montes & Gallagher

27

