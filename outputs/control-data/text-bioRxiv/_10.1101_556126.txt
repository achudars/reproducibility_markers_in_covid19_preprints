bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

3D computational models explain muscle activation patterns
and energetic functions of internal structures in fish
swimming
Tingyu Ming1Y , Bowen Jin1Y , Jialei Song1,2 , Haoxiang Luo3 , Ruxu Du2 , Yang Ding1*
1 Beijing Computational Science Research Center, Haidian District, Beijing, China
2 Department of Mechanical and Automation Engineering, Chinese University of Hong
Kong, Hong Kong SAR, China
3 Department of Mechanical Engineering, Vanderbilt University, Nashville, TN, USA
YThese authors contributed equally to this work.
* dingyang@csrc.ac.cn

Abstract
How muscles are used is a key to understanding the internal driving of fish swimming.
However, the underlying mechanisms of some features of the muscle activation
patterns and their differential appearance on different species are still obscure. In this
study, we explain the muscle activation patterns by using 3D computational fluid
dynamics models coupled to the motion of fish with prescribed deformation and
examining the torque and power required along the fish body with two primary
swimming modes. We find that the torque required by the hydrodynamic forces and
body inertia exhibits a wave pattern that travels faster than the curvature wave in
both anguilliform and carangiform swimmers, which can explain the traveling wave
speeds of the muscle activations. Most interestingly, intermittent negative power (i.e.,
power delivered by the fluid to the body) on the posterior part, along with a timely
transfer of torque and energy by tendons, explains the decrease of the duration of
muscle activation towards the tail. The torque contribution from the body elasticity
further solves the mystery of the wave speed increase or the reverse of the wave
direction of the muscle activation on the posterior part of a carangiform swimmer. For
anguilliform swimmers, the absence of the changes mentioned above in the muscle
activation on the posterior part is in line with our torque prediction and the absence
of long tendons from experimental observations. These results provide novel insights
into the function of muscles and tendons as an integrative part of the internal driving
system, especially from an energy perspective, and highlight the differences in the
internal driving systems between the two primary swimming modes.

Author summary
For undulatory swimming, fish form posteriorly traveling waves of body bending by
activating their muscles sequentially along the body. However, experimental
observations have showed that the muscle activation wave does not simply match the
bending wave. Researchers have previously computed the torque required for muscles
along the body based on classic hydrodynamic theories and explained the higher wave
speed of the muscle activation compared to the curvature wave. However, the origins
of other features of the muscle activation pattern and their variation among different

February 18, 2019

1/16

1
2
3
4
5
6
7

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

species are still obscure after decades of research. In this study, we use 3D
computational fluid dynamics models to compute the spatiotemporal distributions of
both the torque and power required for eel-like and mackerel-like swimming. By
examining both the torque and power patterns and considering the energy transfer,
storage, and release by tendons and body viscoelasticity, we can explain not only the
features and variations in the muscle activation patterns as observed from fish
experiments but also how tendons and body elasticity save energy. We provide a
mechanical picture in which the body shape, body movement, muscles, tendons, and
body elasticity of a mackerel (or similar) orchestrate to make swimming efficient.

Introduction

9
10
11
12
13
14
15
16

17

In the undulatory swimming of fish, a backward-traveling wave of body bending is
formed to push against the water and generate propulsion. Muscle is the executor of
the neural control and the source of mechanical power in fish swimming. Therefore,
how muscles are used is a key question in understanding the control and mechanics of
fish swimming and has been under multidisciplinary research over the past decades.
Experimentally, muscle activation during swimming is measured using
electromyography (EMG) for various fish species [1–5](Fig 1). During steady
swimming, a common pattern emerges: the muscle elements are activated in the
manner of a wave traveling posteriorly, but this EMG wave travels faster than the
curvature wave [6]. As such, the phase difference between the curvature and EMG
varies along the body, known as “neuromechanical phase lags”. Nonetheless, details of
the muscle activation pattern vary among species. For anguilliform swimmers such as
an eel, the speed difference is not large, and the duration of the muscle activation on
one side of the body is approximately half of the undulation period [3]. For
carangiform swimmers such as a carp, the propagation speed of the EMG onset is
much higher than that of the curvature wave, whereas that of EMG termination is
even higher, resulting in decrease of duration towards the tail [4]. The EMG activity,
together with muscle contraction kinetics, the strain and the volume of the active
muscle, can determine the absolute muscle power output along the body. With this
approach, Rome et al. [5] showed that for scup, the power is generated mostly by the
posterior part of the body.
To understand the muscle activation patterns and underlying mechanical principles
of internal driving, researchers previously studied the internal torque and the
corresponding power required. The sign of the torque has been used to predict which
side of the muscle should be activated. Using theoretical models, namely resistive
force theory [7], elongated body theory [8], and 3D waving plate theory [9, 10],
previous studies obtained torque waves that travel faster than the curvature waves and
qualitatively explained the neuromechanical phase lag. However, since positive and
negative torques both occupy half of the period all along the body, the decrease of the
EMG duration in carangiform swimmers remains an obscure phenomenon.
Another approach used to understand the internal driving in the coupled system is
to use neural control signals as an input and observe the kinematics emerging from the
coupling of internal driving, the body, and the external fluid. Using resistive force
theory and 2D computational fluid dynamics (CFD) with a prescribed uniform muscle
activation, McMillen et al. [11] and Tytell et al. [12] studied lamprey-like swimmers
and showed that the same muscle forces can generate body bending with different
wavelengths, corresponding to varying magnitudes of the neuromechanical phase lags,
depending on passive body properties such as stiffness. However, since the kinematics
emerge from the coupling of many components, this kind of approach may generate
kinematics that do not match the experimental observations; therefore, the approach

February 18, 2019

8

2/16

18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

1
L
T

0
0

L

1

0

L

1

0

L

1

0

L

1

0

1

L

Fig 1. Electromyography patterns for fish species with different body forms and
kinematics for steady swimming. The red vertical lines indicate the duration of EMGs
of the muscle on the left-hand side at that position on the body (the EMGs of lamprey
and saithe are dashed). The yellow and blue stripes indicate the durations when the
local curvature is increasing and decreasing, respectively. The red dotted lines on the
right side of the figure indicate the duration when the tail is moving from rightmost to
leftmost. Adapted from [6] with permission from the Journal of Experimental Biology.
may create difficulties in systematically studying the features the muscle activation
and in explaining the differences in the muscle activation between species.
These previous modeling studies were all based on either theoretical models with
strong assumptions or 2D CFD models, which cannot capture 3D flow around the top
and bottom of the fish body and the jet left behind and 3D shapes for carangiform
swimmers [13]. Therefore, while qualitative explanations from the models are
reasonable, the errors in these predictions are hard to estimate.

58
59
60
61
62
63
64

Fig 2. Flow fields in the middle coronal (z = 0) planes of eel (A) and mackerel (B)
models in the laboratory frame. The arrows represent the velocity direction and the
colors represent the magnitude of the velocity. Only flow speeds greater than 0.02 in
nondimensionalized units are shown.
To study the features of muscle activations among different species and reveal the
underlying mechanical principles, here we use 3D CFD simulations to investigate the
torque patterns and power output patterns for a typical anguilliform swimmer and a
typical carangiform swimmer. Combining the simulation results with experimental
observations, we aim to explain the features and their variations in the EMG patterns
among fish with different swimming modes.

February 18, 2019

3/16

65
66
67
68
69
70

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

Model and Numerical Methods

71

Treating water as an incompressible viscous fluid and the fish as moving bodies with
prescribed deformations, we developed numerical 3D models of an eel and a mackerel
(see Fig 2).

Body shape and kinematics

73
74

75

The carangiform body is modeled based on the actual anatomy of a mackerel, whereas
the anguilliform body is created from a lamprey computed tomography (CT) scan
(see [14] for details). Except for the caudal fin, other fins are neglected for the
swimmers. The lengths of the fish bodies (L) are used as the unit length in the
simulations. The bodies are meshed with triangular elements, and some sharp and
small structures from the scan are removed to avoid an instability of the CFD
computation. After obtaining the surface data of the two fishes, we reshaped the fishes
and re-meshed the surface grid so that our code could accommodate the boundary
between the fish and the fluid. The sharp and thin tail of the mackerel was modeled as
a zero-thickness membranous structure. The number of surface mesh points was 3962
for the eel and 2127 for the mackerel (including 1962 for the mackerel’s body and 165
for the tail). See S1 Fig for mesh details. The body mass (M ) was computed by
assuming a uniform distribution of density equal to the fluid density and was 1 in
nondimensional units. M = 0.0019 for the eel and M = 0.0101 for the mackerel.
The kinematics for undulatory locomotion are generally in the form of a posteriorly
traveling wave with the largest wave amplitude at the tail. To describe the
deformation of the fish bodies, centerline curvatures κ are prescribed in the form of
κ(s, t) = A(s) sin(ks − ωu t), where s is the arc length measured along the fish axis
from the tip of the fish head, A(s) is the amplitude envelope of curvature as a function
of s, k is the wavenumber of the body undulations that corresponds to wavelength λ,
and ωu is angular frequency. We use the undulation period as the unit of time, so
ωu = 2π. The amplitude envelope A(s) for the anguilliform kinematics has the form
A(s) = amax es−1 , where amax is the tail-beat amplitude. For carangiform kinematics,
the amplitude envelope has the form A(s) = a0 + a1 s + a2 s2 . The parameters for A(s)
were adjusted to fit the envelope of the movement of real fish observed in
experiments [8, 15]. The parameters used were amax = 11.41, and k = 2π/0.59 for the
anguilliform swimmer and a0 = 1, a1 = −3.2, a2 = 5.6, and k = 2π/1.0 for the
carangiform swimmer. To avoid generating spurious forces and torques in the
interaction between the fish bodies and fluid, we added rotation and translation in the
body frame of the swimmers to ensure that the movement of the bodies without
external forces satisfied two conservation laws: linear momentum conservation and
angular momentum conservation (see S1 Appendix for details). The resulted
kinematics are shown in S2 Fig.

CFD and the fluid-structure interaction

76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108

109

The in-house immersed boundary method code used is capable of simulating 3D
incompressible, unsteady, and viscous flows in a domain with complex embedded
objects including zero-thickness membranes and general 3D bodies [16, 17]. The flow is
computed on a nonuniform Cartesian grid in x′ y ′ z ′ coordinates. The fluid domain has
a size of 8.5 × 5 × 5, and a total of 620 × 400 × 400 ≈ 99 million points are used. The
grid is locally refined near the body with the finest spacing at 0.005 × 0.005 × 0.005.
The fish models are placed in the center of the computation domain, and the body
centerlines are in the z ′ = 0 plane. A homogeneous Neumann boundary condition is
used for the pressure at all boundaries. The flow speed of the inlet flow and outlet

February 18, 2019

72

4/16

110
111
112
113
114
115
116
117
118

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

flow at the front and back boundaries are set as the swimming speed of the trial runs
so that the model swimmers move only minimally in the computational domain. A
zero-gradient boundary condition is used at all other boundaries.
We considered the fluid-structure interaction in the plane of undulation. Because
the body of the swimmers is deforming, the governing equation for the angular degree
of freedom is d(Iω)/dt = Ttot , where I is the moment of inertia, ω is the angular speed
of the body, and Ttot is the total torque from hydrodynamic forces. Since the
deformation is prescribed, I and I˙ are known. Therefore, ω can be obtained by
˙
numerically integrating ω̇ = (Ttot − Iω)/I
while integrating other equations for the
translational movement of the body and the flow of the fluid. The time interval for the
integration is 5 × 10−4 .
We set an initial swimming speed of 0.3 at the beginning of the simulation and
waited two full cycles for the swimmer to reach steady swimming. All the data
presented are collected from the third and fourth cycles. Since the swimming direction
is not perfectly aligned with the x′ -axis of the computation grid, a new coordinate
system is used so that the swimming direction is aligned with -x, y is the lateral
direction, and the z-axis is the vertical direction. Vertical motion is neglected, but the
force magnitude in the z direction is only 9.3 × 10−6 for the eel and 9.3 × 10−5 for the
mackerel, which are less than 3% of the force magnitude in the forward direction. The
Reynolds number is defined as Re = U L/νk , where U is the swimming speed, and
νk = 1/15000 is the kinematic viscosity.

Force, torque, and power in the simulation

120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139

140

The force, internal torque, and power distributions along the fish body as a function of
time are computed from the simulation. The force per unit length on the fish body, F,
is calculated as follows: Take an arc length ∆s along the body centerline, and
integrate all forces from every mesh point in ∆s; then, divide the total force by the arc
length ∆s.
Considering the hydrodynamic forces, we compute the internal torque required to
overcome the hydrodynamic forces and body inertia. The body elasticity and the other
internal resistive forces are initially ignored and will be be discussed later. The torque
can be computed by integrating ∫the contributions from either side of∫ the body from the
1
s
point of interest: Tp (s, t) = −ez s r × (F − mb a)dl or Ta (s, t) = ez 0 r × (F − mb a)dl,
where mb is the body mass per unit length, and a = v̇ is the acceleration of the body
segment. To minimize the numerical error, we use a weighted average of the torques
computed from both sides, namely T = sTp + (1 − s)Ta .
The internal power by the torque and the power transferred to the fluid per unit
length are computed as PT (s, t) = T κ̇ and PF (s, t) = −F · v, respectively, where κ̇ is
the time derivative of curvature, and v is the velocity of the body segment. The
difference between the total power computed by integrating the internal power or the
external power along the body is within the numerical error (< 5%).

141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158

Results and Discussion

159

Body movement and fluid flow

160

The free swimming speeds (U ) are 0.29 and 0.25 in nondimensionalized units for the
eel and the mackerel, respectively. The corresponding Strouhal numbers are 0.63 and
0.68. These values are consistent with previous numerical studies at similar Reynolds
numbers (Re ≈4000) (e.g., [14]). For both fishes, double row vortices are shed behind
the tail, similar to previous numerical results (see Fig 2). The velocity field behind the

February 18, 2019

119

5/16

161
162
163
164
165

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

mackerel clearly shows a backward flow, while a mean flow behind the eel in the
fore-aft direction is not easily detected.
-3
4 10 2

Eel

2

0

Head<-Position->Tail

1

-4

Time

Time

B

1

00

167

-3
5 10

Mackerel

A

166

0

1

0

0

Head<-Position->Tail

1

-5

Fig 3. Spatiotemporal distribution of the fore-aft force (Fx ) on the eel (A) and the
mackerel (B) for two periods. Negative values indicate thrust, as the swimming
direction is in the -x direction.

Force

168

As expected from the input kinematics and body shapes, the forces are relatively
uniformly distributed on the eel but concentrated on the tail of the mackerel (Fig 3,
Fig 4A & C, S1 Video, and S2 Video). The fore-aft and lateral forces both show
posteriorly traveling wave patterns similar to those of body bending, except at the
head where the surface orientation rapidly changes. For the eel, the peaks in the force
components near 0.7 body length correspond to an increase in the body height (in z
direction) at that position. For the mackerel, the separation of the thrust and drag is
clear: the tail generates most of the thrust, and the anterior part of the body
generates drag at all times.
Because the phase of the force, especially the lateral force, is essential in
determining the phase of the torque [18], we compare the phases of the lateral forces
from the simulation with those of the velocity and the acceleration of the segments.
Roughly speaking, if the lateral force from the fluid on a segment is in phase with the
negation of the segment velocity, it is a resistive-like force, and if the lateral force is in
phase with the negation of the acceleration of the segment, it is a reactive-like force.
We find that the phase of the observed lateral force on the body is closer to the phase
of the negation of the acceleration except near the snout tips and the tail for the
mackerel. In these regions, the phase of the lateral force is close to the negation of the
velocity. Roughly speaking, the forces on the fish are close to the predicted forces from
elongated body theory, but there are discrepancies when the shape changes are rapid.
Detailed discussions of the hydrodynamics underlying the force pattern are beyond the
scope of this paper.

Torque

170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190

191

The torque required to overcome the hydrodynamic forces and body inertia in both
species exhibits a traveling wave pattern moving posteriorly with a higher speed than
the curvature wave (Fig 5). For the eel, the average speed of the torque wave (vT ) is
1.43 in the nondimensionalized unit (body length/period), 2.4 times that of the
curvature wave (vκ = 0.59). The traveling wave speed of the torque is even higher in
the mackerel (vT = 2.23), exhibiting a nearly standing wave pattern. The torque wave
speeds qualitatively match the observation that the EMG speed is much higher in

February 18, 2019

169

6/16

192
193
194
195
196
197
198

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

Phase

Fy 10-3 -2
5
-

A

Time

Eel

2

0

0
2

-5
Fy
0.02

C

1

0

0
0
0.5
1
Head<-Position->Tail

-v
-a
CFD

0

2
-2

D

-

Phase

Mackerel
Time

1

B

-v
-a
CFD

0

-0.02 2
0
0.5
1
Head<-Position->Tail

Fig 4. Lateral force (Fy ). Left column: Spatiotemporal distribution of the lateral
force on the body for two periods from the simulation. The dashed black line indicates
a zero-crossing (phase) of the force. Right column: Comparison of the phase of the
lateral force along the body from CFD (solid black line, the same as the dashed lines
in A and C) with the phase of the negation of the velocity and the phase of the
negation of the acceleration. A 2π term is added or subtracted to ensure continuity.

Eel

2.0

-4
10
2
2.0

A

-4
10
4

B
1.5

1.0

M

0.5

M

κ
ax
κ
in

0

Time

1.5
Tim e

Mackerel

1.0

xκ
Ma

0.5

Min

0

κ

-4
0
-2
0
0.5
1
0.5
1
Head<-Position->Tail
Head<-Position->Tail
Fig 5. Spatiotemporal distribution of the torque on the body in two periods for the
eel (A) and mackerel (B). The solid and dashed lines indicate the maximum and
minimum curvatures, respectively. The same information is illustrated by S3 Video
and S4 Video.
0

0

February 18, 2019

7/16

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

carangiform swimmers (Fig 1). The maximal value of the torque appears at
approximately the middle of the body of the eel and slightly posterior to the middle
point for the mackerel.

Power

200
201

202

As shown in Fig 6, the power from the torque is mostly positive, indicating the energy
output from the muscle, but negative values are observed on the posterior parts of
both fish. For the eel, the power is nearly all negative for s > 0.6, similar to the case
with a floppy body in a previous 2D study [12], while for the mackerel, the negative
power is intermittent on the posterior part. The work over a cycle calculated by
simply integrating the power is the minimal work needed, since the dissipation due to
the internal resistance is not included; this method implies that the negative power
transferred to the body is fully stored and recovered. The peak of this work per cycle
is at the anterior part (≈0.4) for the eel and at a more posterior position for the
mackerel (≈0.65), slightly posterior to the peak magnitude of the torque. We find that
the work over a cycle is significantly negative on the posterior half of the eel body and
slightly negative near the tail of the mackerel. If we assume that no energy-storing
and transmitting elements exist, the work done by the muscles is the integration of
only the positive power. We denote this quantity by W + . The differences between the
two kinds of work per cycle are the greatest for the posterior part of the eel, indicating
that power is lost if no spatial energy transfer is performed inside the eel body. The
distribution of power transferred to the fluid from the body is relatively uniform on
the eel but concentrated on the tail of the mackerel (cyan dashed lines in Fig6B & D).
The mean total power Ptot averaged over a cycle is 2.0 × 10−4 (in
nondimensionalized units) for the eel and 2.5 × 10−4 for the mackerel. If only the
+
+
positive power is used, the power becomes Ptot
= 8.7 × 10−4 and Ptot
= 3.3 × 10−4 ,
for the eel and the mackerel, respectively. The significant differences between Ptot and
+
Ptot
indicate the great potential to improve energetic efficiency by the spatiotemporal
transfer of energy.

Understanding the torque and power patterns

203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226

227

The torque pattern can be understood by applying the results obtained in a previous
study [18]: The torque pattern in undulatory locomotion is determined mainly by the
wavelength and phase of the lateral force relative to the lateral movement. The torque
wave of the eel has a relatively low wave speed relative to that in the case of the
mackerel due to the short wavelength of the undulation. Since the phase of the force
for the eel is overall close to the phase of the reactive force, the internal torque and
power patterns are also similar to the patterns associated with pure reactive forces
(Fig 7, left column). For the mackerel, the long wavelength of the curvature wave and
the concentrated force on the tail result in nearly synchronized torques on the body.
Because the force from the tail to the fluid is nearly in phase with the velocity, the
rate of change of curvature (κ̇) and the torque are also nearly in phase. As such, the
torque and power patterns are similar to the patterns associated with pure resistive
forces (Fig 7, right column), and the internal power is nearly all positive.

Body viscoelasticity explains the wave speed variation of EMG
Previous bending tests and experiences in the handling of fish indicate that the torque
from the viscoelasticity of an eel body is significant but smaller than the torque
generated by muscles [19]. For carangiform swimmers, since no muscles exist behind
the peduncle region and the curvature is comparable (albeit greater) with the rest of

February 18, 2019

199

8/16

228
229
230
231
232
233
234
235
236
237
238
239
240

241

242
243
244
245

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

6

2
A

Eel

+
W

B

0.4

W
+
Welast
Wfluid

0.2
work

Time

-3
10

0

1

0

-0.2
0.5

0

2

1

-6 -0.4
2

C

0

10-3
0.4 D

0.5

1

+
W
W

0.3
0

1
e=0

work

Mackerel
Time

0

+
Welast
Wfluid

0.2
0.1

Torqu

0
1

-2

0

0
0.5
1
0.5
Head<-Position->Tail
Head<-Position->Tail
Fig 6. Internal power (PT (s, t)) distribution for the eel (A) and the mackerel (C) and
the work done over a cycle by muscles along the body of the eel (B) and the mackerel
(D). The dashed line in (C) indicates the zero-crossing of the torque in the mackerel
(Fig 5B). The two black dots in (C) indicate an example time instant when two points
on the body have the opposite sign of power but the same sign of torque. The solid
blue lines in (B & D) represent the work by integrating only the positive values in
(A & C), and the dashed-dotted red lines represent the work (W ) by integrating both
positive and negative values. The dotted green lines represent the positive work W +
when body elasticity is considered (Fig 8B & D). The cyan dashed lines represent the
work done to the fluid by the integration of PF (s, t).
0

February 18, 2019

9/16

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

2.0 A

1

C

T(s,t)

1.5

0

1.0

xκ
Ma

0.5

Min

xκ
Ma

κ

Min

-1

κ

0
2.0

B

W(s)

1.5
P(s,t)

1

D

W(s)

0

1.0

-1

0.5
0
0

0.2
0.4
0.6
0.8
Tail <-- Position --> Head

1 0

0.2
0.4
0.6
0.8
Tail <-- Position --> Head

1

Fig 7. Spatiotemporal distributions of the torque (T ) and power (P ) along the body
when pure resistive forces (left column) or pure reactive forces (right column) are
considered. All values are normalized to the respective maximum values in each
subfigure. The solid and dashed lines indicate the maximum and minimum
curvatures,
∫1
respectively. The insets are the distribution of the work (W (s) = 0 P (s, t)dt) done by
the internal torque. The gray lines in the insets indicate 0 to guide the eye. In the
calculation, the body is uniform, the undulation amplitude is uniform and
infinitesimal, and the wavelength is the same as the body length. See S2 Appendix for
details of the derivation.

February 18, 2019

10/16

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

-4
10
1.5 2

Torque
2

-3
10
6

Power
B

Time

Eel

A

0

1

0

0

0.5

1

Time

Mackerel

2

1

-1.5 0

0

0

-4
10
3 2

0

1

0

1

-6
-3
10
2

D

C

0

0.5

0.5
Head<-Position->Tail

1

1

-3 0

0

0

0.5

1

-2

Head<-Position->Tail

Fig 8. Torque (left column) and power (right column) distributions when the
elasticity of the body is considered for the eel (top row) and the mackerel (bottom
row). The dashed lines indicate zero-crossings of the torque.
the body, the torque from elasticity must be significant at least in the tail region.
However, an accurate in vivo measurement of the body viscoelasticity distribution is
not available. Therefore, here we discuss the trend of the influences of the viscosity
and elasticity individually when the elasticity or viscosity is small relative to the
torque from hydrodynamics and the body inertia (Fig 8).
We assume that the magnitude of the torque from the body elasticity or viscosity
is 20% of the torque at individual positions along the body, namely
Te = 0.2⟨T ⟩κ(s, t)/⟨κ⟩ or Tv = 0.2⟨T ⟩κ̇(s, t)/⟨κ̇⟩, where “⟨⟩” means standard deviation
over time. As shown in Fig 8, we find that the effect of elasticity on the torque is
different along the body, separated by a position (s ≈ 0.5 for the mackerel and s ≈ 0.2
for the eel) where T and κ̇ are in phase and the power is all positive. Anterior to that
point, the torque magnitudes increase, and the torque wave speeds decrease; posterior
to that point, the torque magnitude decreases, and the speed of the torque wave
increases. For the mackerel, the torque wave can even reverse when the phase shift
effect of the elasticity is strong. The reversal of the wave resembles the reversal of the
wave of the offset of the EMG observed for carangiform swimmers (Fig 1). As a result
of the changes in the torque, the area of the negative power region in the posterior
part of the body decreases, and W + decreases (Fig 6D). This observation is consistent
with the findings of previous studies that suitable elasticity can save and restore
energy to improve efficiency (e.g., [20]). For the eel, the effect of the speed increase
ends near s = 0.7 when the maximal curvature coincides with the minimal torque
without elasticity. Therefore, the energy storing and releasing for the eel is in the
middle part of the body (Fig 6B). Since the body viscoelasticity of the eel is weak and
this effect is subtle, changes in the wave speed of the middle part of the torque wave
or EMG are not obvious.

February 18, 2019

11/16

246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

Torque

2

2

-4
10
2

-3
10
6

Power
B

0

0

0.5

1

Time

Mackerel

2

Time

0

1

1

-2 0

0

0

C

0

0

1

-6
-3
10
2

D

1

0

0.5

-4
10
4 2

0.5
Head<-Position->Tail

1

Time

Time

Eel

A

1

-4 0

0

0

0.5

1

-2

Head<-Position->Tail

Fig 9. Torque (left column) and power (right column) distributions when the viscosity
of the body is considered for the eel (top row) and the mackerel (bottom row). The
solid and dashed lines indicate the maximum and minimum curvatures, respectively.
Since the body viscosity requires a torque in phase with the time derivative of the
curvature, for both the eel and mackerel the resulted torques become more aligned
with the time derivative of the curvature and hence have wave speeds closer to the
speed of curvature (vT /vκ = 2.2 for the eel and vT /vκ = 1.8 for the mackerel).
Consequently, the negative power regions are reduced since the viscosity of the body
always dissipates energy.

Tendon connection explains the duration decrease of EMG

272
273
274
275
276

277

While local elasticity can transfer energy temporally, the spatial transmission of
energy can only be achieved by other structures. In animals, coupled joint articulation
by tendons over two or more joints is common and is an effective structure to save and
transfer energy [21]. For carangiform swimmers, long tendons exist that span over
many vertebra [22]. We hypothesize that these long tendons are used to transfer
energy from the posterior part to the middle part of the body when the negative
power appears on the posterior part (Fig 6). This hypothesis can explain the observed
decrease in the muscle activation duration among the carangiform swimmers,
including some detailed features: the increase in the duration of the negative power
from the middle of the body towards the tail matches the decrease in the EMG
duration. The start of the positive power is aligned with the sign change of κ̇ (the
lines in Fig 5B), resulting in a low speed that is the same as that of the curvature
wave. The end of the positive power is aligned with the sign change in the torque (the
dashed lines in Fig 6B), resulting in a high speed that is the same as that of the
torque wave. Such differences in wave speed qualitatively match the speed differences
of the onset and offset of the EMG. Note that this hypothesis does not contradict the

February 18, 2019

271

12/16

278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

common view that force and energy are transmitted to the tail to interact with the
fluid. Actually, the torque is still required when the power is negative on the posterior
region and can be provided by the muscle in a more anterior position connected by the
tendon. This hypothesis is also consistent with the observation that the EMG
duration is nearly half of the undulation period on the whole body of anguilliform
swimmers, which do not possess long tendons [22].

Error associated with Re

Conclusion

296
297
298
299

301
302
303
304
305
306
307
308
309

310

Using 3D numerical models, we provide so far the most accurate prediction of the
torque and power required for hydrodynamic forces during the undulatory swimming
of fish. By considering the torque and power transfer by tendons and the body
viscoelasticity, we for the first time give explanations for some long-standing questions
in muscle activation patterns. Our study offers an integrative view of the function of
the muscles as part of the mechanical system, highlights the differences in the internal
driving of two primary swimming modes, and provides insights on the energy transfer
and saving mechanisms of fish swimming. The numerical models developed and the
mechanisms revealed in this study may guide the design of efficient bio-inspired robots,
especially soft robots with distributed driving systems and elastic bodies [24, 25].

Supporting information

311
312
313
314
315
316
317
318
319
320

321

S1 Appendix. Description of the method to satisfy momentum
conservations and obtain kinematics in the body frames.

322
323

S2 Appendix. Derivation of the torque and power from pure resistive
forces and reactive forces.
Mesh used in the simulation. (A) Eel. (B) Mackerel.

324
325

326

S2 Fig The kinematics of the swimmers in their own body frames (free
movement in the vacuum) (A) Eel. (B) Mackerel.
S1 Video. The force distribution along the body of the eel. The black line
represents the midline of the fish and the red arrows represent the hydrodynamic
forces. The head is on the left and the tail is on the right.

February 18, 2019

295

300

The low swimming speeds we observed (compared with those of real animals) are
likely due to the low Re used in our simulations. However, we argue that the results
are qualitatively representative for real adult fish. First, a meta-analysis of previously
reported fish swimming data indicates that the transition from the viscous regime to
the turbulent regime occurs at a Re of several thousand [23]. Second, even the eel
model in our study shows an inertia-dominated mode of swimming. Since the drag
coefficient decreases with increasing Re in general, the speed of the simulated
swimmer is expected to increase with increasing Re, and the contribution of the
resistive force is expected to decrease for a real adult eel.

S1 Fig

294

13/16

327
328

329
330
331

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

S2 Video. The force distribution along the body of the mackerel. The
black line represents the midline of the fish and the red arrows represent the
hydrodynamic forces. The head is on the left and the tail is on the right.
S3 Video. The torque distribution along the body of the eel. The
magnitude of the torque in the z direction is represented by the color.

333
334

335
336

S4 Video. The torque distribution along the body of the mackerel. The
magnitude of the torque in the z direction is represented by the color.

Acknowledgments

337
338

339

This work was supported by the National Natural Science Foundation of China grant
No. 11672029 and NSAF-NSFC grant No. U1530401 (both to T.Y.M., B.W.J., J.L.S.
and Y.D.). We thank Prof. Fotis Sotiropoulos and Prof. Iman Borazjani for sharing
the shape data of the fish.

References
1. Williams L, Grillner S, Smoljaninov VV, Allen PW, Kashin S, Rossignol S.
Locomotion in lamprey and trout: the relative timing of activation and
movement. Journal of Experimental Biology. 1989;143:559–566.
2. Wardle CS, Videler JJ. The timing of the electromyogram in the lateral
myotomes of mackerel and saithe at different swimming speeds. Journal of Fish
Biology. 1993;42(3):347–359.
3. Gillis GB. Neuromuscular control of anguilliform locomotion: patterns of red
and white muscle activity during swimming in the American eel Anguilla
rostrata. Journal of Experimental Biology. 1998;201:3245–3256.
4. Leeuwen Jv, Lankheet M, Akster H, Osse J. Function of red axial muscles of
carp (Cyprinus carpio): recruitment and normalized power output during
swimming in different modes. Journal of Zoology. 1990;220(1):123–145.
5. Rome LC, Swank D, Corda D. How fish power swimming. Science.
1993;261(5119):340–343.
6. Wardle C, Videler J, Altringham J. Tuning in to fish swimming waves: body
form, swimming mode and muscle function. Journal of Experimental Biology.
1995;198(8):1629–1636.
7. Chen J, Friesen W, Iwasaki T. Mechanisms underlying rhythmic locomotion:
body–fluid interaction in undulatory swimming. Journal of Experimental
Biology. 2011;214(4):561–574.
8. Hess F, Videler JJ. Fast continuous swimming of saithe (Pollachius virens): a
dynamic analysis of bending moments and muscle power. Journal of
Experimental Biology. 1984;109(1):229–251.
9. Cheng JY, Blickhan R. Bending moment distribution along swimming fish.
Journal of Theoretical Biology. 1994;168(3):337–348.

February 18, 2019

332

14/16

340
341
342
343

bioRxiv preprint doi: https://doi.org/10.1101/556126; this version posted February 20, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY 4.0 International license.

10. Cheng JY, Pedley T, Altringham J. A continuous dynamic beam model for
swimming fish. Philosophical Transactions of the Royal Society of London
Series B: Biological Sciences. 1998;353(1371):981–997.
11. McMillen T, Williams T, Holmes P. Nonlinear muscles, passive viscoelasticity
and body taper conspire to create neuromechanical phase lags in anguilliform
swimmers. PLoS Computational Biology. 2008;4(8):e1000157.
12. Tytell ED, Hsu CY, Williams TL, Cohen AH, Fauci LJ. Interactions between
internal forces, body stiffness, and fluid environment in a neuromechanical
model of lamprey swimming. Proceedings of the National Academy of Sciences.
2010;107(46):19832–19837.
13. Wolfgang M, Anderson J, Grosenbaugh M, Yue D, Triantafyllou M. Near-body
flow dynamics in swimming fish. Journal of Experimental Biology.
1999;202(17):2303.
14. Borazjani I, Sotiropoulos F. On the role of form and kinematics on the
hydrodynamics of self-propelled body/caudal fin swimming. Journal of
Experimental Biology. 2010;213(1):89–107.
15. Tytell ED, Lauder GV. The hydrodynamics of eel swimming. I. Wake structure.
Journal of Experimental Biology. 2004;207(11):1825–1841.
16. Song J, Luo H, Hedrick TL. Three-dimensional flow and lift characteristics of a
hovering ruby-throated hummingbird. Journal of The Royal Society Interface.
2014;11(98):20140541.
17. Luo H, Dai H, de Sousa PJF, Yin B. On the numerical oscillation of the
direct-forcing immersed-boundary method for moving boundaries. Computers &
Fluids. 2012;56:61–76.
18. Ming T, Ding Y. Transition and formation of the torque pattern of undulatory
locomotion in resistive force dominated media. Bioinspiration & biomimetics.
2018;13(4):046001.
19. Long Jr JH. Muscles, elastic energy, and the dynamics of body stiffness in
swimming eels. American zoologist. 1998;38(4):771–792.
20. Alben S, Witt C, Baker TV, Anderson E, Lauder GV. Dynamics of freely
swimming flexible foils. Physics of Fluids. 2012;24(5):051901.
21. Junius K, Moltedo M, Cherelle P, Rodriguez-Guerrero C, Vanderborght B,
Lefeber D. Biarticular elements as a contributor to energy efficiency:
biomechanical review and application in bio-inspired robotics. Bioinspiration &
biomimetics. 2017;12(6):061001.
22. Shadwick RE, Gemballa S. Structure, kinematics, and muscle dynamics in
undulatory swimming. Fish physiology. 2005;23:241–280.
23. Weerden JF, Reid DA, Hemelrijk CK. A meta-analysis of steady undulatory
swimming. Fish and Fisheries. 2014;15(3):397–409.
24. Zhu L, Cao Y, Liu Y, Yang Z, Chen X. Architectures of soft robotic locomotion
enabled by simple mechanical principles. Soft matter. 2017;13(25):4441–4456.
25. Shintake J, Cacucciolo V, Shea H, Floreano D. Soft biomimetic fish robot made
of dielectric elastomer actuators. Soft robotics. 2018;5(4):466–474.

February 18, 2019

15/16

