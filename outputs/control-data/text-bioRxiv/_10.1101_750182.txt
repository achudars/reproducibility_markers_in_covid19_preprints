bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

RBA for eukaryotic cells: foundations and theoretical
developments
Anne Goelzer, Vincent Fromion
INRA, UR1404, MaIAGE, Université Paris-Saclay, Jouy-en-Josas, France.
firstname.name@inra.fr

Abstract
Resource allocation models were recently identified as new ways to investigate cell design principles. In particular, the Resource Balance Analysis (RBA) framework is the
first constraint-based modelling method capable of accurate quantitative predictions of the
genome-wide resource allocation. Initially developed and validated on bacteria, the objective of this paper is to provide the mathematical fundations of the extension of the RBA
framework to eukaryotic cells. We especially investigate the way to handle the cellular
compartments in order to formalize eventually the functioning of organelles. It turns out
that the final RBA problem for eukaryotic cells is close to the one of prokaryotic cells from
a theoretical point of view. The mathematical properties that were already identified on
the prokaryotic RBA framework can be easily transposed to eukaryotic cells. In particular,
the eukaryotic RBA problem can be solved easily at the cell scale by Linear Programming.
This paves the way to future developments of RBA models for eukaryotic cells.

1

Introduction

Recently, bacterial whole-cell models based on concepts of parsimonious resource allocation between cellular processes were shown to predict accurately the growth rate and a high number of
cellular variables (i.e. metabolic fluxes, abundances of molecular machines including enzymes)
across exponential growth conditions [3, 7, 2]. Moreover, they were also shown to reproduce
complex genetic regulations without the explicit addition of gene regulations, thus reproducing
observed cellular configurations with simple cost-benefit arguments with respect to the use of
cellular resources [14]. Such types of models are so-called constraint-based models, and actually
formalize the mathematical relationships defining the interactions and allocation of resources
between the cellular processes as a set of equality and inequality convex constraints [5, 6]. Satisfying these constraints then led to a linear convex optimization problem. The underlying
problem is thus tractable and solvable rapidly even at genome scale in a few seconds [1, 10].
The first genome-scale constraint-based modeling method, named Resource Balance Analysis
(RBA) was developed in 2009-2011 [5, 6], where the first versions of the RBA model for the
bacterium Bacillus subtilis were already developed and simulated. The first (and still only) biological validation of a genome-scale model integrating resource allocation was achieved in 2015
for the RBA model of B. subtilis [7]. In parallel, since 2013, other constraint-based modelling
methods integrating some of the RBA constraints have been developed [11, 9], confirming that
resource allocation is a relevant cell design principle and also an intensive research area within
the systems biology community (see [4] and references therein). Currently, the resource allocation framework was used to generate resource allocation models for prokaryotes. There exists
published resource allocation based models for the bacterium B. subtilis [5, 6, 7, 2], Escherichia
coli [11, 9, 2] and the cyanobacteria Synechococcus elongatus PCC 7942 [12]. Extending the

1

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

resource allocation framework to eukaryotic cells is now the next step to achieve.
In this document we study the extension of the RBA framework that was originally developed
in [5, 6] for bacteria, to eukaryotic cells. Here our purpose is not to develop and implement a
RBA model for eukaryotic cells, but to provide the mathematical foundations of the framework,
and especially:
• to handle the compartments on RBA constraints in a systematic way;
• to identify clearly the assumptions that are necessary to obtain a convex formulation of
the constraints;
• to derive the constraints, and in fine the RBA optimization problem for eukaryotic cells.
As we will show in the sequel, under mild assumptions, the existence of compartments does not
change the theoretical nature of the RBA problem, implying that the mathematical properties
presented in [5, 6] are thus valid in case of eukaryotic cells. In particular, this means that the
RBA optimization problem for eukaryotic cells can be efficiently solved at the genome scale.
The paper is organized as follows. We first recall in Section 2 the RBA framework for prokaryotes, especially to introduce the notations. Section 2.1 presents the original problem of [7]. In
Section 2.2, we extend the constraints to include the turnover rate of proteins and metabolites.
Then, we investigate in Section 3.1, 3.2, 3.3 and 3.4 the consequences of compartments on RBA
constraints. Finally, in Section 3.5, we present the RBA framework for eukaryotic cells.
∆ 
Notation. AT refers to the transpose of the matrix A. Rn>0 = x ∈ Rn |xi > 0 for all i ∈
∆

∆

∆

{1, · · · , n} , R>0 = R1>0 , Rn≥0 = {x ∈ Rn | xi ≥ 0 for all i ∈ {1, · · · , n}} and R≥0 = R1≥0 .

2

The RBA problem for prokaryotic cells: some recall

In this section, we first recall the RBA optimization problem for prokaryotes, introduce notations
and also the constraints. Most of the results are extracted from [5, 6].

2.1

The RBA standard formulation: some recalls

A cell is composed of different cellular entities:
(i) Ny molecular machines, that can be subdivided in Nm enzymes and transporters involved
∆

in the metabolic network (i.e. enzymes, transporters) E = (E1 , . . . , ENm ) at the concentra∆
∆
tions E = (E1 , . . . , ENm )T and with the fluxes ν = (ν1 , . . . , νNm )T ; and Np macromolecu∆

lar machines M = (M1 , . . . , MNp ) involved in non-metabolic cellular processes such as the
∆

translation apparatus, at the concentrations M = (M1 , . . . , MNp )T ;
∆

(ii) Ng proteins PG = {PG1 , . . . , PGNG } for which the cellular process to which the proteins
∆

belong is not specified. PG = (PG1 , . . . , PGNG )T denotes the set of concentrations of PG ;
∆

∆

(iii) Ns metabolites S = (S1 , . . . , SNs ) at the concentrations S = (S1 , . . . , SNs )T . Among
∆
the set S, we distinguish a subset B = (B1 , . . . , BNb ) of metabolites which have fixed
∆

concentrations B̄ = (B̄1 , . . . , B̄Nb )T .
Remarks.

2

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1. When a metabolic reaction can be catalyzed by two (respectively, n > 2) different enzymes,
corresponding to isoenzymes, the metabolic reaction is duplicated (respectively, n times
repeated), i.e., when a metabolic reaction r is catalyzed by E1 or E2 then we introduce
two reactions r1 and r2 that are catalyzed by E1 and E2 respectively.
2. When an enzymatic complex Ei can catalyze two (respectively, n > 2) distinct reactions,
we duplicate (respectively, repeat n times) the enzymatic complex: when the enzymatic
complex Ei catalyzes reactions r1 and r2 , then we introduce two enzymatic complexes Ei1
and Ei2 that catalyze r1 and r2 respectively. In this case, the translation process has to
produce both Ei1 and Ei2 .
p
The RBA optimization problem for prokaryotic cell (Prba
) can be formalized mathematically as
follows.
N
p
Prba
: For a fixed vector of concentrations PG ∈ R>0g , and the growth rate µ ≥ 0, i.e. the amount
of produced biomass per cell per hour,
m
Y ∈ Rm+p
≥0 , ν ∈ R ,

find
subject to
(C1 )

S
S
PG ) = 0
B̄ + CG
−Ων + µ(CYS Y + CB

(C2a )

M
µ(CYM Y + CG
PG ) − KT Y ≤ 0

(C2b )

−KE Y ≤ ν ≤ KE Y

(C3 )

D
CYD Y + CG
PG − D̄ ≤ 0

0

∆

where all the inequalities are componentwise inequalities, Y T = (E T , M T ) is the vector of concentrations of molecular machines and:
• Ω is the stoichiometry matrix of the metabolic network of size Ns × Nm , where Ωij corresponds to the stoichiometry of metabolite Si in the j-th enzymatic reaction;
S
) is a Ns ×Ny (resp. Ns ×Ng ) matrix where each coefficient CYSij corresponds
• CYS (resp. CG
to the number of metabolite Si consumed (or produced) for the synthesis of one machine
Yj (resp. PGj ); CYSij is then positive, negative or null if Si is produced, consumed or not
involved in the the synthesis of one machine Yj (resp. PGj );
S
S
• CB
is a Ns ×Nb matrix where each coefficient CB
corresponds to the number of metabolite
ij
Si consumed (or produced) for the synthesis of one Bj ;
0

• KT (KE and KE , respectively) of size Np ×Np (Nm ×Nm , respectively) is diagonal matrix
0
where each coefficient KTi (KEi and KEi , respectively) is positive and corresponds to the
efficiency of the molecular machine Mi , i.e. the rate of the process per amount of the
catalyzing molecular machine, (the efficiency of the enzyme Ei in forward and backward
sense, respectively);
M
• CYM (resp. CG
) is a Np × Ny (resp. Np × Ng ) matrix where each coefficient CYMij typically
corresponds to the length in amino acids of the machine Yj (resp. PGj ). In some cases
(for instance for the constraints on protein chaperoning), the length in amino acids can
be multiplied by a coefficient, such as the fraction of the whole proteome that necessitates
chaperoning;

• D̄ is a vector of size N c , where N c is the number of volume and surface areas for which
density contraints are considered. D̄i is the density of molecular entity with respect to
the volume or surface area. Densities are typically expressed as a number of amino-acid
residues by volume or surface area.
3

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

D
• CYD (resp. CG
) is a N c × Ny (resp. N c × NG ) matrix where each coefficient CYDij
corresponds to the density of one machine Yj (resp. PGj ) in the compartment i. By
construction, we have one unique localization per machine.

Actually, the RBA method formalizes the mathematical relationships defining the interactions
and allocation of resources between the cellular entities. All these relationships take the form of
linear growth-rate dependent equalities and inequalities, and form the convex feasibility problem
p
Prba
[5, 6]. For cells growing in exponential phase at a growth rate µ,
(I) the metabolic network has to produce all metabolic precursors necessary for biomass production (equalities C1 in the optimization problem);
(II) the capacity of all molecular machines must be sufficient to ensure their function, i.e. to
catalyze chemical conversions at a sufficient rate (inequalities C2b for the enzymes and
transporters, C2a for the molecular machines of macromolecular processes);
(III) the intracellular density of compartments and the occupancy of membranes are limited
(inequalities C3 );
(IV) mass conservation is satisfied for all molecule types (equalities C1 ).
Remarks.
1. In practice, the vector B̄ contains non-zero values only for the concentrations of macrocomponents such as DNA, cell wall, and lipid membranes, and for a few set of metabolites
(see supplementary data of [7]).
2. In order to model reversible enzymes, we have introduced two diagonal matrices of en0
, describing the constraints attached to each enzyme
zyme efficiencies, i.e. KE and KE
in both directions. Actually, when an enzyme is assumed irreversible, by convention, the
constraints associated to the backward direction is taken equal to 0.
3. In [6, 7], the RBA problem that was built for Bacillus subtilis integrates two macromolecular processes in constraint C2a , the translation and chaperoning of proteins, and two
density constraints, the limitation of the cytosolic density and of the membrane occupancy.
4. The RBA model can be refined by integrating for instance other molecular machines or
other types of constraints such as the transcription machinery, or the protein secretion
(see [7]) to cite very few.
To illustrate the facility to integrate new constraints, the following section presents how to
integrate the degradation of molecular entities into RBA.

2.2

Integration of biological macromolecular turnover into RBA

The objective here is to show how to integrate the degradation of any molecular entity such
as proteins, RNAs, metabolites or macromolecular machines into RBA. We restrict our developments to metabolites and proteins, other molecular entities can be handled in the same
way.
Metabolite turnover. Some bacterial macromolecular components such as the membrane or
some metabolites are damaged over time and need to be degraded and replaced. We then consider that a metabolite Sj is degraded at rate γSj > 0. Then, the dynamics of the concentration
Sj is given by
dSj (t)
= Ωj ν(t) − (µ + γSj )Sj (t),
dt
which leads in steady-state to deduce that for all the metabolites Bj in B, Ωj ν = (µ + γBj )B̄j .
4

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Protein turnover. Actually, few of the bacterium’s proteins are systematically degraded,
with the exception of a small number of proteins generally associated with regulatory or stress
mechanisms. The vast majority of proteins are stable and have an average half-life of several
hours (days). Eventually, the half-life of this set of stable proteins results from the fact that
they are damaged over time (by temperature or specific stresses) and are typically recognized
and degraded by dedicated proteases.
We then consider that a protein has a specific turnover rate γYj > 0. The dynamics of the
concentration of protein Yj is given by
dYj (t)
= λYj (t) − (µ + γYj )Yj (t),
dt
where the flux λYj (t) is the flux of protein (in number of molecules per unit of time and per
unit of volume) produced by the ribosome. In steady-state, we thus have: λYj = (µ + γYj )Yj .
Moreover, when the protein is degraded, amino-acids are released at a rate of γYj αkj Yj , where
αkj is the number of the k-th amino acid in one protein. ATP is also consumed by the protease,
0
0
at a rate of γYj αj Yj where αj is the number of ATP consumed by the protease to degrade the
protein.
Remark. For fast-growing bacteria such as E. coli or B. subtilis, the growth rate is usually
larger than the turnover rate of most of the proteins. Therefore, protein degradation can be
neglected without a significant impact on the predicted resource distribution by RBA.
Constraint on protease processes. In order to degrade proteins, the cell has to possess
enough proteases. That leads to introduce a constraint on the capability of the protease to
degrade proteins:
Ny
X
γYj Yj (t) ≤ kP P (t)
j

where P (t) corresponds to the concentration of proteases. This concentration is clearly a new
decision variable of the RBA problem. It is integrated in the vector Y since the protease is a
new molecular machine.
RBA problem for prokaryotes with protein and metabolite turnover. The set of
macromolecular machines M is now increased with the protease concentration (and Np is updated in accordance). The RBA problem is now given by : for a fixed vector of concentrations
N
PG ∈ R>0g , and the growth rate µ ≥ 0,
find
subject to
(C1 )

y
g
m
Y ∈ Rm+p
≥0 , ν ∈ R , ΛY ∈ R≥0 , ΛG ∈ R≥0
0

0

S
S
−Ων + CYS ΛY + CG
ΛG + CYS ΓY Y + CG
ΓG PG + · · ·
S
CB
(µ + ΓB )B̄ = 0
0

0

(C2a )

M
M
CYM ΛY + CG
ΛG + CYM ΓY Y + CG
ΓG PG − KT Y ≤ 0

(C2b )

−KE Y ≤ ν ≤ KE Y

(C3 )

D
CYD Y + CG
PG − D̄ ≤ 0

(C4a )

ΛY − (µ + ΓY )Y = 0

(C4b )

ΛG − (µ + ΓG )PG = 0

0

ΓY , ΓG are diagonal matrix of size Ny × Ny , Ng × Ng respectively, and where the coefficient
ΓYjj , ΓGjj correspond to the turnover rate of Yj and PGj respectively. ΓB is a Ns × Nb matrix
5

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

where ΓBkj is the turnover rate of Bj , and index k refers to the position of Bj in the set S.
0
0
S0
Moreover, CYS (resp. CG
) is a Ns × Ny (resp. Ns × Ng ) matrix where each coefficient CYSij
0

S
(resp. CG
) corresponds to the number of metabolite Si consumed (or produced) during the
ij
degradation of one machine Yj (resp. PGj ).
In addition to translation and chaperoning, C2a now contains the constraint on the capability of
0
M0
proteases to achieve protein degradation (terms CYM ΓY Y and CG
ΓG PG ), and thus the matrix
M
CYM and CG
have been updated appropriately.
Moreover, constraint C4a and C4b correspond to the steady-state regimen of the differential
equation of Yj (t) for all j ∈ (1 . . . Ny ) and on the concentration of the PG proteins.
∆

0

By substituting constraints (C4a ) and (C4b ) in the other ones, and by noting ΓSY = (CYS +CYS )ΓY ,
∆

0

∆

∆

0

∆

0

S
S
S
M
M
M
M
M
ΓSG = (CG
+ CG
)ΓG , ΓSB = CB
ΓB , ΓM
Y = (CY + CY )ΓY , and ΓG = (CG + CG )ΓG , the
previous optimization problem can further be aggregated as

Y ∈ Ry≥0 , ν ∈ Rm ,

find
subject to
(C1 )

S
S
B̄) + ΓSY Y + ΓSG PG + ΓSB B̄ = 0
PG + CB
−Ων + µ(CYS Y + CG

(C2a )

M
M
µ(CYM Y + CG
PG ) + Γ M
Y Y + ΓG PG − KT Y ≤ 0

(C2b )

−KE Y ≤ ν ≤ KE Y

(C3 )

D
CYD Y + CG
PG − D̄ ≤ 0

0

Remark. As in the case of protein degradation, machines that degrade cell macro-components
or metabolites can also be defined and integrated into the problem in the same way.

3

RBA for eukaryotes

Eukaryotic cells are obviously much more complex than prokaryotic cells, the precise control of
a large diversity of cellular processes are only partially known, even for well-established process
like transcription. From a RBA perspective, we have mainly to integrate systematically in the
RBA framework the presence of organelles and so to handle the fact that the metabolism, the
macromolecular processes, the molecular machines and the associated constraints are now localized in different cell compartments. Actually, we notice that in genome-scale metabolic models,
organelles are usually integrated only through the localization of metabolites. In the latest release of the yeast consensus model [8], the localization of some reactions is added in the reaction
name as an annotation. However, the biomass reaction typically integrates the composition of
the whole-cell, without distinguishing the composition of organelles. The allocation of resources
to the organelles is thus fixed and constant for any condition. Hereafter, the formulation will
bypass this assumption and the cell investment in the organelle is explicitly included in the
resource allocation problem.

3.1

Modeling organelles: first steps

We define a cell as a complex system where its cytoplasm contains organelles which are described
through the introduction of N com compartments, with N com ≥ 2 since we always assume that
the cell contains at least mitochondria (see Figure 3.1). It is furthermore necessary to add the
N int interfaces between the different compartments. At the time t, the i-th compartment has
a volume V i (t). It furthermore has interfaces with the other compartments, where each of its
interfaces has a given surface area denoted A∗↔i . V c (t) is the volume of the cytoplasm (or the

6

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 1: The eukaryotic cell with compartments. The cell is divided in N com compartments of volume V z for z ∈ {1, · · · , Ncom } and in N int interfaces of surface area Az for
z ∈ {0 ↔ i, · · · , j ↔ k}. The cell is also composed of a set of metabolites S and of molecular machines Y, that can be located in different compartments (e.g. the sets Sk and Yk for the
k-th compartment). On this figure, we considered two organelles. The first one of volume V i is
composed of a single membrane of surface area A0↔i . The second one is composed of two membranes (for instance an inner and an outer membrane) of surface area A0↔j and Aj↔k defining
an intermembranous space of volume V j and a matrix of volume V k . The second organelle is
thus composed of two compartments of volumes V j and V k associated to two interfaces of A0↔j
and Aj↔k respectively.

7

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

cell1 ) at time t and is defined by
c

∆

0

V (t) = V (t) +

com
NX

V i (t)

i=1
0

where V (t) corresponds to the volume at time t of the part of the cell volume not contained in
one of N com compartments, and classically called the cytosol.
Remarks.
1. In the sequel, the volume of the cytosol is the one which allows to define the concentration
of an entity present in this part of the cell.
2. To describe a mitochondrion, two compartments must be defined: the intermembrane
space and the matrix. A single interface is associated to the matrix and corresponds to
the inner mitochondrial membrane. The intermembrane space has two interfaces, one with
the matrix, already mentioned, and a second one with the cytosol corresponding to the
outer mitochondrial membrane.
In order to model the cell, we then introduce a catalog of entities (defined in detail later)
where it is assumed that each entity belongs to a specific compartment or/and to an interface
between two compartments. The abundance of each entity is assumed to be known in each
compartment and interface: nX i corresponds to the number of X in the i-th compartment and
∆
[X i ]i corresponds to its concentration in the i-th compartment, i.e., [X i ]i = nX i /V i . Finally,
[X i ]c defines the concentration of X in the i-th compartment with respect to the cell volume,
∆
i.e., [X i ]c = nX i /V c . The total concentration of X with respect to the cell volume is then given
by
com
NX
nX i
c ∆
[X] =
Vc
i=0
where nX 0 corresponds to the number of X in the cytosol.
For an interface between the i-th and j-th compartment, the number of X in this interface is
denoted by nX i↔j .
Modeling the creation of an entity X in the i-th compartement. We now consider
that the creation of X in the i-th compartment is described by this differential equation:
ṅX i (t) = aX i (t)

(1)

where aX i is then a quantity proportional to a rate, i.e., a number of molecules per unit of
time. The evolution of the concentration of this entity in its compartment is obtained after
straightforward computations and given by


d i i
d nX i (t)
a i (t)
= Xi
[X (t)] =
− µi [X i (t)]i
i
dt
dt V (t)
V (t)
∆
where µi (t) = V˙ i (t)/V i (t).

Following the same lines, it is possible to express the evolution of X in the i-th compartment
through the evolution of its concentration with respect to the cell volume:


d i c
d nX i (t)
a i (t)
[X (t)] =
= Xc
− µc (t)[X i (t)]c
c
dt
dt V (t)
V (t)
1 With

a slight abuse of denomination.

8

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

∆

∆

where µc = V˙ c (t)/V c (t). By introducing λX i (t) = aX i (t)/V c (t), corresponding to the rate
of production of X in the i-th compartment per unit of cell volume, the previous differential
equation is rewritten as
d i c
[X (t)] = λX i (t) − µc (t)[X i (t)]c .
(2)
dt
The density constraints attached to compartments and their interfaces. The density
constraints (i.e. constraints (C3 ) in the RBA problem of the previous section) are related to the
fact that biological entities can only occupy a part of the volume of each compartment or of the
surface defining the interfaces between the different compartments.
By virtue of a formulation introduced in [5, 6], we then assume that the macromolecules present
in a compartment occupy a maximal fraction of the compartment volume (respectively, surface).
Thus, we introduce β i , a global parameter, attached to the i-th compartment. In the RBA
framework, the coefficient β i is expressed as an equivalent volume occupied by one amino acid
in this compartment. This is used to express the volume or the surface occupancy of each
macromolecule in terms of an equivalent number of amino acids (see [6, 7] for details). Finally,
we can link the volume of the compartment to its content in macro-entities, as e.g. enzymes,
chaperones, ribosomes, by this relationship:
i

i

V (t) ≥ β

i

N
X

lk nXki (t)

(3)

k=1

for each i ∈ {0, 1, · · · , N com } and where N i is the number of possible (macro) entities present in
the i-th compartment and lk for each k ∈ {1, · · · , N i } is the total number of equivalent amino
acid residues of the entity Xk .
Following the same lines, the density acting on the surface area of the interface between the
i-th and j-th compartment is given by β ij , expressed as the equivalent surface occupied by one
amino acid in this interface, and this relationship:
ij

Ai↔j (t) ≥ β

ij

N
X

lk nX i↔j (t)

(4)

k

k=1

where N ij is the number of possible (macro) entities present in the interface between the i-th
and the j-th compartment and lk for each k ∈ {1, · · · , N ij } is the total number of amino acid
residues of the entity Xk .
Remark. More generally, the volume V i and the surface area Ai↔j of a compartment are
usually linked by the so-called volume/surface ratio σi . By the definition, the volume/surface
ratio σi of the i-th compartment is given by
∆

σi (t) =

A0↔i (t)
.
V i (t)

We will see in Section 3.5 how the relation between the volume and the surface area of a
compartment is taken into account into RBA constraints.
A simplifying assumption. In order to simplify the presentation in the reminder part of
this article, we assume that the volume of each compartment, including cytosol, saturates the
density constraint over time, i.e., Inequality (3) is an equality for all compartments. This implies

9

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

that the cell volume is relied to the (macro) entity content of each compartment by this simple
relation:
com
NX
Ni
X
V c (t) =
βi
lk nXki (t).
i=0

k=1

The evolution of the cell volume with respect to the time is then given by
V˙ c (t) =

com
NX

i

β

i=0

i

N
X

αk aXki (t) =

com
NX

i

β

i

i=0

k=1

N
X

lk λXki (t) V c (t).

k=1

|

∆

{z

}

=µc (t)

The expression of the cell volume leads to define a first constraint on the concentrations of the
set of all (macro) entities present in the cell:
com

i

NX
N
X
V c (t)
i
=
1
=
β
lk [Xki (t)]c .
V c (t)
i=0
k=1

If we furthermore introduce the volume of each compartment as a fraction of the cell volume:
Ni

X
V i (t)
lk [Xki (t)]c
= βi
f (t) = c
V (t)
i

∆

(5)

k=1

for all i ∈ {0, 1, · · · , N com }. We thus conclude that
i

f˙i (t) = β i

N
X
k=1

Ni


X 
d[Xki (t)]c
= βi
lk λXki (t) − µc (t)[Xki (t)]c .
lk
dt
k=1

Moreover, the volume fraction f i can be related to the surface area of the compartment normamized by the cell volume through Equation (4) as follows:
σi (t) =

A0↔i (t) 1
A0↔i (t)
=
i
V (t)
V c (t) f i (t)
| {z }
∆

=f 0↔i (t)

This leads to a constraint between the surface area and the volume of the compartment:
f 0↔i (t) = σ i (t)f i (t)

(6)

Remark. Other assumptions can be easily considered, in particular if the active constraints
are the interface surface rather than the volume. Finally, if the volume or interface surfaces
of compartments are defined differently by other mathematical expressions, it is important to
verify that the associated constraints can be formulated as convex constraints.

3.2

How to handle the flux exchanges between different compartments

We now investigate how the exchange fluxes of metabolites between two compartments are computed. In order to simplify the presentation, we consider the i-th compartment of volume V i ,
which has an interface with the cytosol of volume V 0 . We will also first assume that the volumes
of compartments (V i and V 0 ) are constant.

10

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

The metabolic network in the i-th compartment is classically described by a stoichiometric
matrix Ωi and the evolution of metabolite concentrations is described by
d[S i (t)]i
= Ωi ν i (t)
dt
where [S i (t)]i is the vector of metabolite concentrations (in the i-th compartment), ν i (t) is the
vector of fluxes (expressed as a number of molecules per unit of time and per unit of volume),
i
concatenating internal fluxes, denoted νint
(t), and fluxes of exchange between the compartment
i
and the cytosol, denoted νex,i↔0
(t). By convention, an exchange flux is positive when the
molecule is imported in the compartment and negative when it is exported from it. In such
a model, since all the quantities are defined per unit of volume and are attached to a specific
compartment, the exchanges with another compartment have to be converted, typically as a
number of molecules per unit of time, i.e.,
∆

i
i
Fex,i↔0
(t) = νex,i↔0
(t) V i .

This conversion allows us to write the equation linking the exchanges between the two considered
compartments as
∆
0
i
Fex,0↔i
(t) = −Fex,i↔0
(t).
However, the previous expression has a general drawback since the fluxes are now expressed
as an absolute number of molecules, and this number typically increase exponentially during a
growth phase. But that is not really a problem, we have just to normalize all these numbers by
a common quantity, chosen to be for example the volume of cell. In such a way, we then handle
only ‘normalized fluxes’ through all the compartments and these fluxes can now be added or
subtracted (at the level of exchange). We then introduce:


i
∆
∆ V
ν̃ki (t) = f i νki (t) = c νki (t)
V
for all k ∈ {1, · · · , N i } and all i ∈ {0, 1, · · · , N com }. In a steady-state regime, the fluxes through
metabolic networks satisfy these equality constraints:
 0

 i

νin
νin
i
i
[Ω0in , Ω0ex ]
=
0
and
[Ω
,
Ω
]
=0
0
i
ex
in
νex,0↔i
νex,i↔0
which can be rewritten with respect to the normalized fluxes as
 1


0
ν̃
in


 f0
 = 0 and [Ωi , Ωiex ] 
[Ω0in , Ω0ex ] 
in
 1


0
ν̃
ex,0↔i
f0

1 i
ν̃
f i in
1 i
ν̃
f i ex,i↔0



=0


where f 0 and f i are defined by Relation (5). We conclude that the interconnection of both
metabolic networks in steady-state can be written as
 0

ν̃in

 0

 i

Ωin
0
Ω0ex

=0
ν̃
i
i
in


0
Ωin −Ωex 

0
ν̃ex,0↔i

11

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Compartments with time-variant volumes. The previous results are obtained when the
volume of compartments is constant. We now consider a more general case. To do this, the
effect of dilution due to the increasing compartment volume has to be included. This is classic
and leads to the following differential equation:
 i

d[S i (t)]i
νin (t)
i
i
= [Ωin , Ωex ]
− µi (t)[S i (t)]i
i
νex,i↔0
(t)
dt
i
i
with νin
(t) and νex,i↔0
(t) are the internal and the exchange fluxes between the i-th compartment
and the cytosol respectively. By definition, we have
∆

ν̃ i (t) =

V i (t) i
ν (t)
V c (t)
| {z }
f i (t)

and then


i
ν̃in
(t)
 f i (t) 
d[S i (t)]i


= [Ωiin | Ωiex ] 
 − µi (t)[S i (t)]i .
i
dt
 ν̃ex (t) 


f i (t)
Since
∆

[S i (t)]c =

[S i (t)]i V i (t)
niS (t)
=
= [S i (t)]i f i (t),
c
V (t)
V c (t)

then we have
d[S i (t)]c
dt

d[S i (t)]i i
df i (t)
f (t) + [S i (t)]i
dt
dt

 i
ν̃in (t)
 − µi (t) [S i (t)]i f i (t) · · ·
= [Ωiin | Ωiex ] 
|
{z
}
i
ν̃ex (t)
c
[S i (t)]
"
#
V̇i (t)
V̇ c (t)
i
i
i
+[S (t)]
− V (t) c
.
V c (t)
(V (t))2
=

∆

∆

Finally, since V̇ c (t) = µc (t)V c (t) and V̇i (t) = µi (t)V i (t), the terms depending on µi (t) vanish,
so we can rewrite the previous differential equations as
 i

ν̃in (t)
d[S i (t)]c
 − µc (t)[S i (t)]c .
= [Ωiin | Ωiex ] 
dt
i
ν̃ex (t)

3.3

How to link enzyme activities in the different compartments with
each other

Typically, the activity of the k-th enzyme localized in the i-th compartment is described by
i
(t) = [Eki (t)]i Fk ([S∗i (t)]i )
νE
k
i
where [Eki ]i is the concentration of the k-th enzyme in the i-th compartment, νE
(t) is the
k
flux through the enzyme expressed as a number of molecules per unit of time and per unit of
volume. Fk is the nonlinear characteristic of the enzyme activity which is a function of a set of
∆
metabolite concentrations in the i-th compartment, i.e., [S∗i (t)]i = ([S1i (t)]i , · · · , [Sni (t)]i )T . The

12

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

notation S∗i will refer in the sequel to a set of metabolite concentrations in the i-th compartment.
In the RBA framework, the maximal flux through the k-th enzyme is constrained by its concentration through this simple linear inequality:
i
i
νE
(t) ≤ kE
[Eki (t)]i .
k
k

This last inequality can be rewritten in an equivalent way as an inequality between a normalized
flux and the concentration of the enzyme with respect to the cell volume:
i
i
ν̃E
≤ kE
[Eki (t)]c .
k
k

3.4

How to handle protein production in different compartments

Protein production. We assume that a protein Y is localized in the i-th compartment, has
a given concentration [Y i ]i , and that Y is produced by the machine2 R0 that is located in the
cytosol. We also assume that the volumes of compartments and of the cytosol are constant. So
V i , f i , V 0 , f 0 and V c are constant.
The total flow of proteins (in number of molecules per unit of time) produced by the nR0
machines is nR0 kR0 , where kR0 is the efficiency of R0 (in a number of amino acid per unit
of time3 ). Actually, like for an enzyme, the efficiency kR0 can be a nonlinear function that
depends on the concentration of a set of metabolites (located in the same compartment than
R0 ), kR0 ([S∗0 ]0 ). The machines produce a set of proteins that can be located in the same
compartment or translocated in another one.
Let us recall that the creation (in number per unit of time) of Y in the i-th compartment is
given by aY i (see Relation (1)). So the capability of machine R0 has to be sufficient to produce
aY i , and, by extension, all the proteins that R0 must produce. So we have:
com
NX
Ni
X

lk aYki (t) ≤ kR0 ([S∗0 (t)]0 )nR0 (t).

i=0 k=1

In the previous equation, lk is the length in amino acids of the protein Yk . In order to alleviate
the notations, we assume that R0 produces all proteins of the cell. The formula can be extended
directly to a subset of proteins by defining a subset of proteins per compartment. We can finally
normalize the previous inequality by V c on both sides in order to deduce this inequality:
com
NX
Ni
X

lk λYki (t) ≤ kR0 ([S∗0 (t)]0 )[R0 (t)]c .

(7)

i=0 k=1

Remark. Normally, the constraints in the compartment 0 is expressed with respect to the
concentration in the compartment 0:
com
NX
Ni
X

i=0 k=1
∆

However, since [R0 (t)]0 =

lk

aYki (t)
V 0 (t)

≤ kR0 ([S∗0 (t)]0 )[R0 (t)]0 .

aY i (t) ∆ aY i (t)
[R0 (t)]c
, and k 0 = 0k c , the two inequalities are equivalent.
0
f
V
f V

Impact of protein production on metabolites. The protein production consumes metabolites such as charged-tRNAs, GTP and releases others such as uncharged-tRNAs, GDP and
2 Corresponding

to the translation apparatus and its associated accessory proteins.
this is used to simplify the formulation of the RBA problem and more general modeling is possible
(see [6, 7] for details).
3 Again,

13

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

phosphate. In the case of translocation processes, these metabolites can further be located in
different compartments.
We first consider the case where all metabolites that are produced/consumed are located in the
cytosol. To this end, we consider a metabolite Sk located in the cytosol, and that γYk copies of
Sk are consumed for the synthesis of the protein Y. The flux νY0 (in number of molecules per
unit of time and per unit of volume) of Sk consumed by R0 to produce Y in the cytosol is equal
a i (t)
to γYk Y 0 . So we have:
V
d[Sk0 (t)]0
a i (t)
= Ω0k ν 0 (t) − γYk Y 0 .
dt
V
Remarks.
a i (t)
1. If the metabolite is produced, then the term γYk Y 0 is added and not substracted in
V
the equation.
2. If the protein Y is produced in the cytosol, and then remains in the cytosol instead of
a 0 (t)
being translocated in another compartment, the flux νY0 is equal to γYk Y 0 .
V
By using the same notation than the previous section, we have:
ν̃ 0 (t)
a i (t)
d[Sk0 (t)]0
= Ω0k 0 − γYk Y0 c .
dt
f
f V
And for all proteins that are produced by R0 in the cytosol, we have:
com

i

NX X
N
aY i (t)
d[Sk0 (t)]0
ν̃ 0 (t)
= Ω0k 0 −
γYj,k 0j c .
dt
f
f V
i=0 j=1

(8)

Steady-state regime. In steady-state, from Equation (2), Inequality (7) becomes
c

µ

com
NX
Ni
X

lj [Yji ]c ≤ kR0 ([S∗0 ]0 )[R0 ]c ,

i=0 j=1

and Equality (8) becomes:
Ω0k ν̃ 0

c

−µ

com
NX
Ni
X

γYj,k [Yji ]c = 0.

i=0 j=1

Compartments with time-varying volumes. Now let us consider that the volumes are
time-varying. The dynamics of [Sk0 (t)]0 with respect to time is given by
ν̃ 0 (t)
a i (t)
d[Sk0 (t)]0
= Ω0k 0
− γYk 0 Y c
− µ0 (t)[Sk0 (t)]0 .
dt
f (t)
f (t)V (t)
∆

Since we have [Sk0 (t)]c = f 0 (t)[Sk0 (t)]0 then
d[Sk0 (t)]0
d[Sk0 (t)]c
= f˙0 (t)[Sk0 (t)]0 + f 0 (t)
dt
dt
14

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

and by summing on all proteins:
d[Sk0 (t)]c
dt

=



ν̃ 0 (t)
Ω0k 0

f (t)

−

com
NX
Ni
X

γYj,k

i=0 j=1

aYji (t)
f 0 (t)V c (t)


− µ0 (t)[Sk0 (t)]0 f 0 (t) · · ·

+[Sk0 (t)]0 f 0 (t)(µ0 (t) − µc (t))
which finally leads to deduce that
com

i

NX X
N
d[Sk0 (t)]c
= Ω0k ν̃ 0 (t) −
γYj,k λYji (t) − µc (t)[Sk0 (t)]c .
dt
i=0 j=1

Protein translocation. We now consider the translocation process. A molecular machine,
the translocon, translocates proteins from one compartment to another one, and usually consumes and produces metabolites that can be located in both compartments. One metabolite
(such as protons) can also be translocated with the protein. In this paragraph, we establish
the formulation of constraints related to the translocon capability, and also on the associated
metabolites.
We consider (i) 3 metabolites S1 , S2 and S3 . S1 is located in the cytosol, S2 in the i-th compartment, and S3 is translocated between compartments; (ii) the translocon T that is localized
in the membrane; and (iii) a protein Y that is translocated. The membrane is considered as
the 0 ↔ i interface. Moreover, we consider that all volumes are constant.
As in the previous sections, we have a number of translocon nT 0↔i that catalyzes the translocation of nY copies of Y from the cytosol to the i-th compartment. In most of organisms, such
translocation steps are irreversible. We thus have one translocon to translocate proteins from
the cytosol to the i-th compartment (e.g. Tim/Tom, Tic/Toc machines). What count in our
model will be the active protein Y in the i-th compartment. We will thus note aY i the number
of Y that will be translocated per unit of time and that will be present finally in the i-th compartment.
The capability of the translocon (in number per unit of time) must be sufficient to translocate
the flow of proteins Y (also expressed in unit of time). So we have the constraint:
lY aY i (t) ≤ kT ([S∗0 (t)]0 , [S∗i (t)]i )nT 0↔i (t)
with kT ([S∗0 (t)]0 , [S∗i (t)]i ) the efficiency of the translocon (in number of amino acids residues per
unit of time), depending on a set of metabolites that can be located in both compartments, and
lY the length of amino acid residues of Y. We can normalize the previous inequality by V c and
obtained
lY λY i (t) ≤ kT ([S∗0 (t)]0 , [S∗i (t)]i )[T 0↔i (t)]c .
And for all proteins that are translocated by T, we have:
i

N
X

lj λYji (t) ≤ kT ([S∗0 (t)]0 , [S∗i (t)]i )[T 0↔i (t)]c .

j=1

Impact of translocation on metabolites. For S1 and S2 , we have the same type of relations
than in the previous paragraph. The flux (in number of molecules per unit of volume per unit
a i (t)
of time) of S1 (located in the cytosol) consumed by T to translocate Y is equal to δY1 Y 0 ,
V
where δY1 is the number of S1 consumed per translocated protein. So for all proteins:
i

N
X
aY i (t)
d[S10 (t)]0
= Ω01 ν 0 (t) −
δYj,1 j 0
dt
V
j=1

15

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

where δYj,1 is the number of S1 consumed to translocate Yj . And for S2 :
i

N
X
aY i (t)
d[S2i (t)]i
= Ωi2 ν i (t) −
δYj,2 j i
dt
V
j=1

where δYj,2 is the number of S2 consumed to translocate Yj .
By normalizing by V c instead and by using the same notations than before, we have:
Ni

λY i (t)
d[S10 (t)]0
ν̃ 0 (t) X
δYj,1 j 0
= Ω01 0 −
dt
f
f
j=1
and:

Ni

λY i (t)
d[S2i (t)]i
ν̃ i (t) X
= Ωi2 i −
δYj,2 j i
dt
f
f
j=1
Let us now consider S3 and the two concentrations in the cytosol and in the i-th compartment.
The flux of S3 (in number of molecules per unit of time) that crosses the interface 0 ↔ i (from
the cytosol to the i-th compartment) is equal to:
0
F0↔i
= ν30↔i (t)V 0 = δY3 aY i (t).
0
By the mass conservation, the flux of S3 that enters is equal to −F0↔i
.
In the cytosol, the dynamics of the concentration of S3 when the protein Y is translocated, is
given by
a i (t)
d[S30 (t)]0
= Ω03 ν 0 (t) − δY3 Y 0 ,
dt
V
where δY3 is the number of S3 that is translocated together with Y.
For the concentration of S3 in the i-th compartment, we have:

d[S3i (t)]i
a i (t)
= Ωi3 ν i (t) + δY3 Y i .
dt
V
By using the same transformation than the previous section, we finally obtain:
d[S30 (t)]0
dt
d[S3i (t)]i
dt

a i (t)
ν̃ 0 (t)
− δY3 Y0 c
f0
f V
i
aY i (t)
i ν̃ (t)
= Ω3 i + δY3 i c
f
f V
= Ω03

For all proteins that are translocated, we have:
d[S30 (t)]0
dt
d[S3i (t)]i
dt

aY i (t)
ν̃ 0 (t) PN i
− j=1 δYj,3 0j c
0
f
f V
i
a
i
P
Y i (t)
ν̃
(t)
N
= Ωi3 i + j=1 δYj,3 ij c
f
f V
= Ω03

Steady state regimen. In steady state, we thus have
i

c

µ

N
X

lj [Yji ]c ≤ kT ([S∗0 (t)]0 , [S∗i (t)]i )[T 0↔i ]c ,

j=1

16

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

and for the metabolites S1 , S2 and S3 , these following constraints:
i

Ω01 ν̃ 0 − µc
Ωi2 ν̃ i − µc
Ω03 ν̃ 0 − µc

N
X
j=1
Ni
X
j=1
Ni
X

δYj,1 [Yji ]c = 0
δYj,2 [Yji ]c = 0
δYj,3 [Yji ]c = 0

j=1
i

Ωi3 ν̃ i

c

+µ

N
X

δYj,3 [Yji ]c = 0

j=1

Compartments with time-variant volumes. For the general case, we follow the same lines
than in the previous section, and obtain for S2 for instance:
i

N
X
d[S2i (t)]c
= Ωi2 ν̃ i (t) −
δYj,2 λYji (t) − µc (t)[S2i (t)]c .
dt
j=1

3.5

RBA problem for the i-th compartment

In this section, we write the RBA constraints for the i-th compartment of an eukaryotic cell.
As we said previously, we consider hereafter the concentration of molecular species with respect
to the volume of the cell (e.g. [Yji ]c in Section 3.1). However, for the sake of readability, we
will omit the brackets in the notation of concentrations in the sequel. The notation Yji will
thus refer to [Yji ]c , the concentration of the machine Yj localized in the i-th compartment with
respect to the cell volume. The notation PGi will refer to the concentration of the PG proteins
in the i-th compartment ([PGi ]c ). We also considered the vector of normalized flux ν̃. Moreover,
n̄B i
∆
the concentration of metabolites B̄ji will refer to [B̄ji ]c = cj , where n̄Bji is constant and given.
V
Again, for the sake of readibility, we will not integrate the turnover rate of molecular entities.
Thereafter, we consider the most common case: an organelle that is isolated from the cytosol
by a lipidic membrane. We will consider that some metabolic and macromolecular processes
occur within the organelle, and that some molecular entities (e.g. metabolites, proteins, to cite
a few) are produced in the cytosol and imported into the organelle. Even if the constraints
will be formulated for this type of organelle, the formulation is generic enough to describe the
exchanges between any compartments.
Let us consider the i-th compartment and its interface with the cytosol 0 ↔ i. By convention,
the fluxes that enter within the compartments are positive, and the ones that are excreted are
negative. Let us consider the Nyi machines present in the i-th compartment of concentrations
i
enzymes and
Y i ≥ 0, and being synthetized at rate ΛiY . Among the Nyi machines, we have Nm
i
i
the vector of their metabolic fluxes ν̃ . Moreover, we will further specify ν̃ with the internal
i
0↔i
metabolic fluxes ν̃in
and the ones of exchange through the interface ν̃ex
.

17

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Metabolic and capacity constraints. The constraints attached to the metabolic network,
and to the production of molecular machines for compartment i are:

S,i i
S,i i
(C1i ) −Ωi ν̃ i + CYS,i ΛiY + CG
ΛG + µc CB
B̄ = 0





M,i
M,i
i
i
i
i
i


 (C2a ) CY ΛY + CG ΛG − KT Y ≤ 0
0

i
i
i
(C2b
) −KE,i Y i ≤ ν̃in
≤ KE
Yi





i

) ΛiY − µc Y i = 0

 (C4a
i
(C4b ) ΛiG − µc PGi = 0

where
• (C1i ) describes the mass conservation for the set of metabolites localized in the i-th compartment (Si ). Moreover, we consider that a subset of metabolites also has a fixed concentration B̄ i (also given with respect to the cell volume);
i
• (C2a
) describes the capability constraints of the molecular machines localized in the i-th
compartment;
i
• (C2b
) describes the capability constraints of the enzymes localized in the i-th compartment.
Constraints on transporter are defined in the constraints related to the compartment
interface.
i
i
• (C4a
) and (C4b
) are the constraints of steady-state regimen for the dynamics of the concentration of molecular machine and PG localized in the i-th compartment.

In all constraints, the matrixes C∗∗,i contains the same type of coefficients than the ones in
Section 2.1. Only the structure of the matrices changes with respect to the type of process
and to the molecular machines that are present in the i-th compartment and in the j-th constraint. For instance, if the i-th compartment is the mitochondria, then since translation of
i
some mitochondrial proteins occurs only in the mitochondria, then (C2a
) contains a constraint
of the capability of the mitochondrial translation process. Therefore, we need to identify the
proteins that are only translated in the mitochondria to build the constraints. If the vector ΛiY
 i,in 
ΛY
i
,
is organized along the machines that are produced in or out the mitochondria ΛY =
Λi,out
Y
then CYM,i = [lYi,in , 0] where lYi,in contains the length in amino acids of mitochondrial molecular
machines produced in the mitochondria.
i
We also chose to put the constraints (C4a
) for all molecular machines of the i-th compartment
whatever is their location of production for readability purpose.
Remark. As mentionned previously, the set B of metabolites having fixed concentrations usually contains building blocks of macro-components such as DNA, cell wall or membrane, and
thus in particular the building blocks for the membrane of organelles (i.e. the interface of
S,i i
compartment). The term µc CB
B̄ typically corresponds to the flux necessary to maintain the
i
concentration B constant and equal to B̄ i at growth rate µc . If we assume that the set Bi
contains at least one metabolite Bik for the synthesis of any interface (for instance the interface
0 ↔ i), then we have:
∆

B̄ki =

n̄Bki
Vc

=

n̄Bki A0↔i
n̄Bki
0↔i
=
f
= f 0↔i B̂ki
A0↔i | V{zc }
A0↔i
=f 0↔i

18

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

∆

where B̂ki =

n̄Bki

corresponds to the number of Bk per unit of surface area.
A0↔i
In this this case, constraint C1i is rewritten as:
S,i i
S,i
−Ωi ν̃ i + CYS,i ΛiY + CG
ΛG + µc CB
(B̄ i + f 0↔i B̂ i ) = 0

For the interface 0 ↔ i, we have:

0↔i
(C2a
) CYM,0→i ΛiY + CYM,0←i Λ0Y + CYM,0↔i Λ0↔i
···

Y




M,0↔i

+CG
Λ0↔i
− KT0↔i Y 0↔i ≤ 0

G


0
0↔i
0↔i
0↔i 0↔i
(C2b
) −KE,0↔i Y 0↔i ≤ ν̃ex
≤ KE
Y




0↔i
0↔i
c
0↔i
 (C4a ) ΛY − µ Y
=0




0↔i
0↔i
c 0↔i
(C4b ) ΛG − µ PG = 0
Here:
• the term CYM,0→i ΛiY corresponds to the flux of machines that are (i) active in the i-th
compartment, (ii) produced in the cytosol and (iii) translocated through the interface.
• The term CYM,0←i Λ0Y corresponds to the flux of machines that are (i) active in the cytosol,
(ii) produced in i-th compartment and (iii) translocated through the interface4 .
corresponds to the flux of the machines localized in the interface
• The term CYM,0↔i Λ0↔i
Y
0 ↔ i and that needs a secretion machine to be inserted in the membrane.
The vector of machines Y 0↔i typically regroups the systems of import and export (if any) of
proteins (e.g. TIM/TOM or TIC/TOC machine), and secretion machines to insert the membranous machines in the interface of the compartment. Only one global secretion machine could
be integrated, as well as several machines (e.g. insertion of machines produced in compartment
i, or in compartment 0) depending the level of details that we want to consider.
Remark. Often in eukaryotes, a molecular machine localized in the i-th compartment Yij is
composed of subunits that are synthetized in different compartments; that thus need to be
translocated. This is well represented in the RBA framework through coefficients CYM,0↔i . In
that case, this coefficient will be equal to the length in amino acid residues of the subunits of
Yij that need to be translocated.
Volume constraints. It remains to formalize the constraints on the volumes of compartments
in steady-state. Some organelles such as the peroxisome, the mitochondria, the chloroplast were
ancestrally bacteria. Their internal density is higher than the cytosol, and we could assume that
their principle of growth follows the one of prokaryotic cells: the density of the compartment
should be kept constant, and thus the increase of volume is driven by an increase in mass. Alternatively, the constraints could arise from the membrane occupancy. In this case, the increase
of volume is driven by an increase in the mass of membranous proteins.
Following Section 3.1, a compartment satisfying the density constraint has this following volume:
 i

Ngi
N
X
X
lj nGi (t)
V i (t) = β i 
lj nY i (t) +
j

j

j=1

j=1

4 Again, we introduce this term to be as generic as possible. However, the export of proteins may not occur
in all organelles, so this term could vanish.

19

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

which can be normalized with respect to the cell volume leading to obtain this steady-state
regimen:
 i

Ngi
N
X
X
f i = βi 
lj Yji +
lk PGi k 
j=1

k=1

where lj and lk are the equivalent length in amino acid residues of the machine Yj and protein
PGk respectively, and β i is the volume occupied by one amino acid in the i-th compartment. The
term β i lj Yji then correspond to the fraction of the volume of the cell occupied by the machine
Yij .
Remark. β i would typically correspond to

1
in the RBA for prokaryotic cells.
D̄i

Moreover, we also have the constraint between the volume and the surface area of the compartment (Equality (6)):
f 0↔i = σ i f i
We could for instance consider a fixed surface/volume ratio σ i , so that when the volume of the
compartment is higher, so is the surface.
Finally, the user should decide which constraints f i or f 0↔i is the active one:

 i

Ngi
N

X
X



βi 
lj Yji +
lk PGi k  = f i




j=1
k=1

 0↔i

∆
i
Ng0↔i
(C3a
)=
NX
X

0↔i 

 ≤ f0↔i

lj Yj0↔i +
lk PG0↔i
 β
k



j=1
k=1

 0↔i
f
= σi f i
or


 i

Ngi
N

X
X



βi 
lj Yji +
lk PGi k  ≤ f i




j=1
k=1

 0↔i

∆
i
Ng0↔i
(C3b
)=
NX
X


 = f0↔i

β 0↔i 
lj Yj0↔i +
lk PG0↔i

k



j=1
k=1

 0↔i
f
= σi f i

i
Mitochondria and the thylakoid could typically be modeled by (C3b
) while chloroplast and
i
peroxisome by (C3a ).
Moreover, we could also add constraints on the minimal and maximal volume occupied by the
compartment such as
f i ≤ f i ≤ f¯i

where f i , f¯i are the minimal and maximal ratio of the i-th compartment with respect to the
cell volume respectively. Having f i = 0 means that the compartment may be absent.
Finally, the volume of the cytosol is defined as the volume of the cell minus the volume of
all organelles. In addition, the volume occupied by all machines within the cytosol must be

20

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

compatible with the volume of the










0 ∆
(C3 ) =










cytosol:
0

f =1−

com
NX

fi

i=1

f0 ≤ f0
 0

Ng0
N
X
X
β0 
lj Yj0 +
lk PG0 k  ≤ f 0 .
j=1

k=1

Remark. For complex structures of organelles, such as mitochondria or chloroplast, we expect
that other constraints between volumes or surfaces should be added in order to guarantee the
structure of the organelle. For instance, for mitochondria, the volume of the membranous
interspace between the outer and the inner membrane and of the mitochondrial matrix should
be linked such as
f inter = αi f matrix
where αi is the ratio between both volumes. Thus, if one of the interface or one of the volume
is increasing, so are the others.
However, at this stage, the way to tackle the structure of organelles is more a modelling issue,
and is thus up to the modeller. The modeler can describe the structure he wants, as soon as
the mathematical formulation remains convex.
Formulation of the constraints for the i-th compartment. To summarize, we write now
i
the set of constraints Crba
attached to the i-th compartment, composed of the interior and its
interface by

S,i i
S,i

(C1i )
−Ωi ν̃ i + CYS,i ΛiY + CG
ΛG + µc CB
(B̄ i + f 0↔ B̂ i ) = 0




M,i i

i

ΛG − KTi Y i ≤ 0
CYM,i ΛiY + CG
 (C2 )



0

i
i


−KE,i Y i ≤ ν̃in
≤ KE
Yi






(C20↔i ) CYM,0→i ΛiY + CYM,0↔i Λ0Y + CYM,0↔i Λ0↔i
···

Y


M,0↔i 0↔i
0↔i 0↔i

+C
Λ
−
K
Y
≤0

G
T
G




0

0↔i
0↔i 0↔i

−KE,0↔i Y 0↔i ≤ ν̃ex
≤ KE
Y








Ngi
Ni

X
X


i
i
i


β
lj Yj +
lk PGi  ≤ f i
 (C3 )
k

∆

i
Crba
=

j=1



























(C4i )












(C40↔i )







β 0↔i 
f

0↔i

k=1

0↔i
NX

lj Yj0↔i +

j=1
i i

Ng0↔i



X

 = f 0↔i
lk PG0↔i
k

k=1

=σ f

f ≤ f i ≤ f¯i
i

ΛiY − µc Y i = 0
ΛiG − µc PGi = 0
Λ0↔i
− µc Y 0↔i = 0
Y
Λ0↔i
− µc PG0↔i = 0
G

i
Here we assume that the constraints on volume follows the case (C3b
). For the other type of
i
i
organelles and for the cytosol, only the (C3 ) constraints need to be substituted by (C3a
) and

21

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

(C30 ) respectively.
i
In Crba
, the decision variables are:
i
0↔i
• the flux vector ν̃ i of size Nm
+ Nm
i
0↔i
• the concentration of molecular machines Y i and Y 0↔i of size Nm
+ Npi and Nm
+ Np0↔i
respectively

• the synthesis rates of molecular machines (Λ0↔i
and ΛiY of same size as Y i and Y 0↔i )
Y
0↔i
i
i
and of PG proteins (ΛG and ΛG of size Ng and Ng0↔i respectively)
• the volume f i and f 0↔i .
∆

∆

The previous contraints can be further aggregated by introducing Y ī = [Y i , Y 0↔i ]T , ΛīY =
[ΛiY , ΛY0↔i ]T , PGī
matrix form:


























∆

∆

T
= [PGi , PG0↔i ]T , ΛīG = [ΛiG , Λ0↔i
G ] , and by rewriting constraint C3 under a

S,i
S,ī ī
(B̄ i + f 0↔i B̂ i ) = 0
ΛG + µc CB
(C1ī ) −Ωi ν̃ i + CYS,ī ΛīY + CG
M,ī ī
(C2ī ) CYM,ī ΛīY + CG
ΛG − KTī Y ī ≤ 0
0

ī
−KE,ī Y ī ≤ ν̃ i ≤ KE
Y ī
D,i ī
(C3ī ) CYD,i Y ī + CG
PG − f i ≤ 0


















(C4ī )








D,0↔i ī
CYD,0↔i Y ī + CG
PG − f 0↔i = 0

f 0↔i = σ i f i
f i ≤ f i ≤ f¯i
ΛīY − µc Y ī = 0
ΛīG − µc PGī = 0

and where all matrices C∗∗,ī are deduced by straightforward manipulations.
Finally, if we substitute constraints (C4ī ) in the other ones, we obtain:

ī
Crba


S,ī ī
S,i
(C1ī ) −Ωi ν̃ i + µc (CYS,ī Y ī + CG
PG + CB
(B̄ i + f 0↔i B̂ i )) = 0





M,ī ī


(C2ī ) µc (CYM,ī Y ī + CG
PG − KTī Y ī ≤ 0




0

ī


−KE,ī Y ī ≤ ν̃ i ≤ KE
Y ī



∆
D,i ī
(C3ī ) CYD,i Y ī + CG
PG − f i ≤ 0
=



D,0↔i ī


CYD,0↔i Y ī + CG
PG − f 0↔i = 0






f 0↔i = σ i f i






f i ≤ f i ≤ f¯i

The previous formulation is thus very close to the RBA formulation of prokaryotic cells of
Section 2.1. Only constraints C3 differ by having the normalized volume and surface area of the
compartment as decision variables, and this, in order to adjust the volume of the organelles to
the need of the cell. Morever, all constraints are linear with respect to the decision variables.

22

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

3.6

Formulation of the RBA problem for eukaryotic cells

The consequences of the integration of compartments on RBA have been explored in the previous
paragraphs. Clearly, by introducing the normalization of all species by the cell volume, the
formulation of the RBA problem for eukaryotic cells is very close to the one for prokaryotic
e
cells. We give in this section the RBA optimization problem, Prba
, for the eukaryotic cell.
Let us introduce:
(i) the set of Ncom cellular compartments indexed by IV = {0, . . . , Ncom }, and the set of Nint
interfaces indexed by IA = {e ↔ 0, 0 ↔ i, . . . , k ↔ j}5 . The set IA contains the indexes of
all possible interfaces between compartments. We note Nc = Ncom + 1 + Nint .
(ii) Y the vector of concentrations of all molecular machines of size Ny (which includes Nm
enzymes), present in all compartments and interfaces.
(iii) the flux vector ν of size Nm and associated to the Nm enzymes;
(iv) PG the vector of concentration of the PG proteins of size Ng present in all compartments
and interfaces.
(v) fV is the vector of the normalized volume of compartments with respect to the total
∆
cell volume: fV = ((f i )i∈IV )T . Moreover, fA is the vector of normalized surface area of
∆
compartments with respect to the total cell volume: fA = ((f i )i∈IA )T . Finally, f is the
concatenation of fV and fA .
The RBA optimization problem can be formalized as follows.
N
e
Prba
(µ): For a fixed vector of concentrations PG ∈ R>0g , and the growth rate µ ≥ 0 of the cell,
N

find

c
Y ∈ R≥0y , ν ∈ RNm , f ∈ RN
≥0 ,

(C1 )

S
S
−Ων + µ(CYS Y + CG
PG + CB
B̄ + CFS f B̂) = 0

(C2 )

M
µ(CYM Y + CG
PG ) − KT Y ≤ 0
0

−KE Y ≤ ν ≤ KE Y
D,iq
(C3a ) CYD,iq Y + CG
PG − CFD,iq f ≤ 0

(C3b )

D,eq
PG − CFD,eq f = 0
CYD,eq Y + CG

(C3c )

CFF f − C̄ = 0

(C3d )

f V ≤ IV f ≤ f¯V

where:
• (C1 ) and (C2 ) have the same meaning than the RBA problem for prokaryotic cells
• (C3a ) include the volume or surface constraints that may not be saturated. The contraints
on the maximal density of the cytosol is typically included here.
• (C3b ) contain the volume or surface constraints that are assumed to be always saturated
• (C3c ) contain all the constraints between the surface and the volume of one compartment
(e.g. f 0↔i = σ i f i ), additional constraints between volumes or surfaces for complex strucPN com
tures of compartments, and the equality constraint determining f 0 : f 0 = 1 − i=1 f i .
C̄ is a vector having 1 only for the constraint on f 0 and zero otherwise.
5 here

e denotes the index of the compartment associated to the extracellular medium

23

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

• (C3d ) regroup the constraints on the minimal and maximal volume of compartments with
respect to the total cell volume. The vector f V and f¯V contain the minimal and maximal
normalized volumes of compartments respectively, and the matrix IV is such that fV =
IV f .
The RBA problem for eukaryotic cells is a Linear programming optimization problem, and can
thus be solved efficiently at the cell scale. Compared to the RBA problem for prokaryotic
cells, the set of C1 and C2 constraints are similar, with the same matrices of coefficients and
0
parameters C∗∗ , KT and KE , KE . It means that this part of the optimization problem can be
built exactly as in the RBA problem for prokaryotes. Only the values of efficiency coefficients
0
(KE , KE ) of processes could be dependent on the compartment, since they may be modulated
by the internal metabolite concentrations of compartments (see Section 3.3 and 3.4).

4

Conclusion

In this paper, we investigated how the RBA framework can be extended to eukaryotic cells.
Interestingly, it turns out that the RBA framework for eukaryotic cells remains very close to
the one for prokayotic cells. More importantly, the RBA problem for eukaryotic cells for a fixed
growth rate is a Linear Programming (LP) problem, and can thus be solved efficiently at the
cell scale [1, 10].
Recently, we developed RBApy, a python package for the generation and simulation of RBA
models for prokaryotic cells [2]. Because of the similarity between optimization problems, the
extension of RBApy to eukaryotic cells should require only a few changes, mainly at the level of
density constraints. Only a few additional parameters are required, and they are mainly related
to the structure of organelles (such as the surface/volume ratios). Therefore, we expect no major theoretical or operational difficulty at developing RBA models for eukaryotic cells. Running
RBA for an eukaryotic cell depends on the number of decision variables and of constraints.
In steady-state, the associated optimization problem should be of reasonable size, enabling its
efficient resolution.
In practice, developing RBA models for eukaryotic cells strongly relies on the level of knowledge
on the functioning or biological processes. The framework is flexible enough to integrate a high
level of details, such as all the different chaperoning systems and their targets in mitochondria,
if the knowledge is available and if the modeler want to include a high level of details. Or,
in contrast, the RBA model can include only an aggregated description of a biological process.
Therefore, the final RBA model will result from a compromise between the level of knowledge on
the functioning of the organism, the resulting size of the optimization problem, and the choice
of the modeler.
RBA model parameters can be estimated from data, and even from existing published data.
When we developed the RBA model of Escherichia coli in [2], we used existing fluxomics and
quantitative proteomic datasets [15, 13] to estimate parameters, and obtained good quantitative predictions. Currently, the real challenge is the biological validation of RBA models of
eukaryotic cells as we did for bacteria a few years ago in [7]: to have (or to generate) suitable
datasets to learn the parameters in different growth conditions and how they evolve with respect
to growth rate, in order to finally perform predictions using varying growth-rate dependent parameters. This will be achieved in a near future, as well as the update of the RBApy package
to automatically generates RBA models for eukaryotic cells.

Acknowledgments
We thank O. Bodeit and A. Bulović for their critical comments on this manuscript.

24

bioRxiv preprint doi: https://doi.org/10.1101/750182; this version posted August 29, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

References
[1] A. Ben-Tal and A. Nemirovski. Lectures on modern convex optimization: analysis, algorithms, and engineering applications. MPS/SIAM Series on Optimization, 2001.
[2] A. Bulović, S. Fischer, M. Dinh, F. Golib, W. Liebermeister, C. Poirier, L. Tournier,
E. Klipp, V. Fromion, and A. Goelzer. Automated generation of bacterial resource allocation models. Metabolic engineering, 2019.
[3] A. Goelzer and V. Fromion. Bacterial growth rate reflects a bottleneck in resource allocation. Biochemical Biophysical Acta, 1810(10):978–988, 2011.
[4] A. Goelzer and V. Fromion. Resource allocation in living organisms. Biochemical Society
Transactions, 45(4):945–952, 2017.
[5] A. Goelzer, V. Fromion, and G. Scorletti. Cell design in bacteria as a convex optimization
problem. Proceedings of the 48th IEEE Conference on Decision and Control, pages 4517–
4522, December 2009.
[6] A. Goelzer, V. Fromion, and G. Scorletti. Cell design in bacteria as a convex optimization
problem. Automatica, 47(6):1210–1218, 2011.
[7] A. Goelzer, J. Muntel, V. Chubukov, M. Jules, E. Prestel, R. Nolker, M. Mariadassou,
S. Aymerich, M. Hecker, P. Noirot, D. Becher, and V. Fromion. Quantitative prediction of
genome-wide resource allocation in bacteria. Metabolic Engineering, 32:232–243, 2015.
[8] H. Lu, F. Li, B. J. Sánchez, Z. Zhu, G. Li, I. Domenzain, S. Marcišauskas, P. M. Anton,
D. Lappa, C. Lieven, et al. A consensus S. cerevisiae metabolic model yeast8 and its ecosystem for comprehensively probing cellular metabolism. Nature Communications, 10(1):1–13,
2019.
[9] M. Mori, T. Hwa, O.C. Martin, A. De Martino, and E. Marinari. Constrained allocation
flux balance analysis. PLoS computational biology, 12(6):e1004913, 2016.
[10] Y. Nesterov. Introductory lectures on convex optimization: a basic course. Kluwer Academic
Publishers, 2004.
[11] E.J. O’Brien, J.A. Lerman, R.L. Chang, D.R. Hyduke, and B.Ø. Palsson. Genome-scale
models of metabolism and gene expression extend and refine growth phenotype prediction.
Molecular systems biology, 9(1), 2013.
[12] A.-M. Reimers, H. Knoop, A. Bockmayr, and R. Steuer. Cellular trade-offs and optimal resource allocation during cyanobacterial diurnal growth. Proceedings of the National
Academy of Sciences, 114(31):E6457–E6465, 2017.
[13] A. Schmidt, K. Kochanowski, S. Vedelaar, E. Ahrné, B. Volkmer, L. Callipo, K. Knoops,
M. Bauer, R. Aebersold, and M. Heinemann. The quantitative and condition-dependent
Escherichia coli proteome. Nature biotechnology, 34(1):104, 2016.
[14] L. Tournier, A. Goelzer, and V. Fromion. Optimal resource allocation enables mathematical
exploration of microbial metabolic configurations. Journal of mathematical biology, 2017.
[15] B.R.B.H. Van Rijsewijk, A. Nanchen, S. Nallet, R.J. Kleijn, and U. Sauer. Large-scale
13c-flux analysis reveals distinct transcriptional control of respiratory and fermentative
metabolism in Escherichia coli. Molecular systems biology, 7(1), 2011.

25

