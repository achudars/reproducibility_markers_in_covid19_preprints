bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

3

Evolution rapidly optimizes stability and
aggregation in lattice proteins despite
pervasive landscape valleys and mazes

4

Jason Bertram*,† and Joanna Masel‡

1

2

*

10

Environmental Resilience Institute, Indiana University,
Bloomington, IN, 47401.
†
Department of Biology, Indiana University, Bloomington, IN,
47401.
‡
Department of Ecology and Evolutionary Biology, University
of Arizona, Tucson, AZ 85721.

11

September 19, 2019

5
6
7
8
9

12
13
14
15
16
17
18
19
20
21

Acknowledgements: This work was supported by the John Templeton
Foundation (60814). We thank David McCandlish for comments on the
manuscript, and Artem Kaznatcheev for discussions. The authors acknowledge the Indiana University Pervasive Technology Institute for providing
HPC Karst resources that have contributed to the research results reported
within this paper. This research was supported in part by Lilly Endowment,
Inc., through its support for the Indiana University Pervasive Technology
Institute, and in part by the Indiana METACyt Initiative. The Indiana
METACyt Initiative at IU was also supported in part by Lilly Endowment,
Inc.

1

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

22

23
24

25

26
27
28
29
30
31

32
33
34
35
36
37

Short title: Stability-aggregation tradeoffs in lattice proteins
Keywords: Fitness landscape, sign epistasis, pleiotropy, computational
complexity, protein folding, hydrophobic zipping
Corresponding author details (two corresponding authors):
Jason Bertram
jxb@iu.edu
Department of Biology
1001 E 3rd St
Bloomington
IN 47405
Joanna Masel
masel@email.arizona.edu
Ecology & Evolutionary Biology
1041 E Lowell St
Tucson
AZ 85721

2

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

38

Abstract

39

Fitness landscapes are widely used to visualize the dynamics and

40

long-term outcomes of evolution. The fitness landscapes of genetic

41

sequences are characterized by high dimensionality and “ruggedness”

42

due to sign epistasis. Ascending from low to high fitness on such

43

landscapes can be difficult because adaptive trajectories get stuck at

44

low-fitness local peaks. Compounding matters, recent computational

45

complexity arguments have proposed that extremely long, winding

46

adaptive paths may be required to even reach local peaks, a “maze-

47

like” landscape topography. The extent to which peaks and mazes

48

shape the mode and tempo of evolution is poorly understood due to

49

empirical limitations and the abstractness of many landscape models.

50

We develop a biophysically-grounded computational model of protein

51

evolution based on two novel extensions of the classic hydrophobic-

52

polar lattice model of protein folding. First, rather than just consid-

53

ering fold stability we account for the tradeoff between stability and

54

aggregation propensity. Second, we use a “hydrophobic zipping” algo-

55

rithm to kinetically generate ensembles of post-translationally folded

56

structures. Our stability-aggregation fitness landscape exhibits exten-

57

sive sign epistasis and local peaks galore. We confirm the postulated

58

existence of maze-like topography in our biologically-grounded land-

59

scape. Although these landscape features frequently obstruct adap-

60

tive ascent to high fitness and virtually eliminate reproducibility of

61

evolutionary outcomes, many adaptive paths do successfully complete

62

the long ascent from low to high fitness. This delicate balance of

3

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

63

“hard but possible” adaptation could occur more broadly provided

64

that the optimal outcomes possible under a tradeoff are improved by

65

rare constraint-breaking substitutions.

4

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

66

1

Introduction

67

The effect of an allele on organismal fitness can depend on its genetic context,

68

a phenomenon known as epistasis. Epistasis is often visualized in terms of a

69

“landscape” representing the mapping from high-dimensional genotype space

70

to fitness (Wright, 1932; Kondrashov and Kondrashov, 2015). In the absence

71

of epistasis, new mutations have the same effect regardless of the order in

72

which they occur, and adaptive evolution on any genetic background leads to

73

the same peak genotype(s). The latter still applies if epistasis only affects the

74

magnitude — not the sign — of mutational fitness effects. However, if there

75

is sign epistasis (mutations that are beneficial on some genetic backgrounds

76

are deleterious on others), fitness landscapes become “rugged”; many or all

77

of the mutational paths between two genotypes pass through valleys of lower

78

fitness even if those genotypes only differ by a few mutations (Weinreich

79

et al., 2005).

80

Since sign epistasis is pervasive, particularly at the level of individual

81

proteins (Starr and Thornton, 2016), it is important to understand the con-

82

sequences of landscape “ruggedness” (Kondrashov and Kondrashov, 2015).

83

These consequences can be broadly be divided into two categories. First,

84

sign epistatic landscapes can be permeated with local fitness peaks where no

85

beneficial mutations are available, halting adaptive evolution and requiring

86

valley crossing to proceed. Second, when sign epistasis occurs along real-

87

ized adaptive paths, individual alleles alternate between being beneficial or

88

deleterious as their genetic context evolves (Pollock et al., 2012; Shah et al.,

5

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

89

2015; Starr et al., 2018), which can create a “maze-like” landscape on which

90

adaptive evolution must backtrack by reverting alleles at some loci. In the

91

extreme case that such reversions occur repeatedly across many loci, astro-

92

nomically long adaptive paths may be required to reach even local fitness

93

peaks (Kaznatcheev, 2019).

94

Although a large body of empirical work has explored the local properties

95

of fitness landscapes (e.g. in the neighbourhood of some reference genotype)

96

(De Visser and Krug, 2014; Starr and Thornton, 2016), the global properties

97

of sign-epistatic fitness landscapes are still poorly understood (Kondrashov

98

and Kondrashov, 2015). While globally mapping empirical landscapes is

99

likely impossible, theoretical models should in principle allow global explo-

100

ration (Fragata et al., 2018). One influential global approach is to ana-

101

lyze randomly constructed epistatic landscapes, but the applicability of these

102

“random field models” (Stadler and Happel, 1999) to biological systems is

103

unclear.

104

Theoretical toy models grounded in the biophysics of macromolecules hold

105

more promise (Serohijos and Shakhnovich, 2014; Bastolla et al., 2017), but to

106

date have been only applied in limited ways to study global landscape proper-

107

ties. The simplest approach for studying large macromolecular landscapes is

108

to reduce fitness to a binary of “functional” and “non-functional” genotypes,

109

creating a neutral network of functional genotypes connected by mutation

110

(Maynard Smith, 1970). Global landscape structure then becomes a matter

111

of evolutionary accessibility via neutral mutations among equivalently-high-

112

fitness genotypes (Lipman and Wilbur, 1991; Wilke, 2001) (see Gavrilets
6

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

113

(1999) for a similar approach applied at the organismal level). Even when

114

this reduction to binary fitness is not made, many theoretical models focus

115

on neutral landscape features such as mutational robustness (Van Nimwe-

116

gen et al., 1999) and extended periods of neutral meandering (Fontana and

117

Schuster, 1998; Ancel and Fontana, 2000). Consequently, far less is known

118

about the global topography of fitness differences, even within the specific

119

setting of macromolecules (Kondrashov and Kondrashov, 2015).

120

In particular, our understanding of how local peaks and mazes may im-

121

pact evolution over long evolutionary trajectories — as might occur over the

122

long-timescale global ascent from low to high fitness — is still rudimentary.

123

Recent empirical studies suggest the existence of long-term trends in pro-

124

tein evolution, specifically an increase in hydrophobicity and a decrease in

125

the clustering of hydrophobic amino acids along the primary sequence (Foy

126

et al., 2019). The long timescale of these observed trends could conceivably

127

be explained by slow valley-crossing processes (pervasive peaks) (Guo et al.,

128

2019), or long adaptive paths (mazes), or a combination of these. Studies of

129

macromolecular epistatic fitness landscapes with a global emphasis on long

130

evolutionary paths should help to resolve such issues.

131

Here we investigate the global fitness landscape of an evolving protein

132

using a computational lattice model to evaluate the mapping from amino

133

acid sequence to molecular fitness. We evaluate thousands of adaptive tra-

134

jectories to explore how difficult it is to reach high fitness, the diversity of

135

high-fitness local peaks reached, the extent to which local peaks obstruct

136

adaptation, and the prevalence of maze-like behavior. In response to the
7

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

137

empirical results of Foy et al. (2019), we also explore whether our model is

138

capable of generating long-term directional changes in sequence properties

139

like hydrophobic clustering.

140

Following the classic approach of (Lau and Dill, 1989), our model groups

141

amino acids as either hydrophobic (H) or polar (P) and maps protein struc-

142

ture onto a square lattice. Previous applications of HP lattice models to

143

protein evolution have adopted a neutral network approach of focusing on

144

“functional” amino acid sequences that have unique lowest-free-energy “na-

145

tive” conformations and evaluating whether such sequences are mutationally

146

connected (Lipman and Wilbur, 1991; Chan and Bornberg-Bauer, 2002). Our

147

approach differs in two respects.

148

First, we do not define fitness in terms of the existence of native confor-

149

mations, which precludes all but the highest fitness HP sequences, and which

150

requires extensive computational sampling of each sequence’s structural pos-

151

sibilities, necessitating the use of short sequences (of order ∼ 20 residues).

152

Instead, we implement a hydrophobic zipping algorithm that efficiently sam-

153

ples the molecular products of any sequence by simulating the kinetics of

154

protein folding.

155

Second, along with fold stability, our protein fitness metric also accounts

156

for the risk of inter-molecular aggregation. Aggregation risk is a crucial as-

157

pect of how proteins affect organismal fitness (DePristo et al., 2005; Levy

158

et al., 2012), with important consequences for the fitness landscape of HP

159

sequences. Since contacts between H residues are responsible for bonding

160

both within (stable folding) and between (aggregation) protein molecules,
8

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

161

there is a fundamental tradeoff between fold stability and aggregation po-

162

tential. Innovation is made more difficult because P→H mutations will often

163

cause both stability and aggregation potential to increase, and vice versa

164

for H→P mutations. Importantly, the stability-aggregation tradeoff can in-

165

duce sign epistasis as structural evolution changes each residue’s role. For

166

instance, previously shielded H residues can become exposed and present

167

an aggregation risk, while previously peripheral P residues selected for ag-

168

gregation avoidance might become situated in more structurally important

169

positions where an H residue would be better for stability. We find that

170

evolution on our stability-aggregation fitness landscape is characterized by

171

an abundance of local peaks and widespread maze-like behavior, causing

172

strong path-dependence, largely eliminating reproducibility of outcomes at

173

the sequence level, and frequently obstructing adaptive ascent to high fitness.

174

Despite these obstacles, evolution does often manage to reach high fitness.

175

Maze-like adaptive paths are created by pervasive sign epistasis, but are only

176

of order L steps long, much shorter than the extremely long O(2L ) paths that

177

are hypothetically possible on sign-epistatic landscapes (Kaznatcheev, 2019).

178

Adaptive paths that reach high fitness in our model can be seen as a series

179

of innovations that cumulatively do better than naively expected from the

180

intrinsic stability-aggregation tradeoff, a phenomenon that may apply more

181

broadly wherever evolutionary tradeoffs are present.

9

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

182

2

183

2.1

184

Methods
Hydrophobic zipper model of protein stability and
aggregation

185

We implement a two-dimensional HP lattice protein folding model. The

186

amino acid heteropolymer is modeled as “beads on a string”, where each

187

amino acid “bead” can be either hydrophobic (H) or polar (P). The allow-

188

able conformations of the heteropolymer are self-avoiding walks on a two-

189

dimensional square lattice (beads that are sequential neighbours must be

190

one lattice step apart, and each lattice position holds at most one bead).

191

To be biologically useful, folded heteropolymers must be both thermo-

192

dynamically stable and unlikely to aggregate with the other heteropolymers

193

in the cellular environment. Following the classic HP model (Lau and Dill,

194

1989), the thermodynamic stability of a conformation (free energy of fold-

195

ing) is assumed to be proportional to the number of contacts between H

196

monomers that are not sequential neighbours; this latter number we will

197

refer to as “stability” S. Similarly, we define the “aggregation potential”

198

A of a conformation as the number of potential H contacts that the con-

199

formation leaves exposed to bind to other molecules (Fig. 1). Combining

200

these together, we assign an overall stability/aggregation score F = S − A

201

to each conformation. The tradeoff between stability and aggregation (see

202

Introduction) implies that S and A are strongly pleiotropic.

203

We ensure that we are comparing the properties of sequences with the

10

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

204

same length L as follows. It is not sufficient to simply fix the number of

205

amino acids in the HP sequence, because sequences containing long runs of

206

P residues are effectively collections of fragments shorter than L in the HP

207

lattice zipper model. We therefore penalize fragmentation by setting S = 0

208

for zipped conformations that do not incorporate all L monomers in the

209

sequence.

210

We model the kinetic process taking the amino acid heteropolymer from

211

a disordered string to a folded globule as “hydrophobic zipping” (Dill et al.,

212

1993). Our implementation follows the algorithm outlined in Dill and Fiebig

213

(1994). The zipping process starts with an initial nucleation in which a pair

214

of H monomers that are sequentially nearby — 3 amino acids apart in our

215

square lattice model — form an H-H contact (Fig. 1). We assume that nu-

216

cleation occurs between the leftmost such pair in the sequence (e.g. because

217

folding begins before translation is complete; we return to this assumption

218

in the Discussion). The formation of the nucleating contact brings other H

219

monomers closer together, facilitating the formation of more H-H contacts.

220

Each new H-H contact is chosen randomly from among the set of candidate

221

H pairs that are possible given the current partially-zipped topology. To

222

identify candidate H pairs, Dijkstra’s shortest path algorithm is applied to

223

identify 3-step shortest paths connecting H residues on the graph of amino

224

acid beads (nodes) connected by sequence-adjacency and existing H-H con-

225

tacts (i.e. both solid and dotted lines in Fig. 1 are graph edges). A checking

226

procedure excludes candidate pairs incompatible with the topology of the

227

existing zipped structure. Zipping proceeds in this way until no further con11

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

228

tacts are possible. Since fragmented sequences are assumed to have S = 0

229

in order to compare only sequences of comparable length, we do not allow

230

further nucleation events after the initial one.

231

Hydrophobic zipping is a stochastic process because a given HP sequence

232

x may zip to different conformations depending on the order in which H-H

233

contacts form (Fig. 1). Consequently, F (x) is a random variable for each

234

sequence x. We define the overall “fitness” F (x) of x as the expectation of

235

F (x). Although F (x) is not a direct measure of organismal or protein per-

236

formance, and can even be negative, we use the term “fitness” for simplicity

237

since F (x) defines our fitness landscape. We estimate F (x) numerically by

238

computing F (x) for a sample of 1000 zipped conformations and taking the

239

sample mean.

240

Biophysically, hydrophobic zipping represents a rapid initial phase of con-

241

formational entropy loss (Dill et al., 1993). Zipping sometimes finds the low-

242

est free energy conformations possible for a given sequence, but in general

243

reaching the lowest free energy conformations requires breaking H-H con-

244

tacts formed during zipping, a process that would presumably require longer

245

timescales than the initial rapid collapse (Dill et al., 1993). Zipped con-

246

formations nevertheless approximate the lowest free energy conformations,

247

and are produced with sample frequencies that reflect kinetic accessibility.

248

With respect to aggregation, much of the aggregation risk associated with

249

the expression of a sequence could be attributable to these rapidly-formed

250

conformations.

12

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

13

Figure 1:

Hydrophobic zipping of the 10-monomer sequence HPPHPHH-

PPH (H: solid circles, P: hollow circles). Folding starts at the leftmost possible H-H contact (nucleation). Depending on the order in which H-H contacts
form (a stochastic process), it is possible that the zipper gets “stuck” before
much of the sequence is folded (left branch). Such sequences are regarded as
fragmented and assigned S = 0. Orange stars denote potential H contacts
contributing to the aggregation potential A. S is equal to the number of
non-sequential H-H contacts (dotted lines).

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

251

2.2

Sequence evolution

252

We simulate sequence evolution as an origin-fixation process. Each substi-

253

tutional step, we compute the fitnesses F (x) of the current sequence x as

254

well as the fitnesses F (x0 ) of all possible mutants x0 of x. We allow only

255

single H → P or P → H mutations. There are L such mutants where L is

256

sequence length. If fitter mutants are found to exist, one of them is chosen to

257

replace x. We implement two alternative decision rules: choosing the fittest

258

mutant and choosing a random fitter mutant. If all mutants are found to

259

have lower fitness than x, we re-estimate F (x) with a larger sample size and

260

again check if the previously estimated mutant fitnesses exceed F (x). If no

261

fitter mutants are found (a local peak), evolution is stopped; otherwise the

262

above is repeated on the chosen fitter mutant. The re-estimation of F (x)

263

helps to ensure that we do not unintentionally miss any beneficial mutations

264

due to sampling error in F (x).

265

We preclude mutations that create runs of three or more P monomers,

266

since these would jam the zipper before all L amino acids could be incorpo-

267

rated in the fold. We also initialize evolution on sequences that start and

268

end on H monomers and do not have runs of three or more P monomers, but

269

are otherwise randomly generated. We do not specify initial hydrophobicity;

270

instead, we vary the odds of H versus P monomers at each sequence position

271

to generate a broad range of initial hydrophobicities.

14

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

272

2.3

273

To connect our findings to the hydrophobic clustering results of Foy et al.

274

(2019) we use the same hydrophobic clustering metric, defined as follows.

275

Split an HP sequence of total length L into blocks of length l. In each block,

276

subtract the number of P residues from the number of H residues to obtain a

277

278

Hydrophobic clustering

block score n. Hydrophobic clustering is then given by Ψ = σ 2 (n)/K where

2 /l2 )
2
l
1
−
where
σ 2 (n) is the variance in n among blocks, and K = l L (1−n
2
L −L
L

279

n is the block mean n (Irbäck et al., 1996; Irbäck and Sandelin, 2000). Intu-

280

itively, Ψ is a modified dispersion index for the block scores n that accounts

281

for finite sequence length L (similar to Bessel’s correction for estimating vari-

282

ance from a finite sample). The expectation of Ψ for completely random HP

283

sequences with any L and any hydrophobocity is equal to 1 (Irbäck et al.,

284

1996; Irbäck and Sandelin, 2000). We use a block length of l = 3 and report

285

the average Ψ over the three possible block phases.

286

2.4

287

Data and source code for simulations and figures can be accessed at https:

288

//github.com/jasonbertram/HPzipper_folding_vs_aggregation.

Data availability

15

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

289

3

290

3.1

291

Results
Adaptive ascent from low-fitness random sequences
to high fitness

292

In this section, we examine the global topography of the fitness landscape

293

F (x) by simulating adaptive trajectories starting from different initial se-

294

quences generated randomly as described in Sec. 2.2. This gives a general

295

sense of how likely it is to ascend to high fitness, and how adaptive evolution

296

changes properties such as hydrophobicity and hydrophobic clustering. We

297

assume a best-case scenario in which the most beneficial mutation is substi-

298

tuted at each step such that the fitness landscape is ascended at the greatest

299

possible rate.

300

HP sequences can be divided into three qualitatively distinct groups re-

301

lated to their fitness F (x). The highest fitness sequences always incorporate

302

all L residues in their zipped conformations, and zip to only one or a few con-

303

formations (we call these sequences “complete”). The lowest fitness sequences

304

never zip to a complete conformation (we call these sequences “incomplete”).

305

“Intermediate” sequences only sometimes form a complete fold.

306

Our randomized initial sequences are almost always incomplete or in-

307

termediate, and have low fitness. The blue points in Fig. 2a-d show that

308

adaptive evolution from these initial sequences frequently terminates at in-

309

complete, low-fitness local peaks.

310

Evolution does nevertheless manage to reach high-fitness complete se-

16

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

311

quences. Initial sequences which evolve completeness do not start with higher

312

F (x) relative to other random initial sequences (Fig. 2a). Rather, it is the

313

specific combination of H and P residues that determines whether high fitness

314

is attainable. Local peaks that are complete sequences generally take more

315

adaptive steps to reach than those with incomplete sequences, but there is

316

considerable overlap in the adaptive path lengths (Fig. 2b). This means that

317

some complete sequences experience long ascents in which beneficial muta-

318

tions do not run out before reaching high fitness, whereas others attain high

319

fitness via relatively quick shortcuts. Initial sequences with low hydropho-

320

bicity rarely reach a complete local peak, while initially high hydrophobicity

321

improves the odds of reaching a complete sequence peak (Fig. 2c). However,

322

many simulations with high initial hydrophobicity evolve to intermediate

323

peaks short of completeness, indicating that reaching high fitness is also sen-

324

sitive to the exact sequence of H and P residues.

325

Despite the sensitivity of fitness outcomes to genetic background, HP

326

sequence evolution does exhibit consistent patterns. The highest fitness se-

327

quences all have hydrophobicity near ≈ 0.6 (Fig. 2d). Hydrophobicity tends

328

to decline over an adaptive trajectory, although a significant minority of in-

329

termediate peak sequences gain H residues (Fig. 2e). Adaptive evolution

330

also tends to reduce the within-sequence clustering of hydrophobic residues

331

(Section 2.3).

17

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

18

Figure 2:

Adaptive origin-fixation evolution to a local peak on the fitness

landscape F (x) defined as stability minus aggregation following HP zipper
folding. Complete sequences shown in red, incomplete sequences in blue, and
intermediate sequences in orange. When sample points exactly overlap, the
plotted circle is scaled proportional to the number of overlapping samples.
Hydrophobic clustering uses a window size of 3 and averages over the three
possible windowing phases. 1491 sequences of length L = 60 were evolved
selecting the fittest beneficial mutation for each substitution.

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

332

3.2

Evolutionary mazes

333

In this section, we investigate the path-dependence of adaptive evolution on

334

the stability-aggregation landscape F (x) by repeatedly initializing evolution

335

from the same sequence, but now picking a random beneficial mutation at

336

each step rather than the highest fitness one as in the previous section. To

337

ensure that it is possible to evolve completeness we choose a random initial

338

sequence with a relatively high hydrophobicity of 0.78 (see Fig. 2c).

339

The landscape F (x) exhibits strong path-dependence. Despite starting

340

from the same sequence, almost every adaptive path reached a different peak

341

spanning incompleteness to completeness, depending on the order and iden-

342

tity of beneficial mutations (Fig. 3a). Adaptive paths also exhibit substantial

343

“backtracking”, with total adaptive path length significantly exceeding the

344

number of HP differences between the initial and final sequences (Fig. 3b).

345

Taken together, these imply a maze-like landscape in which many poor path

346

choices exist leading to low-fitness dead-ends, and meandering adaptive walks

347

may be needed to reach high fitness due to alternation in the sign of muta-

348

tional effects along adaptive trajectories (Fig. 4).

349

Adaptive paths that terminate at incomplete peaks are distinguished by

350

the rapid removal of hydrophobic residues (Fig. 3c). This represents a lazy

351

strategy of reducing aggregation risk by simply reducing overall hydropho-

352

bicity, dooming the prospects of finding complete folds. Adaptive paths that

353

eventually attain completeness maintain H residues for longer, or even tran-

354

siently accumulate them. In spite of this, in the early stages of adaptation,

19

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

355

reductions in aggregation propensity A may still be the main source of gains

356

in fitness F (Fig. 4). These paths therefore represent an ambitious strategy

357

of tinkering with the fold to both reduce aggregation propensity and increase

358

stability.

359

4

360

We have shown that an HP lattice protein stability-aggregation fitness land-

361

scape exhibits pervasive sign epistasis, resulting in a high density of local

362

peaks, evolutionary mazes, and strong path-dependence of evolutionary out-

363

comes. One of the sources of sign epistasis in our model is that mutations can

364

change the zipped conformations of a sequence in such a way that a residue

365

that was buried in the protein core might now be exposed to the solvent. For

366

an H residue, this will often mean switching from having a beneficial stabi-

367

lizing role to posing a deleterious aggregation risk, and conversely for a P

368

residue. Previous HP lattice models of protein evolution hinge on protein sta-

369

bility, not the intrinsic tradeoff between stability and aggregation and ways

370

to optimize both despite the tradeoff, and as a result have not captured the

371

full sign-switching repercussions of evolving different conformations (Lipman

372

and Wilbur, 1991; Chan and Bornberg-Bauer, 2002; Bloom et al., 2006).

Discussion

373

Despite the ruggedness of the stability-aggregation landscape, evolution

374

from low-fitness random initial sequences frequently reaches high fitness with-

375

out requiring valley crossing. These high-fitness adaptive paths may require

376

back-and-forth H↔P mutations at some loci, and may consequently be longer
20

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

21

Figure 3: Maze-like behavior in HP lattice protein evolution. Starting from
the same initial sequence, 987 sequences were evolved picking a random beneficial mutation at each step. (a) Many different evolutionary outcomes are
possible. (b) Adaptive paths exhibit backtracking (only complete sequences
shown for clarity; circle sizes proportional to number of sequences). (c) Evolution gets stuck at incomplete peaks (blue) when it focuses on removing
hydrophobic residues to reduce aggregation propensity.

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

22

Figure 4:

Example of a long (> L) adaptive path with backtracking. For

the first ≈ 15 substitutions, evolution primarily reduces aggregation without
reducing hydrophobicity. The chance of forming a complete fold then gradually increases, ultimately leading to completeness. Top left panel shows
that the preferred state of most residues changes, in some cases repeatedly
(highlighted with white lines). Beneficial mutations with ∆F ≥ 1 are yellow,
deleterious mutations with ∆F ≤ 1 are dark and close-to-neutral mutations
with |∆F | < 1 (whose scoring as beneficial/deleterious is more sensitive
to sampling noise) are green. Black dots show mutations that occur (randomly chosen from among mutations with ∆F > 0). Residues with extended
stretches of dark continuing to the peak have become “entrenched”. Evolving
HP sequence on top right.

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

377

than L. We therefore confirm, in a biologically-grounded model landscape,

378

the importance of mazes posited by Kaznatcheev (2019) on the basis of more

379

abstract landscape models. However, all of our adaptive paths are of order

380

L, much shorter than the O(2L ) paths that are hypothetically possible un-

381

der sign epistasis. Intuitively, the latter exponential paths would require an

382

amount of conformational rearrangement that is not consistent with gradu-

383

ally improving stability or aggregation potential at each adaptive step. Even

384

along maze-like paths, some alleles become critical for maintaining accumu-

385

lated fitness gains; further mutations at the corresponding loci are deleterious

386

(right panel in Fig. 4). Such “entrenchment” (McCandlish et al., 2016; Shah

387

et al., 2015; Ashenberg et al., 2013; Flynn et al., 2017; Starr et al., 2018)

388

makes exponential-length adaptive paths unlikely, at least at the level of

389

individual proteins.

390

One dimension in the fitness landscape — hydrophobicity — seems to

391

strongly determine how far (Hamming distance), and how high (fitness), it

392

is possible to move along adaptive paths. Complete evolved sequences tend

393

to start at higher hydrophobicity (Fig. 2c) and maintain high hydrophobic-

394

ity for longer (Fig. 3c) than incomplete sequences. Since the early stages

395

in the evolution of a random sequence will generally entail high conforma-

396

tional diversity, many H residues will not have consistent structural roles

397

and will therefore contribute little to expected stability S. It is beneficial

398

to replace these with P residues to reduce aggregation risk. However, since

399

H residues are the raw material needed to fold, this “lazy” strategy closes

400

off future avenues for innovation, potentially even committing evolution to
23

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

401

further H residue removal. By contrast, transiently retaining or even adding

402

H residues opens up conformational possibilities (a distinct mechanism from

403

adding “surplus” stability to enable a stability-reducing innovation (Bloom

404

et al., 2006)). This “industrious” strategy requires finding mutations that

405

put the present H residues to better structural use.

406

Similar observations apply to hydrophobic clustering, which is strongly

407

positively correlated with hydrophobicity both among initial sequences and

408

following adaptive evolution. This correlation arises because, for most values

409

of hydrophobicity, successful folding requires H residues to be more uniformly

410

distributed than random along the sequence. For instance, among the ran-

411

domly generated initial sequences, we require that no two H residues be more

412

than three residues apart as this would surely cause zipping to fail (Section

413

2.2). Since lower hydrophobicity means fewer H residues to go around, lower

414

hydrophobicity sequences will therefore tend to have lower clustering.

415

Remarkably, although evolutionary outcomes in our model are highly

416

non-reproducible, even at the coarse level of fitness F (Fig. 3), both hy-

417

drophobicity and hydrophobic clustering ultimately decline for almost all

418

complete sequences (Fig. 2e,f). This appears to be a generic consequence

419

of improving the consistency (chance to form a complete fold) of folding,

420

since increases in hydrophobic clustering primarily occur in “intermediate”

421

sequences which have high final hydrophobicity and, consequently, high con-

422

formational diversity. This may help to explain the long-term declines in

423

hydrophobic clustering inferred empirically by Foy et al. (2019).

424

Our HP zipping model shares the usual disclaimer of all HP lattice mod24

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

425

els — though grossly simplifying reality, they nevertheless capture essential

426

aspects of how protein folding is driven by contact between hydrophobic

427

residues subject to conformational constraints (Dill and Fiebig, 1994). Our

428

zipping model makes additional assumptions which add further caveats. It

429

seems unlikely that our assumption of a single, fixed nucleation site applies to

430

real proteins. In principle our findings could be sensitive to this assumption

431

since it closes off adaptive paths whereby separately nucleated “subdomains”

432

separated by disordered regions gradually combine into larger “complete”

433

structures. However, we find that this scenario almost never occurs: in sim-

434

ulations where multiple nucleations are allowed, adaptive evolution almost

435

always reaches a local peak consisting of a fragmented string of small (∼ 10

436

residues), highly-stable, independently nucleated structures. A related caveat

437

is precluding H-H contacts from breaking once they have formed, which if

438

allowed in a more sophisticated kinetic model might provide ways for sep-

439

arately nucleated substructures to merge. While we cannot rule out such

440

possibilities, it seems plausible that the outcome of the rapid initial phase

441

of folding representing by zipping is a good indicator of the stability and

442

aggregation properties of a sequence.

443

The stability-aggregation tradeoff creates an evolutionary quandary in

444

which mutations that increase (decrease) a positive attribute (stability) of-

445

ten also increase (decrease) a negative attribute (aggregation propensity).

446

Beneficial mutations will consequently often only constitute a small propor-

447

tion of all possible mutations (Fig. 4). Moreover, as with any evolutionary

448

tradeoff, some of these beneficial mutations only improve the balance be25

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

449

tween the two sides of the tradeoff (e.g. by gaining more in stability than

450

aggregation potential). Given these constraints on adaptation, how are long

451

adaptive trajectories leading from globally-low to globally-high fitness possi-

452

ble? The answer is that the quandary between stability and aggregation is

453

not a strict tradeoff: there exist (rare) mutations that are able to escape the

454

status quo or even represent a “win-win” (both gaining stability and lowering

455

aggregation potential).

456

It seems plausible that fitness landscapes with similar “improvable trade-

457

off” properties could occur more widely than the protein folding landscape

458

studied here. The stability-aggregation tradeoff in our model is an example

459

of “frustration” caused by competing interactions (Wolf et al., 2018). Frus-

460

tration seems to be a universal feature of biological macromolecules (Ferreiro

461

et al., 2014, 2018), where competition occurs between the tendency to engage

462

in beneficial interactions and the tendency to engage in deleterious interac-

463

tions, i.e. between affinity and specificity. Competition between affinity and

464

specificity also constrains evolution at the cellular level of protein-protein

465

interaction networks; similar to our findings, evolutionary adaptation can

466

still occur by adjusting the fitness consequences of this inescapable conflict

467

Heo et al. (2011). More broadly, frustration effects occur across scales of

468

biological organisation, as evidenced by the ubiquity of tradeoffs (Wolf et al.,

469

2018). The prevalence of constraint-breaking mutations is less apparent,

470

but environmental change, which is also ubiquitous, can act as a transient

471

constraint-breaker (De Vos et al., 2015). Our protein fitness landscape model

472

can thus be viewed as a case study of the evolutionary effects of frustration,
26

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

473

with lessons that may extend well beyond protein evolution.

474

References

475

L. W. Ancel and W. Fontana. Plasticity, evolvability, and modularity in

476

RNA. Journal of Experimental Zoology, 288(3):242–283, 2000.

477

O. Ashenberg, L. I. Gong, and J. D. Bloom. Mutational effects on stability

478

are largely conserved during protein evolution. Proceedings of the National

479

Academy of Sciences, 110(52):21071–21076, 2013.

480

U. Bastolla, Y. Dehouck, and J. Echave. What evolution tells us about

481

protein physics, and protein physics tells us about evolution. Current

482

opinion in structural biology, 42:59–66, 2017.

483

J. D. Bloom, S. T. Labthavikul, C. R. Otey, and F. H. Arnold. Protein

484

stability promotes evolvability. Proceedings of the National Academy of

485

Sciences, 103(15):5869–5874, 2006.

486

487

488

489

H. S. Chan and E. Bornberg-Bauer. Perspectives on protein evolution from
simple exact models. Applied bioinformatics, 50(3):121–144, 2002.
J. A. G. De Visser and J. Krug. Empirical fitness landscapes and the predictability of evolution. Nature Reviews Genetics, 15(7):480, 2014.

490

M. G. De Vos, A. Dawid, V. Sunderlikova, and S. J. Tans. Breaking evo-

491

lutionary constraint with a tradeoff ratchet. Proceedings of the National

492

Academy of Sciences, 112(48):14906–14911, 2015.
27

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

493

M. A. DePristo, D. M. Weinreich, and D. L. Hartl. Missense meanderings in

494

sequence space: a biophysical view of protein evolution. Nature Reviews

495

Genetics, 6(9):678, 2005.

496

K. A. Dill and K. M. Fiebig. Hydrophobic zippers: A conformational search

497

strategy for proteins. In Statistical Mechanics, Protein Structure, and

498

Protein Substrate Interactions, pages 109–113. Springer, 1994.

499

K. A. Dill, K. M. Fiebig, and H. S. Chan. Cooperativity in protein-folding

500

kinetics. Proceedings of the National Academy of Sciences, 90(5):1942–

501

1946, 1993.

502

503

504

505

D. U. Ferreiro, E. A. Komives, and P. G. Wolynes.

Frustration in

biomolecules. Quarterly reviews of biophysics, 47(4):285–363, 2014.
D. U. Ferreiro, E. A. Komives, and P. G. Wolynes. Frustration, function and
folding. Current opinion in structural biology, 48:68–73, 2018.

506

W. F. Flynn, A. Haldane, B. E. Torbett, and R. M. Levy. Inference of

507

epistatic effects leading to entrenchment and drug resistance in hiv-1 pro-

508

tease. Molecular biology and evolution, 34(6):1291–1306, 2017.

509

510

W. Fontana and P. Schuster. Continuity in evolution: on the nature of
transitions. Science, 280(5368):1451–1455, 1998.

511

S. G. Foy, B. A. Wilson, J. Bertram, M. H. Cordes, and J. Masel. A shift

512

in aggregation avoidance strategy marks a long-term direction to protein

513

evolution. Genetics, 211(4):1345–1355, 2019.
28

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

514

I. Fragata, A. Blanckaert, M. A. D. Louro, D. A. Liberles, and C. Bank.

515

Evolution in the light of fitness landscape theory. Trends in ecology &

516

evolution, 2018.

517

518

S. Gavrilets. A dynamical theory of speciation on holey adaptive landscapes.
The American Naturalist, 154(1):1–22, 1999.

519

Y. Guo, M. Vucelja, and A. Amir. Stochastic tunneling across fitness val-

520

leys can give rise to a logarithmic long-term fitness trajectory. Science

521

Advances, 5(7):eaav3842, 2019.

522

M. Heo, S. Maslov, and E. Shakhnovich. Topology of protein interaction

523

network shapes protein abundances and strengths of their functional and

524

nonspecific interactions. Proceedings of the National Academy of Sciences,

525

108(10):4258–4263, 2011.

526

527

A. Irbäck and E. Sandelin. On hydrophobicity correlations in protein chains.
Biophysical Journal, 79(5):2252–2258, 2000.

528

A. Irbäck, C. Peterson, and F. Potthast. Evidence for nonrandom hydropho-

529

bicity structures in protein chains. proceedings of the National Academy of

530

Sciences, 93(18):9533–9538, 1996.

531

532

533

A. Kaznatcheev. Computational complexity as an ultimate constraint on
evolution. Genetics, page 302000, 2019.
D. A. Kondrashov and F. A. Kondrashov. Topological features of rugged

29

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

534

fitness landscapes in sequence space. Trends in Genetics, 31(1):24–33,

535

2015.

536

K. F. Lau and K. A. Dill. A lattice statistical mechanics model of the confor-

537

mational and sequence spaces of proteins. Macromolecules, 22(10):3986–

538

3997, 1989.

539

E. D. Levy, S. De, and S. A. Teichmann. Cellular crowding imposes global

540

constraints on the chemistry and evolution of proteomes. Proceedings of

541

the National Academy of Sciences, 109(50):20461–20466, 2012.

542

D. J. Lipman and W. J. Wilbur. Modelling neutral and selective evolution

543

of protein folding. Proceedings of the Royal Society of London. Series B:

544

Biological Sciences, 245(1312):7–11, 1991.

545

546

547

548

J. Maynard Smith. Natural selection and the concept of a protein space.
Nature, 225(5232):563, 1970.
D. M. McCandlish, P. Shah, and J. B. Plotkin. Epistasis and the dynamics
of reversion in molecular evolution. Genetics, 203(3):1335–1351, 2016.

549

D. D. Pollock, G. Thiltgen, and R. A. Goldstein. Amino acid coevolution

550

induces an evolutionary stokes shift. Proceedings of the National Academy

551

of Sciences, 109(21):E1352–E1359, 2012.

552

A. W. Serohijos and E. I. Shakhnovich. Merging molecular mechanism and

553

evolution: theory and computation at the interface of biophysics and evo-

30

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

554

lutionary population genetics. Current opinion in structural biology, 26:

555

84–91, 2014.

556

P. Shah, D. M. McCandlish, and J. B. Plotkin. Contingency and entrench-

557

ment in protein evolution under purifying selection. Proceedings of the

558

National Academy of Sciences, 112(25):E3226–E3235, 2015.

559

560

561

562

P. F. Stadler and R. Happel. Random field models for fitness landscapes.
Journal of Mathematical Biology, 38(5):435–478, 1999.
T. N. Starr and J. W. Thornton. Epistasis in protein evolution. Protein
Science, 25(7):1204–1218, 2016.

563

T. N. Starr, J. M. Flynn, P. Mishra, D. N. Bolon, and J. W. Thornton.

564

Pervasive contingency and entrenchment in a billion years of hsp90 evolu-

565

tion. Proceedings of the National Academy of Sciences, 115(17):4453–4458,

566

2018.

567

E. Van Nimwegen, J. P. Crutchfield, and M. Huynen. Neutral evolution of

568

mutational robustness. Proceedings of the National Academy of Sciences,

569

96(17):9716–9720, 1999.

570

D. M. Weinreich, R. A. Watson, and L. Chao. Perspective: sign epistasis and

571

genetic costraint on evolutionary trajectories. Evolution, 59(6):1165–1174,

572

2005.

573

574

C. O. Wilke. Adaptive evolution on neutral networks. Bulletin of mathematical biology, 63(4):715–730, 2001.
31

bioRxiv preprint doi: https://doi.org/10.1101/776450; this version posted September 19, 2019. The copyright holder for this preprint (which was
not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available
under aCC-BY-NC-ND 4.0 International license.

575

Y. I. Wolf, M. I. Katsnelson, and E. V. Koonin. Physical foundations of

576

biological complexity. Proceedings of the National Academy of Sciences,

577

115(37):E8678–E8687, 2018.

578

579

S. Wright. The roles of mutation, inbreeding, crossbreeding, and selection in
evolution, volume 1. na, 1932.

32

