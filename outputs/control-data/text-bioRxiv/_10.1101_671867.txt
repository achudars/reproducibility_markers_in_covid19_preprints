bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

1

A young age of subspecific divergence in the desert locust, Schistocerca gregaria

2
3

Marie-Pierre Chapuis1,2, Louis Raynal3,4, Christophe Plantamp5, Christine N. Meynard6, Laurence

4

Blondin7, Jean-Michel Marin3,4 and Arnaud Estoup4,6

5
6

1

CIRAD, CBGP, Montpellier, France.

7

2

CBGP, CIRAD, INRA, IRD, Montpellier SupAgro, Univ Montpellier, Montpellier, France.

8

3

IMAG, Univ de Montpellier, CNRS, Montpellier, France.

9

4

Institut de Biologie Computationnelle (IBC), Montpellier, France.

10

5

ANSES, Laboratoire de Lyon, France.

11

6

CBGP, INRA, CIRAD, IRD, Montpellier SupAgro, Univ Montpellier, Montpellier, France.

12

7

CIRAD, BGPI, Montpellier, France.

13
14
15

Corresponding author: Marie-Pierre Chapuis, marie-pierre.chapuis@cirad.fr

16
17

Keywords: Approximate Bayesian Computation; colonization; desert locust; divergence time; Holocene;

18

Orthoptera; paleo-vegetation; Random Forest; Schistocerca gregaria

19
20
21

Short title: Evolutionary history of Schistocerca gregaria

1

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

22

Abstract

23

Dating population divergence within species from molecular data and relating such dating to

24

climatic and biogeographic changes is not trivial. Yet it can help formulating evolutionary

25

hypotheses regarding local adaptation and future responses to changing environments. Key issues

26

include statistical selection of a demographic and historical scenario among a set of possible

27

scenarios, and estimation of the parameter(s) of interest under the chosen scenario. Such inferences

28

greatly benefit from new statistical approaches including Approximate Bayesian Computation -

29

Random Forest (ABC-RF), the later providing reliable inference at a low computational cost, with

30

the possibility to take into account prior knowledge on both biogeographical history and genetic

31

markers. Here, we used ABC-RF, including independent information on evolutionary rate and

32

pattern at microsatellite markers, to decipher the evolutionary history of the African arid-adapted

33

pest locust, Schistocerca gregaria. We found that the evolutionary processes that have shaped the

34

present geographical distribution of the species in two disjoint northern and southern regions of

35

Africa were recent, dating back 2.6 Ky (90% CI: 0.9 – 6.6 Ky). ABC-RF inferences also supported

36

a southern colonization of Africa from a low number of founders of northern origin. The inferred

37

divergence history is better explained by the peculiar biology of S. gregaria, which involves a

38

density-dependent swarming phase with some exceptional spectacular migrations, rather than a

39

continuous colonization resulting from the continental expansion of open vegetation habitats during

40

the past Quaternary glacial episodes.

2

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

41

Introduction

42

As in other regions of the world, Africa has gone through several major episodes of climate change

43

since the early Pleistocene (deMenocal 1995 and 2004). During glaciation periods, the prevalent

44

climate was colder and drier than nowadays, and became more humid during warmer interglacial

45

periods. These climatic phases resulted in shifts of vegetation (Vivo and Carmignotto 2004) and are

46

most likely at the origin of the current isolation between northern and southern distributions of arid-

47

adapted species (Monod 1971). In Africa, at least fifty-six plant species show disjoint geographical

48

distributions in southern and northern arid areas (Monod 1971; Jurgens 1997; Lebrun 2001).

49

Similarly, a number of animal vertebrate species show meridian disjoint distributions on this

50

continent, including eight mammals and 29 birds (Monod 1971; de Vivo and Carmignotto 2004;

51

Lorenzen et al. 2012). The desert locust, Schistocerca gregaria, is among the few examples of

52

insect species distributed in two distinct regions along the north-south axis of Africa. Other known

53

disjunctions in insects are interspecific and concern species of the families Charilaidae (Orthoptera)

54

and Mythicomyiidae (Diptera), and of the genus Fidelia (Hymenoptera) (Le Gall et al. 2010).

55

Similarities in extant distributions of African arid-adapted species across divergent taxonomic

56

groups point to a common climatic history and an important role of environmental factors. Yet, to

57

our knowledge, studies relating evolutionary history and climatic history have rarely been carried

58

out in this continent (but see mitochondrial studies by Miller et al. 2011 on the ostrich, Atickem et

59

al. 2018 on the black-backed jackal, and Moodley et al. 2018 on the white rhinoceros).

60

Relating evolutionary and climatic histories often requires dating population differentiation

61

events so that species or subspecies divergence can be understood in a broad biogeographic context.

62

However, finding a reliable calibration to convert measures of genetic divergence into units of

63

absolute time is challenging, especially so for recent evolutionary events (Ho et al. 2008). Extra-

64

specific fossil calibration may lead to considerable overestimates of divergence times, but internal

65

fossil records are often lacking (Ho et al. 2008). A sensible approach is to use an evolutionary rate

66

estimated from sequence data of a related species for which internal calibration is available (Ho et
3

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

67

al. 2008). Unfortunately, on the African continent, fossils, such as radiocarbon-dated ancient

68

samples, remain relatively rare and are often not representative of modern lineages (e.g., Le Gall

69

2010 for insects). The lack of paleontological and archaeological records is partly due to their

70

fragility under the aridity conditions of the Sahara. The end-result is that the options to relate

71

population divergence to biogeographic events in this region are very limited. Finding a dating

72

strategy that does not rely on fossils would therefore constitute a key advance in understanding the

73

region’s biogeography.

74

In this context, the use of versatile molecular markers, such as microsatellite loci, for which

75

evolutionary rates can be obtained from direct observation of germline mutations in the species of

76

interest, represents a useful alternative. Microsatellite mutation rates exceed by several orders of

77

magnitude that of point mutation in DNA sequences, ranging from 10-6 to 10-2 events per locus and

78

per generation (Ellegren 2000). Such rates allow one to both observe mutation events in parent-

79

offspring segregation data of realistic sample size and to reconstruct the recent history of related

80

populations. However, the use of microsatellite loci to estimate divergence times at recent

81

evolutionary time-scales still needs to overcome significant challenges. Since microsatellite allele

82

sizes result from the insertion or deletion of single or multiple repeat units and are tightly

83

constrained, these markers can be characterized by high levels of homoplasy that can obscure

84

inferences about gene history (e.g., Estoup et al. 2002). In particular, at large time scales (i.e., for

85

distantly related populations), genetic distance values no longer follow a linear relationship with

86

time. Rather, they reach a plateau and therefore provide biased unreliable estimation of divergence

87

time over a certain time threshold (Takezaki and Nei 1996; Feldman et al. 1997; Pollock 1998).

88

Microsatellites remain informative with respect to divergence time only if the population split

89

occurs within the period of linearity with time (Feldman et al. 1997; Pollock 1998). The exact value

90

of the differentiation threshold above which microsatellite markers would no longer accurately

91

reflect divergence times will depend on constraints on allele sizes and population-scaled mutation

92

rates (Feldman et al. 1997; Pollock 1998). In this context, the Approximate Bayesian Computation 4

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

93

random forest (ABC-RF) approach recently proposed by Raynal et al. (2019) is a singular statistical

94

advance, allowing both to take into account prior knowledge on genetic markers and to compute

95

accuracy at a local (i.e., posterior) scale. Using this method, one can consider to evaluate the

96

divergence time threshold above which posterior estimates would become biased, and in this way

97

thoroughly evaluate the robustness of inferences.

98

The desert locust, S. gregaria, is a generalist herbivore that can be found in arid grasslands

99

and deserts in both northern and southern Africa (Figure 1a). In its northern range, the desert locust

100

is one of the most widespread and harmful agricultural pest species, with a very large potential

101

outbreak area, spanning from West Africa to Southwest Asia. The desert locust is also present in the

102

southwestern arid zone (SWA) of Africa, which includes South-Africa, Namibia, Botswana and

103

south-western Angola. The southern populations of the desert locust are termed S. g. flaviventris

104

and are geographically separated by nearly 2,500 km from populations of the nominal subspecies

105

from northern Africa, S. g. gregaria (Uvarov 1977). The isolation of S. g. flaviventris and S. g.

106

gregaria lineages was recently supported by highlighting distinctive mitochondrial DNA

107

haplotypes and male genitalia morphologies (Chapuis et al. 2016). Yet, the precise history of

108

divergence remains elusive.

109

The main objective of the present study is to unravel the historical and evolutionary

110

processes that have shaped the present disjoint geographical distribution of the desert locust and the

111

genetic variation observed both within and between populations of its two subspecies. To this aim,

112

we applied an ABC-RF approach and show its full potential to help discriminate between

113

alternative biogeographic scenarios. We first start by identifying a set of evolutionary alternatives

114

relevant to the species from African paleo-vegetation maps that reflect potential past distributions of

115

the desert locust. We then used molecular data obtained from microsatellite markers for which we

116

could obtain independent information on evolutionary rates and allele size constraints in the species

117

of interest from direct observation of germline mutations (Chapuis et al. 2015). We applied recently

118

available algorithms of the ABC-RF on our microsatellite population genetic data to compare a set
5

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

119

of thoroughly formalized and justified evolutionary scenarios and estimate the divergence time

120

between S. g. gregaria and S. g. flaviventris under the most likely of our scenarios. Finally, we

121

interpret our results in light of past vegetation cover and desert locust biology.

122
123

Results

124

Table 1 shows the values of the summary statistics obtained from the observed population dataset

125

consisting in two unstructured pooled samples of the subspecies S. g. gregaria and S. g. flaviventris,

126

A total of 170 individuals (i.e., 80 and 90 individuals for S. g. gregaria and S. g. flaviventris,

127

respectively) were genotyped at 23 microsatellite markers derived from either genomic DNA (14

128

loci) or messenger RNA (9 loci) resources (hereafter referred to as untranscribed and transcribed

129

microsatellite markers, respectively). The level of differentiation between the two subspecies (as

130

measured by the parameter FST) was 0.04 and 0.12 for untranscribed and transcribed microsatellite

131

markers, respectively. The level of genetic diversity was higher within S. g. gregaria (+7 and 14%

132

for the mean number of alleles and expected heterozygosity, respectively).

133
134

Formalization and choice of evolutionary scenarios

135

Using a rich corpus of vegetation data, we reconstructed the present time (Fig. 1c) and past time

136

(Figs. 1d-f) distribution ranges of S. gregaria in Africa, going back to the Last Glacial Maximum

137

period (LGM, 26 to 14.8 Ky ago). Maps of vegetation cover for glacial arid maximums (Figs. 1e

138

and 1f) showed an expansion of open vegetation habitats sufficient to make the potential range of

139

the species continuous from the Horn of Africa in the north-west to the Cape of Good Hope in the

140

south. Maps of vegetation cover for interglacial humid maximums (Fig. 1d) showed a severe

141

contraction of deserts. These maps helped us formalize twelve competing evolutionary scenarios

142

(Figure 2), as well as bounds of prior distributions for various parameters (see the section Prior

143

setting for divergence parameters in Materials and methods). The twelve competing scenarios were

144

generated by different combinations of presence vs. absence of three key evolutionary events that
6

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

145

we identified as having potentially played a role in setting up the observed disjoint distribution of

146

the two locust subspecies: (i) a long population size contraction in the ancestral population, due to

147

the reduction of open vegetation habitats during the interglacial periods, (ii) a bottleneck in the

148

southern subspecies S. g. flaviventris right after divergence, associated to a single long-distance

149

migration event of a small fraction of the ancestral population, and (iii) a discrete genetic admixture

150

event either unidirectional from S. g. gregaria into S. g. flaviventris, or bidirectional, in order to

151

consider the many climatic transitions of the last Quaternary.

152

ABC-RF analyses supported the same group of scenarios or the same best individual

153

scenario for all ten replicate analyses (Table 2). The classification votes and posterior probabilities

154

estimated for the observed microsatellite dataset were the highest for the groups of scenarios in

155

which (i) S. g. flaviventris experienced a bottleneck event at the time of the split (scenarios

156

SB+SCB+SBA+SCBA; average of 2829 votes out of 3,000 RF-trees; posterior probability = 0.926),

157

(ii)

158

SC+SCB+SCA+SCBA; 2035 of 3,000 RF-trees; posterior probability = 0.682), and (iii) no

159

admixture event occurred between populations after the split (scenarios S+SC+SB+SCB; 2013 of

160

3,000 RF-trees; posterior probability = 0.700). When considering the twelve scenarios separately,

161

the highest classification vote was for scenario SCB (1521 of 3,000 RF-trees), which congruently

162

excludes a genetic admixture event and includes a population size contraction in the ancestral

163

population as well as a bottleneck event at the time of divergence in the S. g. flaviventris subspecies.

164

The posterior probability of scenario SCB averaged 0.564 over the ten replicate analyses (Table 2).

165

Table S1.1 (Supplementary Material S1) shows that only two other scenarios (SB and SCBAU)

166

obtained at least 5% of the votes. The scenario SB included only a single bottleneck event in S. g.

167

flaviventris (mean of 15.7% of votes) and the scenario SCBAU included a bottleneck event in S. g.

168

flaviventris, a population size contraction in the ancestral population and an unidirectional genetic

169

admixture event from S. g. gregaria into S. g. flaviventris (mean of 10.8% of votes). All other

170

scenarios obtained less than 5% of the votes and were hence even more weakly supported.

the

ancestral

population

experienced

a

7

population

size

contraction

(scenarios

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

171

We found that the posterior error rates (i.e., 1 minus the posterior probabilities) were lower

172

than the prior error rates for the analyses considering either groups of scenarios based on the

173

presence (or not) of a bottleneck in S. g. flaviventris (i.e., 7.4% versus 19.0%) or the scenarios

174

separately (i.e., 43.6% versus 58.4%). For other groups of scenarios, the discrimination power was

175

similar at both the global (prior error rates) and local (posterior error rates) scales, with values

176

ranging from 26.1% to 32.1% (Table 2). Altogether, these results indicate that the observed dataset

177

belongs to a region of the data space where the power to discriminate among scenarios is higher

178

than the global power computed over the whole prior data space, and that the presence or absence of

179

a bottleneck in S. g. flaviventris is the demographic event with the most robust prediction in our

180

ABC-RF treatments. These results can be visually illustrated by the projection of the reference table

181

datasets and the observed one on a single (when analyzing pairwise groups of scenarios) or on the

182

first two linear discriminant analysis (LDA) axes (when analyzing the twelve scenarios considered

183

separately) (Figure S1.1, Supplementary Material S1).

184

Figure S1.2, Supplementary Material S1, illustrates how RFs automatically rank the

185

summary statistics according to their level of information. It shows that the number and set of most

186

informative statistics is different depending on the comparisons (groups of scenarios or individual

187

scenarios). Two sample statistics that measure the amount of genetic variation shared between

188

populations (FST, DM2 and LIK) were among the most informative when discriminating among

189

groups of scenarios including or not an admixture event. For groups of scenarios differing by

190

population size variation events, statistics summarizing variation between the two subspecies

191

samples (FST and DM2 for the bottleneck event in S. g. flaviventris; DAS and LIK for the

192

population size contraction in the ancestral population) and statistics summarizing genetic variation

193

within subspecies samples (mean expected heterozygosity and mean number of alleles for both

194

population size variation events) were among the most discriminative ones. Only fifteen single

195

sample statistics were not informative (according to their position relatively to the noise statistics

196

added to our treatments) when considering the twelve individual scenarios separately. Most of those
8

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

197

non informative statistics were associated to the set of transcribed microsatellites (Figure S1.3,

198

Supplementary Material S1).

199
200

Parameter estimation under the best evolutionary scenario

201

Figure 3a shows point estimates with 90% credibility intervals of the posterior distribution of the

202

divergence time between the two subspecies under the best supported scenario SCB. Our

203

estimations point to a young age of subspecies divergence, with a median divergence time of 2.6 Ky

204

and a 90% credibility interval of 0.9 to 6.6 Ky, when assuming an average of three generations per

205

year (Roffey and Magor 2003; Table 3 and Table S1.2, Supplementary Material S1). The accuracy

206

of divergence time estimation was similar at both the global and local scales (i.e., normalized mean

207

absolute errors of 0.369 and 0.359, respectively; Table 3). Constraints on allele sizes in conjunction

208

with high population-scaled mutation rates potentially strongly affect the linearity of the

209

relationship between mutation accumulation and time of divergence estimated from microsatellite

210

data. We thus evaluated the accuracy of ABC-RF estimation of the population divergence time as a

211

function of the time scale, under scenario SCB. Analyses of pseudo-observed datasets showed that

212

the ABC-RF median estimate of divergence time reached a plateau for time scales ≥ 100,000

213

generations (Figure 4). Thus, the divergence time between S. g. flaviventris and S. g. gregaria

214

estimated on our real microsatellite dataset (~10,000 generations) is positioned within the period of

215

linearity with time, well before reaching a plateau reflecting a saturation of genetic information at

216

microsatellite markers. It is hence expected to represent a sensible estimation of the actual

217

divergence time.

218

Using the median as a point estimate, we estimated that the population size contraction in

219

the ancestor could have occurred at a time approximately three times older than the divergence time

220

between the subspecies (Table 3). Estimations of the ratio of stable effective sizes of the S. g.

221

gregaria and S. g. flaviventris populations (i.e., Nf / Ng) showed large 90% credibility intervals and

222

include the rate value of 1 (Table 3). Accuracy analysis indicates that our genetic data withhold
9

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

223

little information on this composite parameter (Table 3). The bottleneck intensity during the

224

colonization of south-western Africa (i.e., dbf / Nbf) shows the highest accuracy of estimation

225

(Table 3). The median of 1 and the 90% credibility interval of 0.5 to 2.4 exclude severe and mild

226

bottlenecks and support a strong to moderate event (Table 3).

227

The most informative summary statistics were different depending on the parameter of

228

interest (results not shown). For the time since divergence between the two subspecies, the most

229

informative statistics corresponded to the expected heterozygosity computed within the S. g.

230

flaviventris sample and the mean index of classification from S .g. flaviventris to S. g. gregaria

231

(Figure S1.4, Supplementary Material S1). The addition of noise variables in our treatments showed

232

that most statistics characterizing genetic variation within the S. g. gregaria sample were not

233

informative.

234
235

Discussion

236
237

A young age of subspecific divergence

238

With a 90% credibility interval of the posterior density distribution of the divergence time at 0.9 to

239

6.6 Ky, our ABC-RF analyses clearly point to a divergence of the two desert locust subspecies

240

occurring during the present Holocene geological epoch (0 to 11.7 Ky ago; Figure 3a). The

241

posterior median estimate (2.6 Ky) and interquartile range (1.8 to 3.7 Ky) postdated the middle-late

242

Holocene boundary (4.2 Ky). The latter past time boundary corresponds to the last transition from

243

humid to arid conditions in the African continent (Figure 3b). This increasing aridity was shown to

244

be a progressive change, with a concomitant maximum in northern and southern Africa at around 4

245

to 4.2 Ky ago, where aridity caused a contraction of the forest at its northern and southern

246

peripheries without affecting its core region (Guo et al. 2000; Maley et al. 2018). Interestingly, the

247

earliest archeological records of the desert locust found in Tin Hanakaten (Algeria) and Saqqara

248

(Egypt) archaeological sites date back to this period (Figure 3b; Meinzingen 1993; Malek 1997;
10

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

249

Aumassip 2002). Pollen records also showed that during this period the plant community was

250

dominated by the desert and semi-desert taxa found today, including some species of prime

251

importance for the current ecology of the desert locust (Kröpelin et al. 2008, Shi et al. 1998,

252

Duranton et al. 2012). Then, the past 4 Ky are thought to have been under environmental stability

253

and as dry as at present. One can therefore reasonably assume that, at the inferred divergence time

254

between the two locust subspecies, the connectivity between the two African hemispheres was still

255

limited by the moist equator, in particular at the west, and by the savannahs and woodlands of the

256

eastern coast (Figure 1c). Consequently, contrary to most phylogeographic studies on other African

257

arid-adapted species (Atickem et al. 2018, Moodley et al. 2018), it is unlikely that the rather ancient

258

Quaternary climatic history explained the Southern range extension of the desert locust.

259

Recent geological and palynological research has shown that a brief fragmentation of the

260

African primary forest occurred during the Holocene interglacial from 2.5 Ky to 2.0 Ky ago

261

(reviewed in Maley et al. 2018). This forest fragmentation period is characterized by relatively

262

warm temperatures and a lengthening of the dry season rather than an arid climate. Although this

263

period does not correspond to a phase of general expansion of savannas and grasslands, it led to the

264

opening of the Sangha River Interval (SRI) in the core of the tropical forest in Central Africa (see

265

Fig. 1 in Maley et al. 2018). The SRI corresponds to a 400 km wide (14–18° E) open strip

266

composed of savannas and grasslands dividing the rainforest in a north-south direction. The SRI

267

corridor is thought to have facilitated the southern migration of Bantu-speaking pastoralists, along

268

with cultivation of the semi-arid sub-Saharan cereal, pearl millet, Pennisetum glaucum (Schwartz

269

1992; Bostoen et al. 2015). The Bantu expansion took place between approximately 5 and 1.5 Ky

270

ago and reached the southern range of the desert locust, including northern Namibia for the Western

271

Bantu branch and southern Botswana and eastern South Africa for the Eastern Bantu branch

272

(Vansina 1995). We cannot exclude that the recent subspecific distribution of the desert locust has

273

been mediated by this recent ecological disturbance, which included a north-south corridor of open

274

vegetation habitats and the diffusion of agricultural landscapes through the Bantu expansion. The
11

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

275

progressive reappearance of forest vegetation 2 Ky ago would have then led to the present-day

276

isolation and subsequent genetic differentiation of the new southern populations from northern

277

parental populations. However, the level of climatic and habitat favorability of the SRI

278

environmental disturbance to the species, and thereby the likelihood of a south-eastern colonization

279

through the SRI corridor, remains to be evaluated in line with further data on this period.

280
281

On the role of dispersal on subspecific divergence

282

Our ABC-RF results indicate that a demographic bottleneck (i.e., a strong transitory reduction of

283

effective population size) occurred in the nascent southern subspecies of the desert locust. The high

284

posterior probability value (92.6%) shows that this evolutionary event could be inferred with strong

285

confidence. This result is compatible with the abovementioned colonization hypothesis if the

286

proportion of suitable habitats for the desert locust in the SRI corridor was low, strongly limiting

287

the carrying capacity during the time for range expansion. This scenario reduces, at the same time,

288

the likelihood of a successful colonization through the SRI corridor. A more plausible alternative

289

for a bottleneck event in S. g. flaviventris is a southern colonization of Africa through an

290

exceptional long-distance migration event. In winged migratory species, movements are assisted by

291

high velocity winds and may ascend to high altitudes (2000 m in the desert locust; Uvarov 1977)

292

(Pedgley et al. 1995). Although largest insects exert some control over their direction of migration

293

by flying actively, or at least gliding within (Pedgley et al. 1995), accidental displacements in wind

294

directions markedly different from that of seasonal dominant winds that assist migrations are likely.

295

Such accidental displacements at long-distance (i.e., a few to several thousand kms) were recorded

296

in a number of migratory species, such as cicadas, butterflies, moths and locusts (Pedgley et al.

297

1995; Lorenz, 2009).

298

To survive in its erratic arid and semi-arid habitat, the desert locust migrates downwind to

299

reach areas where rain has recently fallen and exploit newly available resources. The dynamics of

300

prevailing winds and pressure over Africa predicts the likelihood of a southeastern transport of
12

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

301

locusts (Nicholson 1996, Waloff and Pedgley 1986). In northern Africa, at least since 2.7Ky, the

302

strong northeast trade winds bring desert locust swarms equatorward in the moist intertropical

303

convergence zone (Figures 1a-b; Kröpelin et al. 1998). Most winds are westerlies (Figures 1a-b),

304

nevertheless easterly winds flow parallel to the eastern coast of Africa in northern winter (e.g.,

305

January; Figure 1b). In southern Africa, winds blow mostly from the north-east toward the extant

306

south-western distribution of the desert locust in southern winter (e.g., August; Figure 1a). In

307

agreement with this, southward movements of desert locust have been documented along the

308

eastern coast of Africa, in southern Tanzania during the plagues of 1926-1934, 1940-1948 and

309

1949-1963 (Waloff 1976), and even in Mozambique in January 1945 during the peak of the major

310

plague of 1940-1948 (Waloff 1966).

311

Furthermore, most travels off the range listed in the history of the desert locust were

312

associated with plague events (Waloff 1976), with other records including Portugal, the British Isles

313

and the famous trans-Atlantic crossing observed in October 1988, where large numbers of locusts

314

landed in the Caribbean islands (Richardson and Nemeth, 1991). Plagues typically culminate

315

several years of above average rainfall, resulting in abundant vegetation that supports both

316

cumulative locust population growth and full development of gregarious characteristics (Richardson

317

and Nemeth, 1991). The gigantic numbers (over a billion) of swarming locusts may facilitate the

318

success of long-distance migrations, in spite of high mortality. In addition, flight capacity and

319

endurance of the gregarious phase are remarkable, with swarms of winged adults regularly traveling

320

up to hundreds km in a day, in case of sudden lack of resources (Roffey and Magor 2003).

321

Therefore, out-of-range displacements of the desert locust may be explained by the synergistic

322

effects of exceptional environmental conditions (e.g., unusual winds in strength or direction, rain

323

favorable to plague) and peculiar biology of the gregarious phase of this species (e.g., swarming

324

behavior, huge numbers of dispersers).

325

In conclusion, dynamics of dominant winds in subtropical desert, historical records of

326

exceptional migrations in the desert locust, and the very robust prediction for the presence of a
13

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

327

bottleneck in S. g. flaviventris right after divergence by our ABC-RF treatments altogether support

328

that a single or a few swarm(s) from the Central region of the desert locust range sourced during a

329

plague the colonization of south-western Africa, suggesting for a role of dispersal in the disjoint

330

distribution and divergence of desert locust populations. Interestingly, an exceptional trans-Atlantic

331

flight of the desert locust from Africa to South America was revealed to give rise to the radiation of

332

some 50 Schistocerca species in the western hemisphere (Lovejoy et al., 2006).

333
334

On the influence of climatic cycles

335

It may appear surprising, at least at first sight, that the southern colonization of the desert locust did

336

not occur during one of the major glacial episodes of the last Quaternary cycle, since these periods

337

are characterized by a more continuous range of the desert locust (see paleo-vegetation maps in

338

Figures 1e-f). In particular, during the last glacial maximum (LGM, -14.8 Ky to -26 Ky), the Sahara

339

desert extended hundreds of km further South than at present and annual precipitation were lower

340

(i.e. ~200–1,000 mm/year). Several hypotheses explain why our evolutionary scenario choice

341

procedure provided low support to the possibility of a birth of the locust subspecies S. g. flaviventris

342

at older periods. First, we cannot exclude that our microsatellite genetic data allow making

343

inferences about the last colonization event only. Error rates at both local and global scales for the

344

choice of scenario groups including or not a genetic admixture event after the split indicated that

345

our discrimination power to infer this specific evolutionary event was poor (i.e., 32.1% and 30.0%

346

respectively, Table 2). The recent north-to-south colonization event selected by our ABC-RF

347

treatment may hence have blurred traces of older colonization events.

348

Second, while there is large evidence that much of Africa was drier during the last glacial

349

phase, this remains debated for southwestern Africa (see the gray coloration in Figure 3b). Some

350

climate models show that at least some parts of this region, such as the Kalahari Desert, may have

351

experienced higher rainfall than at present (Cockcroft 1987; Ganopolski et al. 1998; Chase and

352

Meadows 2007). Such regional responses to glacial cycles may have prolonged until the middle
14

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

353

Holocene. In particular, the northern Younger Dryas (i.e., -12.9 to -11.7 Ky) can be correlated only

354

partly with an arid period in the southern hemisphere (i.e., -14.4 to -12.5 Ky). Such older climate

355

episodes in antiphase between hemispheres (see the sandy brown coloration in Figure 3b) may have

356

prevented from either a successful north-to-south migration event or a successful establishment and

357

spread in the new southern range.

358

Third, although semi-desert and desert biomes were more expanded than at present during

359

the LGM, extreme aridity and lowered temperatures may have actually been unfavorable to the

360

species. For example, mean temperatures lowered by 5 to 6°C in both southern-western Africa

361

(Stute and Talma 1997) and Central Sahara (Edmunds et al. 1999).The maintenance of desert locust

362

populations depends on the proximity of areas with rainfalls at different seasons or with the

363

capacity to capture and release water. For instance, in the African northern range, breeding success

364

of locust populations relies on seasonal movements between the Sahel-Saharan zones of inter-

365

tropical convergence, where the incidence of rain is high in summer, and the Mediterranean-

366

Saharan transition zone, with a winter rainfall regime (Rainey and Waloff 1951). In addition, adult

367

migration and nymphal growth of the desert locust are dependent upon high temperature (Roffey

368

and Magor 2003). It is hence possible then that the conjunction of hyper-aridity with intense cold

369

could not easily support populations of the desert locust, despite the high extent of their migrations.

370

Interestingly, climatic reconstructions during the Last Glacial Maximum (LGM) indeed showed

371

dramatic decreases of mean temperature throughout all of Africa and of precipitation in the Sahelian

372

region (Figs. S2.3 and S2.4, Supplementary Material S2). Accordingly, species distribution

373

modelling showed a LGM distribution for the desert locust very similar to its current distribution

374

(Figs. S2.5, S2.6 and S2.7, Supplementary Material S2), excluding the hypothesis of a more

375

continuous range of the species at this time.

376

While ABC-RF analyses did not support that the Quaternary climatic history explained the

377

subspecific divergence in the desert locust, they provided evidence for the occurrence of a large

378

contraction of the size of the ancestral population preceding the divergence. Using the median as a
15

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

379

point estimate, we estimated that the population size contraction in the ancestor could have occurred

380

at a time about three fold older than the divergence time between the subspecies. This corresponds

381

to the African humid period in the early and middle stages of the Holocene, though the large

382

credibility interval also included the last interglacial period of the Pleistocene (Figure 3b). Such

383

population size contraction was likely induced by the severe(s) contraction(s) of deserts that

384

prevailed prior the estimated divergence between the two subspecies. Interestingly, these humid

385

periods were more intense and prolonged in northern Africa, which corresponded to the presumed

386

center of origin of the most recent common ancestor (Scott 1993; Partridge 1997; Shi et al. 1998).

387
388

Statistical advances by means of ABC Random Forest

389

To our knowledge, the present study is the first one using recently developed ABC-RF algorithms

390

(Raynal et al. 2019) to carry out inferences about parameter estimation on a real multi-locus

391

microsatellite dataset (for scenario choice see for example Rougemont et al. (2016) and Fraimout et

392

al. (2017)). When compared with various ABC solutions, this new RF method offers several

393

advantages: a significant gain in terms of robustness to the choice of the summary statistics,

394

independence from any type of tolerance level, and a good trade-off in terms of quality of point

395

estimator precision of parameters and credible interval estimations for a given computing time

396

(Raynal et al. 2019). The RF approach that we used here includes three novelties in statistical

397

analyses that were particularly useful for reconstructing the evolutionary history of the divergence

398

between S. g. gregaria and S. g. flaviventris subspecies. First, our ABC-RF statistical treatments

399

benefited from the incorporation of previous estimations of mutation rates and allele size constraints

400

for the microsatellite loci used in this study (for details see the Materials and methods section

401

Microsatellite dataset, mutation rate and mutational model). Microsatellite mutation rate and

402

pattern of most eukaryotes remains to a large extent unknown, and, to our knowledge, the present

403

study is a rare one where independent information on mutational features was incorporated into the

404

microsatellite prior distributions. Second, given the low RF computing time, we could simulate
16

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

405

large pseudo-observed datasets to compute error measures conditionally to a subset of fixed

406

divergence time values chosen to cover the entire prior interval. In this way, we showed that

407

posterior distributions for estimation of divergence time between the two subspecies accurately

408

reflected true divergence time values. Third, because error levels may differ depending on the

409

location of an observed dataset in the prior data space (e.g. Pudlo et al. 2016), prior-based indicators

410

are poorly relevant, aside from their use to select the best classification method and set of

411

predictors, here our summary statistics. Therefore, in addition to global prior errors, we computed

412

local posterior errors, conditionally to the observed dataset. The latter errors measure prediction

413

quality exactly at the position of the observed dataset. For parameter estimation accuracy, we

414

propose an innovative way to approximate local posterior errors, relying partly on out-of-bag

415

predictions and implemented in a new version of the R library abcrf (version 1.8) available on R

416

CRAN (see the Supplementary Material S3 for a detailed description). Such statistical advances are

417

of general interest and will be useful for any statistical treatments of massive simulation data,

418

including for inferences using single nucleotide polymorphisms (i.e,. SNPs) obtained from new

419

generation sequencing technologies.

420
421

Materials & Methods

422
423

Formalization of evolutionary scenarios

424

To help formalize the evolutionary scenarios to be compared, we relied on maps of vegetation

425

cover in Africa from the Quaternary Environment Network Atlas (Adams and Faure 1997). We

426

considered the periods representative of arid maximums (LGM and YD; Fig.1e-f, humid maximums

427

(HCO; Fig.1d), and present-day arid conditions (Fig.1c), for which reliable vegetation

428

reconstructions have been published. Desert and xeric shrubland cover fits well with the present-day

429

species range during remission periods. Tropical and Mediterranean grasslands were added

430

separately since the species inhabits such environments during outbreak periods only. The
17

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

431

congruence between present maps of species distribution (Fig.1a) and of open vegetation habitats

432

(Fig.1c) suggests that vegetation maps for more ancient periods could be considered as good

433

approximations of the potential range of the desert locust in the past (but see section ‘On the

434

influence of climatic cycles’ in the Discussion). Maps of vegetation cover during ice ages (Figs. 1e

435

and 1f) show an expansion of open vegetation habitats (i.e., grasslands in the tropics and deserts in

436

both the North and South of Africa) sufficient to make the potential range of the species continuous

437

from the Horn of Africa in North-West to the Cape of Good Hope in the South. Notice that we also

438

explored species distribution modelling for the HCO and LGM periods as an alternative to using

439

vegetation as a surrogate for the locust range (Supplementary Materials S2). However, distribution

440

modelling provided a narrower set of alternative hypotheses than the vegetation-based scenarios

441

mentioned above and are therefore not discussed any further.

442

Based on the above paleo-vegetation map reconstructions, we considered a set of alternative

443

biogeographic hypotheses formulated into different types of evolutionary scenarios. First, we

444

considered scenarios involving a more or less continuous colonization of southern Africa by the

445

ancestral population from a northern origin. In this type of scenario, effective population sizes were

446

allowed to change after the divergence event, without requiring any bottleneck event (i.e., without

447

any abrupt and strong reduction of population size) right after divergence. Second, we considered

448

the situation where the colonization of Southern Africa occurred through a single (or a few) long-

449

distance migration event(s) of a small fraction of the ancestral population. This situation was

450

formalized through scenarios that differed from a continuous colonization scenario by the

451

occurrence of a bottleneck event in the newly founded population. The bottleneck event occurred

452

into S. g. flaviventris right after divergence and was modelled through a limited number of founders

453

during a short period.

454

Because the last Quaternary cycle includes several arid climatic periods, including the

455

intense punctuation of the Younger Dryas (YD) and the last glacial maximum (LGM), we also

456

considered scenarios that incorporated the possibility of a discrete genetic admixture event, either
18

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

457

bidirectional or unidirectional from S. g. gregaria into S. g. flaviventris. Since previous tests based

458

on simulated data showed a poor power to discriminate between a single versus several admixture

459

events (results not shown), we considered only scenarios including a single admixture event.

460

Finally, at interglacial humid maximums, the map of vegetation cover showed a severe

461

contraction of deserts, which were nearly completely vegetated with annual grasses and shrubs and

462

supported numerous perennial lakes (Fig.1d; deMenocal et al. 2000). We thus considered the

463

possibility that vegetation-induced contractions of population sizes have pre-dated the separation of

464

the two subspecies. Hence, whereas so far scenarios involved a constant effective population size in

465

the ancestral population, we formalized alternative scenarios in which we assumed that a long

466

population size contraction event occurred into the ancestral population at a time tC, with an

467

effective population size NC for a duration dC.

468

Combining the presence or absence of the three above-mentioned key evolutionary events (a

469

bottleneck in S. g. flaviventris, a bidirectional or an unidirectional genetic admixture from S. g.

470

gregaria into S. g. flaviventris, and a population size contraction in the ancestral population)

471

allowed defining a total of twelve scenarios, that we compared using ABC-RF. The twelve

472

scenarios with their historical and demographic parameters are graphically depicted in Figure 2. All

473

scenarios assumed a northern origin for the common ancestor of the two subspecies and a

474

subsequent southern colonization of Africa. This assumption is supported by recent mitochondrial

475

DNA data showing that S. g. gregaria have higher levels of genetic diversity and diagnostic bases

476

shared with outgroup and congeneric species, whereas S. g. flaviventris clade was placed at the

477

apical tip within the species tree (Chapuis et al. 2016). In agreement with this assumption,

478

preliminary analyses based on observed data showed a low support for a southern origin for the

479

common ancestor of the two subspecies and a subsequent northern colonization of Africa (results

480

not shown).

481

All scenarios considered three populations of current effective population sizes Nf for S. g.

482

flaviventris, Ng for S. g. gregaria, and Na for the ancestral population, with S. g. flaviventris and S.
19

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

483

g. gregaria diverging tS generations ago from the ancestral population. The bottleneck event which

484

potentially occurred into S. g. flaviventris was modelled through a limited number of founders NB

485

during a short period dB. The potential unidirectional genetic admixture into S. g. flaviventris

486

occurred at a time tA, with a proportion rAU of genes of S. g. gregaria origin. (or rAB). In the case of

487

a bidirectional genetic admixture, still occurring at a time tA, the proportion of S. g. gregaria genes

488

entering into the S. g. flaviventris population was rAB and the proportion of S. g. flaviventris genes

489

entering into the S. g. gregaria population was 1- rAB. The potential population size contraction

490

event occurred into the ancestral population at a time tC, with an effective population size NC during

491

a duration dC.

492
493

Prior setting for historical and demographical parameters

494

Prior values for time periods between sampling and admixture, divergence and/or ancestral

495

population size contraction events (tC, tS and tA, respectively) were drawn from log-uniform

496

distributions bounded between 100 and 500,000 generations, with tC > tS > tA. Assuming an average

497

of three generations per year (Roffey and Magor 2003), this prior setting corresponds to a time

498

period that goes back to the second-to-latest glacial maximum (150 Ky ago) (de Vivo and

499

Carmignotto 2004, deMenocal et al. 2000). Preliminary analyses showed that assuming a uniform

500

prior shape for all time periods (instead of log-uniform distributions) do not change scenario choice

501

results, with posterior probabilities only moderately affected, and this despite a substantial increase

502

of out-of-bag prior error rates (e.g., + 50% when considering the twelve scenarios separately; Table

503

S4.1, Supplementary Material S4). Analyses of simulated pseudo-observed datasets (pods) showed

504

that assuming a uniform prior rather than a log-uniform prior for time period parameters would

505

have also biased positively the median estimate of the divergence time and substantially increased

506

its 90% credibility interval (Figure S4.1 and Table S4.2, Supplementary Material S4). Using a log-

507

uniform distribution remains a sensible choice for parameters with ranges of values covering

20

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

508

several if not many log-intervals, as doing so allows assigning equal probabilities to each of the log-

509

intervals.

510

We used uniform prior distributions bounded between 1x104 and 1x106 diploid individuals

511

for the different stable effective population sizes Nf, Ng and Na (Chapuis et al. 2014). The admixture

512

rate (i.e., the proportion of S. g. gregaria genes entering into the S. g. flaviventris population), was

513

drawn from a uniform prior distribution bounded between 0.05 and 0.50 for a unidirectional event

514

(rAU) and between 0.05 and 0.95 for a bidirectional event (rAB). We used uniform prior distributions

515

bounded between 2 and 100 for both the numbers of founders (in diploid individuals) and durations

516

of bottleneck events (in number of generations). For the contraction event, we used uniform prior

517

distributions bounded between 100 and 10,000 for both the population size NC (in diploid

518

individuals) and duration dC (in number of generations). Assuming an average of three generations

519

per year (Roffey and Magor 2003), such prior choice allowed a reduction in population size for a

520

short to a relatively long period, similar for instance to the whole duration of the HCO (from 9 to

521

5.5 Ky ago) which was characterized by a severe contraction of deserts.

522
523

Microsatellite dataset, mutation rate and mutational model

524

We carried out our statistical inference on the microsatellite dataset previously published in Chapuis

525

et al. (2016). The 23 microsatellite loci genotyped in that dataset were derived from either genomic

526

DNA (14 loci) or messenger RNA (9 loci) resources, and were hereafter referred to as untranscribed

527

and transcribed microsatellite markers (following Blondin et al. 2013). These microsatellites were

528

shown to be genetically independent, free of null alleles and at selective neutrality (Chapuis et al.

529

2016). Previous levels of FST (Weir 1996) and Bayesian clustering analyses (Pritchard et al. 2000)

530

among populations showed a weak genetic structuring within each subspecies (Chapuis et al. 2014,

531

2017). For each subspecies, we selected and pooled three population samples in order to ensure

532

both a large sample size (i.e., 80 and 90 individuals for S. g. gregaria and S. g. flaviventris,

533

respectively), while ensuring a non-significant genetic structure within each subspecies pooled
21

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

534

sample, as indicated by non-significant Fisher’s exact tests of genotypic differentiation among the

535

three initial population samples within subspecies and exact tests of Hardy-Weinberg equilibrium

536

for each subspecies pooled sample (i.e., P-value > 0.05; Genepop 4.0; Rousset 2008). More

537

precisely, the S. g. gregaria sample consisted in pooling the population samples 8, 15 and 22 of

538

Chapuis et al. (2014) and the S. g. flaviventris sample included the population samples 1, 2 and 6 of

539

Chapuis et al. (2017).

540

Mutations occurring in the repeat region of each microsatellite locus were assumed to follow

541

a symmetric generalized stepwise mutation model (GSM; Zhivotovsky et al. 1997; Estoup et al.

542

2002). Prior values for any mutation model settings were drawn independently for untranscribed

543

and transcribed microsatellites in specific distributions. Because allele size constraints exist at

544

microsatellite markers, we informed for each microsatellite locus their lower and upper allele size

545

bounds using values estimated in Chapuis et al. (2015), following the approach of Pollock et al.

546

(1998) and microsatellite data from several species closely related to S. gregaria (Blondin et al.

547

(2013). Prior values for the mean mutation rates (𝜇
̅̅̅)
𝑅 were set to the empirical estimates inferred

548

from observation of germline mutations in Chapuis et al. (2015), i.e., 2.8x10-4 and 9.1x10-5 for

549

untranscribed and transcribed microsatellites, respectively. The parameters for individual

550

microsatellites were then drawn from a Gamma distribution with mean = 𝜇
̅̅̅
𝑅 and shape = 0.7

551

(Estoup et al. 2001) for both types of microsatellites. We ensured that the chosen value of shape

552

parameter generated the same inter-loci variance as estimated in Sun et al. (2012) from direct

553

observations of thousands of human microsatellites. Prior values for the mean parameters of the

554

geometric distributions of the length in number of repeats of mutation events (𝑃̅) were set to the

555

proportions of multistep germline mutations observed in Chapuis et al. (2015), i.e., 0.14 and 0.67

556

for untranscribed and transcribed microsatellites, respectively. The P parameters for individual loci

557

were then standardly drawn from a Gamma distribution (mean = 𝑃̅ and shape = 2). We also

558

considered mutations that insert or delete a single nucleotide to the microsatellite sequence. To

559

model this mutational feature, we used the DIYABC default setting values (i.e., a uniform
22

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

560

distribution bounded between [10-8, 10-5] for the mean parameter ̅̅̅̅̅̅
𝜇𝑆𝑁𝐼 and a Gamma distribution

561

(mean = ̅̅̅̅̅̅
𝜇𝑆𝑁𝐼 and shape = 2) for individual loci parameters; Cornuet et al. 2010; see also DIYABC

562

user manual p. 13, http://www1.montpellier.inra.fr/CBGP/diyabc/).

563
564

Analyses using ABC Random Forest

565

We used the software DIYABC v.2.1.0 (Cornuet et al. 2014) to simulate datasets constituting the

566

so-called reference tables (i.e., records of a given number of datasets simulated using the scenario

567

ID and the evolutionary parameter values sampled from prior distributions and summarized with a

568

pool of statistics). Random-forest computations were then performed using a new version of the R

569

library

570

detailed in Pudlo et al. (2016), Raynal et al. (2019) and Estoup et al. (2018a) for scenario choice

571

and parameter estimation, as well as several statistical novelties allowing to compute error rates in

572

scenario choice and accuracy measures for parameter estimation (see details below). An overview

573

of the ABC-RF methods used in the present paper is provided in Supplementary Material S3.

574

Readers can also consult Pudlo et al. (2016), Rougemont et al. (2016), Fraimout et al. (2017),

575

Estoup et al. (2018a,b) and Marin et al. (2018) for scenario choice, and Raynal et al. (2019) for

576

parameter estimation to access to further detailed statistical descriptions, testing and applications of

577

ABC-RF algorithms.

ABCRF

(version 1.8) available on the CRAN. This version includes all ABC-RF algorithms

578

For scenario choice, the outcome of the first step of the ABC-RF statistical treatment applied

579

to a given target dataset is a classification vote for each scenario which represents the number of

580

times a scenario is selected in a forest of n trees. The scenario with the highest classification vote

581

corresponds to the scenario best suited to the target dataset among the set of compared scenarios.

582

This step also provides an error rate relevant to the entire prior sampling space, the global prior

583

error. See the section Global prior errors in Supplementary Material S2 for details. The second RF

584

analytical step provides a reliable estimation of the posterior probability of the best supported

585

scenario. One minus such posterior probability yields the local posterior error associated to the
23

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

586

observed dataset (see the section Local posterior errors in Supplementary Material S3). In practice,

587

ABC-RF analyses were processed by drawing parameter values into the prior distributions

588

described in the two previous sections and by summarizing microsatellite data using a set of 32

589

statistics (see Table 1 for details about such summary statistics) and the one LDA axis or eleven

590

LDA axes (i.e. number of scenarios minus 1; Pudlo et al. 2016) computed when considering

591

pairwise groups of scenarios or individual scenarios, respectively. We processed ABC-RF

592

treatments on reference tables including 150,000 simulated datasets (i.e., 12,500 per scenario).

593

Following Pudlo et al. (2016), we checked that 150,000 datasets was sufficient by evaluating the

594

stability of prior error rates and posterior probabilities estimations of the best scenario on 50,000,

595

80,000 and 100,000 and 130,000 simulated datasets (Table S1.3, Supplementary Material S1). The

596

number of trees in the constructed random forests was fixed to n = 3,000, as this number turned out

597

to be large enough to ensure a stable estimation of the prior error rate (Figure S1.5, Supplementary

598

Material S1). We predicted the best scenario and estimated its posterior probability and prior error

599

rate over ten replicate analyses based on ten different reference tables.

600

In order to assess the power of our approach to infer each specific evolutionary event of

601

interest, we first processed ABC-RF analyses by grouping scenarios based on the presence or

602

absence of each type of evolutionary event that we identified as having potentially played a role in

603

setting up the disjoint distribution of the two locust subspecies (e.g., Roux et al. 2016, Leroy et al.

604

2017 and Estoup et al. 2018a). We conducted ABC-RF treatments on three pairwise groups of

605

scenario (with four scenarios per group): groups of scenarios with vs. without a bottleneck in S. g.

606

flaviventris, groups with vs. without a population size contraction in the ancestral population, and

607

groups with vs. without an asymmetrical genetic admixture event from S. g. gregaria into S. g.

608

flaviventris. We then conducted ABC-RF treatments on the twelve scenarios considered separately.

609

For parameter estimation, we constructed ten independent replicate RF treatments based on

610

ten different reference tables for each parameter of interest (Raynal et al. 2019): the time since

611

divergence, the ratio of the time of the contraction event into the ancestral population on the time
24

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

612

since divergence, the intensity of the bottleneck event in the sampled S. g. flaviventris population

613

(defined as the ratio of the bottleneck event of duration dbf on the effective population size Nbf ) and

614

the ratio of the stable effective population size of the two sampled populations. For each RF

615

treatment, we simulated a total of 100,000 datasets for the selected scenario (drawing parameter

616

values into the prior distributions described in the two previous sections and using the same 32

617

summary statistics). Following Raynal et al. (2019), we checked that 100,000 datasets was

618

sufficient by evaluating the stability of the measure of accuracy on divergence time estimation using

619

50,000, 80,000 and 90,000 simulated datasets (Table S1.4, Supplementary Material S1). The

620

number of trees in the constructed random forests was fixed to n = 2,000, as such number turned out

621

to be large enough to ensure a stable estimation of the measure of divergence time estimation

622

accuracy (Figure S1.6, Supplementary Material S1). For each RF treatment, we estimated the

623

median value and the 5% and 95% quantiles of the posterior distributions. It is worth noting that we

624

considered median values as the later provided more accurate estimations (according to out-of-bag

625

predictions) than when considering mean values (results not shown). Accuracy of parameter

626

estimation was measured using out-of-bag predictions and the normalized mean absolute error

627

(NMAE). NMAE corresponds to the mean of the absolute difference between the point estimate

628

(here the median) and the (true) simulated value divided by the simulated value (formula detailed in

629

Supplementary Material S3).

630

Finally, because microsatellite markers tend to underestimate divergence time for large time

631

scales due to allele size constraints, we evaluated how the accuracy of ABC-RF estimation of the

632

time of divergence between the two subspecies was sensitive to the time scale. To this aim, we used

633

DIYABC to produce pseudo-observed datasets assuming fixed divergence time values chosen to

634

cover the prior interval (100 ; 250 ; 500; 1,000 ; 2,500; 5,000 ; 10,000 ; 25,000 ; 50,000; 100,000;

635

250,000 generations) and using the best scenario. We simulated 5,000 of such test datasets for each

636

of the eleven divergence time values. Each of these test dataset was treated using ABC-RF in the

637

same way as the above target observed dataset.
25

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

638
639

Acknowledgements

640

This work was supported by research funds from the French Agricultural Research Centre for

641

International Development (CIRAD), the project ANR-16-CE02-0015-01 (SWING), the INRA

642

scientific department SPE (AAP-SPE 2016), and the Labex NUMEV (NUMEV, ANR10-LABX-

643

20). The data used in this work were partly produced through the technical facilities of the Centre

644

Méditerranéen Environnement Biodiversité, Montpellier. We are grateful to Pierre-Emmanuel Gay

645

for assistance with maps, and Antoine Foucart, Gauthier Dobigny and Jean-Yves Rasplus for

646

fruitful discussions. We thank Michael D. Greenfield and two anonymous reviewers for

647

constructive and insightful comments on an earlier version of the manuscript.

648
649

Conflict of interest disclosure

650

The authors of this preprint declare that they have no financial conflict of interest with the content

651

of this article. Arnaud Estoup is one of the PCI Evolutionary Biology recommenders.

652
653

Data accessibility

654

Microsatellite genotypic data and R scripts for ABC-RF analyses are available at

655

https://dataverse.cirad.fr/.

656

26

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

657

References

658

Adams JM, Faure H (1997) (eds), QEN members. Review and Atlas of Palaeovegetation:

659

Preliminary land ecosystem maps of the world since the Last Glacial Maximum. Oak Ridge

660

National Laboratory, TN, USA.

661
662

Atickem A, Stenseth NC, Drouilly M, Bock S, Roos C, Zinner D (2018) Deep divergence among
mitochondrial lineages in African jackals. Zool Scripta, 47, 1-8.

663

Aumassip G (2002) L’algérie des premiers hommes. Ibis Press, 230 p.

664

Beaumont MA, Zhang W, Balding DJ (2002) Approximate Bayesian Computation in Population

665

Genetics. Genetics, 162, 2025–2035.

666

Blondin L, Badisco L, Pagès C, Foucart A, Risterucci AM, Bazelet CS, Vanden Broeck J, Song H,

667

Ould Ely S, Chapuis M-P (2013) Characterization and comparison of microsatellite markers

668

derived from genomic and expressed libraries for the desert locust. J Appl Entomol, 137,

669

673–683.

670
671

Bond G et al. (1997) A pervasive millenial-scale cycle in North Atlantic Holocene and Glacial
climates. Science, 278, 1257-1265.

672

Bostoen K, Clist B, Doumenge C, Grollemund R, Hombert JM, Muluwa JK, Maley J (2015) Middle

673

to Late Holocene paleoclimatic change and early Bantu expansion in the rain forests of

674

Western Central Africa. Curr Anthropol, 56, 354–384.

675

Breiman, L. (2001) Random Forests. Machine Learning, 45(1), 5–32.

676

Chapuis M-P, Bazelet CS, Blondin L, Foucart A, Vitalis R, Samways MJ. (2016) Subspecific

677

taxonomy of the desert locust, Schistocerca gregaria (Orthoptera: Acrididae), based on

678

molecular and morphological characters. Syst Entomol, 41, 516-530.

679

Chapuis M-P, Foucart A, Plantamp P, Blondin L, Leménager N, Benoit L, Gay P-E, Bazelet CS

680

(2017) Genetic and morphological variation in non-polyphenic southern African populations

681

of the desert locust. Afr Entomol, 25, 13-23.

27

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

682

Chapuis M.-P, Plantamp P, Blondin B, Pagès C, Vassal J.-M., Lecoq M (2014) Demographic

683

processes shaping genetic variation of the solitarious phase of the desert locust. Mol Ecol,

684

23, 1749–1763.

685

Chapuis M-P, Plantamp C, Streiff R, Blondin L, Piou C (2015) Microsatellite evolutionary rate and

686

pattern in Schistocerca gregaria inferred from direct observation of germline mutations. Mol

687

Ecol, 24, 6107-6119.

688
689
690
691
692
693

Chase BM, Meadows ME (2007) Late Quaternary dynamics of southern Africa’s winter rainfall
zone. Earth Sci Rev, 84, 103-138.
Chase BM et al. (2009) A record of rapid Holocene climate change preserved in hyrax middens
from SW Africa. Geology 37, 703-706.
Cockcroft MJ, Wilkinson MJ, Tyson PD (1987) The application of a present-day climatic model to
the Late Quaternary in southern Africa. Climate Change, 10, 161-181.

694

Cornuet J-M, Ravigne V, Estoup A (2010) Inference on population history and model checking

695

using DNA sequence and microsatellite data with the software DIYABC (v1.0). BMC

696

Bioinformatics, 11, 401.

697

Cornuet J-M, Pudlo P, Veyssier J, Dehne-Garcia A, Gautier M, Leblois R, Marin J-M, Estoup A

698

(2014) DIYABC v2.0: a software to make Approximate Bayesian Computation inferences

699

about population history using Single Nucleotide Polymorphism, DNA sequence and

700

microsatellite data. Bioinformatics, 30, 1187–1189.

701

deMenocal PB (1995) Plio-Pleistocene African climate, Science, 270, 53-59.

702

deMenocal PB, Ortiz J, Guilderson T, Adkins J, Sarnthein M, Baker L, Yarusinsky M (2000)

703

Abrupt onset and termination of the African Humid Period: Rapid climate response to

704

gradual insolation forcing. Quat Sci Rev, 19, 347-361.

705
706

deMenocal PB (2004) African climate change and faunal evolution during the Pliocene-Pleistocene.
Earth and Planetary Science Letters, 220, 3–24.

28

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

707

Dib C, Fauré S, Fizames C, Samson D, Drouot N, Vignal A, Millasseau P, Marc S, Hazan J, Seboun

708

E, et al. (1996) A comprehensive genetic map of the human genome based on 5264

709

microsatellites. Nature, 380, 152–154

710

Dupont LM (2011) Orbital scale vegetation change in Africa Quat Sci Rev, 30, 3589-3602.

711

Duranton JF, Foucart A, Gay P-E (2012) Florule des biotopes du criquet pèlerin en Afrique de

712

l'Ouest et du Nord-Ouest à l'usage des prospecteurs de la lutte antiacridienne. Rome : FAO,

713

487 p.

714
715
716
717
718
719

Edmunds WM, Fellman E, Goni IB (1999) Lakes, groundwater and palaeohydrology in the Sahel of
NE Nigeria: evidence from hydrogeochemistry. J Geol Soc Lond, 156, 345–355.
Ellegren H (2000) Microsatellite mutations in the germline: implications for evolutionary inference.
Trends Genet, 16, 551–558.
Estoup A, Jarne P, Cornuet J-M (2002) Homoplasy and mutation model at microsatellite loci and
their consequences for population genetics analysis. Mol Ecol, 11, 1591-1604.

720

Estoup A, Raynal L, Verdu P, Marin J-M (2018a) Model choice using Approximate Bayesian

721

Computation and Random Forests: analyzes based on model grouping to make inferences

722

about the genetic history of Pygmy human populations. J Soc Fr Statistique, 159, 167-190.

723

Estoup A, Verdu P, Marin J-M, Robert C, Dehne-Garcia A, Cornuet J-M, Pudlo P (2018b)

724

Application of approximate Bayesian computation to infer the genetic history of Pygmy

725

hunter-gatherers populations from Western Central Africa. Handbook of Approximate

726

Bayesian Computation. Chapman and Hall/CRC.

727

Estoup A, Wilson IJ, Sullivan C, Cornuet J-M, Moritz C (2001) Inferring population history from

728

microsatellite et enzyme data in serially introduced cane toads, Bufo marinus. Genetics, 159,

729

1671-1687.

730
731

Feldman MW, Bergman A, Pollock DD, Goldstein DB (1997) Microsatellite genetic distances with
range constraints: analytic description and problems of estimation. Genetics, 145, 207–216.

29

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

732

Fraimout A, Debat V, Fellous S, Hufbauer RA, Foucaud J, Pudlo P, Marin J-M, Price DK, Cattel J

733

et al. (2017). Deciphering the routes of invasion of Drosophila suzukii by means of ABC

734

random forest. Mol Biol Evol, 34(4), 980–996.

735

Ganopolski A, Rahmstorf S, Petoukohov V, Claussen M (1998) Simulation of modern and glacial

736

climates with a coupled global model of intermediate complexity. Nature, 391, 351-356.

737

Gasse F (2000) Hydrological changes in the African tropics since the Last Glacial Maximum. Quat

738
739
740
741
742
743
744
745
746
747
748

Sci Rev, 19, 189–211.
Goldstein DB, Linares AR, Cavalli-Sforza LL, Feldman MW (1995) An evaluation of genetic
distances for use with microsatellite loci. Genetics, 139, 463-471.
Guo Z, Petit-Maire N, Kroepelin S (2000) Holocene non-orbital climatic events in present-day arid
areas of northern Africa and China. Global Planet Change v.26 p.97-103.
Hijmans RJ, Cameron SE, Parra JL, Jones PG, Jarvis A (2005) Very high resolution interpolated
climate surfaces for global land areas. Int J Climatol, 25, 1965-1978.
Ho SY, Saarma U, Barnett R, Haile J, Shapiro B (2008) The Effect of Inappropriate Calibration:
Three Case Studies in Molecular Ecology. PLoS One, 3, e1615.
Jürgens N (1997) Floristic biodiversity and history of African arid regions. Biodiv Conserv, 6, 495514.

749

Kröpelin S, Verschuren D, Lézine A-M, Eggermont H, Cocquyt C, Francus P, Cazet JP, Fagot M,

750

Rumes B, Russel JM, et al. (2008). Climate-driven ecosystem succession in the Sahara: The

751

past 6000 years. Science, 320, 765–8.

752

Latinne A, Meynard CN, Herbreteau V, Waengsothorn S, Morand S, Michaux JR (2015) Influence

753

of past and future climate changes on the distribution of three Southeast Asian murine

754

rodents. J Biogeogr, 42, 1714-1726.

755

Lebrun JP (2001) Introduction à la flore d'Afrique. 156 pp. CIRAD and Ibis Press.

30

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

756

Le Gall P, Silvain JF, Nel A, Lachaise D (2010) Les insectes actuels témoins des passés de

757

l’Afrique : essai sur l’origine et la singularité de l’entomofaune de la région afrotropicale.

758

Ann Soc Entomol Fr, 46, 297-343.

759

Leroy T, Roux C, Villate L, Bodénès C, Romiguier J, Paiva JAP, Dossat C, Aury J-M, Plomion C,

760

Kremer A (2017) Extensive recent secondary contacts between four European white oak

761

species. New Phytol 214:865–878.

762
763
764
765
766
767

Lorenz MW (2009) Migration and trans-Atlantic flight of locusts. Quaternary International, 196, 412.
Lorenzen ED, Heller R, Siegismund HR (2012) Comparative phylogeography of African savannah
ungulates. Mol Ecol, 21, 3656–3670.
Malek J (1997) The locusts on the daggers of Ahmose. In: E. Goring, N. Reeves and J. Riffle (eds.),
Chief of Seers: Egyptian Studies in Memory of Cyril Aldred, London, 207-219.

768

Maley J, Doumenge C, Giresse P, Mahé G, Philippon N, Hubau W, Lokonda MO, Tshibamba JM,

769

Chepstow-Lusty A (2018) Late Holocene forest contraction and fragmentation in central

770

Africa. Quat Res, 89, 43–59.

771
772

Marin JM, Pudlo P, Estoup A, Robert CP (2018) Likelihood-free Model Choice. Handbook of
Approximate Bayesian Computation. Chapman and Hall/CRC.

773

Meinzingen WF (1993) A guide to migrant pest management in Africa. FAO, Rome, Italy.

774

Meynard CN, Gay PE, Lecoq M, Foucart A, Piou C, Chapuis M-P (2017) Climate-driven

775

geographic distribution of the desert locust during recession periods: subspecies' niche

776

differentiation and relative risks under scenarios of climate change. Glob Change Biol,

777

23(11), 4739-4749.

778
779

Michel AP, Sim S, Powell THQ, Taylor MS, Nosil P, Feder JL. (2010) Widespread genomic
divergence during sympatric speciation. Proc Natl Acad Sci USA, 107, 9724–9729.

31

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

780

Miller JM, Hallager S, Monfort S, Newby J, Bishop K, Tidmus S, Black P, Houston B, Matthee C,

781

Robinson J, Fleischer RC (2011). Phylogeographic analysis of nuclear and mtDNA supports

782

subspecies designations in the Ostrich (Struthio camelus). Conserv Genet, 12, 423–431.

783
784

Monod T (1971) Remarques sur les symetries floristiques des zones sèches nord et sud en Afrique.
Mitteilungen der Botanischen Staatssammlung München, 10, 375-423.

785

Moodley Y, Russo I-RM, Robovsky J, Dalton D, Kotzé A, Smith S, Stejskal J, Ryder OA, Hermes

786

R, Walzer C, Bruford MW (2018) Contrasting evolutionary history, anthropogenic declines

787

and genetic contact in the northern and southern white rhinoceros (Ceratotherium simum).

788

Proc R Soc B, 285, 1-9.

789

Nicholson SE (1996) A review of climate dynamics and climate variability in Eastern Africa. In:

790

Johnson TC, Odada EO (Eds.), The Limnology, Climatology and Paleoclimatology of the

791

East African Lakes. Gordon and Breach, Amsterdam, pp. 25-56.

792
793

Partridge TC (1997) Cainozoic environmental change in southern Africa, with special emphasis on
the last 200 000 years. Progr Phys Geog, 21, 3-22.

794

Pedgley DE, Reynolds DR, Tatchell GM (1995) Long-range migration in relation to climate and

795

weather: Africa and Europe. In: Drake VA, Gatehouse AG (Eds.), Insect Migration.

796

Cambridge University Press, Cambridge, pp. 3–29.

797

Pollock DD, Bergman A, Feldman MW, Goldstein DB (1998) Microsatellite behaviour with range

798

constraints: parameter estimation and improved distances for use in phylogenetic

799

reconstruction. Theor Popul Biol, 53, 256–271.

800
801
802
803
804

Pritchard JK, Stephens M, Donnelly P (2000) Inference of population structure using multilocus
genotype data. Genetics, 155, 945–959.
Pudlo P, Marin J-M, Estoup A, Cornuet J-M, Gautier M, Robert CP (2016) Reliable ABC model
choice via random forests. Bioinformatics, 32, 859–866.
Rainey RC, Waloff Z (1951) Flying locusts and convection currents. Anti-Locust Bull, 9, 51-70.

32

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

805
806
807
808
809
810
811
812
813
814

Raynal L, Marin J-M, Pudlo P, Ribatet M, Robert CP, Estoup A (2019) ABC random forests for
Bayesian parameter inference. Bioinformatics, 35, 1720–1728.
Richardson, CH, Nemeth, DJ (1991) Hurricane-borne African locusts (Schistocerca gregaria) on
the Windward Islands. GeoJournal, 23, 349–357.
Robert CP, Cornuet J-M, Marin J-M, Pillai NS (2011) Lack of confidence in approximate Bayesian
computation model choice. P Natl Acad Sci USA, 108, 15112–15117.
Roberts N, Taieb M, Baker P, Damnati B, Icole M, Williamson D (1993) Timing of the Younger
Dryas event in East Africa from lake-level changes. Nature, 366,146–8.
Roffey J, Magor JI (2003) Desert Locust population parameters. Desert Locust Field Research
Stations, Technical Series, 30, 29 p. FAO, Rome, Italy.

815

Rougemont Q, Roux C, Neuenschwander S, Goudet J, Launey S, Evanno G (2016) Reconstructing

816

the demographic history of divergence between European river and brook lampreys using

817

approximate Bayesian computations. PeerJ, 4, e1910.

818
819

Rousset F (2008) GenePop’007: a complete re-implementation of the GenePop software for
Windows and Linux. Mol Ecol Resour, 8, 103–106.

820

Roux C, Fraïsse C, Romiguier J, Anciaux Y, Galtier N, Bierne N (2016) Shedding light on the grey

821

zone of speciation along a continuum of genomic divergence. PLOS Biol, 14(12), e2000234.

822

Schwartz D (1992) Assèchement climatique vers 3000 B.P. et expansion Bantu en Afrique centrale

823
824
825

atlantique: quelques réflexions. B Soc Geol Fr, 163, 353–61.
Scott L (1993) Palynological evidence for late Quaternary warming episodes in Southern Africa.
Palaeogeogr Palaeocl, 101, 229-235.

826

Shi N, Dupont LM, Beug H-J, Schneider R (1998) Vegetation and climate changes during the last

827

21 000 years in S.W. Africa based on a marine pollen record. Veg Hist Archaeobot, 7, 127-

828

140.

829
830

Stokes S, Thomas DSG, Washington R (1997) Multiple episodes of aridity in southern Africa since
the last interglacial period. Nature, 388, 154–158.
33

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

831

Stute M, Talma AS (1997) Glacial temperatures and moisture transport regimes reconstructed from
18

832

noble gases and

833

on Isotope Techniques in the Study of Past and Current Environmental Changes in the

834

Hydrosphere and the Atmosphere, Vienna, International Atomic Energy Agency.

835
836
837
838
839
840
841
842
843
844
845
846
847
848

O, Stampriet aquifer, Namibia. Proceedings of International Symposium

Sun JX, Helgason A, Masson G et al. (2012) A direct characterization of human mutation based on
microsatellites. Nat Genet, 44, 1161–1165.
Sunnåker M, Busetto AG, Numminen E, Corander J, Foll M, Dessimoz C (2013) Approximate
Bayesian computation. PLoS Comput Biol, 9, e1002803.
Sword GA, Lecoq M, Simpson SJ (2010). Phase polyphenism and preventative locust management.
J Insect Physiol, 56, 949–957.
Takezaki N, Nei M (1996) Genetic distances and reconstruction of phylogenetic trees from
microsatellite DNA. Genetics, 144, 389–399.
Talma AS, Vogel JC (1992) Late Quaternary paleotemperatures derived from a speleothem from
Cango Caves. Cape Province, South Africa. Quat. Res., 37, 203-13.
Uvarov BP (1977) Grasshoppers and Locusts, vol. 2. Centre for Overseas Pest Research, London,
UK.
Van Andel TH, Tzedakis PC (1996). Palaeolithic landscapes of Europe and environs: 150,00025,000 years ago: an overview. Quat Sci Rev, 15, 481-500.

849

Vansina J (1995) New Linguistic Evidence and the Bantu expansion. J Afr Hist, 36, 173–195.

850

Vivo M, Carmignotto AP (2004) Holocene vegetation change and the mammal faunas of South

851

America and Africa. J Biogeogr, 31, 943–957.

852

Walker MJC, Berkelhammer M, Björck S, Cwynar LC, Fisher DA, Long AJ, Lowe JJ, Newnham

853

RM, Rasmussen SO, Weiss H (2012) Formal subdivision of the Holocene Series/Epoch: a

854

Discussion Paper by a Working Group of INTIMATE (Integration of ice-core, marine and

855

terrestrial records) and the Subcommission on Quaternary Stratigraphy (International

856

Commission on Stratigraphy). J Quat Sci, 27, 649–659
34

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

857
858
859
860

Waloff Z (1966) The upsurges and recessions of the desert locust plague: an historical survey. AntiLocust Memoir, 8, 111 p.
Waloff Z (1976) Some temporal characteristics of desert locust plagues. Anti-Locust Memoir, 13, 1–
36.

861

Waloff Z, Pedgley DE (1986) Comparative biogeography and biology of the South American

862

locust, Schistocerca cancellata (Serville), and the South African desert locust, S. gregaria

863

flaviventris (Burmeister) (Orthoptera: Acrididae): a review. Bull Entomol Res, 76, 1-20.

864

Weir BS (1996) Genetic Data Analysis II. Sinauer Associates, Sunderland, Massachusetts.

865

Zhivotovsky LA, Feldman MW, Grishechkin SA (1997) Biased mutations and microsatellite

866

variation. Mol Biol Evol, 14, 926–933.

35

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

867

Supporting Material

868

Additional supporting information may be found in the online version of this article.

869
870

Figure legends

871
872

Figure 1. Present time distribution range of Schistocerca gregaria in Africa under remission

873

periods with winds in August a) and January b), and vegetation habitats suitable for the

874

species during the present period b), the Holocene Climatic Optimum (HCO, 9 to 6 Ky ago)

875

d), the Younger Dryas (YD, 12.9 to 11.7 Ky ago) e) and the Last Glacial Maximum (LGM, 26

876

to 14.8 Ky ago) f).

877

(a-b) Distribution range and winds are adapted from Sword et al. (2010) and Nicholson (1996),

878

respectively. (c-f) Vegetation habitats are adapted from Adams and Faure (1997). Open vegetation

879

habitats suitable for the desert locust correspond to deserts (dark orange), xeric shrublands (light

880

orange) and tropical - Mediterranean grasslands (pink). Other unsuitable habitat classes (white) are

881

forests, woodlands and temperate shrublands and savannas.

882
883

Figure 2. Evolutionary scenarios compared using ABC-RF.

884

The subscripts g, f and a refer to the subspecies S. g. gregaria, S. g. flaviventris and their unsampled

885

common ancestor, respectively. Twelve scenarios are considered and identified by an acronym.

886

Such scenarios differ by the presence or absence of three evolutionary events: a bottleneck in S. g.

887

flaviventris (B) right after divergence between the two subspecies, a population size contraction in

888

the ancestral population (C) and a discrete genetic admixture event either unidirectional from S. g.

889

gregaria into S. g. flaviventris (AU) or bidirectional (AB) . For convenience, parameters associated

890

with an evolutionary event are represented graphically only in the first shown scenario that include

891

this event. Looking forward in time, time periods are tC, the time of ancestral population size

892

contraction, tS, the time of split between the two subspecies, and tA, the time of the genetic
36

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

893

admixture between subspecies (with tC > tS > tA). rAU is the unidirectional admixture rate, i.e. the

894

proportion of genes from the S. g. gregaria lineage entering the S. g. flaviventris population at time

895

tA. rAB is the bidirectional admixture rate, i.e. the proportion of genes exchanged between the S. g.

896

gregaria lineage and the S. g. flaviventris lineage at time tA. Ng, Nf and Na are the stable effective

897

population sizes of S. g. gregaria, S. g. flaviventris and the ancestor, respectively. NC is the effective

898

population size during the contraction event of duration dC in the ancestor. NB is the effective

899

population size during the bottleneck event of duration dB.

900
901

Figure 3. Divergence time between S. g. gregaria and S. g. flaviventris inferred under the best

902

supported scenario (scenario SCB) a) in relation to bioclimatic changes in Northern b) and

903

Southern Africa c).

904

a) Dashed and solid lines represent the formal subdivision of the Holocene and Pleistocene epochs

905

(Walker at al. 2012). Dotted lines with labels on the right side are the median value and 90%

906

credibility interval of the posterior density distributions of the divergence time (assuming an

907

average of three generations per year; Roffey and Magor 2003). Asterisks refer to earliest

908

archeological records of the desert locust. In the Algerian Sahara, remains of locusts were found in

909

a special oven dating back to about 6Ky ago, in the rock shelter of Tin Hanakaten (Aumassip 2002).

910

In Egypt, locusts were depicted on daggers of the pharaoh Ahmose, founder of the Eighteenth

911

Dynasty (about 3.5 Ky ago) (Malek 1997) and, at Saqqara, on tombs of the Sixth Dynasty (about

912

4.2 to 4.4 Ky ago) that is thought to have felt with the impact of severe droughts (Meinzingen

913

1993). b-c) Climatic episodes include major cycles and additional transitions of aridity (sandy

914

brown) and humidity (steel blue). The grey coloration means that there is debate on the climatic

915

status of the period (arid vs. humid). HCO: Holocene Climatic Optimum; YD: Younger Dryas;

916

LGM: Last Glacial Maximum; LIG: Last Inter Glacial. Delimitations of climatic periods were based

917

on published paleoclimatic inferences from geological sediment sequences (e.g., eolian deposition,

918

oxygen isotope data) and biological records (e.g., pollen or insect fossils assemblages) from marine
37

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

919

cores or terrestrial lakes. References are Bond et al. (1997), Guo et al.(2000), Kröpelin et al.

920

(2008), Roberts et al. (1993) and van Andel and Tzedakis (1996) for northern Africa, and Talma

921

and Vogel (1992), Stokes et al. (1997), and Shi et al. (1998) for southern Africa. See also Gasse

922

(2000) for a review.

923
924

Figure 4. Median and 90% credibility interval a) and local accuracy b) of ABC-RF posterior

925

distributions of the divergence time under the best supported scenario (scenario SCB) as a

926

function of the time scale.

927

Simulated pseudo-observed datasets (5,000 per divergence time) were generated for fixed

928

divergence time values of 100 ; 250 ; 500; 1,000 ; 2,500; 5,000 ; 10,000 ; 25,000 ; 50,000; 100,000;

929

and 250,000 generations (cf. x-axis with a log-scale). a) The estimated median (plain lines) and

930

90% credibility interval (90% CI; dashed lines), averaged over the 5,000 datasets, are represented

931

(y-axis). b) The local accuracy is measured using out-of-bag predictions and the normalized mean

932

absolute error (NMAE). See Supplementary Material S3 for details.

933
934

38

Tables
Table 1. Summary statistics provided by DIYABC with corresponding values computed from the observed microsatellite dataset.

S. g. gregaria
one-sample statistics

S. g. flaviventris
one-sample statistics

Two-samples statistics

Summary statistics

Observed values at 14
untranscribed markers

Observed values at 9
transcribed markers

NAL
HET
VAR
MGW
NAL
HET
VAR
MGW
FST
DAS
LIKSgg Sgf
LIKSgf  Sgg
DM2
N2P
H2P
V2P

28.8
0.92
36.1
0.92
23.4
0.86
33.4
0.96
0.04
0.07
3.61
3.20
22.7
35.0
0.91
40.2

15.8
0.79
13.3
0.86
14.4
0.69
16.7
0.95
0.12
0.16
2.82
2.55
12.4
21.1
0.79
18.2

The names of summary statistics are those given in the program DIYABC (Cornuet et al. 2014). NAL: mean number of alleles; HET: mean expected heterozygosity; VAR:
variance of allele sizes in base pairs; MGW: M index of Garza and Williamson (2001); FST: pairwise differentiation estimator of Weir and Cockerham (1984); DAS: shared
allele distance (Chakraborty and Jin 1993); LIK: the mean index of classification (Rannala and Moutain, 1997; Pascual et al. 2007); DM2: distance of Golstein et al. (1995).
N2P, H2P and V2P: NAL, HET and VAR statistics computed after pooling the two population samples. Note that five “noise variables”, randomly drawn into uniform
distributions bounded between 0 and 1, and denoted NOISE1 to NOISE5 in the concerned illustrations, were added to the set of summary statistics processed by RF, in order

to evaluate which summary statistics of our genetic datasets were informative in our different inferential ABC-RF settings, when conducting scenario choice or parameter
estimation. Such noise variables do not alter ABC-RF inferences (see Marin et al. 2018; Raynal et al. 2019).

Table 2. Scenario choice when analyzing groups of scenarios or scenarios separately.
Analyses of groups of scenarios

Analysis of scenarios
separately

Group 1 = no B vs.
group 2 = B

Group 1= no C vs.
group 2 = C

Group 1 = no A vs.
group 2 = AS vs. group 3 = AU

Prior error rate

19.0%

26.1%

32.1%

58.4%

Posterior probability
(selected group or individual scenario)

0.926
(B )

0.682
(C)

0.700
(no A)

0.564
(scenario SCB)

Scenarios were grouped based on the presence or not of a bottleneck in S. g. flaviventris (B or no B), a population size contraction in the ancestor (C or no C) and a
symmetrical (i.e., bidirectional) or an asymmetrical genetic admixture from S. g. gregaria into S. g. flaviventris (AB or AU or no A). We reported values for prior error rates
and posterior probabilities of the selected group of scenarios or individual scenario, averaged over ten replicate analyses. The local posterior error rate (corresponding to a
confidence measure of the selected scenario given the observation.) can be computed as 1 minus the posterior probability (see Supplementary material S3 for details). The
number of records for each reference datasets simulated from DIYABC was set to 150,000 and the number of RF- trees was 3,000.

Table 3. Parameter estimation under the best supported scenario (scenario SCB).
Posterior values

Prior values

Median

90% CI

NMAE

Median

90% CI

NMAE

tS

7,723

2,785 – 19,708

0.369

1,212

124 – 73,795

0.359

tC / tS

2.75

1.11 – 35.47

0.596

12.17

1.24 – 762.26

1.077

Nf / Ng

5.43

0.52 – 25.56

1.332

1.00

0.12 – 8.11

1.726

dB / NB

1.06

0.49 – 2.41

0.323

1.00

0.13 – 7.57

0.299

tS: time of divergence between the two desert locust subspecies (in number of generations); tC: time of ancestral population size contraction; Nf : stable effective population
size of S. g. flaviventris; Ng: stable effective population size of S. g. gregaria; d B : duration of the bottleneck event; NB: effective population size during the bottleneck event.
For each evolutionary parameter, we reported posterior point estimates averaged over ten replicate analyses. CI: credibility interval. The number of records for each reference
datasets simulated from DIYABC was set to 100,000 and the number of RF-trees was 2,000. Accuracy has been measured with the normalized mean absolute error (NMAE)
which corresponds to the mean of the absolute difference between the point estimate of the parameter (here the median) and the (true) simulated value divided by the (true)
simulated value. NMAE measures were computed using out-of-bag predictions either on the whole data space defined by the prior distributions (prior NMAE) or
conditionally to the observed dataset (posterior NMAE); see Supplementary material S3 for details.

Fig. 1
a) Present distribution
(winds in Aug)

b) Present distribution
(winds in Jan)

c) Present habitats

d) HCO habitats

e) YD habitats

f) LGM habitats

Legend:

Desert

Xeric shrubland

Tropical and Mediterranean grassland

Fig. 2
S (split)

SC (+contraction)

Na
tS

Nf

gregaria

SCAU

SBAU

SCBAU

SCAB

SBAB

SCBAB

rAU
SAB (+bidirectional admixture)

tA

NB, dB

tC

SAU (+unidirectional admixture)

tA

SCB

NC, dC
Ng

flaviventris

SB (+bottleneck)

rAB

Fig. 3

Present

a)

b)

c)

Median and 90%CI
of ABC−RF posterior distribution

Northern Africa
climate

Southern Africa
climate

Holocene

4.2

Late stage
4.2

*

*

2.6

4.8

*

Calendar age BP (Ky)

0.9

Middle stage
8.2

HCO

6.6

HCO

8.2
9.3
10.9
12.5
14.4

Early stage
11.7

Pleistocene

12.9
14.8
17.2
21.1

YD

LGM

LGM

LIG

LIG

17.2
21.1

43.0
58.0
75.0
90.0

Late stage
125.0

Middle stage
Past

110.0
125.0

125.0

2nd−to−LGM

2nd−to−LGM

Fig. 4
b) Posterior NMAE

0.40
0.35
0.25

0.30

Median estimate

10.0
1.0
0.1

Median and 90%CI

100.0

0.45

a) Posterior estimation

0.1

1.0

10.0

100.0

Divergence time (KG)

0.1

1.0

10.0

100.0

Divergence time (KG)

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Supplementary material online for the manuscript: « A young age of subspecific
divergence in the desert locust Schistocerca gregaria”

Marie-Pierre Chapuis1,2, Louis Raynal3,4, Christophe Plantamp5, Christine N. Meynard6, Laurence
Blondin7, Jean-Michel Marin3,4 and Arnaud Estoup4,6
1

CIRAD, CBGP, Montpellier, France.

2

CBGP, CIRAD, INRA, IRD, Montpellier SupAgro, Univ Montpellier, Montpellier, France.

3

IMAG, Univ de Montpellier, CNRS, Montpellier, France.

4

Institut de Biologie Computationnelle (IBC), Montpellier, France.

5

ANSES, Laboratoire de Lyon, France.

6

CBGP, INRA, CIRAD, IRD, Montpellier SupAgro, Univ Montpellier, Montpellier, France.

7

CIRAD, BGPI, Montpellier, France.

Outline:
Supplementary material S1. Details on results from ABC Random Forest (ABC-RF) treatments.
Supplementary material S2. Hindcasting the desert locust potential distribution into the midHolocene (HCO) and the last glacial maximum (LGM) using distribution modelling.
Supplementary material S3. Overview of the used ABC Random Forest (ABC-RF) methods.
Supplementary material S4. Details on results from ABC-RF treatments when assuming uniform
priors for the three time period parameters of the studied scenarios.

Supplementary material S1. Details on results from ABC-RF treatments.
Table S1.1. Scenario choice for each of the ten replicate analyses.

Reference
Best
table
scenario

Votes
S

Votes
SC

Votes
SB

Votes
SCB

Votes
SAU

Votes
SCAU

Votes Votes Votes
SBAU SCBAU SAB

Votes
SCAB

Votes Votes Prior error
SBAB SCBAB
rate

scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB

0.004

0.033

0.171

0.513

0.011

0.022

0.040

0.094

0.017

0.041

0.024

0.031

0.583

Posterior
probability
(best
scenario)
0.572

0.003

0.026

0.178

0.515

0.006

0.018

0.023

0.093

0.023

0.022

0.051

0.042

0.583

0.549

0.003

0.024

0.196

0.497

0.010

0.019

0.030

0.101

0.025

0.033

0.036

0.024

0.583

0.545

0.004

0.026

0.144

0.483

0.006

0.018

0.043

0.126

0.041

0.032

0.050

0.026

0.586

0.570

0.004

0.025

0.126

0.537

0.007

0.017

0.030

0.117

0.017

0.021

0.063

0.036

0.582

0.607

0.004

0.039

0.161

0.501

0.004

0.023

0.036

0.128

0.020

0.026

0.037

0.021

0.585

0.568

0.014

0.021

0.136

0.536

0.005

0.022

0.029

0.099

0.022

0.044

0.037

0.035

0.585

0.588

0.005

0.016

0.149

0.491

0.005

0.019

0.026

0.124

0.042

0.030

0.034

0.058

0.586

0.565

0.003

0.036

0.151

0.506

0.009

0.019

0.017

0.113

0.049

0.024

0.034

0.040

0.584

0.551

0.006

0.031

0.178

0.491

0.002

0.029

0.028

0.082

0.041

0.032

0.033

0.047

0.585

0.528

0.005

0.028

0.159

0.507

0.007

0.021

0.030

0.108

0.030

0.030

0.040

0.036

0.584

0.564

1
2
3
4
5
6
7
8
9
10
Mean

We report values for the proportion of votes, prior error rates and posterior probabilities of the best scenario on ten replicate analyses based on ten different reference tables.
Scenarios are depicted in Figure 2. For each reference table, the number of datasets simulated using DIYABC was set to 150,000 and the number of RF-trees was 3,000. The

scenario SCB was the best supported for all replicate analyses: it involves a bottleneck event in S. g. flaviventris right after divergence, a population size contraction in the
ancestral population and not any genetic admixture event.

Table S1.2. Estimation of the divergence time between S. g. gregaria and S. g. flaviventris for the ten replicate analyses processed under
the best supported scenario (scenario SCB).
tdiv (G)
reference table 1
reference table 2
reference table 3
reference table 4
reference table 5
reference table 6
reference table 7
reference table 8
reference table 9
reference table 10
Mean
SD

Median
7440.0
8257.1
7930.3
7301.0
7598.6
7426.0
7776.0
7960.0
7552.3
7991.0
7723.2
307.3

q5%
2485.0
2668.0
2771.0
2888.0
2376.0
2975.7
3190.0
2812.0
2717.0
2966.9
2785.0
240.5

q95%
19380.0
21086.0
20310.9
19639.5
18260.6
19704.7
19290.2
19664.2
20685.0
19060.7
19708.2
817.8

Replicate analyses have been processed on different reference tables. For each reference table, the number of datasets simulated using DIYABC was set to 100,000 and the
number of RF-trees was 2,000. Divergence times are given in number of generations (G). SD stands for standard deviations computed from the ten values of median, 5%
quantile and 95% quantile estimated from the ten replicate analyses.

Table S1.3 Effect of the number of simulated datasets in the reference table on scenario choice.
nref
Votes S
Votes SC
Votes SB
Votes SCB
Votes SAU
Votes SCAU
Votes SBAU
Votes SCBAU
Votes SAB
Votes SCAB
Votes SBAB
Votes SCBAB
Prior error rate
Posterior probability
(best model)

50,000
Mean
0.006
0.030
0.155
0.496
0.006
0.025
0.033
0.117
0.031
0.032
0.039
0.030
0.594
0.567

SD
0.002
0.015
0.025
0.035
0.003
0.005
0.009
0.027
0.009
0.012
0.014
0.013
0.002

80,000
Mean
0.005
0.031
0.155
0.506
0.007
0.023
0.031
0.113
0.030
0.029
0.039
0.031
0.589

0.037

0.562

SD
0.002
0.009
0.028
0.036
0.004
0.004
0.007
0.019
0.011
0.007
0.013
0.009
0.002

100,000
Mean
0.006
0.029
0.165
0.500
0.006
0.020
0.033
0.108
0.027
0.029
0.043
0.032
0.587

0.034

0.555

SD
0.003
0.006
0.033
0.034
0.004
0.005
0.008
0.017
0.010
0.009
0.014
0.009
0.001

130,000
Mean
0.006
0.028
0.164
0.502
0.006
0.022
0.030
0.109
0.029
0.031
0.042
0.032
0.585

0.034

0.563

SD
0.004
0.006
0.036
0.025
0.004
0.006
0.009
0.017
0.010
0.012
0.013
0.009
0.001

150,000
Mean
0.005
0.028
0.159
0.507
0.007
0.021
0.030
0.108
0.030
0.030
0.040
0.036
0.584

SD
0.003
0.007
0.022
0.019
0.003
0.008
0.016
0.012
0.008
0.011
0.011
0.011
0.001

0.028

0.564

0.023

Scenarios are depicted in Figure 2. The number of records in the reference datasets (nref) simulated from DIYABC varied from 50,000 to 150,000. We report mean and
standard deviation values for the proportion of votes for each scenario, and for prior error rates and posterior probabilities of the best scenario for ten replicate analyses.
Replicate analyses have been processed on different reference tables. The number of RF-trees was 3,000. The scenario SCB was the best supported for all replicate analyses: it
involves a bottleneck event in S. g. flaviventris right after divergence, a population size contraction in the ancestral population and not any genetic admixture event.

Table S1.4. Effect of the number of simulated datasets in the reference table on posterior point estimation values (A) and estimation
accuracy (B) of the divergence time between S. g. gregaria and S. g. f laviventris under the best supported scenario (scenario SCB).
(A)
50,000

nref

Posterior
estimations

Median
q5%
q95%

80,000

90,000

Mean

SD

Mean

SD

Mean

SD

7731.8
2697.0
20295.5

448.9
129.7
1763.6

7691.8
2706.8
19711.6

357.5
235.2
1451.3

7724.8
2764.4
19508.7

318.0
172.9
1264.1

100,000
Mean
SD
7723.2
2785.0
19708.2

307.3
240.5
817.8

(B)
nref
Accuracy
measures

50,000

80,000

90,000

100,000

Prior NMAE

0.378

0.365

0.362

0.359

Posterior NMAE

0.375

0.370

0.365

0.369

The number of records in the reference datasets (nref) simulated from DIYABC varied from 50,000 to 100,000. The number of RF-trees was set to 2,000. (a) Replicate
analyses have been processed on ten reference tables. (b). The normalized mean absolute error (NMAE) is the absolute difference between the point estimate (here the
median) and the (true) simulated value divided by the (true) simulated value.

Figure S1.1. Projection on a single (when analyzing pairwise groups of scenarios) or on the first two LDA axes (when analyzing the
twelve scenarios separately) of the observed dataset and the simulated datasets recorded in the reference table. Colors correspond to
group of scenarios or individual scenarios. The location of the desert locust observed dataset is indicated by a vertical black line or a star.
Scenarios were grouped based on the presence or not of a bottleneck in S. g. flaviventris (B or no B), a population size contraction in ancestor (C
or no C) and a genetic admixture either unidirectional from S. g. gregaria into S. g. flaviventris or bidirectional (AU or AB or no A). When
considering the whole set of twelve scenarios separately (d), the projected points substantially overlapped for at least some of the scenarios. This
suggests an overall low power to discriminate among scenarios considered. Conversely, considering pairwise groups of scenarios, one can
observe a weaker overlap of projected points (at least for (a) and (b)) suggesting a stronger power to discriminate among groups of scenarios of
interest than when considering all scenarios separately. One can note that the location of the observed dataset (indicated by a vertical line)
suggests an association with the scenario group with a bottleneck event in S. g. flaviventris and with the scenario group with a population size
contraction in the ancestral population.
(a) Group g1= no B vs. group g2 = B

(b) Group g1 = no C vs. group g2 =C

(c) Scenario group 1 = no A vs. group 2 = AU vs. group 3 = AB

(d) All twelve scenarios considered separately

Figure S1.2. Contributions of ABC-RF summary statistics when choosing between groups of scenarios. The contribution of each 32 summary statistics
and one LDA axis (or two LDA axes) is evaluated as the total amount of decrease in the Gini criterion (variable importance on the x-axis). The higher the
contribution of the statistics, the more informative it is in the inferential process. The microsatellite set and subspecies sample are indicated at the end of each
statistics by indices k_i for single population statistics and k_i.j for two population statistics, with k=1 for the set of untranscribed microsatellites or k=2 for the
set of transcribed microsatellites, and i(j)=1 for the S. g. flaviventris subspecies or and i(j)=2 for the S. g. gregaria subspecies. See Table S1 for details on the
summary statistics abbreviations. Five noise variables, randomly drawn into uniform distributions bounded between 0 and 1, and denoted NOISE1 to NOISE5
were added to the set of summary statistics processed by RF, in order to evaluate from which amount of decrease in the Gini criterion the summary statistics
computed from our genetic datasets were not informative anymore (indicated by a red star).

(a) Group g1= no B vs. group g2 = B

(b) Group g1 = no C vs. group g2 =C

(c) Group 1 = no A vs. group 2 = AU vs. group 3 = AB

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S1.3. Contributions of ABC-RF summary statistics when choosing among the twelve
individual scenarios. The contribution of each 32 summary statistics and eleven LDA axes is
evaluated as the total amount of decrease in the Gini criterion (variable importance on the x-axis).
The higher the contribution of the statistics, the more informative it is in the inferential process. The
microsatellite set and subspecies sample are indicated at the end of each statistics by indices k_i for
single population statistics and k_i.j for two population statistics, with k=1 for the set of
untranscribed microsatellites or k=2 for the set of transcribed microsatellites, and i(j)=1 for the S. g.
flaviventris subspecies or and i(j)=2 for the S. g. gregaria subspecies. See Table 1 for details on the
summary statistics abbreviations. Five noise variables, randomly drawn into uniform distributions
bounded between 0 and 1, and denoted NOISE1 to NOISE5 were added to the set of summary
statistics processed by RF, in order to evaluate from which amount of decrease in the Gini criterion
the summary statistics computed from our genetic datasets were not informative anymore (indicated
by a red star).

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S1.4. Contributions of ABC-RF summary statistics when estimating the divergence time
between the two desert locust subspecies under the best supported scenario (scenario SCB). The
contribution of each 32 summary statistics is evaluated as the total amount of decrease of the residual
sum of squares, divided by the number of trees, (variable importance on the x-axis). The higher the
contribution of the statistics, the more informative it is in the inferential process. The microsatellite
set and subspecies sample are indicated at the end of each statistics by indices k_i for single
population statistics and k_i.j for two population statistics, with k=1 for the set of untranscribed
microsatellites or k=2 for the set of transcribed microsatellites, and i(j)=1 for the S. g. flaviventris
subspecies or and i(j)=2 for the S. g. gregaria subspecies. See Table S6.1 for details on the summary
statistics abbreviations. Five noise variables, randomly drawn into uniform distributions bounded
between 0 and 1, and denoted NOISE1 to NOISE5 were added to the set of summary statistics
processed by RF, in order to evaluate from which amount of decrease in the variable importance
criterion the summary statistics computed from our genetic datasets were not informative anymore
(indicated by a red star).

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S1.5. Effect of the number of RF-trees for scenario choice. We here illustrate the effect
of the number of trees in the forest on the prior error rate using an informed mutational prior
setting and considering the twelve compared scenarios separately. The number of datasets in the
reference table simulated using DIYABC was 150,000. The shape of the curve shows that the
prior error rate stabilizes for a number of RF-trees > 2,000.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S1.6. Effect of the number of RF-trees for parameter estimation. We here illustrate the
effect of the number of trees in the forest on the RF mean square error of the divergence time
between S. g. gregaria and S. g. flaviventris under the selected scenario SCB and using an informed
mutational prior setting. The number of datasets in the reference table simulated using DIYABC was
100,000. The shape of the curve shows that the prior error rate stabilizes for a number of RF-trees >
1,500.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Supplementary material S2. Hindcasting the desert locust
potential distribution into the mid-Holocene (HCO) and the last
glacial maximum (LGM) using distribution modelling.
To complement distribution projections based on vegetation during the mid-Holocene (HCO;
~6,000 years ago) and Last Glacial Maximum (LGM; ~120,000 years ago) periods, we used
species distribution modelling along with climatic reconstructions of the past. However,
results from this modelling effort do not fully match vegetation reconstructions presented in
the main text. Given that most Global Climate Models (GCMs) have been calibrated and
tested largely with northern hemisphere data, uncertainties related to current and past
extrapolations of climate over large areas of Africa are often unknown (e.g. Rowell et al.
2016). In this appendix, we present the results of the distribution modelling effort, while in
the main text we base our formalization of evolutionary scenarios on paleo-vegetation
reconstructions. Notice that the difference between the two approaches does not affect our
major conclusions. Indeed, since paleo-vegetation maps show more severe changes of open
vegetation distributions during glacial and interglacial periods, their use make us consider a
wider spectrum of key biogeographic events than we would have identified based on climatic
modelling (e.g. continuous colonization of southern Africa, population size contraction), and
thus a larger set of possible scenarios. In addition, our inference of a most likely scenario
including a long-distance migration event, and our estimation of a short time scale of
divergence between the two clades, do not conflict with the results of any of these approaches
(see also the section ‘On the influence of climatic cycles’ in Discussion of the main text).
Methods
In a previous study (Meynard et al. 2017), we used Climond data (Kriticos et al. 2012) to
characterize the current distribution of the two desert locust subspecies, and project their
potential fate under different climate change scenarios into 2070. Here, we could not use the
same models because the climatic variables used to calibrate those models, in particular
radiation and wetness indices, are not available into the mid-Holocene (HCO) and Last
Glacial Maximum (LGM) periods. However, we apply here a similar modelling procedure
with a different subset of environmental predictors. Instead of Climond, here we downloaded
Worldclim v1.4 data (Hijmans et al. 2005) at a 5 min resolution (approximately 9 km at the
equator).
For hindcasting, we first need to calibrate a model under current conditions, which can then
be used to draw maps of potential ranges under HCO and LGM conditions. To do so, we used
the occurrence data published in Meynard et al. (2017), which included decades of monitoring
of S. g. gregaria in northern Africa, the middle east and southern Asia during remission
periods, as well as field records and literature records of S. g. flaviventris in southern Africa.
However, rather than modelling each clade independently as we did before, here we decided
to group presence records for the two clades as a single unit for the following reasons: (1)
here the emphasis is in paleo-climates, at a time scale where the two clades were not yet
supposed to be differentiated; (2) a niche analysis in Meynard et al. (2017) did not show
evidence of niche differentiation between S. g. gregaria and S. g. flaviventris, suggesting that

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

the environment occupied by the southern clade is a subset of that occupied by the northern
one; and (3) the biogeographic hypothesis supported by the molecular analysis presented here
involves the colonization of the southern tip of south Africa by an isolated population of the
northern sub-species, which is more generalist in terms of its environmental niche. We
therefore considered that grouping occurrence records regardless of the subspecies would
provide for a more accurate hindcasting scenario. However, preliminary analysis using
separate modelling for each subspecies showed qualitatively similar projections when using S.
g. gregaria alone (results not shown).
Finally, since here the emphasis is on Africa, we included only occurrence records in this
continent, and used 10,000 pseudo-absences drawn at random from outside the combined
current ranges of the two clades by using the distribution maps proposed in Meynard et al.
(2017) to mask out areas available for pseudo-absence selection. We also assumed here that
most of the African continent was accessible to the species during this geological time-scale,
given the long known dispersal distances during outbreak periods, the wide distribution of the
northern clade, and the fact that the species is present in both extremes of the continent.
Consequently, here we do not delimit an accessible area, but we limit our modelling to
continental Africa.
To model the species distribution we used four climatic variables to represent mean and
variability in temperature and precipitation, while minimizing correlation between them. The
four variables selected using these criteria were annual mean temperature (BIO1), annual
precipitation (BIO12), annual temperature range (BIO7) and precipitation seasonality
(BIO15). We also tested the same forward variable selection procedure presented in Meynard
et al. (2017), which provided very similar predictions but, for simplicity, we will not present
those results here. Using these four climatic predictors, we applied three statistical models in
Rv3.6.1 to draw a consensus map for all predictions: Generalized Additive Model (GAM)
using library mgcv, and limiting the maximum model complexity to k=4 (Wood 2006);
boosted regression trees (BRT) using the library gbm, with 2000 trees and no interactions
(Elith et al. 2008); and MAXENT, using the library dismo and all default parameters (Elith et
al. 2011). As mentioned above, background data was sampled at random in Africa from
outside the species current distribution. Pseudo-absences received a combined weight of 50%
when using GAM or BRT, in order to balance the large number of pseudo-absences with
respect to presence records in the modelling process while representing the range of values of
the environmental predictors in the study area (Barbet-Massin et al. 2012). The consensus was
drawn as the median predicted probability between the three models, and four different
threshold values were calculated from this consensus: the MST threshold (the threshold that
maximizes the sum of sensitivity + specificity), often recommended as a good strategy to
optimize presence and absence classification rates (Liu et al. 2005), was calculated to delimit
the predicted range of the species and calculate classification rate statistics; and 3 different
thresholds that represent the highest predicted values that include a fixed percentage of
presences (50%, 75% and 90%). These thresholds were used to visualize on the maps the core
(50% threshold) versus the more marginal (between 75% and 90% thresholds) habitats within
the range. In this context, the 50% threshold represents the core distribution, i.e. the highest
predicted values that contain more than half of the occurrences, the 90% threshold represents
the area that includes most of the occurrences, and the area outside the 90% threshold
represents marginal or no habitat, where the species is unlikely to occur. The area between the

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

75% and 90% threshold can be considered as habitat that is rather marginal but that is still
part of the predicted range.
Classification success rates (AUC, TSS, sensitivity and specificity) were calculated for the
consensus on all the dataset, using an MST threshold when needed. The thresholds calculated
using current climate and occurrence data were then projected into past scenarios (HCO and
LGM) using 3 different global circulation models at the same resolution: CCSM4, MIROCESM and MPI-ESM-P. We chose these three GCMs because their projections were available
for both time steps of interest. Although the three GCMs are based on climatological
principles, each one works in slightly different ways, and therefore produces different results.
Consensus between GCMs presented below represent median values of predictions between
the three GCMs.
Results
The current distribution of S. gregaria, as modelled using both subclades as a single unit and
limited to continental Africa, is quite similar to the one already published in Meynard et al.
(2017) (see Figure S2.1). There are, however, differences in the outline of the distributions,
but the overall predicted area is largely overlapping and classification rates were excellent for
this model under current conditions (% correctly classified = 87%; AUC = 0.960 ± 0.003;
sensitivity = 0.911 ± 0.014; specificity = 0.870 ± 0.002; TSS = 0.788 ± 0.016). As expected,
the species is more likely to occur in regions with mid to high temperatures, wide annual
temperature range, low precipitation and high precipitation seasonality (Figure S2.2).

Figure S2.1: Current range as predicted by a model combining both subspecies’ occurrences and using four climatic
predictors. The range predicted by this model (black contour) is compared to the one published in Meynard et al. (2017)
using a different set of predictors and separating occurrences by subspecies (blue contour).

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S2.2: Response curves of S. gregaria against the four environmental predictors used in the modelling process, as
derived from the GAM model. Notice that temperature is expressed as the real temperature x 10.

To better understand the results in terms of distributional changes, Figure S2.3 shows a
comparison of the climatic variables used in the modelling process in the study region during
the present, the HCO and the LGM periods across Africa. Although only one GCM scenario
is shown (CCSM4), climatic conditions for the other two GCMs present similar trends. Notice
that, although temperatures are thought to have been warmer than present during the HCO
globally, those changes are not uniform across regions and are not reflected in these HCO
scenarios for Africa. In all the scenarios in Figure S2.3, mean temperature showed a slight
decrease across Africa, while precipitation increased slightly.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S2.3: Comparison of climates across times (current climate, mid-Holocene, Last Glacial Maximum=LGM). Variables
shown are those used in the modelling process. BIO1 = Mean Annual Temperature; BIO7 = Annual Temperature Range;
BIO12 = Annual Precipitation; BIO15 = Precipitation Seasonality (Coefficient of Variation). Vertical color lines indicate mean
values for each period: blue = current mean; red = HCO mean; green = LGM mean.

However, when looking at the distribution of those changes (Figure S2.4) some regions
showed a decrease and others an increase in temperatures during the same period. Most of
Africa shows changes that represent less than 10% of their current mean temperature values
(Figure S2.4, upper left). Overall, conditions under HCO in Africa were therefore similar to
current climatic conditions in terms of temperature but were moister in many regions that are
relevant to the potential distribution of the desert locust (Figure S2.4, upper row).

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S2.4: Relative changes in annual mean temperature (BIO1) and annual precipitation (BIO12) during the HCO and
LGM, expressed as a percent of current values per grid cell. Positive values therefore indicate an increase whereas negative
values represent a decrease with respect to current climatic conditions.

During the LGM (Figure S2.3, right column), mean temperature decreased more dramatically
throughout all of Africa, while precipitation increased in some regions but decreased in others
(Figure S2.4, lower row). While the entire continent experienced a decrease in temperature,
changes in precipitation were more heterogeneous (Figure S2.4, lower right). Given that these
changes are heterogeneous across regions, changes in the potential distribution of S. gregaria
are less dramatic than one would expect given global simplifications of these changes.
Indeed, the predicted distribution during the HCO and the LGM are very similar to the current
distribution (Figure S2.5). There is an overall shrinkage of the core habitat (in red in all
maps), but the contour of the distribution (black contour) remains large and mostly
overlapping with the current distribution.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S2.5: Comparison of current versus past potential distribution of S. gregaria during the HCO and LGM periods.

Although each GCM resulted in differences in terms of the projected distribution maps of S.
gregaria, in the consensus distribution is projected to be very similar to the current
distribution during the HCO, and slightly reduced during the LGM, with a shift of the core
favorable climatic conditions towards a much reduced area, especially during the LGM
(Figure S2.5).
Although climatic projections for each GCM result in different projected distributions during
the HCO (Figure S2.6) and the LGM (Figure S2.7), overall the tendencies are the same: a
similar distribution when comparing present and HCO conditions, and a more restricted
potential distribution when considering LGM conditions.

Figure S2.6: Projected potential distribution of S. gregaria during the mid-Holocene (~6000 years BP) using three different
Global Circulation Models (GCMs): CCRM4, MIROC-ESM and MPI-ESM-P.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S2.7: Projected potential distribution of S. gregaria during the LGM (~20,000 years BP) using three different Global
Circulation Models (GCMs): CCRM4, MIROC-ESM and MPI-ESM-P.

References
Barbet-Massin M, Jiguet F, Albert CH, Thuiller W. 2012. Selecting pseudo-absences for
species distribution models: how, where and how many? Methods Ecol. Evol. DOI:
10.1111/j.2041-210X.2011.00172.x.
Elith J, Leathwick JR, Hastie T. 2008. A working guide to boosted regression trees. J. Anim.
Ecol. 77:802–813.
Elith J, Phillips SJ, Hastie T, Dudik M, Chee YE, Yates CJ. 2011. A statistical explanation of
MaxEnt for ecologists. Divers. Distrib. 17:43–57.
Hijmans RJ, Cameron SE, Parra JL, Jones PG, Jarvis A. 2005. Very High Resolution
interpolated climate surfaces for global land areas. Int. J. Climatol. 25:1965–1978.
Kriticos DJ, Webber BL, Leriche A, Ota N, Macadam I, Bathols J, Scott JK. 2012. CliMond:
global high-resolution historical and future scenario climate surfaces for bioclimatic
modelling. Methods Ecol. Evol. 3:53–64.
Liu C, Berry PM, Dawson TP, Pearson RG. 2005. Selecting thresholds of occurrence in the
prediction of species distributions. Ecography 28:385–393.
Meynard CN, Gay P-E, Lecoq M, Foucart A, Piou C, Chapuis M-P. 2017. Climate‐ driven
geographic distribution of the desert locust during recession periods: Subspecies’
niche differentiation and relative risks under scenarios of climate change. Glob.
Change Biol. 23:4739–4749.
Rowell DP, Senior CA, Vellinga M, Graham RJ. 2016. Can climate projection uncertainty be
constrained over Africa using metrics of contemporary performance? Clim. Change
134:621–633.
Wood SN. 2006. Generalized Additive Models: an introduction with R. Boca Raton, Florida:
Chapman & Hall/CRC

Supplementary Material S3: Overview of the used ABC Random Forest (ABC-RF) methods
In this supplementary material, we provide readers with an overview of the Approximate Bayesian
Computation Random Forest (hereafter ABC-RF) methods used in the present paper. We invite
the reader to consult Pudlo et al. (2016), Estoup et al. (2018), and Raynal et al. (2018) for more
in-depth explanations.

ABC framework
Let y denote the observed data and θ a vector of parameters associated to a statistical model whose
likelihood is f (. | θ). Under the Bayesian parametric paradigm the posterior distribution
π(θ | y) ∝ f (y | θ)π(θ)
is of prime interest. It characterizes the distribution of θ given the observation y and can be
interpreted as an update of the prior distribution π(θ) by the likelihood of y. The likelihood is
hence pivotal, but unfortunately intractable in the evolutionary scenarios (models) we consider in
the present study, as well as in many other evolutionary studies. As a matter of fact, the underlying
Kingman’s coalescent process (Kingman, 1982) does not allow a close expression for the likelihood
because all the possible genealogies and mutational process yielding y should be considered. To
solve this issue, some likelihood-free methods have been developed using the fact that, even though
the likelihood is not available, generating artificial (i.e. simulated) data for a given value of θ is
much easier if not feasible (e.g. Beaumont (2010). Approximate Bayesian computation (ABC) is
one of them (Beaumont et al., 2002).
In a nutshell, ABC consists in generating parameters θ 0 and associated pseudo-data z from
the scenario, and accepting θ 0 as a realization from an approximated posterior if z is similar to y.
In standard ABC treatments, the notion of similarity is defined through the use of a distance ρ
to compare η(z) and η(y), where η(.) is a projection of the data in a lower dimensional space of
summary statistics. Only pseudo-data providing distance lower than a threshold  are retained.
The choice of ρ, η(.) and  is a major issue in ABC (Beaumont, 2010).
ABC-RF is a recently derived ABC approach based on the supervised machine learning tool
named Random Forest (Breiman, 2001), which has as major advantage to avoid the three abovementioned difficulties. Initially introduced in Pudlo et al. (2016) for model choice and then extended
to parameter inference in Raynal et al. (2018), ABC-RF relies on the use of random forests on a
set of simulated pseudo-data according to the generative Bayesian models under consideration.
Let consider M Bayesian parametric models. For a given model index m ∈ {1, . . . , M }, a prior
probability P(M = m) is defined, with θ m its associated parameters and fm (y | θ m ) its likelihood.
The generation process of a reference table made of H elements is described in Algorithm 1.
Algorithm 1: Generation of a reference table with H elements
1
2
3
4
5
6

for j ← 1 to H do
Generate m(j) from the prior P(M = m)
Generate θ m(j) from the prior πm(j) (.)
Generate z(j) from the model fm(j) (. | θ m(j) )

Compute η(z(j) ) = η1 (z(j) ), . . . , ηd (z(j) )
end

1

The output takes the form of a matrix containing simulated model indexes, parameters and
summary statistics, as described below
 (1)

m
θm(1) η1 (z(1) ) η2 (z(1) ) . . . ηd (z(1) )
 m(2) θm(2) η1 (z(2) ) η2 (z(2) ) . . . ηd (z(2) ) 


 ..
.
..
..
..
..
..
 .

.
.
.
.
.
m(H)

θm(H)

η1 (z(H) ) η2 (z(H) ) . . . ηd (z(H) )

ABC-RF for model choice
The ABC-RF strategy for model choice is described in Algorithm 2. The output is the affectation
of y to a model (scenario), this decision being made based on the majority class of the RF tree
votes.
Algorithm 2: ABC-RF for model choice
Input : a reference table used as learning set, made of H elements, each one composed of a model
index m(H) and d summary statistics. A possibly large collection of summary statistics can
be used, including some obtained by machine-learning techniques, but also by scientific
theory and knowledge
Learning : construct a classification random forest m̂(·) to infer model indexes
Output : apply the random forest classifier to the observed data η(y) to obtain m̂(η(y))

The selected scenario is the one with the highest number of votes in his favor. In addition to
this majority vote, the posterior probability of the selected scenario can be computed as described
in Algorithm 3.
Algorithm 3: ABC-RF computation of the posterior probability of the selected scenario

Input : the values of I m(h) 6= m̂(η(z(h) )) for the trained random forest and corresponding
summary statistics of the reference table, using the out-of-bag classifiers
Learning : construct a regression random forest Ê(.) to infer E (I {m 6= m̂(η(y))} | η(y))
Output : an estimate of the posterior probability of the selected model m̂(η(y))
P̂ (m = m̂(η(y)) | η(y)) = 1 − Ê (I {m 6= m̂(η(y))} | η(y))

Such posterior probability provides a confidence measure of the previous prediction at the point
of interest η(y). It relies on the building of a regression random forest designed to explain the
model prediction error. More specifically, and as a first step, posterior probability computation
makes use of out-of-bag predictions of the training dataset. Because each tree of the random forest
is built on a bootstrap sampling of the H elements of the reference table (i.e. the training dataset),
there is about one third of the reference table that remains unused per tree, and this ensemble of
left aside datasets corresponds to the “out-of-bag”. Thus, for each pseudo-data of the reference
2

table, one can obtain an out-of-bag prediction by aggregating all the classification trees in which
the pseudo-data was out-of-bag.
step, the out-of-bag predictions m̂(η(z(h) )) are used
 (h) In a second
(h)
to compute the indicators I m 6= m̂(η(z )) . These 0 - 1 values are used as response variables
for the regression random forest training, for which the explanatory variables are the summary
statistics of the reference table. Predicting the observed data thanks to this forest allows the
derivation of the posterior probability of the selected model (Algorithm 3). Note that using the
out-of-bag procedure prevents over-fitting issues and is computationally parsimonious as it avoids
the generation of a second reference table for the regression random forest training.
Model grouping A recent useful add-on to ABC-RF has been the model-grouping approach developed in Estoup et al. (2018), where pre-defined groups of scenarios are analysed using Algorithm
2 and 3. The model indexes used in the training reference table are modified in a preliminary step
to match the corresponding groups, which are then used during learning phase. When appropriate,
unused scenarios are discarded from the reference table. This improvement is particularly useful
when a high number of individual scenarios are considered and have been formalized through the
absence or presence of some key evolutionary events (e.g. admixture, bottleneck, ...). Such key
evolutionary events allow defining and further considering groups of scenarios including or not such
events. This grouping approach allows to evaluate the power of ABC-RF to make inferences about
evolutionary event(s) of interest over the entire prior space and assess (and quantify) whether or
not a particular evolutionary event is of prime importance to explain the observed dataset (see
Estoup et al. (2018) for details and illustrations).

ABC-RF for parameter estimation
Once the selected (i.e. best) scenario has been identified, the next step is the estimation of its
parameters of interest under this scenario. The ABC-RF parameter estimation strategy is described
in Algorithm 4 and takes a similar structure to Algorithm 2. The idea is to use a regression random
forest for each dimension of the parameter space (i.e. for each parameter). For a given parameter of
interest, the output of the algorithm is a vector of weights wy that can be used to compute posterior
quantities of interest such as expectation, variance and quantiles. wy provides an empirical posterior
distribution for θm,k ; see Raynal et al. (2018) for more details.
Algorithm 4: ABC-RF for parameter estimation
Input : a vector of θm(h) ,k values (i.e. the k-th component of θm(h) ) and d summary statistics
Learning : construct a regression random forest to infer parameter values
Output : apply the random forest to the observed data η(y), to deduce a vector of weights
(1)
(H)
wy = {wy , . . . , wy }, which provides an empirical posterior distribution for θj,k
wy is used to compute the estimators of the mean, the variance and the quantiles of the
parameter of interest
Ê(θm,k | η(y)), V̂(θm,k | η(y)), Q̂α (θm,k | η(y))

3

Global prior errors
In both contexts, model choice or parameter estimation, a global quality of the predictor can be
computed, which does not take the observed dataset (about which one wants to make inferences)
into account. Random forests make it possible the computation of errors on the training reference
table, using the out-of-bag predictions previously described in the section “ABC-RF for model
choice”.
For model choice, this type of error is called the prior error rate, which is the mis-classification
error rate computed over the entire multidimensional prior space. It can be computed as
H
o
1 X n (h)
I m 6= m̂(η(z(h) )) .
H
h=1

For parameter estimation, the equivalent is the prior mean squared error (MSE) or the normalised mean absolute error (NMAE), the latter being less sensitive to extreme values. These
errors are computed as
H
2
1 X
θm(h) ,k − θ̂m(h) ,k ,
MSE =
H
h=1

NMAE =

H
1 X θm(h) ,k − θ̂m(h) ,k
.
H
θm(h) ,k
h=1

They can be perceived as Monte Carlo approximation of expectations with respect to the prior
distribution.

Local posterior errors
In the present paper, we propose some posterior versions of errors, which target the quality of
prediction with respect to the posterior distribution. As such errors take the observed dataset η(y)
into account, we mention them as local posterior errors.
For model choice, the posterior probability provided by Algorithm 3 is a confidence measure of
the selected scenario given the observation. Therefore
1 − P̂ (m = m̂(η(y)) | η(y))
directly yields the posterior error associated to η(y): P̂ (m 6= m̂(η(y)) | η(y)).
For parameter estimation, when trying to infer on θm,k , a point-wise analogous measure of a
local error can be computed as the posterior expectations
!


2
θm,k − θ̂m,k
E θm,k − θ̂m,k | η(y)
and
E
| η(y) .
(1)
θm,k
We approximate these expectations by
H
X


2
wy(h) θm(h) ,k − θ̂m(h) ,k

and

i=1

H
X
i=1

4

wy(h)

θm(h) ,k − θ̂m(h) ,k
.
θm(h) ,k

We again uses the out-of-bag information to compute θ̂m(h) ,k , hence avoiding the (time consuming)
production of a second reference table, and assume that the weights wy from the regression random
forest are good enough to approximate any posterior expectations of functions of θm,k :
E(g(θm,k ) | η(y)).
Another more expensive strategy to evaluate the posterior expectations (1) is to construct new
regression random forests using the out-of-bag vector of values


θm(h) ,k − θ̂m(h) ,k

2

or

θm(h) ,k − θ̂m(h) ,k
,
θm(h) ,k

depending on the targeted error. The observation η(y) is then given to the forests, targeting the
expectations (1).
Note that the values θ̂m(h) ,k in the previous formulas can be replaced by either the approximated
posterior expectations Ê(θm(h) ,k | η(y)) or the posterior medians Q̂50% (θm(h) ,k | η(y)), again using
the out-of-bag information, to provide the local posterior errors. We found that both in the present
paper (see main text, Materials and Methods section) and for various tests that we carried out on
different inferential setups and datasets (results not shown), the posterior median provides a better
accuracy of parameter estimation than the posterior expectation (aka posterior mean). This trends
also holds for global prior errors that can be computed using either the mean or the median as
point estimates.
As final comment, it is worth noting that so far a common practice consisted in evaluating
the quality of prediction (for model choice or parameter estimation) in the neighborhood of the
observed dataset, that is around η(y) and not exactly for η(y). For model choice, Estoup et al.
(2018) use the so called posterior predictive error rate which is an error of this type. In this case,
some simulated datasets of the reference table close to the observation are selected thanks to an
Euclidean distance, then new pseudo-observed datasets are simulated using similar parameters, on
which is computed the error (see also Lippens et al., 2017, for a similar approach in a standard
ABC framework). However, the main problem of processing this way is the difficulty to specify the
size of the area around the observation, especially when the number of summary statistics is large.
We therefore do not recommend the use of such a “neighborhood” error anymore, but rather to
compute the local posterior errors detailed above as the latter measured prediction quality exactly
at the position of interest η(y).

References
Beaumont, M. A. (2010). Approximate Bayesian Computation in Evolution and Ecology. Annual
Review of Ecology, Evolution, and Systematics, 41:379–406.
Beaumont, M. A., Zhang, W., and Balding, D. (2002). Approximate Bayesian Computation in
Population Genetics. Genetics, 162(4):2025–2035.
Estoup, A., Raynal, L., Verdu, P., and Marin, J.-M. (2018). Model choice using Approximate
Bayesian Computation and Random Forests: analyses based on model grouping to make inferences about the genetic history of Pygmy human populations. Journal de la Société Française
de Statistique, 159(3).

5

Kingman, J. F. C. (1982). On the Genealogy of Large Populations. Journal of Applied Probability,
19(A):27–43.
Lippens, C., Estoup, A., Hima, M. K., Loiseau, A., Tatard, C., Dalecky, A., Bâ, K., Kane, M.,
Diallo, M., Sow, A., Niang, Y., Piry, S., Berthier, K., Leblois, R., Duplantier, J. M., and Brouat,
C. (2017). Genetic structure and invasion history of the house mouse (Mus musculus domesticus)
in Senegal, West Africa: a legacy of colonial and contemporary times. Heredity, 119(2):64–75.
Pudlo, P., Marin, J.-M., Estoup, A., Cornuet, J.-M., Gautier, M., and Robert, C. P. (2016). Reliable
ABC model choice via random forests. Bioinformatics, 32(6):859–866.
Raynal, L., Marin, J.-M., Pudlo, P., Ribatet, M., Robert, C. P., and Estoup, A. (2018). ABC
random forests for Bayesian parameter inference. Bioinformatics. to appear.

6

Supplementary material S4. Details on results from ABC-RF treatments when assuming uniform
priors for the three time period parameters of the studied scenarios.
Table S4.1. Scenario choice for each of the ten replicate analyses using uniform priors for the three time period parameters of the
studied scenarios.
Reference
Best
table
scenario
1
2
3
4
5
6
7
8
9
10
Mean

scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB
scenario
SCB

Posterior
probability
(best scenario)

Votes
S

Votes
SC

Votes
SB

Votes
SCB

Votes
SAU

Votes
SCAU

Votes Votes Votes
SBAU SCBAU SAB

Votes
SCAB

Votes Votes
Prior
SBAB SCBAB error rate

0.013

0.045

0.147

0.462

0.007

0.022

0.020

0.040

0.041

0.099

0.034

0.069

0.778

0.596

0.018

0.027

0.140

0.365

0.012

0.026

0.033

0.096

0.044

0.075

0.072

0.092

0.776

0.398

0.012

0.077

0.182

0.326

0.006

0.030

0.019

0.069

0.038

0.102

0.064

0.074

0.775

0.426

0.014

0.035

0.175

0.405

0.007

0.022

0.022

0.061

0.023

0.091

0.040

0.104

0.777

0.563

0.019

0.048

0.101

0.416

0.010

0.024

0.026

0.063

0.039

0.092

0.055

0.106

0.778

0.547

0.018

0.030

0.130

0.295

0.011

0.030

0.013

0.124

0.075

0.093

0.098

0.082

0.778

0.398

0.016

0.057

0.094

0.308

0.011

0.018

0.015

0.050

0.028

0.113

0.058

0.231

0.775

0.511

0.019

0.037

0.109

0.359

0.007

0.018

0.015

0.049

0.057

0.080

0.105

0.145

0.777

0.474

0.010

0.052

0.114

0.286

0.017

0.023

0.014

0.070

0.069

0.136

0.098

0.113

0.777

0.460

0.013

0.057

0.124

0.249

0.009

0.016

0.012

0.067

0.061

0.133

0.091

0.168

0.778

0.442

0.015

0.047

0.132

0.347

0.010

0.023

0.019

0.069

0.048

0.101

0.072

0.118

0.777

0.481

We empirically evaluated the influence of shape of prior distributions for the time periods on our inferences by conducting all ABC-RF analyses assuming a set of uniform
priors bounded between 100 and 500,000 generations. In the main document, prior values for time periods were drawn from log-uniform distributions bounded between 100
and 500,000 generations. We report values for the proportion of votes, prior error rates and posterior probabilities of the best scenario on ten replicate analyses based on ten
different reference tables. Scenarios are depicted in Figure 2. For each reference table, the number of datasets simulated using DIYABC was set to 150,000 and the number of
RF-trees was 3,000. The scenario SCB was the best supported for all replicate analyses: it involves a bottleneck event in S. g. flaviventris right after divergence, a population
size contraction in the ancestral population and not any secondary contact with asymmetrical genetic admixture from S. g. gregaria into S. g. flaviventris.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Table S4.2. Estimation of the divergence time between S. g. gregaria and S. g.
flaviventris for ten replicate analyses using uniform prior distributions for the three
time period parameters under the best supported scenario (scenario SCB).
tdiv (G)
reference table 1
reference table 2
reference table 3
reference table 4
reference table 5
reference table 6
reference table 7
reference table 8
reference table 9
reference table 10
Mean
SD

Median
10236.6
7603.0
8500.0
10598.5
9226.0
9665.0
8675.5
10281.6
8845.0
7909.7
9154.1
1027.5

q5%
3678.5
2311.2
2788.8
3564.4
3147.9
3381.5
2572.3
2919.8
3271.9
2040.1
2967.6
541.6

q95%
25457.0
23020.3
19401.0
24444.5
21286.6
24445.2
26375.8
27349.0
24094.7
21333.4
23720.8
2476.4

We empirically evaluated the influence of shape of prior distributions for the time periods on our inferences by
conducting all ABC-RF analyses assuming a set of uniform priors bounded between 100 and 500,000
generations. Median value and 90% CI for priors are 146,936 and 13,195 – 498,867, respectively. Replicate
analyses have been processed on different reference tables. For each reference table, the number of datasets
simulated using DIYABC was set to 100,000 and the number of RF- trees was 2,000. Divergence times are
given in number of generations. SD stands for standard deviations computed from the ten values of median, 5%
quantile and 95% quantile estimated from the ten replicate analyses.

bioRxiv preprint doi: https://doi.org/10.1101/671867; this version posted November 25, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Figure S4.1. Estimation of the time since divergence between the two desert locust
subspecies as a function of time scales using uniform prior distributions for the three
time period parameters under the best supported scenario (scenario SCB).
Simulated datasets (5,000 par divergence time) were generated for fixed divergence time
values of 100 ; 250 ; 500; 1,000 ; 2,500; 5,000 ; 10,000 ; 25,000 ; 50,000; 100,000; and
250,000 generations. The median (plain lines) and 90% credibility interval (90% CI; dashed
lines), averaged over the 5,000 datasets, are represented. Divergence time values are in
number of generations.

