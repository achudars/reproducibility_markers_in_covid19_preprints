medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

1

An Efficient and Robust Approach to Detect Auditory Evoked Responses using

2

Adaptive Averaging

3
4

Haoyu Wang1,2#, Xu Ding1#, Bei Li3#, Xueling Wang1,3, Zhiwu Huang1,3, Yunfeng

5

Hua1,2*, Hao Wu1,2,3*

6
7

1

Ear Institute, Shanghai Jiao Tong University School of Medicine, Shanghai, China

8

2

Shanghai Institute of Precision Medicine, Shanghai, China

9

3

Department of Otolaryngology-Head and Neck Surgery, Shanghai ninth people’s

10

Hospital, Shanghai Jiao Tong University School of Medicine

11

#

12

* Corresponding authors

These authors contribute equally

13
14
15

ABSTRACT

16

Objective: the auditory brainstem response is widely employed to evaluate hearing

17

function of test subjects for both clinical and research purposes. Currently, hearing

18

threshold estimation still relies on trained professionals to assess the audiograms,

19

resulting in the largest cost component of the test. The objective of this study was to

20

develop an automated approach to objectively and reliably detect the hearing thresholds.

21

Design: From eight mice and four human participants, we recorded for each sound level

22

hundreds of single sweeps and asked how many sweeps were minimum required for a
NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

1

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

23

response being detected from cumulative averages using correlation function. We

24

named this procedure the adaptive averaging approach.

25

Result: We found an exponential increase in the required sweeps at near-threshold

26

sound levels, modeling of which allowed objective and precise threshold estimation.

27

The results from mouse and human recordings deviated consistently less than 5 dB

28

from the expert-assessed values. Moreover, up to 69 % sweeps at suprathreshold sound

29

tests were found redundant for the threshold estimation and could be avoided to

30

improve test efficiency.

31

Conclusions: The adaptive averaging approach achieved objective and precise hearing

32

threshold detection and implementation of this approach in commercial recording

33

devices will automate the hearing test in a more reliable and cost-effective way.

34
35
36

INTRODUCTION

37

The auditory brainstem responses (ABRs) are brain electrical potential changes due to

38

the synchronous neuronal activities evoked by suprathreshold acoustic stimuli (Jewett

39

et al., 1970). In a hearing test, surface electrodes are placed on the scalp of the test

40

subject to monitor the threshold sound level below which ABRs are no longer

41

detectable. As a non-invasive technique, the ABR test has been worldwide employed in

42

hospitals and clinics to exam auditory function, particularly for infants, adults with

43

learning disabilities as well as patients undergoing operation, to whom a test through

44

communication or body movements is not applicable (Jacobson et al., 1990). Typical
2

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

45

ABR waveform is composed of five peaks in the early onset (up to ten milliseconds) of

46

sound evoked potentials. These peaks appear to be one millisecond (ms) apart and have

47

an amplitude of few hundreds nanovolt (nV), corresponding to synchronous activities

48

arising from (I) auditory nerve, (II) cochlear nucleus, (III) superior olivary complex,

49

(IV) lateral lemniscus and (V) inferior colliculus, respectively (Basbaum, 2008). Over

50

decades, the ABR has not only been used to estimate the hearing threshold, also features

51

of the waveform including peak latencies and amplitudes provide clinically significant

52

information, for instance hidden hearing loss (Bramhall et al., 2018b; Mehraei et al.,

53

2016; Ridley et al., 2018), tinnitus (Bramhall et al., 2018a; Castaneda et al., 2019), site

54

of lesions or tumors in the auditory system (Roeser et al., 2007) based on the way how

55

the waveform is altered.

56
57

Although the ABR test itself is considered objective, the waveform recognition at near-

58

threshold sound levels is not always trivial and requires visual inspection from trained

59

professionals under established guidelines. Currently, the test still demands audiologists

60

or clinicians who are experienced in this technique to conduct recordings and interpret

61

outcomes on site, which raises the largest cost component in such test. Moreover,

62

according to a previous report (Vidler et al., 2004) cases with limited consensus about

63

the assessed hearing thresholds are not rare, because the accuracy of waveform

64

recognition highly depends on the skill and the experience of the assessors, especially

65

when untypical waveforms or high background noise level are encountered. As

66

extensive hearing test is employed for instance to diagnose progressive and acquired
3

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

67

hearing loss in preschool children (Lu et al., 2014; Lu et al., 2011) as well as to evaluate

68

drug ototoxicity, there is a clear need for an automated approach of high accuracy and

69

robustness to make the test less labor-intense and more objective.

70
71

Single-sweep ABR recordings are contaminated with background noise generated from

72

muscle activity, adjacent power lines, etc. Therefore, it is almost exclusively required

73

averaging over more than hundreds of sweeps to suppress random noise peaks, so that

74

the signal-to-noise ratio (SNR) of the average responses is sufficient for an

75

unambiguous ABR waveform recognition. In clinic, the waveform assessment is

76

mainly based on visual inspecting of average responses and assisted by statistic

77

measures like well-known single-point F ratio (Fsp) to evaluate the signal and noise

78

characteristics (Elberling et al., 1984). Despite of recent progress using machine

79

learning (McKearney et al., 2019), reliable assessments still heavily involve human

80

supervision in a semi-objective fashion. In the last few decades, several methods have

81

been proposed to automate the procedure. With the criterion whether sweep averages

82

or single-sweeps are processed, they fall into two major categories, namely feature- and

83

statistics-based detection strategies (Dobie, 1993). The former utilizes either

84

quantification of the similarity between measured waveforms and existing templates

85

from database (Valderrama et al., 2014), or feature recognition using trained artificial

86

neural networks on human-annotated datasets (Alpsan et al., 1991; McKearney et al.,

87

2019), but detection accuracy is still limited by the waveform heterogeneity, varying

88

data quality, as well as inconsistent training data (McKearney et al., 2019). The latter
4

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

89

measures either inter-sweep variability to detect stable signals using correlation

90

function (Bershad et al., 1974; Weber et al., 1980; Xu et al., 1995) or level of residual

91

noise (Don et al., 1994; Elberling et al., 1984) to describe the ‘quality’ of the signal

92

through a scoring procedure, for which calibrations are needed for thresholding the

93

signals with arbitrary boundary. Although some of these techniques have already been

94

integrated in commercial devices, they are mainly employed for crosscheck purpose

95

due to frequent detection errors caused by noise-related artifacts.

96
97

To better understand the noise and ABR characteristics, we first recorded from mice at

98

each sound level hundreds of sweeps and found pairwise correlation coefficients of

99

those sweeps followed a normal distribution. Upon declined sound levels, a series of

100

peaks with shifted center towards zero were obtained as a result of progressively

101

overwhelmed responses in noise. This implies consistent threshold detection by

102

thresholding quantified correlation requires comparable SNRs across recordings and

103

frequent calibration, however neither of which is practical under daily experimental

104

settings. In the present study, we overcame this limitation by a novel approach using

105

adaptive averaging, in which sweeps were added iteratively for averaging in order to

106

test how many sweeps are required for stimulus-related waveform being detected

107

through cross correlation measurement. The hearing threshold was then objectively

108

estimated by modeling the change in the minimal sweep numbers at peri-threshold

109

sound levels. The autodetected thresholds were found deviated from the expert-

110

assessed ground truth consistently less than 5 dB. In addition, the minimal sweep
5

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

111

numbers are instructive for an efficient averaging strategy based on SNR adaptation.

112

When implemented in commercial ABR devices, this automated approach could stop

113

on-going averaging upon detected waveforms and save up to 69 % redundant sweeps

114

according to our reconstructed experiments, and thereby shorten the test duration

115

without compromising the accuracy of test results.

116
117

MATERIALS AND METHODS

118
119

Animals and Ethics

120

C57BL/6 mice (wt) were purchased from Sino-British SIPPR/BK Lab.Animal Ltd

121

(Shanghai, China). The terc-/- mouse line was kindly donated by Lin Liu (Nankai

122

University, China) and bred in house. This study is conduct at the Ear Institute and the

123

Hearing and Speech Center of Shanghai Ninth People’s Hospital. All procedures were

124

reviewed and approved by the Institutional Authority for Laboratory Animal Care of

125

the hospital (HKDL2018503).

126
127

ABR recordings

128

Mouse ABRs were recorded using a TDT RZ6/BioSigRZ system (Tuck-Davis Tech.

129

Inc., US) in a sound-proof chamber. 7-week-old mice were anesthetized through

130

intraperitoneal injection of hydrate chloride (500 mg/kg). Through the test, animal body

131

temperature was maintained at around 37°C using a regulated heating pad (Harvard

132

Apparatus, US) and rectal thermal probe. Electrical potential time courses were
6

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

133

registered via subdermal needle electrodes (Rochester Electro-Med. Inc., US) placed at

134

vertex (record electrode), left infra-auricular mastoid region (reference electrode) and

135

right shoulder region (ground electrode) of the test subjects. The acoustic stimuli of

136

3 ms tone pips at 16 kHz were delivered via a multi-field magnetic speaker (Tuck-Davis

137

Tech. Inc., US) positioned 10 cm from the vertex of the test subjects. The stimulus rate

138

was 21 per second and the evoked potentials were sampled at 24 kHz. 500 sweeps were

139

acquired at each test sound level starting from 90 dB to 0 dB with an increment of 5 dB.

140

For one animal, we acquired signals evoked by peri-threshold sound levels (±10 dB

141

with a 1-dB increment procedure).

142
143

Human ABRs were collected from four adult volunteers aged between 21 and 29 years-

144

old without history in abnormal auditory function using a commercial device

145

(Intelligent Hearing Systems, US) with Smart EP software. An electromagnetically

146

shielded insert earphone (ER-3) was applied to deliver click stimulation to the left ear

147

at a rate of 37.1 per second. The recorded potentials were amplified by a factor of

148

100,000 and filtered with a 100 Hz (high-pass) and 3000 Hz (low-pass) filter. Averaged

149

signals over 500, 1000, and 2000 sweeps were acquired 3 times at each test sound level

150

starting from 60 dB to 0 dB with an increment of 5 dB.

151
152

Analysis of single-sweep correlation

153

Analysis of inter-sweep correlation was conduct in mouse recordings. All acquired

154

single-sweep ABRs were analyzed using self-written routines in MATLAB
7

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

155

(MathWorks Inc., US). The artifact rejection level was set to 55 μV and a high-pass

156

filter (smoothing splines with a smoothing parameter of 0.5, MATLAB function) was

157

applied to the raw data. The pairwise correlation was calculated using MATLAB

158

function from sweeps cropped with a temporal window of 1-6 ms post-stimulation

159

onset, resulting in 61,075 correlation coefficients from 350 sweeps at each test sound

160

levels. The histograms of the obtained coefficients were fitted with a normal

161

distribution.

162
163

Adaptive averaging method

164

For the mouse dataset, each iteration recruited 50 sweeps into MATLAB workspace

165

until all 350 sweeps were added. Within iterations all sweeps in the workspace were

166

subdivided randomly into two groups for separated averaging, between which a cross

167

correlation function was computed using MATLAB function. The existence of

168

stimulus-related waveform was tested based on whether the obtained correlation has a

169

maximum at a lag less than 1% of total signal length (1-6 ms post-stimulation onset).

170

In each iteration the lag value was measured three times with regrouped sweeps to reject

171

cases with coincidently overlapped signals at required lag value. For each sound level,

172

it was measured at which iteration stimulus-related response was detected. The

173

maximum number of executed iterations was set to 7, which is limited to total sweep

174

numbers (after excessive amplitude exclusion). A sigmoid function (1) was employed

175

to model the minimum required iteration numbers after normalization N(S) at each

176

sound level S and a growth of 0.9 in the function corresponds to the estimated hearing
8

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

177

threshold T. The constant k equals 0.6, which was obtained from the best fitting.

𝑁(𝑆) =

178

1
1+𝑒 −𝑘(𝑆−𝑇)

(1)

179

As for the human dataset, averaged responses over 500, 1000 and 2000 sweeps were

180

loaded in each iteration. Lag value was measured three times with a combination of 2

181

out of 3 averaged responses of the same sweep number. The maximum executed

182

iteration number was set to 7. For iterations requiring averages over 1500 or more than

183

2000 sweeps, the combined average responses avg(M+N) containing M plus N sweeps

184

were obtained from the weighted averaging of avg(M) and avg (N) using the equation

185

(2).

186

𝑎𝑣𝑔(𝑀 + 𝑁) =

𝑀•𝑎𝑣𝑔(𝑀)+𝑁•𝑎𝑣𝑔(𝑁)
𝑀+𝑁

(2)

187
188

The maximal lag value allowed for a true ABR waveform was 2 % of the total signal

189

length (0-10 ms post-stimulation onset). Same as for the mouse data, hearing threshold

190

was interpolated from a fitting with sigmoid function at a growth of 0.9.

191
192

Hearing Threshold Assessment

193

All hearing thresholds were verified by visual inspection of five independent clinicians

194

blinded to the test subjects. For each experiment, recordings averaged either over fixed

195

sweep counts (the conventional averaging) or according to the outcomes from the

196

adaptive averaging. Averaged audiograms were provided in MATLAB figures which

197

enable interactive zoom function for better waveform recognition. Results were

198

collected and mean values were calculated using the 3/5 method with the highest and
9

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

199

the lowest estimation dropped.

200
201

RESULTS

202

Correlations between Single-sweep ABR Recordings

203

As ABRs are usually embedding in high level background activities as well as system

204

noise, smooth baseline and clear waveform, if present, are usually obtained after an

205

averaging over hundreds of sweeps (Fig 1 A). We recorded from mouse single-sweeps

206

upon 16 kHz tone-pips at different levels of loudness. After a small fraction had been

207

excluded due to excessive amplitudes caused by movement artifacts, more than 350

208

sweeps were obtained and then filtered through a high-pass filter (Nishida et al., 1993)

209

to remove low frequency fluctuations in short latency ABR components (Suppl 1).

210

Pairwise correlations were computed from the sweeps cropped with a temporal window

211

of 1-6 ms post-stimulation onset. The obtained correlation coefficients (CCs) at each

212

sound level were found following normal distributions (Fig 1 B). When sweeps were

213

recorded upon suprathreshold sound levels, corresponding shifts of the CC distributions

214

were observed, indicating increased degrees of positive correlation. In line with

215

previous studies (Galbraith, 2001), this result confirmed that ABR waveforms in single

216

sweeps are highly correlated and measurable using correlation function. Moreover,

217

when fit with a single gaussian function, invariable peak width (0.1778 ± 0.0154) was

218

obtained from each distribution, implying reliable auditory responses with identical

219

waveform and an add-on effect of constant uncorrelated noises.

220
10

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

221
222

Objective Threshold Detection using Correlation Coefficients

223

Next, we tested whether one can use correlation measurements to detect objectively the

224

hearing thresholds. Recordings were performed using acoustic stimuli varying from 90

225

dB to 0 dB in three wildtype mice (wt) of normal hearing and five telomerase-knock-

226

out mice (terc-/-) of high percentage in deafness. Representative responses of a wt and

227

a terc-/- animal were illustrated in Fig 2 A and the medians of CCs were plotted as a

228

function of test sound levels (Fig 2 B). Between two rising phases, a shift of about

229

30 dB was found, consistent with the threshold elevation estimated by visual inspection.

230

This result confirmed CCs as a promising measure to detect the hearing threshold, as

231

derived from early theoretical work (Bershad et al., 1974). In order to obtain a critical

232

test boundary between supra- and sub-threshold sound level, we computed from eight

233

animal at each sound level the medians of CCs and aligned them to the visual inspected

234

thresholds (Fig 2 C). Sweeps upon stimuli above hearing threshold were found to have

235

stronger positive correlation with a median greater than 0.0119 ± 0.0034. Although this

236

empirically determined value could be used to threshold detectable ABRs, the detection

237

accuracy was limited by close values obtained at near-threshold levels as well as inter-

238

trial variability (data not shown).

239
240
241

Adaptive Averaging Method

242

It is impractical to keep identical recording conditions (including electrode position,
11

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

243

depth of anesthesia, etc.) for multiple recording sessions or perform frequent calibration

244

before each experiment for daily use. In order to develop a more robust and applicable

245

approach, we designed a novel procedure to adapt sweep number for averaging to the

246

requirement for waveform detection. This means, instead of thresholding a detectable

247

positive correlation using pre-calibrated critical test boundary, the new approach asks

248

for how many sweeps are required to generate two average responses that are positively

249

correlated above certain criterion (Fig 3 A). As the noise level is suppressed

250

exponentially by averaging over increasing number of sweeps, this method adapts

251

intrinsically to varying data quality and works in a calibration-free fashion.

252
253

In detail, recorded sweeps were randomly divided into two groups and cross correlation

254

was calculated between group averages (Fig 3 C, see Fig 3 B for results using

255

conventional averaging). In the presence of stimulus-related waveforms, one expected

256

a neglectable lag (e.g. less than 1 % of analyzed data points) at which maximum

257

correlation was found (Fig 3 D). To reject false positives caused by coincident overlap

258

of noise peaks, each lag test required consistent results from three parallel

259

measurements on regrouped sweeps. For each failed lag test, additional sweeps were

260

added and the random split averaging was repeated, until a response was detected or

261

the maximum number of iterations was reached. As shown in Fig 3 E, the number of

262

executed iterations increased rapidly starting at near-threshold sound levels and

263

reaching its maximum at the first subthreshold sound level as expected. Although the

264

sharp transition allows direct readout of the lowest suprathreshold sound level, we
12

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

265

further tested whether precise estimation beyond the increment between test sound

266

levels could be achieved by modeling the result (Fig 3 F). From one animal, sweeps

267

were acquired upon peri-threshold sound levels with 1-dB increment and the increase

268

in executed iterations was fit with a sigmoid function. Similar fit parameters were

269

obtained from test datasets of 1-dB and 5-dB increment (Fig 3 F), indicating possible

270

interpolation of the threshold from regular 5-dB increment procedure to achieve 1-dB

271

detection precision based on the established model.

272
273
274

Accuracy and Efficiency of the Adaptive Averaging Method

275

To evaluate the performance of the proposed adaptive averaging approach, we applied

276

the procedure to ABR recordings from eight mice as well as four human test participants.

277

Note that for human test, average responses were collected multiple times with different

278

sweep numbers to simulate the random split averaging over sweeps (see Suppl 2 for the

279

variant of flowchart), as the commercial devices in our hospital did not support

280

exporting single-sweeps. When compared to the waveform assessments of five

281

independent clinicians, the new approach yielded correct hearing threshold detection

282

(deviated less than 5 dB from the expert-assessed ground truth) in 8/8 cases for mouse

283

and 4/4 for human (Fig 4 A), indicating a detection accuracy of near human

284

performance. In addition, visual inspection of the adaptive averaged responses and

285

those averaging over a fixed sweep counts yielded similar test results (Fig 4 A),

286

suggesting limited contribution of redundant sweeps in conventional averaging to
13

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

287

visual waveform recognition. When compared to the conventional averaging at all

288

suprathreshold plus the first two subthreshold stimuli, the new method required up to

289

69.6 ± 5.8 % and 36.2 ± 21.1 % less sweeps for a correct threshold estimation in the

290

mouse and human ABR tests, respectively (Fig 4 B).

291
292

Discussion

293
294

In the last few decades, attempts were made towards automated ABR analysis. Several

295

techniques were proposed including the usage of correlation functions to discriminate

296

stable components (ABR waveforms) from random fluctuations (system noise and

297

background activities). In this study we found pairwise CCs between sweeps follows a

298

normal distribution and medians of which reflect the power of stimulus-related

299

waveform over baseline activities. The observed broadening of the distribution is

300

probably caused by random fluctuations which by chance weak correlate or anti-

301

correlate with the true responses. The observed constant peak widths for different test

302

sound levels implies low variation in the ABR waveforms and comparable noise level

303

within single recording session (Fig 1 B). This finding supports the notation that signal

304

transmission in the auditory system is of high fidelity and SNR is the major challenge

305

for detecting true hearing thresholds.

306
307

In practice, comparable SNRs are expected within single recording session except for

308

electrode displacement or weak anesthesia (data not shown), allowing threshold
14

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

309

detection from a pre-calibrated system based on correlation measurement (Fig 2 C). It

310

is, however, unrealistic to keep the same experimental settings including the same

311

system, electrode position, anesthesia depth, etc. for different test subjects as well as in

312

multiple recording sessions, hampering a plug-in application of correlation-based

313

threshold autodetection. In fact, we showed CCs aligned to the hearing thresholds vary

314

between 0.009 and 0.0199 due to different SNRs under our experimental settings (Fig

315

2 C). This variation is about the same magnitude to those caused by different peri-

316

threshold sound levels, which leads to limited detection accuracy.

317
318

The basic idea of the adaptive averaging approach is to keep a standard waveform

319

detection criterion but adapt the SNR by iteratively increased sweep number for

320

averaging. In previous study of middle latency response analysis (Xu et al., 1995), it

321

has been proposed that neglectable lag in cross correlation between two consecutively

322

recorded average signals can serve as a good indication for suprathreshold responses,

323

because in contrast to stimulus-related responses, random distributed noise peaks may

324

superimpose at any time shifts. Here we adapted this idea to detect ABR waveforms in

325

two subgroup averages of sweeps. The underlying logic is as follows: one starts with

326

constant noise level and unknown signal power; each iteration recruits more sweeps in

327

the averaging to suppress progressively the noise level of the updated average responses

328

until the true ABR waveform is no longer overwhelmed in noise and becomes

329

detectable by cross correlation function. Thereby, one expects (1) converging lags to

330

zero requires averaging over less sweeps for recordings containing strong responses
15

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

331

than those with weak responses; (2) the absence of response leads to non-converging

332

lags irrespective of sweep numbers used for averaging. These are supported by our

333

observations that detection of responses upon suprathreshold stimuli requires minimum

334

number of iterations (Fig 3 E), as well as three-fold measured lags show large variation

335

at subthreshold sound levels (Fig 3 D). The steep increase in the number of executed

336

iterations (equivalent to sweep numbers used in averaging) is characteristic for the peri-

337

threshold responses and insensitive to the absolute values of SNRs, enabling a

338

calibration-free automatic threshold detection. Further we showed modeling of the

339

number of executed iterations enables more precise threshold estimation beyond the

340

increment of test sound levels through interpolation, in our case up to 1 dB (Fig 3 F).

341

Alternatively, the adaptive averaging approach enables a test strategy with

342

progressively reduced increment at peri-threshold sound levels to achieve required

343

precision.

344
345

For both mouse and human recordings, the automated approach is extreme reliable in

346

detecting hearing thresholds within a maximum error of ± 5 dB from the expert-

347

assessed ground truths provided by five independent clinicians (Fig 4 A). Besides, the

348

observation variation is comparable between the visual inspected groups either using

349

conventional or adaptive averaging, as well as between visual inspection and automatic

350

detection (Fig 4 A). Based on these results we conclude that the automated approach

351

achieves accurate and robust threshold estimation of near human performance. When

352

to stop averaging is an important decision to make during the ABR data collection, it
16

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

353

not only makes the hearing test more efficient by avoiding prolonged acquisition and

354

redundant data, but also specifies the confidence level of waveform interpretation (Don

355

et al., 1996). Since the underlying principle of the new approach is to average just

356

enough sweeps for the SNR above detection limit, intrinsically it returns instruction to

357

stop averaging when a response is detected. Meanwhile, it is temporally efficient to

358

terminate test when previous iterations with higher sound levels fail to detect a response,

359

because in this case acquired sweeps at lower sound level is supposed to contain pure

360

noise. The reconstructed experiments to compare required sweep number by the

361

adaptive averaging and the fixed sweep counts in the conventional averaging show a

362

reduction up to 69 % and 36 % for mouse and human ABR test, respectively (Fig 4 B).

363

Since the maximum sweep count used here to rule out undetectable ABRs was chosen

364

more than necessary, further improvement can be made by introducing single-point F

365

ratio (Elberling et al., 1984) or residual noise analysis (Don et al., 1994) to terminate

366

averaging. In fact, the acquisition speed of modern ABR devices is usually not a

367

limiting factor (more than 2000 sweep per minute), maybe more importantly the

368

adaptive averaging approach sets the minimum requirement for the data quality that

369

ensures unambiguous waveform recognition by both human and machine.

370
371

The present work has demonstrated a robust and efficient approach to automate hearing

372

threshold detection from recorded ABRs. In contrast to other existing techniques, the

373

basic idea of our approach is not to quantify how likely the recording contains a

374

response, but for the first time to model how many sweeps are required for an averaged
17

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

375

response to counteract the background noise and become detectable by cross correlation

376

function. By doing so, we bypassed the long-lasting challenges caused by varying SNR

377

of ABR recordings and in addition obtained a strategy to stop averaging in an

378

unsupervised fashion. Hence, the proposed method has a remarkable potential of being

379

implemented in commercial ABR devices to make hearing test more reliable and cost-

380

effective.

381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410

References
Alpsan, D., Ozdamar, O. 1991. Brain-Stem Auditory Evoked-Potential Classification by
Backpropagation Networks. Ieee Ijcnn, 1266-1271.
Basbaum, A.I. 2008. The senses : a comprehensive reference Elsevier, Amsterdam ; New York.
Bershad, N.J., Rockmore, A.J. 1974. On estimating signal-to-noise ratio using the sample
correlation coefficient. IEEE Trans. Inf. Theory IT-20, 112-113.
Bramhall, N.F., Konrad-Martin, D., McMillan, G.P. 2018a. Tinnitus and Auditory Perception After a
History of Noise Exposure: Relationship to Auditory Brainstem Response Measures. Ear
Hear 39, 881-894.
Bramhall, N.F., McMillan, G.P., Kujawa, S.G., Konrad-Martin, D. 2018b. Use of non-invasive
measures to predict cochlear synapse counts. Hear Res 370, 113-119.
Castaneda, R., Natarajan, S., Yule Jeong, S., Na Hong, B., Ho Kang, T. 2019. Electrophysiological
changes in auditory evoked potentials in rats with salicylate-induced tinnitus. Brain Res.
Dobie, R.A. 1993. Objective response detection. Ear Hear 14, 31-5.
Don, M., Elberling, C. 1994. Evaluating residual background noise in human auditory brain-stem
responses. J Acoust Soc Am 96, 2746-57.
Don, M., Elberling, C. 1996. Use of quantitative measures of auditory brain-stem response peak
amplitude and residual background noise in the decision to stop averaging. J Acoust Soc
Am 99, 491-9.
Elberling, C., Don, M. 1984. Quality estimation of averaged auditory brainstem responses. Scand
Audiol 13, 187-97.
Galbraith, G.C. 2001. Enhanced brainstem and cortical evoked response amplitudes: single-trial
covariance analysis. Percept Mot Skills 92, 659-72.
Jacobson, J.T., Jacobson, C.A., Spahr, R.C. 1990. Automated and conventional ABR screening
techniques in high-risk infants. J Am Acad Audiol 1, 187-95.
Jewett, D.L., Romano, M.N., Williston, J.S. 1970. Human auditory evoked potentials: possible brain
stem components detected on the scalp. Science 167, 1517-8.
Lu, J., Huang, Z., Ma, Y., Li, Y., Mei, L., Yao, G., Wang, Y., Shen, X., Wu, H. 2014. Comparison between
18

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439

hearing screening-detected cases and sporadic cases of delayed-onset hearing loss in
preschool-age children. Int J Audiol 53, 229-34.
Lu, J., Huang, Z., Yang, T., Li, Y., Mei, L., Xiang, M., Chai, Y., Li, X., Li, L., Yao, G., Wang, Y., Shen, X.,
Wu, H. 2011. Screening for delayed-onset hearing loss in preschool children who
previously passed the newborn hearing screening. Int J Pediatr Otorhinolaryngol 75,
1045-9.
McKearney, R.M., MacKinnon, R.C. 2019. Objective auditory brainstem response classification
using machine learning. Int J Audiol, 1-7.
Mehraei, G., Hickox, A.E., Bharadwaj, H.M., Goldberg, H., Verhulst, S., Liberman, M.C., ShinnCunningham, B.G. 2016. Auditory Brainstem Response Latency in Noise as a Marker of
Cochlear Synaptopathy. J Neurosci 36, 3755-64.
Nishida, S., Nakamura, M., Shibasaki, H. 1993. Method for single-trial recording of somatosensory
evoked potentials. J Biomed Eng 15, 257-62.
Ridley, C.L., Kopun, J.G., Neely, S.T., Gorga, M.P., Rasetshwane, D.M. 2018. Using Thresholds in
Noise to Identify Hidden Hearing Loss in Humans. Ear Hear 39, 829-844.
Roeser, R.J., Valente, M., Hosford-Dunn, H. 2007. Audiology. Diagnosis. 2nd ed. Thieme, New York.
Valderrama, J.T., de la Torre, A., Alvarez, I., Segura, J.C., Thornton, A.R., Sainz, M., Vargas, J.L. 2014.
Automatic quality assessment and peak identification of auditory brainstem responses
with fitted parametric peaks. Comput Methods Programs Biomed 114, 262-75.
Vidler, M., Parkert, D. 2004. Auditory brainstem response threshold estimation: subjective
threshold estimation by experienced clinicians in a computer simulation of the clinical test.
Int J Audiol 43, 417-29.
Weber, B.A., Fletcher, G.L. 1980. A computerized scoring procedure for auditory brainstem
response audiometry. Ear Hear 1, 233-6.
Xu, Z.M., De Vel, E., Vinck, B., Van Cauwenberge, P. 1995. Application of cross-correlation function
in the evaluation of objective MLR thresholds in the low and middle frequencies. Scand
Audiol 24, 231-6.

440

Acknowledgement

441

We would like to thank Yun Li, Kun Han, Yan Ren, Lu Yang and Haifeng Li from

442

Shanghai Ninth People’s Hospital for help with ABR visual inspection. We would like

443

to thank Dr. Guangming Chen and Dr. Lin Liu for providing terc-/- mice. This study

444

was supported by The Program for Professor of Special Appointment (Eastern Scholar)

445

at Shanghai Institutions of Higher Learning (QD2018015 to Y.H.), The Elite Program

446

at Shanghai Ninth People’s Hospital (JY201802 to Y.H., Z.H.), B.L was supported by

447

The National Science Foundation for Young Scientists of China (No81700903) and The
19

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

448

SHIPM-mu Fund from Shanghai Institute of Precision Medicine (JC201808).

449
450

Declarations of interest

451
452

The authors have declared that no conflicts of interest exist.

453
454
455

Author contribution

456

Y.H., H.W designed the study; B.L. and X.D. acquired the data; Y.H. and H.Y.W created

457

the software; Y.H., H.Y.W., X.W, and Z.H., analyzed and interpreted the data. Y.H.,

458

H.Y.W., H.W drafted and revised the work.

459
460
461

Figure Legends

462

Figure 1. Pairwise correlation coefficients of single-sweep ABR recordings. (A)

463

sweeps were recorded at 4 different sound levels (grey lines) and characteristic ABR

464

waveforms, if exist, were obtained via averaging (colored lines). (B) Histograms of

465

pairwise correlation coefficients that were computed from the recorded sweeps in A

466

(black lines). A normal distribution (colored lines) was used to fit each histogram. The

467

mean value of the resulted full width at haft maximum was 0.1778 ± 0.0154 (mean ±

468

s.d.).

469
20

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

470

Figure 2. Threshold estimation using correlation coefficients. (A) Representative

471

audiograms averaged over 350 sweeps were recorded from mice of normal (black lines)

472

or impaired hearing (red lines). Waveforms with different peak amplitudes were

473

observed for recordings at suprathreshold stimuli (above 25 dB for animal of normal

474

hearing and 55 dB for animal of impaired hearing). (B) The same sweeps as for A were

475

used to compute pairwise correlation coefficients at each sound level, respectively. The

476

median correlation coefficients were plotted against corresponding test sound levels

477

and fitted with a sigmoid function. Delayed raising of the medians upon increasing

478

sound levels was observed in animal with impaired hearing, which is in line with the

479

threshold elevation illustrated in A. (C) Median correlation coefficients at peri-

480

threshold sound levels were measured from eight mice. Each curve was aligned to

481

visual inspected thresholds at zero. Mean value of the median correlation coefficients

482

at hearing threshold was 0.0119 ± 0.0034 (mean ± s.d.) varying between 0.0090 and

483

0.0199.

484
485

Figure 3. Threshold detection using adaptive averaging method (A) Flowchart of the

486

adaptive averaging method. (B) Representative mouse audiogram averaged over 350

487

sweeps. The visual inspected threshold was between 25 dB and 30 dB. (C) Subgroup

488

averages at each sound level (black versus grey lines) were obtained by averaging

489

randomly split two groups of sweeps. The intermediate averages were updated by

490

iterations for measuring the cross correlation. (D) The absolute lags in data point of the

491

maximum cross correlation were three-fold measured at each test sound level. For
21

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

492

recordings upon suprathreshold stimuli (dots) a consistent small absolute lag values (no

493

more than 1 data point) were obtained, while non-zero values with large variations

494

(31.11 ± 16.12) were observed for cases of subthreshold stimuli (cycles). (E) In each

495

iteration 50 new sweeps were added into the data pool for random split averaging, until

496

the updated lag value was no more than k data point (in this case k = 1). Minimum

497

required iterations were plotted for tests upon suprathreshold (dots) and subthreshold

498

sound levels (cycles) with an upper limit at 7 to avoid infinite iterations. It is

499

recommended to stop a test, when the hearing threshold is confirmed by two

500

consecutive runs without detectable waveforms (black cycles), so that iterations at

501

lower test sound levels are saved (red cycles). (F) The stepwise increase in required

502

iterations was fitted by a sigmoid function after normalization, allowing threshold

503

interpolation beyond the increment of test sound levels. As calibrated with peri-

504

threshold test with 1-dB increment, the most accurate threshold estimation corresponds

505

to a growth of 0.9 in the best fitted function.

506
507

Figure 4. Performance of the adaptive averaging method in detecting hearing threshold.

508

(A) ABR recordings from mice (n=8) and human participants (n=4) were evaluated by

509

5 independent clinicians or the automated approach. As ground truth, the mean

510

thresholds were used which were based on human inspection of conventional averaged

511

responses with the highest and the lowest value excluded. The thresholds reported by

512

clinicians based on the mouse ABR audiograms using conventional averaging (fixed

513

sweep counts, black dots) and the adaptive averaged responses (varying sweep numbers,
22

medRxiv preprint doi: https://doi.org/10.1101/19003301; this version posted August 13, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

514

red dots) deviated from the expert-assessed ground truth by -0.250  2.719 dB and

515

1.875  3.487 dB, respectively, while it was 0.000  3.590 dB for the automatic detected

516

threshold (red cycles). Similar results were obtained from human ABR audiograms with

517

estimation deviations of -0.083  1.200 dB for the conventional averaging (black dots)

518

and 0.083  1.200 dB for the adaptive averaging (red dots) through visual inspection,

519

compared to 0.1671.258 dB for the automated approach (red cycles). (B) Total sweep

520

numbers required for the adaptive averaging (black boxes) were compared to those used

521

in the conventional averaging (red boxes). Within each experiment, sweep numbers at

522

all suprathreshold levels and the first two subthreshold levels were counted and

523

normalized to the default setting for averaging (350 sweeps for mouse ABR and 3000

524

sweeps for human ABR). The adaptive averaging required 30.4 ± 5.8 % sweeps in

525

mouse ABR tests (left) and 63.8 ± 21.1% in human ABR tests (right) to perform

526

successful threshold detection. Error bar represents standard deviation.

23

B
(dB)

2500

80

2000

60

1500

# pairs

Test sound level

A

40
20

20 dB
40 dB
60 dB
80 dB

1000
500
0

0

2

4

6

-1

Time (ms)

-0.5

0

0.5

Correlation coefficient

Wang et al., Fig 1

1

A

B

0.5

Median corr. coefficient

90

80

70

50

0.3
0.2
0.1
0

C

40

30

Median corr. coefficient

SPL (dB)

60

0.4

20

10

0

0

20

40

SPL (dB)

0.12

60

80

0.1
0.08
0.06
0.04
0.02
0

1

2

3

4

5

6

-15

Time (ms)

Wang et al., Fig 2

-10

-5

0

SPL(dB)

5

10

15

B

C
90

90

Abs. Lag

Start

D
(data point)

A
Start acquisition

80

80

70
Random split
averaging
avgA’’, avgB’’

Compute
xcorr(avgA,avgB)

Compute
xcorr(avgA’,avgB’)

Compute
xcorr(avgA’’,avgB’’)

A = (|lag|<k)

B = (|lag|<k)

C = (|lag|<k)

A&B&C

yes

50

Max.
iterations?

E

50

40

40

30

F

20
10

yes
No signal
Stop acquisition

Signal
Stop acquisition

0

0
1

2

3

4

Time (ms)

5

6

8
6
4
2
0

30

10

20

90 80 70 60 50 40 30 20 10 0

60

20

no
no

60

40

0

# iterations

Random split
averaging
avgA’, avgB’

SPL (dB)

Random split
averaging
avgA, avgB

70

Norm. # iterations

Receiving data
(single sweeps)

60

1

2

3

4

Time (ms)

Wang et al., Fig 3

5

6

90 80 70 60 50 40 30 20 10 0
1
0.8
0.6
0.4
0.2

1
0.5
0
45

25

5

0
90 80 70 60 50 40 30 20 10 0

SPL (dB)

A

Mouse ABR
（n=8）

B

0

-5

Mouse ABR
(n=8)

1.5

Norm. # sweeps

5

Human ABR
(n=4)

1

0.5

0

-10

)
m

Ad

.(

h)
.(

)
v.
on
C

Ad

(h

)
m

Ad

.(

h)
.(

Ad

on

v.

(h

)

Conv.

C

threshold (dB)

10

Human ABR
(n=4)

Wang et al., Fig 4

Ad.

Conv.

Ad.

