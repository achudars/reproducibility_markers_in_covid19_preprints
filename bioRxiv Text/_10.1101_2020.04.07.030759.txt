bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

Genetic Grouping of SARS-CoV-2 Coronavirus Sequences using Informative
Subtype Markers for Pandemic Spread Visualization
Zhengqiao Zhao1* , Bahrad A. Sokhansanj

1†

, Charvi Malhotra 2 , Kitty Zheng 2 , Gail L. Rosen1+ ,

1 Ecological and Evolutionary Signal-Processing and Informatics Laboratory, Department of
Electrical and Computer Engineering, College of Engineering, Drexel University,
Philadelphia, PA, USA
2 College of Medicine, Drexel University, Philadelphia, PA, USA
* zz374@drexel.edu
† bahrad@molhealtheng.com
+ glr26@drexel.edu

Abstract

1

We propose an efficient framework for genetic subtyping of SARS-CoV-2, the novel coronavirus that causes

2

the COVID-19 pandemic. Efficient viral subtyping enables visualization and modeling of the geographic

3

distribution and temporal dynamics of disease spread. Subtyping thereby advances the development of

4

effective containment strategies and, potentially, therapeutic and vaccine strategies. However, identifying

5

viral subtypes in real-time is challenging: SARS-CoV-2 is a novel virus, and the pandemic is rapidly

6

expanding. Viral subtypes may be difficult to detect due to rapid evolution; founder effects are more

7

significant than selection pressure; and the clustering threshold for subtyping is not standardized. We

8

propose to identify mutational signatures of available SARS-CoV-2 sequences using a population-based

9

approach: an entropy measure followed by frequency analysis. These signatures, Informative Subtype

10

Markers (ISMs), define a compact set of nucleotide sites that characterize the most variable (and thus most

11

informative) positions in the viral genomes sequenced from different individuals. Through ISM compression,

12

we find that certain distant nucleotide variants covary, including non-coding and ORF1ab sites covarying

13

with the D614G spike protein mutation which has become increasingly prevalent as the pandemic has spread.

14

1/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

ISMs are also useful for downstream analyses, such as spatiotemporal visualization of viral dynamics. By

15

analyzing sequence data available in the GISAID database, we validate the utility of ISM-based subtyping by

16

comparing spatiotemporal analyses using ISMs to epidemiological studies of viral transmission in Asia,

17

Europe, and the United States. In addition, we show the relationship of ISMs to phylogenetic reconstructions

18

of SARS-CoV-2 evolution, and therefore, ISMs can play an important complementary role to phylogenetic

19

tree-based analysis, such as is done in the Nextstrain [1] project. The developed pipeline dynamically

20

generates ISMs for newly added SARS-CoV-2 sequences and updates the visualization of pandemic

21

spatiotemporal dynamics, and is available on Github at https://github.com/EESI/ISM and via an

22

interactive website at https://covid19-ism.coe.drexel.edu/.

23

Author Summary

24

The novel coronavirus responsible for COVID-19, SARS-CoV-2, expanded to reportedly 8.7 million confirmed

25

cases worldwide by June 21, 2020. The global SARS-CoV-2 pandemic highlights the importance of tracking

26

viral transmission dynamics in real-time. Through June 2020, researchers have obtained genetic sequences of

27

SARS-CoV-2 from over 47,000 samples from infected individuals worldwide. Since the virus readily mutates,

28

each sequence of an infected individual contains useful information linked to the individual’s exposure

29

location and sample date. But, there are over 30,000 bases in the full SARS-CoV-2 genome—so tracking

30

genetic variants on a whole-sequence basis becomes unwieldy. We describe a method to instead efficiently

31

identify and label genetic variants, or “subtypes” of SARS-CoV-2. Applying this method results in a

32

compact, 11 base-long compressed label, called an Informative Subtype Marker or “ISM”. We define viral

33

subtypes for each ISM, and show how regional distribution of subtypes track the progress of the pandemic.

34

Major findings include (1) covarying nucleotides with the spike protein which has spread rapidly and (2)

35

tracking emergence of a local subtype across the United States connected to Asia and distinct from the

36

outbreak in New York, which is found to be connected to Europe.

37

Introduction

38

Severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2), the novel coronavirus responsible for the

39

COVID-19 pandemic, was first reported in Wuhan, China in December 2019. [2, 3]. In a matter of weeks,

40

SARS-CoV-2 infections had been detected in nearly every country, and as of July 2020, reported cases

41

continue to rapidly increase across multiple continents. Powered by advances in rapid genetic sequencing,

42

2/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

there is an expansive and growing body of data on SARS-CoV-2 sequences from individuals around the

43

world. During the early stage of the pandemic, a substantial degree of heterogeneity was already identified,

44

with differences in 15% of the sites of the sequences. [4] SARS-CoV-2 will mutate over time as transmissions

45

occur and the virus spreads; although, notably, it has previously been observed that coronaviruses, which are

46

single strand RNA viruses with a relatively large genome size („30,000 bases), tend to have lower mutation

47

rates than other RNA viruses [5]. Central repositories are continuously accumulating SARS-CoV-2 genome

48

data from around the world, such as the Global Initiative on Sharing all Individual Data (GISAID) [6]

49

(available at https://www.gisaid.org/).

50

Researchers are presently using whole genome sequence alignment and phylogenetic tree construction to

51

study the evolution of SARS-CoV-2 on a macro and micro scale [1, 7–10]. For example, the Nextstrain group

52

has created a massive phylogenetic tree incorporating sequence data and applied a model of the time-based

53

rate of mutation to create a hypothetical map of viral distribution [1] (available at

54

https://nextstrain.org/ncov). Similarly, the China National Center for Bioinformation has established a

55

“2019 Novel Coronavirus Resource”, which includes a clickable world map that links to a listing of sequences

56

along with similarity scores based on alignment (available at https://bigd.big.ac.cn/ncov?lang=en) [11].

57

In more granular studies, early work by researchers based in China, analyzing 103 genome sequences,

58

identified two highly linked single nucleotides, leading them to suggest that two major subtypes had emerged:

59

one called “L,” predominantly found in the Wuhan area, and “S,” which derived from “L” and found

60

elsewhere [12]. Subsequently, further diversity was recognized as the virus continued to spread, and

61

researchers developed a consensus reference sequence for SARS-CoV-2, to which other sequences may be

62

compared [13]. Researchers have continued to publish studies of the specific variants in the context of

63

localized outbreaks, such as the Diamond Princess cruise ship [14], as well as regional outbreaks and their

64

international connections [12, 15–18].

65

Efforts are also underway to identify potential genome sites and regions where selection pressure may

66

result in phenotypic variation. Particular focus has been given to the ORF (open reading frame) coding for

67

the spike (S) receptor-binding protein, which may impact the development of vaccines and antivirals [19].

68

Notably, a group studying sequence variants within patients reported limited evidence of intrahost variation,

69

though they cautioned that the results were preliminary and could be the result of limited data [20, 21].

70

Intrahost variation thus represents yet another layer of complexity in evaluating that viral variation which

71

influences disease progression in an individual patient, or may be associated with events that can in turn

72

generate sequence variation in other individuals that patient infects.

73

Given the importance of tracking and modeling genetic changes in the SARS-CoV-2 virus as the outbreak
3/44

74

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

expands, there is a need for an efficient methodology to quantitatively characterize groups of variation in the

75

SARS-CoV-2 virus genome by defining genetic subtypes of the virus. Exemplary potential applications of

76

quantitative subtyping include the following: 1) Characterizing potentially emerging variants of the virus in

77

different regions, which may ultimately express different phenotypes. 2) Monitoring variation in the viral

78

genome that may be important for vaccine development, for example due to emerging structural differences

79

in proteins encoded by different strains. 3) Designing future testing methodology to contain disease

80

transmission across countries and regions, for example developing specific tests that can characterize whether

81

a COVID-19 patient developed symptoms due to importation or likely domestic community transmission. 4)

82

Identifying viral subtypes that may correlate with different clinical outcomes in different regions and patient

83

subpopulations.

84

Phylogenetic trees obtained through sequence alignment may be utilized to map viral outbreaks

85

geographically and trace transmission chains [22, 23] and have been applied to SARS-CoV-2 by, e.g., the

86

Nextstrain group as discussed above. At an early stage in the pandemic, however, phylogenetic trees may be

87

unreliable predictors of evolutionary relationships between viral strains circulating worldwide, because of

88

insufficient information regarding the molecular clock assumption, practical limits on data collection, and

89

sampling bias [24]. Accordingly, subtyping based on phylogenetic models may also be unreliable and change,

90

as the assumptions underlying the models change given more sequencing and continued variation in the viral

91

genome. The ISM approach described in this paper relies instead on compact measures of sequence similarity

92

that will remain conserved even as more genome sequence data is added over time. ISMs thus provide a

93

robust subtype definition, which can help track the virus as the pandemic progresses. Therefore, it may be

94

more efficient to focus on co-occurring patterns of only the sites of the more frequently occurring variation

95

within the viral genome to identify subtypes, rather than utilizing whole genome sequence data to cluster

96

viral genomes, which may contain additional confounding variation.

97

Moreover, the nomenclature of clades imply that the categorization of viruses in subtypes is static rather
than dynamic. SARS-CoV-2 is a novel virus in humans that is rapidly evolving, which makes it harder to

98

99

establish a stable nomenclature for genetic typing [10]. The Nextstrain project has sought to address these

100

challenges by providing their own clade definitions based on whether there are a certain number of mutations

101

at nucleotide positions in the sequence (at least two) and naming clades based on their estimated time of

102

emergence [25]. This shows that a conventional genetic subtype relying on whole genome phylogenetic trees

103

will be complicated by the changes in viral genome, especially early on in a pandemic before those changes

104

are clearly governed by selection pressure. Lineages will likely disappear and reemerge within different

105

geographical regions and over the course of time [10]. In addition, viral evolutionary analysis, such as by the

106

4/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

Nextstrain group, relies on making assumptions solely on molecular evolution (the degree of sequence

107

similarity and branching points in defining genetic clades and other levels of organization) and not on

108

transmission models.

109

In this paper, we propose a methodology to complement phylogenetics-based transmission and evolution

110

models of SARS-CoV-2 that can consistently and rapidly identify subtypes without requiring an initial tree

111

reconstruction step—and, thereby, avoid the need to make assumptions about the molecular evolution clock

112

and clustering thresholds. To generate highly informative molecular signatures indicative of a subtype or

113

emerging lineage, we look to methods that have been successfully employed in the microbiome field to resolve

114

species/subspecies from 16S ribosomal RNA (16S rRNA) gene [26]. The 16S rRNA gene is a highly

115

conserved sequence and therefore can be used for phylogenetic analysis in microbial communities [27–31].

116

One way to differentiate between closely related microbial taxa is to identify nucleotide positions in 16S

117

rRNA data (“oligotypes”) that represent information-rich variation [32]. This approach has also been used in

118

the reverse direction to find conserved sites as a way to assemble viral phylogenies [33]. Dawy et al. proposed

119

to use Shannon’s mutual information to identify multiple important loci for Gene mapping and marker

120

clustering [34]. Shannon Entropy [35] has been applied in multiple sequence alignment data to quantify the

121

sequence variation at different positions [32, 36]. Given a position of interest, entropy can be used to measure

122

the amount of “randomness” at that position, as determined by whether sequences may have different bases

123

at a specific position. For instance, if there is an A at a given position across all aligned sequences, the

124

entropy will be 0, i.e., there is no “randomness” at that position. On the other hand, if at a given position

125

there is a G in 50% of the sequences and a T in the other 50%, the entropy will be 1 (i.e., essentially

126

“random”), and thus a relatively high entropy. Based on this property, oligotyping [32] utilizes variable sites
revealed by the entropy analysis to identify highly refined taxonomic units.1

127

128

Accordingly, we present herein a method to define a genetic signature, called an “informative subtype

129

marker” or ISM, for the viral genome that can be 1) utilized to define SARS-CoV-2 subtypes that can be

130

quantified to characterize the geographic and temporal spread of the virus, and 2) efficiently implemented for

131

identifying strains to potentially analyze for phenotypic differences. The method compresses the full viral

132

genome to generate a small number of nucleotides that are highly informative of the way in which the viral

133

genome dynamically changes. We draw on the aforementioned oligotyping approach developed for 16S rRNA

134

data [32] and build on its implementation of entropy and grouping patterns to address the particular

135

challenges of viral genomes. On top of oligotyping, we add error correction to account for ambiguities in

136

1 It

is important to note that while we use the term “random” in the foregoing, in the biological context, a position may have
a different base in different sequences due to selection pressure resulting in strains with different phenotypes, rather than purely
random variation.

5/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

reported sequence data and, optionally, applied further compression by identifying patterns of base entropy

137

correlation. The resulting ISM, therefore, defines a viral genetic subtype (that can be related to a

138

phylogenetic “lineage”, see Comparison of ISM-defined subtypes to clades identified using phylogenetic trees)

139

in the sense that it is a compressed (reduced complexity) representation of a set of genetic features (a.k.a

140

genotype).

141

The ISM pipeline may complement a phylogenetic approach in that it can efficiently identify viral

142

subtypes of the population through genetic hotspots and do not rely on evolutionary model assumptions.

143

ISMs identify subtypes with slight differences between sequences where the sequence identity is ą99%, as is

144

the case of SARS-CoV-2 with OrthoANI of 99.8% (at the end of April 2020) [37]. ISMs include the key base

145

mutations in the marker identification itself. And thus, unlike phylogenetic lineages (i.e., clades and

146

subsequent emergent subtypes), ISM-defined subtypes are expressly differentiated by mutations with high

147

diversity (over the viral population). For example, the ISM label of a subtype can include mutation in

148

SARS-CoV-2’s spike protein, which may have an important phenotypic impact.

149

As a succinct and robust identifier, therefore, ISM-based subtyping can facilitate downstream analysis,

150

such as modeling and visualizing the geographic and temporal patterns of genetic variability of SARS-CoV-2

151

sequences obtained from the GISAID database. We have made the pipeline available on Github

152

https://github.com/EESI/ISM, where it will be continuously updated as new sequences are uploaded to

153

data repositories 2 . We have also developed an interactive website showing the worldwide country-specific

154

distributions of ISM-defined subtypes, available at https://covid19-ism.coe.drexel.edu/

155

Methods

156

Data collection and preprocessing

157

Nextstrain maintains a continually-updated, pre-formatted SARS-CoV-2 (novel coronavirus) sequence

158

dataset through GISAID (this dataset also includes sequences of other novel coronavirus sampled from other

159

hosts such as Bat). This dataset was downloaded from GISAID (http://www.gisaid.org) on June 17, 2020,

160

which contains 47,305 sequences. Our preprocessing pipeline then begins by filtering out sequences that are

161

less than 25000 base pairs (the same threshold used in Nextstrain project built for SARS-CoV-23 ). We also

162

included a reference sequence from National Center for Biotechnology Information4 (NCBI Accession

163

2 The latest report at the time of paper submission, run on June 22, 2020, with data up to June 17, 2020, can be found in
https://github.com/EESI/ISM/blob/master/ISM-report-20200617-with_error_correction-compressed-SHORT-ISM.ipynb.
3 https://github.com/nextstrain/ncov
4 https://www.ncbi.nlm.nih.gov/

6/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

number: NC 045512.2), resulting in an overall data set of 47,280 sequences. We then performed multiple

164

sequence alignment on all remaining sequences using MAFFT [38] with the “FFT-NS-2” method in

165

XSEDE [39]. After alignment, the sequence length was extended (for the present data set, up to 79716 nt)

166

due to gaps inserted into the sequences during the multiple sequence alignment.

167

Entropy analysis and ISM extraction

168

For the aligned sequences, we merged the sequence with the metadata provided by Nextstrain5 as of June 17,
2020, based on identification number, gisaid epi isl, provided by GISAID [6]. Given the fast-moving nature
of the pandemic, we filtered out sequences with incomplete date information in metadata (e.g. ”2020-01”) in
order to incorporate temporal information with daily resolution. In addition, we filtered out sequences from
unknown host or non-human hosts. The resulting final data set contained 45535 sequences excluding the
reference sequence. Then, we calculated the entropy at a given position i by:

Hpiq “ ´

ÿ

pk piq ˚ log2 ppk piqq

kPL

where L is a list of unique characters in all sequences and pk piq is a probability of observing a character k at

169

position i. We estimated pk piq from the frequency of characters at that position. We refer to characters in

170

the preceding because, in addition to the bases A, C, G, and T, the sequences include additional characters

171

representing gaps (-) and ambiguities, which are listed in Supplementary file 2 — Sequence notation [40].6

172

Bases like N and -, which represent a fully ambiguous site and a gap respectively, are substantially less

173

informative. Therefore, we further define a masked entropy as entropy calculated without considering

174

sequences containing N and - in a given nucleotide position in the genome. With the help of this masked

175

entropy calculation, we can focus on truly informative positions, instead of positions at the start and end of

176

the sequence in which there is substantial uncertainty due to artifacts in the sequencing process. Finally,

177

high entropy positions are selected by two criteria: 1) entropy ą 0.23, and 2) the percentage of N and - is

178

less than 25%. Further details about the selection of these two criteria are provided in Supplementary file 1 —

179

Masked entropy threshold analysis. In the data set we processed for this paper, the entropy threshold yielded

180

20 distinct positions within the viral genome sequence. We built the Informative Subtype Markers (ISMs) at

181

these 20 nucleotide positions on each sequence.

182

5 https://https://www.gisaid.org/
6 The sequences are of cDNA derived from viral RNA, so there is a T substituting for the U that would appear in the viral
RNA sequence.

7/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

Error correction to resolve ambiguities in sequence data and remove spurious

183

ISMs

184

The focus of the error correction method is to resolve an ISM that contains ambiguous symbols, i.e., a

185

nucleotide identifier that represents an ambiguous base call (as detailed in Supplementary file 2 — Sequence

186

notation [40]), such as N, which represents a position that could be A, C, T, or G. Our approach uses ISMs

187

with few or no ambiguous symbols to correct ISMs with many ambiguities. Given an ISM with an error, we

188

first find all ISMs that are identical to the subject ISM’s nucleotide positions without error. We refer here to

189

these nearly-identical ISMs as supporting ISMs. Then, we iterate over all positions with an error that must

190

be corrected in the subject ISM. For a given nucleotide position, if all other such supporting ISMs with

191

respect to the said erroneous position contain the same non-ambiguous base (i.e., an A, C, T, or G), then we

192

simply correct the ambiguous base to that non-ambiguous base found in the supporting ISMs. However,

193

when the supporting ISMs disagree at a respective nucleotide position, the method generates an ambiguous

194

symbol which represents all the bases that occurred in the supporting ISMs and compare this artificially

195

generated nucleotide symbol with the original position in the subject ISM. If the generated nucleotide symbol

196

identifies a smaller set of bases, e.g., Y representing C or T rather than N, which may be any base, then we use

197

the generated symbol to correct the original one.

198

When we applied the foregoing error correction algorithm to ISMs generated from the genome data set

199

analyzed in this paper, we found that 90.2% of erroneous ISMs were partially corrected (meaning at least one

200

nucleotide position with ambiguity was corrected for that ISM if not all), and 24.5% of erroneous ISMs were

201

fully corrected (meaning all positions with ambiguity were corrected to a non-ambiguous base (i.e., an A, C, T,

202

or G)). Since one ISM may represent multiple sequences in the data set, overall the error correction algorithm

203

was able to partially correct 96.0% of sequences identified by an erroneous ISM, and 32.4% of such sequences

204

were fully corrected.

205

The error correction method necessarily results in the replacement of ISMs with an ambiguous base at a
site by another ISM without an error at that site. We expect, and have observed that the abundance of
non-ambiguous ISMs are inflated by the error correction process. Here, we utilize the inflation rate of ISMs
to quantify the difference in abundance of an ISM before and after error correction process. The inflation
rate is defined by:
Inflation rate “

NEC ´ N
N

where N is the abundance of an ISM of interest (typically an ISM with few or no ambiguous bases) before

206

error correction, and NEC is the abundance of that ISM after error correction.

207

8/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

Quantification and visualization of viral subtypes

208

At the country/region level, we assess the geographic distribution of SARS-CoV-2 subtypes, and, in turn, we

209

count the frequency of unique ISMs per location and build charts and tables to visualize the ISMs, including

210

the pie charts, graphs, and tables shown in this paper. All visualizations in this paper and our pipeline are

211

generated using Matplotlib and Plotly [41, 42]. To improve visualization, ISMs that occur with frequency of

212

less than 5% in a given location are collapsed into “OTHER” category per location. Our pipeline then

213

creates pie charts for different locations to show the geographical distribution of subtypes. Each subtype is

214

also labeled with the earliest date associated with sequences from a given location in the dataset.

215

The abundance table based ordination is widely used to visualize community ecology in the

216

microbiome [43]. [44] also used Principal Components Analysis (PCA) to produce a two-dimensional visual

217

summary of the genetic variation in human populations. In our application, we can use the abundances of

218

different ISMs in a country as features to quantify the genetic variation pattern of SARS-CoV-2 sequences.

219

In our analysis, we select countries that have more than 100 viral sequences uploaded in order to have

220

enough ISMs to viably generate such an abundance table. Then, the number of sequences is down-sampled

221

to 100 for each country/region with more than 100 sequences so that all countries/regions have the same

222

effective “sequencing depth.” Therefore, results are not biased by the different number of submissions in

223

different countries. We then construct the ISM abundance table. The elements in the abundance table

224

represent the abundance of an ISM in a country/region after down-sampling, where each column is an ISM.

225

We use Bray-Curtis dissimilarity [45] to quantify the dissimilarity of ISM compositions between a pair of

226

regions and form a pairwise Bray-Curtis dissimilarity matrix. Finally, we employ PCA to reduce the

227

dimensionality of the pairwise Bray-Curtis dissimilarity matrix, plotting the first two components to visualize

228

the genetic variation patterns of those countries/regions.

229

To study the progression of SARS-CoV-2 viral subtypes in the time domain, we group all sequences in a
given location that were obtained no later than a certain date (as provided in the sequence metadata)
together and compute the relative abundance (i.e., frequency) of corresponding subtypes. Any subtypes with
a relative abundance that never goes above 2.5% for any date are collapsed into “OTHER” category per
location. The following formula illustrates this calculation:

ISMps,cq ptq “

Ns,c ptq
Nc ptq

where ISMps,cq ptq is the relative abundance of a subtype, s, in location, c, at a date t, Ns,c ptq is the total

230

number of instances of such subtype, s, in location, c, that has been sequenced no later than date t and

231

9/44

bioRxiv preprint doi: https://doi.org/10.1101/2020.04.07.030759; this version posted July 10, 2020. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-ND 4.0 International license.

Nc ptq is the total number of sequences in location, c, that has been sequenced no later than date t.

232

Comparison of ISM subtyping to phylogenetic analysis

233

Nextstrain [1] provides a phylogeny method to track and visualize the dynamic of SARS-CoV-2 sequences.

234

To obtain the results presented here, we downloaded the Nextstrain tree data from

235

https://nextstrain.org/ncov on June 17, 2020. Since both the ISMs and the Nextstrain phylogenetic

236

tree were generated based on the GISAID database, they may be easily compared. We present two

237

comparisons in this paper: 1) ISM hamming distance and phylogenetic tree branch length; 2) ISM clusters

238

defined at different entropy thresholds and Nextstrain defined “clades”.

239

The highest-abundance ISMs are involved with hundreds, if not thousands, of sequences. For a given ISM,

240

we can find the lowest common ancestor (LCA) node in the phylogenetic tree of all sequences with that ISM.

241

The branch length between the LCA and the root can be considered as the inferred evolutionary distance

242

between the reference sequence and the LCA node. Hamming distance between our ISMs measures the

243

divergence between two clusters of sequences. We can compare branch length between the root and LCA

244

with the Hamming distance between a given ISM and the reference ISM. Then, we compute the Pearson

245

correlation coefficient to measure the correlation between the evolutionary distance from the reference

246

genome (inferred by the phylogenetic tree) and the Hamming distance between ISMs and the reference ISM.

247

In Nextstrain data, there are 5 “clades”, namely, 19A, 19B, 20A, 20B and 20C, defined in [25]. Different

248

sequences are assigned to those 5 “clades” based on genetic variations in the sequence. Since our ISMs are

249

clusters of sequences with similar genetic variations, the Nextstrain “clades” provides us a good interface to

250

study how our entropy threshold influences the ISM definition by comparing the overlaps between Nextstrain

251

“clades” grouped sequences and ISM grouped sequences. To measure the similarity between ISM labels and

252

“clade” labels of sequences, we use two clustering metrics, homogeneity and completeness as proposed in [46].

253

A c